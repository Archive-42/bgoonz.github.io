!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){function t(t){for(var n,r,a=t[0],o=t[1],s=0,c=[];s<a.length;s++)r=a[s],i[r]&&c.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(l&&l(t);c.length;)c.shift()()}var n={},i={0:0};function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,r){n=i[e]=[t,r]}));t.push(n[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(e){return r.p+"WordViewerDS."+({1:"dll1",2:"common",3:"objectmodel"}[e]||e)+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),o=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+r+": "+a+")");o.type=r,o.request=a,n[1](o)}i[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.oe=function(e){throw console.error(e),e};var a=window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var l=o;return r(r.s=429)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i=function(e,t,n,i){e.prototype.constructor=e,e.__typeName=t,e.__class=!0,n&&(e.__baseType=n,e.__basePrototypePending=!1),i.length>0&&(e.__interfaces=i)},r=function(e,t,n){void 0===n&&(n=!1),t.__typeName=e,t.__string=e,t.__flags=n,t.__enum=!0,t.parse=function(e){return t[e]},t.toString=function(e){return t[e]},t.getName=function(){return e}}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(61),o=n(11),s=n(49);var l=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this)||this).actionName=t,r.tabName=n,r.timeStamp=i,r}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Sys.EventArgs);Object(i.a)(l,"ActionEventArgs",Sys.EventArgs,[]);var c,u=n(187),d=n(9),p=(n(54),n(164));!function(e){e[e.none=0]="none",e[e.reading=1]="reading",e[e.edit=2]="edit"}(c||(c={})),Object(i.b)("FrameMode",c);var h=n(175),m=n(97),g=n(66),f=n(88),v=n(3),_=n(150),y=n(46),b=function(){function e(){this._unprocessedActionOperations=[],this._actionEventSource=new s.a,this.otelNonUserActionEventTableName=g.a.getOtelNonUserActionEventTableName(),this.otelNonUserActionEventTableNamePrefix=g.a.getOtelNonUserActionEventTablePrefix(),p.a.add_onAfterError(Object(r.d)(this,this.closeUnprocessedActions,"closeUnprocessedActions"))}var t=e.prototype;return t.add_onActionEventHandler=function(e){this._actionEventSource.addHandler("OtelUserAction",e)},t.remove_onActionEventHandler=function(e){this._actionEventSource.removeHandler("OtelUserAction",e)},t.onBeforeAction=function(e){this.addUnprocessedActionOperation(e)},t.onAfterAction=function(e){this.removeLastUnprocessedActionOperation(e)&&this.canRecordToOtel(e)&&this.recordToOtel(e)},t.addUnprocessedActionOperation=function(e){Array.add(this._unprocessedActionOperations,e)},t.removeLastUnprocessedActionOperation=function(e){var t=this._unprocessedActionOperations.length-1;return this._unprocessedActionOperations[t]!==e?(Array.clear(this._unprocessedActionOperations),!1):(Array.removeAt(this._unprocessedActionOperations,t),!0)},t.closeUnprocessedActions=function(){this._unprocessedActionOperations.length>0&&v.ULS.sendTraceTag(40109205,383,50,"Count of unprocessed action operations: "+this._unprocessedActionOperations.length.toString());for(var e=0;e<this._unprocessedActionOperations.length;e++){var t=this._unprocessedActionOperations[e];this.recordToOtel(t)}Array.clear(this._unprocessedActionOperations)},t.canRecordToOtel=function(e){return!0},t.recordToOtel=function(t){var i=n(1).AFrameworkApplication;if(g.a.isUserActionLoggingToOtelEnabled()){0;var r=n(1).AFrameworkApplication.theActionManager.getActionMetadata(t.actionId),s=!!r&&r.flags[32]&&r.flags[64];if(!(2!==t.behavior||t.response<1||!i.theWsaClient||s)){var d=t.actionId,p=a.ActionManager.actionIdResolver(d)||"",b=t.startTime.getTime(),S=t.endTime.getTime()-b;S=S<0?0:S;var C=t.commandTabName||g.a.unknownValueString,A=h.a[t.invocationMethod],I=u.a[t.commandLocation],w=c[t.beginMode],T=t.telemetryData&&"TriggerTime"in t.telemetryData?t.telemetryData.TriggerTime:0,E=parseInt(String(Math.round(T)));E>g.a.MAX_SAFE_INTEGER&&(v.ULS.sendTraceTag(42567431,383,50,"timeOffsetMs ("+E+") was > "+g.a.MAX_SAFE_INTEGER),E=g.a.MAX_SAFE_INTEGER);var k=n(1).AFrameworkApplication.theWsaClient.getActiveDocKey(),M=32===t.response,P=!!r&&r.flags[8]&&!!t.reportingData,F=[Object.assign(new y.a,{name:"Mode",string:w}),Object.assign(new y.a,{name:"ActiveDocKey",int64:k})],D=0,O=0;if(P){var R=t.reportingData,x=(65535&d^d>>>16)<<16;x<0&&(x+=4294967296),D=void 0===R.dataValue1||null===R.dataValue1?0:R.dataValue1,O=void 0===R.dataValue2||null===R.dataValue2?0:R.dataValue2,D+=x,O+=x,Array.add(F,Object.assign(new y.a,{name:"CustomData1",int64:D})),Array.add(F,Object.assign(new y.a,{name:"CustomData2",int64:O}))}64===t.response||e.componentNameNotUsed;r&&r.flags[64]?(g.a.sanitizeValues(Object(o.a)((function(){return C}),(function(e){return C=e})),Object(o.a)((function(){return A}),(function(e){return A=e})),Object(o.a)((function(){return I}),(function(e){return I=e}))),Array.add(F,Object.assign(new y.a,{name:"ActionId",int64:t.actionId})),Array.add(F,Object.assign(new y.a,{name:"ActionName",string:p})),Array.add(F,Object.assign(new y.a,{name:"CommandSurface",string:I})),Array.add(F,Object.assign(new y.a,{name:"ParentName",string:C})),Array.add(F,Object.assign(new y.a,{name:"TriggerMethod",string:A})),Array.add(F,Object.assign(new y.a,{name:"TimeOffsetMs",int64:E})),Array.add(F,Object.assign(new y.a,{name:"StartTime",date:b})),Array.add(F,Object.assign(new y.a,{name:"Succeeded",bool:M})),f.a.sendActivityEvent(Object.assign(new _.a,{name:p&&p.length>0?this.otelNonUserActionEventTableNamePrefix+p:this.otelNonUserActionEventTableName,durationMs:S,dataFields:F})),v.ULS.sendTraceTag(40915043,383,50,"OtelActionListener activity:"+p)):(m.d(d,M,C,t.invocationMethod,t.commandLocation,S,F),v.ULS.sendTraceTag(40915072,383,50,"OtelActionListener action:"+p),this._actionEventSource.raiseEvent("OtelUserAction",new l(p,C,Date.now())))}}},e.getInstance=function(){return e._instance||(e._instance=new e)},e}();b._instance=null,b.componentNameNotUsed=2,Object(i.a)(b,"OtelActionListener",null,[28,29]);var S=n(13),C=function(){function e(e){void 0===e&&(e=!0),this._unprocessedActionOperations=[],p.a.add_onAfterError(Object(r.d)(this,this.closeUnprocessedActions,"closeUnprocessedActions")),this._logActiveDocKey=e}var t=e.prototype;return t.onBeforeAction=function(e){this.addUnprocessedActionOperation(e)},t.onAfterAction=function(e){this.removeLastUnprocessedActionOperation(e)&&this.canRecordToSqm(e)&&this.recordToSqm(e)},t.addUnprocessedActionOperation=function(e){Array.add(this._unprocessedActionOperations,e)},t.removeLastUnprocessedActionOperation=function(e){var t=this._unprocessedActionOperations.length-1;return this._unprocessedActionOperations[t]!==e?(Array.clear(this._unprocessedActionOperations),!1):(Array.removeAt(this._unprocessedActionOperations,t),!0)},t.closeUnprocessedActions=function(){for(var e=0;e<this._unprocessedActionOperations.length;e++){var t=this._unprocessedActionOperations[e];this.recordToSqm(t)}Array.clear(this._unprocessedActionOperations)},t.canRecordToSqm=function(e){return g.a.oldActionsPipelineIsEnabled()},t.recordToSqm=function(t){var i=n(1).AFrameworkApplication;if(this.canRecordToSqm(t)){0;var r=n(1).AFrameworkApplication.theActionManager.getActionMetadata(t.actionId),a=!!r&&r.flags[64];if(!(2!==t.behavior||t.response<1||!i.theWsaClient||a)){var o=t.actionId,s=t.startTime.getTime(),l=t.endTime.getTime()-s;(s&=4294967295)<0&&(s+=4294967296),l<0&&(l=0);var c=t.invocationMethod+(t.beginMode<<5)+(t.commandLocation<<9)+(e.commandUIActionComponentTypeNotUsed<<16)+(e.actionResponseToResponseCode(t.response)<<21),u=S.a.calcHashCode(t.commandTabName),d=0,p=0;if(!!r&&r.flags[8]){var h=t.reportingData,m=(65535&o^o>>>16)<<16;m<0&&(m+=4294967296),d=void 0===h.dataValue1||null===h.dataValue1?0:h.dataValue1,p=void 0===h.dataValue2||null===h.dataValue2?0:h.dataValue2,d+=m,p+=m}var g,f=[c,u,o,64===t.response?1:e.componentNameNotUsed,s,l,d,p];this._logActiveDocKey&&f.push(i.theWsaClient.getActiveDocKey()),(g=i.theWsaClient).addToStreamDw.apply(g,[e.ribbonStreamId].concat(f))}}},e.getInstance=function(t){return void 0===t&&(t=!0),e._instance||(e._instance=new e(t))},e.actionResponseToResponseCode=function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 4:return 3;case 8:return 4;case 16:return 5;case 32:return 6;case 64:return 7;default:return 8}},e}();C._instance=null,C.ribbonStreamId=8327,C.ribbonStreamWidth=9,C.commandUIActionComponentTypeNotUsed=31,C.componentNameNotUsed=2,Object(i.a)(C,"WsaListener",null,[32,29]);var A=n(67),I=n(189),w=n(260);function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var E=function(e){var t,n,i,r,a;function o(t,n,i){var r;return(r=e.call(this)||this)._oldRefreshedSettingsGetter=t,r._newRefreshedSettingsGetter=n,r._changedSettingNames=i,r}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.prototype.isSettingChanged=function(e){return!this._changedSettingNames||e in this._changedSettingNames},i=o,(r=[{key:"oldRefreshedSettingsGetter",get:function(){return this._oldRefreshedSettingsGetter}},{key:"newRefreshedSettingsGetter",get:function(){return this._newRefreshedSettingsGetter}}])&&T(i.prototype,r),a&&T(i,a),o}(Sys.EventArgs);Object(i.a)(E,"SettingsRefreshedArgs",Sys.EventArgs,[]);var k=n(76);function M(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var P=function(){function e(e){this._appSettingsManager=e,this._settingsGetter=new w.a({},this._appSettingsManager),this._eventSource=new s.a}var t,n,i,r=e.prototype;return r.updatePostRefresh=function(e){e=e||{};var t=this.getChangedSettingNames(e);if(t.length){for(var n={},i=0;i<t.length;i++)n[t[i]]=!0;var r=this._settingsGetter;this._settingsGetter=new w.a(e,this._appSettingsManager),this._eventSource.raiseEvent("SR",new E(r,this._settingsGetter,n))}},r.getChangedSettingNames=function(e){var t=new Array(0);return this.appendChangedSettingsFromDictionary(e,null,this._settingsGetter,t),this.appendChangedSettingsFromDictionary(this._settingsGetter.appSettings,e,this._settingsGetter.fallbackAppSettingsGetter,t),t},r.appendChangedSettingsFromDictionary=function(e,t,n,i){if(e)for(var r=k.d(e),a=0;a<r.length;a++){var o=r[a];if(!t||!(o in t)){var s=e[o];(n?n.getStringAppSetting(o):null)!==s&&Array.add(i,o)}}},r.add_onSettingsRefreshed=function(e){this._eventSource.addHandler("SR",e)},r.remove_onSettingsRefreshed=function(e){this._eventSource.removeHandler("SR",e)},r.getBooleanAppSetting=function(e){return this._settingsGetter.getBooleanAppSetting(e)},r.getDoubleAppSetting=function(e,t){return this._settingsGetter.getDoubleAppSetting(e,t)},r.getIntAppSetting=function(e,t){return this._settingsGetter.getIntAppSetting(e,t)},r.getLongAppSetting=function(e,t){return this._settingsGetter.getLongAppSetting(e,t)},r.getStringAppSetting=function(e){return this._settingsGetter.getStringAppSetting(e)},r.containsAppSetting=function(e){return this._settingsGetter.containsAppSetting(e)},r.getListAppSetting=function(e){return this._settingsGetter.getListAppSetting(e)},t=e,(n=[{key:"isRefreshEnabled",get:function(){return this.getBooleanAppSetting("AppSettingsRefreshIsEnabled")}}])&&M(t.prototype,n),i&&M(t,i),e}();Object(i.a)(P,"RefreshableAppSettings",null,[237,31]);var F=n(232),D=n(125),O=n(43),R=n(40),x=(n(129),n(185),function(){this.errorCode=0,this.errorCause=0,this.errorResolution=0});Object(i.a)(x,"ErrorWithCauseAndResolution",null,[]);var U=n(106),B=n(85),L=n(99),N=n(56),H=n(71),W=n(140),j=n(182),V=n(48),K=n(24),z=n(17),q=n(20),G=n(73),Q=n(28),Z=n(57);function $(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var X=function(){function e(){this.defaultCommonDatapointIds=[60,7982,7993,7994,8047,8048,8049,9411,9412],this.m_UploadUrl="",this.m_IsOptedIn=!1,this.m_SqmQoSEnabled=!1,this.m_QoSDataPoints=null,this.m_MaxSessionMs=18e5,this.m_MaxDataSize=e.defaultMaxDataSize,this.m_MaxSqmId=2147483647,this.m_MaxStreamWidth=9,this.m_MinTimeBetweenUploads=1e3,this.m_MaxStreamRows=e.defaultMaxStreamRows}var t,n,i;return t=e,(n=[{key:"maxSessionMs",get:function(){return this.m_MaxSessionMs},set:function(e){this.m_MaxSessionMs=e}},{key:"uploadUrl",get:function(){return this.m_UploadUrl}}])&&$(t.prototype,n),i&&$(t,i),e}();X.defaultMaxDataSize=65536,X.defaultMaxStreamRows=1e3,X.defaultMaxInt32=4294967295,X.defaultRibbonStreamWidth=8,Object(i.a)(X,"BWsaConfig",null,[]);var J=function(){function e(){}return e.getTicks32=function(){var t=(new Date).getTime();return e.startTicks||(e.startTicks=t),1+t-e.startTicks&2147483647},e.getTicks64=function(){var e=(new Date).getTime();return e+=116444736e5,e*=1e4},e}();J.startTicks=0,Object(i.a)(J,"Ticks",null,[]);var Y=function(){this.m_CorrelationId=null,this.m_FlightId=null,this.m_StartTime=J.getTicks64(),this.m_EndTime=0};Object(i.a)(Y,"BWsaHeader",null,[]);var ee=function(){this.m_cDataPoints=0,this.m_cStreams=0,this.m_cbStreams=0,this.m_wsaHeader=new Y,this.m_wsaDatapoints={},this.m_wsaStreams={}};Object(i.a)(ee,"BWsaData",null,[]);var te=function(e){this.m_WsaId=e,this.m_Value=0,this.m_Ticks=J.getTicks32(),this.m_Count=0,this.m_Sum=0};Object(i.a)(te,"BWsaDatapoint",null,[]);var ne=function(e,t,n,i){(i<1||i>X.defaultMaxStreamRows)&&(i=X.defaultMaxStreamRows),this.m_WsaId=e,this.m_StreamType=t,this.m_Width=n,this.m_MaxRows=i,this.m_RowCount=0,this.m_RowsOverwritten=0,this.m_Rows={}};Object(i.a)(ne,"BWsaStream",null,[]);var ie=function(){};ie.maxRowCount=0,ie.maxOverwritten=0,Object(i.a)(ie,"StreamRowCounters",null,[]);var re=function(){function e(){}return e.isTimerResetNeeded=function(){var t=!1,n=(new Date).getTime();return(!e.lastResetTicks||n-e.lastResetTicks>6e4)&&(t=!0,e.lastResetTicks=n),t},e}();re.lastResetTicks=0,Object(i.a)(re,"TimerResetCheck",null,[]);var ae=function(e){this.m_Ticks=J.getTicks32(),this.m_Values=new Array(e)};function oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(ae,"WsaStreamRow",null,[]);var se=function(){function e(e,t,n,i){this.m_BWsaData=null,this.m_BWsaConfig=null,this.m_Continuation=!1,this.m_LastUpload=0,this.m_TimerId=0,this.m_DataAvailableForUpload=!1,this.m_CommonDatapoints=null,this.c_request=null,this.docKey=0,this.persistentDocHash=null,this.bWsaClientInit(e,t,n,i)}var t,i,a,o=e.prototype;return o.bWsaClientInit=function(e,t,n,i){this.m_BWsaData=new ee,this.m_BWsaConfig=new X,this.m_Continuation=!1,this.m_LastUpload=0,this.m_TimerId=0,this.m_DataAvailableForUpload=!1,this.m_CommonDatapoints={};for(var r=0;r<this.m_BWsaConfig.defaultCommonDatapointIds.length;r++)this.m_CommonDatapoints[""+this.m_BWsaConfig.defaultCommonDatapointIds[r]]=!0;this.m_BWsaConfig.m_UploadUrl=e,this.m_BWsaConfig.m_IsOptedIn=""!==e&&t,this.m_BWsaConfig.m_SqmQoSEnabled=n&&!!i,this.m_BWsaConfig.m_QoSDataPoints=i},o.disableSqmQos=function(){this.m_BWsaConfig.m_SqmQoSEnabled=!1},o.initContinuationSession=function(){var e=new ee,t=this.m_CommonDatapoints;for(var n in t){var i={key:n,value:t[n]}.key,r=this.m_BWsaData.m_wsaDatapoints[i];if(r){var a=new te(parseInt(i));a.m_Value=r.m_Value,a.m_Count=r.m_Count,a.m_Sum=r.m_Sum,e.m_wsaDatapoints[i]=a,e.m_cDataPoints++}}e.m_wsaHeader.m_CorrelationId=this.m_BWsaData.m_wsaHeader.m_CorrelationId,e.m_wsaHeader.m_FlightId=this.m_BWsaData.m_wsaHeader.m_FlightId,this.m_BWsaData=e,this.m_DataAvailableForUpload=!1},o.maxSizeReachedCheck=function(){var e=12*this.m_BWsaData.m_cDataPoints+this.m_BWsaData.m_cbStreams;return e>=this.m_BWsaConfig.m_MaxDataSize&&(this.uploadWsaData(),(e=12*this.m_BWsaData.m_cDataPoints+this.m_BWsaData.m_cbStreams)>=this.m_BWsaConfig.m_MaxDataSize)},o.setInitialDatapoints=function(t){try{if(this.m_DataAvailableForUpload||this.m_CommonDatapoints[""+t])return;this.m_DataAvailableForUpload=!0,this.addCommonDataPointInternal(7982,e.getBrowserInfo()),this.addCommonDataPointInternal(8049,e.getOsInfo()),this.addCommonDataPointInternal(8814,3),this.addCommonDataPointInternal(9411,e.getScreenResolution()),this.addCommonDataPointInternal(9412,e.getDeviceType())}catch(e){e.message;0}},o.isQoSDataPoint=function(e){if(this.m_BWsaConfig.m_IsOptedIn)return!0;if(!this.m_BWsaConfig.m_SqmQoSEnabled)return!1;var t=this.m_BWsaConfig.m_QoSDataPoints;for(var n in t){if({key:n,value:t[n]}.value===e)return!0}return!1},o.setDw=function(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(e<1||e>this.m_BWsaConfig.m_MaxSqmId)return;if(t<0||t>X.defaultMaxInt32)return void this.setDw(8763,e);if(this.maxSizeReachedCheck())return;this.setInitialDatapoints(e),this.resetTimer();var n=this.m_BWsaData.m_wsaDatapoints[""+e];n||(n=new te(e),this.m_BWsaData.m_wsaDatapoints[""+e]=n,this.m_BWsaData.m_cDataPoints++),n.m_Value=t,n.m_Count++,n.m_Sum=t+n.m_Sum}catch(e){}},o.setBool=function(e,t){t&&(t=1),this.setDw(e,t)},o.setBitsOrAnd=function(e,t,n){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(t<0||t>X.defaultMaxInt32||n<0||n>X.defaultMaxInt32)return void this.setDw(8763,e);var i=this.m_BWsaData.m_wsaDatapoints[""+e];i?(this.resetTimer(),i.m_Value&=n,i.m_Value|=t,i.m_Count++):this.setDw(e,t)}catch(e){}},o.setBitsOr=function(e,t){this.setBitsOrAnd(e,t,4294967295)},o.setBitsAnd=function(e,t){this.setBitsOrAnd(e,0,t)},o.setIfMax=function(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;var n=this.m_BWsaData.m_wsaDatapoints[""+e];!n||n.m_Value<t?this.setDw(e,t):this.resetTimer()}catch(e){}},o.setIfMin=function(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;var n=this.m_BWsaData.m_wsaDatapoints[""+e];!n||n.m_Value>t?this.setDw(e,t):this.resetTimer()}catch(e){}},o.incrementDw=function(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(!t)return void this.resetTimer();var n=0,i=this.m_BWsaData.m_wsaDatapoints[""+e];i&&(n=i.m_Value),this.setDw(e,n+t)}catch(e){}},o.addToAverage=function(e,t,n){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;this.setDw(e,t);var i=this.m_BWsaData.m_wsaDatapoints[""+e];i&&(n>1&&(i.m_Count+=n-1),i.m_Value=Math.floor(i.m_Sum/i.m_Count))}catch(e){}},o.createStream=function(e,t,n,i){try{if(this.bsqmActionsPipelineDisabled()&&8327===e)return;if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(e<1||e>this.m_BWsaConfig.m_MaxSqmId)return;if(1!==t&&2!==t)return;if(n<1||n>this.m_BWsaConfig.m_MaxStreamWidth)return;if(this.maxSizeReachedCheck())return;if((i<1||i>this.m_BWsaConfig.m_MaxStreamRows)&&(i=this.m_BWsaConfig.m_MaxStreamRows),!this.m_BWsaData.m_wsaStreams[""+e]){var r=new ne(e,t,n,i);this.m_BWsaData.m_wsaStreams[""+e]=r,this.m_BWsaData.m_cStreams++,this.m_BWsaData.m_cbStreams+=12}}catch(e){}},o.createStreamUnobfuscated=function(e,t,n,i){this.createStream(e,t,n,i)},o.bsqmActionsPipelineDisabled=function(){return n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OldPipelineActionLoggingDisabled")},o.removeOldestStreamRow=function(e){delete e.m_Rows[""+e.m_RowsOverwritten],this.m_BWsaData.m_cbStreams-=4*(e.m_Width+1),e.m_RowCount--,e.m_RowsOverwritten++,e.m_RowsOverwritten>ie.maxOverwritten&&(ie.maxOverwritten=e.m_RowsOverwritten,this.setDw(7994,e.m_RowsOverwritten),this.setDw(8047,e.m_WsaId))},o.addToStreamDw=function(e){if(!(arguments.length<=1)&&arguments.length-1)try{for(var t=new ae(arguments.length<=1?0:arguments.length-1),n=0;n<(arguments.length<=1?0:arguments.length-1);n++)t.m_Values[n]=n+1<1||arguments.length<=n+1?void 0:arguments[n+1];0,this.addToStreamInternal(e,t)}catch(e){}},o.addToStreamDwUnobfuscated=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.addToStreamDw.apply(this,[e].concat(n))},o.addToStreamInternal=function(e,t){if((this.m_BWsaConfig.m_IsOptedIn||this.m_BWsaConfig.m_SqmQoSEnabled)&&!(e<1||e>this.m_BWsaConfig.m_MaxSqmId||this.maxSizeReachedCheck())){this.setInitialDatapoints(e);for(var n=0;n<t.m_Values.length;n++){var i=t.m_Values[n];if(i<0||i>X.defaultMaxInt32)return void this.setDw(8763,e)}var r=this.m_BWsaData.m_wsaStreams[""+e];if(r){if(this.resetTimer(),r.m_Width!==t.m_Values.length)return;if(r.m_RowCount>=r.m_MaxRows&&2===r.m_StreamType&&this.removeOldestStreamRow(r),r.m_RowCount<r.m_MaxRows){var a=r.m_RowCount+r.m_RowsOverwritten;r.m_Rows[""+a]=t,r.m_RowCount++,this.m_BWsaData.m_cbStreams+=4*(r.m_Width+1),r.m_RowCount>ie.maxRowCount&&(ie.maxRowCount=r.m_RowCount,this.setDw(7993,r.m_RowCount),this.setDw(8048,r.m_WsaId))}else r.m_RowsOverwritten++,r.m_RowsOverwritten>ie.maxOverwritten&&(ie.maxOverwritten=r.m_RowsOverwritten,this.setDw(7994,r.m_RowsOverwritten),this.setDw(8047,r.m_WsaId))}}},o.terminate=function(){this.uploadWsaData()},o.uploadWsaData=function(){try{if(this.clearTimer(),!this.m_BWsaData||!this.m_BWsaConfig)return;if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(""===this.m_BWsaConfig.m_UploadUrl)return void(this.m_BWsaConfig.m_IsOptedIn=!1);var e=J.getTicks32();if(this.m_LastUpload>0&&e<=this.m_LastUpload+this.m_BWsaConfig.m_MinTimeBetweenUploads)return;this.m_LastUpload=e;var t=new Array(0),n=this.m_BWsaData.m_wsaStreams;for(var i in n){var r={key:i,value:n[i]};r.value.m_RowCount||(t[t.length]=r.key)}for(var a=0;a<t.length;a++)delete this.m_BWsaData.m_wsaStreams[t[a]],this.m_BWsaData.m_cStreams--,this.m_BWsaData.m_cbStreams-=12;if(this.m_DataAvailableForUpload){this.m_Continuation?this.setDw(60,1):(this.setDw(60,0),this.m_Continuation=!0),this.writeDocIdStream(),this.m_BWsaData.m_wsaHeader.m_EndTime=J.getTicks64();var o=this.serialize(this.m_BWsaData,this.m_BWsaConfig);this.initContinuationSession(),o&&o.length>0&&this.uploadWsaDataRequest(o)}}catch(e){}},o.uploadWsaDataRequest=function(e){if(this.c_request||(this.c_request=new XMLHttpRequest),!this.c_request.readyState||4===this.c_request.readyState){var t=!0;Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version>=10&&(t=!1),this.c_request.open("POST",this.m_BWsaConfig.m_UploadUrl,t),this.c_request.setRequestHeader("Content-Type","application/json"),this.c_request.send(e)}},o.escape=function(e){return e.replace(new RegExp("[\\\\]","g"),"\\\\").replace(new RegExp('[\\"]',"g"),'\\\\\\"').replace(new RegExp("[\\/]","g"),"\\\\/").replace(new RegExp("[\\b]","g"),"\\\\b").replace(new RegExp("[\\f]","g"),"\\\\f").replace(new RegExp("[\\n]","g"),"\\\\n").replace(new RegExp("[\\r]","g"),"\\\\r").replace(new RegExp("[\\t]","g"),"\\\\t")},o.serialize=function(e,t){var n=new Sys.StringBuilder,i=!0,r=!1,a=0;t.m_IsOptedIn&&(a=16),t.m_SqmQoSEnabled&&(a|=32),n.append("{"),n.append('"StartTime":'+e.m_wsaHeader.m_StartTime+","),n.append('"EndTime":'+e.m_wsaHeader.m_EndTime+","),n.append('"Flags":'+a+","),e.m_wsaHeader.m_CorrelationId&&n.append('"CorrelationId":"'+e.m_wsaHeader.m_CorrelationId+'",'),e.m_wsaHeader.m_FlightId&&n.append('"FlightId":"'+e.m_wsaHeader.m_FlightId+'",'),n.append('"wsaDatapoints":[');var o=e.m_wsaDatapoints;for(var s in o){var l={key:s,value:o[s]}.value;this.isQoSDataPoint(l.m_WsaId)&&(r=!0,i||n.append(","),n.append('{"Id":'+l.m_WsaId+","),n.append('"Val":'+l.m_Value+","),n.append('"Tic":'+l.m_Ticks+"}"),i=!1)}n.append('],"wsaStreams":['),i=!0;var c=e.m_wsaStreams;for(var u in c){var d={key:u,value:c[u]}.value;if(this.isQoSDataPoint(d.m_WsaId)){r=!0;var p=!0;i||n.append(","),n.append('{"Id":'+d.m_WsaId+","),n.append('"Width":'+d.m_Width+","),n.append('"Rows":[');var h=d.m_Rows;for(var m in h){var g={key:m,value:h[m]}.value;p||n.append(","),n.append('{"Tic":'+g.m_Ticks+","),n.append('"Vals":[');for(var f=0;f<g.m_Values.length;f++)f>0&&n.append(","),n.append(""+g.m_Values[f]);n.append("]}"),p=!1}n.append("]}"),i=!1}}return n.append("]}"),r?n.toString():null},o.isUserOptedIn=function(){return this.m_BWsaConfig.m_IsOptedIn},o.disable=function(){try{this.clearTimer(),this.m_BWsaConfig.m_IsOptedIn=!1}catch(e){}},o.addCommonDataPointInternal=function(e,t){if(!this.m_BWsaData.m_wsaDatapoints[""+e]){var n=new te(e);n.m_Value=t,this.m_BWsaData.m_wsaDatapoints[""+e]=n,this.m_BWsaData.m_cDataPoints++}},o.clearTimer=function(){this.m_TimerId&&(window.clearTimeout(this.m_TimerId),this.m_TimerId=0)},o.resetTimer=function(){re.isTimerResetNeeded()&&(this.clearTimer(),this.m_TimerId=window.setTimeout(Object(r.d)(this,this.bWsaOnTimer,"bWsaOnTimer"),this.m_BWsaConfig.m_MaxSessionMs))},o.bWsaOnTimer=function(){this.m_TimerId=0,this.clearTimer(),this.uploadWsaData(),this.resetTimer()},o.addCommonDatapoint=function(e){this.m_CommonDatapoints[""+e]=!0},o.registerPersistentDocId=function(e){return!(!e||4!==e.length||!(e[0]||e[1]||e[2]||e[3]))&&(this.docKey=1,this.persistentDocHash=e,!0)},o.getActiveDocKey=function(){return this.docKey},o.writeDocIdStream=function(){return!(!this.docKey||!this.persistentDocHash)&&(this.createStream(9797,1,5,1),this.addToStreamDw(9797,this.docKey,this.persistentDocHash[0],this.persistentDocHash[1],this.persistentDocHash[2],this.persistentDocHash[3]),this.setDw(10273,this.persistentDocHash[0]),!0)},o.getStreamById=function(e){return this.m_BWsaData.m_wsaStreams[e.toString()]},o.getRowsById=function(e,t){if(!e)return null;var n=new Array(0),i=0,r=e.m_Rows;for(var a in r){var o={key:a,value:r[a]}.value;o.m_Values.length>0&&o.m_Values[0]===t&&(n[i++]=o)}return n},o.updateStartTime=function(e){e&&(this.m_BWsaData.m_wsaHeader.m_StartTime=e)},o.setCorrelationId=function(e){this.m_BWsaData.m_wsaHeader.m_CorrelationId=e},o.setFlightId=function(e){this.m_BWsaData.m_wsaHeader.m_FlightId=e},e.getBrowserInfo=function(){var t=0,n=window.navigator.userAgent,i=-1;if((i=n.indexOf(" MSIE "))>-1?(i+=6,t=2<<24):n.indexOf(" Trident/")>-1&&(i=n.indexOf(" rv:"))>-1?(i+=4,t=2<<24):(i=n.indexOf(" Edge/"))>-1?(i+=6,t=2<<24):(i=n.indexOf(" Firefox/"))>-1?(i+=9,t=3<<24):(i=n.indexOf(" Chrome/"))>-1?(i+=8,t=6<<24):(i=n.indexOf(" Safari/"))>-1&&(i=n.indexOf(" Version/"))>-1?(i+=9,t=4<<24):(i=n.indexOf("Opera/"))>-1?(i+=6,t=5<<24):(t=1<<24,i=-1),i>=0){var r=e.getVersionFromString(n.substr(i));Sys.Browser.agent===Sys.Browser.InternetExplorer&&7===r[0]&&n.indexOf("Trident/4.0")>=0&&(r[0]=8),t|=(r[0]<<16)+r[1]}try{window.navigator.cookieEnabled?t|=2<<29:t|=3<<29}catch(e){}return t=t},e.getVersionFromString=function(t){var n=[0,0];e.isDigit(t.charAt(0))&&(n[0]=parseInt(t));for(var i=0;i<t.length;i++)if(!e.isDigit(t.charAt(i))){t=t.substr(i+1);break}return e.isDigit(t.charAt(0))&&(n[1]=parseInt(t)),(n[0]<0||n[0]>255||n[1]<0||n[1]>65535)&&(n[0]=0,n[1]=0),n},e.getOsInfo=function(){var t=0,n=1,i=window.navigator.userAgent;i.indexOf("Windows CE")>=0?n=3:i.indexOf("Windows")>=0?n=2:i.indexOf("PPC")>=0||i.indexOf("Macintosh")>=0?n=4:i.indexOf("iPhone;")>=0||i.indexOf("iPad;")>=0||i.indexOf("iPod;")>=0?n=7:i.indexOf("SunOS")>=0?n=5:i.indexOf("Linux")>=0&&(n=6),t=n<<24;var r="Windows NT ";7===n&&(r=" OS ");var a=i.indexOf(r);if(a<0&&(r="Mac OS X ",a=i.indexOf(r)),a>=0){var o=e.getVersionFromString(i.substr(a+r.length));t+=(o[0]<<16)+o[1]}var s=0;try{var l=window.navigator.platform;-1!==i.indexOf("WOW64")?s=2:"Win64"===l?s=3:"Win32"!==l&&"Linux i686"!==l||(s=1)}catch(e){}return t|=s<<29},e.getScreenResolution=function(){var e=65535&window.screen.width;return((65535&window.screen.height)<<16)+e},e.getDeviceType=function(){var e=window.navigator.userAgent,t=0;return e.indexOf("iPhone;")>=0?t=1:e.indexOf("iPad;")>=0?t=2:e.indexOf("iPod;")>=0&&(t=3),t},e.isNullOrUndefined=function(e){return null===e||"undefined"==typeof e},e.isDigit=function(e){return e>="0"&&e<="9"},e.getSQMLocationFromCUICommandInfo=function(e){var t=0;if(e){var n=e.RootType;if("Ribbon"===n){var i=e.RootLocation;"LowerRibbon"===i?t=2:"UpperRibbon"===i&&(t=1)}else"QAT"===n?t=3:"Jewel"===n?t=4:"ContextMenu"===n&&(t=19)}return t},e.calcActionId=function(e){for(var t=5381,n=t,i=e.length,r=0;r<i&&(t=4294967295&((t<<5)+t^e.charCodeAt(r)),r!==i-1);r+=2)n=4294967295&((n<<5)+n^e.charCodeAt(r+1));var a=t+35685*n+(23896*n<<16)&4294967295;return a<0&&(a+=4294967296),a},t=e,(i=[{key:"wsaConfig",get:function(){return this.m_BWsaConfig}},{key:"isContinuation",get:function(){return this.m_Continuation}}])&&oe(t.prototype,i),a&&oe(t,a),e}();Object(i.a)(se,"BWsaClient",null,[248]);var le=n(33);function ce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ue=function(e){var t,i,r,a,o;function s(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).isSynchronous=!1,a._uploadUrl=t,a.taskItemPriority=3,a.wsaConfig.m_MaxSessionMs=864e5,a}return i=e,(t=s).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,s.prototype.uploadWsaDataRequest=function(e){var t=n(1).AFrameworkApplication;if(t.theClientRequestManager){var i=n(1).AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson||"";if(t.appSettingsManager.getBooleanAppSetting("BSqmAddFlightsToSessionStartInfoJsonIfMissing")&&(!t.sessionStartInfoSettings.Flights||""===t.sessionStartInfoSettings.Flights)&&t.flightId&&""!==t.flightId){0;try{t.sessionStartInfoSettings.Flights=t.flightId.split(";"),i=le.c(t.sessionStartInfoSettings)}catch(e){v.ULS.sendTraceTag(595083586,201,10,"Failed to updated SessionStartInfo settings with FlightId: {0}",e)}}var r="";if(t.dataPlumber){var a=n(1).AFrameworkApplication.activeFrame?n(1).AFrameworkApplication.activeFrame.mode:0;t.dataPlumber.FrameMode=c[a],r=le.c(t.dataPlumber)}var o,s=n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SendWsaHeadersInBody"),l="",u={};if(s){if((o=e&&e.length>0?new Sys.StringBuilder(e.slice(0,-1)+","):new Sys.StringBuilder("{")).append('"SessionStartInfo":"'+S.a.encodeString(i,S.a.jsonEscapedCharacters)+'"'),o.append(',"DataPlumber":"'+S.a.encodeString(r,S.a.jsonEscapedCharacters)+'"'),o.append(',"UserPrimaryIdentityHash":"'+S.a.encodeString(t.appSettingsManager.getStringAppSetting("LoggableUserId")||"",S.a.jsonEscapedCharacters)+'"'),o.append(',"UserPrimaryIdentitySpace":"'+S.a.encodeString(t.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||"",S.a.jsonEscapedCharacters)+'"'),o.append(',"OmsTenantId":"'+S.a.encodeString(t.appSettingsManager.getStringAppSetting("TenantId")||"",S.a.jsonEscapedCharacters)+'"'),o.append("}"),l=o.toString(),t.appSettingsManager.getBooleanAppSetting("SendBeaconOnShuttingDownRequestsEnabled")||t.isShuttingDownFromPostMessage)return void t.theClientRequestManager.sendShuttingDownRequest(this.uploadUrl,l)}else u["X-SessionStartInfo-Json"]=i,u["X-DataPlumber-Json"]=r;t.theClientRequestManager.addRequest(this.uploadUrl,2,s?l:e,u,!1,this.taskItemPriority,(function(e){}),(function(e){}),null,null,this.isSynchronous,void 0,void 0,"13",void 0,void 0,void 0,!0)}},r=s,(a=[{key:"uploadUrl",get:function(){return this._uploadUrl}}])&&ce(r.prototype,a),o&&ce(r,o),s}(se);Object(i.a)(ue,"MsoBWsaClientBase",se,[247,248,249]);var de=function(e){var t,n;function i(t,n,i,r){return e.call(this,t,n,i,r)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(ue);Object(i.a)(de,"MsoBWsaClient",ue,[]);var pe=function(){this.negativeSign=null,this.numberDecimalDigits=0,this.numberDecimalSeparator=null,this.numberGroupSeparator=null,this.numberGroupSizes=null,this.numberNegativePattern=0,this.percentDecimalDigits=0,this.percentDecimalSeparator=null,this.percentGroupSeparator=null,this.percentGroupSizes=null,this.percentNegativePattern=0,this.percentPositivePattern=0,this.percentSymbol=null};Object(i.a)(pe,"NumberFormatInfo",null,[]);var he=n(10),me=n(68),ge=n(30),fe=n(113),ve=n(70),_e=n(115),ye=n(103),be=function(e){return String.format(e,"")},Se=function(e,t,i,r,a,o){if(4===t)return e;var s=r,l=".js"+o,c=e+l,u="";switch(t){case 0:n(1).AFrameworkApplication.appSettingsManager&&n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OverrideBaseUrlForDullscript")?s="https://localhost:8080/"+(s=be(i)+c).toLowerCase().replace("ewa.","EwaDS.").replace("debug.","Debug."):(u=be(i)+c,s=Ie(s,u),s+=u);break;case 1:s=Ie(s,u=i+c),s+=u;break;case 2:u=String.format("{0}{1}{2}",e,".min",l),s=Ie(s,u),s+=u;break;case 3:u=String.format("{0}\\{1}",a,c),s=Ie(s,u),s+=u;break;case 5:var d=o,p=e,h=e.indexOf("?");h>=0&&(d=o.replace("?","&"),p=e.substring(0,h)),u=String.format("{0}{1}",e,d),s=Ie(s,p),s+=u}return s},Ce=function(e,t,i,r,a,o){if(4===t)return e;var s=r,l=Ae(e,t,i,a,o);switch(t){case 0:n(1).AFrameworkApplication.appSettingsManager&&n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OverrideBaseUrlForDullscript")?s="https://localhost:8080/"+(s=be(i)+e+".js"+o).toLowerCase().replace("ewa.","EwaDS.").replace("debug.","Debug."):(s=Ie(s,l),s+=l);break;case 1:case 2:case 3:s=Ie(s,l),s+=l;break;case 5:var c=o;e.indexOf("?")>=0&&(c=o.replace("?","&")),s=Ie(s,l),s+=String.format("{0}{1}",e,c)}return s},Ae=function(e,t,i,r,a){var o=".js"+a,s=e+o,l="";switch(t){case 4:var c=e.indexOf(n(1).AFrameworkApplication.scriptFolderPath);c>0&&(l=e.substring(c+n(1).AFrameworkApplication.scriptFolderPath.length,e.length));break;case 0:l=n(1).AFrameworkApplication.appSettingsManager&&n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OverrideBaseUrlForDullscript")?"":be(i)+s;break;case 1:l=i+s;break;case 2:l=String.format("{0}{1}{2}",e,".min",o);break;case 3:l=String.format("{0}\\{1}",r,s);break;case 5:var u=e,d=e.indexOf("?");d>=0&&(u=e.substring(0,d)),l=u}return l&&""!==l||ye.b(574359374,200,15,"Script fileName is null or empty"),l},Ie=function(e,t){var i=U.a.instance.getHashedAppResourceHost(n(1).AFrameworkApplication.scriptFolderPath+t);return i?i+n(1).AFrameworkApplication.scriptFolderPath:e},we=n(108),Te=n(93),Ee=function(){function e(){this._keys=new Set,this.$$ge=this.getEnumerator}var t=e.prototype;return t.get_count=function(){return this._keys.size},t.getEnumerator=function(){return Te.fromIterator(Object(r.d)(this._keys,this._keys.values,"values")).$$ge()},t[Symbol.iterator]=function(){return this._keys.values()},t.add=function(e){return!this._keys.has(e)&&(this._keys.add(e),!0)},t.remove=function(e){return!!this._keys.has(e)&&(this._keys.delete(e),!0)},t.contains=function(e){return this._keys.has(e)},t.clear=function(){this._keys.clear()},e}();function ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(Ee,"StringSet",null,[34,35]);var Me,Pe=function(){function e(){this._dataFields=new Array(0),this._dataFieldsKeys=new Ee}var t,n,i,r=e.prototype;return r.addFieldIfMissing=function(e){this.dataFieldsKeys.contains(e.name)||(this.dataFieldsKeys.add(e.name),Array.add(this.dataFields,e))},r.deepClone=function(){for(var t=new e,n=0;n<this.dataFields.length;n++)t.addFieldIfMissing(this.dataFields[n]);return t},t=e,(n=[{key:"dataFields",get:function(){return this._dataFields}},{key:"dataFieldsKeys",get:function(){return this._dataFieldsKeys}}])&&ke(t.prototype,n),i&&ke(t,i),e}();Object(i.a)(Pe,"DataFieldsCollection",null,[]),function(e){e[e.long=0]="long",e[e.boolean=1]="boolean",e[e.double=2]="double",e[e.string=3]="string",e[e.date=4]="date"}(Me||(Me={})),Object(i.b)("DataType",Me);var Fe=n(8),De=n(230),Oe=function(){function e(e,t){var n=this;this.sessionData=null,this.startTimeOnClient=new Date,this.serverStartTime=null,this.sessionStartNameSpace="Office.Online.SessionStart",this.sessionEndNameSpace="Office.Online.SessionEnd",this.automationMetadataNameSpace="Office.Online.AutomationMetadata",ye.b(38844105,200,100,"SSED:Entered SessionStartEndData"),this.startInfoDataFields=new Pe,this.sessionFinishedDataPlumber=t,le.d(e,Object(o.a)((function(){return n.sessionData}),(function(e){return n.sessionData=e})))?(this.fixUpLoggingDataIfNeeded(),this.initMiscStartData()):v.ULS.sendTraceTag(38844106,201,10,"SSED:Unable to deserialize SessionStartInfoJson"),this.sessionData&&"StartTimeUtc"in this.sessionData&&(this.serverStartTime=new Date(this.sessionData.StartTimeUtc))}var t=e.prototype;return t.logSessionStartData=function(){this.sessionData&&g.a.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)&&this.logStartSession(this.sessionStartNameSpace)},t.logSessionEndData=function(){if(this.sessionData&&g.a.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)){we.a.instance.raiseBeforeSessionEndEvent(),this.initMiscEndData(),this.logEndSession(this.sessionEndNameSpace);try{B.Health.instance.shutdown();var e=B.Health.instance.getRemoteTelemetryStats();if(e){var t={};e.forEach((function(e,n){t[n.toString()]=e})),v.ULS.sendTraceTag(592541130,383,50,le.c(t))}}catch(e){v.ULS.sendTraceTag(592541129,383,10,"Failed to serialize RemoteTelemetry request stats: "+e)}}},t.logAutomationMetadata=function(){g.a.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)&&this.sessionData&&this.doLogAutomationMetadata(this.automationMetadataNameSpace)},t.initMiscStartData=function(){this.initStartDataFromPlumber(this.sessionFinishedDataPlumber),this.fixUpLoggingDataIfNeeded(),this.sessionData.ClientVersion=this.sessionFinishedDataPlumber.ApplicationVersion},t.initEndDataFromPlumber=function(e){this.sessionData.FrameMode=e.FrameMode,this.sessionData.Feedback=e.Feedback,this.sessionData.IsCoauthSession=e.IsCoauthSession,this.sessionData.IsRealEdit=e.IsRealEdit,this.sessionData.PrivacyNotice=e.PrivacyNotice,this.sessionData.RenavigationReason=e.RenavigationReason,this.sessionData.CookieComplianceBanner=e.CookieComplianceBanner,this.sessionData.HadSettingsRefresh=e.HadSettingsRefresh,this.sessionData.IsMixedCoauthSession=e.IsMixedCoauthSession;var t=e.MemoryUsageData;t&&(this.sessionData.JsHeapSizeLimit=t.JsHeapSizeLimit,this.sessionData.InitialTotalJSHeapSize=t.InitialTotalJSHeapSize,this.sessionData.InitialUsedJSHeapSize=t.InitialUsedJSHeapSize,this.sessionData.MaxTotalJSHeapSize=t.MaxTotalJSHeapSize,this.sessionData.MaxUsedJSHeapSize=t.MaxUsedJSHeapSize),this.sessionData.WacSessionDatacenter=e.WacSessionDatacenter},t.initStartDataFromPlumber=function(e){try{if(e.HostResponseStats){var t=e.HostResponseStats.Label;t&&(this.sessionData.HostFarmHint=t)}this.sessionData.ClientThrottlingProtection=e.ClientThrottlingProtection,this.sessionData.HostServiceLevel=e.HostServiceLevel,this.sessionData.RequestedCallThrottling=e.RequestedCallThrottling,this.sessionData.WacServiceLevel=e.WacServiceLevel,this.sessionData.SharingStatus=e.SharingStatus}catch(e){}},t.computeSessionEndTime=function(e){if(!e)return ye.b(38844107,200,10,"endTimeOnClient was null"),null;var t=null;if(this.serverStartTime){var n=e.getTime()-this.startTimeOnClient.getTime();t=new Date(n+this.serverStartTime.getTime()),this.sessionData.SessionDurationMs=n}else ye.b(38844108,200,10,"serverStartTime on client was null");return t},t.fixUpLoggingDataIfNeeded=function(){"Application"in this.sessionData&&("Excel"===this.sessionData.Application&&this.fixUpModeForExcel())},t.fixUpModeForExcel=function(){if("Excel"===this.sessionData.Application&&"ApplicationModeExtended"in this.sessionData){var e=this.sessionData.ApplicationModeExtended.toUpperCase();"VIEW"===e||"UNIFIED"===e?this.sessionData.ApplicationModeExtended="EDIT":"EDIT"!==e&&"UNIFIED"!==e||(this.sessionData.ApplicationModeExtended="VIEW")}},t.initMiscEndData=function(){this.initEndDataFromPlumber(this.sessionFinishedDataPlumber);var e=this.computeSessionEndTime(new Date);e&&(this.sessionData.EndTime=e.toString())},t.getDataField=function(e,t,n){if(!e||!t)return null;var i=null;switch(n){case 1:i=Object.assign(new y.a,{name:t,bool:Boolean.parse(e.toString())});break;case 0:var r=parseInt(e);isNaN(r)||(i=Object.assign(new y.a,{name:t,int64:r}));break;case 2:var a=parseFloat(e);isNaN(a)||(i=Object.assign(new y.a,{name:t,double:a}));break;case 3:i=Object.assign(new y.a,{name:t,string:e});break;case 4:var o=Date.parse(e);isNaN(o)||(i=Object.assign(new y.a,{name:t,date:new Date(o).getTime()}));break;default:0}return i},t.logStartSession=function(e){if(this.appendStartInfoToCollection(this.startInfoDataFields),f.a.sendTelemetryEvent(Object.assign(new De.a,{name:e,dataFields:this.startInfoDataFields.dataFields})),g.a.isUserActionLoggingToOtelEnabled(this.sessionData.Application)){var t=Fe.a.openDocument;"ApplicationModeExtended"in this.sessionData&&this.sessionData.ApplicationModeExtended&&this.sessionData.ApplicationModeExtended.toLowerCase().indexOf("new")>=0&&(t=Fe.a.createDocument),m.c(t)}v.ULS.sendTraceTag(39089113,306,50,"SSED:startsession info sent to Otel")},t.appendStartInfoToCollection=function(e){this.addDataIfAvailable("AccessTokenLength","AccessTokenLength",0,e),this.addDataIfAvailable("AccessTokenTtl","AccessTokenTtl",3,e),this.addDataIfAvailable("AllowEarlyFeatures","AllowEarlyFeatures",3,e),this.addDataIfAvailable("ApplicationLCID","ApplicationLcid",3,e),this.addDataIfAvailable("ARRVersion","ArrVersion",3,e),this.addDataIfAvailable("BrowserLCID","BrowserLcid",3,e),this.addDataIfAvailable("CacheId","CacheId",3,e),this.addDataIfAvailable("ClientThrottlingProtection","ClientThrottlingProtection",3,e),this.addDataIfAvailable("ClientVersion","ClientVersion",3,e),this.addDataIfAvailable("CookieComplianceBanner","CookieComplianceBanner",0,e),this.addDataIfAvailable("CookieConsentRequired","CookieConsentRequired",1,e),this.addDataIfAvailable("DeviceName","DeviceName",3,e),this.addDataIfAvailable("EdgeEnvironmentName","EdgeEnvironmentName",3,e),this.addDataIfAvailable("EdgeEventId","EdgeEventId",3,e),this.addDataIfAvailable("EdgeFeatures","EdgeFeatures",3,e),this.addDataIfAvailable("FileExtension","FileExtension",3,e),this.addDataIfAvailable("FileSizeBytes","FileSizeBytes",0,e),this.addDataIfAvailable("FlightsHash","FlightsHash",3,e),this.addDataIfAvailable("HostDatacenterHint","HostDatacenterHint",3,e),this.addDataIfAvailable("HostServiceLevel","HostServiceLevel",3,e),this.addDataIfAvailable("HostFarmHint","HostFarmHint",3,e),this.addDataIfAvailable("HostSessionId","HostSessionId",3,e),this.addDataIfAvailable("LocationCity","LocationCity",3,e),this.addDataIfAvailable("LocationCountry","LocationCountry",3,e),this.addDataIfAvailable("LocationState","LocationState",3,e),this.addDataIfAvailable("PLT","Plt",3,e),this.addDataIfAvailable("RequestedDatacenter","RequestedDatacenter",3,e),this.addDataIfAvailable("RequestedComplianceRegion","RequestedComplianceRegion",3,e),this.addDataIfAvailable("PreviousSession","PreviousSession",3,e),this.addDataIfAvailable("RequestedCallThrottling","RequestedCallThrottling",3,e),this.addDataIfAvailable("ResolvedThrottlingLevel","ResolvedThrottlingLevel",3,e),this.addDataIfAvailable("RoutedVia","RoutedVia",3,e),this.addDataIfAvailable("SessionOrigin","SessionOrigin",3,e),this.addDataIfAvailable("SharingStatus","SharingStatus",3,e),this.addDataIfAvailable("StartTimeUtc","StartTime",4,e),this.addDataIfAvailable("UserAgent","UserAgent",3,e),this.addDataIfAvailable("WacServiceLevel","WacServiceLevel",3,e),this.addDataIfAvailable("WFEVersion","WfeVersion",3,e)},t.logEndSession=function(e){var t=this.startInfoDataFields.deepClone();this.appendStartInfoToCollection(t),this.addDataIfAvailable("EndTimeUtc","EndTime",4,t),this.addDataIfAvailable("Feedback","Feedback",0,t),this.addDataIfAvailable("FrameMode","FrameMode",3,t),this.addDataIfAvailable("HadSettingsRefresh","HadSettingsRefresh",1,t),this.addDataIfAvailable("InitialTotalJSHeapSize","InitialTotalJSHeapSize",0,t),this.addDataIfAvailable("InitialUsedJSHeapSize","InitialUsedJSHeapSize",0,t),this.addDataIfAvailable("IsCoauthSession","IsCoauthSession",1,t),this.addDataIfAvailable("IsRealEdit","IsRealEdit",1,t),this.addDataIfAvailable("JsHeapSizeLimit","JsHeapSizeLimit",0,t),this.addDataIfAvailable("MaxTotalJSHeapSize","MaxTotalJSHeapSize",0,t),this.addDataIfAvailable("MaxUsedJSHeapSize","MaxUsedJSHeapSize",0,t),this.addDataIfAvailable("PrivacyNotice","PrivacyNotice",0,t),this.addDataIfAvailable("RenavigationReason","RenavigationReason",3,t),this.addDataIfAvailable("HadSettingsRefresh","HadSettingsRefresh",1,t),this.addDataIfAvailable("IsMixedCoauthSession","IsMixedCoauthSession",1,t),this.addDataIfAvailable("SessionDurationMs","SessionDurationMs",0,t),this.addDataIfAvailable("WacSessionDatacenter","WacSessionDatacenter",3,t),f.a.sendTelemetryEvent(Object.assign(new De.a,{name:e,dataFields:t.dataFields})),g.a.isUserActionLoggingToOtelEnabled(this.sessionData.Application)&&"IsRealEdit"in this.sessionData&&this.sessionData.IsRealEdit&&this.sessionData.IsRealEdit&&m.c(Fe.a.editDocument),v.ULS.sendTraceTag(39089114,306,50,"SSED:endsession info sent to Otel")},t.doLogAutomationMetadata=function(e){var t,n=new Array(0);le.d(this.sessionData.OfficeAutomationMetadata.toString(),Object(o.a)((function(){return t}),(function(e){return t=e})))?(this.addAutomationItemIfAvailable("JobId","JobId",3,n,t),this.addAutomationItemIfAvailable("JobClassification","JobClassificationId",3,n,t),this.addAutomationItemIfAvailable("TaskId","TaskId",3,n,t),this.addAutomationItemIfAvailable("TaskExecutionId","TaskExecutionId",3,n,t),this.addAutomationItemIfAvailable("ExecutionNumber","ExecutionNumber",3,n,t),this.addAutomationItemIfAvailable("JobProperties","JobProperties",3,n,t),this.addAutomationItemIfAvailable("ScenarioId","TestId",3,n,t),this.addAutomationItemIfAvailable("ConfigName","ConfigName",3,n,t),f.a.sendTelemetryEvent(Object.assign(new De.a,{name:e,dataFields:n})),v.ULS.sendTraceTag(41302225,306,50,"SSED:automation metadata sent to Otel")):v.ULS.sendTraceTag(41302224,201,10,"SSED:Unable to deserialize OfficeAutomationMetadata")},t.addAutomationItemIfAvailable=function(e,t,n,i,r){var a=this.getDataField(r[e],t,n);a&&Array.add(i,a)},t.addDataIfAvailable=function(e,t,n,i){if(e in this.sessionData&&this.sessionData[e]){var r=this.getDataField(this.sessionData[e],t,n);r&&i.addFieldIfMissing(r)}},e}();Object(i.a)(Oe,"SessionStartEndData",null,[]);var Re=n(39),xe=n(60),Ue=n(183),Be=n(75),Le=n(4),Ne=n(25);function He(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var We=function(){function e(){}var t,n,i;return t=e,i=[{key:"openInAppDialogHtmlTemplate",get:function(){return e.dialogHtmlFormat}}],(n=null)&&He(t.prototype,n),i&&He(t,i),e}();We.dialogHtmlFormat="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>",Object(i.a)(We,"OpenInAppDialogHtml",null,[]);var je="&utm_source=wac&utm_medium=web&utm_campaign=miniwac",Ve=function(e){var t,i;function a(t){var i;void 0===t&&(t=""),(i=e.call(this)||this).linkToInstall=null;var r=n(1).AFrameworkApplication;if(1!==r.activeFrame.applicationInstance.officeAppType)return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i);i.clientUrl=r.activeFrame.applicationInstance.clientUrl,i.oicUrl="ms-excel:ofe|u|"+i.clientUrl,i.storeUrl=r.appSettingsManager.getStringAppSetting("AppUrl");var a=!i.clientUrl||!i.clientUrl.length,o=!t||!t.length;return a&&(v.ULS.sendTraceTag(574464472,306,15,"IsClientUrlEmpty: {0}, IsBackupClientUrlEmpty: {1}",a,o),o||(i.clientUrl=t)),he.a.isIPhone?i.storeUrl="itms-apps://"+r.appSettingsManager.getStringAppSetting("WildFireUrlExceliOS")+je:he.a.isAndroid&&(he.a.isLocaleChina?i.storeUrl=r.appSettingsManager.getStringAppSetting("WildFireUrlChinaStoreAndroid"):he.a.androidVersion.majorVersion>4&&(i.storeUrl=r.appSettingsManager.getStringAppSetting("WildFireUrlExcelAndroid")+je)),i}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var o=a.prototype;return o.openUrl=function(e,t){var n=document.getElementById("link");n||((n=document.createElement("a")).id="link",n.style.visibility="hidden",n.href="",document.body.appendChild(n)),n.target=t,n.href=e,n.click()},o.onClickHandler=function(e){var t=this;if(v.ULS.sendTraceTag(592547856,306,50,"MouseClick: Open with redirection timer"),he.a.isAndroid){v.ULS.sendTraceTag(579109377,306,50,"Android intent scheme is being used to open android app from browser"),this.clientUrl&&this.clientUrl.length||v.ULS.sendTraceTag(575484678,306,15,"ClientUrl is null");var n="intent:"+this.clientUrl+"#Intent;scheme=ms-excel;package=com.microsoft.office.excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.storeUrl+";end";this.openUrl(n,"_top")}else he.a.iPhoneOsMajorVersion>=9?(v.ULS.sendTraceTag(578586572,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.oicUrl,"_top")):(v.ULS.sendTraceTag(578586573,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.oicUrl,"_top"),window.setTimeout((function(){t.openUrl(t.storeUrl,"_blank")}),500));return!0},o.onKeyUpHandler=function(e){return(e.innerEvent.keyCode===Ne.a.vK_Enter||e.innerEvent.keyCode===Ne.a.vK_Space)&&(v.ULS.sendTraceTag(592547855,306,50,"KeyPress: Open with redirection timer"),e.sourceElement.click(),!0)},o.initializeAndShowDialog=function(){var e=n(1).AFrameworkApplication,t=n(55).getImageClass,i=n(1).AFrameworkApplication.appSettingsManager.getStringAppSetting("Application");this.dialogHtml=Be.a.formatHtml(We.openInAppDialogHtmlTemplate,CommonUIStrings.l_OpenInMobileAppHeader,String.format(CommonUIStrings.l_OpenInMobileDialogText,i),e.imageClusterPath,t(e.appSettingsManager.getStringAppSetting("AppIcon")),String.format(CommonUIStrings.l_OpenInMobileAppStoreDisplayText,i)),this.dialogId="OpenInAppDialog",this.buttonsOption=5,this.initializeAndShow("",null,null),this.setFocusOnElement(this.linkToInstall)},o.setDialogProperties=function(t){e.prototype.setDialogProperties.call(this,t),document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px",this.linkToInstall=document.getElementById("LinkToInstall"),G.a.instance.registerHandler(Le.EventNames.click,this.linkToInstall,Object(r.d)(this,this.onClickHandler,"onClickHandler")),q.KeyInputManager.instance.registerHandler(Le.EventNames.keyUp,this.linkToInstall,Object(r.d)(this,this.onKeyUpHandler,"onKeyUpHandler"))},o.dispose=function(){this.linkToInstall&&(G.a.instance.unregisterHandler(Le.EventNames.click,this.linkToInstall,Object(r.d)(this,this.onClickHandler,"onClickHandler")),q.KeyInputManager.instance.unregisterHandler(Le.EventNames.keyUp,this.linkToInstall,Object(r.d)(this,this.onKeyUpHandler,"onKeyUpHandler")),this.linkToInstall=null),e.prototype.dispose.call(this)},a}(Be.a);Object(i.a)(Ve,"OpenInAppDialog",Be.a,[]);var Ke=n(58),ze=n(29),qe=n(96),Ge=n(7),Qe=n(79),Ze=n(50),$e=n(158),Xe=n(330),Je=n(27),Ye=n(16),et=n(110),tt=n(179),nt=n(117),it=n(53),rt=n(26),at=n(231),ot=n(21),st=n(35),lt=n(290),ct=n(176);function ut(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"AFrameworkApplication",(function(){return dt}));var dt=function(){function e(t,n){void 0===n&&(n=!0),this._isFocusManagerBugFixEnabled=!1,this._isHttp2Enabled=!1,e._instance=this}var t,i,o,s=e.prototype;return s.updateOpenInClientDocumentUrl=function(e){return null},s.bodyID=function(){return"MainApp"},s.shouldCommandBeHostControlled=function(t){if(t in this.commandsToHostControlIdsMap&&e.appSettingsManager.containsAppSetting(e.hostUIControlSettingName)&&e.appSettingsManager.getStringAppSetting(e.hostUIControlSettingName))for(var n=this.commandsToHostControlIdsMap[t],i=e.appSettingsManager.getListAppSetting(e.hostUIControlSettingName),r=0;r<i.length;r++){var a=i[r];if(a.id===n&&1===a.visibility)return!0}return!1},s.isEntryExistent=function(e){return!1},s.addEntryToBusinessBar=function(e,t){return!1},s.addGdprBusinessBar=function(e,t,n){},s.addGdprBusinessBarWithCloseCallback=function(e,t,n,i){this.addGdprBusinessBar(e,t,n)},s.privacyRefreshRequested=function(){e.activeFrame.refreshDocument(null)},s.addDatacenterDecommissionWarning=function(e){},s.saveAction=function(){return function(){}},s.getFileOpenProperties=function(){return null},s.createMinimumSessionStartInfoSettingsAfterJsonException=function(e){var t={};return null!==e&&(t.Application=e.Application||"",t.WACSessionID=e.SessionId||""),t},s.initialize=function(t){var n=this;e._isUpdateFullSessionStartInfoCalled=!1,ve.a.instance.addMark(ge.a.appInitStart),this._isHttp2Enabled=Boolean.parse(t.StaticContentPrefetchUsingHttp2IsEnabled||"false");var i=new Date;if(e.bootTime=i.getTime(),A.a.get_instance().setAppInitializationStatus(1),e.appSettingsManager=this.createAppSettingsManager(t),e.appSettingsManager.getBooleanAppSetting("SanitizeCookiesEnabled")&&Qe.a.sanitizeCookies(),e.appSettingsManager.getBooleanAppSetting("OneNoteHardBlockBrowsersEnabled")&&(F.a.instance.runFeatureChecks(e.appSettingsManager),!F.a.instance.areBrowserFeaturesSupported)){var o=window.navigator.userLanguage||window.navigator.browserLanguage||window.navigator.language,s=window.location.protocol+"/"+"0".replace("0","")+"/"+window.location.host+"/o/UpgradeBrowser.htm?llcc="+o;this.redirectOutside(s,O.a.unsupportedBrowserWarning)}this.initSessionStartInfoSettings(t.SessionStartInfoJson||""),this.initializeOtel(),e.appSettingsManager.getBooleanAppSetting("MSCCEnabled")&&e.requestCookieConsent(),me.a.instance.notifyReadyToConfigure(ot.a.instance),window.g_logMSAjaxErrorCallback=e.logMSAjaxError,window.g_logMSAjaxInfoCallback=e.logMSAjaxInfo,e.showPageStats=Boolean.parse(t.ShowPageStats||"false"),e.collectPageStats=Boolean.parse(t.CollectPageStats||"false"),e.collectPageStats&&t.PageStats&&""!==t.PageStats&&(e.appPreloadStatistics=t.PageStats),lt.a.instance.start(),a.ActionManager.actionIdResolverDelegate=Object(r.d)(this,this.resolveActionId,"resolveActionId"),a.ActionManager.contextIdResolverDelegate=Object(r.d)(this,this.resolveContextId,"resolveContextId"),a.ActionManager.commandIdResolverDelegate=Object(r.d)(this,this.resolveCommandId,"resolveCommandId"),V.EventHandlerManager.instance.setOnEventInterruptedTask(Object(r.d)(this,this.reportEventInterruptedJavascript,"reportEventInterruptedJavascript")),ze.WacAirSpace.registerDomEvents(),e.buildVersion=t.BuildVersion||"0.0.0.0",e.firstRunExperienceIsEnabled=Boolean.parse(t.FirstRunExperienceIsEnabled||"false"),e.firstRunExperienceUiVariation=parseInt(t.FirstRunExperienceUiVariation||"0"),e.lcid=parseInt(t.Lcid||"1033"),e.uiCulture=t.UICulture||"en-US",e.dataCulture=t.DataCulture||e.uiCulture,e.requestedLcid=parseInt(t.RequestedLcid||e.lcid.toString()),e.canary=t.Canary,e.hostCanary=t.HostCanary,e._isEmbedded=Boolean.parse(t.IsEmbedded||"false"),e._isUIEmbedMode=Boolean.parse(t.IsUIEmbedMode||"false"),e._isNoChrome=Boolean.parse(t.IsNoChrome||"false"),e._requiresCheckout=Boolean.parse(t.RequiresCheckout||"false"),e.useParentHelpFunction=Boolean.parse(t.UseParentHelpFunction||"false"),e.feedbackStringId=parseInt(t.CfString||"0"),e.showRtcConnectionStatus=Boolean.parse(t.ShowRtcConnectionStatus||"false"),e._sleepIntervalInMsec=1e3*parseInt(t.SleepInterval),e._trimOICButtonsIfUnavailable=Boolean.parse(t.TrimOICButtonsIfUnavailable||"false"),e.isCrossDocumentMessengerDisabled=Boolean.parse(t.CrossDocumentMessengerDisabled||"false"),e.isOpenInClientEnabled=!0,e.userSessionId=t.SessionId,e.isLoggingHostRequests=Boolean.parse(t.LogHostRequests||"false"),e.isRtl=Boolean.parse(t.Rtl||"false"),e.shortDateFormat=t.ShortDateFormat,e.shortTimeFormat=t.ShortTimeFormat,e.accessToken=t.AccessToken||"",e.userType=t.UserType||"UNKNOWN",e.tellMeIsEnabled=Boolean.parse(t.TellMeIsEnabled||"false"),e.dataPlumber.fillFromAppSettings(e.appSettingsManager),ot.a.instance.resolveFuture("Common.IRefreshableAppSettings").execute((function(t){t.add_onSettingsRefreshed(Object(r.d)(e.dataPlumber,e.dataPlumber.handleOnSettingsRefresh,"handleOnSettingsRefresh"))})),e._shouldHideToolbarOnViewerRedirect=Boolean.parse(t.ShouldHideToolbarOnViewerRedirect||"false"),e.initializeBulsProperties(t),window.g_sid=e.userSessionId,e.rtcTransportProtocol=t.RtcTransportProtocol,e._newMenuMoreTemplatesUrl=t.NewMenuMoreTemplatesUrl,e._documentIsFolder=Boolean.parse(t.DocumentIsFolder||"false"),e.appSupportsFileRename=Boolean.parse(t.AppSupportsFileRename||"false"),e.appSupportsVersionHistory=Boolean.parse(t.AppSupportsVersionHistory||"false"),e.appSupportsInsertOnlinePictureFromHost=Boolean.parse(t.AppSupportsInsertOnlinePictureFromHost||"false"),e.appSupportsInsertOnlinePictureFromSharePoint=Boolean.parse(t.AppSupportsInsertOnlinePictureFromSharePoint||"false"),e.insertOnlinePictureFromHostEnabled=Boolean.parse(t.InsertOnlinePictureFromHostEnabled||"false"),e.appSupportsMultiInsertOnlinePictureFromHost=Boolean.parse(t.AppSupportsMultiInsertOnlinePictureFromHost||"false"),this._isFocusManagerBugFixEnabled=Boolean.parse(t.FocusManagerBugFixEnabled||"false"),e._mruPollingIntervalInMs=parseInt(t.MruPollingIntervalInMs||"1200000"),e._timeUntilInactiveInMs=parseInt(t.TimeUntilInactiveInMs||"420000"),e._isCustomerFeedbackExternal=Boolean.parse(t.CfExternal||"false"),e._getMoreInfoRetryIntervalsInMs=t.GetMoreInfoRetryIntervalsInMs,e._wacCopyPasteShortcutDialogIsEnabled=Boolean.parse(t.WacCopyPasteShortcutDialogIsEnabled||"false"),e._isDogfoodEnvironment=Boolean.parse(t.IsDogfoodEnvironment||"false"),e.useO365ShellService=Boolean.parse(t.UseO365ShellService||"false");try{var l=(new Date).getTime(),c=e.appSettingsManager.getLongAppSetting("AccessTokenExpirationInMs",0);c<0&&v.ULS.sendTraceTag(19789440,201,50,c.toString()),e.accessTokenTtl=c?l+c:0,e.accessTokenServerExpirationTime=e.appSettingsManager.getLongAppSetting("AccessTokenTtl",0)}catch(t){e.accessTokenTtl=0}try{e.accessTokenExpirationPromptSeconds=Number.parseInvariant(t.AccessTokenExpirationPromptSeconds)}catch(t){e.accessTokenExpirationPromptSeconds=0}e.roamingAppsX86RootUrl=t.RoamingAppsX86RootUrl||"",e.roamingAppsControlInstallerUrl=Je.a.addParameterValue(t.RoamingAppsControlInstallerUrl||"","clid",e.lcid.toString()),e.roamingAppsFirefoxExtensionUrl=Je.a.addParameterValue(t.RoamingAppsFirefoxExtensionUrl||"","clid",e.lcid.toString()),e.hideHeader=Boolean.parse(t.HideHeader||"false"),e.isMobileMode=Boolean.parse(t.IsMobileMode||"false"),e.hasExternalHeader=!Boolean.parse(t.HeaderInsideRibbonIsEnabled||"false"),e.forceTouchRibbon=Boolean.parse(t.ForceTouchRibbon||"false"),e.useCrossOriginStaticScripts=Boolean.parse(t.UseCrossOriginStaticScripts||"false"),qe.a.applicationNameLong=t.WebAppLongName,qe.a.applicationNameShort=t.WebAppShortName,document.body.id=this.bodyID(),e._splashscreenElement=document.getElementById("load_img"),e._splashscreenOverlay=document.getElementById("load_back"),e._isSplashScreenUp=!!e._splashscreenElement&&!!e._splashscreenOverlay,Ue.a.webToadHostName=t.WebToadHostName,e.appSettingsManager.isFullAppSettingsReady&&this.updateFullAppSettings(t),this.updateMiniCheckBasedAppSettings(t),e.ensureAwake(),z.a.setEnsureAppAwakeCallback(e.ensureAwake),z.a.setEnsureAppAwakeIfAsleepCallback(e.ensureAwakeIfAsleep),e.endSessionHeaderReceivedCallback=Object(r.d)(this,this.crashApplication,"crashApplication"),e.assistanceIsEnabled="true"===t.AssistanceIsEnabled,e.assistancePaneIsEnabled="true"===t.AssistancePaneIsEnabled,e.assistanceSearchUrl=t.AssistanceSearchUrl,e.copyLinkForTeamsIsEnabled=e.appSettingsManager.getBooleanAppSetting("CopyLinkForTeamsIsEnabled"),e.isUnifiedHostMode=e.appSettingsManager.getBooleanAppSetting("IsUnifiedHostMode"),e.lokiEndpointForSearch=t.LokiEndpointForSearch,e.tellMeQueryIndexLoggingBaseUrl=t.TellMeQueryIndexLoggingBaseUrl,e.substrateEndpointForSearch=t.SubstrateEndpointForSearch,e.tellMeServiceEndpointForSearch=t.TellMeServiceEndpointForSearch,e.insightsUrl=t.InsightsUrl||"",e.smartLookupIsEnabled="true"===t.SmartLookupIsEnabled,e.insightsIsEnabled=Boolean.parse(t.InsightsIsEnabled||"false"),e.allowEarlyFeaturesForHost=Boolean.parse(t.AllowEarlyFeaturesForHost||"false"),e._environment=e.appSettingsManager.getIntAppSetting("Environment",0),this.initSessionStartAndEndData(),L.a.initialize(),e._cursorPinningIsEnabled=Boolean.parse(t.CursorPinningIsEnabled||"true"),e._nativeSelectionAndContextMenu=e.appSettingsManager.getBooleanAppSetting("OneNoteTeamsEmbedMobileIsEnabled"),e._removeWacDialogKeyUpHandler=Boolean.parse(t.RemoveWacDialogKeyUpHandler||"false"),e.hostOperationHttpStatusCode=e.appSettingsManager.getIntAppSetting("HostOperationHttpStatusCode",0),e.enrichmentPaneUrl=t.EnrichmentPaneUrl||"",e.enrichmentIsEnabled=Boolean.parse(t.EnrichmentIsEnabled||"false"),e.isNewFile=Boolean.parse(t.CreateNew||"false"),e.isNewFile&&(e._newFileTemplateName=t.CreateNewTemplateName,e._newFileTemplateLcid=t.CreateNewTemplateLcid),e.hideHeaderEmbedded=Boolean.parse(t.HideHeaderEmbedded||"false"),e.hideRibbonEmbedded=Boolean.parse(t.HideRibbonEmbedded||"false"),e.isExtensionRequest=Boolean.parse(t.IsExtensionRequest||"false"),e.isConsumption=Boolean.parse(t.IsConsumption||"false"),e.canSupportConsumption=Boolean.parse(t.CanSupportConsumption||"false"),e.wopiIdentityWhitelist=(t.WopiIdentityWhitelist||"").split(","),e.wacFrameImplicitAuthAADApplications=le.b(t.WacFrameImplicitAuthAADApplications||"{}"),e.wacFrameImplicitAuthMSAApplications=le.b(t.WacFrameImplicitAuthMSAApplications||"{}"),e.wacFrameImplicitAuthMSAV2Applications=le.b(t.WacFrameImplicitAuthMSAV2Applications||"{}"),e._wacFrameImplicitAuthTestInformation=le.b(t.WacFrameImplicitAuthTestInformation||"{}"),e._isWopiTokenRefreshEnabled=e.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshIsEnabled"),e._isWopiTokenRefreshWhenSessionExpiredEnabled=e.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshWhenSessionExpiredIsEnabled"),e._isWopiTokenRefreshCancelExpirationEnabled=e.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshCancelExpirationIsEnabled"),e.wopiTokenLastRefreshTime=e.bootTime,e._wopiTokenExpiresAfterMinutes=e.appSettingsManager.getIntAppSetting("WOPITokenExpiresAfterMinutes",0),e._wopiTokenRefreshMaxRetryAttempts=e.appSettingsManager.getIntAppSetting("WopiTokenRefreshMaxRetryAttempts",3),e._wopiTokenRefreshRetryeInterval=e.appSettingsManager.getIntAppSetting("WopiTokenRefreshRetryeInterval",1e4),e._wopiTokenRefreshRetryIntervalForClientNetworkIssue=e.appSettingsManager.getIntAppSetting("WopiTokenRefreshRetryIntervalForClientNetworkIssue",2e3),e.wopiTokenRefreshPermanentHostErrorIdList=(t.WopiTokenRefreshPermanentHostErrorIdList||"").split(","),e.wopiTokenRefreshNetworkErrorIdList=(t.WopiTokenRefreshNetworkErrorIdList||"").split(",");var u=(t.WopiTokensToRefresh||"").split(",");switch(e.wopiTokensToRefresh=u.length>0&&""!==u[0]?u:[it.a.sessionInfo_AccessToken],e._wopiTokenTaskItemPriority=e.appSettingsManager.getIntAppSetting("WopiTokenTaskItemPriority",2),Boolean.parse(t.UpdateRootQuerySignatureInMiniCheck||"false")||(e._rootQuerySignature=e.appSettingsManager.getStringAppSetting("RootQuerySignature")||e.baseDocQuerySignatureWithoutVersion),e.appSettingsManager.getStringAppSetting("SessionExpirationPolicy")){case"NullManager":e._wopiTokenExpirationPolicy=1;break;case"RefreshToken":e._wopiTokenExpirationPolicy=2;break;default:e._wopiTokenExpirationPolicy=0}"teams"===(t[e.uiHostSettingName]||"").toLowerCase()&&ot.a.instance.resolveFuture("Common.ISystemInitiatedFeedback").execute((function(e){e.logActivity("WACTeamsSession",null)}));e.subscribeToBeforeAppShutDown((function(e,t){n.shutdownOtel(),B.Health.instance.shutdown()})),this.configureAppComponents()},s.configureAppComponents=function(){ot.a.instance.register(P,"Common.RefreshableAppSettings").as("Common.IRefreshableAppSettings").singleInstance().usingFactory((function(){return new P(e.appSettingsManager)}))},s.redirectOutside=function(t,n){var i=new $e.QueryStringBuilder(t);throw i.addParam(e.previousSessionParamName,e.userSessionId),i.addParam(e.invalidHostCanaryRedirectParamName,"1"),window.top.location.replace(i.toString()),e.suppressCrashDialog=!0,e.suppressCrashReportingToBSqm=!0,e.suppressCrashReportingToWatson=!0,e.reportError(n),Error.invalidOperation()},s.updateFullSessionStartInfo=function(t){e._isUpdateFullSessionStartInfoCalled||(e._isUpdateFullSessionStartInfoCalled=!0,null==t&&(t=""),e.appSettingsManager.appSettings.SessionStartInfoJson=t,this.initSessionStartInfoSettings(t),this.initializeOtel(),this.initSessionStartAndEndData(),this.initializeBrowserSqm(e.appSettingsManager.appSettings))},s.initSessionStartAndEndData=function(){g.a.isEnabledLogSessionStartAndEndDataFromClientToOTel(e.sessionStartInfoSettings.Application||"unknownApp")&&(e.sessionStartAndEndData=new Oe(e.sessionStartInfoJson,e.dataPlumber),e.sessionStartAndEndData.logSessionStartData(),"OfficeAutomationMetadata"in e.sessionStartInfoSettings&&e.sessionStartInfoSettings.OfficeAutomationMetadata&&e.sessionStartAndEndData.logAutomationMetadata())},s.initSessionStartInfoSettings=function(t){e.sessionStartInfoJson=t;try{e.sessionStartInfoSettings=le.b(e.sessionStartInfoJson)}catch(t){v.ULS.sendTraceTag(35992024,201,10,"Exception thrown from JsonSerializer.SecureDeserialize for sessionStartInfo:{0}. Exception:{1}",e.sessionStartInfoJson,t)}k.g(e.sessionStartInfoSettings)?(e.sessionStartInfoSettings=this.createMinimumSessionStartInfoSettingsAfterJsonException(e.appSettingsManager.appSettings),v.ULS.sendTraceTag(574199378,201,10,"Received an empty SessionStartJson object from the server. Most Part A fields will be missing in Aria events")):(e.sessionStartInfoSettings.Application=e.sessionStartInfoSettings.Application||e.appSettingsManager.getStringAppSetting("Application")||"",e.sessionStartInfoSettings.WACSessionID=e.sessionStartInfoSettings.WACSessionID||e.appSettingsManager.getStringAppSetting("SessionId")||"")},s.initializeOtel=function(){Xe.a((function(){f.a.getInstance(e.sessionStartInfoSettings.Application)})),f.a.setEnabledState(e.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled"))},s.shutdownOtel=function(){if(!e._otelShutdownTriggered){e._otelShutdownTriggered=!0,this.logSessionEndData();var t=f.a.shutdown();t>0&&(v.ULS.sendTraceTag(40464538,383,50,"Otel telemetry queue contains events at shutdown: {0}",t),t>e.appSettingsManager.getIntAppSetting("OtelDroppedEventsThreshold",10)&&v.ULS.sendTraceTag(40994567,383,15,"Otel telemetry queue contains events at shutdown (data loss):{0}",t))}},s.updateFullAppSettings=function(t){e.closeUrl=t.CloseUrl||"",e.useClosePostMessage=Boolean.parse(t.ClosePostMessage||"false"),e.privacyUrl=t.PrivacyUrl||"",e.termsUrl=t.TermsUrl||"",e.filePropertiesUrl=t.FilePropertiesUrl||"",e.useFilePropertiesPostMessage=Boolean.parse(t.FilePropertiesPostMessage||"false"),e.fileSharingUrl=t.FileSharingUrl||"",e.useFileSharingPostMessage=Boolean.parse(t.FileSharingPostMessage||"false"),e.fileShareEnabled=!!e.fileSharingUrl||at.a()&&e.useFileSharingPostMessage,e.workflowTypeString=t.WorkflowType||"None",e.workflowUrl=t.WorkflowUrl||"",e.useWorkflowPostMessage=at.a()&&Boolean.parse(t.WorkflowPostMessage||"false"),e.workflowEnabled=Boolean.parse(t.WorkflowEnabled||"false")&&"None"!==e.workflowTypeString&&(""!==e.workflowUrl||at.a()&&e.useWorkflowPostMessage),e.copyAndEditUrl=t.CopyAndEditUrl||"",e.useCopyAndEditPostMessage=Boolean.parse(t.CopyAndEditPostMessage||"false"),e.useEditModePostMessage=Boolean.parse(t.EditModePostMessage||"false"),e.useRedeemForCommentingPostMessage=Boolean.parse(t.RedeemForCommentingPostMessage||"false"),e.useSignInCommandPostMessage=Boolean.parse(t.SignInCommandPostMessage||"false"),e.appCatalogUrl=t.AppCatalogUrl||"",e.downloadACopyUrl=t.DownloadACopyUrl||"",e.directReadUrl=t.DirectReadUrl||"",e.directInvokeDAVUrl=t.DirectInvokeDAVUrl||"",e.fileEmbedCommandUrl=t.FileEmbedCommandUrl||"",e.hostEmbeddedViewUrl=t.HostEmbeddedViewUrl||"",e.hostEmbeddedEditUrl=t.HostEmbeddedEditUrl||"",e.useFileEmbedCommandPostMessage=Boolean.parse(t.FileEmbedCommandPostMessage||"false"),e.replyWithChangesUrl=t.ReplyWithChangesUrl||"",e.useReplyWithChangesPostMessage=Boolean.parse(t.ReplyWithChangesPostMessage||"false"),e.isReplyWithChangesWorkFlow=!e.isNoChrome&&(Qe.a.get("BP")||"").startsWith("FR=WC.Hotmail%2AWACCopy"),e.useOpenInClientPostMessage=Boolean.parse(t.OpenInClientPostMessage||"false"),e.preferPostMessageOverCommandUrlForOpenInClient=Boolean.parse(t.PreferPostMessageOverCommandUrlForOpenInClient||"false"),e.addSessionIdToClientUrl=Boolean.parse(t.AddSessionIdToClientUrl||"false"),e.fileVersionUrl=t.FileVersionUrl||"",e.useFileVersionPostMessage=Boolean.parse(t.FileVersionPostMessage||"false"),e.reportAbuseUrl=t.ReportAbuseUrl||"",e.closeButtonClosesWindow=Boolean.parse(t.CloseButtonClosesWindow||"false"),e.openInClientEditOnly=Boolean.parse(t.OpenInClientEditOnly||"false"),e.isOfficeTrialOfferEnabled=Boolean.parse(t.OfficeTrialOfferEnabled||"false"),e.isMacOfficeTrialOfferEnabled=Boolean.parse(t.MacOfficeTrialOfferEnabled||"false"),e.dialogClearerStringsIsEnabled=Boolean.parse(t.DialogClearerStringsIsEnabled||"false"),e.dialogDefaultEnterBehaviorIsEnabled=Boolean.parse(t.DialogDefaultEnterBehaviorIsEnabled||"false"),e.downloadCopyOnOpenInClient=Boolean.parse(t.DownloadCopyOnOpenInClient||"false"),e.postMessageOrigin=t.PostMessageOrigin||"",e.hostSupportsFileRename=Boolean.parse(t.HostSupportsFileRename||"false"),e.hostSupportsVersionHistory=Boolean.parse(t.HostSupportsVersionHistory||"false"),e.hostSupportsInsertOnlinePictureFromHost=Boolean.parse(t.HostSupportsInsertOnlinePictureFromHost||"false"),e.userCanRename=Boolean.parse(t.UserCanRenameFile||"false"),e.fileNameMaxLength=parseInt(t.FileNameMaxLength||"250"),e.breadcrumbBrandName=t.BreadcrumbBrandName||"",e.breadcrumbBrandUrl=t.BreadcrumbBrandUrl||"",e.breadcrumbFolderName=t.BreadcrumbFolderName||"",e.breadcrumbFolderUrl=t.BreadcrumbFolderUrl||"",e.signoutUrl=t.SignoutUrl||"",e.signInUrl=t.SignInUrl||"",e.privacyDialogText=t.PrivacyDialogText||"",e.privacyDialogLinkText=t.PrivacyDialogLinkText||"",e.privacyDialogTitleText=t.PrivacyDialogTitleText||"",e.privacyDialogFwlinkId=t.PrivacyDialogFwlinkId||"",e.privacyCookieDomain=t.PrivacyCookieDomain||"",e.mightNeedPrivacyDialog=Boolean.parse(t.ShowPrivacyDialog||"false"),e.privacyDialogShouldCheckRoaming=Boolean.parse(t.PrivacyDialogShouldCheckRoaming||"false"),e.privacyDialogCanWriteServerSettings=Boolean.parse(t.PrivacyDialogCanWriteServerSettings||"false"),e.privacyDialogCurrentVersion=parseInt(t.PrivacyDialogCurrentVersion||"1"),e.privacyDialogAlreadySeen=Boolean.parse(t.PrivacyDialogAlreadySeen||"false"),e._irmPolicyTitle=t.IrmPolicyTitle,e._irmPolicyDescription=t.IrmPolicyDescription,t.ProtectedFile&&(e.protectedFile=Boolean.parse(t.ProtectedFile)),t.EnableMacrosForProtectedFile&&(e.enableMacrosForProtectedFile=Boolean.parse(t.EnableMacrosForProtectedFile)),e._hostNameToIncludeInSavedStatus=t.HostNameToIncludeInSavedStatus||"",e.sessionContext=t.SessionContext||"",e.isCloseable=!e.isEmbedded&&(e.closeButtonClosesWindow||!!e.closeUrl||e.useClosePostMessage),e._isAppsForOfficeSingleSignOnSupportedOnHost=Boolean.parse(t.IsAppsForOfficeSingleSignOnSupportedOnHost||"false"),e._hostFrameTrustCheckIsEnabled=Boolean.parse(t.HostFrameTrustCheckIsEnabled||"false"),v.ULS.sendTraceTag(590444318,306,100,"HostFrameTrustCheckIsEnabled:{0}",e._hostFrameTrustCheckIsEnabled),e._hostAllowlistCheckIsEnabled=Boolean.parse(t.HostAllowlistCheckIsEnabled||"false"),v.ULS.sendTraceTag(578945938,306,100,"HostAllowlistCheckIsEnabled:{0}",e._hostAllowlistCheckIsEnabled),e._hostAllowlistForAddIns=e.appSettingsManager.getStringAppSetting("HostAllowlistForAddIns"),e._hostFrameTrustCheckIsEnabled&&!e.isHostFrameTrusted&&(Boolean.parse(t.HostExemptedFromFrameTrustCheck||"false")?e.isHostFrameTrusted=3:this.supportsFrameTrustCheck?(v.ULS.sendTraceTag(590444319,306,100,"IsHostFrameTrusted is NotReady"),e.isHostFrameTrusted=2,e.sendIsFrameTrustedMessage()):(v.ULS.sendTraceTag(590444320,306,100,"IsHostFrameTrusted is NotImplemented"),e.isHostFrameTrusted=1)),this.addSwitcherHtmlToDom(t),e._disableWholeAppsForOfficeFeature=Boolean.parse(t.DisableWholeAppsForOfficeFeature||"false"),e.smartLookupIsEnabled=Boolean.parse(t.SmartLookupIsEnabled||"false"),e.insightsIsEnabled=Boolean.parse(t.InsightsIsEnabled||"false"),e.mightNeedPrivacyDialog&&A.a.get_instance().executeWhen(8,_e.PrivacyDialogManager.showPrivacyDialogIfNecessary),e.wopiIdentityWhitelist=(t.WopiIdentityWhitelist||"").split(",")},s.updateMiniCheckBasedAppSettings=function(t){e._areRoamingAppsEnabled=Boolean.parse(t.RoamingAppsAreEnabled||"false"),e.baseDocQuerySignatureWithoutVersion=t.BaseDocQuerySignatureWithoutVersion||"",Boolean.parse(t.UpdateRootQuerySignatureInMiniCheck||"false")&&(e._rootQuerySignature=t.RootQuerySignature||e.baseDocQuerySignatureWithoutVersion),e._requiresCheckout=Boolean.parse(t.RequiresCheckout||"false"),e.suppressHelp=Boolean.parse(t.SuppressHelp||"false"),e.showFeedbackButton=Boolean.parse(t.ShowFeedback||"false"),e.feedbackDescription=t.FeedbackDescription||"",e.webEditingEnabled=Boolean.parse(t.WebEditingEnabled||"true"),e.needsSignOutChecking=Boolean.parse(t.NeedsSignOutChecking||"false"),e.accessTokenParamName=t.AccessTokenParam||"access_token",e.limitedEdit=Boolean.parse(t.LimitedEdit||"false"),e.hostAuthenticatesUsersDuringOpenInClient=Boolean.parse(t.HostAuthenticatesUsersDuringOpenInClient||"false"),e.fileName=t.FileName||"",e._isSkyDrive=Boolean.parse(t.IsSkyDrive||"false"),e._isTellMeUpSellEnterpriseEnabled=Boolean.parse(t.IsTellMeUpSellEnterpriseEnabled||"false"),e.flightId=t.FlightId||"",e.userName=t.UserName||"",e.userNameUnknown=Boolean.parse(t.UserNameUnknown||"false"),e._newDocumentDestinationHost=t.NewDocumentDestinationHost,e._isNewDocumentTemplateUIEnabled=Boolean.parse(t.IsNewDocumentTemplateUIEnabled||"false"),e._readFromMruIsEnabled=Boolean.parse(t.ReadFromMruIsEnabled||"false"),e._openMenuBrowseMoreHostUrl=t.OpenMenuBrowseMoreHostUrl,e._openMenuBrowseMoreHostName=t.OpenMenuBrowseMoreHostName,e._updateMruIsEnabled=Boolean.parse(t.UpdateMruIsEnabled||"false"),e._supportsGetMoreInfoForPersonalStorage=Boolean.parse(t.SupportsGetMoreInfoForPersonalStorage||"false"),e.protectFile="true"===t.ProtectInClient,e.protectedFile="true"===t.ProtectedFile,e.appSettingsManager.getBooleanAppSetting("AddInsInSupportedIrmDocsIsEnabled")&&(e.enableMacrosForProtectedFile="true"===t.EnableMacrosForProtectedFile),e.shouldShowSwitcher=Boolean.parse(t.ShouldShowSwitcher||"false"),e.bootAppFromMiniCheck=Boolean.parse(t.BootAppFromMiniCheck||"false"),e.useMiniCheckedDocumentParam=t.UseMiniCheckedDocumentParam||"",e._hideAppsExtensionUrl=t.HideAppsExtensionUrl||"",e.wopiIdentityWhitelist=(t.WopiIdentityWhitelist||"").split(",")},s.crashApplication=function(){null.crash()},s.getSignInParams=function(){return{}},s.getCopyAndEditParams=function(){return{}},s.getFileNewProperties=function(){return null},s.addSwitcherHtmlToDom=function(t){if(!document.getElementById("sw_bar")){var n=t.SwitcherHtml,i=t.SwitcherLocalizedCss;if(n&&i){var r=document.getElementById(e.applicationOuterContainerId),a=document.createElement("div");for(a.innerHTML=n;a.firstChild;)r.appendChild(a.removeChild(a.firstChild));var o=document.createElement("div");for(o.innerHTML=i;o.firstChild;)r.appendChild(o.removeChild(o.firstChild))}}},s.initializeBrowserSqm=function(t){var n,i=!1,a=t.WsaData,o=(n=a?Object(r.a)("("+a+")"):{}).Dispatcher;o&&(i=n.Enabled);var s=n.SqmQoSEnabled,l=n.SqmQoSDataPoints;if(e.theWsaClient=new de(o,i,s,l),i||s){var c=n.StartTime;e.theWsaClient.updateStartTime(c),e.theWsaClient.createStream(C.ribbonStreamId,1,C.ribbonStreamWidth,X.defaultMaxStreamRows),e.theWsaClient.createStream(9134,1,3,X.defaultMaxStreamRows),e.theWsaClient.createStream(e.documentStreamId,1,e.documentStreamWidth,X.defaultMaxStreamRows),g.a.shouldRegisterOtelListener(e.sessionStartInfoSettings.Application||"unknownApp")&&e.theActionManager.registerListener(this.getOtelActionListener()),e.theActionManager.registerListener(this.getWsaListener());var u=parseInt(t.OfficeApplicationId||"0");e.theWsaClient.addCommonDatapoint(59),e.theWsaClient.addCommonDatapoint(e.officeApplicationModeDatapointId),e.theWsaClient.addCommonDatapoint(8491),e.theWsaClient.addCommonDatapoint(11030),e.theWsaClient.addCommonDatapoint(9104),e.theWsaClient.addCommonDatapoint(9902),e.theWsaClient.setDw(59,u),e.theWsaClient.setDw(8491,e.lcid);var d=n.InitialDP;0;for(var p=0;p<d.length;p+=2)e.theWsaClient.setDw(d[p],d[p+1]);if("undefined"!=typeof window.__startTime){var h=window.__startTime;e.theWsaClient.setDw(9085,e.bootTime-h.getTime())}e.theWsaClient.setDw(11030,1440-(new Date).getTimezoneOffset());var m=n.FlightId;e.theWsaClient.setFlightId(m)}},s.initializeDefaultErrorHandler=function(e,t,n){void 0===n&&(n=!1),e&&e.init(t,this.officeAppType,this.officeAppMode,n)},s.getWsaListener=function(){return C.getInstance()},s.getOtelActionListener=function(){return b.getInstance()},s.reportEventInterruptedJavascript=function(e){0},s.onAuthenticationLost=function(t,n,i,r,a){return e._wasAuthenticationLostDuringSession=!0,32},s.onAuthenticationRestored=function(e,t,n,i,r){return 32},s.logSessionEndData=function(){e._logSessionEndDataCalled||(e._logSessionEndDataCalled=!0,g.a.isEnabledLogSessionStartAndEndDataFromClientToOTel(e.sessionStartInfoSettings.Application||"unknownApp")&&e.sessionStartAndEndData.logSessionEndData())},s.dispose=function(){v.ULS.sendTraceTag(40207748,306,50,"In Dispose"),e.appSettingsManager.getBooleanAppSetting("LogBootPerfMetricsOnAppDisposeIsEnabled")&&fe.a.instance.log(),this.logSessionEndData(),e.isShuttingDown=!0,e.eventSource.raiseEvent(e.shuttingDownEventKey),e.theWsaClient&&(e.theWsaClient.terminate(),e.theWsaClient=null),Ze.a(e._activeFrame),e._activeFrame=null,e._splashscreenElement=null,e._splashscreenOverlay=null,e.theClientRequestManager=null,this.shutdownOtel(),B.Health.instance.shutdown(),Ze.a(e.theUlsHost),K.FocusManager.disposeInputManager(),j.a.disposeInputManager(),H.a.disposeInputManager(),W.a.disposeInputManager(),Z.a.disposeInputManager(),G.a.disposeInputManager(),Q.a.disposeInputManager(),q.KeyInputManager.disposeInputManager(),N.a.disposeInputManager(),V.EventHandlerManager.disposeInputManager(),xe.a.dispose(),we.a.instance.dispose(),lt.a.instance.stop(),e.theActionManager=null,e.theWacAirSpaceEngine=null,e.theUlsHost=null},s.resolveActionId=function(e){return Fe.a.getNameFromId(e)},s.resolveContextId=function(e){return st.a.getNameFromId(e)},s.resolveCommandId=function(e){return null},s.handleEditInBrowser=function(){0},s.handleGiveFeedback=function(){0},s.refreshReactRibbonModeCookie=function(){},s.getSliceForCommand=function(e){return null},s.createAppSettingsManager=function(e){return new I.a(e)},s.getAppChromePromise=function(e){return void 0===e&&(e=!0),Promise.reject("getAppChromeLoadedPromise not overridden")},e.get_createdPageNodeIDs=function(){return e._createdPageNodeIDs||(e._createdPageNodeIDs=new Set),e._createdPageNodeIDs},e.updatePageRtl=function(t){var n;if(t?(Sys.UI.DomElement.addCssClass(document.body,"AppRtl"),n="rtl"):(Sys.UI.DomElement.removeCssClass(document.body,"AppRtl"),n="ltr"),e.isDivSyndicated)for(var i=e.getRegisteredFrames(),r=0,a=i.length;r<a;r++)i[r].getDOMElement().dir=n;else document.body.dir=n,document.documentElement.dir=n},e.get_wopiIdentityWhitelist=function(){return e.wopiIdentityWhitelist},e.get_wopiTokenRefreshNetworkErrorIdList=function(){return e.wopiTokenRefreshNetworkErrorIdList},e.get_wopiTokenRefreshPermanentHostErrorIdList=function(){return e.wopiTokenRefreshPermanentHostErrorIdList},e.get_wopiTokensToRefresh=function(){return e.wopiTokensToRefresh},e.registerFrame=function(t){var n=t.get_element().id;e._registeredFrames[n]||(e._registeredFrames[n]=t,Array.add(e._registeredFramesArray,t)),F.a.instance.runFeatureChecks(e.appSettingsManager)},e.unRegisterFrame=function(t){t&&(e._registeredFrames[t],Array.remove(e._registeredFramesArray,e._registeredFrames[t]),delete e._registeredFrames[t])},e.getRegisteredFrames=function(){return e._registeredFramesArray},e.get_bulsSizeThresholdBytes=function(){return e.bulsSizeThresholdBytes},e.isInsertOnlinePictureFromHostSupported=function(){return e.insertOnlinePictureFromHostEnabled&&(e.hostSupportsInsertOnlinePictureFromHost||e.isSkyDrive)&&e.appSupportsInsertOnlinePictureFromHost||e.appSupportsInsertOnlinePictureFromSharePoint},e.shouldUseEmulatedOneDriveHostForInsertOnlinePicture=function(){return!!e.activeFrame&&!!e.activeFrame.applicationInstance&&4===e.activeFrame.applicationInstance.officeAppType||e.appSupportsInsertOnlinePictureFromSharePoint||e.insertOnlinePictureFromHostEnabled&&e.appSupportsInsertOnlinePictureFromHost&&e.appSettingsManager.getBooleanAppSetting("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled")&&e.isSkyDrive&&!e.hostSupportsInsertOnlinePictureFromHost},e.isRenameSupported=function(){return e.hostSupportsFileRename&&e.appSupportsFileRename},e.isVersionHistorySupported=function(){return e.hostSupportsVersionHistory&&e.appSupportsVersionHistory&&!e.protectFile},e.initializeBulsProperties=function(t){e.browserUlsIsEnabled=Boolean.parse(t.BrowserUlsIsEnabled||"false");var n=parseInt(t.BulsSizeThresholdBytes||"0");n&&(e.bulsSizeThresholdBytes=n),e.bulsUploadMaxSize=parseInt(t.BulsUploadMaxSize||"0"),e.browserUlsTraceLevel=parseInt(t.BrowserUlsTraceLevel||"0"),e.logCanaryInBrowser=Boolean.parse(t.LogCanaryInBrowser||"false")},e.requestCookieConsent=function(){nt.a.instance.requestConsentWithSettings((function(){var t=document.getElementById(e.externalHeaderPanelId);return Object.assign(new CookieComplianceSettings(e.appSettingsManager.getListAppSetting("MSCCCookies")),{markup:e.appSettingsManager.getStringAppSetting("MSCCMarkup"),bannerParent:t?t.parentNode:document.body,addHandler:z.a.addHandler,onConsentRequested:function(){var t=document.getElementById(e.applicationOuterContainerId);t&&(t.style.position="relative",t.style.width="100%",t.style.height="100%")},rootDomain:e.appSettingsManager.getStringAppSetting("WacRootDomain")})}))},e.logFunctionWithBadCast=function(e){v.ULS.sendTraceTag(5256782,201,50,"Bad cast in "+e)},e.logMSAjaxError=function(e){v.ULS.sendTraceTag(594342682,201,10,e)},e.logMSAjaxInfo=function(e){v.ULS.sendTraceTag(588906697,209,50,e)},e.scriptUrlFromName=function(t,i){var r;return r=U.a.instance.isEnabled?function(e,t,i,r,a,o){return n(1).AFrameworkApplication.appSettingsManager&&n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SubresourceIntegrityIsEnabled")?Ce(e,t,i,r,a,o):Se(e,t,i,r,a,o)}(t,i,e.scriptBase,e.staticContentScriptNameBase,e.lcid,R.a.staticContentQueryParameter):function(e,t,i,r,a,o){if(4===t)return e;var s=r,l=".js"+o,c=e+l;switch(t){case 0:var u=be(i)+c;n(1).AFrameworkApplication.appSettingsManager&&n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OverrideBaseUrlForDullscript_v2")?s="https://localhost:8080/"+u.replace("debug.","Debug."):s+=u;break;case 1:s+=i+c;break;case 2:s+=String.format("{0}{1}{2}",e,".min",l);break;case 3:s+=String.format("{0}\\{1}",a,c);break;case 5:var d=o;e.indexOf("?")>=0&&(d=o.replace("?","&")),s+=String.format("{0}{1}",e,d)}return s}(t,i,e.scriptBase,e.staticContentScriptNameBase,e.lcid,R.a.staticContentQueryParameter),r=e.getBrotliResourceUrl(r),ye.b(51225436,200,100,"ScriptUrlFromName for {0} is {1}",t,r),r},e.sriHashFromName=function(t,n){var i=null,r=null;return U.a.instance.isEnabled&&e.appSettingsManager.getBooleanAppSetting("SubresourceIntegrityIsEnabled")&&(r=Ae(t,n,e.scriptBase,e.lcid,R.a.staticContentQueryParameter),i=U.a.instance.getSriHash(e.scriptFolderPath+r)),ye.b(574493713,200,100,"SriHash for {0} is {1}",r,i),i},e.getBrotliResourceUrl=function(t){return e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting(e.isBrotliSupportedSettingName)&&(t.endsWith(e.cssExtension)?t.replace(e.cssExtension,e.brotliExtension+e.cssExtension):t.endsWith(e.jsExtension)&&t.replace(e.cssExtension,e.brotliExtension+e.jsExtension),ye.b(51389006,200,50,"Returning brotli compressed url {0}",t)),t},e.createNumberFormat=function(){var t=new pe;return void 0!==e.appSettingsManager.appSettings.NegativeSign&&null!==e.appSettingsManager.appSettings.NegativeSign&&(t.negativeSign=e.appSettingsManager.appSettings.NegativeSign,t.numberDecimalDigits=parseInt(e.appSettingsManager.appSettings.NumberDecimalDigits),t.numberDecimalSeparator=e.appSettingsManager.appSettings.NumberDecimalSeparator,t.numberGroupSeparator=e.appSettingsManager.appSettings.NumberGroupSeparator,t.numberGroupSizes=e.getGroupSizesArrayFromString(e.appSettingsManager.appSettings.NumberGroupSizes),t.numberNegativePattern=parseInt(e.appSettingsManager.appSettings.NumberNegativePattern),t.percentDecimalDigits=parseInt(e.appSettingsManager.appSettings.PercentDecimalDigits),t.percentDecimalSeparator=e.appSettingsManager.appSettings.PercentDecimalSeparator,t.percentGroupSeparator=e.appSettingsManager.appSettings.PercentGroupSeparator,t.percentGroupSizes=e.getGroupSizesArrayFromString(e.appSettingsManager.appSettings.PercentGroupSizes),t.percentNegativePattern=parseInt(e.appSettingsManager.appSettings.PercentNegativePattern),t.percentPositivePattern=parseInt(e.appSettingsManager.appSettings.PercentPositivePattern),t.percentSymbol=e.appSettingsManager.appSettings.PercentSymbol),t},e.getGroupSizesArrayFromString=function(e){for(var t=e.split(","),n=t.length,i=new Array(n),r=0;r<n;r++)i[r]=parseInt(t[r]);return i},e.add_appSleep=function(t){e.eventSource.addHandler("ASEK",t)},e.remove_appSleep=function(t){e.eventSource.removeHandler("ASEK",t)},e.add_appWakeup=function(t){e.eventSource.addHandler("AWEK",t)},e.remove_appWakeup=function(t){e.eventSource.removeHandler("AWEK",t)},e.add_isHostFrameTrustedSet=function(t){e.eventSource.addHandler("IHFTSEK",t)},e.remove_isHostFrameTrustedSet=function(t){e.eventSource.removeHandler("IHFTSEK",t)},e.ensureAwakeIfAsleep=function(){e.isSleeping&&e.ensureAwake()},e.ensureAwake=function(){if(isFinite(e._sleepIntervalInMsec)){var t=e._theAppSleepTask;e._theAppSleepTask=null,e.isSleeping=!1,t&&e.theTaskManager.deleteTask(t),e._theAppSleepTask=new Re.a(3,1,e._sleepIntervalInMsec,e.putApplicationToSleep,21),e.theTaskManager.addTask(e._theAppSleepTask)}},e.putApplicationToSleep=function(t){e.isSleeping=!0,e._theAppSleepTask=null},e.isSplashScreenUp=function(){return e._isSplashScreenUp},e.dismissSplashScreen=function(){e._isSplashScreenUp&&(D.f(e._splashscreenElement,null,e.onAfterDismissSplashScreen),D.f(e._splashscreenOverlay,null,e.onAfterDismissSplashScreenOverlay))},e.dismissSplashScreenImmediately=function(){e.setSplashScreenInvisible(),e.setSplashScreenOverlayInvisible()},e.dismissSplashScreenOverlay=function(){e._isSplashScreenUp&&D.f(e._splashscreenOverlay,null,e.onAfterDismissSplashScreenOverlay)},e.registerOnAfterSplashScreenDismissed=function(t){Array.add(e._splashScreenDismissedCallbacks,t)},e.runSplashScreenDismissedCallbacks=function(){for(var t=0;t<e._splashScreenDismissedCallbacks.length;++t){(0,e._splashScreenDismissedCallbacks[t])()}},e.showSplashScreen=function(t){void 0===t&&(t=!1),(!e._isSplashScreenUp||t)&&e._splashscreenElement&&e._splashscreenOverlay&&(e._isSplashScreenUp=!0,e._splashscreenElement.style.display="flex",e._splashscreenOverlay.style.display="block",e._splashscreenOverlay.setAttribute(Ge.a.ariaHiddenAttribute,Ge.a.ariaFalseValue),Ye.a.setOpacity(e._splashscreenElement,100),Ye.a.setOpacity(e._splashscreenOverlay,70))},e.onAfterDismissSplashScreen=function(t){e.setSplashScreenInvisible()},e.onAfterDismissSplashScreenOverlay=function(t){e.setSplashScreenOverlayInvisible()},e.setSplashScreenInvisible=function(){e._splashscreenElement&&(e._splashscreenElement.style.display="none"),e._isSplashScreenUp&&(e.clearAriaLoadingAttributes(),e.runSplashScreenDismissedCallbacks()),e._isSplashScreenUp=!1},e.clearAriaLoadingAttributes=function(){var t=document.getElementById(e.applicationOuterContainerId);t&&(t.removeAttribute(Ge.a.ariaHiddenAttribute),t.removeAttribute(Ge.a.ariaBusyAttribute))},e.setSplashScreenOverlayInvisible=function(){e._splashscreenOverlay&&(e._splashscreenOverlay.style.display="none",e._splashscreenOverlay.setAttribute(Ge.a.ariaHiddenAttribute,Ge.a.ariaTrueValue))},e.reportError=function(t,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),e.reportErrorWithCauseAndResolution(t,O.a.unknownCause,O.a.unknownResolution,n,i,r)},e.add_errorDialogDisplayed=function(t){e.eventSource.addHandler(e.errorDialogDisplayedEventKey,t)},e.remove_errorDialogDisplayed=function(t){e.eventSource.removeHandler(e.errorDialogDisplayedEventKey,t)},e.reportErrorWithCauseAndResolution=function(t,n,i,r,a,o){void 0===r&&(r=null),void 0===a&&(a=null),void 0===o&&(o=null),e._appEncounteredFirstError||(e._appEncounteredFirstError=!0,A.a.get_instance().isCompleted(13)||(A.a.get_instance().setAppInitializationStatus(13),v.ULS.sendTraceTag(42000463,306,50,"App encountered its first error so updating app init status")));var s=Object.assign(new x,{errorCode:t,errorCause:O.a.unknownCause,errorResolution:O.a.unknownResolution});if(e.eventSource.raiseEvent(e.errorDialogDisplayedEventKey,s),e.theWsaClient&&(e.theWsaClient.addToStreamDw(9134,t,n,i),!e._checkedForBootError&&t!==O.a.openInClientFailed&&t!==O.a.openInClientOffice14Required&&t!==O.a.openInClientWithC2RFailed&&t!==O.a.openInClientSecondaryFailed&&t!==O.a.downloadFailed&&t!==O.a.unexpectedPostMessage&&t!==O.a.roamingControlMissing)){var l=new Date;(!e._reportedRenderTime||l.getTime()-e._renderTime.getTime()<1e3)&&e.theWsaClient.setDw(10459,t),e._checkedForBootError=!0}L.a.recordBSqmQosError(t.toString(),r,a,o)},e.subscribeToBeforeAppShutDown=function(t){e.add_beforeAppShutDown((function(e,n){try{t(e,n)}catch(e){v.ULS.shipAssertTag(7448661,201,!1,e.toString())}}))},e.add_beforeAppShutDown=function(t){e.eventSource.addHandler(e.shuttingDownEventKey,t)},e.remove_beforeAppShutDown=function(t){e.eventSource.removeHandler(e.shuttingDownEventKey,t)},e.logFlightedSettingUsage=function(t){var n=String.format('The flighted setting has impacted the experience: {{"SettingType":"{0}"}}',t);v.ULS.sendTraceTag(5566927,306,50,n),e.loggedFligtingTypes[t]=!0},e.reportRenderTime=function(t,n){if(void 0===t&&(t=null),void 0===n&&(n=!0),!e._reportedRenderTime){var i;if(e._reportedRenderTime=!0,e._renderTime=t||new Date,"undefined"!=typeof window.__startTime){var r=window.__startTime;i=e._renderTime.getTime()-r.getTime()}else i=1e9;n&&e.theWsaClient.setDw(9086,i),v.ULS.sendTraceTag(6320966,345,50,"Legacy RenderTime (ms): {0}",i)}},e.sendIsFrameTrustedMessage=function(){e._hostFrameTrustCheckIsEnabled&&!e._isFrameTrustedMessageInitiated&&(e.get_hostPostmessengerFuture().execute((function(t){t.addAllowedReceivingMessage(rt.a.host_IsFrameTrusted),t.registerCallback(rt.a.host_IsFrameTrusted,e.receivedIsFrameTrustedMessage),e.sendIsFrameTrustedMessageWithRetry(t)})),e._isFrameTrustedMessageInitiated=!0)},e.sendIsFrameTrustedMessageWithRetry=function(t,n){if(void 0===n&&(n=0),2===e.isHostFrameTrusted){if(n>3)return void v.ULS.sendTraceTag(577816406,306,50,"No retries remaining.");t.sendMessage(rt.a.app_IsFrameTrusted,null),n++,window.setTimeout((function(){e.sendIsFrameTrustedMessageWithRetry(t,n)}),5e3)}},e.receivedIsFrameTrustedMessage=function(t){if(e._hostFrameTrustCheckIsEnabled&&3!==e.isHostFrameTrusted){0;var n=t.Values[it.a.isTopFrameTrusted],i=!!n&&Boolean.parse(n.toString()||"false");if(e._hostAllowlistCheckIsEnabled&&!i)if(t.Values.m_Origin){var r=Je.a.getHostname(t.Values.m_Origin.toString());i=e.isHostAllowlistedForAddIns(r)}else v.ULS.sendTraceTag(576583125,306,15,"Messsage origin is null");e.isHostFrameTrusted=i?5:4}},e.isHostAllowlistedForAddIns=function(t){if(!t)return!1;var n=new RegExp(e._hostAllowlistForAddIns).exec(t);return n&&n.length>=1?(v.ULS.sendTraceTag(578945939,306,50,"IsHostFrameTrusted set true via Allowlist check:{0}",t),!0):(v.ULS.sendTraceTag(576583126,306,50,"IsHostFrameTrusted set false via Allowlist check:{0}",t),!1)},e.sendSetOverlayContentMessage=function(t){e._successfullySetOverlayContent||e.get_hostPostmessengerFuture().execute((function(n){var i;n.addAllowedReceivingMessage(rt.a.setOverlayContent),n.registerCallback(rt.a.setOverlayContent,e.receivedSetOverlayContentMessage),n.sendMessage(rt.a.setOverlayContent,((i={}).overlayContent=t,i))}))},e.receivedSetOverlayContentMessage=function(t){e._successfullySetOverlayContent=!0},e.reportDocumentLoadedTime=function(t,n){void 0===t&&(t=null),void 0===n&&(n=!1),e._reportedLoadTime||(e._reportedLoadTime=!0,A.a.get_instance().setAppInitializationStatus(n?9:8)),e.documentLoadedTime=t||new Date,ve.a.instance.recordDocumentLoadedTime(e.documentLoadedTime.getTime()),e.get_hostPostmessengerFuture().execute((function(t){t.reportDocumentLoadedTime(e.documentLoadedTime.getTime())}))},e.get_hostPostmessengerFuture=function(){return e._hostPostmessengerFuture||(e._hostPostmessengerFuture=ot.a.instance.resolveFuture("Postmessage.IHostPostmessenger"))},e.set_hostPostmessengerFuture=function(t){return e._hostPostmessengerFuture=t,t},e.reportInitialUi=function(t){var n;e._reportedInitialUi||(e._reportedInitialUi=!0,n=t?1:2,e.theWsaClient.setDw(10309,n))},e.getSessionIdQueryParam=function(){return e.userSessionIdQueryParam+"="+S.a.urlKeyValueEncode(e.userSessionId)},e.getLogHostRequestQueryParam=function(){return e.logHostRequestsQueryParam+"="+e.logHostRequestsQueryValue},e.getBrowserBuildRequestQueryParam=function(){return e.browserBuildQueryParam+"="+S.a.urlKeyValueEncode(e.buildVersion)},e.getWacClusterQueryParam=function(){return e.theClientRequestManager&&e.theClientRequestManager.wacClusterId?et.a.wacClusterQsName+"="+e.theClientRequestManager.wacClusterId:null},e.getWacUserAgentQueryParam=function(){return e.theClientRequestManager&&e.theClientRequestManager.wacUserAgent?et.a.wacUserAgentQsName+"="+e.theClientRequestManager.wacUserAgent:null},e.addCommonUrlParameters=function(t){e.ensureCommonUrlParameters(Object(r.d)(t,t.addFullParam,"addFullParam"))},e.addOrReplaceCommonUrlParameters=function(t){e.ensureCommonUrlParameters(Object(r.d)(t,t.addOrReplaceFullParam,"addOrReplaceFullParam"))},e.ensureCommonUrlParameters=function(t){e.userSessionId&&t(e.getSessionIdQueryParam()),e.isLoggingHostRequests&&t(e.getLogHostRequestQueryParam()),e.buildVersion&&t(e.getBrowserBuildRequestQueryParam());var n=e.getWacClusterQueryParam();n&&t(n);var i=e.getWacUserAgentQueryParam();i&&t(i)},e.showRequiresSignInDialog=function(){var e=new Ke.StandardDialog;e.buttonsOption=0,e.setButtonText(1,CommonUIStrings.l_DialogClose),e.messageBox(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NeedToSignIn,3,null)},e.showOpenInAppDialog=function(t){(void 0===t&&(t=""),e.isMobileMode)&&new Ve(t).initializeAndShowDialog()},e.disableControllerServicesViaQueryParam=function(){e._isControllerServicesQueryParamNeeded=!0},e.enableControllerServicesViaQueryParam=function(){e._isControllerServicesQueryParamNeeded=!1},e.loadTestFrameworkIfRequested=function(){e.shouldDownloadTestFramework()&&(Ue.a.loadTestHarness(),e.suppressCrashDialog=!0,d.Debug.debugSettings.assertHandler=d.Debug.reportAssertToTestHarness)},e.shouldDownloadTestFramework=function(){var e=function(e){try{return sessionStorage.getItem(e)}catch(e){return null}};return""!==Ue.a.webToadHostName&&Ue.a.isBrowserUnderWebToadRun(window.location.href,e)},e.registerTestHarnessErrorHandler=function(t){e._testHarnessOnErrorCallback=t},e.tryReportErrorToTestHarness=function(t){return!!e._testHarnessOnErrorCallback&&(e._testHarnessOnErrorCallback(t),!0)},e.logUniqueFlightedSettingUsage=function(t){t in e.loggedFligtingTypes||e.logFlightedSettingUsage(t)},e.isMultiTouchGestureEnabled=function(){return!!e.appSettingsManager&&(e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureIsEnabledForVisio")||e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureChromeIsEnabled")&&he.a.isChrome||e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureNonChromeIsEnabled")&&!he.a.isChrome)},e.isPinchToZoomEnabled=function(){return!!e.appSettingsManager&&(e.appSettingsManager.getBooleanAppSetting("PinchZoomIsEnabled")||e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureChromeIsEnabled")&&he.a.isChrome||e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureNonChromeIsEnabled")&&!he.a.isChrome)},e.isScheduledShutdownEnabled=function(){return!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("SessionExpirationDueToScheduledShutdownIsEnabled")},e.shouldUseChromeExtension=function(){return!!e.appSettingsManager&&(!(he.a.isChromiumEdge&&(e.appSettingsManager.getBooleanAppSetting("ChromiumEdgeUIPasteForWordIsEnabled")||e.appSettingsManager.getBooleanAppSetting("ChromiumEdgeUIPasteForPPTIsEnabled")||e.appSettingsManager.getBooleanAppSetting("ChromiumEdgeUIPasteForOneNoteIsEnabled"))&&he.a.supportsExecCommandPaste)&&e.appSettingsManager.getBooleanAppSetting("ChromeClipboardAccessIsEnabled"))},e.shouldUsePasteHandlerForUIPaste=function(){return!!e.appSettingsManager&&(!(!e.isSupportedBrowserForPasteHandlerUIPaste||!he.a.supportsExecCommandPaste)&&(e.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordUsePasteHandlerForUIPasteSettings"),!!e.appSettingsManager.getBooleanAppSetting("UsePasteHandlerForUIPasteIsEnabled")))},e.shouldUsePasteHandlerForUIPasteTextOnly=function(){return!!e.appSettingsManager&&(!(!e.isSupportedBrowserForPasteHandlerUIPaste||!he.a.supportsExecCommandPaste)&&(e.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordUsePasteHandlerForUIPasteTextOnlyIsEnabledSettings"),!!e.appSettingsManager.getBooleanAppSetting("UsePasteHandlerForUIPasteTextOnlyIsEnabled")))},t=e,o=[{key:"documentLoadedTime",get:function(){return e._documentLoadedTime},set:function(t){e._documentLoadedTime=t,e.theActionManager.processAction(Fe.a.documentLoaded,2)}},{key:"rootQuerySignature",get:function(){return e._rootQuerySignature}},{key:"disableEditIfAndroid",get:function(){return 2===e.activeFrame.applicationInstance.officeAppType?!!he.a.isAndroid&&!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("EnablePowerPointOnlineEditorForAndroid"):!!he.a.isAndroid&&!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("DisableEditEntryPointsFromViewerForAndroid")}},{key:"numberFormat",get:function(){return e._numberFormat||(e._numberFormat=e.createNumberFormat())}},{key:"theActionManager",get:function(){return e._theActionManager||(e._theActionManager=new a.ActionManager(ot.a.instance.resolveFuture("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")))},set:function(t){e._theActionManager=t}},{key:"theTaskManager",get:function(){return xe.a.instance}},{key:"extraErrorInfoFromHost",get:function(){return e._extraErrorInfoFromHost}},{key:"latestActivityTime",get:function(){return e._latestActivityTime},set:function(t){e._latestActivityTime=t}},{key:"activeFrame",get:function(){if(!e._activeFrame){var t=e.getRegisteredFrames();e._activeFrame=t[0]}return e._activeFrame},set:function(t){e._activeFrame=t}},{key:"canExecuteCloseAction",get:function(){return e.isCloseable&&!!e.theActionManager&&32===e.theActionManager.processAction(Fe.a.close,1)}},{key:"isRtl",get:function(){return e._isRtl},set:function(t){e._isRtl!==t&&(e._isRtl=t,e.updatePageRtl(e._isRtl))}},{key:"areRoamingAppsEnabled",get:function(){return e._areRoamingAppsEnabled}},{key:"wacFrameImplicitAuthTestInformation",get:function(){return e._wacFrameImplicitAuthTestInformation}},{key:"isWopiTokenRefreshWhenSessionExpiredEnabled",get:function(){return e._isWopiTokenRefreshWhenSessionExpiredEnabled}},{key:"isWopiTokenRefreshEnabled",get:function(){return e._isWopiTokenRefreshEnabled}},{key:"isWopiTokenRefreshCancelExpirationEnabled",get:function(){return e._isWopiTokenRefreshCancelExpirationEnabled}},{key:"wopiTokenExpiresAfterMinutes",get:function(){return e._wopiTokenExpiresAfterMinutes}},{key:"wopiTokenRefreshRetryeInterval",get:function(){return e._wopiTokenRefreshRetryeInterval}},{key:"wopiTokenRefreshRetryIntervalForClientNetworkIssue",get:function(){return e._wopiTokenRefreshRetryIntervalForClientNetworkIssue}},{key:"wopiTokenRefreshMaxRetryAttempts",get:function(){return e._wopiTokenRefreshMaxRetryAttempts}},{key:"wopiTokenExpirationPolicy",get:function(){return e._wopiTokenExpirationPolicy}},{key:"wopiTokenTaskItemPriority",get:function(){return e._wopiTokenTaskItemPriority}},{key:"wasAuthenticationLostDuringSession",get:function(){return e._wasAuthenticationLostDuringSession}},{key:"isCustomerFeedbackExternal",get:function(){return e._isCustomerFeedbackExternal}},{key:"closeWindowOnAppClose",get:function(){return e.closeButtonClosesWindow}},{key:"trimDownloadACopy",get:function(){return!e.downloadACopyUrl||he.a.isIPad||e.protectFile}},{key:"isDogfoodEnvironment",get:function(){return e._isDogfoodEnvironment}},{key:"environment",get:function(){return e._environment}},{key:"trimOICButtons",get:function(){return(!e.isOpenInClientEnabled||e.appSettingsManager.getBooleanAppSetting("OICAllowListIsEnabled")&&!(he.a.isWindows||he.a.isMac||he.a.isAndroid||he.a.isIPad||he.a.isIPhone))&&(void 0===e.docPropertiesProvider.openInClientCommandUrl||null===e.docPropertiesProvider.openInClientCommandUrl||""===e.docPropertiesProvider.openInClientCommandUrl)&&!e.useOpenInClientPostMessage&&e._trimOICButtonsIfUnavailable}},{key:"isEmbedded",get:function(){return e._isEmbedded}},{key:"isUIEmbedMode",get:function(){return e._isUIEmbedMode}},{key:"shouldHideToolbarOnViewerRedirect",get:function(){return e._shouldHideToolbarOnViewerRedirect}},{key:"isNoChrome",get:function(){return e._isNoChrome}},{key:"areThirdPartyAddInsAllowed",get:function(){return!e.protectedFile||e.enableMacrosForProtectedFile}},{key:"isSleeping",get:function(){return e._isSleeping},set:function(t){e._isSleeping!==t&&(e._isSleeping=t,e._isSleeping?e.eventSource.raiseEvent("ASEK"):e.eventSource.raiseEvent("AWEK"))}},{key:"isHostFrameTrusted",get:function(){return v.ULS.sendTraceTag(590444317,306,100,"IsHostFrameTrusted:{0}",e._isHostFrameTrusted),e._isHostFrameTrusted},set:function(t){if(v.ULS.sendTraceTag(592487892,306,50,"IsHostFrameTrusted:{0}",t),e._isHostFrameTrusted!==t){e._isHostFrameTrusted=t,4===e._isHostFrameTrusted&&v.ULS.sendTraceTag(51180616,306,15,"Host_IsFrameTrusted is NotTrusted");try{e.eventSource.raiseEvent("IHFTSEK",e._isHostFrameTrusted)}catch(e){v.ULS.sendTraceTag(595150338,306,10,"Exception while setting IsHostFrameTrusted:{0}",e)}}}},{key:"requiresCheckout",get:function(){return e._requiresCheckout}},{key:"imageClusterName",get:function(){return e._imageClusterName},set:function(t){e._imageClusterName=t}},{key:"imageClusterPath",get:function(){return e._imageClusterPath},set:function(t){e._imageClusterPath=t}},{key:"scriptFolderPath",get:function(){return e._scriptFolderPath},set:function(t){e._scriptFolderPath=t}},{key:"scriptBase",get:function(){return e._scriptBase},set:function(t){e._scriptBase=t}},{key:"currentBrowserSupportsCrossDomainAjax",get:function(){return tt.a.browserSupportsCrossDomainRequests}},{key:"accessToken",get:function(){return e._accessToken},set:function(t){e.isWopiTokenRefreshEnabled&&(e.baseDocQuerySignatureWithoutVersion&&(e.baseDocQuerySignatureWithoutVersion=Je.a.addOrReplaceParameterValueInQueryParams(e.baseDocQuerySignatureWithoutVersion,e.accessTokenParamName,encodeURIComponent(t))),e.currentFileBaseDocQuerySignatureWithoutVersion&&(e.currentFileBaseDocQuerySignatureWithoutVersion=Je.a.addOrReplaceParameterValueInQueryParams(e.currentFileBaseDocQuerySignatureWithoutVersion,e.accessTokenParamName,encodeURIComponent(t))),e.rootQuerySignature&&(e._rootQuerySignature=Je.a.addOrReplaceParameterValueInQueryParams(e.rootQuerySignature,e.accessTokenParamName,encodeURIComponent(t)))),e._accessToken=t}},{key:"accessTokenTtl",get:function(){return e._accessTokenTtl},set:function(t){e.isWopiTokenRefreshEnabled&&(e.baseDocQuerySignatureWithoutVersion&&(e.baseDocQuerySignatureWithoutVersion=Je.a.addOrReplaceParameterValueInQueryParams(e.baseDocQuerySignatureWithoutVersion,e.accessTokenTtlParamName,t.toString())),e.currentFileBaseDocQuerySignatureWithoutVersion&&(e.currentFileBaseDocQuerySignatureWithoutVersion=Je.a.addOrReplaceParameterValueInQueryParams(e.currentFileBaseDocQuerySignatureWithoutVersion,e.accessTokenTtlParamName,t.toString())),e.rootQuerySignature&&(e._rootQuerySignature=Je.a.addOrReplaceParameterValueInQueryParams(e.rootQuerySignature,e.accessTokenTtlParamName,t.toString()))),e._accessTokenTtl=t}},{key:"isSkyDrive",get:function(){return e._isSkyDrive}},{key:"hostNameToIncludeInSavedStatus",get:function(){return e._hostNameToIncludeInSavedStatus}},{key:"logHostRequestsQueryValue",get:function(){return e.isLoggingHostRequests?"1":"0"}},{key:"unifiedHeaderOfficeOnlineLogoWidth",get:function(){return e._unifiedHeaderOfficeOnlineLogoWidth}},{key:"newDocumentDestinationHost",get:function(){return e._newDocumentDestinationHost}},{key:"isNewDocumentTemplateUIEnabled",get:function(){return e._isNewDocumentTemplateUIEnabled}},{key:"isTellMeUpSellEnterpriseEnabled",get:function(){return e._isTellMeUpSellEnterpriseEnabled}},{key:"newMenuMoreTemplatesUrl",get:function(){return e._newMenuMoreTemplatesUrl}},{key:"isAppsForOfficeSingleSignOnSupportedOnHost",get:function(){return e._isAppsForOfficeSingleSignOnSupportedOnHost}},{key:"hideAppsExtensionUrl",get:function(){return e._hideAppsExtensionUrl}},{key:"isControllerServicesQueryParamNeeded",get:function(){return e._isControllerServicesQueryParamNeeded}},{key:"disableWholeAppsForOfficeFeature",get:function(){return e._disableWholeAppsForOfficeFeature}},{key:"documentIsFolder",get:function(){return e._documentIsFolder}},{key:"readFromMruIsEnabled",get:function(){return e._readFromMruIsEnabled}},{key:"mruPollingIntervalInMs",get:function(){return e._mruPollingIntervalInMs}},{key:"timeUntilInactiveInMs",get:function(){return e._timeUntilInactiveInMs}},{key:"openMenuBrowseMoreHostUrl",get:function(){return e._openMenuBrowseMoreHostUrl}},{key:"openMenuBrowseMoreHostName",get:function(){return e._openMenuBrowseMoreHostName}},{key:"supportsGetMoreInfoForPersonalStorage",get:function(){return e._supportsGetMoreInfoForPersonalStorage}},{key:"getMoreInfoRetryIntervalsInMs",get:function(){return e._getMoreInfoRetryIntervalsInMs}},{key:"cursorPinningIsEnabled",get:function(){return e._cursorPinningIsEnabled}},{key:"nativeSelectionAndContextMenu",get:function(){return e._nativeSelectionAndContextMenu}},{key:"freemiumUpsellMode",get:function(){if(!e.appSettingsManager.getBooleanAppSetting("FreemiumUpsellHeaderUIIsEnabled"))return 0;var t=3;switch(e.appSettingsManager.getStringAppSetting("FreemiumUpsellMode")){case"ShowUpsell":t=1;break;case"ShowBadge":t=2;break;case"ShowNothing":default:e.appSettingsManager.getBooleanAppSetting("FreemiumUpsellShowWhenPremiumStatusIsUnknown")&&(v.ULS.sendTraceTag(40739805,324,50,"Premium Status unknown. Defaulting to app setting"),t=1)}return t}},{key:"updateMruIsEnabled",get:function(){return e._updateMruIsEnabled}},{key:"wacCopyPasteShortcutDialogIsEnabled",get:function(){return e._wacCopyPasteShortcutDialogIsEnabled}},{key:"removeWacDialogKeyUpHandler",get:function(){return e._removeWacDialogKeyUpHandler}},{key:"isCookieBannerVisible",get:function(){return!!window.self.g_cookieBannerVisible}},{key:"newFileTemplateName",get:function(){return e._newFileTemplateName}},{key:"newFileTemplateLcid",get:function(){return e._newFileTemplateLcid}},{key:"instance",get:function(){return e._instance}},{key:"staticContentScriptNameBase",get:function(){return R.a.staticContentHost+e.scriptFolderPath}},{key:"loggedFligtingTypes",get:function(){return e._loggedFlightingTypes||(e._loggedFlightingTypes={})}},{key:"scheduledShutdownPromptSeconds",get:function(){return e.accessTokenExpirationPromptSeconds}},{key:"isSupportedBrowserForPasteHandlerUIPaste",get:function(){return null==e._isSupportedBrowserForPasteHandlerUIPaste&&(e._isSupportedBrowserForPasteHandlerUIPaste=he.a.isChromiumEdge||he.a.isElectron||he.a.isSafari12Up),e._isSupportedBrowserForPasteHandlerUIPaste}}],(i=[{key:"irmPolicyTitle",get:function(){return e._irmPolicyTitle}},{key:"irmPolicyDescription",get:function(){return e._irmPolicyDescription}},{key:"supportsFrameTrustCheck",get:function(){try{return-1!==window.location.href.toLowerCase().indexOf("&sftc=1")}catch(e){v.ULS.sendTraceTag(592487891,306,10,"Exception while getting SupportsFrameTrustCheck:{0}",e)}return!1}},{key:"isActivityTaskPaneWithNewInfrastructureEnabled",get:function(){return!1}},{key:"isRibbonFlexBoxLayoutEnabled",get:function(){return!1}},{key:"isSimplifiedReactRibbonUxEnabled",get:function(){return!1}},{key:"isReactMultilineRibbonEnabled",get:function(){return!1}},{key:"isReactStatusBarEnabled",get:function(){return!1}},{key:"isReactRibbonEnvironmentEnabled",get:function(){return this.isSimplifiedReactRibbonUxEnabled||this.isReactMultilineRibbonEnabled}},{key:"isShyRibbonEnabled",get:function(){return!1}},{key:"shouldRenderReactMultilineRibbon",get:function(){return!1}},{key:"delayInstallAddInIsEnabled",get:function(){return!1}},{key:"shouldResizeLegacyDialogBeforeFocus",get:function(){return!1}},{key:"isTelemetryForScriptsLoadedInSessionsWithSciptErrorEnabled",get:function(){return!1}},{key:"isReactSharedHeaderUxEnabled",get:function(){return e.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsWoncaHeaderRefactoringEnabled",!0)?!e.hideHeaderEmbedded:!(e.hideHeader||e.hideHeaderEmbedded)}},{key:"isSharedHeaderPlaceholderEnabled",get:function(){return!1}},{key:"isSharedHeaderSearchUxEnabled",get:function(){return!1}},{key:"isSharedHeaderVersionHistoryEnabled",get:function(){return!1}},{key:"isSharedHeaderThemingEnabled",get:function(){return!1}},{key:"isReactFileMenuUxEnabled",get:function(){return!1}},{key:"isReactFileMenuWithHomeEnabled",get:function(){return!1}},{key:"isReactRibbonTabRefreshEnabled",get:function(){return!1}},{key:"isReactFloatieEnabled",get:function(){return!1}},{key:"isReactTabbedTaskPaneInfrastructureEnabled",get:function(){return!1}},{key:"isTaskPaneResizingEnabled",get:function(){return!1}},{key:"isFirstPartyTaskPaneResizeEnabled",get:function(){return!1}},{key:"isReactDialogEnabled",get:function(){return!1}},{key:"isReactJustificationDialogEnabled",get:function(){return!1}},{key:"isReactFileUploadErrorDialogEnabled",get:function(){return!1}},{key:"isReactDialogWithLinkToResourceEnabled",get:function(){return!1}},{key:"isReactRefreshDialogEnabled",get:function(){return!1}},{key:"isReactCommercialPrivacyNoticeDialogEnabled",get:function(){return!1}},{key:"isReactCommercialTrustCenterDialogEnabled",get:function(){return!0}},{key:"isReactInsertFileDialogEnabled",get:function(){return!0}},{key:"isReactAccCheckerPaneEnabled",get:function(){return!1}},{key:"isReactNotificationsEnabled",get:function(){return!1}},{key:"isReactSmartLookupTaskPaneEnabled",get:function(){return!1}},{key:"isRegionComposerEnabled",get:function(){return!1}},{key:"isExperimentalBundleEnabled",get:function(){return!1}},{key:"isRibbonVisualRefreshEnabled",get:function(){return!1}},{key:"isChangesButtonEnabled",get:function(){return!1}},{key:"isTellMeServiceEdogEndpointOverrideEnabled",get:function(){return!1}},{key:"isTellMeServiceProdEndpointOverrideEnabled",get:function(){return!1}},{key:"isTellMeUseServiceForCommandClassifierEnabled",get:function(){return!1}},{key:"isTellMeServiceSendParameterInRequestBodyEnabled",get:function(){return!1}},{key:"isTellMeServiceResultsForSearchEnabled",get:function(){return!1}},{key:"isFindInDocumentWithMatchesEnabled",get:function(){return!1}},{key:"shouldFetchTokensForSearch",get:function(){return!1}},{key:"shouldShowAnswerSearchResults",get:function(){return!1}},{key:"shouldShowDefinitionSearchResults",get:function(){return!1}},{key:"shouldShowEntitySearchResults",get:function(){return!1}},{key:"shouldShowWolframSearchResults",get:function(){return!1}},{key:"shouldFindInDocWithMatchesOpenSerplet",get:function(){return!1}},{key:"shouldHelpShowNumberOfMatches",get:function(){return!1}},{key:"shouldHelpShowTopSearchResult",get:function(){return!1}},{key:"isTellMeInSharedHeaderEnabled",get:function(){return!1}},{key:"isTellMeNBCommandProviderEnabled",get:function(){return this.isReactRibbonEnvironmentEnabled&&e.appSettingsManager.getBooleanAppSetting("TellMeNBCommandProviderIsEnabled")&&"en-US"===e.uiCulture}},{key:"shouldHideChangesButtonInitially",get:function(){return!1}},{key:"isCommentsButtonInCollabCornerEnabled",get:function(){return!1}},{key:"isSimplifiedReactRibbonUxFlightEnabled",get:function(){return this.isSimplifiedReactRibbonUxEnabled}},{key:"isSimplifiedUXOptOutInViewTabFlightEnabled",get:function(){return!1}},{key:"isTransistionalHeaderUIEnabled",get:function(){return!1}},{key:"officeAppType",get:function(){return 0}},{key:"officeAppMode",get:function(){return 0}},{key:"clientUrl",get:function(){return""}},{key:"commandsToHostControlIdsMap",get:function(){return{}}},{key:"isSyncUxFeatureEnabled",get:function(){return!1}},{key:"newAndOpenHandlerUrlPrefix",get:function(){return""}},{key:"isFocusManagerBugFixEnabled",get:function(){return this._isFocusManagerBugFixEnabled}},{key:"catchUpFlyoutEnabled",get:function(){return!1}},{key:"diagnosticsBuildVersion",get:function(){return e.buildVersion}},{key:"diagnosticsSessionId",get:function(){return e.userSessionId}},{key:"isHttp2Enabled",get:function(){return this._isHttp2Enabled}},{key:"editMode",get:function(){return 0}},{key:"giveFeedbackOnOpenClient",get:function(){return!1}}])&&ut(t.prototype,i),o&&ut(t,o),e}();dt.documentStreamId=2096,dt.documentStreamWidth=9,dt.supportsViewingFlag="V",dt.supportsEditingFlag="E",dt.supportsCobaltFlag="C",dt.supportsPublishingFlag="P",dt.supportsEditingWithLocksFlag="L",dt.supportsReviewingFlag="R",dt.userSessionIdQueryParam="usid",dt.logHostRequestsQueryParam="loghostrequests",dt.browserBuildQueryParam="build",dt.officeApplicationModeDatapointId=8721,dt.modeSwitchTimeParamName="wdModeSwitchTime",dt.previousSessionParamName="wdPreviousSession",dt.sessionOriginParamName="wdOrigin",dt.correlationIdQueryParam="corrid",dt.uiHostParamName="uih",dt.invalidHostCanaryRedirectParamName="wdHCRedir",dt.controllerServicesParamName="wdccsoff",dt.hostUIControlSettingName="HostDefinedUIControls",dt.uiHostSettingName="UiHost",dt.consumptionSupportedParamName="csc",dt.isBrotliSupportedSettingName="IsBrotliSupported",dt.cssExtension=".css",dt.jsExtension=".js",dt.brotliExtension=".br",dt.postmessageFocusId="HostIntegrationMessaging",dt._renderTime=null,dt._latestActivityTime=new Date,dt._reportedRenderTime=!1,dt._checkedForBootError=!1,dt._reportedInitialUi=!1,dt._reportedLoadTime=!1,dt._appEncounteredFirstError=!1,dt._isUpdateFullSessionStartInfoCalled=!1,dt._createdPageNodeIDs=null,dt._documentLoadedTime=null,dt._rootQuerySignature=null,dt._registeredFrames={},dt._registeredFramesArray=[],dt._splashscreenElement=null,dt._splashscreenOverlay=null,dt._isSplashScreenUp=!0,dt._splashScreenDismissedCallbacks=[],dt._testHarnessOnErrorCallback=null,dt._numberFormat=null,dt.endSessionHeaderReceivedCallback=null,dt.theUlsHost=null,dt._theActionManager=null,dt.theClientRequestManager=null,dt.theWindowEventManager=null,dt.hostPostmessenger=null,dt.theWacAirSpaceEngine=null,dt.appSettingsManager=null,dt.theOfflineLogger=null,dt._extraErrorInfoFromHost=null,dt._activeFrame=null,dt._areRoamingAppsEnabled=!1,dt.privacyDialogText=null,dt.privacyDialogLinkText=null,dt.privacyDialogTitleText=null,dt.privacyDialogFwlinkId=null,dt.privacyCookieDomain=null,dt.mightNeedPrivacyDialog=!1,dt.privacyDialogShouldCheckRoaming=!1,dt.privacyDialogCanWriteServerSettings=!1,dt.privacyDialogCurrentVersion=0,dt.privacyDialogAlreadySeen=!1,dt.wopiIdentityWhitelist=null,dt.wacFrameImplicitAuthAADApplications=null,dt.wacFrameImplicitAuthMSAApplications=null,dt.wacFrameImplicitAuthMSAV2Applications=null,dt._wacFrameImplicitAuthTestInformation=null,dt.wopiTokenLastRefreshTime=0,dt._isWopiTokenRefreshWhenSessionExpiredEnabled=!1,dt._isWopiTokenRefreshEnabled=!1,dt._isWopiTokenRefreshCancelExpirationEnabled=!1,dt._wopiTokenExpiresAfterMinutes=0,dt._wopiTokenRefreshRetryeInterval=0,dt._wopiTokenRefreshRetryIntervalForClientNetworkIssue=0,dt.wopiTokenRefreshNetworkErrorIdList=null,dt.wopiTokenRefreshPermanentHostErrorIdList=null,dt._wopiTokenRefreshMaxRetryAttempts=0,dt.wopiTokensToRefresh=null,dt._wopiTokenExpirationPolicy=0,dt._wopiTokenTaskItemPriority=0,dt.wopiHostOriginFromPostMessage=null,dt.docPropertiesProvider=null,dt._isRtl=!1,dt.baseDocQuerySignatureWithoutVersion=null,dt.currentFileBaseDocQuerySignatureWithoutVersion=null,dt.buildVersion=null,dt.collectPageStats=!1,dt.showPageStats=!1,dt.suppressCrashDialog=!1,dt.suppressRetryFromCrashDialog=!1,dt.suppressRetryFromCrashDialogMessage=null,dt._wasAuthenticationLostDuringSession=!1,dt.suppressDebugCrashDialog=!1,dt.suppressCrashReportingToBSqm=!1,dt.suppressCrashReportingToWatson=!1,dt.appInitTime=new Date,dt.appPreloadStatistics="",dt.forceTouchRibbon=!1,dt.isReadOnlyRecommended=!1,dt.isInImmersiveReaderMode=!1,dt.hostOperationHttpStatusCode=0,dt.closeUrl=null,dt.useClosePostMessage=!1,dt.privacyUrl=null,dt.termsUrl=null,dt.filePropertiesUrl=null,dt.useFilePropertiesPostMessage=!1,dt.fileSharingUrl=null,dt.useFileSharingPostMessage=!1,dt.fileShareEnabled=!1,dt.workflowTypeString=null,dt.workflowUrl=null,dt.useWorkflowPostMessage=!1,dt.workflowEnabled=!1,dt.copyAndEditUrl=null,dt.useCopyAndEditPostMessage=!1,dt.useEditModePostMessage=!1,dt.useRedeemForCommentingPostMessage=!1,dt.useSignInCommandPostMessage=!1,dt.appCatalogUrl=null,dt.downloadACopyUrl=null,dt.directReadUrl=null,dt.directInvokeDAVUrl=null,dt.fileEmbedCommandUrl=null,dt.hostEmbeddedViewUrl=null,dt.hostEmbeddedEditUrl=null,dt.useFileEmbedCommandPostMessage=!1,dt.replyWithChangesUrl=null,dt.useReplyWithChangesPostMessage=!1,dt.isReplyWithChangesWorkFlow=!1,dt.fileVersionUrl=null,dt.useFileVersionPostMessage=!1,dt.useOpenInClientPostMessage=!1,dt.preferPostMessageOverCommandUrlForOpenInClient=!1,dt.addSessionIdToClientUrl=!1,dt.fileName=null,dt.sessionContext=null,dt.reportAbuseUrl=null,dt.limitedEdit=!1,dt.hostAuthenticatesUsersDuringOpenInClient=!1,dt.breadcrumbBrandName=null,dt.breadcrumbBrandUrl=null,dt.breadcrumbFolderName=null,dt.breadcrumbFolderUrl=null,dt.userName=null,dt.userNameUnknown=!1,dt.signoutUrl=null,dt.signInUrl=null,dt.hideHeader=!1,dt.isMobileMode=!1,dt.closeButtonClosesWindow=!1,dt.isCloseable=!1,dt.useParentHelpFunction=!1,dt.suppressHelp=!1,dt.showFeedbackButton=!1,dt.feedbackDescription=null,dt.hideHeaderEmbedded=!1,dt.isExtensionRequest=!1,dt.hideRibbonEmbedded=!1,dt.isConsumption=!1,dt.canSupportConsumption=!1,dt.feedbackStringId=0,dt._isCustomerFeedbackExternal=!1,dt.showRtcConnectionStatus=!1,dt.openInClientEditOnly=!1,dt.webEditingEnabled=!1,dt.downloadCopyOnOpenInClient=!1,dt.needsSignOutChecking=!1,dt.shortDateFormat=null,dt.shortTimeFormat=null,dt.roamingAppsX86RootUrl=null,dt.roamingAppsControlInstallerUrl=null,dt.roamingAppsFirefoxExtensionUrl=null,dt.isOpenInClientEnabled=!1,dt.userSessionId=null,dt.isLoggingHostRequests=!1,dt.firstRunExperienceIsEnabled=!1,dt.firstRunExperienceUiVariation=0,dt.assistanceIsEnabled=!1,dt.assistancePaneIsEnabled=!1,dt.assistanceSearchUrl=null,dt.copyLinkForTeamsIsEnabled=!1,dt.isUnifiedHostMode=!1,dt.tellMeIsEnabled=!1,dt.smartLookupIsEnabled=!1,dt.insightsIsEnabled=!1,dt.allowEarlyFeaturesForHost=!1,dt.insightsUrl=null,dt.enrichmentIsEnabled=!1,dt.enrichmentPaneUrl=null,dt.hostSupportsFileRename=!1,dt.hostSupportsVersionHistory=!1,dt.appSupportsFileRename=!1,dt.appSupportsVersionHistory=!1,dt.insertOnlinePictureFromHostEnabled=!1,dt.hostSupportsInsertOnlinePictureFromHost=!1,dt.appSupportsInsertOnlinePictureFromHost=!1,dt.appSupportsMultiInsertOnlinePictureFromHost=!1,dt.appSupportsInsertOnlinePictureFromSharePoint=!1,dt.userCanRename=!1,dt.renameInCoauthSessionWithRenameCapableClientsIsEnabled=!1,dt.documentTitleInputElement=null,dt.fileNameMaxLength=0,dt.renameFileTooltip=null,dt.rtcTransportProtocol=null,dt.peoplesWellIsEnabled=!1,dt._isDogfoodEnvironment=!1,dt._environment=0,dt.browserUlsIsEnabled=!1,dt.bulsUploadMaxSize=0,dt.bulsSizeThresholdBytes=null,dt.browserUlsTraceLevel=0,dt._trimOICButtonsIfUnavailable=!1,dt.suppressAppCloseOnNavigate=!1,dt.isOfficeTrialOfferEnabled=!1,dt.isMacOfficeTrialOfferEnabled=!1,dt.dialogClearerStringsIsEnabled=!1,dt.dialogDefaultEnterBehaviorIsEnabled=!1,dt.isShuttingDown=!1,dt.isShuttingDownFromPostMessage=!1,dt.requestedLcid=0,dt.lcid=0,dt.uiCulture=null,dt.dataCulture=null,dt.bootTime=0,dt.canary=null,dt.hostCanary=null,dt._isEmbedded=!1,dt._isUIEmbedMode=!1,dt._shouldHideToolbarOnViewerRedirect=!1,dt._isNoChrome=!1,dt.isDivSyndicated=!1,dt.shouldShowSwitcher=!1,dt.hasExternalHeader=!1,dt.lokiEndpointForSearch=null,dt.tellMeQueryIndexLoggingBaseUrl=null,dt.substrateEndpointForSearch=null,dt.tellMeServiceEndpointForSearch=null,dt.protectFile=!1,dt.protectedFile=!1,dt.enableMacrosForProtectedFile=!1,dt._irmPolicyTitle=null,dt._irmPolicyDescription=null,dt._isSleeping=!1,dt._isHostFrameTrusted=0,dt._hostFrameTrustCheckIsEnabled=!1,dt._hostAllowlistCheckIsEnabled=!1,dt._isFrameTrustedMessageInitiated=!1,dt._hostAllowlistForAddIns=null,dt._requiresCheckout=!1,dt._theAppSleepTask=null,dt._sleepIntervalInMsec=0,dt.isCrossDocumentMessengerDisabled=!1,dt.postMessageOrigin="",dt._imageClusterName=null,dt._imageClusterPath=null,dt._scriptFolderPath=null,dt._scriptBase=null,dt.requiresCrossDomainAjax=!1,dt._accessToken=null,dt.accessTokenParamName=null,dt._accessTokenTtl=0,dt.accessTokenTtlParamName="access_token_ttl",dt.accessTokenServerExpirationTime=0,dt.accessTokenExpirationPromptSeconds=0,dt.userType=null,dt.theDefaultErrorHandler=null,dt._isSkyDrive=!1,dt._hostNameToIncludeInSavedStatus=null,dt._unifiedHeaderOfficeOnlineLogoWidth=0,dt._newDocumentDestinationHost=null,dt._isNewDocumentTemplateUIEnabled=!1,dt._isTellMeUpSellEnterpriseEnabled=!1,dt._newMenuMoreTemplatesUrl=null,dt._isAppsForOfficeSingleSignOnSupportedOnHost=!1,dt._hideAppsExtensionUrl=null,dt._isControllerServicesQueryParamNeeded=!1,dt._disableWholeAppsForOfficeFeature=!1,dt._documentIsFolder=!1,dt._readFromMruIsEnabled=!1,dt._mruPollingIntervalInMs=0,dt._timeUntilInactiveInMs=0,dt._openMenuBrowseMoreHostUrl=null,dt._openMenuBrowseMoreHostName=null,dt._supportsGetMoreInfoForPersonalStorage=!1,dt._getMoreInfoRetryIntervalsInMs=null,dt._cursorPinningIsEnabled=!1,dt._nativeSelectionAndContextMenu=!1,dt.executeRenameFile=null,dt.executeVersionHistory=null,dt.executeRefreshFilename=null,dt.sendFileNameAndLocationUpdateNotification=null,dt.useCrossOriginStaticScripts=!1,dt._updateMruIsEnabled=!1,dt._wacCopyPasteShortcutDialogIsEnabled=!1,dt.flightId=null,dt.bootAppFromMiniCheck=!1,dt.useMiniCheckedDocumentParam=null,dt.logCanaryInBrowser=!1,dt.useO365ShellService=!1,dt.applicationDivId="application",dt.externalHeaderPanelId="AppHeaderPanel",dt.externalHeaderPanelClassName="AppHeaderPanel",dt.applicationOuterContainerId="applicationOuterContainer",dt.externalHeaderLabel=null,dt.sessionStartInfoJson=null,dt.sessionStartInfoSettings=null,dt.dataPlumber=new ct.a,dt.sessionStartAndEndData=null,dt._removeWacDialogKeyUpHandler=!1,dt.isNewFile=!1,dt._newFileTemplateName=null,dt._newFileTemplateLcid=null,dt.bootPerfDebuggingMetrics={},dt._instance=null,dt._otelShutdownTriggered=!1,dt.errorDialogDisplayedEventKey="ErrorDialogDisplayedEvent",dt.shuttingDownEventKey="ShuttingDownEvent",dt.eventSource=new s.a,dt._logSessionEndDataCalled=!1,dt._successfullySetOverlayContent=!1,dt._hostPostmessengerFuture=null,dt.theWsaClient=null,dt.coauthManager=null,dt._loggedFlightingTypes=null,dt.scheduledShutdownTtl=0,dt._isSupportedBrowserForPasteHandlerUIPaste=null,Object(i.a)(dt,"AFrameworkApplication",null,[4])},function(e,t,n){"use strict";var i=new Map;Type.prototype.implementsInterface=function(e){if("number"!=typeof e&&"string"!=typeof e)return!1;if(!this.prototype||!this.prototype.constructor)return!1;if("undefined"!=typeof this.__interfaceId)return e===this.__interfaceId;this.resolveInheritance(),i.has(this.prototype.constructor)||i.set(this.prototype.constructor,new Map);var t=i.get(this.prototype.constructor);if(t.has(e))return t.get(e);for(var n=this;n;){var r=n.__interfaces;if(r&&-1!==Array.indexOf(r,e))return t.set(e,!0),!0;n=n.__baseType}return t.set(e,!1),!1},Object.getType=function(e){var t=e.constructor;return t&&"function"==typeof t&&t.__typeName&&"Object"!==t.__typeName?t:Object},Boolean.parse=function(e){return"false"!==e&&"False"!==e&&("true"===e||"True"===e||"false"!==(e=e.trim().toLowerCase())&&("true"===e||void 0))};var r=function(e,t,n){var i="$$d_"+n;return null==e[i]&&(e[i]=t.bind(e)),e[i]},a=function(e,t){return null!=e&&null!=t&&("number"==typeof e||"string"==typeof e?Object.getType(t).implementsInterface(e):e.isInstanceOfType(t))},o=(n(19),n(421)),s=function(e){return e.next||(e.next=function(){return this.moveNext()?{done:!1,value:this.get_current()}:{done:!0,value:void 0}},e[Symbol.iterator]=function(){return this}),e};n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return s}))},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(208),a=function(e,t,n,i,r,a,o,s){void 0===o&&(o=!1),void 0===s&&(s=null),this.timestamp=e,this.category=t,this.tag=n,this.level=i,this.message=r||"",this.logType=a,this.isMinified=o,this.args=s};Object(i.a)(a,"LoggingArgs",null,[]);n(199);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){this.currentLevel=0,this._ulsCallDepth=0,this._loggingDuration=-1,this._blockedTags=new Array(0),this._host=new r.a,this._inHostTransition=!1,this.currentLevel=50}var t,i,s,l=e.prototype;return l.logImpl=function(t,n,i,r,o,s,l){var c=e.getTimestamp();if((r||this.shouldTrace(n,i)&&this.shouldTraceTag(t))&&!(this._ulsCallDepth>1)){o||this._ulsCallDepth++;try{var u=new Date;e.preprocessArgs(l);var d=!1,p=null,h="";if("undefined"==typeof s?d=!0:h=e.buildMessageString(s,l),d&&l&&l.length>0){p=[];for(var m=0,g=l.length;m<g;++m)p.push(null===l[m]||"undefined"==typeof l[m]?"":l[m].toString())}var f=new a(u.getTime(),n,t,i,h,r,d,p);this._host.handleTrace(f)}finally{o||this._ulsCallDepth--}e.supportsPerformanceNow&&(this._loggingDuration+=e.getTimestamp()-c)}},l.assertImpl=function(e,t,n,i,r){if(!n&&this._ulsCallDepth<=1){this._ulsCallDepth++;try{this.logImpl(e,t,10,1,!0,i,r)}finally{this._ulsCallDepth--}}},l.shouldTrace=function(e,t){return t<=this.currentLevel},l.setTraceLevel=function(e){this.currentLevel=e},l.shouldTraceTag=function(e){return!this._blockedTags[e]},l.clearSuppressedTags=function(){this._blockedTags=new Array(0)},l.addSuppressedTag=function(e){this._blockedTags[e]=!0},e.preprocessArgs=function(t){var i=n(3).ULS;if(t)for(var r=0,a=t.length;r<a;++r){var o=t[r];if(o&&"object"==typeof o){var s=Object.getType(o).prototype.toString;if(s===e.objectToStringPrototype||!s)if(1===o.nodeType)t[r]=i.concatArray([o.tagName,"#",o.id,".",o.className]);else try{t[r]=i.jsonSerialize(o)}catch(e){0,t[r]=e}}}},e.buildMessageString=function(e,t){return t&&t.length?e?String.format.apply(null,[e].concat(t)):t.join(", "):e||""},e.getTimestamp=function(){try{if(e.supportsPerformanceNow)return window.performance.now()}catch(t){e.supportsPerformanceNow=!1}return-1},t=e,(i=[{key:"ulsCallDepth",get:function(){return this._ulsCallDepth}},{key:"elapsedLoggingDuration",get:function(){return this._loggingDuration}},{key:"host",get:function(){return this._host},set:function(e){e!==this._host&&(this._inHostTransition||(this._inHostTransition=!0,e?(this._host.handoffToNewHost(e),this._host.dispose(),this._host=e):(this._host.dispose(),this._host=new r.a),this._inHostTransition=!1))}}])&&o(t.prototype,i),s&&o(t,s),e}();function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}s.objectToStringPrototype=Object.prototype.toString,s.supportsPerformanceNow=!!window.performance&&!!window.performance.now,Object(i.a)(s,"UlsImpl",null,[73]);var c=function(){function e(){this._host=new r.a}var t,n,i,a=e.prototype;return a.logImpl=function(e,t,n,i,r,a,o){},a.assertImpl=function(e,t,n,i,r){},a.shouldTrace=function(e,t){return!1},a.shouldTraceTag=function(e){return!1},a.setTraceLevel=function(e){},a.clearSuppressedTags=function(){},a.addSuppressedTag=function(e){},t=e,(n=[{key:"host",get:function(){return this._host},set:function(e){}},{key:"ulsCallDepth",get:function(){return 0}},{key:"elapsedLoggingDuration",get:function(){return-1}}])&&l(t.prototype,n),i&&l(t,i),e}();function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(c,"UlsImplStub",null,[73]),n.d(t,"ULS",(function(){return d}));var d=function(){function e(){}var t,n,i;return e.setUlsHost=function(t){e._isDisabled&&(e._impl=new s),e._impl.host=t,e._isDisabled=!1},e.disable=function(){e._impl=new c,e._isDisabled=!0},e.sendTraceTag=function(t,n,i,r){for(var a=arguments.length,o=new Array(a>4?a-4:0),s=4;s<a;s++)o[s-4]=arguments[s];e._impl.logImpl(t,n,i,0,!1,r,o)},e.shipAssertTag=function(t,n,i,r){void 0===r&&(r=null);for(var a=arguments.length,o=new Array(a>4?a-4:0),s=4;s<a;s++)o[s-4]=arguments[s];e._impl.assertImpl(t,n,i,r,o)},e.shouldTrace=function(t,n){return e._impl.shouldTrace(t,n)},e.shouldTraceTag=function(t){return e._impl.shouldTraceTag(t)},e.clearSuppressedTags=function(){e._impl.clearSuppressedTags()},e.addSuppressedTag=function(t){e._impl.addSuppressedTag(t)},e.setTraceLevel=function(t){e._impl.setTraceLevel(t)},e.concatArray=function(e){var t;return(t=[]).concat.apply(t,e).join("")},e.jsonSerialize=function(e){return window.JSON?JSON.stringify(e):Sys.Serialization.JavaScriptSerializer.serialize(e)},e.getElapsedLoggingDuration=function(){return e._impl.elapsedLoggingDuration},t=e,i=[{key:"host",get:function(){return e._impl.host}},{key:"ulsCallDepth",get:function(){return e._impl.ulsCallDepth}},{key:"impl",get:function(){return e._impl}},{key:"isDisabled",get:function(){return e._isDisabled}}],(n=null)&&u(t.prototype,n),i&&u(t,i),e}();d._impl=new s,d._isDisabled=!1,Object(i.a)(d,"ULS",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"EventNames",(function(){return s}));var i=n(0),r=(n(9),n(10)),a=n(76);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){}var t,n,i;return e.get_keyEvents=function(){return e.ensureKeyEventsCreated(),e._keyEvents},e.get_keyTypedEvents=function(){return e.ensureKeyTypedEventsCreated(),e._keyTypedEvents},e.get_mouseEvents=function(){return e.ensureMouseEventsCreated(),e._mouseEvents},e.get_dragEvents=function(){return e.ensureDragEventsCreated(),e._dragEvents},e.get_dragDropEvents=function(){return e.ensureDragDropEventsCreated(),e._dragDropEvents},e.get_clickEvents=function(){return e.ensureClickEventsCreated(),e._clickEvents},e.get_touchEvents=function(){return e.ensureTouchEventsCreated(),e._touchEvents},e.get_pointerEvents=function(){return e.ensurePointerEventsCreated(),e._pointerEvents},e.get_gesturePointerEvents=function(){return e.ensureGesturePointerEventsCreated(),e._gesturePointerEvents},e.get_gestureMouseEvents=function(){return e.ensureGestureMouseEventsCreated(),e._gestureMouseEvents},e.get_networkEvents=function(){return e.ensureNetworkEventsCreated(),e._networkEvents},e.ensureEventNamesMapping=function(){e._eventNames||(e._eventNames=a.b([e.aggregateEventTiming,e.aggregateEventTimingStart,e.aggregateEventTimingStop,e.beforeDeactivate,e.beforeKeyDown,e.beforeKeyPress,e.beforeKeyUp,e.blur,e.browserPointerCancel,e.browserPointerDown,e.browserPointerEnter,e.browserPointerLeave,e.browserPointerMove,e.browserPointerOut,e.browserPointerOver,e.browserPointerUp,e.change,e.click,e.compositionEnd,e.compositionStart,e.compositionUpdate,e.contextMenu,e.copy,e.cut,e.domSubtreeModified,e.doubleClick,e.dragLeave,e.dragStart,e.dragOver,e.dragEnter,e.drop,e.durationChange,e.error,e.ended,e.focus,e.freeze,e.input,e.keyDown,e.keyPress,e.keyUp,e.load,e.loseCapture,e.message,e.mouseDown,e.mouseEnter,e.mouseLeave,e.mouseMove,e.mouseOut,e.mouseOver,e.mouseUp,e.mouseWheel,e.msPointerCancel,e.msPointerDown,e.msPointerEnter,e.msPointerLeave,e.msPointerMove,e.msPointerOut,e.msPointerOver,e.msPointerUp,e.networkConnected,e.networkDisconnected,e.pan,e.panStart,e.panMove,e.panEnd,e.panCancel,e.panUp,e.panDown,e.panRight,e.panLeft,e.paste,e.pause,e.pinch,e.pinchCancel,e.pinchEnd,e.pinchIn,e.pinchMove,e.pinchOut,e.pinchStart,e.play,e.playing,e.pointerDown,e.pointerEnter,e.pointerLeave,e.pointerMove,e.pointerOut,e.pointerOver,e.pointerUp,e.propertyChange,e.reportFrameTiming,e.resize,e.scroll,e.selectionChange,e.selectStart,e.submit,e.swcReady,e.swipe,e.reset,e.textInput,e.timeUpdate,e.touchCancel,e.touchContextMenu,e.touchEnd,e.touchMove,e.touchStart,e.unload,e.visibilityChange,e.wheel]))},e.ensureKeyEventsCreated=function(){e._keyEvents||(e._keyEvents=[e.keyDown,e.keyUp,e.keyPress,e.beforeKeyDown,e.beforeKeyUp,e.beforeKeyPress])},e.ensureKeyTypedEventsCreated=function(){e._keyTypedEvents||(e._keyTypedEvents=[e.keyDown,e.keyPress])},e.ensureMouseEventsCreated=function(){e._mouseEvents||(e._mouseEvents=[e.mouseDown,e.mouseUp,e.mouseMove,e.mouseEnter,e.mouseLeave,e.mouseOver,e.mouseOut,e.mouseWheel])},e.ensureDragEventsCreated=function(){e._dragEvents||(e._dragEvents=[e.mouseDown,e.mouseUp,e.mouseMove,e.mouseOut,e.touchStart,e.touchEnd,e.touchMove,e.click])},e.ensureDragDropEventsCreated=function(){e._dragDropEvents||(e._dragDropEvents=[e.dragOver,e.drop])},e.ensureClickEventsCreated=function(){e._clickEvents||(e._clickEvents=[e.click,e.doubleClick])},e.ensureTouchEventsCreated=function(){e._touchEvents||(e._touchEvents=[e.touchStart,e.touchEnd,e.touchMove,e.touchCancel])},e.ensurePointerEventsCreated=function(){e._pointerEvents||(e._pointerEvents=[e.pointerDown,e.pointerEnter,e.pointerLeave,e.pointerMove,e.pointerUp,e.pointerOver,e.pointerOut])},e.ensureGesturePointerEventsCreated=function(){e._gesturePointerEvents||(e._gesturePointerEvents=[e.browserPointerDown,e.browserPointerMove,e.browserPointerUp,e.browserPointerCancel])},e.ensureGestureMouseEventsCreated=function(){e._gestureMouseEvents||(e._gestureMouseEvents=[e.mouseDown,e.mouseMove,e.mouseUp])},e.ensureNetworkEventsCreated=function(){e._networkEvents||(e._networkEvents=[e.networkConnected,e.networkDisconnected])},e.isValidEventName=function(t){return e.ensureEventNamesMapping(),!!e._eventNames[t]},e.ensureIsSimulatedMapping=function(){e._isSimulated||(e._isSimulated=a.b([e.beforeKeyDown,e.beforeKeyUp,e.beforeKeyPress,e.pan,e.pinch,e.swipe,e.touchContextMenu]))},e.isSimulated=function(t){return e.ensureIsSimulatedMapping(),!!e._isSimulated[t]},e.ensureIsInternalMapping=function(){e._isInternal||(e._isInternal=a.b([e.touchContextMenu]))},e.isInternalEvent=function(t){return e.ensureIsInternalMapping(),!!e._isInternal[t]},e.eventNameFromString=function(t){var n=t;switch(n){case"textinput":n=e.textInput;break;case"dommousescroll":n=e.mouseWheel;break;case"domsubtreemodified":n=e.domSubtreeModified;break;case"mspointerdown":n=e.msPointerDown;break;case"mspointerup":n=e.msPointerUp;break;case"mspointermove":n=e.msPointerMove;break;case"mspointerover":n=e.msPointerOver;break;case"mspointerout":n=e.msPointerOut;break;case"mspointercancel":n=e.msPointerCancel;break;case"mspointerleave":n=e.msPointerLeave;break;case"mspointerenter":n=e.msPointerEnter}return n},t=e,i=[{key:"mouseWheel",get:function(){return e._mouseWheel||(r.a.isFirefox?e._mouseWheel="DOMMouseScroll":e._mouseWheel="mousewheel"),e._mouseWheel}}],(n=null)&&o(t.prototype,n),i&&o(t,i),e}();s.keyDown="keydown",s.keyUp="keyup",s.keyPress="keypress",s.beforeKeyDown="BeforeKeyDown",s.beforeKeyUp="BeforeKeyUp",s.beforeKeyPress="BeforeKeyPress",s.touchContextMenu="touchcontextmenu",s.compositionStart="compositionstart",s.compositionEnd="compositionend",s.compositionUpdate="compositionupdate",s.loseCapture="losecapture",s.pointerDown="msospPointerDown",s.pointerMove="msospPointerMove",s.pointerUp="msospPointerUp",s.pointerOver="msospPointerOver",s.pointerOut="msospPointerOut",s.pointerLeave="msospPointerLeave",s.pointerEnter="msospPointerEnter",s.browserPointerDown="pointerdown",s.browserPointerMove="pointermove",s.browserPointerUp="pointerup",s.browserPointerOver="pointerover",s.browserPointerOut="pointerout",s.browserPointerCancel="pointercancel",s.browserPointerLeave="pointerleave",s.browserPointerEnter="pointerenter",s.mouseDown="mousedown",s.mouseUp="mouseup",s.mouseMove="mousemove",s.mouseEnter="mouseenter",s.mouseLeave="mouseleave",s.mouseOver="mouseover",s.mouseOut="mouseout",s._mouseWheel=null,s.wheel="wheel",s.click="click",s.doubleClick="dblclick",s.touchStart="touchstart",s.touchMove="touchmove",s.touchEnd="touchend",s.touchCancel="touchcancel",s.msPointerDown="MSPointerDown",s.msPointerMove="MSPointerMove",s.msPointerUp="MSPointerUp",s.msPointerOver="MSPointerOver",s.msPointerOut="MSPointerOut",s.msPointerCancel="MSPointerCancel",s.msPointerLeave="MSPointerLeave",s.msPointerEnter="MSPointerEnter",s.textInput="textInput",s.drop="drop",s.dragStart="dragstart",s.dragOver="dragover",s.dragEnter="dragenter",s.dragLeave="dragleave",s.contextMenu="contextmenu",s.beforeDeactivate="beforedeactivate",s.domSubtreeModified="DOMSubtreeModified",s.message="message",s.focus="focus",s.input="input",s.blur="blur",s.freeze="freeze",s.change="change",s.propertyChange="propertychange",s.scroll="scroll",s.selectionChange="selectionchange",s.selectStart="selectstart",s.submit="submit",s.reset="reset",s.load="load",s.unload="unload",s.error="error",s.resize="resize",s.copy="copy",s.cut="cut",s.paste="paste",s.play="play",s.playing="playing",s.pause="pause",s.timeUpdate="timeupdate",s.durationChange="durationchange",s.ended="ended",s.aggregateEventTiming="aggregateeventtiming",s.aggregateEventTimingStart="aggregateeventtimingstart",s.aggregateEventTimingStop="aggregateeventtimingstop",s.reportFrameTiming="reportframetiming",s.visibilityChange="visibilitychange",s.networkConnected="online",s.networkDisconnected="offline",s.swcReady="swc:ready",s.pinch="pinch",s.pinchStart="pinchstart",s.pinchEnd="pinchend",s.pinchOut="pinchout",s.pinchIn="pinchin",s.pinchMove="pinchmove",s.pinchCancel="pinchcancel",s.pan="pan",s.panStart="panstart",s.panEnd="panend",s.panMove="panmove",s.panCancel="pancancel",s.panDown="pandown",s.panUp="panup",s.panLeft="panleft",s.panRight="panright",s.swipe="swipe",s._eventNames=null,s._isSimulated=null,s._isInternal=null,s._keyEvents=null,s._keyTypedEvents=null,s._mouseEvents=null,s._dragEvents=null,s._dragDropEvents=null,s._clickEvents=null,s._touchEvents=null,s._pointerEvents=null,s._gesturePointerEvents=null,s._gestureMouseEvents=null,s._networkEvents=null,Object(i.a)(s,"EventNames",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a}));var i="",r=function(e){return null===e||"undefined"==typeof e||!e.length},a=function(e){return null===e||"undefined"==typeof e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(0),r=n(48),a=n(7),o=n(22),s=n(13),l=n(5);function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var d=function(){function e(){}return e.removeChildNodes=function(e){if(l.c(e))return null;var t=e.parentNode;if(t){var n=e.cloneNode(!1);return t.replaceChild(n,e),n}for(var i,r=e.firstChild;r;)i=r.nextSibling,e.removeChild(r),r=i;return e},e.removeChildNodesSlow=function(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)},e.toggleCSSClassOnElement=function(t,n,i){i?e.ensureCSSClassOnElement(t,n):e.removeCSSClassFromElement(t,n)},e.ensureCSSClassOnElement=function(e,t){if(!l.c(e)){var n=e.className;if(l.c(n)||-1===n.indexOf(t)){var i=n.trim()+" "+t;i=i.trim(),e.className=i}}},e.removeCSSClassFromElement=function(e,t){if(!(l.c(e)||l.c(t)||l.c(e.className))){var n=e.className;n!==n.replace(t,"")&&(e.className=n.replace(t,""))}},e.setEnabledOnElement=function(t,n,i,r){if(void 0===i&&(i=!1),void 0===r&&(r=!1),!l.c(t)&&!i){e.toggleCSSClassOnElement(t,"cui-disabled",!n);var o=n?a.a.ariaFalseValue:a.a.ariaTrueValue;a.a.setAriaAttribute(t,a.a.ariaDisabledAttribute,o),r&&a.a.setAriaAttribute(t,a.a.ariaReadOnlyAttribute,o)}},e.addToTabLoop=function(e){e.tabIndex=0},e.createNoOpLink=function(t){void 0===t&&(t=!0);var n=e.createElement("a");return t&&e.addToTabLoop(n),n},e.validateStringProperty=function(e,t){return l.c(e)&&(e=t,l.c(e)&&(e="")),e},e.setUnselectable=function(t,n,i){if(!l.c(t)&&"#text"!==t.nodeName&&(n?t.setAttribute("unselectable","on"):t.setAttribute("unselectable","off"),i))for(var r=t.firstChild;r;)e.setUnselectable(r,n,!0),r=r.nextSibling},e.createClusteredImageContainerNew=function(t,n,i,r,a,o){var s=o?e.createBlockSpan():e.createElement("span");return s.className+=a?" cui-img-cont-float ":" cui-img-container ",s.className+=e.imageSizeToClass[t],l.b(n)||(s.appendChild(r),r.src=n,r.setAttribute("role","presentation"),l.c(i)||(r.className=i)),s},e.setLargeControlText=function(t,n,i){var r=n,a=!1,o=null,s=n.lastIndexOf("\u200b\u200b");if(-1!==s)r=n.substr(0,s),a=!0,o=n.substr(s+2);else{var c=n.lastIndexOf(" ");-1!==c?(r=n.substr(0,c),a=!0,o=n.substr(c+1)+(i?" ":"")):i&&(a=!0)}t.innerHTML="",t.appendChild(document.createTextNode(r)),a&&t.appendChild(document.createElement("br"));var u=!l.b(o);u&&t.appendChild(document.createTextNode(o)),e.ensureCSSClassOnElement(t,u?"cui-ctl-largelabel-twoline":"cui-ctl-largelabel-singleline")},e.setControlText=function(t,n,i){o.DomUtils.setFormattedTextToPlaceholders(t,n,i,(function(t){var n;return(n=e.createElement("span")).setAttribute("dir","auto"),n.innerText=t,n}))},e.releaseEventHandlersRecursively=function(t){if(!l.c(t)&&(e.unregisterAllHandlers(t),!l.c(t.childNodes)))for(var n=0;n<t.childNodes.length;n++)e.releaseEventHandlersRecursively(t.childNodes[n])},e.createBlockSpan=function(){var t=e.createElement("span");return t.className="cui-block",t},e.isTrue=function(e){return!l.c(e)&&"true"===s.a.toLower(e)},e.isFalse=function(e){return!l.c(e)&&"false"===s.a.toLower(e)},e.createElement=function(e){var t=document.createElement(e);return t.setAttribute("unselectable","on"),t},e.createSelectableElement=function(e){return document.createElement(e)},e.cancelPendingTimeout=function(e){-1!==e.val&&(window.clearTimeout(e.val),e.val=-1)},e.cancelInterval=function(e){-1!==e.val&&(window.clearInterval(e.val),e.val=-1)},e.unregisterAllHandlers=function(e){r.EventHandlerManager.instance.unregisterAllHandlers(e)},e.preventDefaultKeyAction=function(e,t){return e.innerEvent.keyCode===t&&(e.innerEvent.preventDefault(),!0)},e.isEncodedStringArray=function(t){return t.startsWith(e._encodedStringArrayToken)},e.encodeStringArrayXmlAttribute=function(t){if(!t||!t.length)return null;for(var n,i=new Sys.StringBuilder(e._encodedStringArrayToken),r=c(t);!(n=r()).done;){var a=n.value;i.append(a?a.length:0),i.append(","),i.append(a),i.append(",")}return i.toString().slice(0,-1)},e.decodeStringArrayXmlAttribute=function(t){if(l.b(t)||!t.startsWith(e._encodedStringArrayToken))return null;if(!(t=t.slice(e._encodedStringArrayToken.length)).length)return null;for(var n=[];t.length>0;){var i=parseInt(t);if(isNaN(i)||i<0)return null;var r=t.indexOf(",");if(-1===r)return null;n.push(t.substr(r+1,i)),t=t.slice(r+1+i+1)}return n},e}();d._encodedStringArrayToken="STRARRY@",d.imageSizeToClass=["","cui-img-5by3","cui-img-8by8","cui-img-13by13","cui-img-16by16","cui-img-32by32","cui-img-40by40","cui-img-48by48","cui-img-64by48","cui-img-85by48","cui-img-1by16","cui-img-14by14","cui-img-24by24","cui-img-20by20","cui-img-30by30","cui-img-120by20","cui-img-84by21","cui-img-90by21","cui-img-200by200","cui-img-70by48"],d.galleryElementDimensionsToSizeString=["","Size16by16","Size40by40","Size48by48","Size61by75","Size64by48","Size85by48","Size110by75","Size85by16","Size32by32","Size120by20","Size20by20","Size24by24","Size84by21","Size90by21","Size200by200","Size70by48"],Object(i.a)(d,"Utility",null,[])},function(e,t,n){"use strict";var i,r=n(0),a=n(11),o=(n(9),n(24)),s=n(25),l=n(20);!function(e){e[e.title=0]="title",e[e.content=1]="content",e[e.notes=2]="notes",e[e.unknown=3]="unknown"}(i||(i={})),Object(r.b)("AccessibilityItemType",i);var c=n(16),u=n(10),d=n(8),p=n(3);function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return m}));var m=function(){function e(){}var t,r,m;return e.setAriaAttribute=function(e,t,n){e&&(u.a.isIPad||e.setAttribute(t,n))},e.addNotificationCallback=function(t){e.readyForNotifications?t():(e._notificationCallbacks||(e._notificationCallbacks=[]),Array.add(e._notificationCallbacks,t))},e.getF6NotificationString=function(e){var t=u.a.isMac?CommonUIStrings.l_AccHelpDialogCommandKey:CommonUIStrings.l_AccHelpDialogCtrlKey,n=String.format(CommonUIStrings.l_F6ToMoveAroundApp,t);return e?String.format("{0} {1}",n,CommonUIStrings.l_AccessibilityHelpShortcut):n},e.getCanvasDescribedByString=function(e){var t=u.a.isMac?CommonUIStrings.l_AccHelpDialogCommandKey:CommonUIStrings.l_AccHelpDialogCtrlKey,n=String.format(CommonUIStrings.l_F6ToLeaveEditingSurface,t);return e?String.format("{0} {1}",n,CommonUIStrings.l_AccessibilityHelpShortcut):n},e.appendSpanWithHiddenContext=function(t){var n=t.ownerDocument.createElement("span");e.hideElementFromSight(n),t.appendChild(n);var i=t.ownerDocument.createElement("span");t.appendChild(i);var r=t.ownerDocument.createElement("span");return e.hideElementFromSight(r),t.appendChild(r),i},e.getTextWithHiddenContext=function(e){return e.children[1].innerText},e.setTextWithHiddenContext=function(e,t,n){var i=n.indexOf("{0}");var r=n.substring(0,i);e.children[0].innerText=r,e.children[1].innerText=t;var a=n.substring(i+"{0}".length,n.length);e.children[2].innerText=a},e.appendHiddenLabel=function(t,n,i){var r=document.createElement("div");return e.hideElementFromSight(r),r.id=n,""!==i&&(r.innerText=i),r.setAttribute(e.ariaRoleAttribute,e.ariaPresentationRole),r.setAttribute(e.ariaHiddenAttribute,e.ariaTrueValue),t.appendChild(r),t.setAttribute(e.ariaLabelledByAttribute,n),r},e.createHiddenDescriptionElement=function(t,n){var i=document.createElement("div");return e.hideElementFromSight(i),i.id=t,""!==n&&(i.innerText=n),i.setAttribute(e.ariaRoleAttribute,e.ariaDescriptionRole),i.setAttribute(e.ariaHiddenAttribute,e.ariaTrueValue),i},e.appendHiddenDescribedBy=function(t,n,i,r){var a=e.createHiddenDescriptionElement(i,r);return t.appendChild(a),n.setAttribute(e.ariaDescribedByAttribute,a.id),a},e.hideElementFromSight=function(e){e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex="-100"},e.registerHelpActionAndShortcut=function(t,i){void 0===i&&(i=null);var r=n(94).Redirect,a=n(1).AFrameworkApplication;r.registerAction(t,d.a.accessibilityHelp),o.FocusManager.instance().getScope(n(31).AFrame.documentFocusID).bindAction(l.KeyInputManager.hashKey(s.a.VK_A,5),d.a.accessibilityHelp),a.appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled")&&i&&e.createLiveRegionAnnouncement(i,CommonUIStrings.l_AccHelpShortcutAnnouncement)},e.createLiveRegionAnnouncement=function(t,i){var r=n(1).AFrameworkApplication,a=document.createElement("div");a.setAttribute(e.ariaRoleAttribute,e.ariaMarqueeRole),a.setAttribute(e.ariaLiveAttribute,e.ariaPoliteLiveLevel),a.setAttribute(e.ariaAtomicAttribute,e.ariaTrueValue),a.className="WACAriaLiveRegion",t.appendChild(a),r.registerOnAfterSplashScreenDismissed((function(){a.appendChild(document.createTextNode(i))}))},e.getAccessiblityInfoForScreenReader=function(t,n,i,r,a,o,s){if(!(t&&n&&i&&r&&a&&o&&a))throw Error.argumentNull("rawAccessibilityInfo, allTitlePromptDic, allTitlesDic, allContentPromptDic, allContentsDic, allNotePromptDic or allNotesDic");e.parseoutAccessibilityInfo(t,n,i,r,a,o,s)},e.getAccessibilityInfoForAccessibilityMode=function(t){if(!t)throw Error.argumentNull("rawAccessibilityInfo");return e.insertHeadingTagsInAccessibilityInfo(t)},e.parseoutAccessibilityInfo=function(t,n,i,r,o,s,l){for(var c=0;c<t.childNodes.length;){var u=t.childNodes[c];if("BR"===u.tagName){var d=e.getItemType(u);3!==d&&function(){var p=void 0,h=void 0,m=u.getAttribute("id").toString().split("_")[1];d?1===d?(e.getContentOrNoteInfoForReader(t.childNodes[c-1],1,Object(a.a)((function(){return p}),(function(e){return p=e})),Object(a.a)((function(){return h}),(function(e){return h=e}))),r[m]=p,o[m]=h):2===d&&(e.getContentOrNoteInfoForReader(t.childNodes[c-1],2,Object(a.a)((function(){return p}),(function(e){return p=e})),Object(a.a)((function(){return h}),(function(e){return h=e}))),s[m]=p,l[m]=h):(e.getTitleInfoForReader(t.childNodes[c-1],Object(a.a)((function(){return p}),(function(e){return p=e})),Object(a.a)((function(){return h}),(function(e){return h=e}))),n[m]=p,i[m]=h)}()}c++}},e.insertHeadingTagsInAccessibilityInfo=function(t){for(var n=0,i=new Array(t.childNodes.length);n<t.childNodes.length;){var r=t.childNodes[n];if(r.innerHTML&&""!==r.innerHTML?i[n]=e.getOuterHTML(r):i[n]="","BR"===r.tagName){var a=e.getItemType(r);a?1===a?i[n-1]=e.attachHeadingTagForSpecifiedItem(i[n-1],1):2===a&&(i[n-1]=e.attachHeadingTagForSpecifiedItem(i[n-1],2)):i[n-1]=e.attachHeadingTagForSpecifiedItem(i[n-1],0)}n++}return i.join("")},e.getItemType=function(e){var t=new RegExp("^Title_[0-9]+$"),n=new RegExp("^Content_[0-9]+$"),i=new RegExp("^Notes_[0-9]+$"),r=e.getAttribute("id");return r?t.test(r.toString())?0:n.test(r.toString())?1:i.test(r.toString())?2:(p.ULS.sendTraceTag(7422981,1900,10,"current BR ID of '{0}' doesn't not match any of Title, Content or Notes",r.toString()),3):(p.ULS.sendTraceTag(7422980,1900,10,"Failed to find attribute of ID from BR Node!"),3)},e.getOuterHTML=function(e){var t=document.createElement("P");return t.appendChild(e.cloneNode(!0)),t.innerHTML},e.getItemPromptPattern=function(e){switch(e){case 0:return String.format("\\[{0} [0-9]+ {1}\\]",CommonUIStrings.l_ScreenReader_PatternWord_Slide,CommonUIStrings.l_ScreenReader_PatternWord_Title);case 1:return String.format("\\[{0} [0-9]+ {1}\\]",CommonUIStrings.l_ScreenReader_PatternWord_Slide,CommonUIStrings.l_ScreenReader_PatternWord_Content);case 2:return String.format("\\[{0} [0-9]+ {1}\\]",CommonUIStrings.l_ScreenReader_PatternWord_Slide,CommonUIStrings.l_ScreenReader_PatternWord_Notes);default:throw Error.invalidOperation(String.format("Unsupported item type of {0}",i[e]))}},e.getTitleInfoForReader=function(t,n,i){n.val=CommonUIStrings.l_ScreenReader_UnknowSlideTitlePrompt,i.val=CommonUIStrings.l_ScreenReader_UnknowSlideTitle;try{if(2!==t.childNodes.length)p.ULS.sendTraceTag(7422982,1900,10,"Expect 2 Children which contains Slide # and Slide Title, but acutal content is {0}",c.a.dumpHtmlWithoutText(t));else{var r=t.childNodes[0].nodeValue;new RegExp(String.format("^{0}$",e.getItemPromptPattern(0)),"i").test(r)&&(n.val=r,"LI"!==t.childNodes[1].tagName||1!==t.childNodes[1].childNodes.length||"DIV"!==t.childNodes[1].childNodes[0].tagName||1!==t.childNodes[1].childNodes[0].childNodes.length?p.ULS.sendTraceTag(7422983,1900,10,"Expect TAG of LI and 1 Child Slide Title Info, but acutal Tag is {0} and content is {1}",t.childNodes[1].tagName,c.a.dumpHtmlWithoutText(t.childNodes[1])):(i.val=t.childNodes[1].childNodes[0].childNodes[0].nodeValue,i.val&&i.val.length||(i.val=CommonUIStrings.l_ScreenReader_NoSlideTitle)))}}catch(e){p.ULS.sendTraceTag(7422984,1900,10,"Failed to parse the slide # and title because of {0}, the acutal raw data is {1}",e.toString(),c.a.dumpHtmlWithoutText(t))}},e.getContentOrNoteInfoForReader=function(t,n,r,a){r.val=null,a.val=null;var o=null,s=null,l=null,u=null;switch(n){case 1:r.val=CommonUIStrings.l_ScreenReader_UnknowSlideContentPrompt,o=e.getItemPromptPattern(1),s="LI",l=CommonUIStrings.l_ScreenReader_NoSlideContent,u=CommonUIStrings.l_ScreenReader_UnknowSlideContent;break;case 2:r.val=CommonUIStrings.l_ScreenReader_UnknowSlideNotePrompt,o=e.getItemPromptPattern(2),s="P",l=CommonUIStrings.l_ScreenReader_NoSlideNote,u=CommonUIStrings.l_ScreenReader_UnknowSlideNote;break;default:throw Error.create(String.format("Don't support the type of {0} in GetContentOrNoteInfoForReader",i[n]))}var d=t.childNodes[0].nodeValue,h=new RegExp("^"+o+"$","i");if(h.test(d)){if(r.val=d,t.childNodes.length>1)for(var m=e.extractAllListItems(t),g=0;g<m.length;g++){var f=m[g].tagName;f===s?a.val?a.val=String.format("{0} {1}",a.val,e.extractInnerText(m[g])):a.val=e.extractInnerText(m[g]):p.ULS.sendTraceTag(7476291,1900,10,"Expect Tag is {0} but got Tag of {1}.",s,f||"null")}a.val&&a.val.length||(a.val=l)}else p.ULS.sendTraceTag(7476292,1900,10,"Cannot find the Prompt by Pattern of {0} from {1}",h.toString(),c.a.dumpHtmlWithoutText(t.childNodes[0])),a.val=u},e.attachHeadingTagForSpecifiedItem=function(t,n){var r=t,a=null,o=null,s=null;switch(n){case 0:o="h1",s="<ul>";break;case 1:o="h2",s="<ul>";break;case 2:o="h3",s="<ul>"}a=new RegExp(String.format("^{0}{1}",s,e.getItemPromptPattern(n)),"i");var l=t.match(a);l&&1===l.length?r=t.substring(0,s.length)+("<"+o+">"+t.substring(s.length,l[0].length)+"</"+o+">")+t.substring(l[0].length,t.length):p.ULS.sendTraceTag(7422985,1900,10,"Failed to find expected Slide {0} by pattern of {1}",i[n],a.toString());return r},e.extractAllListItems=function(e){var t=e.childNodes;return"UL"===e.childNodes[1].tagName&&(t=e.childNodes[1].childNodes),t},e.extractInnerText=function(e){var t=null;if(e.innerText)t=e.innerText;else if(e.innerHTML&&e.innerHTML.length>0){for(var n=e,i=1e3;i>=0;i--){if(!n.childNodes.length){t=n.nodeValue;break}if(!n.childNodes[0].tagName||"SPAN"===n.childNodes[0].tagName){t=n.innerHTML;break}if(1!==n.childNodes.length){p.ULS.sendTraceTag(7476293,1900,15,"Unsupported Item format: {0}",c.a.dumpHtmlWithoutText(e));break}n=n.childNodes[0]}i<=0&&p.ULS.sendTraceTag(8263566,1900,15,"more than 1000 Nested level HTML object is NOT supported")}return t},t=e,m=[{key:"readyForNotifications",get:function(){return e._readyForNotifications},set:function(t){if(e._readyForNotifications=t,e._readyForNotifications&&e._notificationCallbacks){for(var n=0;n<e._notificationCallbacks.length;n++)e._notificationCallbacks[n]();e._notificationCallbacks=null}}}],(r=null)&&h(t.prototype,r),m&&h(t,m),e}();m.ariaAtomicAttribute="aria-atomic",m.ariaBusyAttribute="aria-busy",m.ariaCheckedAttribute="aria-checked",m.ariaControlsAttribute="aria-controls",m.ariaDescribedByAttribute="aria-describedby",m.ariaDisabledAttribute="aria-disabled",m.ariaExpandedAttribute="aria-expanded",m.ariaHasPopupAttribute="aria-haspopup",m.ariaHiddenAttribute="aria-hidden",m.ariaLabelAttribute="aria-label",m.ariaLabelledByAttribute="aria-labelledby",m.ariaLevelAttribute="aria-level",m.ariaLiveAttribute="aria-live",m.ariaMultilineAttribute="aria-multiline",m.ariaOwnsAttribute="aria-owns",m.ariaPressedAttribute="aria-pressed",m.ariaPosInSetAttribute="aria-posinset",m.ariaReadOnlyAttribute="aria-readonly",m.ariaRoleDescription="aria-roledescription",m.ariaSelectedAttribute="aria-selected",m.ariaSetSizeAttribute="aria-setsize",m.ariaValueMaxAttribute="aria-valuemax",m.ariaValueMinAttribute="aria-valuemin",m.ariaValueNowAttribute="aria-valuenow",m.ariaAlertRole="alert",m.ariaApplicationRole="application",m.ariaButtonRole="button",m.ariaCheckBoxRole="checkbox",m.ariaComboboxRole="combobox",m.ariaComplementaryRole="complementary",m.ariaDialogRole="dialog",m.ariaDescriptionRole="description",m.ariaDocumentRole="document",m.ariaGridCellRole="gridcell",m.ariaGridRole="grid",m.ariaGroupRole="group",m.ariaHeadingRole="heading",m.ariaImageRole="img",m.ariaLinkRole="link",m.ariaListboxRole="listbox",m.ariaListRole="list",m.ariaListItemRole="listitem",m.ariaMainRole="main",m.ariaMarqueeRole="marquee",m.ariaMenuItemCheckBoxRole="menuitemcheckbox",m.ariaMenuItemRadioRole="menuitemradio",m.ariaMenuItemRole="menuitem",m.ariaMenuRole="menu",m.ariaNavigationRole="navigation",m.ariaNoteRole="note",m.ariaOptionRole="option",m.ariaPresentationRole="presentation",m.ariaProgressBarRole="progressbar",m.ariaRadioRole="radio",m.ariaRegionRole="region",m.ariaRoleAttribute="role",m.ariaRowRole="row",m.ariaStatusRole="status",m.ariaTabRole="tab",m.ariaTabListRole="tablist",m.ariaTextboxAttribute="textbox",m.ariaTreeItemRole="treeitem",m.ariaTreeRole="tree",m.ariaToggleButtonRole="toggle",m.ariaFalseValue="false",m.ariaTrueValue="true",m.ariaUndefinedValue="undefined",m.ariaAssertiveLiveLevel="assertive",m.ariaOffLiveLevel="off",m.ariaPoliteLiveLevel="polite",m.str_TitleValueID="TitleValueID",m.str_ContentValueID="ContentValueID",m.str_NoteValueID="NoteValueID",m._readyForNotifications=!0,m._notificationCallbacks=null,Object(r.a)(m,"AccessibilityUtils",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}return e.getNameFromId=function(e){switch(e){case 617890675:return"AccCheckerFocusBackward";case 2971500747:return"AccCheckerFocusBottom";case 3772228079:return"AccCheckerFocusForward";case 1785655699:return"AccCheckerFocusTop";case 83795095:return"AccessibilityHelp";case 389865630:return"AccessibilityHelpDialogFocusBackward";case 3803697328:return"AccessibilityHelpDialogFocusForward";case 1099072191:return"ActivateAppForOffice";case 1743607468:return"ActivateTranslatorApp";case 1750752436:return"ActivityNotificationButtonHandler";case 3602816928:return"ActivityNotificationClosed";case 1402209562:return"AddInCommandsActionHandler";case 798637440:return"AlwaysEnabled";case 3030242601:return"AnswerForSearch";case 587759533:return"AnswerForSearchSingleLine";case 2434078920:return"amutTest1";case 2434078917:return"amutTest2";case 2434078918:return"amutTest3";case 3896010204:return"Animation";case 613275288:return"AnonymousCreationNavigateAfterSave";case 2316947260:return"AnonymousCreationSaveToHost";case 2799657174:return"AppSettingsRefreshSkipCache";case 2175352112:return"AuthenticationLost";case 2556904104:return"AuthenticationRestored";case 4289528682:return"BlockIfFocusedTextField";case 3551492845:return"BlockIfNotFocusedTextField";case 2279655429:return"BreadcrumbLinkClick";case 954512041:return"BusinessBarButtonOne";case 1404592381:return"BusinessBarButtonTwo";case 3484823337:return"BusinessBarClose";case 3786550719:return"BusinessBarInvoke";case 2119511063:return"BusinessBarLink";case 1281138585:return"CancelPresenceTooltips";case 1915117369:return"CancelSigninBusinessBar";case 3270784282:return"CancelSigninDialog";case 1783852782:return"CatchUpPassiveAwarenessSession";case 1206905761:return"CatchUpActiveAwarenessSession";case 1168274369:return"CheckTab";case 3134914741:return"CheckTabShift";case 3695056554:return"CheckUserAccessAndGrantPermissionsTest";case 2598811989:return"CheckUserAccessTest";case 2635327499:return"ClearSearch";case 241072808:return"ClearSearchFromSearchMenu";case 3033402446:return"Close";case 1895329487:return"CloseAccessibilityCheckerPane";case 1520278933:return"CloseEnrichmentPane";case 1530887760:return"CloseExtensionTaskPane";case 953328883:return"CloseSwitcher";case 691867605:return"CoauthorsRendered";case 3411172825:return"CommentActivityPreviewed";case 36098707:return"CommentActivitySelected";case 3259256685:return"CommentBeginRefresh";case 1637502579:return"CommentBeginRefreshRefused";case 863375655:return"CommentBeginSucceeded";case 1510212254:return"CommentCancelled";case 1137396240:return"CommentDeeplinkOpened";case 467845448:return"CommentDelete";case 375707647:return"CommentDone";case 3609945866:return"CommentDownloadFailed";case 159412208:return"CommentDownloadSucceeded";case 1951217806:return"CommentHintClick";case 2477668749:return"CommentHintMouseExit";case 4198211167:return"CommentHintMouseOver";case 1046295975:return"CommentNewCreated";case 2462410242:return"CommentNewSaved";case 4041287661:return"CommentReply";case 516537638:return"CommentSaveNetworkError";case 4156131848:return"CommentSaveRetry";case 1991982245:return"CommentSaveSucceeded";case 485487087:return"CommentTabBackward";case 2489743155:return"CommentTabForward";case 3103450156:return"CommentUndone";case 1808554760:return"CommitNewDocumentTitle";case 2609364291:return"ContactSupport";case 710925581:return"Conversation";case 1750478296:return"CopyAndEdit";case 3505086889:return"CopyLink";case 1278286187:return"CreateDocument";case 195579685:return"DecreaseZoom";case 1756450500:return"Definitions";case 2114287254:return"DefinitionsForTellMe";case 211953924:return"DialogAction";case 3756639316:return"DialogCancel";case 844297214:return"DialogClose";case 1245654357:return"DialogMove";case 646039090:return"DialogSecondaryAction";case 1825605114:return"DialogTertiaryAction";case 779285039:return"DigitalPrintToSwaySlabClicked";case 4275690876:return"DimeLaunch";case 3619977465:return"DismissNewCommentActivityIndicator";case 3113540593:return"DisposeCrossDocumentMessenger";case 537152338:return"DoBrowserDefault";case 1169404878:return"DocumentLoaded";case 567929329:return"DoesCommentExist";case 336231556:return"DoNothing";case 1203133001:return"DoNothingInEdit";case 3555692408:return"DownloadACopy";case 1695673896:return"DownloadACopyDownloadButtonClick";case 2619015155:return"EditComment";case 2413704991:return"EndPinchToZoom";case 291542435:return"EditDocument";case 1257657435:return"ExecuteAddinAction";case 3280707168:return"ExecuteDynamicAddInCommandsAPI";case 1176360680:return"ExecuteUnitTests";case 2281252844:return"ExecuteUnitTestsBvt";case 1261644258:return"F6";case 715899390:return"F6shift";case 1754333801:return"FeedbackSubmit";case 3019354063:return"FeedbackCancel";case 3537588550:return"FileNameUpdate";case 512688659:return"FileProperties";case 981334692:return"FileSharing";case 2260671807:return"FileSuggestion1";case 2260671810:return"FileSuggestion2";case 2260671809:return"FileSuggestion3";case 3541645273:return"FindReplaceInDocument";case 1540292897:return"FindInDocument";case 2398455418:return"FindMatchCase";case 1783557e3:return"FindWholeWord";case 15750502:return"FireGetRelevantActivities";case 1486778386:return"FirstRunExperienceCompleted";case 3016992658:return"FirstRunExperienceFocusBackward";case 1501863744:return"FirstRunExperienceFocusForward";case 672565674:return"FirstRunExperienceShowUI";case 710478303:return"FocusToBrowser";case 348609604:return"FreemiumUpsellBadge";case 4180531998:return"FreemiumUpsellDialogShowUI";case 1274543852:return"FreemiumUpsellEligible";case 4288982261:return"GetAnimationStats";case 3890502328:return"GetUserContactsTest";case 3094869204:return"GetUserProfilePictureTest";case 802602464:return"GiveFeedback";case 577991405:return"GrantUserAccessTest";case 1454393937:return"Help";case 4065325971:return"HideActivityPane";case 2493123577:return"HideCommentPane";case 1592314317:return"HideUILessDialog";case 3107136749:return"HostUnload";case 3018530951:return"IncreaseZoom";case 3740310824:return"InitializeRenameUIHandler";case 3553159035:return"InsertAgaveFromOsf";case 56493533:return"InsertOfficeAddin";case 1435347209:return"Insights";case 3317204163:return"InsightsForTellMe";case 2823076269:return"InvokeDictionarySerpletContextMenu";case 2670256092:return"InvokeFilesSerplet";case 234181094:return"InvokeFilesSerpletHomeTab";case 4149966010:return"InvokeImageSerpletContextMenu";case 720345883:return"InvokeSynonymsSerpletContextMenu";case 3565729580:return"InvokeInDocSerplet";case 1914896509:return"InvokeSerplet";case 4195071443:return"InvokeSerpletRibbon";case 2861781337:return"InvokeSerpletContextMenu";case 3359903192:return"InvokeSerpletTellMeZeroTerm";case 3087426977:return"InvokeZeroTermSerpletContextMenu";case 3799468329:return"IsJoined";case 2246375352:return"JoinChatThread";case 57698967:return"KeyManagerCommandUnitTest";case 407117407:return"LaunchAddInCommands";case 1945259303:return"LaunchAppForOfficeDialog";case 1784018444:return"LaunchFileMenu";case 951969558:return"LaunchMenu";case 1478840041:return"LaunchSigninWindow";case 2531463828:return"LaunchWildFireBusinessBar";case 2153376084:return"LivePersonaCardAction";case 1182470434:return"MoveToFolder";case 2482841374:return"MoveToFolderCompleteByHost";case 3475093410:return"MultiTouch";case 3734060499:return"NewBrowserSuggestionClicked";case 2423504651:return"NewComment";case 1002198721:return"NewCommentActivityReady";case 1056925771:return"NewDocument";case 3266255548:return"NewReply";case 1938400843:return"NotifyCommentDoesNotExist";case 3506486948:return"NoTouchStart";case 1448619089:return"O365SwitcherReady";case 3389570779:return"OnDemandLoadingDialogCancelled";case 3963562945:return"OnDemandLoadingDialogCompleted";case 3476734992:return"OpenBasicChatPane";case 2068502235:return"OpenDocument";case 3427834559:return"OpenDocumentLabelPane";case 2155708348:return"OpenDocumentUrl";case 2596942163:return"OpenInBrowser";case 2683007645:return"OpenSwitcher";case 2349775795:return"OpenTermsOfUseLink";case 1959943459:return"OpenUrlInNewTab";case 628793421:return"OreoOnToggleRibbonState";case 3723784884:return"OtelSendSampleOfEvents";case 2888780028:return"OtelSendTelemetryEvents";case 1298584397:return"OtelSendTelemetryEventsPeriodically";case 929022654:return"CoauthoringCommand";case 3236517055:return"CoauthoringCommandMenuClose";case 250882013:return"CoauthoringCommandMenuOpen";case 1285265560:return"CoauthoringPopulateFlyout";case 3798167515:return"CoauthoringQueryStatus";case 2052777571:return"CoauthoringRefreshControl";case 4033456482:return"CoauthoringUserButtonClick";case 2133437452:return"PeopleSuggestion1";case 2133437453:return"PeopleSuggestion2";case 2133437454:return"PeopleSuggestion3";case 1397611854:return"PerformUserAuth";case 1500655301:return"PinOrUnpinFont";case 3675896289:return"PopulateDialogMenu";case 2799130311:return"PopulateMruMenu";case 2074131365:return"PopulateNewMenu";case 1145315516:return"PopulateSensitivityFlyout";case 3934434802:return"PreviewPanelTabBackward";case 1596970964:return"PreviewPanelTabForward";case 1208554566:return"PrivacyLink";case 3511208508:return"QueryActivateTranslatorApp";case 1309495434:return"QueryAddInCommandsLoadStatus";case 3847984948:return"QueryBreadcrumbDocName";case 3874562422:return"QueryBuildVersion";case 3720034241:return"QueryClearSearch";case 825574620:return"QueryCopyAndEditButton";case 1478537812:return"QueryDocChatButtonStatus";case 860152194:return"QueryEntitledAppsForOffice";case 3887408216:return"QueryEnvironmentName";case 1369572530:return"QueryFindMatchCase";case 3914542e3:return"QueryFindWholeWord";case 49122376:return"QueryPackageInitialized";case 497870830:return"QueryPolicyLabel";case 3134802707:return"QuerySensitivity";case 2875864574:return"QuerySensitivitySubFlyout";case 991261903:return"QuerySensitivityToggleButton";case 2793115165:return"QuerySessionId";case 1536028887:return"QuerySimplifiedRibbonIsEnabled";case 1557026322:return"QueryStaticUiTouchMode";case 1949220702:return"QueryToggleAccCheckerButton";case 1715205439:return"QueryToggleActivityPane";case 1059068017:return"QueryToggleCatchUpFlyout";case 847427893:return"QueryToggleCommentPane";case 433063458:return"QueryZoomText";case 2576944597:return"RaiseActionToHost";case 269161319:return"RebootUrlOnUiHost";case 2999339013:return"RedoCommentAction";case 543799107:return"RefreshAddinCommands";case 2854028228:return"RefreshChatControl";case 2924716042:return"RegionMoveBackward";case 1656936120:return"RegionMoveForward";case 741381681:return"RegisterAppActivatedEvent";case 1897077126:return"RenameFile";case 3502386740:return"RenameMostRecentlyUsedFileEntry";case 1197060601:return"ReplyWithChanges";case 3237171630:return"ReportAbuseLink";case 4248596885:return"ReportFileMenuPageAbout";case 1074909883:return"ReportFileMenuPageHome";case 127178350:return"ReportFileMenuPageInfo";case 1852071536:return"ReportFileMenuPageNew";case 2392426770:return"ReportFileMenuPageOpen";case 2971760737:return"ReportFileMenuPagePrint";case 4100738419:return"ReportFileMenuPageSaveAs";case 720070809:return"ReportFileMenuPageShare";case 4133531354:return"ReportFileMenuPageSwitch";case 3048126886:return"ReportFileMenuPageTransform";case 3865908344:return"ReportFileMenuPageUnknown";case 1509043591:return"ReportFreemiumUpsellBadgeClicked";case 975509583:return"ReportFreemiumUpsellBadgeDisplayed";case 3865601672:return"ReportFreemiumUpsellDialogClicked";case 2275483468:return"ReportFreemiumUpsellDialogDismissed";case 4142738798:return"ReportFreemiumUpsellDialogDisplayed";case 4177432571:return"ReportFreemiumUpsellEligibleClicked";case 2539564555:return"ReportFreemiumUpsellEligibleDisplayed";case 1355500294:return"ReportLegacyRibbonLoaded";case 1128336726:return"ReportMRUFromHomePage";case 105169305:return"ReportMRUFromOpenPage";case 4188650553:return"ReportOneLineRibbonLoaded";case 2050007412:return"ReportRibbonModeMLR";case 2050007578:return"ReportRibbonModeSLR";case 2363934117:return"ReportSwitchFromLegacyRibbon";case 422501225:return"ReportSwitchFromSimplifedRibbon";case 903886994:return"ReportTabAddins";case 1120156565:return"ReportTabChart";case 1449630229:return"ReportTabData";case 3221800135:return"ReportTabDeveloper";case 3099434941:return"ReportTabDrawing";case 3696531680:return"ReportTabFormulas";case 2625726220:return"ReportTabHelp";case 4191810468:return"ReportTabHome";case 469886678:return"ReportTabInsert";case 491924414:return"ReportTabPageLayout";case 3328108543:return"ReportTabReview";case 2527431031:return"ReportTabSwitch";case 3841439565:return"ReportTabUnknown";case 2652577546:return"ReportTabView";case 1240571126:return"ReportTemplateFromHomePage";case 3302080867:return"ReportTemplateFromNewPage";case 1380507044:return"ReportVersionHistorySaveACopySuccess";case 951489623:return"ReportVersionHistorySaveACopyFailure";case 3169500754:return"RequestFontInfo";case 1323818969:return"RestartExtensionTaskPane";case 637959088:return"ResumeFocusWithDirection";case 1782110672:return"RetrieveAddInCommandsEntitlementsList";case 1596290176:return"RetryOpenInClient";case 4169072475:return"RibbonEsc";case 1047758638:return"RibbonFocus";case 536345575:return"RibbonModeToggledToMLR";case 4031133701:return"RibbonModeToggledToSLR";case 1254348094:return"RibbonMoveBackward";case 2187030096:return"RibbonMoveForward";case 1308255763:return"RibbonStateChanged";case 3190032724:return"RibbonTabSwitched";case 4246497969:return"SaveACopy";case 2316717900:return"SaveAsToHost";case 3070187925:return"SaveFileChange";case 617689800:return"SaveToCloudStorage";case 3050207199:return"SaveToSharePoint";case 2918242107:return"SearchHelp";case 1873541548:return"SelectNextComment";case 4242021840:return"SelectPrevComment";case 2935633379:return"SetSensitivity";case 1384511460:return"SharedCommentsCancelCommentCreateThread";case 3401575755:return"SharedCommentsCommitComment";case 1426025625:return"SharedCommentsCommitDraft";case 2297956587:return"SharedCommentsCreateReply";case 3866509012:return"SharedCommentsCreateReplyWithMentions";case 2104859114:return"SharedCommentsCreateReplyWithTaskAssigned";case 2716070047:return"SharedCommentsCreateThread";case 355666834:return"SharedCommentsCreateThreadWithMentions";case 2470061772:return"SharedCommentsCreateThreadWithTaskAssigned";case 3191809076:return"SharedCommentsDeletePost";case 1912911518:return"SharedCommentsDeleteThread";case 1414137793:return"SharedCommentsDeleteThreadWithTask";case 1127700748:return"SharedCommentsDiscardDraft";case 1978095600:return"SharedCommentsPresentLinkToCommentAction";case 243899744:return"SharedCommentsReopenThread";case 1615492167:return"SharedCommentsReopenThreadWithTask";case 738982675:return"SharedCommentsRequestInitCommentSession";case 537095687:return"SharedCommentsResolveThread";case 88639566:return"SharedCommentsResolveThreadWithTask";case 334636250:return"SharedCommentsSelectComment";case 2079612261:return"SharedCommentsUpdateCommentBodyAction";case 2529583086:return"ShowAccessibilityCheckerPane";case 3276527670:return"ShowAccessibilityHelpDialog";case 749424676:return"ShowActivityPane";case 516359383:return"ShowAddInCommandsLoadStatusCallout";case 2269104277:return"ShowAddInErrorDialog";case 3510751882:return"ShowCommentPane";case 4284341431:return"ShowContextMenu";case 2269433685:return"ShowContextMenuWithFloatie";case 4193807224:return"ShowDialogMenu";case 2451283737:return"ShowExtensionTaskpane";case 3681556347:return"ShowFileVersion";case 459047735:return"ShowFloatie";case 2391539661:return"ShowFloatPane";case 1203507006:return"ShowGrantUserAccessDialog";case 2603175857:return"ShowInsightsForSuggestion";case 2382951455:return"ShowRenameDialog";case 2679862750:return"ShowRenameFlyout";case 2638199087:return"ShowRenameDisabledDialog";case 83993843:return"ShowSmartLookupForSuggestion";case 545765261:return"ShowSmartLookupFromCommand";case 2220417879:return"ShowThirdPartyNotices";case 2583751502:return"ShowTrustCenter";case 2517401660:return"ShowUILessDialog";case 466976539:return"ShowVersionHistoryDialog";case 1738002952:return"ShowZoomDialog";case 4196619892:return"SignIn";case 3231625709:return"SimulateO365ShellServiceReceived";case 606289265:return"SmartLookupForTellMe";case 1621589088:return"StartPinchToZoom";case 1550573691:return"SwitcherTileClick";case 380914761:return"TabSwitch";case 2652476189:return"TellMe";case 4054875485:return"TellMeAccessibilityMenuText";case 2751631965:return"TellMeCacheAsyncMenuRefresh";case 815990803:return"TellMeFocusInput";case 586156566:return"TellMeInteractionBegin";case 878547493:return"TellMeLogCommandExecuted";case 1024534176:return"TellMeLogInputBlur";case 2303219627:return"TellMeLogInputFocus";case 4266170064:return"TellMeLogMenuClose";case 2480888384:return"TellMeLogMenuOpen";case 1708531416:return"TellMeLogOfficeAppStatusQuery";case 3243793933:return"TellMeRestoreFocus";case 1404166600:return"TellMeTryQuery";case 1956545633:return"ToggleActivityPane";case 2145510275:return"ToggleAnimations";case 3418267371:return"ToggleCatchUpFlyout";case 2288458806:return"ToggleChatPane";case 2281051331:return"ToggleCommentPane";case 2758000563:return"ToggleRibbonState";case 2684863833:return"ToggleRibbonUX";case 1342108365:return"ToggleRibbonUXDialog";case 941487903:return"ToggleSensitivity";case 2478534165:return"TouchStart";case 1468994080:return"Training";case 3485513367:return"TriggerFloodgateSurvey";case 3901198658:return"TryMacOffice";case 1391456747:return"TryMacOfficeFromPowerPointViewer";case 201621520:return"TryMacOfficeFromWordViewer";case 1773624819:return"TryOffice";case 4268365028:return"TryOfficeFromPowerPointViewer";case 2578423837:return"TryOfficeFromWordViewer";case 215809929:return"TryOfficeThroughTellMe";case 3466807785:return"UndoCommentAction";case 2112877354:return"UpdateCommandUI";case 1852918846:return"UpdateSaveStatusForHeader";case 3649559640:return"UpdateVersionsPane";case 2424604265:return"UserSurveyCancel";case 3800318691:return"UserSurveySubmit";case 3329796304:return"SupportsExchangeRestApisTest";case 3182458430:return"VersionHistory";case 1255721029:return"WhatsNew";case 3574662461:return"WolframForSearch";case 2988588587:return"Workflow";case 2910828042:return"ZoomDialogFocusBackward";case 2095185708:return"ZoomDialogFocusForward"}return null},e}();r.accCheckerFocusBackward=617890675,r.accCheckerFocusBottom=2971500747,r.accCheckerFocusForward=3772228079,r.accCheckerFocusTop=1785655699,r.accessibilityHelp=83795095,r.accessibilityHelpDialogFocusBackward=389865630,r.accessibilityHelpDialogFocusForward=3803697328,r.activateAppForOffice=1099072191,r.activateTranslatorApp=1743607468,r.activityNotificationButtonHandler=1750752436,r.activityNotificationClosed=3602816928,r.addInCommandsActionHandler=1402209562,r.alwaysEnabled=798637440,r.answerForSearch=3030242601,r.answerForSearchSingleLine=587759533,r.amutTest1=2434078920,r.amutTest2=2434078917,r.amutTest3=2434078918,r.animation=3896010204,r.anonymousCreationNavigateAfterSave=613275288,r.anonymousCreationSaveToHost=2316947260,r.appSettingsRefreshSkipCache=2799657174,r.authenticationLost=2175352112,r.authenticationRestored=2556904104,r.blockIfFocusedTextField=4289528682,r.blockIfNotFocusedTextField=3551492845,r.breadcrumbLinkClick=2279655429,r.businessBarButtonOne=954512041,r.businessBarButtonTwo=1404592381,r.businessBarClose=3484823337,r.businessBarInvoke=3786550719,r.businessBarLink=2119511063,r.cancelPresenceTooltips=1281138585,r.cancelSigninBusinessBar=1915117369,r.cancelSigninDialog=3270784282,r.catchUpPassiveAwarenessSession=1783852782,r.catchUpActiveAwarenessSession=1206905761,r.checkTab=1168274369,r.checkTabShift=3134914741,r.checkUserAccessAndGrantPermissionsTest=3695056554,r.checkUserAccessTest=2598811989,r.clearSearch=2635327499,r.clearSearchFromSearchMenu=241072808,r.close=3033402446,r.closeAccessibilityCheckerPane=1895329487,r.closeEnrichmentPane=1520278933,r.closeExtensionTaskPane=1530887760,r.closeSwitcher=953328883,r.coauthorsRendered=691867605,r.commentActivityPreviewed=3411172825,r.commentActivitySelected=36098707,r.commentBeginRefresh=3259256685,r.commentBeginRefreshRefused=1637502579,r.commentBeginSucceeded=863375655,r.commentCancelled=1510212254,r.commentDeeplinkOpened=1137396240,r.commentDelete=467845448,r.commentDone=375707647,r.commentDownloadFailed=3609945866,r.commentDownloadSucceeded=159412208,r.commentHintClick=1951217806,r.commentHintMouseExit=2477668749,r.commentHintMouseOver=4198211167,r.commentNewCreated=1046295975,r.commentNewSaved=2462410242,r.commentReply=4041287661,r.commentSaveNetworkError=516537638,r.commentSaveRetry=4156131848,r.commentSaveSucceeded=1991982245,r.commentTabBackward=485487087,r.commentTabForward=2489743155,r.commentUndone=3103450156,r.commitNewDocumentTitle=1808554760,r.contactSupport=2609364291,r.conversation=710925581,r.copyAndEdit=1750478296,r.copyLink=3505086889,r.createDocument=1278286187,r.decreaseZoom=195579685,r.definitions=1756450500,r.definitionsForTellMe=2114287254,r.dialogAction=211953924,r.dialogCancel=3756639316,r.dialogClose=844297214,r.dialogMove=1245654357,r.dialogSecondaryAction=646039090,r.dialogTertiaryAction=1825605114,r.digitalPrintToSwaySlabClicked=779285039,r.dimeLaunch=4275690876,r.dismissNewCommentActivityIndicator=3619977465,r.disposeCrossDocumentMessenger=3113540593,r.doBrowserDefault=537152338,r.documentLoaded=1169404878,r.doesCommentExist=567929329,r.doNothing=336231556,r.doNothingInEdit=1203133001,r.downloadACopy=3555692408,r.downloadACopyDownloadButtonClick=1695673896,r.editComment=2619015155,r.endPinchToZoom=2413704991,r.editDocument=291542435,r.executeAddinAction=1257657435,r.executeDynamicAddInCommandsAPI=3280707168,r.executeUnitTests=1176360680,r.executeUnitTestsBvt=2281252844,r.F6=1261644258,r.f6shift=715899390,r.feedbackSubmit=1754333801,r.feedbackCancel=3019354063,r.fileNameUpdate=3537588550,r.fileProperties=512688659,r.fileSharing=981334692,r.fileSuggestion1=2260671807,r.fileSuggestion2=2260671810,r.fileSuggestion3=2260671809,r.findReplaceInDocument=3541645273,r.findInDocument=1540292897,r.findMatchCase=2398455418,r.findWholeWord=1783557e3,r.fireGetRelevantActivities=15750502,r.firstRunExperienceCompleted=1486778386,r.firstRunExperienceFocusBackward=3016992658,r.firstRunExperienceFocusForward=1501863744,r.firstRunExperienceShowUI=672565674,r.focusToBrowser=710478303,r.freemiumUpsellBadge=348609604,r.freemiumUpsellDialogShowUI=4180531998,r.freemiumUpsellEligible=1274543852,r.getAnimationStats=4288982261,r.getUserContactsTest=3890502328,r.getUserProfilePictureTest=3094869204,r.giveFeedback=802602464,r.grantUserAccessTest=577991405,r.help=1454393937,r.hideActivityPane=4065325971,r.hideCommentPane=2493123577,r.hideUILessDialog=1592314317,r.hostUnload=3107136749,r.increaseZoom=3018530951,r.initializeRenameUIHandler=3740310824,r.insertAgaveFromOsf=3553159035,r.insertOfficeAddin=56493533,r.insights=1435347209,r.insightsForTellMe=3317204163,r.invokeDictionarySerpletContextMenu=2823076269,r.invokeFilesSerplet=2670256092,r.invokeFilesSerpletHomeTab=234181094,r.invokeImageSerpletContextMenu=4149966010,r.invokeSynonymsSerpletContextMenu=720345883,r.invokeInDocSerplet=3565729580,r.invokeSerplet=1914896509,r.invokeSerpletRibbon=4195071443,r.invokeSerpletContextMenu=2861781337,r.invokeSerpletTellMeZeroTerm=3359903192,r.invokeZeroTermSerpletContextMenu=3087426977,r.isJoined=3799468329,r.joinChatThread=2246375352,r.keyManagerCommandUnitTest=57698967,r.launchAddInCommands=407117407,r.launchAppForOfficeDialog=1945259303,r.launchFileMenu=1784018444,r.launchMenu=951969558,r.launchSigninWindow=1478840041,r.launchWildFireBusinessBar=2531463828,r.livePersonaCardAction=2153376084,r.moveToFolder=1182470434,r.moveToFolderCompleteByHost=2482841374,r.multiTouch=3475093410,r.newBrowserSuggestionClicked=3734060499,r.newComment=2423504651,r.newCommentActivityReady=1002198721,r.newDocument=1056925771,r.newReply=3266255548,r.notifyCommentDoesNotExist=1938400843,r.noTouchStart=3506486948,r.o365SwitcherReady=1448619089,r.onDemandLoadingDialogCancelled=3389570779,r.onDemandLoadingDialogCompleted=3963562945,r.openBasicChatPane=3476734992,r.openDocument=2068502235,r.openDocumentLabelPane=3427834559,r.openDocumentUrl=2155708348,r.openInBrowser=2596942163,r.openSwitcher=2683007645,r.openTermsOfUseLink=2349775795,r.openUrlInNewTab=1959943459,r.oreoOnToggleRibbonState=628793421,r.otelSendSampleOfEvents=3723784884,r.otelSendTelemetryEvents=2888780028,r.otelSendTelemetryEventsPeriodically=1298584397,r.coauthoringCommand=929022654,r.coauthoringCommandMenuClose=3236517055,r.coauthoringCommandMenuOpen=250882013,r.coauthoringPopulateFlyout=1285265560,r.coauthoringQueryStatus=3798167515,r.coauthoringRefreshControl=2052777571,r.coauthoringUserButtonClick=4033456482,r.peopleSuggestion1=2133437452,r.peopleSuggestion2=2133437453,r.peopleSuggestion3=2133437454,r.performUserAuth=1397611854,r.pinOrUnpinFont=1500655301,r.populateDialogMenu=3675896289,r.populateMruMenu=2799130311,r.populateNewMenu=2074131365,r.populateSensitivityFlyout=1145315516,r.previewPanelTabBackward=3934434802,r.previewPanelTabForward=1596970964,r.privacyLink=1208554566,r.queryActivateTranslatorApp=3511208508,r.queryAddInCommandsLoadStatus=1309495434,r.queryBreadcrumbDocName=3847984948,r.queryBuildVersion=3874562422,r.queryClearSearch=3720034241,r.queryCopyAndEditButton=825574620,r.queryDocChatButtonStatus=1478537812,r.queryEntitledAppsForOffice=860152194,r.queryEnvironmentName=3887408216,r.queryFindMatchCase=1369572530,r.queryFindWholeWord=3914542e3,r.queryPackageInitialized=49122376,r.queryPolicyLabel=497870830,r.querySensitivity=3134802707,r.querySensitivitySubFlyout=2875864574,r.querySensitivityToggleButton=991261903,r.querySessionId=2793115165,r.querySimplifiedRibbonIsEnabled=1536028887,r.queryStaticUiTouchMode=1557026322,r.queryToggleAccCheckerButton=1949220702,r.queryToggleActivityPane=1715205439,r.queryToggleCatchUpFlyout=1059068017,r.queryToggleCommentPane=847427893,r.queryZoomText=433063458,r.raiseActionToHost=2576944597,r.rebootUrlOnUiHost=269161319,r.redoCommentAction=2999339013,r.refreshAddinCommands=543799107,r.refreshChatControl=2854028228,r.regionMoveBackward=2924716042,r.regionMoveForward=1656936120,r.registerAppActivatedEvent=741381681,r.renameFile=1897077126,r.renameMostRecentlyUsedFileEntry=3502386740,r.replyWithChanges=1197060601,r.reportAbuseLink=3237171630,r.reportFileMenuPageAbout=4248596885,r.reportFileMenuPageHome=1074909883,r.reportFileMenuPageInfo=127178350,r.reportFileMenuPageNew=1852071536,r.reportFileMenuPageOpen=2392426770,r.reportFileMenuPagePrint=2971760737,r.reportFileMenuPageSaveAs=4100738419,r.reportFileMenuPageShare=720070809,r.reportFileMenuPageSwitch=4133531354,r.reportFileMenuPageTransform=3048126886,r.reportFileMenuPageUnknown=3865908344,r.reportFreemiumUpsellBadgeClicked=1509043591,r.reportFreemiumUpsellBadgeDisplayed=975509583,r.reportFreemiumUpsellDialogClicked=3865601672,r.reportFreemiumUpsellDialogDismissed=2275483468,r.reportFreemiumUpsellDialogDisplayed=4142738798,r.reportFreemiumUpsellEligibleClicked=4177432571,r.reportFreemiumUpsellEligibleDisplayed=2539564555,r.reportLegacyRibbonLoaded=1355500294,r.reportMRUFromHomePage=1128336726,r.reportMRUFromOpenPage=105169305,r.reportOneLineRibbonLoaded=4188650553,r.reportRibbonModeMLR=2050007412,r.reportRibbonModeSLR=2050007578,r.reportSwitchFromLegacyRibbon=2363934117,r.reportSwitchFromSimplifedRibbon=422501225,r.reportTabAddins=903886994,r.reportTabChart=1120156565,r.reportTabData=1449630229,r.reportTabDeveloper=3221800135,r.reportTabDrawing=3099434941,r.reportTabFormulas=3696531680,r.reportTabHelp=2625726220,r.reportTabHome=4191810468,r.reportTabInsert=469886678,r.reportTabPageLayout=491924414,r.reportTabReview=3328108543,r.reportTabSwitch=2527431031,r.reportTabUnknown=3841439565,r.reportTabView=2652577546,r.reportTemplateFromHomePage=1240571126,r.reportTemplateFromNewPage=3302080867,r.reportVersionHistorySaveACopySuccess=1380507044,r.reportVersionHistorySaveACopyFailure=951489623,r.requestFontInfo=3169500754,r.restartExtensionTaskPane=1323818969,r.resumeFocusWithDirection=637959088,r.retrieveAddInCommandsEntitlementsList=1782110672,r.retryOpenInClient=1596290176,r.ribbonEsc=4169072475,r.ribbonFocus=1047758638,r.ribbonModeToggledToMLR=536345575,r.ribbonModeToggledToSLR=4031133701,r.ribbonMoveBackward=1254348094,r.ribbonMoveForward=2187030096,r.ribbonStateChanged=1308255763,r.ribbonTabSwitched=3190032724,r.saveACopy=4246497969,r.saveAsToHost=2316717900,r.saveFileChange=3070187925,r.saveToCloudStorage=617689800,r.saveToSharePoint=3050207199,r.searchHelp=2918242107,r.selectNextComment=1873541548,r.selectPrevComment=4242021840,r.setSensitivity=2935633379,r.sharedCommentsCancelCommentCreateThread=1384511460,r.sharedCommentsCommitComment=3401575755,r.sharedCommentsCommitDraft=1426025625,r.sharedCommentsCreateReply=2297956587,r.sharedCommentsCreateReplyWithMentions=3866509012,r.sharedCommentsCreateReplyWithTaskAssigned=2104859114,r.sharedCommentsCreateThread=2716070047,r.sharedCommentsCreateThreadWithMentions=355666834,r.sharedCommentsCreateThreadWithTaskAssigned=2470061772,r.sharedCommentsDeletePost=3191809076,r.sharedCommentsDeleteThread=1912911518,r.sharedCommentsDeleteThreadWithTask=1414137793,r.sharedCommentsDiscardDraft=1127700748,r.sharedCommentsPresentLinkToCommentAction=1978095600,r.sharedCommentsReopenThread=243899744,r.sharedCommentsReopenThreadWithTask=1615492167,r.sharedCommentsRequestInitCommentSession=738982675,r.sharedCommentsResolveThread=537095687,r.sharedCommentsResolveThreadWithTask=88639566,r.sharedCommentsSelectComment=334636250,r.sharedCommentsUpdateCommentBodyAction=2079612261,r.showAccessibilityCheckerPane=2529583086,r.showAccessibilityHelpDialog=3276527670,r.showActivityPane=749424676,r.showAddInCommandsLoadStatusCallout=516359383,r.showAddInErrorDialog=2269104277,r.showCommentPane=3510751882,r.showContextMenu=4284341431,r.showContextMenuWithFloatie=2269433685,r.showDialogMenu=4193807224,r.showExtensionTaskpane=2451283737,r.showFileVersion=3681556347,r.showFloatie=459047735,r.showFloatPane=2391539661,r.showGrantUserAccessDialog=1203507006,r.showInsightsForSuggestion=2603175857,r.showRenameDialog=2382951455,r.showRenameFlyout=2679862750,r.showRenameDisabledDialog=2638199087,r.showSmartLookupForSuggestion=83993843,r.showSmartLookupFromCommand=545765261,r.showThirdPartyNotices=2220417879,r.showTrustCenter=2583751502,r.showUILessDialog=2517401660,r.showVersionHistoryDialog=466976539,r.showZoomDialog=1738002952,r.signIn=4196619892,r.simulateO365ShellServiceReceived=3231625709,r.smartLookupForTellMe=606289265,r.startPinchToZoom=1621589088,r.switcherTileClick=1550573691,r.tabSwitch=380914761,r.tellMe=2652476189,r.tellMeAccessibilityMenuText=4054875485,r.tellMeCacheAsyncMenuRefresh=2751631965,r.tellMeFocusInput=815990803,r.tellMeInteractionBegin=586156566,r.tellMeLogCommandExecuted=878547493,r.tellMeLogInputBlur=1024534176,r.tellMeLogInputFocus=2303219627,r.tellMeLogMenuClose=4266170064,r.tellMeLogMenuOpen=2480888384,r.tellMeLogOfficeAppStatusQuery=1708531416,r.tellMeRestoreFocus=3243793933,r.tellMeTryQuery=1404166600,r.toggleActivityPane=1956545633,r.toggleAnimations=2145510275,r.toggleCatchUpFlyout=3418267371,r.toggleChatPane=2288458806,r.toggleCommentPane=2281051331,r.toggleRibbonState=2758000563,r.toggleRibbonUX=2684863833,r.toggleRibbonUXDialog=1342108365,r.toggleSensitivity=941487903,r.touchStart=2478534165,r.training=1468994080,r.triggerFloodgateSurvey=3485513367,r.tryMacOffice=3901198658,r.tryMacOfficeFromPowerPointViewer=1391456747,r.tryMacOfficeFromWordViewer=201621520,r.tryOffice=1773624819,r.tryOfficeFromPowerPointViewer=4268365028,r.tryOfficeFromWordViewer=2578423837,r.tryOfficeThroughTellMe=215809929,r.undoCommentAction=3466807785,r.updateCommandUI=2112877354,r.updateSaveStatusForHeader=1852918846,r.updateVersionsPane=3649559640,r.userSurveyCancel=2424604265,r.userSurveySubmit=3800318691,r.supportsExchangeRestApisTest=3329796304,r.versionHistory=3182458430,r.whatsNew=1255721029,r.wolframForSearch=3574662461,r.workflow=2988588587,r.zoomDialogFocusBackward=2910828042,r.zoomDialogFocusForward=2095185708,Object(i.a)(r,"CommonCommands",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(10),a=n(13),o=function(){function e(){this.assertHandler=null,this.allowAssertDebugging=void 0,this.disableAssert=void 0,this.enableMaxAssertCount=void 0,this.maxAssertCount=void 0,this.logListeners=void 0,this.shouldLogFunction=null,this.shouldLogCallstackFunction=null}return e.getDefaultDebugSettings=function(){return new e},e}();Object(i.a)(o,"DebugSettings",null,[]);var s=n(3),l=n(199);function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"Debug",(function(){return p}));var p=function(){function e(){}var t,i,u;return e.breakpoint=function(){0},e.reportAssertToTestHarness=function(e,t){var i=n(1).AFrameworkApplication,r=t?l.a(t):"not tagged",o=new Sys.StringBuilder;o.appendLine("Assert ["+r+"] OAUTOBUGTAG:CLS[WebToadBrowserProductErrorAssert]["+r+"][][][]ENDOABT  "),o.append(e),i.tryReportErrorToTestHarness(a.a.replaceAll(o.toString(),"\r\n","\\r\\n"))},e.generateCallstack=function(t,n,i,r){void 0===t&&(t=null),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===r&&(r=!1);var o=new Sys.StringBuilder,s=[];r||e.isUnitTest||e.addAnonymousFunctionNameFieldToAtlasTypes();var l=1;try{for(var c=t||arguments.callee;c&&l<40;c=c.caller,l++){var u=e.getFunctionName(c);if(!u.startsWith(e._commonDebugFunctionPrefix)){var d=e.generateSignature(c,i)||"";if(n)o.append(u),o.append(d),o.appendLine();else{var p="anonymous"===u;o.append(String.format(p?'<function depth="{0}" signature="{1}"><![CDATA[{2}]]></function>':'<function depth="{0}" signature="{1}" />',l-1,a.a.htmlEncode(u+d),p?c.toString():""))}if(Array.contains(s,c)){n&&o.appendLine("--[JavaScript recursion]--");break}Array.add(s,c)}}40===l&&n&&o.appendLine("***[Maximum callstack depth reached]***")}catch(e){n?(o.append("Exception: "),o.append(e.message),o.appendLine()):o.append(String.format('<function depth="{0}" signature="{1}" />',l-1,a.a.htmlEncode("Exception: "+e.message)))}return o.toString()},e.generateMethodFrame=function(t,n,i){void 0===i&&(i=!1);var r="";i||e.isUnitTest||e.addAnonymousFunctionNameFieldToAtlasTypes();try{for(var a=t||arguments.callee;a&&((r=e.getFunctionName(a)).startsWith(e._commonDebugFunctionPrefix)||r.startsWith("$$ct"));a=a.caller);}catch(e){return"[Failed to find current method name - exception "+e.toString()+"]"}if(null==r)return"[Failed to find current method name]";if(n){var o=r.indexOf("__");-1!==o&&(r=r.substr(o+2));var s=r.lastIndexOf("$");-1!==s&&(r=r.substring(0,s))}return r},e.generateSignature=function(t,n){if(!t)return null;var i,r=null,a=t.toString().match(e._simpleSignatureRegex);if(a&&3===a.length&&(r=a[2]),!n)return r;i=r&&r.length>=2?r.substring(r.indexOf("(")+1,r.length-1).split(","):[];var o=t.arguments;if(o){for(var s=new Sys.StringBuilder("("),l=i.length,c=0,u=o.length;c<u;c++){var d=void 0;if(c<l){var p=i[c];p=p?p.trim():"",s.append(p),s.append(" = ")}var h=o[c];if(null===h)d="null";else{var m=typeof h;switch(m){case"function":case"undefined":case"object":d=m;break;case"number":case"boolean":d=h.toString();break;case"string":d='"'+h+'"';break;default:d="unknown ("+m+")"}}s.append(d),c<u-1&&s.append(", ")}return s.append(")"),s.toString()}return null},e.getFunctionName=function(t){var i,a=n(1).AFrameworkApplication;if(a.appSettingsManager&&a.appSettingsManager.getBooleanAppSetting("FixAnonymousCallstacksIsEnabled")){i=t.name;var o=t[e._functionLabelFieldName];i&&i.length?"anonymous"===i.toLowerCase()&&r.a.isInternetExplorer&&(s.ULS.sendTraceTag(0,201,15,String.format("Reporting decorated name instead of 'anonymous' in the callstack. Decorated name = {0}. Function body = {1}.",o,t.toString())),i=o):i=o}else i=t.name||t[e._functionLabelFieldName];if(null==i){var l=t.toString().match(e._functionNameRegex);if(!l||2!==l.length)return"anonymous";i=l[1]}return i.trim().length>0?i:"anonymous"},e.addAnonymousFunctionNameFieldToAtlasTypes=function(){for(var t,n=c(Type.getRootNamespaces());!(t=n()).done;){var i=t.value;0,e.addAnonymousFunctionNameFieldsForNamespace(i)}},e.nnlpt=function(t){return t.getName().replace(e._normalizeNamespaceRegex,"_")},e.normalizeNamespaceLabelPrefix=function(t){return t.getName().replace(e._normalizeNamespaceRegex,"_")},e.addAnonymousFunctionNameFieldsForNamespace=function(t){for(var n in t){var i={key:n,value:t[n]};try{var r=i.value;if(Type.isClass(r)){var a=r,o=e.nnlpt(a);if(void 0!==a.prototype){var s=a.prototype.constructor;void 0===s[e._functionLabelFieldName]&&(e.addAnonymousFunctionNameField(o,s,"",""),e.processObjectFieldDictionary(o,a.prototype,a.getBaseType()))}e.processObjectFieldDictionary(o,r,null)}else Type.isInterface(r)||Type.isEnum(r)||(Type.isNamespace(r)?e.addAnonymousFunctionNameFieldsForNamespace(r):e.addAnonymousFunctionNameField(e.normalizeNamespaceLabelPrefix(t),i.value,i.key,"_"))}catch(e){0}}},e.processObjectFieldDictionary=function(t,n,i){for(var r in n){var a={key:r,value:n[r]};if(!(Type.isClass(a.value)||i&&i.prototype[a.key]===a.value)){var o="$";i&&(o+="prototype$"),e.addAnonymousFunctionNameField(t,a.value,a.key,o)}}},e.addAnonymousFunctionNameField=function(t,n,i,r){"function"==typeof n&&"anonymous"===e.getFunctionName(n)&&(n[e._functionLabelFieldName]=t+r+i)},e.shouldLog=function(e,t){var n;return n=!1,n},e.methodFrame=function(t,n){return void 0===n&&(n=null),e.generateMethodFrame(n,t)},e.domElementLoggingInfo=function(t){var n=e.domElementInfo(t);t.parentNode&&(n+="\nwith Parent "+e.domElementInfo(t.parentNode));var i=t.innerHTML;return i.length<5e3?n+="\n InnerHTML: "+i:n+="\n InnerHTML too long",n},e.domElementInfo=function(e){return String.format("'{0}' tag named '{1}' class '{2}'",e.tagName,e.id,e.className)},t=e,u=[{key:"isUnitTest",get:function(){if(null==e._isUnitTest)try{e._isUnitTest=!(void 0===JVUnit||null===JVUnit)}catch(t){e._isUnitTest=!1}return e._isUnitTest}},{key:"debugSettings",get:function(){return e._debugSettings||(e._debugSettings=o.getDefaultDebugSettings()),e._debugSettings},set:function(t){e._debugSettings=t}},{key:"KomodoLoaded",get:function(){return window.self.g_liveBooksKomodoLoaded}},{key:"KomodoFailedToConnect",get:function(){return window.self.g_liveBooksKomodoFailedToConnect},set:function(e){window.self.g_liveBooksKomodoFailedToConnect=e}}],(i=null)&&d(t.prototype,i),u&&d(t,u),e}();p._debugSettings=null,p._logCache=void 0,p._flushing=void 0,p._komodoNodeProcessor=null,p._komodoLog=null,p._komodoMessageCenter=null,p._komodoContent=null,p._sysNamespaceLabeled=void 0,p._simpleSignatureRegex=new RegExp("function\\s*([^(]*)([^{]*\\))"),p._functionNameRegex=new RegExp("function\\s*([^(]*)\\("),p._normalizeNamespaceRegex=new RegExp("\\.","g"),p._functionLabelFieldName="__ulsFunctionName",p._commonDebugFunctionPrefix=p.nnlpt(p),p.shouldForwardToUls=!0,p.commonLevelMap=void 0,p._isUnitTest=null,p.alertAssertAdditionalInfo=null,p.ReadyForKomodo=!1,p._ignoredAssertCount=void 0,p._ignoredNameCount=void 0,Object(i.a)(p,"Debug",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(19);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){this._majorVersion=-1,this._minorVersion=-1}var t,n,i;return t=e,(n=[{key:"majorVersion",get:function(){return this._majorVersion},set:function(e){this._majorVersion=e}},{key:"minorVersion",get:function(){return this._minorVersion},set:function(e){this._minorVersion=e}}])&&a(t.prototype,n),i&&a(t,i),e}();Object(i.a)(o,"AndroidVersion",null,[]);var s=function(e,t){this.original=e,this.wrapped=t};Object(i.a)(s,"TimerFunctionData",null,[]);var l=n(3);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return u}));var u=function(){function e(){}var t,i,a;return e.$$cctor=function(){window.self;e._setTimeoutData=e.wrapTimerFunctionWithExceptionHandling("setTimeout"),e._setIntervalData=e.wrapTimerFunctionWithExceptionHandling("setInterval"),e._setImmediateData=e.wrapTimerFunctionWithExceptionHandling("setImmediate")},e.isChromeAtLeast=function(t){if(e.isWebKit){var n=window.navigator.userAgent.toLowerCase(),i=n.indexOf("chrome/");if(i>=0){var r=i+7,a=n.indexOf(".",r);if(a>0)return parseInt(n.substring(r,a))>=t}}return!1},e.browserSupportsSetActive=function(e){return!!e&&!!e.setActive},e.browserSupportsSendBeacon=function(){try{return"function"==typeof window.navigator.sendBeacon}catch(e){return!1}},e.browserSupportsCustomEvent=function(){try{return"CustomEvent"in window&&"function"==typeof window.CustomEvent}catch(e){return!1}},e.isRequestKeepAliveSupported=function(){try{return null!=Object.getOwnPropertyDescriptor(Request.prototype,"keepalive")}catch(e){return!1}},e.browserSupportsFetchKeepAlive=function(){try{return null!=e._supportsFetchKeepAlive||(e._supportsFetchKeepAlive=e.browserSupportsFetchApi&&e.isRequestKeepAliveSupported()),e._supportsFetchKeepAlive}catch(e){return!1}},e.isSafariAtLeast=function(t){if(e.isWebKit){var n=window.navigator.userAgent.toLowerCase(),i=n.indexOf("version/");if(i>=0){var r=i+8,a=n.length;return parseInt(n.substring(r,a))>=t}}return!1},e.checkWindowsNTVersion=function(){if(!e._ntVersionChecked){var t=new RegExp("Windows NT\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent);e._ntVersionChecked=!0,e._ntVersion=-1,null!=t&&t.length>=2&&(e._ntVersion=parseFloat(t[1]),isNaN(e._ntVersion)&&(e._ntVersion=-1))}},e.setOpacity=function(t,i){n(9).Debug;e.isInternetExplorerNonEdge&&!e.isInternetExplorer9Up?t.style.filter=1===i?"":"alpha(opacity="+100*i+")":t.style.opacity=i.toString()},e.supportsNoReferrer=function(){return e.isWebKitOrIEEdge||e.isFirefox},e.wrapTimerFunctionWithExceptionHandling=function(t){var i=window.self,a=Object(r.a)(Function,i[t]);return new s(a,(function(t,i){var o=n(9).Debug;if(e.isInternetExplorer10){var s=Object(r.a)(Function,t);s&&(t=function(){e.executeCodeInTryCatchWithExceptionLogging(s)})}return Sys.Application.get_isDisposing()?(l.ULS.sendTraceTag(595179603,210,50,"Unloading. Not queuing method [{0}] stack [{1}]",t,o.generateCallstack()),0):a(t,i)}))},e.executeCodeInTryCatchWithExceptionLogging=function(e){var t=n(305).setExceptionCallStack;try{e()}catch(e){throw t(e),e}},e.isWebSocketSupported=function(){return"undefined"!=typeof WebSocket},e.isSupportedPlugin=function(e){var t=window.navigator.plugins;if(!t||!t.length)return!1;for(var n=0;n<t.length;n++){if(t[n].name.toLowerCase().indexOf(e.toLowerCase())>=0)return!0}return!1},t=e,a=[{key:"isInternetExplorerNonEdge",get:function(){return Sys.Browser.agent===Sys.Browser.InternetExplorer}},{key:"isInternetExplorerOrEdge",get:function(){return e.isInternetExplorerNonEdge||e.isInternetExplorerEdge}},{key:"isNonStandardsCompliantIE",get:function(){return!!e.isInternetExplorerNonEdge&&(!window.document.documentMode||window.document.documentMode<=8)}},{key:"isInternetExplorer",get:function(){return e.isNonStandardsCompliantIE||e.isInternetExplorer9Up}},{key:"isInternetExplorer7",get:function(){return!!e.isInternetExplorerNonEdge&&!window.document.documentMode}},{key:"isInternetExplorer8",get:function(){return!!e.isInternetExplorerNonEdge&&!!window.document.documentMode&&8===window.document.documentMode}},{key:"isInternetExplorer9",get:function(){return!!e.isInternetExplorerNonEdge&&!!window.document.documentMode&&9===window.document.documentMode}},{key:"supportsSynchronousXhrDuringNavigate",get:function(){return!e.isChrome}},{key:"supportsExecCommandPaste",get:function(){return document.queryCommandSupported("paste")}},{key:"isInternetExplorer9Up",get:function(){return!!e.isInternetExplorerNonEdge&&!!window.document.documentMode&&window.document.documentMode>=9}},{key:"isInternetExplorer10",get:function(){return!!e.isInternetExplorerNonEdge&&!!window.document.documentMode&&10===window.document.documentMode}},{key:"isInternetExplorer10Up",get:function(){return!!e.isInternetExplorerNonEdge&&!!window.document.documentMode&&window.document.documentMode>=10}},{key:"isInternetExplorerEdge",get:function(){return window.navigator.userAgent.indexOf("Edge/")>=0}},{key:"isInternetExplorerMobile",get:function(){return window.navigator.userAgent.indexOf("IEMobile/11")>=0}},{key:"isInternetExplorer11Up",get:function(){return!!e.isInternetExplorerNonEdge&&!!window.document.documentMode&&window.document.documentMode>=11}},{key:"is64bitBrowser",get:function(){return window.navigator.userAgent.indexOf("Win64; x64;")>=0}},{key:"isIEOnWindows64",get:function(){var t=window.navigator.userAgent;return e.isInternetExplorerNonEdge&&(t.indexOf("Win64; x64;")>=0||t.indexOf("Win64; IA64;")>=0||t.indexOf("WOW64;")>=0)}},{key:"isFirefox",get:function(){return Sys.Browser.agent===Sys.Browser.Firefox}},{key:"isFirefox3Up",get:function(){return e.firefoxVersion>=3}},{key:"isFirefox4Up",get:function(){return e.firefoxVersion>=4}},{key:"firefoxVersion",get:function(){if(e.isFirefox){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf("firefox/");if(n>=0){var i=n+8,r=t.length;return parseInt(t.substring(i,r))}}return 0}},{key:"edgeVersion",get:function(){if(e.isInternetExplorerEdge){var t=e._edgeVersionRegularExpression.exec(window.navigator.appVersion);if(t&&2===t.length)return t[1]}return""}},{key:"isBingPreview",get:function(){return window.navigator.userAgent.toLowerCase().indexOf("bingpreview/")>=0}},{key:"isChrome76Up",get:function(){return e.isChromeAtLeast(76)}},{key:"isChrome",get:function(){return window.navigator.userAgent.toLowerCase().indexOf("chrome/")>=0&&!e.isInternetExplorerEdge}},{key:"isChromeiOS",get:function(){return window.navigator.userAgent.toLowerCase().indexOf("crios/")>=0}},{key:"isFirefoxiOS",get:function(){return window.navigator.userAgent.toLowerCase().indexOf("fxios/")>=0}},{key:"isSamsungInternet",get:function(){return window.navigator.userAgent.toLowerCase().indexOf("samsungbrowser/")>=0}},{key:"isElectron",get:function(){return window.navigator.userAgent.toLowerCase().indexOf("electron/")>=0&&e.isChrome}},{key:"electronVersion",get:function(){if(e.isElectron){var t=e._electronVersionRegularExpression.exec(window.navigator.appVersion);if(t&&2===t.length)return t[1]}return""}},{key:"isTeamsElectron",get:function(){var t=window.navigator.userAgent.toLowerCase();return e.isElectron&&t.indexOf("teams/")>=0}},{key:"isChromeOrIEEdge",get:function(){return window.navigator.userAgent.toLowerCase().indexOf("chrome/")>=0}},{key:"isWcosEdge",get:function(){if(null==e._isWcosEdge)try{e._isWcosEdge=null!=window.external&&null!=window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'==window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}return e._isWcosEdge}},{key:"supportsDomL2Selection",get:function(){return e._supportsDomL2SelectionChecked||(e._supportsDomL2Selection=!!window.self.getSelection,e._supportsDomL2SelectionChecked=!0),e._supportsDomL2Selection}},{key:"supportsCompositionEvents",get:function(){return e.isInternetExplorer9Up||e.isSafari4Up||e.isChromeOrIEEdge||e.isIPhone||e.isIPad}},{key:"supportsTextInputEvent",get:function(){return e.isInternetExplorer9Up||e.isSafari4Up||e.isChrome}},{key:"supportsInputEvent",get:function(){return e.isInternetExplorerEdge||e.isSafari4Up||e.isChrome||e.isFirefox}},{key:"supportsOpenInClientNpapiPlugin",get:function(){return e.isFirefox3Up}},{key:"supportsOpenInClientForAllApps",get:function(){var t=n(1).AFrameworkApplication;return(!e.isAndroid||!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("OICForAndroidIsEnabled"))&&(!e.isWcosEdge||!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("OICForWCOSIsEnabled"))}},{key:"supportsPerformanceNow",get:function(){return null==e._supportsPerformanceNow&&(e._supportsPerformanceNow=!!window.performance&&!!window.performance.now),e._supportsPerformanceNow}},{key:"browserSupportsServiceWorker",get:function(){return"serviceWorker"in navigator}},{key:"browserSupportsFetchApi",get:function(){try{return null!=e._supportsFetchApi||(e._supportsFetchApi="function"==typeof window.fetch&&"undefined"!=typeof Request),e._supportsFetchApi}catch(e){return!1}}},{key:"alwaysInImeMode",get:function(){return e.isAndroid}},{key:"supportsTextRange",get:function(){return!!window.self.document.body.createTextRange}},{key:"supportsWordBreakingRange",get:function(){if(null!=e._supportsExpandOnRangeObjects)return e._supportsExpandOnRangeObjects;if(!e.supportsTextRange)return!1;var t=window.self.document.createRange();return e._supportsExpandOnRangeObjects=!!t.expand,e._supportsExpandOnRangeObjects}},{key:"supportsPlacingIpInEmptySpan",get:function(){return!(e.isNonStandardsCompliantIE||e.isInternetExplorer11Up||e.isInternetExplorerEdge||e.isWebKit)}},{key:"isWebKit",get:function(){return Sys.Browser.agent===Sys.Browser.Safari&&!e.isInternetExplorerEdge}},{key:"isWebKitOrIEEdge",get:function(){return Sys.Browser.agent===Sys.Browser.Safari}},{key:"isSafari3Up",get:function(){return e.isSafariAtLeast(3)}},{key:"isSafari4Up",get:function(){return e.isSafariAtLeast(4)}},{key:"isSafari5Up",get:function(){return e.isSafariAtLeast(5)}},{key:"isSafari9Up",get:function(){return e.isSafariAtLeast(9)}},{key:"isSafari12Up",get:function(){return e.isSafariAtLeast(12)}},{key:"isOpera12Older",get:function(){return Sys.Browser.agent===Sys.Browser.Opera}},{key:"isOpera15Up",get:function(){return window.navigator.userAgent.indexOf("OPR")>=0}},{key:"isOpera",get:function(){return e.isOpera12Older||e.isOpera15Up}},{key:"isWindows",get:function(){return window.navigator.userAgent.indexOf("Windows")>=0}},{key:"isWindowsVistaUp",get:function(){return e.checkWindowsNTVersion(),e._ntVersion>=6}},{key:"isWindows8Up",get:function(){return e.checkWindowsNTVersion(),e._ntVersion>=6.2}},{key:"isMac",get:function(){return window.navigator.userAgent.indexOf("Macintosh")>=0}},{key:"isPpcMac",get:function(){return window.navigator.userAgent.indexOf("PPC Mac")>=0}},{key:"isLinux",get:function(){return window.navigator.userAgent.indexOf("Linux")>=0}},{key:"isIPad",get:function(){return null===e._isIPad&&(e._isIPad=window.navigator.userAgent.indexOf("iPad")>=0||e.isMac&&e.supportsTouch&&!e.isIPhone),e._isIPad}},{key:"iPadOsVersion",get:function(){if(e.isIPad){var t=window.navigator.userAgent,n=t.indexOf(" CPU OS ");if(n>=0){var i=n+8,r=t.length,a=parseInt(t.substring(i,r));if(a!==Number.NaN)return a}}return 0}},{key:"iPhoneOsMajorVersion",get:function(){if(e.isIPhone){var t=window.navigator.userAgent,n=t.indexOf("OS ");if(n>=0){var i=n+3,r=t.indexOf("_",i);if(r>0){var a=parseInt(t.substring(i,r));if(a!==Number.NaN)return a;l.ULS.sendTraceTag(589410829,306,10,"IPhone OS version NAN: {0}",t)}}}return 0}},{key:"isIPhone",get:function(){return window.navigator.userAgent.indexOf("iPhone")>=0}},{key:"isWindowsPhone",get:function(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}},{key:"isAndroid",get:function(){return window.navigator.userAgent.indexOf("Android")>=0}},{key:"androidVersion",get:function(){var t=new o;if(!e.isAndroid)return t;var n="";try{var i=(n=window.navigator.userAgent.toUpperCase()).indexOf(e._androidVersionPrefix),r=n.substr(i+e._androidVersionPrefix.length+1).indexOf(e._androidVersionSuffix),a=n.substr(i+e._androidVersionPrefix.length+1,r).split(e._androidVersionSeparator);t.majorVersion=parseInt(a[0].trim(),10),t.minorVersion=1===a.length?0:parseInt(a[1].trim(),10)}catch(e){l.ULS.sendTraceTag(595079326,306,10,"UserAgent Parse Failure: {0}",n)}return t}},{key:"isLocaleChina",get:function(){return"ZH-CN"===window.navigator.language.toUpperCase()}},{key:"isChromeOS",get:function(){return window.navigator.userAgent.indexOf("CrOS ")>=0}},{key:"chromeRevision",get:function(){if(e.isChrome){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf("chrome/");if(n>=0){var i=n+7,r=t.indexOf(".",i),a=t.substring(i,r);return parseInt(a)}}return 0}},{key:"isMobile",get:function(){return e.isIPad||e.isAndroid}},{key:"maxTouchPoints",get:function(){for(var e=["maxTouchPoints","msMaxTouchPoints"],t=0;t<e.length;t++){var n=window.navigator[e[t]];if(null!=n)return n}return 0}},{key:"supportsTouch",get:function(){return e.isAndroid||e.maxTouchPoints>0}},{key:"supportsMouse",get:function(){return!e.isIPad}},{key:"selectionShowsThroughOpaqueContent",get:function(){return e.isMobile}},{key:"isSupportedMacBrowser",get:function(){return e.isMac&&(e.isFirefox3Up||e.isSafari3Up)}},{key:"supportsInlineSVG",get:function(){return e.supportsSVG&&(!e.isFirefox||e.isFirefox4Up)}},{key:"supportsVML",get:function(){return e.isInternetExplorerNonEdge}},{key:"supportsSVG",get:function(){return!e.isNonStandardsCompliantIE}},{key:"isMobileBrowser",get:function(){return window.navigator.userAgent.indexOf("Mobile")>=0}},{key:"isChromiumEdge",get:function(){return window.navigator.userAgent.indexOf("Edg/")>=0}},{key:"setTimeoutData",get:function(){return e._setTimeoutData}},{key:"setIntervalData",get:function(){return e._setIntervalData}},{key:"setImmediateData",get:function(){return e._setImmediateData}},{key:"supportsDocumentImplementationCreateHtmlDocument",get:function(){return null==e._supportsDocumentImplementationCreateHtmlDocument&&(e._supportsDocumentImplementationCreateHtmlDocument=(e.isInternetExplorer10Up||!e.isInternetExplorerNonEdge)&&!!document.implementation&&!!document.implementation.createHTMLDocument),e._supportsDocumentImplementationCreateHtmlDocument}},{key:"supportsFullscreen",get:function(){return!!(document.webkitRequestFullscreen||document.msRequestFullscreen||document.mozRequestFullScreen||document.requestFullscreen)}},{key:"supportsWindowAtob",get:function(){return null==e._supportsWindowAtob&&(e._supportsWindowAtob=!!window.self.atob),e._supportsWindowAtob}},{key:"supportsMicrophoneAccessInIframe",get:function(){return e.isInternetExplorerEdge||e.isFirefox||e.isChrome}},{key:"supports32BitsZIndex",get:function(){return null==e._supports32BitsZIndex&&(e._supports32BitsZIndex=e.isInternetExplorerOrEdge||e.isSafari4Up||e.isChrome||e.isFirefox),e._supports32BitsZIndex}},{key:"browserNameForlogging",get:function(){return e._browserNameForLogging||(e.isInternetExplorerNonEdge?e._browserNameForLogging="InternetExplorer":e.isInternetExplorerEdge?e._browserNameForLogging="Edge":e.isChromiumEdge?e._browserNameForLogging="ChromiumEdge":e.isChrome&&window.chrome?e._browserNameForLogging="Chrome":e.isFirefox?e._browserNameForLogging="Firefox":e.isSafari3Up?e._browserNameForLogging="Safari3Up":e.isTeamsElectron?e._browserNameForLogging="TeamsElectron":e.isElectron?e._browserNameForLogging="Electron":e._browserNameForLogging="UnsupportedBrowser"),e._browserNameForLogging}},{key:"browserCodeForLogging",get:function(){return e.isInternetExplorerNonEdge?e._browserCodeForLogging=3:e.isInternetExplorerEdge?e._browserCodeForLogging=1:e.isChromiumEdge?e._browserCodeForLogging=8:e.isChrome&&window.chrome?e._browserCodeForLogging=0:e.isFirefox?e._browserCodeForLogging=2:e.isSafari3Up?e._browserCodeForLogging=4:e.isTeamsElectron?e._browserCodeForLogging=9:e.isElectron?e._browserCodeForLogging=7:e._browserCodeForLogging=5,e._browserCodeForLogging}},{key:"browserIdentifierForLogging",get:function(){return e.browserCodePrefix+e.browserCodeForLogging}},{key:"hasPdfReader",get:function(){return e.isInternetExplorerEdge||e.firefoxVersion>=18||e.isSupportedPlugin("Chrome PDF Viewer")||e.isSupportedPlugin("Microsoft Edge PDF Viewer")||e.isSupportedPlugin("WebKit built-in PDF")}}],(i=null)&&c(t.prototype,i),a&&c(t,a),e}();u._supportsDomL2SelectionChecked=!1,u._supportsDomL2Selection=!1,u._supportsDocumentImplementationCreateHtmlDocument=null,u._supportsWindowAtob=null,u._supports32BitsZIndex=null,u._supportsExpandOnRangeObjects=null,u._supportsFetchKeepAlive=null,u._supportsFetchApi=null,u._supportsPerformanceNow=null,u._isWcosEdge=null,u._ntVersionChecked=!1,u._ntVersion=-1,u._browserNameForLogging=null,u._browserCodeForLogging=6,u.browserCodePrefix="BCX",u._androidVersionPrefix="ANDROID",u._androidVersionSeparator=".",u._androidVersionSuffix=";",u._edgeVersionRegularExpression=new RegExp("Edge/(\\d+\\.\\d+)"),u._electronVersionRegularExpression=new RegExp("Electron/(\\d+\\.\\d+\\.\\d+)"),u._isIPad=null,u._setTimeoutData=null,u._setIntervalData=null,u._setImmediateData=null,Object(i.a)(u,"BrowserUtils",null,[]),u.$$cctor()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(e,t){this._use=e,this._assign=t}var t,n,i;return t=e,(n=[{key:"val",get:function(){return this._use()},set:function(e){this._assign(e)}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"Ref",null,[]);var o=function(e,t){return new a(e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(5);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(e){this.node=e}var t,n,i;return e.getFirstChildNodeWithName=function(t,n){for(var i=e.getNodeChildren(t),r=i.length,a=null,o=0;o<r;o++){if((a=i[o])[e.NAME]===n)return a}return null},e.getNodeName=function(t){return t[e.NAME]},e.getNodeChildren=function(t){var n=t[e.CHILDREN];return r.c(n)?e.emptyArray:n},e.getNodeAttributes=function(t){return t[e.ATTRIBUTES]},e.getNodeAttribute=function(t,n){return t[e.ATTRIBUTES][n]},t=e,i=[{key:"emptyArray",get:function(){return r.c(e.s_emptyArray)&&(e.s_emptyArray=[]),e.s_emptyArray}}],(n=[{key:"name",get:function(){return e.getNodeName(this.node)}},{key:"children",get:function(){return e.getNodeChildren(this.node)}},{key:"attributes",get:function(){return e.getNodeAttributes(this.node)}},{key:"hasChildren",get:function(){return e.getNodeChildren(this.node).length>0}}])&&a(t.prototype,n),i&&a(t,i),e}();o.ATTRIBUTES="attrs",o.CHILDREN="children",o.NAME="name",o.ALIGNMENT="Alignment",o.ALT="Alt",o.ARIALABELLEDBYID="ariaLabelledById",o.ARRANGEMENT="Arrangement",o.ARRANGEMENTVERTICAL="Vertical",o.CLASSNAME="Classname",o.COLOR="Color",o.COMMAND="Command",o.CONTEXTUALGROUPID="ContextualGroupId",o.CSSCLASS="CssClass",o.DESCRIPTION="Description",o.DISPLAYCOLOR="DisplayColor",o.DISPLAYMODE="DisplayMode",o.DIVIDER="Divider",o.ELEMENTDIMENSIONS="ElementDimensions",o.ENABLED="Enabled",o.GREEN="Green",o.GROUPID="GroupId",o.HEIGHT="Height",o.HORIZONTALALIGNMENT="HorizontalAlignment",o.id="Id",o.IMAGE="Image",o.IMAGECLASS="ImageClass",o.IMAGE16BY16="Image16by16",o.IMAGE32BY32="Image32by32",o.INDEX="Index",o.ISSTRETCHED="IsStretched",o.KEYTIP="Keytip",o.LABELTEXT="LabelText",o.LANGUAGE="Language",o.LAYOUTTITLE="LayoutTitle",o.LOADING="Loading",o.LOWSCALEWARNING="LowScaleWarning",o.MAGENTA="Magenta",o.MAXHEIGHT="MaxHeight",o.MAXIMUMVALUE="MaximumValue",o.MAXWIDTH="MaxWidth",o.MENUITEMID="MenuItemId",o.MESSAGE="Message",o.MINHEIGHT="MinHeight",o.MINIMUMVALUE="MinimumValue",o.ONEROW="OneRow",o.ORANGE="Orange",o.OVERFLOW="Overflow",o.PURPLE="Purple",o.SCROLLABLE="Scrollable",o.SEQUENCE="Sequence",o.SHOWMENUSECTIONSEPERATOR="ShowMenuSectionSeparator",o.SHOWMENUSECTIONTITLEICON="ShowMenuSectionTitleIcon",o.SHOWMENUSECTIONTITLEBACKGROUND="ShowMenuSectionTitleBackground",o.MENUSECTIONTITLEFOCUSABLE="MenuSectionTitleFocusable",o.SHOWECTIONSEPERATOR="ShowSectionSeparator",o.SINGLEDOCK="SingleDock",o.SIZE="Size",o.STEP="Step",o.STYLE="Style",o.TEMPLATEALIAS="TemplateAlias",o.TEXTALIGN="TextAlign",o.THEME="Theme",o.THREEROW="ThreeRow",o.TITLE="Title",o.TITLEID="TitleId",o.TWOROW="TwoRow",o.TYPE="Type",o.UNITTYPE="UnitType",o.VALUE="Value",o.WIDTH="Width",o.YELLOW="Yellow",o.RIBBON="Ribbon",o.JEWEL="Jewel",o.TABS="Tabs",o.CONTEXTUALTABS="ContextualTabs",o.CONTEXTUALGROUP="ContextualGroup",o.TAB="Tab",o.SCALING="Scaling",o.MAXSIZE="MaxSize",o.SCALE="Scale",o.GROUP="Group",o.GROUPS="Groups",o.LAYOUT="Layout",o.COLLAPSIBLESECTION="CollapsibleSection",o.SECTION="Section",o.OVERFLOWSECTION="OverflowSection",o.ROW="Row",o.CONTROL="ControlRef",o.CONTROLS="Controls",o.MENU="Menu",o.MENUSECTION="MenuSection",o.TEMPLATE="Template",o.TEMPLATES="Templates",o.RIBBONTEMPLATES="RibbonTemplates",o.GROUPTEMPLATE="GroupTemplate",o.GALLERY="Gallery",o.SPECIALTEXTSTRINGS="SpecialTextStrings",o.UNIT="Unit",o.FLOATIE="Floatie",o.TOUCHGROUP="TouchGroup",o.TASKPANE="TaskPane",o.colors="Colors",o.color="Color",o.toggleButton="ToggleButton",o.comboBox="ComboBox",o.dropDown="DropDown",o.button="Button",o.splitButton="SplitButton",o.statefulColorSplitButton="StatefulColorSplitButton",o.statefulImageSplitButton="StatefulImageSplitButton",o.flyoutAnchor="FlyoutAnchor",o.statefulColorFlyoutAnchor="StatefulColorFlyoutAnchor",o.galleryButton="GalleryButton",o.insertTable="InsertTable",o.label="Label",o.searchBox="SearchBox",o.slider="Slider",o.spinner="Spinner",o.textBox="TextBox",o.colorPicker="ColorPicker",o.separator="Separator",o.placeholder="Placeholder",o.clonedControl="ClonedControl",o.jewelMenuLauncher="JewelMenuLauncher",o.BUTTONDOCK="ButtonDock",o.CENTERALIGN="Center",o.DOCKS="Docks",o.HERODOCK="HeroDock",o.LEFTALIGN="Left",o.RIGHTALIGN="Right",o.FIRSTTOLAST="Begin",o.LASTTOFIRST="End",o.TOOLBAR="Toolbar",o.STATUSBAR="StatusBar",o.LARGE="Large",o.MEDIUM="Medium",o.SMALL="Small",o.DIVIDERAFTER="DividerAfter",o.DIVIDERBEFORE="DividerBefore",o.s_emptyArray=null,Object(i.a)(o,"DataNodeWrapper",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(11),a=n(83),o=(n(54),n(3));function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(){this._logLevelMapping={},this._logLevelMapping[1]=10,this._logLevelMapping[2]=15,this._logLevelMapping[3]=50,this._logLevelMapping[4]=100,this._logLevelMapping[5]=200,this._logCategoryMapping={},this._logCategoryMapping[1]=300,this._logCategoryMapping[2]=303,this._logCategoryMapping[3]=304,this._logCategoryMapping[4]=319,this._logCategoryMapping[5]=201,this._logCategoryMapping[6]=370,this._logCategoryMapping[7]=315,this._logCategoryMapping[8]=324}var t,n,i,r=e.prototype;return r.getLogLevel=function(e){var t;return""+e in this._logLevelMapping?t=this._logLevelMapping[""+e]:(t=200,o.ULS.shipAssertTag(6423762,200,!1,"Failed to find SharedLogLevel: {0}",e)),t},r.getLogCategory=function(e){var t;return""+e in this._logCategoryMapping?t=this._logCategoryMapping[""+e]:(t=200,o.ULS.shipAssertTag(6423763,200,!1,"Failed to find CommonLogCategory: {0}",e)),t},r.shouldTrace=function(e,t){var n=this.getLogCategory(e),i=this.getLogLevel(t);return o.ULS.shouldTrace(n,i)},r.traceTag=function(e,t,n,i){for(var r=this.getLogCategory(t),a=this.getLogLevel(n),s=arguments.length,l=new Array(s>4?s-4:0),c=4;c<s;c++)l[c-4]=arguments[c];o.ULS.sendTraceTag.apply(null,[e,r,a,i].concat(l))},r.shipAssertTag=function(e,t,n,i){for(var r=this.getLogCategory(t),a=arguments.length,s=new Array(a>4?a-4:0),l=4;l<a;l++)s[l-4]=arguments[l];o.ULS.shipAssertTag.apply(null,[e,r,n,i].concat(s))},r.traceMultiPartMessageTag=function(e,t,n,i,r){r=r||"";var a=3048-i.length;if(a<=0)this.traceTag(e,t,n,i+": "+r);else{var o=Math.ceil(r.length/a);if(o<=1)this.traceTag(e,t,n,i+": "+r);else for(var s=1,l=0,c=a;s<=o;s++,l=c,c+=a){var u=Math.min(r.length,c),d=r.substring(l,u),p=String.format("[{0} of {1}] {2}: {3}",s,o,i,d);this.traceTag(e,t,n,p)}}},t=e,i=[{key:"instance",get:function(){return e._instance||(e._instance=new e)}}],(n=null)&&s(t.prototype,n),i&&s(t,i),e}();function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}l._instance=null,Object(i.a)(l,"XLog",null,[]),n.d(t,"a",(function(){return p}));var p=function(){function e(){}var t,i,o;return e.get_linkableProtocolList=function(){return e._linkableProtocolList||(e._linkableProtocolList=["http://","https://","file://","file:\\\\","ftp://",e.mailToProtocol,"news:",e.notesUnescaped,"\\\\","www.","onenote:","tel:","mms://",e.notesEscaped,"mssv://",e.bookmarkAnchorPrefix])},e.get_urlKeyValueEncodeReplacements=function(){return e._urlKeyValueEncodeReplacements||(e._urlKeyValueEncodeReplacements=[a.a.createGlobalSearchFindReplacePair("!","%21"),a.a.createGlobalSearchFindReplacePair("'","%27"),a.a.createGlobalSearchFindReplacePair("\\(","%28"),a.a.createGlobalSearchFindReplacePair("\\)","%29"),a.a.createGlobalSearchFindReplacePair("\\*","%2A")])},e.stripIgnoredLinkChars=function(e,t){if(t.val=0,!e)return null;for(var n=e.length;n>t.val&&-1!=="#%&*{}:<>?+.;(),!']\"\u201d".indexOf(e.charAt(n-1));)n--;for(;t.val<n&&-1!=="(['\"\u201c".indexOf(e.charAt(t.val));)t.val++;return e.substr(t.val,n-t.val)},e.isLinkable=function(t,n){if(void 0===n&&(n=!1),!t)return!1;var i;t=e.toLower(t),t=e.stripIgnoredLinkChars(t,Object(r.a)((function(){return i}),(function(e){return i=e})));for(var a,o=c(e.get_linkableProtocolList());!(a=o()).done;){var s=a.value;if((!n||!t.startsWith(e.notesUnescaped)||t.startsWith(e.notesEscaped))&&e.startsWith(t,s))return!0}return!1},e.isEmail=function(t){return!!t&&t.length<=254&&e._emailRegex.test(t)},e.isWhitespace=function(e){switch(e){case 12288:case 8197:case 32:case 13:case 10:case 65532:case 11:case 9:case 160:return!0}return!1},e.isWhitespaceUnicode=function(e){switch(e){case" ":case"\xa0":case"\u1680":case"\u2000":case"\u2001":case"\u2002":case"\u2003":case"\u2004":case"\u2005":case"\u2006":case"\u2007":case"\u2008":case"\u2009":case"\u200a":case"\u202f":case"\u205f":case"\u3000":return!0}return!1},e.startsWith=function(e,t){return!!e&&!!t&&e.startsWith(t)},e.convertToHex=function(t,n){for(var i=t.toString(16);i.length<n;)i="0"+i;return e.toLower(i)},e.removeSurroundingChar=function(e,t){return e&&e.length>=2&&e.charAt(0)===t&&e.charAt(e.length-1)===t&&(e=e.substr(1,e.length-2)),e},e.encodeString=function(e,t){n(9).Debug;for(var i=e,r=t.length,a=0;a<r;++a)i=t[a].performReplaceOn(i);return i},e.urlKeyValueEncode=function(t){var n=t;return n=encodeURIComponent(n),n=e.encodeString(n,e.get_urlKeyValueEncodeReplacements())},e.get_romanOnes=function(){return e._romanOnes||(e._romanOnes=["","I","II","III","IV","V","VI","VII","VIII","IX"])},e.get_romanTens=function(){return e._romanTens||(e._romanTens=["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"])},e.get_romanHundreds=function(){return e._romanHundreds||(e._romanHundreds=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"])},e.convertToRoman=function(t,n){void 0===n&&(n=!1);for(var i="";t>=1e3;)i+="M",t-=1e3;var r=e.get_romanHundreds()[Math.floor(t/100)];t%=100;var a=e.get_romanTens()[Math.floor(t/10)];t%=10;var o=e.get_romanOnes()[t],s=String.format("{0}{1}{2}{3}",i,r,a,o);return n&&(s=e.toLower(s)),s},e.redactForLogging=function(e){return null==e?"(null)":"REDACTED:"+e.length},e.convertFromRoman=function(t){t=e.toUpper(t);var n=new RegExp("^[IVXLCDM]+$"),i=t.match(n);if(!i||1!==i.length||i[0]!==t||t.length<1)return-1;for(var a=0,o=0;a<t.length&&"M"===t.charAt(a);)a++;if(a>0){if(o=1e3*a,!(a<t.length))return o;t=t.substr(a)}return a=0,o+=e.convertIndividualPlaceValueFromRoman(e.get_romanHundreds(),t,Object(r.a)((function(){return a}),(function(e){return a=e})),100),a<t.length&&(t=t.substr(a),a=0,o+=e.convertIndividualPlaceValueFromRoman(e.get_romanTens(),t,Object(r.a)((function(){return a}),(function(e){return a=e})),10),a<t.length&&(t=t.substr(a),a=0,o+=e.convertIndividualPlaceValueFromRoman(e.get_romanOnes(),t,Object(r.a)((function(){return a}),(function(e){return a=e})),1))),t.length!==a&&(o=-1),o<1?-1:o},e.convertIndividualPlaceValueFromRoman=function(t,n,i,r){for(var a=t.length-1;a>0;a--)if(e.startsWith(n,t[a]))return i.val+=t[a].length,a*r;return 0},e.convertFromAlpha=function(e){var t=new RegExp("^([a-zA-Z])\\1{0,}$"),n=e.match(t);return!n||n.length<=1||n[0]!==e||e.length<1?-1:26*((e=e.toUpperCase()).length-1)+e.charCodeAt(0)-64},e.convertToAlpha=function(t,n){void 0===n&&(n=!1);var i="";if(t<0)return i;i=e.fromCharCode(t%26+65);var r=Math.floor(t/26);if(r>0)for(var a=i.charAt(0);r>0;)i+=a,r--;return n&&(i=e.toLower(i)),i},e.isAlpha=function(t){var n=t.toString();return e.toLower(n)!==e.toUpper(n)},e.isNumeric=function(e){return"0123456789".indexOf(e)>=0},e.isAlphaNum=function(t){return e.isAlpha(t)||e.isNumeric(t)},e.isLowSurrogateCharAt=function(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343},e.isHighSurrogateCharAt=function(e,t){return e.charCodeAt(t)>=55296&&e.charCodeAt(t)<=56319},e.getMinimalDifferenceBoundsAtCp=function(t,n,i,a,o){var s,l,c=!0,u=t.substr(i),d=n.substr(i),p=e.reverseString(u),h=e.reverseString(d);e.getMinimalDifferenceBounds(p,h,Object(r.a)((function(){return s}),(function(e){return s=e})),Object(r.a)((function(){return l}),(function(e){return l=e}))),s<u.length&&s<d.length&&t.charCodeAt(i)===n.charCodeAt(i)&&(c=!1),c?(a.val=i,o.val=s):e.getMinimalDifferenceBounds(t,n,a,o)},e.reverseString=function(e){for(var t="",n=e.length-1;n>=0;n--)t+=e.charAt(n);return t},e.getMinimalDifferenceBounds=function(t,i,r,a){var o,s;n(9).Debug;if(i=i||"",(t=t||"").length<i.length?(o=t,s=i):(o=i,s=t),s.startsWith(o))r.val=o.length,a.val=0;else if(s.endsWith(o))r.val=0,a.val=o.length;else{var c;for(c=0;c<t.length&&c<i.length;c++){var u=t.charCodeAt(c),d=i.charCodeAt(c);if(!(u===d||e.isWhitespace(u)&&e.isWhitespace(d)))break}for(r.val=c,c=0;c<t.length&&c<i.length;c++){var p=t.charCodeAt(t.length-c-1),h=i.charCodeAt(i.length-c-1);if(!(p===h||e.isWhitespace(p)&&e.isWhitespace(h)))break}a.val=c,r.val+a.val>o.length&&(a.val=o.length-r.val)}if(r.val>0){var m=r.val<t.length&&e.isLowSurrogateCharAt(t,r.val),g=r.val<i.length&&e.isLowSurrogateCharAt(i,r.val);(m||g)&&r.val--}if(a.val>1){var f=a.val<t.length&&e.isLowSurrogateCharAt(t,t.length-a.val),v=a.val<i.length&&e.isLowSurrogateCharAt(i,i.length-a.val);(f||v)&&a.val--}var _=r.val<t.length&&e.isLowSurrogateCharAt(t,r.val)||r.val<i.length&&e.isLowSurrogateCharAt(i,r.val),y=a.val>0&&(a.val<t.length&&e.isLowSurrogateCharAt(t,t.length-a.val)||a.val<i.length&&e.isLowSurrogateCharAt(i,i.length-a.val));(_||y)&&l.instance.traceTag(6961039,5,3,"Consecutive low surrogate chars!")},e.checkStringIsNullOrEmpty=function(e){return!e||!e.length},e.serializeStringDictionaryToJson=function(e){if(!e||!e.get_count())return"";var t=new Sys.StringBuilder;t.append("{");for(var n,i=c(e);!(n=i()).done;){var r=n.value;if(r.get_key()&&null!==r.get_value()){var a=String.format('"{0}": "{1}",',r.get_key(),r.get_value());t.append(a)}}var o=t.toString(),s=o.length;return s>1?o.substring(0,s-1)+"}":""},e.get_htmlEncodeReplacements=function(){if(!e._htmlEncodeReplacements){var t="&<>'\"`".length;e._htmlEncodeReplacements=new Array(t);for(var n=0;n<t;n++){var i=new RegExp("&<>'\"`".charAt(n).toString(),"g");e._htmlEncodeReplacements[n]=new a.a(i,"&#"+e.charCodeAt("&<>'\"`",n)+";")}}return e._htmlEncodeReplacements},e.get_htmlAttributeEncodeReplacements=function(){return e._htmlAttributeEncodeReplacements||(e._htmlAttributeEncodeReplacements=[a.a.createGlobalSearchFindReplacePair("&","&amp;"),a.a.createGlobalSearchFindReplacePair("<","&lt;"),a.a.createGlobalSearchFindReplacePair(">","&gt;"),a.a.createGlobalSearchFindReplacePair('"',"&quot;"),a.a.createGlobalSearchFindReplacePair("'","&#39;"),a.a.createGlobalSearchFindReplacePair("\r",""),a.a.createGlobalSearchFindReplacePair("\n","")])},e.get_xmlEncodeReplacements=function(){return e._xmlEncodeReplacements||(e._xmlEncodeReplacements=[a.a.createGlobalSearchFindReplacePair("&","&amp;"),a.a.createGlobalSearchFindReplacePair("<","&lt;"),a.a.createGlobalSearchFindReplacePair(">","&gt;"),a.a.createGlobalSearchFindReplacePair("'","&apos;"),a.a.createGlobalSearchFindReplacePair('"',"&quot;")])},e.get_htmlTextWhiteSpaceReplacements=function(){return e._htmlTextWhiteSpaceReplacements||(e._htmlTextWhiteSpaceReplacements=[a.a.createGlobalSearchFindReplacePair(" ","\xa0"),a.a.createGlobalSearchFindReplacePair("\xa0(?!\xa0)"," ")])},e.get_httpHeaderSanitizationReplacements=function(){return e._httpHeaderSanitizationReplacements||(e._httpHeaderSanitizationReplacements=[a.a.createGlobalSearchFindReplacePair("\r",""),a.a.createGlobalSearchFindReplacePair("\n","")])},e.areTextEqualIgnoreNbsp=function(t,n){return e.replaceNbsp(t)===e.replaceNbsp(n)},e.replaceNbsp=function(t){return t?t.replace(e.nbspRegExp," "):null},e.htmlEncode=function(t){return e.encodeString(t,e.get_htmlEncodeReplacements())},e.htmlAttributeEncode=function(t){return e.encodeString(t,e.get_htmlAttributeEncodeReplacements())},e.xmlEncode=function(t){return e.encodeString(t,e.get_xmlEncodeReplacements())},e.getCssStyleFromDictionary=function(e){var t=new Sys.StringBuilder;for(var n in e){var i={key:n,value:e[n]};t.append(i.key),t.append(": "),t.append(i.value),t.append("; ")}return t.toString()},e.encodeWhitespace=function(t){return e.encodeString(t,e.get_htmlTextWhiteSpaceReplacements())},e.httpHeaderEncode=function(t){return e.encodeString(t,e.get_httpHeaderSanitizationReplacements())},e.isValidWebImageProtocol=function(t){return!!t&&((t=e.toLower(t)).startsWith("http://")||t.startsWith("https://"))},e.getFileNameWithoutExtension=function(e){if(!e)return null;var t=e.lastIndexOf(".");return t>=0&&t<e.length?e.substring(0,t):e},e.getFileExtension=function(e){if(!e)return"";var t=e.lastIndexOf(".");return t>=0&&t<e.length?e.substring(t,e.length):""},e.testGlobal=function(e,t){if(e.global){for(var n=!1;e.test(t);)n=!0;return n}return e.test(t)},e.matchGlobal=function(e,t){var n=[],i=e.match(t);if(i&&Array.add(n,i),t.global)for(i=e.match(t);i;)Array.add(n,i),i=e.match(t);return n},e.replaceAll=function(e,t,n){return e.replace(new RegExp(t,"g"),n)},e.localeCompare=function(t,n){return t.localeCompare(n)-e._localeCompareOffset},e.charAt=function(e,t){return e.charAt(t)},e.tryGetCharAt=function(e,t){return!e||t<0||t>=e.length?null:e.substring(t,t+1)},e.charCodeAt=function(e,t){return e.charCodeAt(t)},e.toUpper=function(e){return e.toUpperCase()},e.toLower=function(e){return e.toLowerCase()},e.toLowerForLocale=function(t,n){var i=t;return 1055!==n&&2092!==n&&1068!==n||(i=(i=i.replace("I","\u0131")).replace("\u0130","i")),e.toLower(i)},e.isLowerCase=function(e){return e.toLowerCase()===e},e.isUpperCase=function(e){return e.toUpperCase()===e},e.isNullOrEmpty=function(e){return!e},e.removeAllWhitespace=function(t){for(var n="",i=0;i<t.length;i++)e.isWhitespace(t.charCodeAt(i))||(n+=t.charAt(i).toString());return n},e.indexOfWhiteSpace=function(t,i){n(9).Debug;if(!t)return-1;if((i=i<0?0:i)>=t.length)return-1;for(var r=i;r<t.length;r++)if(e.isWhitespace(t.charCodeAt(r)))return r;return-1},e.lastIndexOfWhiteSpace=function(t,i){n(9).Debug;if(!t)return-1;if((i=i>t.length-1?t.length-1:i)<0)return-1;for(var r=i;r>=0;r--)if(e.isWhitespace(t.charCodeAt(r)))return r;return-1},e.isEastAsianChar=function(e){return e>=19968&&e<=40959||e>=13312&&e<=19967||e>=12544&&e<=12591||e>=12352&&e<=12543||e>=4352&&e<=4607||e>=12592&&e<=12687||e>=44032&&e<=55203||e>=40960&&e<=42191},e.isEastAsianCharExtended=function(t){return e.isEastAsianChar(t)||t>=12688&&t<=12703||t>=63744&&t<=64255||t>=11904&&t<=12245||t>=12288&&t<=12351},e.isThaiChar=function(e){return e>=3584&&e<=3711},e.getHexString=function(e){return e.toString(16).toUpperCase()},e.getInitials=function(t,n,i){return void 0===i&&(i=!1),t?(t=e.cleanupDisplayName(t),e.unsupportedTextRegExp.test(t)||!i&&e.phoneNumberRegExp.test(t)?"":e.getInitialsLatin(t,n)):""},e.cleanupDisplayName=function(t){return(t=(t=t.replace(e.unwantedCharsRegExp,"")).replace(e.multipleWhitespaceRegExp," ")).trim()},e.getInitialsLatin=function(e,t){var n="",i=e.split(" ");return 2===i.length?(n+=i[0].charAt(0),n+=i[1].charAt(0)):3===i.length?(n+=i[0].charAt(0),n+=i[2].charAt(0)):i.length>0&&(n+=i[0].charAt(0)),t&&n.length>1&&(n=n.charAt(1)+""+n.charAt(0)),n.toUpperCase()},e.stripPreTag=function(e){return e.replace(new RegExp("\\s*<pre>(.*)</pre>\\s*","i"),"$1")},e.fromCharCode=function(e){return String.fromCharCode(e)},e.from4CharCodes=function(e,t,n,i){return String.fromCharCode(e,t,n,i)},e.escape=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return escape(e)})),e.unescape=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return unescape(e)})),e.right=function(e,t){return e.substr(t)},e.substr=function(e,t,n){return e.substr(t,n)},e.substring=function(e,t,n){return e.substring(t,n)},e.trimToLength=function(e,t){return null===e?null:e.length>t?e.substring(0,t):e},e.boundsToString=function(e){return e?"[L:"+e.x+", T:"+e.y+", R:"+(e.x+e.width)+", B:"+(e.y+e.height)+", W:"+e.width+", H:"+e.height+"]":""},e.pointToString=function(e){return"("+e.x+","+e.y+")"},e.padLeft=function(e,t,n){for(;e.length<t;)e=n+e;return e},e.calcHashCode=function(t){if(!t)return 0;if(e._hashCodeCache[t])return e._hashCodeCache[t];for(var n=5381,i=n,r=t.length,a=0;a<r&&(n=4294967295&((n<<5)+n^t.charCodeAt(a)),a!==r-1);a+=2)i=4294967295&((i<<5)+i^t.charCodeAt(a+1));var o=n+35685*i+(23896*i<<16)&4294967295;return o<0&&(o+=4294967296),e._hashCodeCache[t]=o,o},e.formatNumberToString=function(t,n,i,r){var a=t<0;if(6===n){e.generateAbsoluteValueString(t,i.percentDecimalDigits,i.percentDecimalSeparator,i.percentGroupSeparator,i.percentGroupSizes,r);var o=a?i.percentNegativePattern:i.percentPositivePattern;r.val=e.generatePercentString(r.val,i.percentSymbol,a,i.negativeSign,o)}else if(8===n){var s=new Array(2);s[0]=i.numberDecimalSeparator,r.val=e.generateTimespanString(t,s)}else e.generateAbsoluteValueString(t,i.numberDecimalDigits,i.numberDecimalSeparator,i.numberGroupSeparator,i.numberGroupSizes,r),r.val=e.generateNumberString(r.val,n,a,i.negativeSign,i.numberNegativePattern)},e.generateAbsoluteValueString=function(e,t,i,r,a,o){n(9).Debug;var s="",l="",c=Math.pow(10,t),u=Math.abs(Math.round(e*c)/c),d=Math.floor(u),p=(u*c-d*c)/c;if(d)for(var h=a.length,m=0,g=d;g>0;){var f=a[m];if(f){for(var v=0;v<f&&g>0;v++){s=(g%10).toString()+s,g=Math.floor(g/10)}g>0&&(s=r+s)}else s=g.toString()+s,g=0;m<h-1&&m++}else s="0";for(var _="",y=Math.round(p*c)/c,b=0;b<t;b++){var S=Math.floor(10*y);_+=S.toString();var C=Math.pow(10,t-b-1);y=Math.round(y*C*10-S*C)/C}for(var A=_.length;A>0&&"0"===_.charAt(A-1);)A--;""!==(_=_.substring(0,Math.max(0,A)))&&(l+=i+_),o.val=s+l},e.generatePercentString=function(t,n,i,r,a){var o=e.placeholderForPercent(n,i,r,a);return String.format(o,t)},e.generateTimespanString=function(t,n){return e.genTimeSpanFromSecond(t,n)},e.generateNumberString=function(t,i,r,a,o){n(9).Debug;var s=t;if(r)switch(o){case 0:s="("+s+")";break;case 1:s=a+s;break;case 2:s=a+" "+s;break;case 3:s+=a;break;case 4:s=s+" "+a;break;default:0}return String.format(e.placeholderForNumberMeasurement(i),s)},e.getExceptionMessage=function(e){var t=new Sys.StringBuilder,n=e.Exceptions;if(n&&n.length>0)for(var i,r=c(n);!(i=r()).done;){var a=i.value;t.appendLine(a.message)}else t.append(e.message);return t.toString()},e.parseNumberAndUnitsFromString=function(t,i,r,a,o){n(9).Debug;var s="[0-9]*"+("["+r.numberDecimalSeparator+"]")+"?[0-9]+",l=new RegExp(s,"g"),c=t.match(l);if(!c||1!==c.length)return a.val=Number.NaN,void(o.val=0);var u="",d=r.negativeSign;switch(r.numberNegativePattern){case 0:u="[(][ ]?"+s+"[ ]?[)]";break;case 1:case 2:u=d+"[ ]?"+s;break;case 3:case 4:u=s+"[ ]?"+d;break;default:0}var p=new RegExp(u,"g"),h=t.match(p),m=!!h;var g=m?t.replace(h[0],"{0}"):t.replace(c[0],"{0}"),f=!1,v=0;if("{0}"===(g=(g=e.removeAllWhitespace(g)).toLowerCase()))f=!0;else for(var _=0;_<i.length;_++){var y=i[_],b="";if(6===y){var S=m?r.percentNegativePattern:r.percentPositivePattern;b=e.placeholderForPercent(r.percentSymbol,m,d,S)}else b=e.placeholderForNumberMeasurement(y);if((b=(b=e.removeAllWhitespace(b)).toLowerCase())===g){v=y,f=!0;break}}if(f){var C=(m?"-":"")+c[0];C=C.replace(r.numberDecimalSeparator,"."),a.val=parseFloat(C),o.val=isNaN(a.val)?0:v}else a.val=Number.NaN,o.val=0},e.placeholderForNumberMeasurement=function(e){n(9).Debug;var t="";switch(e){case 0:t="{0}";break;case 1:t=CommonUIStrings.l_CentimeterUnitPlaceholder;break;case 2:t=CommonUIStrings.l_CharacterUnitPlaceholder;break;case 3:t=CommonUIStrings.l_InchUnitPlaceholder;break;case 4:t=CommonUIStrings.l_LineUnitPlaceholder;break;case 5:t=CommonUIStrings.l_PointUnitPlaceholder;break;case 7:t=CommonUIStrings.l_PixelsUnitPlaceholder;break;case 9:t=CommonUIStrings.l_DegreeUnitPlaceholder;break;default:0}return t},e.placeholderForPercent=function(e,t,i,r){n(9).Debug;var a="";if(t)switch(r){case 0:case 1:a=i+"{0}"+e;break;case 2:case 7:a=i+e+"{0}";break;case 3:case 10:a=e+i+"{0}";break;case 4:case 9:a=e+"{0}"+i;break;case 5:case 11:a="{0}"+i+e;break;case 6:case 8:a="{0}"+e+i;break;default:0}else switch(r){case 0:case 1:a="{0}"+e;break;case 2:case 3:a=e+"{0}";break;default:0}return a},e.isNumber=function(t){return!!e.ignoredNumbersCheck.exec(t)},e.containsWhitespaceAtMost=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=-1);for(var r=n;r<i&&r<t.length;r++)if(!e.isWhitespace(t.charCodeAt(r)))return!1;return!0},e.containsWhitespaceWithoutObjectReplacementSpace=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=-1);for(var r=n;r<i&&r<t.length;r++)if(65532===t.charCodeAt(r)||!e.isWhitespace(t.charCodeAt(r)))return!1;return!0},e.genTimeSpanFromSecond=function(t,n){var i=Math.round(100*Math.abs(t)),r=Math.floor(i/100),a=i%100;return e.padLeft(r.toString(),2,"0")+n[0]+e.padLeft(a.toString(),2,"0")},e.getRGBFromBGR=function(e){return 6===e.length&&new RegExp("^[0-9A-F]{6}$","i").test(e)?"#"+e.substr(4,2)+e.substr(2,2)+e.substr(0,2):e},t=e,o=[{key:"_lineBreakRegExp",get:function(){return e._lineBreakRegularExpression||(e._lineBreakRegularExpression=new RegExp("[\r\n]+","g"))}},{key:"unwantedCharsRegExp",get:function(){return e._unwantedCharsRegularExpression||(e._unwantedCharsRegularExpression=new RegExp("\\([^)]*\\)|[\\0-\\u001F\\!-/:-@\\[-`\\{-\\u00BF\\u0250-\\u036F\\uD800-\\uFFFF]","g"))}},{key:"phoneNumberRegExp",get:function(){return e._phoneNumberRegularExpression||(e._phoneNumberRegularExpression=new RegExp("^\\d+[\\d\\s]*(:?ext|x|)\\s*\\d+$","i"))}},{key:"multipleWhitespaceRegExp",get:function(){return e._multipleWhitespaceRegularExpression||(e._multipleWhitespaceRegularExpression=new RegExp("\\s+","g"))}},{key:"unsupportedTextRegExp",get:function(){return e._unsupportedTextRegularExpression||(e._unsupportedTextRegularExpression=new RegExp("[\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF\\u1100-\\u11FF\\u3130-\\u318F\\uA960-\\uA97F\\uAC00-\\uD7AF\\uD7B0-\\uD7FF\\u3040-\\u309F\\u30A0-\\u30FF\\u3400-\\u4DBF\\u4E00-\\u9FFF\\uF900-\\uFAFF]|[\\uD840-\\uD869][\\uDC00-\\uDED6]"))}},{key:"nbspRegExp",get:function(){return e._nbspRegExpression||(e._nbspRegExpression=new RegExp("\xa0","g"))}}],(i=null)&&d(t.prototype,i),o&&d(t,o),e}();p.mailToProtocol="mailto:",p.notesUnescaped="notes:",p.notesEscaped="notes://",p.bookmarkAnchorPrefix="bookmark://",p._emailRegex=new RegExp("\\S+@\\S+\\.[\\w]+"),p._linkableProtocolList=null,p._urlKeyValueEncodeReplacements=null,p._romanOnes=null,p._romanTens=null,p._romanHundreds=null,p._hashCodeCache={},p._localeCompareOffset="A".localeCompare("A"),p._htmlEncodeReplacements=null,p._htmlAttributeEncodeReplacements=null,p._xmlEncodeReplacements=null,p._htmlTextWhiteSpaceReplacements=null,p._httpHeaderSanitizationReplacements=null,p._lineBreakRegularExpression=null,p._unwantedCharsRegularExpression=null,p._phoneNumberRegularExpression=null,p._multipleWhitespaceRegularExpression=null,p._unsupportedTextRegularExpression=null,p._nbspRegExpression=null,p.jsonEscapedCharacters=[new a.a(new RegExp("\\\\","g"),"\\\\"),new a.a(new RegExp('\\"',"g"),'\\"')],p.ignoredNumbersCheck=new RegExp("^[\\d\\s\\.\\,\\+\\-]+$"),Object(i.a)(p,"StringUtils",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(11),o=n(1);n(9),n(54);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(){this._windowStartTime=0,this._measuredActionTotalMs=0,this._sleepUntilTime=0}var t,n,i;return e.prototype.recordThrottledActionTime=function(e){this._measuredActionTotalMs+=e},t=e,(n=[{key:"shouldRunThrottledAction",get:function(){var e=(new Date).getTime();if(e<this._sleepUntilTime)return!1;if(!this._windowStartTime)return this._windowStartTime=e,this._sleepUntilTime=0,!0;var t=e-this._windowStartTime;if(t>200){var n=this._measuredActionTotalMs/t;return this._measuredActionTotalMs=0,n>.8?(this._windowStartTime=0,this._sleepUntilTime=e+50,!1):(this._windowStartTime=e,!0)}return!0}}])&&s(t.prototype,n),i&&s(t,i),e}();Object(i.a)(l,"ThrottlingManager",null,[220]);var c=n(67);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(){function e(e){var t=this;this.breadcrumbDocName="",this.breadcrumbFolderName="",this.breadcrumbFolderUrl="",this.breadcrumbBrandUrl="",this.breadcrumbBrandName="",this.set_openInClientCommandUrl(""),this.sharingStatus=0,e&&o.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){t.setPropertiesFromAppSettings(o.AFrameworkApplication.appSettingsManager.appSettings)}))}var t,n,i,r=e.prototype;return r.set_openInClientCommandUrl=function(t){return e._openInClientCommandUrl=this.supportsOpenInClientForAllApps?t:"",t},r.setPropertiesFromAppSettings=function(t){if(t){this.breadcrumbDocName=t.BreadcrumbDocName||"",this.set_openInClientCommandUrl(t.OpenInClientCommandUrl||""),this.breadcrumbFolderName=t.BreadcrumbFolderName||"",this.breadcrumbFolderUrl=t.BreadcrumbFolderUrl||"",this.breadcrumbBrandUrl=t.BreadcrumbBrandUrl||"",this.breadcrumbBrandName=t.BreadcrumbBrandName||"";var n=t.SharingStatus||"";this.sharingStatus=e.parseSharingStatus(n)}},e.parseSharingStatus=function(e){var t;switch(e){case"Private":t=1;break;case"Shared":t=2;break;default:t=0}return t},t=e,(n=[{key:"openInClientCommandUrl",get:function(){return e._openInClientCommandUrl}},{key:"supportsOpenInClientForAllApps",get:function(){return!this.isAndroid||o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICForAndroidIsEnabled")}},{key:"isAndroid",get:function(){return window.navigator.userAgent.indexOf("Android")>=0}}])&&u(t.prototype,n),i&&u(t,i),e}();d._openInClientCommandUrl=null,Object(i.a)(d,"DocPropertiesProvider",null,[8]);var p=n(305),h=n(48),m=n(68),g=n(70),f=n(50),v=n(41);var _=function(e){var t,n;function i(t,n,i){var r;if((r=e.call(this,t,n,i,0)||this).origin=null,r.data=null,r.source=null,i.rawEvent){var a=i.rawEvent;r.origin=a.origin,r.source=a.source,r.data=a.data}else r.origin="",r.source=null,r.data="";return r}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.create=function(e,t,n){return new i(e,t,n)},i}(v.EventHandlerArgs);Object(i.a)(_,"WindowEventArgs",v.EventHandlerArgs,[]);var y=function(){function e(){e._windowEventManagerNumber++,this._window=window.self,this._eventHandlerManager=h.EventHandlerManager.instance}var t=e.prototype;return t.dispose=function(){},t.addHandler=function(e,t,n){this._eventHandlerManager.registerHandler(e,this._window,2,Object(r.d)(this,this.onWindowEvent,"onWindowEvent"),t,n)},t.removeHandler=function(e,t){this._eventHandlerManager.unregisterHandler(e,this._window,t)},t.onWindowEvent=function(e,t,n){var i=_.create(e,this._window,n);return this._eventHandlerManager.processEvent(e,t,i)},e}();y._windowEventManagerNumber=0,Object(i.a)(y,"WindowEventManager",null,[219,4]);var b=n(10);function S(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var C=function(e){var t,n;function i(t,n){return void 0===n&&(n=!0),e.call(this,t,n)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,s,u,v=i.prototype;return v.initialize=function(t){e.prototype.initialize.call(this,t),o.AFrameworkApplication.theWindowEventManager=new y,m.a.instance.registerActions(o.AFrameworkApplication.theActionManager),o.AFrameworkApplication.theActionManager.throttlingManager=i.theThrottlingManager,g.a.instance.userSessionId=o.AFrameworkApplication.userSessionId,g.a.instance.recordAppInitStart(o.AFrameworkApplication.bootTime),g.a.instance.recordResourceDownloadStart(),g.a.instance.recordResourceDownloadEnd(),g.a.instance.recordBootResourceTimings(),g.a.instance.recordPaintTimings(),g.a.instance.recordSplashScreenShown();var n=o.AFrameworkApplication.appSettingsManager.getLongAppSetting("HostProvidedClickTime",-1);n>0&&g.a.instance.recordUserClickedInHostUi(n),g.a.instance.recordNewFileMetrics(o.AFrameworkApplication.isNewFile,o.AFrameworkApplication.newFileTemplateName,o.AFrameworkApplication.newFileTemplateLcid),o.AFrameworkApplication.docPropertiesProvider=new d(t),(!Boolean.parse(t.AvoidCallStackReThrow||"false")||b.a.isInternetExplorer10||b.a.isSafari9Up)&&h.EventHandlerManager.instance.setOnExceptionOccurred((function(e){throw p.setExceptionCallStack(e),e})),c.a.get_instance().executeWhen(6,Object(r.d)(o.AFrameworkApplication.theActionManager,o.AFrameworkApplication.theActionManager.logUnhandledKeyboardActions,"logUnhandledKeyboardActions"))},v.dispose=function(){f.a(o.AFrameworkApplication.theWindowEventManager),o.AFrameworkApplication.theWindowEventManager=null,e.prototype.dispose.call(this)},v.initializeBrowserSqm=function(t){e.prototype.initializeBrowserSqm.call(this,t),g.a.instance.initWsaClient(o.AFrameworkApplication.theWsaClient)},v.checkHostCanaryValidityAndRedirectIfNeeded=function(e,t){o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("InvalidHostCanary")&&e&&this.redirectOutside(e,t)},a=i,u=[{key:"theThrottlingManager",get:function(){return i._theThrottlingManager||(i._theThrottlingManager=new l)},set:function(e){i._theThrottlingManager=e}}],(s=null)&&S(a.prototype,s),u&&S(a,u),i}(o.AFrameworkApplication);C._theThrottlingManager=null,Object(i.a)(C,"WebApp",o.AFrameworkApplication,[]);var A=n(357),I=n(160),w=n(3),T=n(391),E=function(e,t,n,i,r,a,o,s){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=null),this.logMessageMaxChars=3072,this.sizeThresholdBytes=65536,this.uploadCadenceMs=6e4,this.throttlingTimeoutMs=2e3,this.delayedLogHandlingCadenceMs=1e4,this.asyncUploadRequestTimeout=5e3,this.asyncOverride=!1,this.uploadMaximumSizeBytes=0,null!=e&&(this.logMessageMaxChars=e),null!=t&&(this.sizeThresholdBytes=t),null!=n&&(this.uploadCadenceMs=n),null!=i&&(this.throttlingTimeoutMs=i),null!=r&&(this.delayedLogHandlingCadenceMs=r),null!=a&&(this.asyncUploadRequestTimeout=a),null!=o&&(this.asyncOverride=o),null!=s&&s>0&&(this.uploadMaximumSizeBytes=s)};Object(i.a)(E,"UlsUploadConfiguration",null,[]);var k=n(199);function M(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var P=function(){function e(e,t,n){void 0===n&&(n=null),this._failedUploadAttemptCount=0,this.nextUploadId=0,this._ulsCallDepthAdjustment=0,this._request=null,this._disposing=!1,this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!1,this._delayedLoggingTimerId=0,this._cadenceTimerId=0,this._throttlingTimeoutId=0,this._mode=0,this.sendAfterThrottling=!1,this._asyncFlushTimeoutId=0,n||(n=new E),this._sessionId=e,this.uploadUrl=t,this.uploadUrl.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&w.ULS.disable(),this._uploadCadenceMs=n.uploadCadenceMs,this._throttlingTimeoutMs=n.throttlingTimeoutMs,this._delayedLogHandlingCadenceMs=n.delayedLogHandlingCadenceMs,this._uploadRequestTimeout=n.asyncUploadRequestTimeout,this._asyncOverride=n.asyncOverride,this._logCache=new T.LogCache(n.sizeThresholdBytes,n.logMessageMaxChars,e),this._logCache.uploadMaximumSizeBytes=n.uploadMaximumSizeBytes,this.resetCadenceTimer(),this._delayedLogBuffer=[],this.resetDelayedLoggingTimer()}var t,n,i,a=e.prototype;return a.handleTrace=function(e){this.ulsCallDepth>1?Array.add(this._delayedLogBuffer,e):(this._logCache.addLog(e),this.logIndicatesError(e)&&!this.disableSynchronousFlush()?(this.flushSynchronous("LogIndicatesError in HandleTrace"),w.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",k.a(e.tag))):this._logCache.isDataSizeThresholdExceeded&&(this.flushImpl(!1,!0),w.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))},a.logIndicatesError=function(e){return!!e&&(1===e.logType||10===e.level)},a.disableSynchronousFlush=function(){return!1},a.dispose=function(){this._disposing||(this._disposing=!0,this.flushForAppClose(),w.ULS.setUlsHost(null),window.clearTimeout(this._asyncFlushTimeoutId),window.clearTimeout(this._delayedLoggingTimerId),window.clearTimeout(this._cadenceTimerId),this._asyncFlushTimeoutId=0,this._delayedLoggingTimerId=0,this._cadenceTimerId=0)},a.flushForAppClose=function(){this.mode=2,this.handleDelayedLogs(),this.sendAfterThrottling=!1,this.endThrottling(),this.flushSynchronous("FlushForAppClose")},a.uploadLogs=function(e,t){return e.uploadId=this.nextUploadId,!!this.uploadSerializedLogs(e.serialize(),t)&&(this.nextUploadId++,!0)},a.uploadSerializedLogs=function(t,n){var i,r=this._asyncOverride||!n;return this._request&&r||(this._request=new XMLHttpRequest),this._request.readyState&&4!==this._request.readyState?(w.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",((i={}).UploadId=this.nextUploadId,i.XhrReadyState=this._request.readyState,i)),!1):(this._request.open("POST",this.uploadUrl,r),this._request.setRequestHeader("Content-Type","application/json"),this._request.setRequestHeader(e.sessionIdHeaderName,this._sessionId),r&&(this._request.timeout=this._uploadRequestTimeout),this.modifyHttpRequestBeforeUploading(this._request),this._request.send(t),!0)},a.onUploadException=function(e){this._request&&this._request.abort()},a.modifyHttpRequestBeforeUploading=function(e){},a.setTimeoutToLogOriginAndExecute=function(e,t,n){try{return window.setTimeout((function(){w.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",t,n),e()}),t)}catch(t){if(w.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",t.toString()),!this.setTimeoutToLogOriginAndExecuteReentrancyDetector){this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!0;try{e()}finally{this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!1}}return 0}},a.resetDelayedLoggingTimer=function(){try{window.clearTimeout(this._delayedLoggingTimerId)}catch(e){w.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}this._delayedLoggingTimerId=this.setTimeoutToLogOriginAndExecute(Object(r.d)(this,this.handleDelayedLogs,"handleDelayedLogs"),this._delayedLogHandlingCadenceMs,"ResetDelayedLoggingTimer")},a.handleDelayedLogs=function(){var e,t=this._delayedLogBuffer.length;if(t){var n=[];Array.addRange(n,this._delayedLogBuffer),this._delayedLogBuffer=[],w.ULS.sendTraceTag(3731798,100,50,"HandleDelayedLogs {0}",((e={}).Count=t,e)),this._ulsCallDepthAdjustment++;for(var i=0;i<t;i++)this.handleTrace(n[i]);this._ulsCallDepthAdjustment--,this.resetDelayedLoggingTimer()}else this.resetDelayedLoggingTimer()},a.resetCadenceTimer=function(){try{window.clearTimeout(this._cadenceTimerId)}catch(e){w.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}this._cadenceTimerId=this.setTimeoutToLogOriginAndExecute(Object(r.d)(this,this.flushImpl,"flushImpl"),this._uploadCadenceMs,"ResetCadenceTimer")},a.endThrottling=function(){this.mode=0,this.sendAfterThrottling&&(this.sendAfterThrottling=!1,this.flushImpl())},a.shouldThrottle=function(e){return 2===this.mode||1===this.mode&&!e},a.flushSynchronous=function(e){w.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",e),this.flushImpl(!0)},a.flushAsynchronous=function(){this.flushAsynchronousInternal(0)},a.flushAsynchronousInternal=function(e){this._asyncFlushTimeoutId||(this._asyncFlushTimeoutId=this.setTimeoutToLogOriginAndExecute(Object(r.d)(this,this.flushImpl,"flushImpl"),e,"FlushAsynchronous"))},a.flushImpl=function(t,n){this._ulsCallDepthAdjustment++;try{window.clearTimeout(this._asyncFlushTimeoutId)}catch(e){w.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}if(this._asyncFlushTimeoutId=0,!this._logCache.count)return this.resetCadenceTimer(),void this._ulsCallDepthAdjustment--;if(!n&&this.shouldThrottle(t))return w.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",t?"sync":"async"),this.sendAfterThrottling=!0,void this._ulsCallDepthAdjustment--;var i;this.mode=t?2:1,this.resetCadenceTimer(),w.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",t?"sync":"async",this._logCache.count);try{i=this.uploadLogs(this._logCache,t)}catch(e){0,this.onUploadException(e),i=!1}i?(this._logCache.reset(),this._failedUploadAttemptCount=0):(this._failedUploadAttemptCount++,this._failedUploadAttemptCount<e.maxUploadAttempts?this.flushAsynchronousInternal(e.retryDelay):(this._logCache.reset(),this.nextUploadId++,this._failedUploadAttemptCount=0)),this._ulsCallDepthAdjustment--},a.showAssertDialog=function(e){},a.handoffToNewHost=function(e){},a.add_onUlsTrace=function(e){},a.remove_onUlsTrace=function(e){},t=e,(n=[{key:"ulsCallDepth",get:function(){return w.ULS.ulsCallDepth+this._ulsCallDepthAdjustment}},{key:"mode",get:function(){return this._mode},set:function(e){var t=this._mode;if(this._mode=e,!this._mode&&t)try{var n=this._throttlingTimeoutId;this._throttlingTimeoutId=0,window.clearTimeout(n)}catch(e){w.ULS.sendTraceTag(0,100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}else this._mode&&!t&&(this._throttlingTimeoutId=this.setTimeoutToLogOriginAndExecute(Object(r.d)(this,this.endThrottling,"endThrottling"),this._throttlingTimeoutMs,"ThrottlingMode Setter"))}},{key:"logCache",get:function(){return this._logCache},set:function(e){this._logCache=e}},{key:"delayedLogBuffer",get:function(){return this._delayedLogBuffer}},{key:"cadenceTimerId",get:function(){return this._cadenceTimerId}},{key:"delayedLoggingTimerId",get:function(){return this._delayedLoggingTimerId}},{key:"asyncFlushTimeoutId",get:function(){return this._asyncFlushTimeoutId}},{key:"throttlingTimeoutId",get:function(){return this._throttlingTimeoutId}},{key:"ulsCallDepthAdjustment",get:function(){return this._ulsCallDepthAdjustment},set:function(e){this._ulsCallDepthAdjustment=e}}])&&M(t.prototype,n),i&&M(t,i),e}();P.defaultRemoteUlsUrl="RemoteUls.ashx",P.maxUploadAttempts=3,P.retryDelay=15e3,P.sessionIdHeaderName="X-UserSessionId",Object(i.a)(P,"UploadingUlsHost",null,[85,4]);var F=function(e,t,n,i){this.uploadId=e,this.attemptCount=t,this.sessionId=n,this.version=i};Object(i.a)(F,"UploadState",null,[]);var D=n(27),O=n(110);var R=function(e){var t,n;function i(t){var n;return(n=e.call(this)||this).args=t,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Sys.EventArgs);Object(i.a)(R,"UlsLoggingEventArgs",Sys.EventArgs,[]);var x=n(323);function U(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function L(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var N=function(e){var t,n;function i(t,n,r,a){var s;if((s=e.call(this,o.AFrameworkApplication.userSessionId,i.generateCompleteRemoteUlsUrl(t,n,r),new E(void 0,o.AFrameworkApplication.get_bulsSizeThresholdBytes(),a.getIntAppSetting("BulsUploadFrequencyInMs",6e4),void 0,void 0,void 0,void 0,o.AFrameworkApplication.bulsUploadMaxSize))||this)._events=null,s._tagCallStackInclusionList=null,s._firstFailure=void 0,s._retryDelayWhenDisconnectedInMilliseconds=null,s._clientRequestManager=r,s._appSettingsManager=a,s._clientRequestManager,s._suppressionETag=s._appSettingsManager.getStringAppSetting("RemoteUlsETag"),s._suppressionETag){var l=s._appSettingsManager.getStringAppSetting("RemoteUlsSuppressions");i.processSuppressedTags(l)}return s}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,s,l,c=i.prototype;return c.add_onUlsTrace=function(e){this.events.addHandler(i.ulsTraceEventKey,e)},c.remove_onUlsTrace=function(e){this.events.removeHandler(i.ulsTraceEventKey,e)},c.getCallStack=function(){return(new Error).stack},c.getTagCallStackInclusionList=function(){var e=null;if(o.AFrameworkApplication.appSettingsManager.containsAppSetting("TagCallStackInclusionList")){e=new x.a;for(var t=o.AFrameworkApplication.appSettingsManager.getListAppSetting("TagCallStackInclusionList"),n=0;n<t.length;n++)e.set_item(t[n],!0)}return e},c.handleTrace=function(t){if(this._tagCallStackInclusionList||(this._tagCallStackInclusionList=this.getTagCallStackInclusionList()),this._tagCallStackInclusionList&&this._tagCallStackInclusionList.containsKey(t.tag)){var n=this.getCallStack();t.message+=". JsCallStack: "+n}e.prototype.handleTrace.call(this,t);var r=this.events.getHandler(i.ulsTraceEventKey),a=new R(t);r&&r(null,a)},c.showAssertDialog=function(e){},c.uploadLogs=function(t,n){if(this._clientRequestManager){if(!this.shouldTrySendingTheRequest)return!1;var i=t.serialize();if(o.AFrameworkApplication.bulsUploadMaxSize>0&&i.length>o.AFrameworkApplication.bulsUploadMaxSize)return!1;if(t.uploadId=this.nextUploadId++,this.shouldSendShuttingDownRequest())return this.sendShuttingDownRequest(this.uploadUrl,i),!0;var r=n&&o.AFrameworkApplication.isShuttingDown;return this.addUploadRequest(this.uploadUrl,i,n&&!this.overwriteSessionId?0:3,1,r,t.uploadId,this.overwriteSessionId,this.overwriteVersion),!0}return e.prototype.uploadLogs.call(this,t,n)},c.onSuccessfulUpload=function(e){try{if(!(e&&e.data&&e.data.responseHeaders&&i.headerSuppressionETag in e.data.responseHeaders))return;var t=e.data.responseHeaders[i.headerSuppressionETag];if(t===this._suppressionETag)return;this._suppressionETag=t;var n=e.data.responseHeaders[i.headerSuppressedTags];i.processSuppressedTags(n)}catch(e){w.ULS.sendTraceTag(593847297,100,50,"Failed to process tag suppressions. [Message: {0}] [Stack: {1}]",e.message,e.stack)}},c.onFailedUpload=function(e){var t=this,n=e.data;if(n){if(13===n.status)return w.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),void this.uploadSerializedLogs(n.request.get_body(),!1);if(n.responseHeaders){if(!(i.invalidUlsJsonHeaderName in n.responseHeaders)){var r=n.httpStatus;if(!(400<=r&&r<=499)){var a=n.state;a.attemptCount>=P.maxUploadAttempts||window.setTimeout((function(){t.addUploadRequest(n.request.get_url(),n.request.get_body(),3,a.attemptCount+1,!1,a.uploadId,a.sessionId,a.version)}),P.retryDelay)}}}else w.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}",n.id,n.responseXml,n.responseData)}else w.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",e)},c.addUploadRequest=function(e,t,n,a,o,s,l,c){var u=null;this._suppressionETag&&((u={})[i.headerSuppressionETag]=this._suppressionETag),this._clientRequestManager.addRequest(e,2,t,u,!1,n,Object(r.d)(this,this.onSuccessfulUpload,"onSuccessfulUpload"),Object(r.d)(this,this.onFailedUpload,"onFailedUpload"),new F(s,a,l,c),null,o,this._appSettingsManager.getIntAppSetting("BulsClientRequestManagerQueueTimeInMS",3e4),void 0,"19",l,void 0,c,void 0,[i.headerSuppressionETag,i.headerSuppressedTags])},c.sendShuttingDownRequest=function(e,t){this._clientRequestManager.sendShuttingDownRequest(e,t)},c.shouldSendShuttingDownRequest=function(){return o.AFrameworkApplication.isShuttingDown&&(this._appSettingsManager.getBooleanAppSetting("SendBeaconOnShuttingDownRequestsEnabled")||o.AFrameworkApplication.isShuttingDownFromPostMessage)},i.generateCompleteRemoteUlsUrl=function(e,t,n){return e=i.addBuildNumber(e,t),e=i.addWacCluster(e,n)},i.addWacCluster=function(e,t){if(!t)return e;var n=t.wacClusterId;return n?e=D.a.addOrReplaceParameterValue(e,O.a.wacClusterQsName,n):e},i.addBuildNumber=function(e,t){return t?D.a.addOrReplaceParameterValue(e,"build",o.AFrameworkApplication.buildVersion):e},i.createHostAndInitUlsForApp=function(e,t){return void 0===e&&(e=P.defaultRemoteUlsUrl),void 0===t&&(t=!0),o.AFrameworkApplication.browserUlsIsEnabled?(w.ULS.setUlsHost(new i(e,t,o.AFrameworkApplication.theClientRequestManager,o.AFrameworkApplication.appSettingsManager)),w.ULS.setTraceLevel(o.AFrameworkApplication.browserUlsTraceLevel)):w.ULS.disable(),w.ULS.host},i.processSuppressedTags=function(e){if(w.ULS.clearSuppressedTags(),e)for(var t,n=U(e.split(","));!(t=n()).done;){var i=t.value,r=parseInt(i);!isNaN(r)&&isFinite(r)&&w.ULS.addSuppressedTag(r)}},a=i,(s=[{key:"events",get:function(){return this._events||(this._events=new Sys.EventHandlerList)}},{key:"overwriteSessionId",get:function(){return null}},{key:"overwriteVersion",get:function(){return null}},{key:"retryDelayWhenDisconnectedInMilliseconds",get:function(){return this._retryDelayWhenDisconnectedInMilliseconds||(this._retryDelayWhenDisconnectedInMilliseconds=this._appSettingsManager.getIntAppSetting("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6e4)),this._retryDelayWhenDisconnectedInMilliseconds}},{key:"shouldTrySendingTheRequest",get:function(){var e=this._clientRequestManager.isNetworkOffline;return!!(e&&(new Date).getTime()-this._clientRequestManager.lastResponseTime.getTime()>=this.retryDelayWhenDisconnectedInMilliseconds)||!e}}])&&L(a.prototype,s),l&&L(a,l),i}(P);N.headerSuppressionETag="X-bULS-SuppressionETag",N.headerSuppressedTags="X-bULS-SuppressedTags",N.ulsTraceEventKey="CommonUlsTraceEventKey",N.invalidUlsJsonHeaderName="X-InvalidUlsJson",Object(i.a)(N,"CommonUlsHost",P,[]);var H=n(359),W=n(31),j=n(43),V=n(40),K=(n(129),n(390),n(154));var z=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._clearButton=null,t._saveLog=null,t._filter=null,t._filterButton=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(K.a);z._contentDiv=null,z._logDiv=null,z._logEntries=void 0,Object(i.a)(z,"LoggingTab",K.a,[]);var q=function(){this.buttonActionCommand=null,this.createNewDocumentAspxRelativePath="",this.flyoutAnchorId=null,this.headerButtonId=null,this.headerButtonText=null,this.headerButtonTitle=null,this.image32by32=null,this.image32by32Class=null,this.labelText=null};Object(i.a)(q,"FileNewProperties",null,[]);var G=function(){this.buttonActionCommand=null,this.flyoutAnchorId=null,this.image32by32=null,this.image32by32Class=null};Object(i.a)(G,"FileOpenProperties",null,[]);var Q=n(55),Z=n(4),$=n(24),X=n(17),J=n(20),Y=n(356),ee=n(62),te=n(30),ne=n(113),ie=n(69),re=n(222),ae=n(39),oe=n(96),se=n(124),le=n(79),ce=n(134),ue=n(312),de=n(130),pe=n(153),he=n(16),me=n(26),ge=n(21),fe=n(126),ve=n(8),_e=n(208);function ye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var be=function(e){var t,n;function i(t,n){var i;return(i=e.call(this)||this)._argsCache=null,i._appName=t,i.reset(n),i}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,o,s,l=i.prototype;return l.reset=function(e){this._argsCache=[],e||window.setTimeout(Object(r.d)(this,this.reset,"reset"),6e4),w.ULS.sendTraceTag(3973958,101,50,"Reset")},l.handleTrace=function(e){e&&Array.add(this._argsCache,e)},l.handoffToNewHost=function(e){var t=this._argsCache.length;w.ULS.sendTraceTag(3973959,101,50,"Cached {0} logs",t);for(var n=0;n<t;n++)e.handleTrace(this._argsCache[n])},l.flushAsynchronous=function(){},a=i,(o=[{key:"argsCache",get:function(){return this._argsCache}}])&&ye(a.prototype,o),s&&ye(a,s),i}(_e.a);Object(i.a)(be,"CachingUlsHost",_e.a,[]);var Se=n(103),Ce=n(112),Ae=n(237),Ie=n(25),we=n(220),Te=n(45),Ee=n(34),ke=n(137),Me=n(18),Pe=function(){function e(e,t,n,i){this._inited=!1,this._actionManager=e,this._focusManager=t,this._documentDataUtils=n,this._lazyScrollControl=i,this._actionManager.addAction(Me.a.prevPage,Ee.a.application,Object(r.d)(this,this.prevPage,"prevPage")),this._actionManager.addAction(Me.a.nextPage,Ee.a.application,Object(r.d)(this,this.nextPage,"nextPage"))}var t=e.prototype;return t.init=function(){this._actionManager.addAction(Me.a.onCurrentPageChange,Ee.a.application,Object(r.d)(this,this.onCurrentPageChange,"onCurrentPageChange")),this._actionManager.addActionWithFlags(Me.a.queryCurrentPageLabel,Ee.a.application,Object(r.d)(this,this.onQueryCurrentPageLabel,"onQueryCurrentPageLabel"),96);var e=this._focusManager.getScope(W.AFrame.appFocusId);e.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_Comma,J.KeyInputManager.commandKeyModifier),Me.a.prevPage),e.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_Period,J.KeyInputManager.commandKeyModifier),Me.a.nextPage),this._inited=!0},t.dispose=function(){},t.nextPage=function(e,t,i,r,a){var o,s=n(14).App;return 1!==i&&this._inited?((o=s.get_activeAppFrame()?s.get_activeAppFrame().workspace.getCurrentPage():1)<this._documentDataUtils.pageCount&&this.onPageJump(o+1),32):32},t.prevPage=function(e,t,i,r,a){var o,s=n(14).App;return 1!==i&&this._inited?((o=s.get_activeAppFrame()?s.get_activeAppFrame().workspace.getCurrentPage():1)>1&&this.onPageJump(o-1),32):32},t.onPageJump=function(e){var t=n(14).App;this._lazyScrollControl.value.scrollToPage(e),t.get_activeAppFrame().ribbonUser&&t.get_activeAppFrame().ribbonUser.poll(),t.get_activeAppFrame().statusBarUser&&t.get_activeAppFrame().statusBarUser.pollControl(ke.a.pageInfoLabel)},t.onCurrentPageChange=function(e,t,i,r,a){var o=n(14).App;return 1===i?o.isReadyForRibbon()?32:8:(this.onPageJump(a),32)},t.onQueryCurrentPageLabel=function(e,t,i,r,a){if(1===i)return 32;var o=a,s=n(14).App.get_activeAppFrame().workspace.getCurrentPage(),l=this._documentDataUtils.pageCount;return o[we.a.Value]=String.format(WordViewerIntl.WordViewerStrings.l_PageLabel,s,l>0?l.toString():WordViewerIntl.WordViewerStrings.l_PageCountUnknown),o[Te.a.labelText]=o[we.a.Value],32},e}();Object(i.a)(Pe,"NavigationControl",null,[245,4]);var Fe=n(13),De=function(){function e(e){this._mostRecentClientPoint=null,this.scrollHoriz=!0,this.scrollVert=!0,this._element=e}var t=e.prototype;return t.isDragPossible=function(e){return 3!==e.inputSource&&!e.mouseButton},t.onDragStart=function(e){return!!this.isDragPossible(e)&&(this._mostRecentClientPoint=e.clientPoint,!0)},t.onDragMove=function(e){var t=e.clientPoint,n=t.y-this._mostRecentClientPoint.y,i=t.x-this._mostRecentClientPoint.x;return o.AFrameworkApplication.isRtl&&2===e.inputSource&&b.a.isInternetExplorerNonEdge&&(i=-i),this.scrollVert&&(this._element.scrollTop-=n),this.scrollHoriz&&(this._element.scrollLeft-=i),this._mostRecentClientPoint=t,!0},t.onDragEnd=function(e){this._mostRecentClientPoint=null},t.onDragCancel=function(e){this._mostRecentClientPoint=null},e}();Object(i.a)(De,"ScrollDragAdapter",null,[77]);var Oe=n(114),Re=function(){function e(e){this._dragInputManager=e}var t=e.prototype;return t.registerDragScrollRegion=function(e){var t=new De(e);this._dragInputManager.registerDragAdapterWithPriority(e,t,2),Oe.b(e,"dsa",t)},t.unregisterDragScrollRegion=function(e){var t=Oe.a(e,"dsa");null!=t&&this._dragInputManager.unregisterDragAdapter(e,t)},e}();Object(i.a)(Re,"DragScrollManager",null,[]);var xe=n(22),Ue=n(303),Be=n(159),Le=n(148),Ne=n(91);function He(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var We,je=function(){function e(e,t,i,a,s,l){var c=this;this._containerOffsetWidth=0,this._reportFutureContainerWidth=!1,this._containerClientWidth=0,this._isContainerWidthDirty=!0,this._containerClientHeight=0,this._isContainerHeightDirty=!0,this._scrollLeft=0,this._isScrollLeftDirty=!1,this._resizingScroller=!1,this._scrollTop=0,this._isScrollTopDirty=!1,this._futureScrollTop=-1,this._ignoreNextOnScroll=!1,this._dragScrollManager=null,this._doubleClickHandler=null,this._mouseDownHander=null,this._workspace=null;var u=n(14).App;this._appSettingsManager=e,this._actionManager=t,this._focusManager=i,this._documentDataUtils=a,this._lazyZoomControl=s,this._theConfig=l,u.get_activeAppFrame().add_onResize(Object(r.d)(this,this.windowResize,"windowResize")),this._container=document.createElement("div"),this._container.id="WACContainer",this._container.className="WACContainer",this._scroller=document.createElement("div"),this._scroller.id="WACScroller",this._scroller.className="WACScroller",this._scrollerHeight=this._documentDataUtils.totalPageGap+this._documentDataUtils.totalPageHeight,this._scrollerWidth=2*this._theConfig.marginPixels+this._documentDataUtils.maxPageWidth,this._scroller.style.height=this._scrollerHeight+"px",this._scroller.style.width=this._scrollerWidth+"px",this._container.appendChild(this._scroller),this.setUpPinchZoom(),b.a.isIPad&&!o.AFrameworkApplication.isEmbedded&&window.setTimeout((function(){Sys.UI.DomElement.addCssClass(c._container,"webkitTouchScrolling")}),0),this._newEmbedModeIsEnabled=this._appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),this._isSmallView=this._appSettingsManager.getBooleanAppSetting("IsSmallView"),this._isSmallView&&!this._newEmbedModeIsEnabled&&(this._doubleClickHandler=Object(r.d)(this,this.onDoubleClick,"onDoubleClick"),this.clickInputManager.registerHandler(Z.EventNames.doubleClick,this._container,this._doubleClickHandler),this._mouseDownHander=Object(r.d)(this,this.onMouseDown,"onMouseDown"),this.mouseInputManager.registerHandler(Z.EventNames.mouseDown,this._container,this._mouseDownHander,null)),Sys.UI.DomElement.addCssClass(this._container,o.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),this._onScrollHandler=Object(r.d)(this,this.onScroll,"onScroll"),this._onSelectStartHandler=Object(r.d)(this,this.ignoreEvent,"ignoreEvent"),X.a.addHandler(this._container,Z.EventNames.scroll,this._onScrollHandler),X.a.addHandler(this._container,Z.EventNames.selectStart,this._onSelectStartHandler),this._isSmallView&&!this._newEmbedModeIsEnabled&&this.dragScrollManager.registerDragScrollRegion(this._container),this._onMouseWheel=Object(r.d)(this,this.mouseWheelEventPng,"mouseWheelEventPng"),this.mouseInputManager.registerHandler(Z.EventNames.mouseWheel,this._container,this._onMouseWheel,null),this._actionManager.addAction(Me.a.scrollDownArrow,Ee.a.application,Object(r.d)(this,this.scrollDownArrow,"scrollDownArrow")),this._actionManager.addAction(Me.a.scrollUpArrow,Ee.a.application,Object(r.d)(this,this.scrollUpArrow,"scrollUpArrow")),this._actionManager.addAction(Me.a.scrollRightArrow,Ee.a.application,Object(r.d)(this,this.scrollRightArrow,"scrollRightArrow")),this._actionManager.addAction(Me.a.scrollLeftArrow,Ee.a.application,Object(r.d)(this,this.scrollLeftArrow,"scrollLeftArrow")),this._actionManager.addAction(Me.a.scrollPageDown,Ee.a.application,Object(r.d)(this,this.scrollPageDown,"scrollPageDown")),this._actionManager.addAction(Me.a.scrollPageUp,Ee.a.application,Object(r.d)(this,this.scrollPageUp,"scrollPageUp")),this._actionManager.addAction(Me.a.scrollHome,Ee.a.application,Object(r.d)(this,this.scrollHome,"scrollHome")),this._actionManager.addAction(Me.a.scrollEnd,Ee.a.application,Object(r.d)(this,this.scrollEnd,"scrollEnd")),this._actionManager.addActionWithFlags(Me.a.resizeScroller,Ee.a.application,Object(r.d)(this,this.resizeScroller,"resizeScroller"),96),this._actionManager.addActionWithFlags(Me.a.resizeScrollerWithoutAnimation,Ee.a.application,Object(r.d)(this,this.resizeScrollerWithoutAnimation,"resizeScrollerWithoutAnimation"),96),this._actionManager.addActionWithFlags(Me.a.repositionScroller,Ee.a.application,Object(r.d)(this,this.repositionScrollerWithAnimation,"repositionScrollerWithAnimation"),97),this._actionManager.addActionWithFlags(Me.a.repositionScrollerWithoutAnimation,Ee.a.application,Object(r.d)(this,this.repositionScrollerWithoutAnimation,"repositionScrollerWithoutAnimation"),97);var d=this._focusManager.getScope(W.AFrame.documentFocusID);d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_DownArrow,0),Me.a.scrollDownArrow),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_UpArrow,0),Me.a.scrollUpArrow),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_RightArrow,0),Me.a.scrollRightArrow),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_LeftArrow,0),Me.a.scrollLeftArrow),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_PageDown,0),Me.a.scrollPageDown),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_PageUp,0),Me.a.scrollPageUp),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_Home,0),Me.a.scrollHome),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_End,0),Me.a.scrollEnd),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_Home,2),Me.a.scrollHome),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_End,2),Me.a.scrollEnd),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_Space,0),Me.a.scrollPageDown),d.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_Space,4),Me.a.scrollPageUp)}var t,i,a,s=e.prototype;return s.init=function(){},s.getWidth=function(){return this.containerClientWidth},s.getClientHeight=function(){return this.containerClientHeight},s.getScrollLeft=function(){return this.scrollLeft},s.getScrollTop=function(){return this.scrollTop},s.getFutureScrollTop=function(){return this.futureScrollTop},s.setIgnoreNextOnScroll=function(e){this.ignoreNextOnScroll=e},s.focus=function(){this._container.focus()},s.dispose=function(){this._scroller&&(this._container.removeChild(this._scroller),this._scroller=null),this._doubleClickHandler&&(this.clickInputManager.unregisterHandler(Z.EventNames.doubleClick,this._container,this._doubleClickHandler),this._doubleClickHandler=null),this._mouseDownHander&&(this.mouseInputManager.unregisterHandler(Z.EventNames.mouseDown,this._container,this._mouseDownHander),this._mouseDownHander=null),X.a.removeHandler(this._container,Z.EventNames.scroll,this._onScrollHandler),X.a.removeHandler(this._container,Z.EventNames.selectStart,this._onSelectStartHandler),this._onScrollHandler=null,this._onSelectStartHandler=null,this._onMouseWheel&&(this.mouseInputManager.unregisterHandler(Z.EventNames.mouseWheel,this._container,this._onMouseWheel),this._onMouseWheel=null),this._isSmallView&&!this._newEmbedModeIsEnabled&&this._dragScrollManager&&(this._dragScrollManager.unregisterDragScrollRegion(this._container),this._dragScrollManager=null),this._container=null},s.scrollToPage=function(e){var t;if(e<=1)t=0;else{e>this._documentDataUtils.pageCount&&(e=this._documentDataUtils.pageCount);this._lazyZoomControl.value.currentZoom;t=this._documentDataUtils.getPageTopAtZoom(e,this._lazyZoomControl.value.currentZoom)-this._theConfig.pageGapPixels/2}this._actionManager.processActionWithData(Me.a.repositionScroller,2,new Be.a(t,0))},s.scrollToPageOffset=function(e,t){var i=n(14).App;if(e<1||e>i.instance.theDocument.pageCount)return 8;var r=this._lazyZoomControl.value.currentZoom,a=Ne.a.instance.getPageTopAtZoom(e,r),s=Ne.a.instance.getPageHeightAtZoom(e,r)*t/100;return o.AFrameworkApplication.theActionManager.processActionWithData(Me.a.repositionScroller,2,new Be.a(a+s,0))},s.broadcastCurrentScrollPosition=function(){o.AFrameworkApplication.theActionManager.processActionWithData(Me.a.broadcastOnScroll,2,new Ue.a(this.workspace.getCurrentPage(),new Be.a(this.scrollTop,this.scrollLeft),1))},s.setUpPinchZoom=function(){var e=this;ge.a.instance.resolveFuture("Common.IGestureInputRegistrar").execute((function(t){t.register(e._container,e)}))},s.mouseWheelEventPng=function(e){if(e.ctrlKey)return!1;for(var t=3*e.wheelData*this._theConfig.autoScrollAmount,n=0;n<2;n++)this._actionManager.processActionWithData(Me.a.repositionScrollerWithoutAnimation,2,new Be.a(Math.round(this.scrollTop+t),this._scrollLeft));return!0},s.resizeScroller=function(e,t,n,i,a){return this._resizingScroller=!0,this.updateScrollerDimensionsForCurrentZoom(),Le.a.animateSize(this._scroller,this._scrollerHeight,this._scrollerWidth,Object(r.d)(this,this.onAfterResizeScroller,"onAfterResizeScroller")),this._isContainerHeightDirty=!0,32},s.onAfterResizeScroller=function(e){this._resizingScroller=!1,this._actionManager.processAction(Me.a.resizeCache,2),this.onAfterResizeAction()},s.resizeScrollerWithoutAnimation=function(e,t,n,i,r){return this.updateScrollerDimensionsForCurrentZoom(),xe.DomUtils.setElementStyleWidthInPixels(this._scroller,this._scrollerWidth),xe.DomUtils.setElementStyleHeightInPixels(this._scroller,this._scrollerHeight),this._isContainerHeightDirty=!0,32},s.updateScrollerDimensionsForCurrentZoom=function(){var e=this._lazyZoomControl.value.currentZoom;this._scrollerHeight=this._documentDataUtils.totalPageGap+Math.round(this._documentDataUtils.totalPageHeight*e),this._scrollerWidth=2*this._theConfig.marginPixels+Math.round(this._documentDataUtils.maxPageWidth*e)},s.onScroll=function(e){this._ignoreNextOnScroll?this._ignoreNextOnScroll=!1:(this._scrollTop=this.convertScrollTopToDocumentSpace(this._container.scrollTop),this._scrollLeft=this._container.scrollLeft,this._isScrollTopDirty=!1,this._containerClientWidth<this._scrollerWidth&&(this._isScrollLeftDirty=!0),this._actionManager.processActionWithData(Me.a.onScroll,2,new Be.a(this._scrollTop,this._scrollLeft)))},s.repositionScrollerWithAnimation=function(e,t,n,i,r){return this.repositionScroller(r,!0),32},s.repositionScrollerWithoutAnimation=function(e,t,n,i,r){return this.repositionScroller(r,!1),32},s.repositionScroller=function(e,t){var n=this.convertScrollTopToControlSpace(e.scrollTop),i=e.scrollLeft;if(t){this._actionManager.processAction(Me.a.beforeAnimateScroll,2),this._futureScrollTop=n;var a=Le.a.animateScroll(this._container,i,n,Object(r.d)(this,this.onAfterScroll,"onAfterScroll")).runTime;this._actionManager.processActionWithData(Me.a.animateScrollStarted,2,a)}else this._container.scrollLeft=i,this._container.scrollTop=n,this._futureScrollTop=-1;isNaN(n)&&isNaN(i)||(this._isScrollTopDirty=!0)},s.onAfterScroll=function(e){this._appSettingsManager.getBooleanAppSetting("BroadcastMode")&&this.broadcastCurrentScrollPosition()},s.onDoubleClick=function(e){return this._actionManager.processAction(Me.a.zoomToNextLevel,2),!0},s.onMouseDown=function(e){return $.FocusManager.usable()&&this._focusManager.setScope(W.AFrame.documentFocusID),e.innerEvent.preventDefault(),!1},s.windowResize=function(){this.resizeContainer(),this._actionManager.processAction(Me.a.onContainerResizeForSelection,2),this._actionManager.processAction(Me.a.updateZoomOnWindowResize,2)},s.resizeContainer=function(){var e=n(14).App;if(this._container){this._containerOffsetWidth=e.get_activeAppFrame().getDOMElement().clientWidth;var t=0,i=0;e.get_activeAppFrame().isSearchPaneVisible&&(t=this._theConfig.searchPaneWidth,this._containerOffsetWidth-=t,o.AFrameworkApplication.isRtl||(i=t));var a=0;e.get_activeAppFrame().isCommentPaneVisible&&(a=this._theConfig.commentPaneWidth,this._containerOffsetWidth-=a,o.AFrameworkApplication.isRtl&&(i=a)),this._containerOffsetWidth=this._containerOffsetWidth<0?0:this._containerOffsetWidth,this._isSmallView&&!this._newEmbedModeIsEnabled&&(this._containerOffsetWidth+=this.verticalScrollBarWidth),this._reportFutureContainerWidth=!0,Le.a.resizeContainerAnimation(this._container,i,this._containerOffsetWidth,Object(r.d)(this,this.onAfterResizeContainer,"onAfterResizeContainer")),this._containerOffsetWidth-=this.verticalScrollBarWidth,this._isSmallView&&!this._newEmbedModeIsEnabled&&(this._container.style.height=this._container.offsetHeight+this.horizontalScrollBarHeight+"px",this._containerOffsetWidth-=this.verticalScrollBarWidth),this._isContainerHeightDirty=!0,this._isContainerWidthDirty=!0}},s.onAfterResizeContainer=function(e){this._isContainerHeightDirty=!0,this._isContainerWidthDirty=!0,this._reportFutureContainerWidth=!1,this.onAfterResizeAction()},s.onAfterResizeAction=function(){if(b.a.isIPad&&o.AFrameworkApplication.isRtl){0;var e=this._container.scrollWidth>this._container.offsetWidth?"auto":"touch";this._container.style.webkitOverflowScrolling=e}},s.ignoreEvent=function(e){e.stopPropagation(),e.preventDefault()},s.scrollDownArrow=function(e,t,n,i,r){return this._scrollTop=this._scrollTop+this._theConfig.keyboardArrowScrollAmount,this._scrollTop=Math.min(this._scrollTop,this._scrollerHeight-this.containerClientHeight),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32},s.scrollUpArrow=function(e,t,n,i,r){return this._scrollTop=this._scrollTop-this._theConfig.keyboardArrowScrollAmount,this._scrollTop=Math.max(this._scrollTop,0),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32},s.scrollRightArrow=function(e,t,n,i,r){return this._scrollLeft=this._scrollLeft+this._theConfig.keyboardArrowScrollAmount,this._scrollLeft=Math.min(this._scrollLeft,this._scrollerWidth-this.containerClientWidth),this._isScrollLeftDirty=!1,this._container.scrollLeft=this._scrollLeft,32},s.scrollLeftArrow=function(e,t,n,i,r){return this._scrollLeft=this._scrollLeft-this._theConfig.keyboardArrowScrollAmount,this._scrollLeft=Math.max(this._scrollLeft,0),this._isScrollLeftDirty=!1,this._container.scrollLeft=this._scrollLeft,32},s.scrollPageDown=function(e,t,n,i,r){return this._lazyZoomControl.value.isFitPage?(this._actionManager.processAction(Me.a.nextPage,2),32):(this._scrollTop=this._scrollTop+this.containerClientHeight-this._theConfig.pageGapPixels,this._scrollTop=Math.min(this._scrollTop,this._scrollerHeight-this.containerClientHeight),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32)},s.scrollPageUp=function(e,t,n,i,r){return this._lazyZoomControl.value.isFitPage?(this._actionManager.processAction(Me.a.prevPage,2),32):(this._scrollTop=this._scrollTop-this.containerClientHeight-this._theConfig.pageGapPixels,this._scrollTop=Math.max(this._scrollTop,0),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32)},s.scrollHome=function(e,t,n,i,r){return this._scrollTop=0,this._container.scrollTop=0,this._isScrollTopDirty=!1,32},s.scrollEnd=function(e,t,n,i,r){return this._scrollTop=this._scrollerHeight-this.containerClientHeight,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),this._isScrollTopDirty=!1,32},s.convertScrollTopToControlSpace=function(e){return e},s.convertScrollTopToDocumentSpace=function(e){return e},t=e,(i=[{key:"container",get:function(){return this._container}},{key:"scroller",get:function(){return this._scroller}},{key:"scrollLeft",get:function(){return this._isScrollLeftDirty&&(this._scrollLeft=this._container.scrollLeft,this._isScrollLeftDirty=!1),this._scrollLeft},set:function(e){this._scrollLeft=e,this._container.scrollLeft=e,this._isScrollLeftDirty=!1}},{key:"scrollTop",get:function(){return this._isScrollTopDirty&&(this._scrollTop=this.convertScrollTopToDocumentSpace(this._container.scrollTop),this._isScrollTopDirty=!1),this._scrollTop},set:function(e){this._scrollTop=this.convertScrollTopToControlSpace(e),this._container.scrollTop=this._scrollTop,this._futureScrollTop=-1,this._isScrollTopDirty=!1}},{key:"futureContainerWidth",get:function(){return this._reportFutureContainerWidth?this._containerOffsetWidth:this.containerClientWidth}},{key:"futureScrollTop",get:function(){return-1===this._futureScrollTop?this.scrollTop:this._futureScrollTop}},{key:"ignoreNextOnScroll",get:function(){return this._ignoreNextOnScroll},set:function(e){this._ignoreNextOnScroll=e}},{key:"containerClientHeight",get:function(){return this._isContainerHeightDirty&&(this._containerClientHeight=this._container.clientHeight,this._isContainerHeightDirty=!1),this._containerClientHeight}},{key:"containerClientWidth",get:function(){return this._isContainerWidthDirty&&(this._containerClientWidth=this._container.clientWidth,!this._containerClientWidth||this._reportFutureContainerWidth?this._containerClientWidth=this._containerOffsetWidth:this._containerClientWidth!==this._containerOffsetWidth&&(this._isContainerWidthDirty=!1)),this._containerClientWidth}},{key:"resizingScroller",get:function(){return this._resizingScroller}},{key:"verticalScrollBarWidth",get:function(){return this.container.offsetWidth-this.container.clientWidth}},{key:"horizontalScrollBarHeight",get:function(){return this.container.offsetHeight-this.container.clientHeight}},{key:"mouseInputManager",get:function(){return n(14).App.get_activeAppFrame().theMouseInputManager}},{key:"clickInputManager",get:function(){return n(14).App.get_activeAppFrame().theClickInputManager}},{key:"dragScrollManager",get:function(){var e=n(14).App;return this._dragScrollManager||(this._dragScrollManager=new Re(e.get_activeAppFrame().theDragInputManager))}},{key:"workspace",get:function(){return this._workspace||(this._workspace=ge.a.instance.resolve("WordViewer.Workspace"))}}])&&He(t.prototype,i),a&&He(t,a),e}();Object(i.a)(je,"ScrollControl",null,[244,4,257]),function(e){e[e.manual=0]="manual",e[e.fitToFullPage=1]="fitToFullPage",e[e.fitWidth=2]="fitWidth",e[e.onBoot=3]="onBoot"}(We||(We={})),Object(i.b)("ZoomFlag",We);var Ve=n(49),Ke=function(e,t){this.zoom=e,this.allowScrollUpdate=t};Object(i.a)(Ke,"SetCustomZoomArgs",null,[]);var ze=n(361),qe=n(60),Ge=n(52);function Qe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ze=function(){function e(t,n){this.defaultDialogOptions=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"],this.defaultDialogValues=[e.dialogResult_FullPage,e.dialogResult_PageWidth,"200","150","100","75","50"],this.currentZoomStatus=3,this.delta=.1,this.leftPageMargin=0,this.eventSource=new Ve.a,this._dialog=null,this.appSettingsManager=t,this.actionManager=n,this._currentZoom=1}var t,n,i,s=e.prototype;return s.add_zoomChanged=function(e){this.eventSource.addHandler("ZoomChanged",e)},s.remove_zoomChanged=function(e){this.eventSource.removeHandler("ZoomChanged",e)},s.registerZoomChangedEvent=function(e){this.add_zoomChanged(e)},s.removeZoomChangedEvent=function(e){this.remove_zoomChanged(e)},s.registerPinchStartEvent=function(e){},s.removePinchStartEvent=function(e){},s.registerPinchEndEvent=function(e){},s.removePinchEndEvent=function(e){},s.zoomElement=function(e){this.zoomElementTo(e,this.currentZoom)},s.zoomElementTo=function(e,t){null!==e&&Ge.CssUtils.setScale(e,t)},s.setZoom=function(e,t){void 0===t&&(t=!0);var n=100*e,i=n;this.appSettingsManager&&this.appSettingsManager.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled")&&(i=new Ke(n,t)),this.setCustomZoom(0,null,2,null,i)},s.setZoomDuringResize=function(e,t){void 0===t&&(t=!1);var n=3|(t?0:4);this.updateZoom(e,n)},s.isInScope=function(e){return!0},s.onZoomChange=function(e,t,n,i,r){if(1===n)return this.isReadyForRibbon()?32:8;var a=r/100;return a<this.minimumZoom?a=this.minimumZoom:a>this.maximumZoom&&(a=this.maximumZoom),this.onZoomChangeCustomAction(a),this.updateZoom(a),i&&(i.dataValue1=Math.floor(100*a)),32},s.onQueryZoomLevel=function(e,t,n,i,r){return 1===n||(r.value=Math.floor(100*this.currentZoom)),32},s.onQueryZoomText=function(e,t,n,i,r){if(1===n)return 32;var s=r,l="";return Fe.a.formatNumberToString(this.currentZoomOnUI,6,o.AFrameworkApplication.numberFormat,Object(a.a)((function(){return l}),(function(e){return l=e}))),s[this.zoomLabelTextDictionaryKey]=l,32},s.onZoomChangeCustomAction=function(e){},s.isReadyForRibbon=function(){return!0},s.getZoomDialogOptionList=function(){return this.defaultDialogOptions},s.getZoomDialogValueList=function(){return this.defaultDialogValues},s.getCurrentZoomValueBasedOnZoomStatus=function(){var t=Math.floor(100*this.currentZoom).toString();return 1===this.currentZoomStatus?t=e.dialogResult_FullPage:2===this.currentZoomStatus&&(t=e.dialogResult_PageWidth),t},s.increaseZoom=function(e,t,n,i,r){return 1===n||(this.logUpdateZoomEvents(this.actionManager?this.actionManager.commandLocation:0,"IncreaseZoom"),this.currentZoomStatus=0,this.updateZoom(this.nextValueIncreaseZoom)),32},s.decreaseZoom=function(e,t,n,i,r){return 1===n||(this.logUpdateZoomEvents(this.actionManager?this.actionManager.commandLocation:0,"DecreaseZoom"),this.currentZoomStatus=0,this.updateZoom(this.nextValueDecreaseZoom)),32},s.setZoomLevelFromRibbon=function(e,t,n,i,r){var a=this;if(1===n)return 32;this.logUpdateZoomEvents(this.actionManager?this.actionManager.commandLocation:0,"SetZoomLevelFromRibbon");var o=r.Value;if(o.toLowerCase().startsWith("fit")){var s=new ae.a(0,1,0,(function(e){a.zoomToPageWidth(0,null,2,null,null)}),138,void 0,!0);return qe.a.instance.addTask(s),32}var l=parseInt(o)/100;return isNaN(l)?2:(this.currentZoomStatus=0,this.updateZoom(l),32)},s.logUpdateZoomEvents=function(e,t){w.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",e,t,o.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled)},s.showZoomDialog=function(e,t,n,i,a){if(1===n)return 32;w.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog"),this._dialog=new ze.a(this.getZoomDialogOptionList(),this.getZoomDialogValueList(),Object(r.d)(this,this.handleZoomDialogResult,"handleZoomDialogResult"),$.FocusManager.instance());var o=this.getCurrentZoomValueBasedOnZoomStatus();return this._dialog.showZoomDialog(CommonUIStrings.l_ZoomDialogTitle,o),32},s.isDialogResultFullPage=function(t){return t.toLowerCase()===e.dialogResult_FullPage.toLowerCase()},s.isDialogResultPageWidth=function(t){return t.toLowerCase()===e.dialogResult_PageWidth.toLowerCase()},s.handleZoomDialogResult=function(e){var t,n,i=8;if(this.isDialogResultFullPage(e))this.currentZoomStatus=1,i=this.zoomToFit(0,null,2,null,null);else if(this.isDialogResultPageWidth(e))this.currentZoomStatus=2,i=this.zoomToPageWidth(0,null,2,null,null);else{var r=Number.parseInvariant(e);if(r){this.currentZoomStatus=0;var a=r;this.appSettingsManager&&this.appSettingsManager.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled")&&(a=new Ke(r,!0)),i=this.setCustomZoom(0,null,2,null,a)}else i=8}32===i?w.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",((t={}).DialogResult=e,t)):w.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",((n={}).DialogResult=e,n))},s.raiseZoomChangedEvent=function(){this.eventSource.raiseEvent("ZoomChanged",null)},s.raisePinchStartEvent=function(){},s.raisePinchEndEvent=function(){},s.zoomDialogTabFocusHandler=function(e,t,n,i,r){if(!this._dialog)return 2;var a=this._dialog.focusManager.getCurrentRegion().listing.currentElement;if(a===this._dialog._btnCancel&&e===ve.a.zoomDialogFocusForward||a===this._dialog._btnAction&&e===ve.a.zoomDialogFocusBackward)this._dialog.activeSelection||this._dialog.selectFirstZoomOption(),this._dialog.focusManager.getCurrentRegion().listing.trySetCurrentElement(this._dialog.activeSelection);else if(a.id.startsWith(this._dialog.radioboxPrefix)||a.className.startsWith(this._dialog.radioRowClassName)){var o=null;e===ve.a.zoomDialogFocusForward?o=this._dialog._btnAction:e===ve.a.zoomDialogFocusBackward&&(o=this._dialog._btnCancel),this._dialog.focusManager.getCurrentRegion().listing.trySetCurrentElement(o),Sys.UI.DomElement.removeCssClass(this._dialog.activeSelection.parentNode,this._dialog.radioRowHighlightClassName)}else if(e===ve.a.zoomDialogFocusForward)this._dialog.focusManager.getCurrentRegion().moveForward();else{if(e!==ve.a.zoomDialogFocusBackward)return 2;this._dialog.focusManager.getCurrentRegion().moveBackward()}return 32},t=e,(n=[{key:"currentZoom",get:function(){return this._currentZoom}},{key:"currentZoomOnUI",get:function(){return Math.round(100*this.currentZoom)}},{key:"nextValueIncreaseZoom",get:function(){return Math.floor(this.currentZoomOnUI/10)/10+this.delta}},{key:"nextValueDecreaseZoom",get:function(){return Math.ceil(this.currentZoomOnUI/10)/10-this.delta}},{key:"_actionManager",get:function(){return o.AFrameworkApplication.theActionManager}}])&&Qe(t.prototype,n),i&&Qe(t,i),e}();Ze.dialogResult_FullPage="FullPage",Ze.dialogResult_PageWidth="PageWidth",Object(i.a)(Ze,"ZoomManager",null,[256]);var $e=n(35),Xe=function(){function e(e,t,n){this._actionManager=e,this._zoomManager=t,this._appSettingsManager=n}return e.prototype.registerActions=function(){this._appSettingsManager.getBooleanAppSetting("ZoomPopupDialogIsEnabled")&&(this._actionManager.addAction(ve.a.showZoomDialog,$e.a.frame,Object(r.d)(this._zoomManager,this._zoomManager.showZoomDialog,"showZoomDialog")),this._actionManager.addActionWithFlags(ve.a.queryZoomText,$e.a.frame,Object(r.d)(this._zoomManager,this._zoomManager.onQueryZoomText,"onQueryZoomText"),96),this._actionManager.addAction(ve.a.zoomDialogFocusForward,$e.a.frame,Object(r.d)(this._zoomManager,this._zoomManager.zoomDialogTabFocusHandler,"zoomDialogTabFocusHandler")),this._actionManager.addAction(ve.a.zoomDialogFocusBackward,$e.a.frame,Object(r.d)(this._zoomManager,this._zoomManager.zoomDialogTabFocusHandler,"zoomDialogTabFocusHandler")))},e}();Object(i.a)(Xe,"CommonZoomActor",null,[258]);var Je=n(80),Ye=n(98);function et(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var nt=function(e){var t,i;function a(t,n,i,a,o){var s;return(s=e.call(this,n,i)||this)._zoomFlag=3,s._isThroughZoomDialog=!1,s._isInitZoomLogged=!1,s._scrollControl=null,s._app=t,s._lazyPostMessenger=a,s._documentDataUtils=o,s._currentDevicePixelRatio=window.self.devicePixelRatio,s._newEmbedModeIsEnabled=n.getBooleanAppSetting("NewEmbedModeIsEnabled"),s._isSmallView=n.getBooleanAppSetting("IsSmallView"),s._useSetCustomZoomArgs=n.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled"),i.addActionWithFlags(Me.a.onZoomChange,Ee.a.application,Object(r.d)(tt(s),s.onZoomChange,"onZoomChange"),8),i.addAction(Me.a.fitHeight,Ee.a.application,Object(r.d)(tt(s),s.onFitFullPage,"onFitFullPage")),i.addAction(Me.a.fitWidth,Ee.a.application,Object(r.d)(tt(s),s.onFitPageWidth,"onFitPageWidth")),i.addActionWithFlags(Me.a.queryZoomLevel,Ee.a.application,Object(r.d)(tt(s),s.onQueryZoomLevel,"onQueryZoomLevel"),97),i.addActionWithFlags(Me.a.updateZoomOnWindowResize,Ee.a.application,Object(r.d)(tt(s),s.updateZoomOnWindowResize,"updateZoomOnWindowResize"),96),i.addActionWithFlags(Me.a.zoomToNextLevel,Ee.a.application,Object(r.d)(tt(s),s.onNextZoomLevel,"onNextZoomLevel"),96),n.getBooleanAppSetting("ZoomPopupDialogIsEnabled")||i.addActionWithFlags(Me.a.queryZoomText,Ee.a.application,Object(r.d)(tt(s),s.onQueryZoomText,"onQueryZoomText"),97),i.addActionWithFlags(Me.a.populateZoomFlyout,Ee.a.application,Object(r.d)(tt(s),s.populateZoomFlyout,"populateZoomFlyout"),96),i.addActionWithFlags(Me.a.setZoomLevel,Ee.a.application,Object(r.d)(tt(s),s.setZoomLevel,"setZoomLevel"),8),s}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var s,l,c,u=a.prototype;return u.dispose=function(){},u.setZoomLevel=function(e,t,n,i,r){var a=r;if(a<this._app.theConfig.minimumZoom||a>this._app.theConfig.maximumZoom){var o,s,l=((o={}).newLevel=a,o.maxZoom=this._app.theConfig.maximumZoom,o.minZoom=this._app.theConfig.minimumZoom,o);return w.ULS.sendTraceTag(34219330,301,10,"ZoomChangeError: "+l),this._lazyPostMessenger.value.sendError(((s={}).errorType="ZoomChangeError",s.errorObject=l,s)),16}return this._zoomFlag=0,this.updateZoom(a),32},u.fitPage=function(e){if(e){var t=n(14).App.get_activeAppFrame().workspace.getHeight(),i=this.scrollControl.getWidth();this.onFitPage(i,t)}else this.onFitWidth(this.scrollControl.getWidth())},u.updateZoomOnWindowResize=function(e,t,i,r,a){var s=n(14).App,l=this._currentDevicePixelRatio;if(this._currentDevicePixelRatio=window.self.devicePixelRatio,this._currentDevicePixelRatio!==l&&w.ULS.sendTraceTag(25236178,353,50,'{{"ZoomedThroughBrowser":1, "OldBrowserZoom":{0}, "NewBrowserZoom":{1}}}',l,this._currentDevicePixelRatio),3===this._zoomFlag)if(this._isSmallView&&(o.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.WordViewer.IWacWordViewerNewEmbedModeSettings"),w.ULS.sendTraceTag(36226190,301,50,"{{NewEmbedModeIsEnabled: {0}}}",this._newEmbedModeIsEnabled)),this._isSmallView&&!this._newEmbedModeIsEnabled)this.fitPage(!1);else{var c=1;if(s.get_activeAppFrame().workspace){var u=n(14).App.get_activeAppFrame().workspace.getCurrentPage();c=(this.scrollControl.getWidth()-2*this._app.theConfig.marginPixels)/this._documentDataUtils.getPageWidthAtZoom(u,1)}c>1?c=1:!this._isSmallView&&c<.75?c=.75:this._isSmallView&&c<.1&&this._newEmbedModeIsEnabled&&(c=.1),this.updateZoom(c)}else this._zoomFlag?this.fitPage(1===this._zoomFlag):this.actionManager.processAction(Me.a.resizeCache,2);return 32},u.onFitFullPage=function(e,t,i,r,a){var o=n(14).App;return 1===i?o.isReadyForRibbon()?32:8:(this._isThroughZoomDialog?w.ULS.sendTraceTag(7410945,353,50,"Word Viewer - Zoom to fit page height through new dialog"):w.ULS.sendTraceTag(7410946,353,50,"Word Viewer - Zoom to fit page height through old menu"),this.fitPage(!0),32)},u.onZoomChangeCustomAction=function(t){this._isThroughZoomDialog?w.ULS.sendTraceTag(7410947,353,50,"Word Viewer - Zoom to custom value through new dialog: {0}",t):w.ULS.sendTraceTag(7410948,353,50,"Word Viewer - Zoom to custom value through old menu : {0}",t),this._zoomFlag=0,e.prototype.onZoomChangeCustomAction.call(this,t)},u.isReadyForRibbon=function(){return n(14).App.isReadyForRibbon()},u.onFitPageWidth=function(e,t,i,r,a){var o=n(14).App;return 1===i?o.isReadyForRibbon()?32:8:(this._isThroughZoomDialog?w.ULS.sendTraceTag(7410949,353,50,"Word Viewer - Zoom to fit page width through new dialog"):w.ULS.sendTraceTag(7410950,353,50,"Word Viewer - Zoom to fit page width through old menu"),this.fitPage(!1),32)},u.zoomOnFitPage=function(e,t){var i,r=n(14).App,a=n(14).App,o=(t-=this._app.theConfig.pageGapPixels)/(i=r.get_activeAppFrame()?this._documentDataUtils.getPageHeightAtZoom(a.get_activeAppFrame().workspace.getCurrentPage(),1):this._documentDataUtils.getPageHeightAtZoom(1,1));e-=2*this._app.theConfig.marginPixels;var s,l=this._documentDataUtils.getPageWidthAtZoom(n(14).App.get_activeAppFrame().workspace.getCurrentPage(),1),c=e/l;return o>c?l*(s=o)>e&&(s/=l*s/e):i*(s=c)>t&&(s/=i*s/t),s},u.onFitPage=function(e,t){this._zoomFlag=1,this.updateZoom(this.zoomOnFitPage(e,t))},u.zoomOnFitWidth=function(e){e-=2*this._app.theConfig.marginPixels;var t=n(14).App.get_activeAppFrame().workspace.getCurrentPage();return e/this._documentDataUtils.getPageWidthAtZoom(t,1)},u.onFitWidth=function(e){this._zoomFlag=2,this.updateZoom(this.zoomOnFitWidth(e))},u.onNextZoomLevel=function(e,t,i,r,a){if(2===i){var o,s=n(14).App.get_activeAppFrame().workspace.getHeight(),l=this.scrollControl.getWidth(),c=this.zoomOnFitPage(l,s),u=this.zoomOnFitWidth(l),d=[1,1.5,c,u];for(d.sort(),o=0;o<d.length&&!(d[o]-this.currentZoom>=.05);o++);var p=d[o%=d.length];this._zoomFlag=p===c?1:p===u?2:0,this.updateZoom(p)}return 32},u.updateZoom=function(e,t){void 0===t&&(t=0);var i=n(14).App,r=n(14).App;e<this._app.theConfig.minimumZoom?e=this._app.theConfig.minimumZoom:e>this._app.theConfig.maximumZoom&&(e=this._app.theConfig.maximumZoom);var a=!(2&t),o=a?this.repositionScrollbars(this.currentZoom,e):null,s=!!(1&t);!s&&this._isInitZoomLogged&&this.currentZoom!==e&&w.ULS.sendTraceTag(25236179,353,50,'{{"ZoomedThroughViewer":1 , "OldViewerZoom":{0}, "NewViewerZoom":{1}, "ZoomFlag":{2}}}',this.currentZoom,e,We[this._zoomFlag]),this._isInitZoomLogged||(w.ULS.sendTraceTag(25236180,353,50,'Zoom properties on boot. {{"ZoomFlag":{0},"ZoomLevel":{1}}}',We[this._zoomFlag],e),this._isInitZoomLogged=!0);var l=this.currentZoom;this._currentZoom=e;var c=a?Me.a.resizeScroller:Me.a.resizeScrollerWithoutAnimation,u=a?Me.a.resizeCache:Me.a.resizeCacheWithoutAnimation,d=a?Me.a.rebuildCommentHints:Me.a.rebuildCommentHintsWithoutAnimation;if(this.actionManager.processAction(c,2),this.actionManager.processAction(u,2),a&&this.actionManager.processActionWithData(Me.a.repositionScroller,2,new Be.a(o[0],o[1])),this.actionManager.processAction(Me.a.updateSelection,2),this.actionManager.processAction(d,2),this.actionManager.processAction(Me.a.updateSearchHighlight,2),this.actionManager.processAction(Me.a.onContainerResizeForSelection,2),!s&&this.currentZoom!==l){var p,h=((p={}).newLevel=this.currentZoom,p.oldLevel=l,p);this.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this._lazyPostMessenger.value.sendMessageWithRetry(me.a.zoomChangeEvent,h):this._lazyPostMessenger.value.sendMessage(me.a.zoomChangeEvent,h)}return!(4&t)&&i.get_activeAppFrame().statusBarUser&&r.get_activeAppFrame().statusBarUser.pollZoomControl(),!0},u.populateZoomFlyout=function(e,t,n,i,r){if(1===n)return 2===this._app.status?32:8;var a=[Je.f("btnZoom200","3006111724",200),Je.f("btnZoom150","3006111724",150),Je.f("btnZoom100","3006111724",100),Je.f("btnZoom75","3006111724",75),Je.f("btnZoom50","3006111724",50)],o=Je.c("msZoom.Controls",a),s=Je.d("msZoom",o,null),l=[Je.a("fseaFitHeight","2719151194",WordViewerIntl.WordViewerStrings.L_FitHeight),Je.a("fseaFitWidth","2289035997",WordViewerIntl.WordViewerStrings.L_FitWidth)],c=Je.c("msZoomFit.Controls",l),u=[s,Je.d("msZoomFit",c,null)],d=Je.e(u,"menuZoom");return r.PopulationXML=d,32},u.setMaximumZoom=function(e){this._app.theConfig.minimumZoom<=e&&(this._app.theConfig.maximumZoom=e,this.updateZoom(this.currentZoom))},u.setMinimumZoom=function(e){e<=0||e<=this._app.theConfig.maximumZoom&&(this._app.theConfig.minimumZoom=e,this.updateZoom(this.currentZoom))},u.repositionScrollbars=function(e,t){var i=n(14).App,r=n(14).App.get_activeAppFrame().workspace.getCurrentPage(),a=t/e,o=[];if(i.get_activeAppFrame()){var s=this.scrollControl.getScrollTop(),l=this.scrollControl.getScrollLeft(),c=this.scrollControl.getWidth();if(s<this._app.theConfig.pageGapPixels/2)o[0]=s;else{var u=Math.round((r-.5)*this._app.theConfig.pageGapPixels);o[0]=Math.round((s-u)*a)+u}var d=this._documentDataUtils.getPageWidthAtZoom(r,t)+2*this._app.theConfig.marginPixels;if(c>d)o[1]=0;else{var p=1*l/(this._documentDataUtils.getPageWidthAtZoom(r,e)+2*this._app.theConfig.marginPixels-c);o[1]=p*(d-c)}}else o[0]=0,o[1]=0;return o},u.setCustomZoom=function(e,t,n,i,a){var o=a;if(this._useSetCustomZoomArgs){if(!Object(r.c)(Ke,a))return w.ULS.sendTraceTag(51644239,353,10,"actiondata is not a SetCustomZoomArgs"),8;o=a.zoom}return this._isThroughZoomDialog=!0,this.onZoomChange(e,t,n,i,o)},u.zoomToFit=function(e,t,n,i,r){return this._isThroughZoomDialog=!0,this.onFitFullPage(e,t,n,i,r)},u.zoomToPageWidth=function(e,t,n,i,r){return this._isThroughZoomDialog=!0,this.onFitPageWidth(e,t,n,i,r)},u.initializeActor=function(){new Xe(this.actionManager,this,this.appSettingsManager).registerActions()},s=a,(l=[{key:"isFitPage",get:function(){return 1===this._zoomFlag}},{key:"appName",get:function(){return"WordViewer"}},{key:"maximumZoom",get:function(){return this._app.theConfig.maximumZoom}},{key:"minimumZoom",get:function(){return this._app.theConfig.minimumZoom}},{key:"zoomLabelTextDictionaryKey",get:function(){return Ye.a.LabelText}},{key:"scrollControl",get:function(){return this._scrollControl||(this._scrollControl=ge.a.instance.resolve("WordViewer.Controls.IScrollControl"))}}])&&et(s.prototype,l),c&&et(s,c),a}(Ze);Object(i.a)(nt,"ZoomControl",Ze,[255,256,4]);var it=n(78),rt=n(7),at=n(36);function ot(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var st=function(){function e(e,t,i,a){this._elementId="viewerContents",this._pdfElement=null,this._disposed=!1;var s=n(14).App;if(this._parent=e,this._appSettingsManager=t,this._focusManager=i,this._postMessenger=a,this._fullFilename=o.AFrameworkApplication.fileName,this._isCoreMode=this._appSettingsManager.getBooleanAppSetting("IsCoreMode"),this._isJsApi=this._appSettingsManager.getBooleanAppSetting("IsJsApi"),this._url="WordViewer/Document.pdf?"+t.getStringAppSetting("BaseDocQueryParam"),this._url=D.a.addOrReplaceParameterValue(this._url,"type",t.getBooleanAppSetting("IsSmallView")||t.getBooleanAppSetting("IsNoChrome")?"accessprintpdf":"accesspdf"),this._url=D.a.addOrReplaceParameterValue(this._url,"language",t.getStringAppSetting("TranslationLanguage")),w.ULS.sendTraceTag(20820060,301,50,"Sending request for the PDF in accessible mode."),!se.a.doRequest(this._url,Object(r.d)(this,this.onRequestComplete,"onRequestComplete"),s.get_activeAppFrame().notificationBar)){var l="We failed to send the request for the PDF in accessible mode.";this.showErrorDialogAndLogMessage(l),l+=String.format(" URL: {0}",this._url),at.a.propagateError(!0,"RequestFailed",j.a.downloadAccessiblePdfViewFailed,l)}}var t,i,a,s=e.prototype;return s.onRequestComplete=function(e,t,i){var r=this,a=n(14).App;if(!this._disposed){if(!e){var s=String.format("The request for the PDF in accessible mode failed. HTTP Status: {0} Request Status: {1}",i.httpStatus,i.status);return this.showErrorDialogAndLogMessage(s),void at.a.propagateError(!0,"RequestFailed",j.a.downloadAccessiblePdfViewFailed,s)}var l=i.responseXml,c=null;if(l&&(c=l.selectSingleNode("/docdata")),c){var u=String.format("The request for the PDF in accessible mode never returned the PDF. HTTP Status: {0} Request Status: {1}",i.httpStatus,i.status);w.ULS.sendTraceTag(20480266,301,10,u),at.a.showErrorDialog(l),at.a.propagateError(!0,"RequestFailed",j.a.downloadAccessiblePdfViewFailed,u)}else{if(a.reportFirstPageAndRenderTime(),o.AFrameworkApplication.reportDocumentLoadedTime(),this._pdfElement=document.createElement("object"),this._pdfElement.id=this._elementId,this._pdfElement.title=String.format("{0} {1}",this._fullFilename,CommonUIStrings.l_AppTitle),this._pdfElement.setAttribute(rt.a.ariaRoleAttribute,rt.a.ariaDocumentRole),this._pdfElement.setAttribute("type","application/pdf"),this._pdfElement.setAttribute("data",this._url+"#page="+a.initialPageNumber),this._pdfElement.setAttribute("height","100%"),this._pdfElement.setAttribute("width","100%"),this._pdfElement.tabIndex=0,this._pdfElement.style.display="none",this._parent.appendChild(this._pdfElement),this._pdfElement.style.display="",o.AFrameworkApplication.dismissSplashScreen(),b.a.isInternetExplorerEdge){var d=new it.DOMFocusListing((function(){return r._parent}));d.addValidTag(11);var p=this._focusManager.buildRegion(this._parent,this._focusManager.getScope(W.AFrame.documentFocusID),d);p.contained=!1,p.looped=!1,d.trySetCurrentElement(this._pdfElement)}else this._pdfElement.focus();this._postMessenger.reportAppCompleted()}}},s.showErrorDialogAndLogMessage=function(e){w.ULS.sendTraceTag(20480267,301,10,e),at.a.showErrorDialogEx(j.a.downloadAccessiblePdfViewFailed,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorDialogMessage)},s.dispose=function(){this._disposed||(this._parent=null,this._pdfElement=null,this._disposed=!0)},t=e,(i=[{key:"currentPage",get:function(){return 1}},{key:"endPage",get:function(){return 1}},{key:"startPage",get:function(){return 1}},{key:"outerElementID",get:function(){return this._elementId}}])&&ot(t.prototype,i),a&&ot(t,a),e}();Object(i.a)(st,"DisplayManagerPdf",null,[260,4]);var lt=n(61),ct=function(e,t){return e.createElement(t.toString())},ut=function(){function e(e){this._tagName=e}return e.prototype.toString=function(){return this._tagName},e}();ut.a=new ut("a"),ut.br=new ut("br"),ut.col=new ut("col"),ut.colgroup=new ut("colgroup"),ut.div=new ut("div"),ut.img=new ut("img"),ut.li=new ut("li"),ut.ol=new ut("ol"),ut.p=new ut("p"),ut.path=new ut("path"),ut.span=new ut("span"),ut.svg=new ut("svg"),ut.table=new ut("table"),ut.tbody=new ut("tbody"),ut.td=new ut("td"),ut.tr=new ut("tr"),ut.ul=new ut("ul"),Object(i.a)(ut,"DomTagName",null,[]);var dt=function(e,t,n,i,r){var a=["FShadowLeftInner","FShadowLeftOuter","FShadowTopLeftInner","FShadowTopLeftOuter","FShadowTopInner","FShadowTopOuter","FShadowTopRightInner","FShadowTopRightOuter","FShadowRightInner","FShadowRightOuter","FShadowBottomRightInner","FShadowBottomRightOuter","FShadowBottomInner","FShadowBottomOuter","FShadowBottomLeftInner","FShadowBottomLeftOuter"],o=[t,t,t&&n,t&&n,n,n,n&&i,n&&i,i,i,i&&r,i&&r,r,r,r&&t,r&&t];var s=ct(e,ut.div);s.className="WACPageBorder";for(var l=0;l<a.length;l++)if(o[l]){var c=ct(e,ut.div);c.className=a[l],s.appendChild(c)}return s},pt=function(){function e(){this.pageImage=null,this.waitImage=null,this.isPageImageErrorHandlerAdded=!1}return e.prototype.dispose=function(){this.pageImage=null,this.waitImage=null},e}();Object(i.a)(pt,"ImageSet",null,[4]);var ht=n(213),mt=n(313);function gt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ft=function(){function e(e,t,n,i,a,o,s,l,c,u){this._cachePageCount=0,this._startPage=1,this._currentPage=1,this._oldPage=1,this._isBootFinished=!1,this._isDisposed=!1,this._retryRequest=null,this._parent=e,this._appSettingsManager=t,this._actionManager=n,this._focusManager=i,this._postMessenger=a,this._documentDataUtils=o,this._lazyZoomControl=s,this._lazyScrollControl=l,this._theConfig=c,this._theDocument=u,this._elementId=this._parent?this._parent.id:"",this._images=[],this._actionManager.addActionWithFlags(Me.a.onScroll,Ee.a.application,Object(r.d)(this,this.onScroll,"onScroll"),96),this._actionManager.addActionWithFlags(Me.a.resizeCache,Ee.a.application,Object(r.d)(this,this.resizeCache,"resizeCache"),96),this._actionManager.addActionWithFlags(Me.a.resizeCacheWithoutAnimation,Ee.a.application,Object(r.d)(this,this.resizeCacheWithoutAnimation,"resizeCacheWithoutAnimation"),96),this._actionManager.addActionWithFlags(Me.a.setCurrentPage,Ee.a.application,Object(r.d)(this,this.setCurrentPage,"setCurrentPage"),8),this._pageImageLoadedHandler=Object(r.d)(this,this.onPageImgLoaded,"onPageImgLoaded"),this._pageImageErrorHandler=Object(r.d)(this,this.onPageImgLoadError,"onPageImgLoadError")}var t,i,a,s=e.prototype;return s.calculatePageCount=function(){var e=this.zoomControl.currentZoom,t=n(14).App.get_activeAppFrame().workspace,i=Math.ceil(t.getHeight()/(this._documentDataUtils.minPageHeight*e));return 1+this._theConfig.pagesToCacheBefore+this._theConfig.pagesToCacheAfter+i},s.resizeCache=function(e,t,n,i,r){return this.resizeCacheInternal(e,!0)},s.resizeCacheWithoutAnimation=function(e,t,n,i,r){return this.resizeCacheInternal(e,!1)},s.resizeCacheInternal=function(e,t){var i=n(14).App;if(this.scrollControl.resizingScroller)return this.updateImages(this._startPage,t),32;var r,a=this._startPage,o=this._cachePageCount,s=this.zoomControl.currentZoom;r=i.get_activeAppFrame()?this.scrollControl.getFutureScrollTop():0;var l=this._documentDataUtils.getPageFromScrollTop(r,s),c=Math.min(this.calculatePageCount(),this._documentDataUtils.pageCount);if(c!==this._cachePageCount){var u=Math.max(1,l-this._theConfig.pagesToCacheBefore),d=(u=Math.min(u,1+this._documentDataUtils.pageCount-c))+c,p=this._startPage+this._cachePageCount;this._startPage<u&&this.removeImages(this._startPage,Math.min(u,p)),d<p&&this.removeImages(Math.max(d,this._startPage),p),u<this._startPage&&this.addImages(u,Math.min(d,this._startPage)),p<d&&this.addImages(Math.max(p,u),d),this._startPage=u,this._cachePageCount=c}l!==this._currentPage&&(this._oldPage=this._currentPage,this._currentPage=l,this.callSetPage()),this.updateImages(this._startPage,t);var h=n(14).App.get_activeAppFrame().thePageInfoCache;return h&&e!==lt.ActionManager.nullAction&&h.removeFromCache(a,a+o-1),32},s.addImages=function(t,n){for(var i=n-t,r=this._startPage<t?this._images.length:0,a=0;a<i;a++){var o=dt(this._parent.ownerDocument,!0,!0,!0,!0);this._parent.appendChild(o);var s=document.createElement("img");s.id="i"+(t+a),s.className="WACPageImg",s.style.display="inline",s.style.visibility="hidden",X.a.addHandler(s,"load",this._pageImageLoadedHandler),o.appendChild(s),X.a.addHandler(s,"error",this._pageImageErrorHandler);var l=e.createWaitElement(t+a,this._parent);this._parent.appendChild(l);var c=new pt;c.pageImage=s,c.waitImage=l,c.isPageImageErrorHandlerAdded=!0,Array.insert(this._images,a+r,c)}},s.removeImages=function(e,t){for(var n=e;n<t;n++){for(var i=0,r=0;r<this._images.length;r++){if(this._images[r].pageImage.id.substr(1)===n.toString()){i=r;break}}var a=this._images[i];Array.removeAt(this._images,i),X.a.removeHandler(a.pageImage,"load",this._pageImageLoadedHandler),a.isPageImageErrorHandlerAdded&&(X.a.removeHandler(a.pageImage,"error",this._pageImageErrorHandler),a.isPageImageErrorHandlerAdded=!1),this._parent.removeChild(a.pageImage.parentNode),this._parent.removeChild(a.waitImage)}},s.updateImages=function(e,t){var i=n(14).App;if(this._startPage===e&&1===this._startPage)for(var r=0;r<this._cachePageCount;r++)this.swapImages(e+r,r,0,t);else if(this._startPage===e||this._startPage+this._cachePageCount-1<e||e+this._cachePageCount-1<this._startPage){for(var a=this._theConfig.pagesToCacheBefore;a<this._cachePageCount;a++)this.swapImages(e+a,a,0,t);for(var o=this._theConfig.pagesToCacheBefore-1;0<=o;o--)this.swapImages(e+o,o,0,t)}else if(e<this._startPage)for(var s=this._startPage-e-1;s>=0;s--)this.swapImages(e+s,Number.NaN,1,t);else for(var l=e-this._startPage-1,c=e+this._cachePageCount-1,u=l;u>=0;u--)this.swapImages(c-u,Number.NaN,2,t);var d=n(14).App.get_activeAppFrame().thePageInfoCache,p=e+this._cachePageCount-1;d&&d.addToCache(e,p),i.get_activeAppFrame().workspace.pageCacheChanged(e,p)},s.swapImages=function(e,t,n,i){var r;if(n){var a=1===n?this._images.length-1:0,s=1===n?0:this._images.length-1;r=this._images[a],Array.removeAt(this._images,a),Array.insert(this._images,s,r)}else r=this._images[t];var l="i"+e;l!==r.pageImage.id&&(X.a.removeHandler(r.pageImage,"load",this._pageImageLoadedHandler),r.isPageImageErrorHandlerAdded&&(X.a.removeHandler(r.pageImage,"error",this._pageImageErrorHandler),r.isPageImageErrorHandlerAdded=!1),r.pageImage.id=l,r.waitImage.id="wait"+e,X.a.addHandler(r.pageImage,"load",this._pageImageLoadedHandler),r.isPageImageErrorHandlerAdded||(X.a.addHandler(r.pageImage,"error",this._pageImageErrorHandler),r.isPageImageErrorHandlerAdded=!0));var c=re.a.urlForNamedObject("p"+e+".img");this._appSettingsManager.getBooleanAppSetting("UpdateAccessTokenInEditedImageUrlIsEnabled")&&(D.a.getParameterValue(c,o.AFrameworkApplication.accessTokenParamName)&&(c=D.a.addOrReplaceParameterValue(c,o.AFrameworkApplication.accessTokenParamName,encodeURIComponent(o.AFrameworkApplication.accessToken))),D.a.getParameterValue(c,o.AFrameworkApplication.accessTokenTtlParamName)&&(c=this._appSettingsManager.getBooleanAppSetting("UseServerAccessTokenTTLInClientRequests")?D.a.addOrReplaceParameterValue(c,o.AFrameworkApplication.accessTokenTtlParamName,o.AFrameworkApplication.accessTokenServerExpirationTime.toString()):D.a.addOrReplaceParameterValue(c,o.AFrameworkApplication.accessTokenTtlParamName,o.AFrameworkApplication.accessTokenTtl.toString()))),this.setPagePosition(r.pageImage,e,!1,i),r.pageImage.src.endsWith(c)||(r.waitImage.style.display="inline",r.pageImage.src=c),this.setPagePosition(r.waitImage,e,!0,i)},s.alignPageHorizontally=function(e){var t=this.zoomControl.currentZoom;return this._documentDataUtils.getPageLeftAtZoom(e,t,!1)},s.onScroll=function(e,t,i,r,a){var o=n(14).App;if(this.scrollControl.resizingScroller)return 32;var s=a,l=Math.max(0,s.scrollTop),c=!1;if(o.get_activeAppFrame()){var u=this._documentDataUtils.getPageFromScrollTop(l+20,this.zoomControl.currentZoom);u!==this._currentPage&&(this._oldPage=this._currentPage,this._currentPage=u,c=!0)}else this._currentPage=1;var d=Math.max(1,this._currentPage-this._theConfig.pagesToCacheBefore);if((d=Math.min(d,1+this._documentDataUtils.pageCount-this._cachePageCount))!==this._startPage){var p=n(14).App.get_activeAppFrame().thePageInfoCache;this.updateImages(d,!1);var h=this._startPage;this._startPage=d,p.removeFromCache(h,Math.min(this._startPage,h+this._cachePageCount-1)),p.removeFromCache(Math.max(this._startPage+this._cachePageCount-1,h),h+this._cachePageCount-1)}return c&&this.callSetPage(),this._appSettingsManager.getBooleanAppSetting("BroadcastMode")&&this._actionManager.processActionWithData(Me.a.broadcastOnScroll,2,new Ue.a(this._currentPage,new Be.a(l,s.scrollLeft),0)),32},s.callSetPage=function(){var e,t=n(14).App,i=((e={}).newPage=this._currentPage,e.oldPage=this._oldPage,e);this._appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this._postMessenger.sendMessageWithRetry(me.a.pageChangeEvent,i):this._postMessenger.sendMessage(me.a.pageChangeEvent,i),t.get_activeAppFrame().statusBarUser&&t.get_activeAppFrame().statusBarUser.pollControl(ke.a.pageInfoLabel)},s.setCurrentPage=function(e,t,i,r,a){var o=n(14).App,s=a;if(o.get_activeAppFrame().workspace&&o.get_activeAppFrame().workspace.initialized){var l;if(s>0&&s<=this._documentDataUtils.pageCount)return this.scrollControl.scrollToPage(s),32;this.raisePageChangeError(((l={}).errorType="InvalidPageIndex",l.newPage=s,l.pageCount=this._documentDataUtils.pageCount,l))}else{var c,u;w.ULS.sendTraceTag(35149196,301,10,"AppInitError: SetCurrentPageError"),this._postMessenger.sendError(((u={}).errorType="AppInitError",u.errorObject=((c={}).Message="App was likely not fully initialized when SetCurrentPage was called",c),u))}return 16},s.raisePageChangeError=function(e){var t,i=n(14).App.get_activeAppFrame().getTopParagraphId();i&&(e.topParagraphId=i);var r=((t={}).errorType="PageChangeError",t.errorObject=e,t);w.ULS.sendTraceTag(35149197,301,10,JSON.stringify(r)),this._postMessenger.sendError(r)},s.dispose=function(){if(!this._isDisposed){for(var e=0;e<this._images.length;e++){var t=this._images[e];X.a.removeHandler(t.pageImage,"load",this._pageImageLoadedHandler),t.isPageImageErrorHandlerAdded&&(X.a.removeHandler(t.pageImage,"error",this._pageImageErrorHandler),t.isPageImageErrorHandlerAdded=!1),t.dispose()}this._images&&(Array.clear(this._images),this._images=null),this._pageImageLoadedHandler=null,this._pageImageErrorHandler=null,this._isDisposed=!0,this._parent=null}},s.setPagePosition=function(e,t,n,i){var r=this.zoomControl.currentZoom,a=this._documentDataUtils.getPageTopAtZoom(t,r),s=this._documentDataUtils.getPageWidthAtZoom(t,r),l=this._documentDataUtils.getPageHeightAtZoom(t,r);if(i?Le.a.animateSize(e,l,s):(e.style.height=l+"px",e.style.width=s+"px"),n){if(e.children.length>0){i?Le.a.animatePosition(e,this.alignPageHorizontally(t),a):(e.style.top=a+"px",o.AFrameworkApplication.isRtl?e.style.right=this.alignPageHorizontally(t)+"px":e.style.left=this.alignPageHorizontally(t)+"px");var c=e.lastChild;c.id&&""!==c.id.trim()||(c.id="WACProgress"+c.parentNode.id),i?Le.a.animatePosition(c,s/2,.3*l):(c.style.top=.3*l+"px",o.AFrameworkApplication.isRtl?c.style.right=s/2+"px":c.style.left=s/2+"px")}}else i?(Le.a.animateSize(e.parentNode,l,s),Le.a.animatePosition(e.parentNode,this.alignPageHorizontally(t),a)):(e.parentNode.style.height=l+"px",e.parentNode.style.width=s+"px",e.parentNode.style.top=a+"px",o.AFrameworkApplication.isRtl?e.parentNode.style.right=this.alignPageHorizontally(t)+"px":e.parentNode.style.left=this.alignPageHorizontally(t)+"px")},s.onRetrySuccessful=function(e){this._retryRequest=null;for(var t=0;t<this._cachePageCount;t++){var n=this._images[t];n.isPageImageErrorHandlerAdded&&(X.a.removeHandler(n.pageImage,"error",this._pageImageErrorHandler),n.isPageImageErrorHandlerAdded=!1),n.pageImage.src="",n.pageImage.src=re.a.urlForNamedObject("p"+(t+this._startPage)+".img")}},s.onPageImgLoadError=function(e){var t=e.rawEvent.srcElement,n=parseInt(t.id.substr(1));isNaN(n)||n<1||n>this._theDocument.pageCount||this._retryRequest||(this._retryRequest=new mt.a(Object(r.d)(this,this.onRetrySuccessful,"onRetrySuccessful"),t.src),this._retryRequest.send())},s.onPageImgLoaded=function(e){var t=n(14).App;if(e)if(e.rawEvent)if(e.rawEvent.srcElement){var i=e.rawEvent.srcElement;if(i)if(i.id&&i.id.substr(1)){var a=parseInt(i.id.substr(1));if(!(isNaN(a)||a<1||a>this._theDocument.pageCount)){if(this._isBootFinished||a!==t.initialPageNumber)5===a&&o.AFrameworkApplication.theWsaClient.setBool(8810,1);else{var s,l,c,u;if(this._isBootFinished=!0,t.reportFirstPageAndRenderTime(),o.AFrameworkApplication.reportDocumentLoadedTime(),ie.a.mark(5039),ee.PageStats.endRootMeasurement("Load"),this._appSettingsManager.getBooleanAppSetting("IsJsApiV2"))this._postMessenger.sendMessageWithRetry(me.a.appStateEvent,((s={}).pageCount=this._documentDataUtils.pageCount,s.newPage=this.currentPage,s.newLevel=this.zoomControl.currentZoom,s));else this._postMessenger.sendPageCountWithRetry(new ht.a(me.a.pageCountEvent,((l={}).pageCount=this._documentDataUtils.pageCount,l),Object(r.d)(this._postMessenger,this._postMessenger.sendPageCountWithRetry,"sendPageCountWithRetry"))),this._postMessenger.sendPageChangeWithRetry(new ht.a(me.a.pageChangeEvent,((c={}).newPage=this.currentPage,c),Object(r.d)(this._postMessenger,this._postMessenger.sendPageChangeWithRetry,"sendPageChangeWithRetry"))),this._postMessenger.sendZoomChangeWithRetry(new ht.a(me.a.zoomChangeEvent,((u={}).newLevel=this.zoomControl.currentZoom,u),Object(r.d)(this._postMessenger,this._postMessenger.sendZoomChangeWithRetry,"sendZoomChangeWithRetry")));this._postMessenger.reportAppCompleted(),this.updateImages(this._startPage,!1),this._actionManager.processAction(Me.a.documentLoadFinished,2),t.initialScrollTop&&(this._actionManager.processActionWithData(Me.a.repositionScroller,2,new Be.a(t.initialScrollTop,Number.NaN)),t.initialScrollTop=0),t.hideFirstPageImage(),o.AFrameworkApplication.dismissSplashScreen()}a===this._theDocument.pageCount&&o.AFrameworkApplication.theWsaClient.setBool(8811,1),a===this._currentPage&&ie.a.mark(5043),a===this._theDocument.pageCount&&ie.a.mark(5041),this.setPagePosition(i,a,!1,!0),i.style.display="inline",i.style.visibility="visible";var d="wait"+a,p=document.getElementById(d);p&&(p.style.display="none")}}else w.ULS.sendTraceTag(21570585,301,10,"Image element has null ID");else w.ULS.sendTraceTag(21570583,301,10,"Image element of dom event is null")}else w.ULS.sendTraceTag(21570581,301,10,"DomEvent's srcSlement is null");else w.ULS.sendTraceTag(25190429,301,10,"DomEvent's RawEvent is null");else w.ULS.sendTraceTag(21570579,301,10,"DomEvent on page image loaded is null")},e.createWaitElement=function(e,t){var n=dt(t.ownerDocument,!0,!0,!0,!0);return n.id="wait"+e.toString(),n.style.display="none",n.appendChild(at.a.createWaitImage()),n},t=e,(i=[{key:"currentPage",get:function(){return this._currentPage}},{key:"endPage",get:function(){return this._startPage+this._cachePageCount-1}},{key:"startPage",get:function(){return this._startPage}},{key:"outerElementID",get:function(){return this._elementId}},{key:"zoomControl",get:function(){return this._lazyZoomControl.value}},{key:"scrollControl",get:function(){return this._lazyScrollControl.value}}])&&gt(t.prototype,i),a&&gt(t,a),e}();Object(i.a)(ft,"DisplayManagerPng",null,[260,4]);var vt=function(){function e(e,t,n,i,r,a,o,s,l){this._appSettingsManager=e,this._actionManager=t,this._focusManager=n,this._postMessenger=i,this._documentDataUtils=r,this._lazyZoomControl=a,this._lazyScrollControl=o,this._theConfig=s,this._theDocument=l}return e.prototype.create=function(e,t){switch(e){case 0:return new ft(t,this._appSettingsManager,this._actionManager,this._focusManager,this._postMessenger,this._documentDataUtils,this._lazyZoomControl,this._lazyScrollControl,this._theConfig,this._theDocument);case 1:return new st(t,this._appSettingsManager,this._focusManager,this._postMessenger);default:0}return null},e}();Object(i.a)(vt,"DisplayManagerFactory",null,[243]);var _t=n(53),yt=n(225),bt=function(){function e(e,t,n,i){this._ackMessageTimeoutInMs=1e3,this._postMessageMaxRetries=4,this._appCompleteAckMessageReceived=!1,this._appFailedAckMessageReceived=!1,this._zoomChangeAckMessageReceived=!1,this._pageChangeAckMessageReceived=!1,this._pageCountAckMessageReceived=!1,this._isJsApi=n.getBooleanAppSetting("IsJsApi"),this._isJsApiV2=n.getBooleanAppSetting("IsJsApiV2"),this._isCoreMode=n.getBooleanAppSetting("IsCoreMode"),this._actionManager=e,this._hostPostmessenger=t,this._appSettingsManager=n,this._pageLoadPerfRecorder=i,this._isJsApi&&(this._hostPostmessenger.addAllowedReceivingMessage(me.a.setZoomLevel),this._hostPostmessenger.addAllowedReceivingMessage(me.a.setCurrentPage),this._hostPostmessenger.addAllowedReceivingMessage(me.a.hostCacheDiagnostic),this._hostPostmessenger.registerCallback(me.a.setZoomLevel,Object(r.d)(this,this.setZoomLevelHandler,"setZoomLevelHandler")),this._hostPostmessenger.registerCallback(me.a.setCurrentPage,Object(r.d)(this,this.setCurrentPageHandler,"setCurrentPageHandler")),this._hostPostmessenger.registerCallback(me.a.hostCacheDiagnostic,Object(r.d)(this,this.recordFastBootDiagnostic,"recordFastBootDiagnostic")),this._isJsApiV2||(this._hostPostmessenger.addAllowedReceivingMessage(me.a.wacAppCompletedAck),this._hostPostmessenger.addAllowedReceivingMessage(me.a.wacAppFailedAck),this._hostPostmessenger.addAllowedReceivingMessage(me.a.zoomChangeEventAck),this._hostPostmessenger.addAllowedReceivingMessage(me.a.pageChangeEventAck),this._hostPostmessenger.addAllowedReceivingMessage(me.a.pageCountEventAck),this._hostPostmessenger.registerCallback(me.a.wacAppCompletedAck,Object(r.d)(this,this.receiveAckMessages,"receiveAckMessages")),this._hostPostmessenger.registerCallback(me.a.wacAppFailedAck,Object(r.d)(this,this.receiveAckMessages,"receiveAckMessages")),this._hostPostmessenger.registerCallback(me.a.zoomChangeEventAck,Object(r.d)(this,this.receiveAckMessages,"receiveAckMessages")),this._hostPostmessenger.registerCallback(me.a.pageChangeEventAck,Object(r.d)(this,this.receiveAckMessages,"receiveAckMessages")),this._hostPostmessenger.registerCallback(me.a.pageCountEventAck,Object(r.d)(this,this.receiveAckMessages,"receiveAckMessages"))))}var t=e.prototype;return t.sendMessage=function(e,t){this._isJsApi&&this._hostPostmessenger.sendMessage(e,t)},t.sendMessageWithRetry=function(e,t){var n=yt.a.createRetriableMessage(e,t,o.AFrameworkApplication.userSessionId,3);this._hostPostmessenger.postMessage(n)},t.sendError=function(e){this.sendMessage("Error",e)},t.sendErrorWithRetry=function(e){this.sendMessageWithRetry("Error",e)},t.receiveAckMessages=function(e){switch(w.ULS.sendTraceTag(38318928,301,50,"Ack received: {0}.",e.MessageId),e.MessageId){case me.a.wacAppCompletedAck:this._appCompleteAckMessageReceived=!0;break;case me.a.wacAppFailedAck:this._appFailedAckMessageReceived=!0;break;case me.a.zoomChangeEventAck:this._zoomChangeAckMessageReceived=!0;break;case me.a.pageChangeEventAck:this._pageChangeAckMessageReceived=!0;break;case me.a.pageCountEventAck:this._pageCountAckMessageReceived=!0;break;default:w.ULS.sendTraceTag(38318929,301,15,"Received unhandled message "+e.MessageId+" from host")}},t.setZoomLevelHandler=function(e){if(!this._isJsApi||!this._isCoreMode)throw Error.invalidOperation("JsApi core mode is not enabled");if(e.Values&&_t.a.newZoomLevel in e.Values){var t=e.Values[_t.a.newZoomLevel];this._actionManager.processActionWithData(Me.a.setZoomLevel,2,t)}else{var n,i,r=((n={}).errorType="InvalidArgument",n);this.sendError(((i={}).errorType="ZoomChangeError",i.errorObject=r,i))}},t.setCurrentPageHandler=function(e){if(!this._isJsApi||!this._isCoreMode)throw Error.invalidOperation("JsApi core mode is not enabled");if(e.Values&&_t.a.newPage in e.Values){var t=e.Values[_t.a.newPage];this._actionManager.processActionWithData(Me.a.setCurrentPage,2,t)}else{var n,i,r=((n={}).errorType="InvalidArgument",n);this.sendError(((i={}).errorType="PageChangeError",i.errorObject=r,i))}},t.recordFastBootDiagnostic=function(e){e.Values&&_t.a.hostCacheLoadTime in e.Values&&this._pageLoadPerfRecorder.addMetric(te.a.fastViewOpenTime,e.Values[_t.a.hostCacheLoadTime])},t.reportAppCompleted=function(e){var t;void 0===e&&(e=!1);var n={},i=this._pageLoadPerfRecorder.getMetric(te.a.frameRequestStart);null!=i&&(n[_t.a.officeFrameRequestStartTime]=i);var a=this._pageLoadPerfRecorder.getMetric(te.a.resourceDownloadStart);null!=a&&(n[_t.a.officeFrameFirstFlushTime]=a);var s=this._pageLoadPerfRecorder.getMetric(te.a.contentViewable);if(n[_t.a.documentLoadedTime]=s||o.AFrameworkApplication.documentLoadedTime.getTime(),null==s&&w.ULS.sendTraceTag(36992713,301,15,"DocumentLoadedTime was used since ContentViewable time is null"),e)n[_t.a.ignoreForEUPL]=!0;else{var l=this._pageLoadPerfRecorder.getMetric(te.a.documentLoadedTime);null!=l&&(n[_t.a.appCompletedTime]=l)}n[_t.a.officeServerVersion]=this._appSettingsManager.getStringAppSetting("BuildVersion"),n[_t.a.officeAppEndpoint]=this._appSettingsManager.getStringAppSetting("WacCluster");var c=((t={}).Diagnostics=n,t);this._isJsApiV2?this.sendMessageWithRetry(me.a.wacAppCompleted,c):this.sendAppCompletedWithRetry(new ht.a(me.a.wacAppCompleted,c,Object(r.d)(this,this.sendAppCompletedWithRetry,"sendAppCompletedWithRetry")))},t.sendAppCompletedWithRetry=function(e){var t=this;this._isJsApi&&(window.setTimeout((function(){t.timeoutAckMessage(e,Object(a.a)((function(){return t._appCompleteAckMessageReceived}),(function(e){return t._appCompleteAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._appCompleteAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},t.sendAppFailedWithRetry=function(e){var t=this;this._isJsApi&&(window.setTimeout((function(){t.timeoutAckMessage(e,Object(a.a)((function(){return t._appFailedAckMessageReceived}),(function(e){return t._appFailedAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._appFailedAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},t.sendZoomChangeWithRetry=function(e){var t=this;this._isJsApi&&this._isCoreMode&&(window.setTimeout((function(){t.timeoutAckMessage(e,Object(a.a)((function(){return t._zoomChangeAckMessageReceived}),(function(e){return t._zoomChangeAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._zoomChangeAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},t.sendPageChangeWithRetry=function(e){var t=this;this._isJsApi&&this._isCoreMode&&(window.setTimeout((function(){t.timeoutAckMessage(e,Object(a.a)((function(){return t._pageChangeAckMessageReceived}),(function(e){return t._pageChangeAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._pageChangeAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},t.sendPageCountWithRetry=function(e){var t=this;this._isJsApi&&this._isCoreMode&&(window.setTimeout((function(){t.timeoutAckMessage(e,Object(a.a)((function(){return t._pageCountAckMessageReceived}),(function(e){return t._pageCountAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._pageCountAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},t.timeoutAckMessage=function(e,t){this._isJsApi&&!t.val&&(e.retryCount<this._postMessageMaxRetries?(e.callback(e),w.ULS.sendTraceTag(38318930,301,50,"AckMessageTimeout for {0}. Retry sent. Retries left: {1}",e.messageId,this._postMessageMaxRetries-e.retryCount)):w.ULS.sendTraceTag(38318931,301,15,"AckMessageTimeout for {0}. No retries left.",e.messageId))},e}();Object(i.a)(bt,"WordViewerPostMessenger",null,[242]);var St=n(15),Ct=n(287),At=n(63),It=function(){function e(){this._controlReactIdMap={},this._controlLegacyCommandMap={},this._tabIdMap={},this._controlLegacyIdMap={},this._groupLegacyIdMap={},this._groupReactIdMap={},this._iconMap={},this.addCommandDefinitionMapping()}var t=e.prototype;return t.getCommandById=function(e){return this._controlLegacyCommandMap[e]},t.getExternalUxIdsByLegacyControlId=function(e){return this._controlLegacyIdMap[e]},t.getGroupsMetadataByLegacyGroupId=function(e){return this._groupLegacyIdMap[e]},t.getCommandByExternalUxId=function(e){return this._controlReactIdMap[e]},t.getTabCommandByExternalUxId=function(e){return this._tabIdMap[e]},t.getExternalIconIdByLegacyIconId=function(e){return e in this._iconMap?this._iconMap[e]:(w.ULS.sendTraceTag(39946131,306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",e),"MissingIcon_20")},t.getGroupsMetadataByExternalUxId=function(e){return this._groupReactIdMap[e]},t.addAddInCommandToMaps=function(e){this.addCommandToMaps(e)},t.addCommandToMaps=function(e){var t=this._controlReactIdMap[e.externalUxCommand];if(t){delete this._controlReactIdMap[t.externalUxCommand];for(var n=this._controlLegacyCommandMap[t.commandId],i=0;i<n.length;i++)if(n[i].externalUxCommand===t.externalUxCommand){Array.remove(n,n[i]);break}}this._controlReactIdMap[e.externalUxCommand]=e;var r=this._controlLegacyCommandMap[e.commandId];null==r&&(r=new Array(0),this._controlLegacyCommandMap[e.commandId]=r),r.push(e),e.legacyControlId&&(this._controlLegacyIdMap[e.legacyControlId]||(this._controlLegacyIdMap[e.legacyControlId]=new At.a),this._controlLegacyIdMap[e.legacyControlId].add(e.externalUxCommand))},t.addTabToMap=function(e,t){this._tabIdMap[e]=t},t.addIconToMap=function(e,t){this._iconMap[t]=e},t.addGroupToMap=function(e){if(e.legacyGroupId){var t=this._groupLegacyIdMap[e.legacyGroupId];t||(t=new Array(0),this._groupLegacyIdMap[e.legacyGroupId]=t),t.push(e)}if(e.externalUxGroupId){var n=this._groupReactIdMap[e.externalUxGroupId];n||(n=new Array(0),this._groupReactIdMap[e.externalUxGroupId]=n),n.push(e)}},t.addCommandDefinitionMapping=function(){this.addCommandToMaps(Object.assign(new St.a("AccessibilityHelp","3276527670"),{legacyControlId:"jbtnAccessibilityHelp"})),this.addCommandToMaps(new St.a("CoauthorsRendered","691867605")),this.addCommandToMaps(new St.a("CopyLink","981334692")),o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.catchUpFlyoutEnabled?this.addCommandToMaps(Object.assign(new St.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",queryCommandId:"1059068017"})):this.addCommandToMaps(Object.assign(new St.a("CatchUpWithChanges","1956545633"),{legacyControlId:"CatchUpWithChanges",queryCommandId:"1715205439"})),this.addCommandToMaps(Object.assign(new St.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"})),this.addCommandToMaps(Object.assign(new St.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"})),this.addCommandToMaps(Object.assign(new St.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"})),this.addCommandToMaps(Object.assign(new St.a("DownloadACopy","3555692408"),{legacyControlId:"jbtnDownloadACopy"})),this.addCommandToMaps(new St.a("FileMenuLauncher","1784018444")),this.addCommandToMaps(Object.assign(new St.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"})),this.addCommandToMaps(Object.assign(new St.a("Help","1454393937"),{legacyControlId:"jbtnHelp"})),this.addCommandToMaps(new St.a("InsertAddIns","1945259303")),this.addCommandToMaps(new St.a("InsertComment","2423504651")),this.addCommandToMaps(Object.assign(new St.a("InsertComment","2423504651"),{legacyControlId:"btnInsertComment"})),this.addCommandToMaps(new St.a("MenuClose","336231556")),this.addCommandToMaps(new St.a("MenuOpen","336231556")),this.addCommandToMaps(new St.a("MenuPopulate","336231556")),this.addCommandToMaps(new St.a("MoveToFolder","1182470434")),this.addCommandToMaps(new St.a("NavigateToCoauthor","4033456482")),this.addCommandToMaps(new St.a("New","1056925771")),this.addCommandToMaps(new St.a("NewBrowserSuggestionClicked","3734060499")),this.addCommandToMaps(Object.assign(new St.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"})),this.addCommandToMaps(Object.assign(new St.a("PeopleWell","929022654"),{queryCommandId:"3798167515",populationProps:new Ct.a("1285265560",!1)})),this.addCommandToMaps(Object.assign(new St.a("Privacy","1208554566"),{legacyControlId:"jbtnPrivacy"})),this.addCommandToMaps(Object.assign(new St.a("Rename","2382951455"),{legacyControlId:"jbtnRenameDialog"})),this.addCommandToMaps(Object.assign(new St.a("SaveAs","4246497969"),{legacyControlId:"jbtnSaveACopy"})),this.addCommandToMaps(Object.assign(new St.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"})),this.addCommandToMaps(Object.assign(new St.a("SaveToSharePoint","3050207199"),{legacyControlId:"jbtnSaveToSharePoint"})),this.addCommandToMaps(Object.assign(new St.a("SearchHelp","2918242107"),{legacyControlId:"btnHelp"})),this.addCommandToMaps(Object.assign(new St.a("Share","981334692"),{legacyControlId:"jbtnFileSharing"})),this.addCommandToMaps(Object.assign(new St.a("SmartLookUp","1435347209"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new St.a("TabSwitch","336231556")),this.addCommandToMaps(Object.assign(new St.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"})),this.addCommandToMaps(Object.assign(new St.a("Training","2918242107"),{legacyControlId:"btnShowTraining"})),this.addCommandToMaps(Object.assign(new St.a("VersionHistory","3681556347"),{legacyControlId:"jbtnVersion"})),this.addCommandToMaps(Object.assign(new St.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"})),this.addCommandToMaps(Object.assign(new St.a("Zoom","1738002952"),{legacyControlId:"btnViewZoomDialog"})),this.addCommandToMaps(Object.assign(new St.a("ToggleRibbonUXDialog","1342108365"),{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"})),this.addCommandToMaps(new St.a("CommitNewDocumentTitle","1808554760")),this.addCommandToMaps(new St.a("RibbonModeToggledToMLR","536345575")),this.addCommandToMaps(new St.a("RibbonModeToggledToSLR","4031133701")),this.addCommandToMaps(new St.a("Workflow","2988588587")),this.addCommandToMaps(Object.assign(new St.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new St.a("GetHelpFromTellMe","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(Object.assign(new St.a("GetHelpFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(Object.assign(new St.a("GetHelpFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(Object.assign(new St.a("GetHelpWithDescriptionFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(Object.assign(new St.a("GetHelpWithDescriptionFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(new St.a("AnswerForSearch","1914896509")),this.addCommandToMaps(new St.a("AnswerForSearchSingleLine","1914896509")),this.addCommandToMaps(new St.a("ReuseFileQuickActionForSearch","1914896509")),this.addCommandToMaps(new St.a("PeopleSuggestion1","2133437452")),this.addCommandToMaps(new St.a("PeopleSuggestion2","2133437453")),this.addCommandToMaps(new St.a("PeopleSuggestion3","2133437454")),this.addCommandToMaps(new St.a("FileSuggestion1","2260671807")),this.addCommandToMaps(new St.a("FileSuggestion2","2260671810")),this.addCommandToMaps(new St.a("FileSuggestion3","2260671809")),o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.shouldFindInDocWithMatchesOpenSerplet?(this.addCommandToMaps(new St.a("FindWithMatchesParameterized","1914896509")),this.addCommandToMaps(new St.a("FindParameterized","1914896509"))):(this.addCommandToMaps(new St.a("FindWithMatchesParameterized","1540292897")),this.addCommandToMaps(new St.a("FindParameterized","1540292897"))),this.addCommandToMaps(new St.a("SmartLookupFromTellMe","1914896509")),this.addCommandToMaps(new St.a("SmartLookupFromTellMeZeroTerm","3359903192")),!o.AFrameworkApplication.insightsIsEnabled||o.AFrameworkApplication.smartLookupIsEnabled||o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new St.a("SmartLookupFromTellMe","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new St.a("AnswerForSearch","3317204163")),this.addCommandToMaps(new St.a("AnswerForSearchSingleLine","3317204163"))),this.addCommandToMaps(Object.assign(new St.a("SynonymsParameterized","2114287254"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new St.a("TellMeLogMenuClose","4266170064")),this.addCommandToMaps(new St.a("TellMeLogMenuOpen","2480888384")),this.addCommandToMaps(new St.a("TellMeMenuItemExecuted","878547493")),this.addCommandToMaps(new St.a("TellMeSearchResultChange","2652476189")),this.addCommandToMaps(new St.a("TellMeSuggestion_1","1404166600")),this.addCommandToMaps(new St.a("TellMeSuggestion_2","1404166600")),this.addCommandToMaps(new St.a("TellMeSuggestion_3","1404166600")),this.addCommandToMaps(new St.a("TellMeSuggestion_4","1404166600")),this.addCommandToMaps(new St.a("TellMeSuggestion_5","1404166600")),this.addCommandToMaps(new St.a("TryOfficeUpsell","215809929")),this.addCommandToMaps(Object.assign(new St.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"})),this.addCommandToMaps(Object.assign(new St.a("DiagnosticsSection","336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"})),this.addCommandToMaps(Object.assign(new St.a("FileAboutPage","336231556"),{legacyControlId:"faAbout"})),this.addCommandToMaps(Object.assign(new St.a("FileHelpPage","336231556"),{legacyControlId:"faHelp"})),this.addCommandToMaps(Object.assign(new St.a("FileHomePage","2074131365"),{legacyControlId:"faHome"})),this.addCommandToMaps(Object.assign(new St.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"})),this.addCommandToMaps(Object.assign(new St.a("FileNewPage","2074131365"),{legacyControlId:"faNew"})),this.addCommandToMaps(Object.assign(new St.a("FileOpenPage","2799130311"),{legacyControlId:"faOpen"})),this.addCommandToMaps(Object.assign(new St.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"})),this.addCommandToMaps(Object.assign(new St.a("FileSaveAsPage","336231556"),{legacyControlId:"faSaveAs"})),this.addCommandToMaps(Object.assign(new St.a("FileSharePage","336231556"),{legacyControlId:"faShare"})),this.addCommandToMaps(Object.assign(new St.a("FileTransformPage","336231556"),{legacyControlId:"faTransform"})),this.addCommandToMaps(new St.a("NewDocument","1056925771")),this.addCommandToMaps(new St.a("OpenUrlInNewTab","1959943459")),this.addCommandToMaps(new St.a("OpenDocumentUrl","2155708348")),this.addCommandToMaps(Object.assign(new St.a("ReplyWithChanges","1197060601"),{legacyControlId:"jbtnShareRWC"})),this.addCommandToMaps(Object.assign(new St.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"})),this.addCommandToMaps(Object.assign(new St.a("ThirdPartyNotices","2220417879"),{legacyControlId:"jbtnThirdPartyNotices"})),this.addCommandToMaps(Object.assign(new St.a("TrustCenter","2583751502"),{legacyControlId:"jbtnTrustCenter"})),this.addCommandToMaps(Object.assign(new St.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"})),this.addCommandToMaps(Object.assign(new St.a("TryMacOfficeForWordEditor","3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"})),this.addCommandToMaps(Object.assign(new St.a("PreviousVersions","466976539"),{legacyControlId:"btnjVersionHistory"})),this.addCommandToMaps(Object.assign(new St.a("FileVersionHistory","466976539"),{legacyControlId:"btnjVersionHistory"})),this.addCommandToMaps(Object.assign(new St.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"})),this.addCommandToMaps(Object.assign(new St.a("HostConversation","710925581"),{legacyControlId:"HostConversation"})),this.addCommandToMaps(Object.assign(new St.a("HostClose","3033402446"),{legacyControlId:"HostClose"})),this.addCommandToMaps(Object.assign(new St.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"})),this.addCommandToMaps(Object.assign(new St.a("HostOpenInBrowser","2596942163"),{legacyControlId:"HostOpenInBrowser"})),this.addCommandToMaps(Object.assign(new St.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"})),this.addCommandToMaps(Object.assign(new St.a("Sensitivity","941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new Ct.a("1145315516",!0)})),this.addCommandToMaps(new St.a("FreemiumUpsellEligible","1274543852")),this.addCommandToMaps(new St.a("FreemiumUpsellDialogShowUI","4180531998")),this.addCommandToMaps(new St.a("ReportFreemiumUpsellEligibleDisplayed","2539564555")),this.addCommandToMaps(new St.a("RequestFontInfo","3169500754")),this.addCommandToMaps(new St.a("PinOrUnpinFont","1500655301"))},e}();Object(i.a)(It,"ReactCommandDefinitionMapping",null,[259]);var wt=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).addCommandDefinitionMapping$1(),t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.addCommandDefinitionMapping$1=function(){this.addReactToolbarCommandDefinitionMapping(),this.addReactStatusBarCommandDefinitionMapping()},r.addReactToolbarCommandDefinitionMapping=function(){this.addCommandToMaps(Object.assign(new St.a("ToggleAccessibilityViewMode","2680748364"),{queryCommandId:"310212246",legacyControlId:"jbtnToggleViewMode"})),this.addCommandToMaps(Object.assign(new St.a("LaunchImmersiveReaderEdu","1925081555"),{legacyControlId:"btnLaunchImmersiveViewEdu"})),this.addCommandToMaps(Object.assign(new St.a("OpenInClientOnDock","3588168074"),{legacyControlId:"btnEditInClientOnDock"})),this.addCommandToMaps(Object.assign(new St.a("EditDocumentFlyoutAnchor","798637440"),{legacyControlId:"flyoutWordViewerEdit"})),this.addCommandToMaps(Object.assign(new St.a("EditOnWebInMenu","329275380"),{legacyControlId:"btnFlyoutEditOnWeb"})),this.addCommandToMaps(Object.assign(new St.a("ConvertToEditOnWebInMenu","940168130"),{legacyControlId:"btnFlyoutConvertToEditOnWeb"})),this.addCommandToMaps(Object.assign(new St.a("CopyAndEditInMenu","1750478296"),{legacyControlId:"btnFlyoutCopyAndEdit"})),this.addCommandToMaps(Object.assign(new St.a("EditInDesktopClientInMenu","3588168074"),{legacyControlId:"btnEditInClient"})),this.addCommandToMaps(Object.assign(new St.a("ShowPdfConvertAndEditDialog","3402718245"),{legacyControlId:"btnPdfConvertAndEdit"})),this.addCommandToMaps(Object.assign(new St.a("ShowPdfCopyAndEditDialog","4205256019"),{legacyControlId:"btnPdfCopyAndEdit"})),this.addCommandToMaps(Object.assign(new St.a("OpenInClientViewingNonPdf","3588168074"),{legacyControlId:"btnOpenInClient"})),this.addCommandToMaps(Object.assign(new St.a("InteractiveViewOnWeb","329275380"),{legacyControlId:"btnInteractiveViewOnWeb"})),this.addCommandToMaps(Object.assign(new St.a("EditOnWeb","329275380"),{legacyControlId:"btnEditOnWeb"})),this.addCommandToMaps(Object.assign(new St.a("ConvertToEditOnWeb","940168130"),{legacyControlId:"btnConvertToEditOnWeb"})),this.addCommandToMaps(Object.assign(new St.a("CopyAndEdit","1750478296"),{legacyControlId:"btnCopyAndEdit"})),this.addCommandToMaps(Object.assign(new St.a("SaveAndEdit","2866603464"),{legacyControlId:"btnSaveAndEdit"})),this.addCommandToMaps(Object.assign(new St.a("TranslateBackToOriginal","573791575"),{legacyControlId:"jbtnTranslateDocumentBack"})),this.addCommandToMaps(Object.assign(new St.a("DownloadADocumentCopy","3555692408"),{legacyControlId:"btnDownloadWithWord"})),this.addCommandToMaps(Object.assign(new St.a("SaveToCloudStorage","617689800"),{legacyControlId:"btnSaveToCloudStorage"})),this.addCommandToMaps(Object.assign(new St.a("PrintDocumentDirect","3321901940"),{legacyControlId:"PrintUnified"})),this.addCommandToMaps(Object.assign(new St.a("CloseViewer","3033402446"),{legacyControlId:"btnjClose"})),this.addCommandToMaps(Object.assign(new St.a("HostConversation","710925581"),{legacyControlId:"HostConversation"})),this.addCommandToMaps(Object.assign(new St.a("HostOpenDocumentInBrowser","2596942163"),{legacyControlId:"HostOpenInBrowser"})),this.addCommandToMaps(Object.assign(new St.a("FileSharing","981334692"),{legacyControlId:"btnFileSharing"})),this.addCommandToMaps(Object.assign(new St.a("MoreViewerOptionsFlyoutAnchor","336231556"),{legacyControlId:"MoreViewerOptionsFlyoutAnchor"})),this.addCommandToMaps(Object.assign(new St.a("ToggleCommentPane","2281051331"),{queryCommandId:"847427893",legacyControlId:"btnOpenCommentPane"})),this.addCommandToMaps(Object.assign(new St.a("ToggleSearchPane","976411380"),{queryCommandId:"1289223352",legacyControlId:"btnOpenSearchPane"})),this.addCommandToMaps(Object.assign(new St.a("LaunchImmersiveReaderNonEdu","1925081555"),{legacyControlId:"btnLaunchImmersiveViewNonEdu"})),this.addCommandToMaps(Object.assign(new St.a("TranslateDocument","2612243365"),{legacyControlId:"jbtnTranslateDocument"})),this.addCommandToMaps(Object.assign(new St.a("ShowFileVersion","3681556347"),{legacyControlId:"jbtnFileVersion"})),this.addCommandToMaps(Object.assign(new St.a("OverflowDownloadWithWord","3555692408"),{legacyControlId:"overflowbtnDownloadWithWord"})),this.addCommandToMaps(Object.assign(new St.a("DownloadATranslatedCopy","1045098306"),{legacyControlId:"jbtnDownloadATranslatedCopy"})),this.addCommandToMaps(Object.assign(new St.a("DownloadAPdfCopy","3555692408"),{legacyControlId:"btnDownloadPdf"})),this.addCommandToMaps(Object.assign(new St.a("DownloadWordDocAsPdf","1485307652"),{legacyControlId:"jbtnDownloadAsPdf"})),this.addCommandToMaps(Object.assign(new St.a("ShowFileEmbedInfo","1725824390"),{legacyControlId:"jbtnFileEmbed"})),this.addCommandToMaps(Object.assign(new St.a("ViewerHelp","1454393937"),{legacyControlId:"jbtnHelp"})),this.addCommandToMaps(Object.assign(new St.a("ShowAccessibilityHelpDialog","3276527670"),{legacyControlId:"jbtnAccessibilityHelp"})),this.addCommandToMaps(Object.assign(new St.a("GiveViewerFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"})),this.addCommandToMaps(Object.assign(new St.a("TryOfficeFromWordViewer","2578423837"),{legacyControlId:"btnjTryOffice"})),this.addCommandToMaps(Object.assign(new St.a("TryMacOfficeFromWordViewer","201621520"),{legacyControlId:"btnjTryMacOffice"})),this.addCommandToMaps(Object.assign(new St.a("OpenTermsOfUseLink","2349775795"),{legacyControlId:"jbtnTermsOfUse"})),this.addCommandToMaps(Object.assign(new St.a("PrivacyLink","1208554566"),{legacyControlId:"jbtnPrivacy"})),this.addCommandToMaps(Object.assign(new St.a("PrintAccessibilityDocument","1480533506"),{legacyControlId:"jbtnAccessibility"})),this.addCommandToMaps(Object.assign(new St.a("DownloadAccessibilityPdf","3555692408"),{legacyControlId:"jbtnAccessibilityPdf"})),this.addCommandToMaps(Object.assign(new St.a("SyncToPresenter","3349150556"),{legacyControlId:"btnSyncToPresenter"})),this.addCommandToMaps(Object.assign(new St.a("OpenSharedNotes","3870085532"),{legacyControlId:"btnOpenSharedNotes"})),this.addCommandToMaps(Object.assign(new St.a("ShowTrustCenter","2583751502"),{legacyControlId:"jbtnTrustCenter"})),this.addCommandToMaps(Object.assign(new St.a("SwitchToUnifiedReadMode","1254572192"),{legacyControlId:"jbtnSwitchToUnifiedReadMode"}))},r.addReactStatusBarCommandDefinitionMapping=function(){this.addCommandToMaps(Object.assign(new St.a("GetQueryCurrentPageLabel","798637440"),{queryCommandId:"1122736542",legacyControlId:"PageInfoLabel"})),this.addCommandToMaps(Object.assign(new St.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830",legacyControlId:"ClassificationLabel"})),this.addCommandToMaps(Object.assign(new St.a("GetQueryEnvironmentName","798637440"),{queryCommandId:"3887408216",legacyControlId:"EnvironmentLabel"})),this.addCommandToMaps(Object.assign(new St.a("GetQueryPresenterPageLabel","798637440"),{queryCommandId:"936755515",legacyControlId:"PresenterPageLabel"})),this.addCommandToMaps(Object.assign(new St.a("ShowZoomDialog","1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"})),this.addCommandToMaps(Object.assign(new St.a("GiveFeedback","802602464"),{legacyControlId:"GiveFeedback"}))},i}(It);Object(i.a)(wt,"WordViewerReactCommandDefinitionMapping",It,[]);var Tt=n(149),Et=n(289),kt=n(353),Mt=n(168),Pt=n(229);function Ft(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Dt=function(){function e(e,t,n,i,r){this._getFirstPage=null,this._getLastPage=null,this._searchActive=null,this._appBase=null,this._appBaseClientHeight=0,this._isAppBaseHeightDirty=!0,this._theDisplayManager=null,this._theSelectionManager=null,this._theSearchManager=null,this._thePrintManager=null,this._theCommentManager=null,this._scrollControl=null,this._navigationControl=null,this._zoomControl=null,this._heightAboveAppBase=0,this._heightBelowAppBase=0,this._initialized=!1,this._theFocusManager=e,this._lazyDisplayManagerFactory=t,this._lazyZoomControl=n,this._lazyNavigationControl=i,this._lazyScrollControl=r}var t,i,a,s=e.prototype;return s.init=function(e){var t=n(14).App;t.get_activeAppFrame().add_onResize(Object(r.d)(this,this.resizeAppBase,"resizeAppBase")),this._appBase=document.createElement("div"),this._appBase.id="WACAppBase";var i="WACAppBase";o.AFrameworkApplication.protectFile&&(i+=" Protected"),this._appBase.className=i,e.appendChild(this._appBase),this._thePrintManager=Et.a.getPrintManagerInstance(),this.theScrollControl.init();var a=$.FocusManager.instance().getScope(W.AFrame.documentFocusID);a.bindAction(J.KeyInputManager.hashKey(Ie.a.VK_F10,4),Me.a.showContextMenuFromKey),a.bindAction(J.KeyInputManager.hashKey(Ie.a.vK_ContextMenu,0),Me.a.showContextMenuFromKey),this.theZoomControl.initializeActor(),this.theNavigationControl.init(),Pt.a(),t.instance.isAccessiblePdfMode?(this._theDisplayManager=this._lazyDisplayManagerFactory.value.create(1,this._appBase),t.hideFirstPageImage()):(this._appBase.appendChild(this.theScrollControl.container),this._theDisplayManager=this._lazyDisplayManagerFactory.value.create(0,this.theScrollControl.scroller)),t.get_activeAppFrame().ribbonPanel&&(this._heightAboveAppBase=t.get_activeAppFrame().ribbonPanel.clientHeight),t.get_activeAppFrame().statusBarUser&&(this._heightBelowAppBase=Mt.a.isReactStatusBarEnabled?kt.a.reactStatusBarHeight:W.AFrame.statusBarHeight),this._initialized=!0},s.setCommentManagerDisposable=function(e){this._theCommentManager=e},s.setSelectionManagerDisposable=function(e,t,n){this._theSelectionManager=e,this._getFirstPage=t,this._getLastPage=n},s.setSearchManagerDisposable=function(e,t){this._theSearchManager=e,this._searchActive=t},s.getCurrentPage=function(){return this._theDisplayManager.currentPage},s.getHeight=function(){return this._isAppBaseHeightDirty&&(this._appBaseClientHeight=this._appBase.clientHeight,this._isAppBaseHeightDirty=!1),this._appBaseClientHeight},s.getFirstCachedPage=function(){return this._theDisplayManager?this._theDisplayManager.startPage:0},s.getFirstSelectedPage=function(){return this._theDisplayManager&&this._getFirstPage?this._getFirstPage():0},s.getLastCachedPage=function(){return this._theDisplayManager?this._theDisplayManager.endPage:0},s.getLastSelectedPage=function(){return this._theDisplayManager&&this._getLastPage?this._getLastPage():0},s.pageCacheChanged=function(e,t){o.AFrameworkApplication.theActionManager.processActionWithData(Me.a.pageCacheChanged,2,[e,t])},s.searchActive=function(){return!!this._searchActive&&this._searchActive()},s.dispose=function(){n(14).App.get_activeAppFrame().remove_onResize(Object(r.d)(this,this.resizeAppBase,"resizeAppBase")),this._theSearchManager&&(this._theSearchManager.dispose(),this._theSearchManager=null),this._theCommentManager&&(this._theCommentManager.dispose(),this._theCommentManager=null),this._navigationControl&&(this._navigationControl.dispose(),this._navigationControl=null),this._theDisplayManager&&(this._theDisplayManager.dispose(),this._theDisplayManager=null),this._thePrintManager&&(this._thePrintManager.dispose(),this._thePrintManager=null),this._zoomControl&&(this._zoomControl.dispose(),this._zoomControl=null),this._theSelectionManager&&(this._theSelectionManager.dispose(),this._theSelectionManager=null),this._scrollControl&&(this._scrollControl.dispose(),this._scrollControl=null),this._appBase=null,this._getFirstPage=null,this._getLastPage=null,this._searchActive=null},s.onResize=function(){this.resizeAppBase()},s.resizeAppBase=function(){var e=n(14).App,t=this._heightAboveAppBase,i=n(14).App.get_activeAppFrame().businessBar;i&&i.visible&&(t+=i.htmlElement.offsetHeight),this._appBase?(this._appBase.style.width=e.get_activeAppFrame().getDOMElement().clientWidth+"px",this._appBase.style.top=t+"px",this._appBase.style.bottom=this._heightBelowAppBase+"px"):Se.a(4331590,301,!1,"We didn't expect the _appBase to be null");var r=document.getElementById("FirstPageContainer");if(r){var a=Tt.a.calculateToolbarWithTopBarHeight(o.AFrameworkApplication.hideHeader,!1);r.style.top=a+"px"}this._isAppBaseHeightDirty=!0},t=e,(i=[{key:"appBaseDom",get:function(){return this._appBase}},{key:"heightAboveAppBase",get:function(){return this._heightAboveAppBase}},{key:"theSearchManager",get:function(){return this._theSearchManager}},{key:"theDisplayManager",get:function(){return this._theDisplayManager}},{key:"theSelectionManager",get:function(){return this._theSelectionManager}},{key:"theZoomControl",get:function(){return this._zoomControl||(this._zoomControl=this._lazyZoomControl.value)}},{key:"theNavigationControl",get:function(){return this._navigationControl||(this._navigationControl=this._lazyNavigationControl.value)}},{key:"theScrollControl",get:function(){return this._scrollControl||(this._scrollControl=this._lazyScrollControl.value)}},{key:"initialized",get:function(){return this._initialized}}])&&Ft(t.prototype,i),a&&Ft(t,a),e}();Object(i.a)(Dt,"Workspace",null,[4]);var Ot=function(){function e(){}return e.prototype.configure=function(e){e.register(242,"WordViewer.IWordViewerPostMessenger").singleInstance().usingFactory((function(){return new bt(o.AFrameworkApplication.theActionManager,e.resolve("Postmessage.IHostPostmessenger"),o.AFrameworkApplication.appSettingsManager,ne.a.instance)})),e.register(wt,"WordViewer.WordViewerReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").singleInstance().usingFactory((function(){return new wt})),e.register(nt,"WordViewer.Controls.ZoomControl").as("WordViewer.Controls.IZoomControl").as("Common.IZoomManager").singleInstance().usingFactory((function(){var t=n(14).App;return new nt(t.instance,o.AFrameworkApplication.appSettingsManager,o.AFrameworkApplication.theActionManager,e.resolveLazy("WordViewer.IWordViewerPostMessenger"),Ne.a.instance)})),e.register(243,"WordViewer.DisplayManager.IDisplayManagerFactory").singleInstance().usingFactory((function(){var t=n(14).App;return new vt(o.AFrameworkApplication.appSettingsManager,o.AFrameworkApplication.theActionManager,$.FocusManager.instance(),e.resolve("WordViewer.IWordViewerPostMessenger"),Ne.a.instance,e.resolveLazy("WordViewer.Controls.IZoomControl"),e.resolveLazy("WordViewer.Controls.IScrollControl"),t.instance.theConfig,t.instance.theDocument)})),e.register(244,"WordViewer.Controls.IScrollControl").singleInstance().usingFactory((function(){var t=n(14).App;return new je(o.AFrameworkApplication.appSettingsManager,o.AFrameworkApplication.theActionManager,$.FocusManager.instance(),Ne.a.instance,e.resolveLazy("WordViewer.Controls.IZoomControl"),t.instance.theConfig)})),e.register(245,"WordViewer.Controls.INavigationControl").singleInstance().usingFactory((function(){return new Pe(o.AFrameworkApplication.theActionManager,$.FocusManager.instance(),Ne.a.instance,e.resolveLazy("WordViewer.Controls.IScrollControl"))})),e.register(Dt,"WordViewer.Workspace").singleInstance().usingFactory((function(){return new Dt($.FocusManager.instance(),e.resolveLazy("WordViewer.DisplayManager.IDisplayManagerFactory"),e.resolveLazy("WordViewer.Controls.IZoomControl"),e.resolveLazy("WordViewer.Controls.INavigationControl"),e.resolveLazy("WordViewer.Controls.IScrollControl"))})),e.register(30,"Common.IAppSettingsManager").singleInstance().usingFactory((function(){return o.AFrameworkApplication.appSettingsManager})),e.register(93,"Common.ISessionStatus").singleInstance().usingFactory((function(){return Ae.SessionStatusManager.instance}))},e}();Object(i.a)(Ot,"AppComponentConfiguration",null,[15]);var Rt=n(238),xt=n(189);var Ut=function(e){var t,n;function i(t){return e.call(this,t)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.getBaseDocQuerySignature=function(){return this.appSettings.BaseDocQueryParam},i}(xt.a);Object(i.a)(Ut,"WordViewerAppSettingsManager",xt.a,[]);var Bt=function(){this.pageSetSize=4,this.pageSetXmlSize=10,this.marginPixels=10,this.pageGapPixels=20,this.pagesToCacheAfter=1,this.pagesToCacheBefore=1,this.searchPaneWidth=270,this.commentPaneWidth=300,this.commentPaneHorizontalBorderWidth=0,this.commentPaneVerticalBorderWidth=0,this.maximumZoom=4,this.minimumZoom=.1,this.dpiAspectRatio=4/3,this.scrollDelay=1,this.scrollOffset=20,this.scrollZone=50,this.scrollMagnitudePerSecond=1e3,this.autoScrollAmount=15,this.selectionTolerance=5,this.keyboardArrowScrollAmount=50,this.searchLookAheadInPagesets=1,this.highlightTaskDelay=25,this.searchTaskDelay=5,this.searchPageIncrement=100,this.searchResultVerticalMultiplier=1.5,this.searchResultHorizontalBuffer=25,this.minCharactersToSearchBeforePausing=200,this.maxParagraphsToSearchBeforePausing=10,this.maxRetryAttempts=22,this.retryIntervalInMSecs=1e3,this.retryIntervalLongInMSecs=2e4,this.retryTimeoutInMSecs=18e4,this.defaultImageDpi=96,this.silverlightURL="https://r.office.microsoft.com/r/rlidWebOfficeSilverlight?clid={0}",this.divLengthLimitInPixels=4e6};Object(i.a)(Bt,"Config",null,[]);var Lt=n(138),Nt=n(111),Ht=n(37),Wt=n(352);function jt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Vt=function(){function e(){}var t,n,i;return t=e,(n=[{key:"contextId",get:function(){return $e.a.frame}},{key:"nextContext",get:function(){return null}},{key:"isContextSet",get:function(){return!1}},{key:"isGraphNodeContext",get:function(){return!1}}])&&jt(t.prototype,n),i&&jt(t,i),e}();function Kt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(Vt,"FrameContext",null,[246]);var zt=function(){function e(){this._frameContext=new Vt}var t,n,i;return t=e,(n=[{key:"contextId",get:function(){return Ee.a.application}},{key:"nextContext",get:function(){return this._frameContext}},{key:"isContextSet",get:function(){return!1}},{key:"isGraphNodeContext",get:function(){return!1}}])&&Kt(t.prototype,n),i&&Kt(t,i),e}();function qt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(zt,"WordViewerContext",null,[246]);var Gt=function(){function e(e,t,n,i,r){this._pageHeight=e,this._pageWidth=t,this._startPage=n,this._pageCount=i,this._top=r}var t,n,i;return t=e,(n=[{key:"pageHeight",get:function(){return this._pageHeight},set:function(e){this._pageHeight=e}},{key:"pageWidth",get:function(){return this._pageWidth},set:function(e){this._pageWidth=e}},{key:"startPage",get:function(){return this._startPage},set:function(e){this._startPage=e}},{key:"pageCount",get:function(){return this._pageCount},set:function(e){this._pageCount=e}},{key:"top",get:function(){return this._top},set:function(e){this._top=e}}])&&qt(t.prototype,n),i&&qt(t,i),e}();function Qt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(Gt,"ASection",null,[]);var Zt=function(){function e(e){this._hasComments=!1,this._isNormalized=!1,this._isProtectedPdf=!1,this._baseDocQuerySignature=e,this._pageCount=0,this._totalPageHeight=0,this._minPageHeight=Number.MAX_VALUE,this._maxPageWidth=Number.MIN_VALUE,this._sections=[]}var t,i,r,a=e.prototype;return a.getSection=function(e){return e>=1&&e<this._sections.length?this._sections[e]:null},a.init=function(e){var t=n(14).App;if(e){var i=e.selectSingleNode("@dxpInch"),r=e.selectSingleNode("@dypInch"),a=e.selectSingleNode("@pages"),s=parseInt(i.text),l=parseInt(r.text),c=(parseInt(a.text),e.selectSingleNode("@hasComments")),u=e.selectSingleNode("@hasIds"),d=e.selectSingleNode("@isProtectedPdf");if(this._hasComments=!c||Boolean.parse(c.text),this._isNormalized=!!u&&Boolean.parse(u.text),this._isProtectedPdf=!!d&&Boolean.parse(d.text),!t.instance.isPdfMode){var p=new Array(4),h=new Array(4);try{h[0]=e.selectSingleNode("@docHashDw0"),h[1]=e.selectSingleNode("@docHashDw1"),h[2]=e.selectSingleNode("@docHashDw2"),h[3]=e.selectSingleNode("@docHashDw3"),p[0]=parseInt(h[0].text,16),p[1]=parseInt(h[1].text,16),p[2]=parseInt(h[2].text,16),p[3]=parseInt(h[3].text,16)}catch(e){w.ULS.sendTraceTag(5007365,100,15,"Error when parsing dochashDw: {0}",e)}o.AFrameworkApplication.theWsaClient.registerPersistentDocId(p)}var m,g,f,v,_,y,b,S,C,A,I=e.selectNodes("pageset");0;for(var T=0;T<I.length;T++){if(g=(m=I[T]).selectSingleNode("@width"),f=m.selectSingleNode("@height"),v=m.selectSingleNode("@count"),_=parseInt(g.text),y=parseInt(f.text),b=parseInt(v.text),C=_/s*96,A=y/l*96,T){var E=this._sections[T];S=E.top+E.pageHeight*E.pageCount}else S=0;this._sections[T+1]=new Gt(A,C,this._pageCount+1,b,S),A<this._minPageHeight&&(this._minPageHeight=A),C>this._maxPageWidth&&(this._maxPageWidth=C),this._totalPageHeight+=A*b,this._pageCount+=b}}},t=e,(i=[{key:"baseDocQuerySignature",get:function(){return this._baseDocQuerySignature}},{key:"pageCount",get:function(){return this._pageCount}},{key:"sectionCount",get:function(){return this._sections.length-1}},{key:"totalPageHeight",get:function(){return this._totalPageHeight}},{key:"maxPageWidth",get:function(){return this._maxPageWidth}},{key:"minPageHeight",get:function(){return this._minPageHeight}},{key:"hasComments",get:function(){return this._hasComments}},{key:"isNormalized",get:function(){return this._isNormalized}},{key:"isProtectedPdf",get:function(){return this._isProtectedPdf}}])&&Qt(t.prototype,i),r&&Qt(t,r),e}();Object(i.a)(Zt,"ADocument",null,[]);var $t=n(354),Xt=function(){function e(){this._pageInfoList=[],this._retryRequest=null,this._urlRequests={},this._pagesToRequest=[],this._firstSearchPageSet=Number.NaN,this._lastSearchPageSet=Number.NaN,this.buildCache()}var t=e.prototype;return t.addToCache=function(e,t){for(var n=at.a.getPageSetXmlFromPage(e),i=at.a.getPageSetXmlFromPage(t),a=n;a<=i;a++)if(!this._pageInfoList[a-1]){0,Array.add(this._pagesToRequest,a);var s=new ae.a(2,1,1,Object(r.d)(this,this.requestPage,"requestPage"));0,o.AFrameworkApplication.theTaskManager.addTask(s)}},t.requestPage=function(e){this._pagesToRequest.length>0&&(this.requestSelectionXmlForPageSet(re.a.urlForNamedObject(at.a.getPageSetXmlName(this._pagesToRequest[0]))),Array.removeAt(this._pagesToRequest,0))},t.removeFromCache=function(t,n){for(var i=at.a.getPageSetXmlFromPage(t),r=at.a.getPageSetXmlFromPage(n),a=i;a<=r;a++)e.isPageSetInViewingCache(a)||e.isPageSetInSelectionCache(a)||this.isPageSetInSearchCache(a)||(this._pageInfoList[a-1]=null)},t.isPageSetInSearchCache=function(e){var t=n(14).App,i=e>=this._firstSearchPageSet&&e<=this._lastSearchPageSet;return t.get_activeAppFrame().workspace.searchActive()&&i},t.removeSearchCache=function(){if(!isNaN(this._firstSearchPageSet)&&!isNaN(this._lastSearchPageSet)){var e=n(14).App.instance.theConfig.pageSetSize,t=this._firstSearchPageSet,i=this._lastSearchPageSet;this._firstSearchPageSet=Number.NaN,this._lastSearchPageSet=Number.NaN,this.removeFromCache(t*e,i*e)}},t.updateSearchCache=function(e){var t=n(14).App;if(isNaN(this._firstSearchPageSet)||isNaN(this._lastSearchPageSet)){0;var i=this._pageInfoList.length;return this._firstSearchPageSet=1,this._lastSearchPageSet=Math.min(i,this._firstSearchPageSet+t.instance.theConfig.searchLookAheadInPagesets),void this.addToCache(1,this._lastSearchPageSet*t.instance.theConfig.pageSetXmlSize)}var r=n(14).App.instance.theConfig.pageSetXmlSize;if(1===r||e%r==1){at.a.getPageSetXmlFromPage(e);0;var a=this._pageInfoList.length;this._lastSearchPageSet=Math.min(a,this._lastSearchPageSet+1),this.addToCache(this._lastSearchPageSet*r,this._lastSearchPageSet*r),this.removeFromCache(this._firstSearchPageSet*r,this._firstSearchPageSet*r),this._firstSearchPageSet++}},t.isPageCached=function(e){var t=at.a.getPageSetFromPage(e);return!!this._pageInfoList[t-1]},t.buildCache=function(){for(var e=at.a.getPageSetXmlFromPage(Ne.a.instance.pageCount),t=0;t<e;t++)Array.add(this._pageInfoList,null)},t.onItemRequestSucceeded=function(t){var i=n(14).App;this._urlRequests[t.data.request.get_url()]=!1;var r=t.data.responseXml;if(r){se.a.isValidResponseXMLDoc(r)||(r=Sys.Net.XMLDOM(t.data.responseData,!0));for(var a=r.getElementsByTagName("Page"),s=Number.NaN,l=0;l<a.length&&(s=parseInt(a[l].attributes.getNamedItem("id").nodeValue),isNaN(s)||!(s>0));l++);if(!isNaN(s)){var c=n(14).App.get_activeAppFrame().workspace,u=at.a.getPageSetXmlFromPage(s);if(o.AFrameworkApplication.collectPageStats&&(ee.PageStats.beginMeasurement("RequestSelectionXML",t.data.invokedTime),t.data.responseHeaders[O.a.correlationIdHeaderName]&&ee.PageStats.addAttribute(fe.a.correlation,t.data.responseHeaders[O.a.correlationIdHeaderName].toString()),t.data.responseHeaders[ee.PageStats.pageStatsResponseXHRHeader]&&ee.PageStats.addServerMeasurements(t.data.responseHeaders[ee.PageStats.pageStatsResponseXHRHeader].toString()),ee.PageStats.endMeasurement("RequestSelectionXML")),e.isPageSetInViewingCache(u)||e.isPageSetInSelectionCache(u)||this.isPageSetInSearchCache(u)||i.initialParagraphId){if(this._pageInfoList[u-1])return void 0;0,this._pageInfoList[u-1]=r}var d=at.a.getStartPageFromPageSetXml(u),p=at.a.getEndPageFromPageSetXml(u);if(o.AFrameworkApplication.theActionManager.processActionWithData(Me.a.xmlPageDownloaded,2,new $t.a(d,p)),o.AFrameworkApplication.theActionManager.processActionWithData(Me.a.xmlPageDownloaded2,2,new $t.a(d,p)),i.initialParagraphId&&o.AFrameworkApplication.theActionManager.processActionWithData(Me.a.xmlPageDownloaded3,2,new $t.a(d,p)),i.instance.copyingEnabled&&e.isPageSetInSelectionCache(u)){for(var h=!0,m=at.a.getPageSetXmlFromPage(c.getFirstSelectedPage()),g=at.a.getPageSetXmlFromPage(c.getLastSelectedPage()),f=m-1;f<g;f++)if(!this._pageInfoList[f]){h=!1;break}h&&o.AFrameworkApplication.theActionManager.processAction(Me.a.buildClipboard,2)}}}},t.onItemRequestFail=function(e){o.AFrameworkApplication.collectPageStats&&(ee.PageStats.beginMeasurement("RequestSelectionXML",e.data.invokedTime),e.data.responseHeaders[O.a.correlationIdHeaderName]&&ee.PageStats.addAttribute(fe.a.correlation,e.data.responseHeaders[O.a.correlationIdHeaderName].toString()),ee.PageStats.endMeasurement("RequestSelectionXML")),this._urlRequests[e.data.request.get_url()]=!1,this._retryRequest||(this._retryRequest=new mt.a(Object(r.d)(this,this.onRetrySuccessful,"onRetrySuccessful"),e.data.request.get_url()),this._retryRequest.send())},t.onRetrySuccessful=function(e){this._retryRequest=null,this.requestSelectionXmlForPageSet(e.name)},t.getPage=function(e){var t=this.getTextDataForPage(e);return null===t?null:t.selectSingleNode(String.format("/Pages/Page[@id='{0}']",e))},t.getXmlForPage=function(t){var n=at.a.getPageSetXmlFromPage(t)-1;if(this._pageInfoList[n]){var i=e.buildXPathForPageXml(t);return this._pageInfoList[n].selectSingleNode(i)}return null},t.requestSelectionXmlForPageSet=function(e){this._urlRequests[e]||(this._urlRequests[e]=!0,o.AFrameworkApplication.theClientRequestManager.addRequest(e,1,null,null,!0,2,Object(r.d)(this,this.onItemRequestSucceeded,"onItemRequestSucceeded"),Object(r.d)(this,this.onItemRequestFail,"onItemRequestFail"),null))},t.getTextDataForPage=function(e){var t=at.a.getPageSetXmlFromPage(e);return t<=0||t>this._pageInfoList.length||!this._pageInfoList[t-1]?null:this._pageInfoList[t-1]},t.getCopyableHtmlElementsForQuery=function(e,t,n,i){var r=this.getTextDataForPage(t);if(!r)return null;var a=r.selectNodes(e),o=[],s=null;if(1===a.length&&-1!==n&&-1!==i){if(n===i)return o;if(i<n){var l=n;n=i,i=l}}for(var c=0;c<a.length;c++){var u=a[c].parentNode.firstChild,d=a[c].selectSingleNode("ancestor::Table"),p=a[c].selectSingleNode("ancestor::List"),h=a[c].selectSingleNode("ancestor::TextBox");if(u!==a[c]||d||p)if(d){if(d.selectSingleNode("descendant::T")===a[c])s=document.createElement("p"),Array.add(o,s);else{var m=a[c].selectSingleNode("ancestor::TR"),g=a[c].selectSingleNode("ancestor::TD | ancestor::TH");m!==d.firstChild&&g===m.firstChild&&(s=document.createElement("p"),Array.add(o,s))}}else p&&a[c]===u&&(s=document.createElement("p"),Array.add(o,s));else s=document.createElement("p"),Array.add(o,s);if(a[c].childNodes[0]){s||(s=document.createElement("p"),Array.add(o,s));var f=a[c].childNodes[0].nodeValue;-1===n||-1===i||h||(c+1===a.length&&(f=f.substring(0,i)),c||(f=f.substring(n,f.length))),s.innerText+=f}}return o},e.isPageSetInViewingCache=function(e){var t=n(14).App.get_activeAppFrame().workspace,i=at.a.getPageSetXmlFromPage(t.getFirstCachedPage()),r=at.a.getPageSetXmlFromPage(t.getLastCachedPage());return e>=i&&e<=r},e.isPageSetInSelectionCache=function(e){var t=n(14).App.get_activeAppFrame().workspace,i=at.a.getPageSetXmlFromPage(t.getFirstSelectedPage()),r=at.a.getPageSetXmlFromPage(t.getLastSelectedPage());return e>=i&&e<=r},e.buildXPathForPageXml=function(e){return String.format("/Pages/Page[@id='{0}']",e)},e}();Object(i.a)(Xt,"PageInfoCache",null,[]);var Jt=n(254),Yt=n(51);function en(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"App",(function(){return nn}));var nn=function(e){var t,n;function i(t){var n,a;(a=e.call(this,t,!1)||this)._disposed=!1,a.nilUuidStringPng="",a._embedPreviewUrl=null,a._isSmallView=!1,a._isCoreMode=!1,a._showPrintWhenEmbedded=!1,a._showEmbed=!1,a._supportsCobalt=!1,a._supportsEditingWithLocks=!1,a._printingEnabled=!0,a._copyingEnabled=!0,a._isBroadcastMode=!1,a._translationFromEditor=!1,a._pdfMode=!1,a._accessiblePdfMode=!1,a._accessiblePdfModeInitialized=!1,a._showLegacyPrintDialogPdfMode=!1,a._userCanWriteRelative=!1,a._resourceTimingLoggerFuture=null,a._pngFormat=null,a._highDpiDocToPngBrsIsEnabled=!1,a._highDpiPdfToPngBrsIsEnabled=!1,a._zoomPopupDialogIsEnabled=!1,a._zoomControl=null,a._scrollControl=null,a._postMessenger=null,a._wordCommandsToHostControlIdsMap=((n={})[3033402446]="close",n[710925581]="conversation",n[2596942163]="ellipsisOpenInBrowser",n),a._debugPanel=null,a.isScreenReaderPresent=null,a.appEmbedPreviewUrl=null,a._userMayEnterAccessiblePdfMode=null,a._isOdt=!1,a.broadcastPostMessageOrigin=null,Boolean.parse(t.UseCachingUlsHost||"false")&&w.ULS.setUlsHost(new be(t.Application||"",!0)),a.initialize(t),window.g_wordViewerAppConstructed=!0,(new Ot).configure(ge.a.instance),o.AFrameworkApplication.loadTestFrameworkIfRequested(),a.initializeBrowserSqm(t),a._accessibleModeEnabled=Boolean.parse(t.WordViewerAccessibleModeEnabled),a._accessiblePdfModeAppSetting=t.IsAccessiblePdfMode,"true"===t.PdfMode&&(a._pdfMode=!0),"true"===t.TranslationFromEditor&&(a._translationFromEditor=!0),o.AFrameworkApplication.isEmbedded&&(a._isBroadcastMode="true"===t.BroadcastMode),a._translationLanguage=t.TranslationLanguage,a._translationLanguages=t.TranslationLanguages;var s,l=o.AFrameworkApplication.theWsaClient;if(l&&l.isUserOptedIn()&&(s=o.AFrameworkApplication.isNoChrome?19:a.isBroadcastMode?8:a.translationLanguage?10:a.isPdfMode?15:o.AFrameworkApplication.isEmbedded?14:1,l.setDw(o.AFrameworkApplication.officeApplicationModeDatapointId,s),o.AFrameworkApplication.protectFile)){for(var c=new Array(o.AFrameworkApplication.documentStreamWidth),u=0;u<o.AFrameworkApplication.documentStreamWidth;u++)c[u]=0;c[2]=256,l.addToStreamDw.apply(l,[o.AFrameworkApplication.documentStreamId].concat(c))}o.AFrameworkApplication.theClientRequestManager||(o.AFrameworkApplication.theClientRequestManager=O.a.createAnInstance(o.AFrameworkApplication.userSessionId)),o.AFrameworkApplication.theClientRequestManager.wacClusterId=t.WacCluster,o.AFrameworkApplication.theUlsHost=N.createHostAndInitUlsForApp(),o.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady||(o.AFrameworkApplication.appSettingsManager.requestPostBootAppSettings(),o.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady(Object(r.d)(tn(a),a.onFullAppSettingsReady,"onFullAppSettingsReady")),o.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsFailed(Object(r.d)(tn(a),a.onFullAppSettingsFailed,"onFullAppSettingsFailed"))),a.checkIfStringIsDownloaded(t,(function(){return WordViewerIntl.WordViewerStrings}),Ht.a.stringsFailedToLoadWordViewer),a.checkIfStringIsDownloaded(t,(function(){return CommonUIStrings}),Ht.a.stringsFailedToLoadCommonUI),"true"===t.WordViewerPdfModePrintShowsLegacyDialog&&(a._showLegacyPrintDialogPdfMode=!0),a._status=0,a.isPdfMode?(oe.a.documentType=CommonUIStrings.l_DocumentType_Pdf,oe.a.documentTypeTitleCase=CommonUIStrings.l_DocumentType_Pdf,oe.a.documentTypePlural=CommonUIStrings.l_DocumentTypePlural_Pdf,oe.a.subDocumentType=CommonUIStrings.l_SubDocumentType_Pdf):(oe.a.documentType=CommonUIStrings.l_DocumentType_W,oe.a.documentTypeTitleCase=CommonUIStrings.l_DocumentTypeTitleCase_W,oe.a.documentTypePlural=CommonUIStrings.l_DocumentTypePlural_W,oe.a.subDocumentType=CommonUIStrings.l_SubDocumentType_W),oe.a.richClientNameLong=CommonUIStrings.l_RichClientNameLong_W,oe.a.applicationNameOnly=CommonUIStrings.l_AppNameShort_W,oe.a.formatResourceStrings(CommonUIStrings),oe.a.formatResourceStrings(WordViewerIntl.WordViewerStrings),"true"===t.PerfMarkersEnabled&&ie.a.start(),a._canCreateComments=Boolean.parse(t.CanComment),a._userName=t.UserName,a._uiQueryParameter=t.UIParameter,i.webServiceBase=t.WebServiceBase,a.isCoreMode=Boolean.parse(t.IsCoreMode||"false"),o.AFrameworkApplication._extraErrorInfoFromHost=t.ExtraErrorInfo,a._wordEditorAppRootUrl=t.WordEditorAppRootUrl,a._isBinary=Boolean.parse(t.IsBinary||"false"),a.initPaths(t),o.AFrameworkApplication._unifiedHeaderOfficeOnlineLogoWidth=159,o.AFrameworkApplication.imageClusterName=Q.wordViewerImageMapName,o.AFrameworkApplication.imageClusterPath=Lt.a.ribbonImage(o.AFrameworkApplication.imageClusterName+".png"),o.AFrameworkApplication.scriptFolderPath=Lt.a.wordViewerScriptsBase,o.AFrameworkApplication.scriptBase="WordViewer.{0}";var d=t.DocumentPermissions||"";i.canEdit=d.indexOf("W")>-1,i.isReviewer=d.indexOf("R")>-1,o.AFrameworkApplication.isEmbedded&&(w.ULS.sendTraceTag(18395276,301,50,"Embedded view"),a.set_isSmallView("true"===t.SmallView),a._showPrintWhenEmbedded="true"===t.ShowPrint,a._showPrintWhenEmbedded&&o.AFrameworkApplication.theWsaClient.setBitsOr(10383,1),a._showEmbed="true"===t.ShowEmbedCode,a._showEmbed&&o.AFrameworkApplication.theWsaClient.setBitsOr(10383,2),o.AFrameworkApplication.theWsaClient.setDw(10380,window.document.documentElement.clientWidth),o.AFrameworkApplication.theWsaClient.setDw(10379,window.document.documentElement.clientHeight)),a._isBroadcastMode&&(a.broadcastPostMessageOrigin=t.BroadcastPostMessageOrigin,o.AFrameworkApplication.postMessageOrigin=a.broadcastPostMessageOrigin),a._target=document.getElementById(t.ClientId),o.AFrameworkApplication.registerFrame(new Rt.AppFrame(tn(a),a._target,t)),a.isAccessiblePdfMode&&(o.AFrameworkApplication.showSplashScreen(!0),i.hideFirstPageImage()),(o.AFrameworkApplication.isEmbedded||a.isAccessiblePdfMode)&&(i.initialPageNumber=parseInt(t.InitialPageNumber),isNaN(i.initialPageNumber)||i.initialPageNumber<1?i.initialPageNumber=1:(o.AFrameworkApplication.theWsaClient.setDw(10382,i.initialPageNumber),o.AFrameworkApplication.theWsaClient.setBitsOr(10383,4))),a.initializeDefaultErrorHandler(o.AFrameworkApplication.activeFrame.theErrorHandler,t,!0),Boolean.parse(t.ConfigError||"false")&&(at.a.showErrorDialogEx(j.a.configError,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ConfigError),at.a.propagateError(!0,"ServerConfigError",j.a.configError,CommonUIStrings.l_ConfigError)),a.pngFormat=A.a.devicePixelRatio>(a.isPdfMode?1.24:i.DEVICE_PIXEL_RATIO_THRESHOLD_DOC)?"pnglarge":"png",a.highDpiDocToPngBrsIsEnabled=Boolean.parse(t.WordViewerHighDpiDocToPngIsEnabled||"false"),a.highDpiPdfToPngBrsIsEnabled=Boolean.parse(t.WordViewerHighDpiPdfToPngIsEnabled||"false"),a.zoomPopupDialogIsEnabled=Boolean.parse(t.ZoomPopupDialogIsEnabled||"false"),"pnglarge"===a.pngFormat&&(a.isPdfMode&&a.highDpiPdfToPngBrsIsEnabled||!a.isPdfMode&&a.highDpiDocToPngBrsIsEnabled)?a.nilUuidStringPng=t.PngLargeFormatGuid:a.nilUuidStringPng=t.PngFormatGuid,a.theConfig=new Bt,o.AFrameworkApplication.appPreloadStatistics&&ee.PageStats.addServerMeasurements(o.AFrameworkApplication.appPreloadStatistics),ee.PageStats.beginRootMeasurement("Load",o.AFrameworkApplication.appInitTime),ee.PageStats.addAttribute(fe.a.sessionId,o.AFrameworkApplication.userSessionId),a._baseDocQueryParam=t.BaseDocQueryParam,a.theDocument=new Zt(a.baseDocQueryParam),o.AFrameworkApplication.theActionManager.addActionWithFlags(Me.a.xmlPageDownloaded3,Ee.a.application,Object(r.d)(tn(a),a.xmlPageDownloaded3,"xmlPageDownloaded3"),97),a.requestDocData();var p=new zt;o.AFrameworkApplication.theActionManager.registerApplication(p),i.get_activeAppFrame().thePageManager.registerHandler(2,Object(r.d)(tn(a),a.appClose,"appClose"),null),i.get_activeAppFrame().theMouseInputManager.registerHandler(Z.EventNames.mouseDown,a._target,Object(r.d)(tn(a),a.propagateMouseDownEventToHost,"propagateMouseDownEventToHost")),i.get_activeAppFrame().theTouchInputManager.registerHandler(Z.EventNames.touchStart,a._target,Object(r.d)(tn(a),a.propagateTouchEventToHost,"propagateTouchEventToHost")),i.initialParagraphId=i.determineInitialParagraphId(t),i.get_activeAppFrame().ribbonUser&&i.get_activeAppFrame().ribbonUser.poll(),i.get_activeAppFrame().statusBarUser&&i.get_activeAppFrame().statusBarUser.poll();var h=t.PageTitle;null!=h&&(document.title=h),H.a.instance.checkUserRoamingRights(4),MSOJS.ClientUtils.InitUrls(o.AFrameworkApplication.roamingAppsX86RootUrl,o.AFrameworkApplication.roamingAppsControlInstallerUrl,o.AFrameworkApplication.roamingAppsFirefoxExtensionUrl);var f=$.FocusManager.instance().getScope(W.AFrame.mainAppFocusId);W.AFrame.bindWithDoNothingFallback(f,J.KeyInputManager.hashKeyString(WordViewerIntl.WordViewerStrings.l_HK_Save),ve.a.doNothing),a.resourceTimingLoggerFuture.execute((function(e){e.configure(30,0),e.add_entriesAvailable(i.onResourceTimingEntriesAvailable),e.activate()})),a.enqueueDelayLoadedFiles(),a.checkHostCanaryValidityAndRedirectIfNeeded(t.HostViewUrl,Ht.a.hostCanaryFailure),m.a.instance.notifyReadyToInit();var v=t.FileName;null!=v&&pe.c(v).endsWith(".ODT")&&w.ULS.sendTraceTag(18449630,301,50,"ODT load");var _=t.ModeSwitchTime;null!=_&&ne.a.instance.addMetric(te.a.modeSwitchTime,_);var y=t.RedirectionReason;return null!=y&&o.AFrameworkApplication.isNoChrome&&ne.a.instance.addMetric(te.a.isFallback,"NOBUNDLEINFO"!==pe.c(y)?1:0),g.a.instance.recordAppInitEnd(),a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var s,l,c,u=i.prototype;return u.set_isSmallView=function(e){return this._isSmallView=e,e},u.addEntryToBusinessBar=function(e,t){return!!i.get_activeAppFrame().businessBar&&(i.get_activeAppFrame().businessBar.addEntry(e,t),!0)},u.addGdprBusinessBarWithCloseCallback=function(e,t,n,r){if(i.get_activeAppFrame().businessBar){var a=new I.a(null,e,null);a.closeable=!0,a.id=23,a.image=3,a.addLinkWithHandler(t,(function(){he.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+n)})),r&&(a.closeHandler=r),i.get_activeAppFrame().businessBar.addEntry(a,!0)}},u.addGdprBusinessBar=function(e,t,n){this.addGdprBusinessBarWithCloseCallback(e,t,n,null)},u.propagateMouseDownEventToHost=function(e){var t;return this.postMessenger.sendMessage(me.a.browserEvent,((t={}).type="mousedown",t.altKey=!1,t.ctrlKey=!1,t.metaKey=!1,t.shiftKey=!1,t)),!1},u.propagateTouchEventToHost=function(e){var t;return this.postMessenger.sendMessage(me.a.browserEvent,((t={}).type="touchstart",t.altKey=!1,t.ctrlKey=!1,t.metaKey=!1,t.shiftKey=!1,t)),!1},u.fastFail=function(e,t){void 0===t&&(t=null);var n=new Y.a,i=new Wt.a;throw i.register(n),this.initializeDefaultErrorHandler(i,e,!0),null!=t&&(o.AFrameworkApplication.reportError(t),o.AFrameworkApplication.suppressCrashReportingToBSqm=!0,o.AFrameworkApplication.suppressCrashReportingToWatson=!0),Error.invalidOperation("Unable to load resources for LCID "+e.Lcid)},u.handleEditInBrowser=function(){switch(this.editMode){case 1:o.AFrameworkApplication.theActionManager.processAction(Me.a.switchToEditMode,2);break;case 3:var e,t=((e={}).targetWacAction="Edit",e),n=i.get_activeAppFrame().getTopParagraphId();n&&(t.wdparams="wd=pid("+n+")"),o.AFrameworkApplication.theActionManager.processActionWithData(ve.a.copyAndEdit,2,t);break;case 2:o.AFrameworkApplication.theActionManager.processAction(Me.a.binaryConvert,2);break;default:0}},u.setAccessiblePdfModeCookie=function(e){le.a.setWithExpiration("WordViewerAccessibilityModeCookie",e.toString(),30)||w.ULS.sendTraceTag(20267092,301,50,"Failed to set cookie for accessible mode cookie to {0}",e.toString())},u.onFullAppSettingsFailed=function(){w.ULS.sendTraceTag(7387203,301,10,"Full App Settings failed to download."),at.a.showErrorDialogEx(j.a.fullAppSettingDownloadFailed,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemInitialDialogDescription),at.a.propagateError(!0,"FullAppSettingsDownloadFailed",j.a.fullAppSettingDownloadFailed,CommonUIStrings.l_NetworkProblemInitialDialogDescription)},u.updateFullAppSettings=function(t){e.prototype.updateFullAppSettings.call(this,t),o.AFrameworkApplication.docPropertiesProvider=new d(t),"true"===t.UserCanWriteRelative&&(this._userCanWriteRelative=!0);var n=t.Scenarios;this._supportsCobalt=n.indexOf(o.AFrameworkApplication.supportsCobaltFlag)>-1,this._supportsEditingWithLocks=n.indexOf(o.AFrameworkApplication.supportsEditingWithLocksFlag)>-1,"false"===t.PrintingEnabled&&(this._printingEnabled=!1),this.appEmbedPreviewUrl=t.AppEmbedPreviewUrl,this._embedPreviewUrl=this.computeEmbedPreviewUrl(o.AFrameworkApplication.hostEmbeddedViewUrl,this.appEmbedPreviewUrl),this._isBroadcastMode&&this.broadcastPostMessageOrigin&&(o.AFrameworkApplication.postMessageOrigin=this.broadcastPostMessageOrigin)},u.dispose=function(){this._disposed||(m.a.instance.dispose(),i.get_activeAppFrame().theMouseInputManager.unregisterHandler(Z.EventNames.mouseDown,this._target,Object(r.d)(this,this.propagateMouseDownEventToHost,"propagateMouseDownEventToHost")),i.get_activeAppFrame().theTouchInputManager.unregisterHandler(Z.EventNames.touchStart,this._target,Object(r.d)(this,this.propagateTouchEventToHost,"propagateTouchEventToHost")),this.resourceTimingLoggerFuture.execute((function(e){e.deactivate(!0),e.remove_entriesAvailable(i.onResourceTimingEntriesAvailable)})),this._target=null,this._disposed=!0,e.prototype.dispose.call(this))},u.checkIfStringIsDownloaded=function(e,t,n){var i=!1;try{t()||(i=!0)}catch(e){i=!0}i&&this.fastFail(e,n)},u.computeEmbedPreviewUrl=function(e,t){var n=null;return!o.AFrameworkApplication.isEmbedded&&e&&((n=e).toUpperCase().startsWith("HTTP://")?document.URL.toUpperCase().startsWith("HTTPS://")&&(n=t):n.toUpperCase().startsWith("HTTPS://")||(w.ULS.sendTraceTag(5017923,301,15,"HostEmbeddedViewUrl must start with HTTP or HTTPS: {0}",e),n=null)),n},u.getDocDataUri=function(e){var t=null;t=this.highDpiDocToPngBrsIsEnabled&&!this.isPdfMode||this.highDpiPdfToPngBrsIsEnabled&&this.isPdfMode?this.pngFormat:"png";var n=i.webServiceBase+"docdatahandler.ashx?"+this.theDocument.baseDocQuerySignature+"&type="+t+"&o15=1";return e&&(n+="&language="+e),""!==this._uiQueryParameter&&(n+="&ui="+this._uiQueryParameter),this.isPdfMode&&(n+="&PdfMode=1"),n},u.requestDocData=function(){if(!this.shouldSkipDocDataRequest()){o.AFrameworkApplication.collectPageStats&&ee.PageStats.beginMeasurement("RequestDocData");var e=this.getDocDataUri(this._translationLanguage);se.a.doRequest(e,Object(r.d)(this,this.onRequestComplete,"onRequestComplete"),i.get_activeAppFrame().notificationBar)||o.AFrameworkApplication.collectPageStats&&ee.PageStats.endMeasurement("RequestDocData"),ie.a.mark(7244)}},u.shouldSkipDocDataRequest=function(){return!!b.a.isBingPreview&&(w.ULS.sendTraceTag(6031385,301,50,"Skipping DocData: BingPreview"),!0)},u.onRequestComplete=function(e,t,n){if(!this._disposed){if(!e)return i.reportFirstPageAndRenderTime(),at.a.showErrorDialogEx(j.a.openFileNetworkProblem,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemInitialDialogDescription),void at.a.propagateError(!0,"RequestFailed",j.a.openFileNetworkProblem,CommonUIStrings.l_NetworkProblemInitialDialogDescription);i.isFirstPageImageDisplayed()||i.hideFirstPageImage();var r=n.responseXml,a=n.responseData,s=null;if(r&&(se.a.isValidResponseXMLDoc(r)||(r=Sys.Net.XMLDOM(n.responseData,!0)),s=r.selectSingleNode("/docdata/document")),!s)return i.reportFirstPageAndRenderTime(),at.a.showErrorDialog(r),void at.a.propagateError(!0,"InvalidDocData",j.a.cannotOpenFile,CommonUIStrings.l_CannotOpenFile,t);i.instance.status=1,this.initNamedObject(a,this.theDocument.baseDocQuerySignature),this.theDocument.init(s),o.AFrameworkApplication.theWsaClient.setDw(9131,this.theDocument.pageCount);var l=(new Date).getTime()-o.AFrameworkApplication.bootTime;if(o.AFrameworkApplication.theWsaClient.setDw(8867,l),ie.a.mark(5051),g.a.instance.recordAppInteractive((new Date).getTime()),!o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogBootPerfMetricsOnAppDisposeIsEnabled")){var c=new ae.a(2,1,2e3,(function(e){ne.a.instance.log()}),79);o.AFrameworkApplication.theTaskManager.addTask(c)}o.AFrameworkApplication.collectPageStats&&(n.responseHeaders[O.a.correlationIdHeaderName]&&ee.PageStats.addAttribute(fe.a.correlation,n.responseHeaders[O.a.correlationIdHeaderName].toString()),n.responseHeaders[ee.PageStats.pageStatsResponseXHRHeader]&&ee.PageStats.addServerMeasurements(n.responseHeaders[ee.PageStats.pageStatsResponseXHRHeader].toString()),ee.PageStats.endMeasurement("RequestDocData")),i.get_activeAppFrame().statusBarUser&&i.get_activeAppFrame().statusBarUser.setZoomVisibility(!0);var u=new ae.a(2,1,1e3,(function(e){Nt.a.translationLanguages.requestTranslationLanguagesAppSetting()}));o.AFrameworkApplication.theTaskManager.addTask(u),i._docData=n,i.get_activeAppFrame().thePageInfoCache=new Xt,Ne.a.instance.isNormalized&&i.initialParagraphId?i.get_activeAppFrame().thePageInfoCache.addToCache(1,1):this.initializeDocument()}},u.initNamedObject=function(e,t){re.a.initWithExtraUrlParameters(i.webServiceBase+"ResReader.ashx",t,this.nilUuidStringPng,this.getExtraUrlParamsForNamedObject())},u.getExtraUrlParamsForNamedObject=function(){var e=o.AFrameworkApplication.theClientRequestManager.wacClusterId;return(e?"&"+O.a.wacClusterQsName+"="+e:"")+(this.isPdfMode?"&PdfMode=1":"")},u.noRightClick=function(e){X.a.cancelEvent(e)},u.appClose=function(e){this.dispose()},u.initPaths=function(e){Lt.a.wordViewerImageBase=e.WordViewerImageBase,Lt.a.wordViewerCssBase=e.WordViewerCssBase,Lt.a.wordViewerScriptsBase=e.WordViewerScriptsBase,Lt.a.wordViewerScriptsLcidBase=e.WordViewerScriptsLcidBase,Lt.a.ribbonImageBase=e.RibbonImageBase,Lt.a.ribbonCssBase=e.RibbonCssBase,Lt.a.ribbonScriptsBase=e.RibbonScriptsBase,V.a.staticContentHost=e.StaticContentHost,V.a.sharedStaticContentHost=e.SharedStaticContentHost,V.a.staticContentQueryParameter=e.StaticContentQueryParameter,V.a.commonImageBase=e.CommonImageBase,V.a.commonCssBase=e.CommonCssBase,V.a.commonScriptsBase=e.CommonScriptsBase,V.a.commonScriptsLcidBase=e.CommonScriptsLcidBase},u.initializeDocument=function(){var e=i._docData.responseXml;se.a.isValidResponseXMLDoc(e)||(e=Sys.Net.XMLDOM(i._docData.responseData,!0));var t=null;e&&(t=e.selectSingleNode("/docdata/document")),t?(i.get_activeAppFrame().initializeAll(this._target),i.instance.status=2,1!==i.initialPageNumber&&this.scrollControl.scrollToPage(i.initialPageNumber),this.isBroadcastMode&&o.AFrameworkApplication.theActionManager.processAction(Me.a.onAppReady,2)):(at.a.showErrorDialog(e),at.a.propagateError(!0,"InvalidDocData",j.a.cannotOpenFile,CommonUIStrings.l_CannotOpenFile))},u.xmlPageDownloaded3=function(e,t,n,r,a){var o=a;return i.initialParagraphId&&this.foundParaIdInPageInfo(o)&&this.initializeDocument(),32},u.foundParaIdInPageInfo=function(e){var t,n,r=e.firstPage,o=e.lastPage;if(this.findParagraphInSelectionXml(e,Object(a.a)((function(){return n}),(function(e){return n=e})),Object(a.a)((function(){return t}),(function(e){return t=e})))){var s=this.zoomControl.currentZoom,l=Ne.a.instance.getPageTopAtZoom(n,s),c=Math.round(l+t*s)-40;i.initialParagraphId=0,isNaN(c)||(i.initialScrollTop=c)}else{if(!(o>=Ne.a.instance.pageCount))return i.get_activeAppFrame().thePageInfoCache.addToCache(o+1,o+1),!1;i.initialParagraphId=0,i.get_activeAppFrame().thePageInfoCache.removeFromCache(r,r)}return!0},u.findParagraphInSelectionXml=function(e,t,n){t.val=1,n.val=40;for(var r=e.firstPage;r<=e.lastPage;r++){var a=i.get_activeAppFrame().thePageInfoCache.getXmlForPage(r);if(a){var o=a.selectSingleNode(Jt.c(r));if(o&&Jt.d(o,n))return t.val=r,!0}}return!1},u.getSignInParams=function(){var e=i.get_activeAppFrame().getTopParagraphId(),t={targetWacAction:"View"};return t.wdparams="wdparaid= "+e,t},u.getCopyAndEditParams=function(){var e={targetWacAction:"Edit"},t=i.get_activeAppFrame().getTopParagraphId();return t&&(e.wdparams="wd=pid("+t+")"),e},u.getFileNewProperties=function(){var e=new q;return e.createNewDocumentAspxRelativePath=this._wordEditorAppRootUrl+"/",e.flyoutAnchorId="faNew",e.headerButtonId="jbtnNewBlank",e.headerButtonText=WordViewerIntl.WordViewerStrings.L_NewBlank,e.headerButtonTitle=WordViewerIntl.WordViewerStrings.L_NewBlankDescription,e.image32by32=o.AFrameworkApplication.imageClusterPath,e.image32by32Class=Q.getImageClass("OLKNewButton_32x32x32"),e.labelText=WordViewerIntl.WordViewerStrings.L_New,e},u.getFileOpenProperties=function(){var e=new G;return e.flyoutAnchorId="faOpen",e.image32by32=o.AFrameworkApplication.imageClusterPath,e.image32by32Class=Q.getImageClass("SaveAsWordDocx_32x32x32"),e},u.createAppSettingsManager=function(e){return new Ut(e)},u.onFullAppSettingsReady=function(){this.updateFullAppSettings(o.AFrameworkApplication.appSettingsManager.appSettings),i.get_activeAppFrame().updateFullSettings(o.AFrameworkApplication.appSettingsManager.appSettings)},u.enqueueDelayLoadedFiles=function(){ce.a.enqueueResourceWithoutEnabling(de.a.create(V.a.commonScripts("wacairspaceanimationlibrary.js"),null,null,null,!1,!1,null,!0,this.isHttp2Enabled))},u.resolveActionId=function(t){return Me.a.getNameFromId(t)||e.prototype.resolveActionId.call(this,t)},i.get_activeAppFrame=function(){return o.AFrameworkApplication.activeFrame},i.updateUrlForAccessiblePdfMode=function(e,t){var n=i.getUrlParametersForAccessiblePdfMode(t);return D.a.addOrReplaceParametersValue(e,n)},i.getUrlParametersForAccessiblePdfMode=function(e){var t=new Ce.a;return t.add("wdAccPdf",e?"1":"0"),o.AFrameworkApplication.isEmbedded&&(i.instance.showEmbed||t.add("wdEmbedCode","0"),1!==i.initialPageNumber&&t.add("wdStartOn",i.initialPageNumber.toString())),t},i.reportFirstPageAndRenderTime=function(){if(!o.AFrameworkApplication._reportedRenderTime){var e,t=window.g_1stPgLdT;null==t&&(t=new Date);var n=t.getTime();if(g.a.instance.recordContentFetchEnd(n),g.a.instance.recordContentDisplayed(n),g.a.instance.recordWacRenderTimeFromBrowserFetchStart(n),g.a.instance.recordOfficeFrameRequestStart(),"undefined"!=typeof window.__startTime){var i=window.__startTime;g.a.instance.recordContentFetchStart(i.getTime()),e=t.getTime()-i.getTime()}else e=1e9;if(o.AFrameworkApplication.isNoChrome){var r=-1;"undefined"!=typeof window.documentClickTime&&(r=window.documentClickTime.getTime(),g.a.instance.recordUserClickedInHostUi(r));var a=-1;"undefined"!=typeof window.hostInitTime&&(a=window.hostInitTime.getTime(),ne.a.instance.addMetric(te.a.officeInitializationTime,a))}o.AFrameworkApplication.theWsaClient.setDw(10600,e)}},i.isReadyForRibbon=function(){return 1===i.instance.status||2===i.instance.status},i.isFirstPageImageDisplayed=function(){var e=document.getElementById("FirstPageImage");return!!e&&!!e.firstPageDisplayed},i.hideFirstPageImage=function(){var e=document.getElementById("FirstPageImage");e&&(e.onload="",e.onerror="");var t=document.getElementById("FirstPageContainer");t&&t.parentNode.removeChild(t)},i.InitializeHtmlScratchPadProvider=function(e){ue.a.initialize(e)},i.determineInitialParagraphId=function(e){var t=null;void 0!==e.InitialParaId&&null!==e.InitialParaId&&(t=e.InitialParaId);var n=0;if(t)try{n=parseInt(t,16)}catch(e){0}return n},i.onResourceTimingEntriesAvailable=function(e,t){for(var n=0;n<t.entries.length;n++){var i=t.entries[n];i.url=D.a.removeParameter(i.url,o.AFrameworkApplication.accessTokenParamName);var r=D.a.removeAllUrlParameters(i.url);("about:blank"===i.url||r.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===r&&"2"===D.a.getParameterValue(i.url,"u"))&&(i.behavior=1)}},s=i,c=[{key:"instance",get:function(){return o.AFrameworkApplication._instance}}],(l=[{key:"postMessenger",get:function(){return this._postMessenger||(this._postMessenger=ge.a.instance.resolve("WordViewer.IWordViewerPostMessenger"))}},{key:"resourceTimingLoggerFuture",get:function(){return this._resourceTimingLoggerFuture||(this._resourceTimingLoggerFuture=ge.a.instance.resolveFuture("Common.NetworkTiming.IResourceTimingLogger"))}},{key:"zoomControl",get:function(){return this._zoomControl||(this._zoomControl=ge.a.instance.resolve("WordViewer.Controls.IZoomControl"))}},{key:"scrollControl",get:function(){return this._scrollControl||(this._scrollControl=ge.a.instance.resolve("WordViewer.Controls.IScrollControl"))}},{key:"commandsToHostControlIdsMap",get:function(){return this._wordCommandsToHostControlIdsMap}},{key:"isAccessiblePdfMode",get:function(){return!!this.userMayEnterAccessiblePdfMode&&(this._accessiblePdfModeInitialized||(this._accessiblePdfModeInitialized=!0,this._accessiblePdfModeAppSetting?this._accessiblePdfMode=Boolean.parse(this._accessiblePdfModeAppSetting):(Se.a(20300620,301,null!=this.isScreenReaderPresent,"IsScreenReaderPresent was not initialized, defaulting to false"),this._accessiblePdfMode=null!=this.isScreenReaderPresent&&(this.isScreenReaderPresent||Boolean.parse(le.a.get("WordViewerAccessibilityModeCookie")||"false"))),this._accessiblePdfMode&&w.ULS.sendTraceTag(20451526,301,50,"Accessible PDF mode enabled for user")),this._accessiblePdfMode)}},{key:"pngFormat",get:function(){return this._pngFormat},set:function(e){this._pngFormat=e}},{key:"highDpiDocToPngBrsIsEnabled",get:function(){return this._highDpiDocToPngBrsIsEnabled},set:function(e){this._highDpiDocToPngBrsIsEnabled=e}},{key:"highDpiPdfToPngBrsIsEnabled",get:function(){return this._highDpiPdfToPngBrsIsEnabled},set:function(e){this._highDpiPdfToPngBrsIsEnabled=e}},{key:"zoomPopupDialogIsEnabled",get:function(){return this._zoomPopupDialogIsEnabled},set:function(e){this._zoomPopupDialogIsEnabled=e}},{key:"isReactStatusBarEnabled",get:function(){return Mt.a.isReactStatusBarEnabled}},{key:"baseDocQueryParam",get:function(){return this._baseDocQueryParam}},{key:"isCoreMode",get:function(){return this._isCoreMode},set:function(e){this._isCoreMode=e}},{key:"isSmallView",get:function(){return this._isSmallView}},{key:"embedPreviewUrl",get:function(){return this._embedPreviewUrl},set:function(e){this._embedPreviewUrl=e}},{key:"translationLanguage",get:function(){return this._translationLanguage}},{key:"translationLanguages",get:function(){return this._translationLanguages}},{key:"isBinary",get:function(){return this._isBinary}},{key:"supportsEditing",get:function(){return(this._supportsCobalt||this._supportsEditingWithLocks)&&o.AFrameworkApplication.webEditingEnabled&&!this._translationLanguage&&!this.isBroadcastMode&&!o.AFrameworkApplication.protectFile}},{key:"accessibleModeEnabled",get:function(){return this._accessibleModeEnabled}},{key:"userMayEnterAccessiblePdfMode",get:function(){return null!=this._userMayEnterAccessiblePdfMode||(this._userMayEnterAccessiblePdfMode=!1,this.accessibleModeEnabled&&(this.isBroadcastMode?w.ULS.sendTraceTag(20451527,301,100,"Accessible PDF mode not allowed: User is in broadcast mode"):this.isPdfMode?w.ULS.sendTraceTag(20451528,301,100,"Accessible PDF mode not allowed: User is in PDF mode"):b.a.hasPdfReader?this.showPrint?(w.ULS.sendTraceTag(20451531,301,100,"Accessible PDF mode may be entered by user"),this._userMayEnterAccessiblePdfMode=!0):w.ULS.sendTraceTag(20451530,301,100,"Accessible PDF mode not allowed: Printing is not being shown (document may be protected)"):w.ULS.sendTraceTag(20451529,301,100,"Accessible PDF mode not allowed: No PDF viewer detected in browser ({0})",b.a.browserNameForlogging))),this._userMayEnterAccessiblePdfMode}},{key:"userCanComment",get:function(){return!o.AFrameworkApplication.isEmbedded&&this._supportsCobalt&&!i.instance.translationLanguage&&!i.instance.isBroadcastMode&&i.instance.canCreateComments&&(i.canEdit||i.isReviewer)}},{key:"copyingEnabled",get:function(){return this._copyingEnabled&&!o.AFrameworkApplication.protectFile&&!b.a.isIPad&&!this.isProtectedPdf}},{key:"isProtectedPdf",get:function(){return!!this.theDocument&&this.theDocument.isProtectedPdf}},{key:"printingEnabled",get:function(){return this._printingEnabled&&!o.AFrameworkApplication.protectFile}},{key:"showPrint",get:function(){return this.printingEnabled&&(!o.AFrameworkApplication.isEmbedded||this._showPrintWhenEmbedded)}},{key:"showEmbed",get:function(){return this._showEmbed}},{key:"clientUrl",get:function(){return i.get_activeAppFrame().clientEditDocumentUrl}},{key:"officeAppType",get:function(){return 3}},{key:"officeAppMode",get:function(){return 2}},{key:"status",get:function(){return this._status},set:function(e){this._status=e}},{key:"activeUserName",get:function(){return this._userName}},{key:"canCreateComments",get:function(){return this._canCreateComments}},{key:"fileTypeSupportsCommenting",get:function(){return!this.isPdfMode}},{key:"isBroadcastMode",get:function(){return this._isBroadcastMode}},{key:"isPdfMode",get:function(){return this._pdfMode}},{key:"showReadOnlyBusinessBar",get:function(){return!!this.kindOfReadOnlyBusinessBar&&!!this.editMode&&2!==this.editMode}},{key:"kindOfReadOnlyBusinessBar",get:function(){switch(o.AFrameworkApplication.appSettingsManager.getIntAppSetting("ShowReadonlyBusinessBar",0)){case 2:return 2;case 0:default:return 0}}},{key:"translationFromEditor",get:function(){return this._translationFromEditor}},{key:"isOdt",get:function(){return this._isOdt}},{key:"showLegacyPrintDialogPdfMode",get:function(){return this._showLegacyPrintDialogPdfMode}},{key:"userCanWriteRelative",get:function(){return this._userCanWriteRelative}},{key:"userCanSaveAndEditTranslatedDocument",get:function(){return!(!this.translationLanguage||o.AFrameworkApplication.protectFile||o.AFrameworkApplication.disableEditIfAndroid||!this.userCanWriteRelative||o.AFrameworkApplication.isUIEmbedMode&&!o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HostSupportsDocRebootFeaturesInOtherMode"))}},{key:"editMode",get:function(){return o.AFrameworkApplication.copyAndEditUrl&&!o.AFrameworkApplication.protectFile?3:i.instance.supportsEditing&&i.get_activeAppFrame().wordEditorUrl?i.get_activeAppFrame().editNeedsConversion?2:1:0}},{key:"isReactSharedHeaderUxEnabled",get:function(){return o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsWoncaHeaderRefactoringEnabled",!0)?Object(Yt.a)(i.prototype,this,"isReactSharedHeaderUxEnabled")&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactSharedHeaderInViewerIsEnabled")&&!o.AFrameworkApplication.hideHeader:Object(Yt.a)(i.prototype,this,"isReactSharedHeaderUxEnabled")&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactSharedHeaderInViewerIsEnabled")}},{key:"isSharedHeaderPlaceholderEnabled",get:function(){return this.isReactSharedHeaderUxEnabled&&o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HeaderPlaceholderIsEnabled",!1)}}])&&en(s.prototype,l),c&&en(s,c),i}(C);nn.DEVICE_PIXEL_RATIO_THRESHOLD_DOC=1.24,nn.canEdit=!1,nn.isReviewer=!1,nn.interactiveViewIsEnabled=!1,nn.initialParagraphId=0,nn.initialPageNumber=1,nn.initialScrollTop=0,nn.allowUnsafeAppClose=!1,nn._docData=null,nn.webServiceBase=null,nn.mode=3,Object(i.a)(nn,"App",C,[0])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e,t){this.queryCommandId=null,this.commandPreviewId=null,this.commandRevertId=null,this.menuItemId=null,this.populationProps=null,this.legacyControlId=null,this.previewControlIds=null,this.externalUxCommand=e,this.commandId=t};Object(i.a)(r,"CommandMetadata",null,[])},function(e,t,n){"use strict";var i=n(0),r=(n(54),n(32)),a=n(79),o=n(322),s=function(e,t){this.x=e,this.y=t};Object(i.a)(s,"UnroundedPoint",null,[]);var l=n(27),c=n(10),u=n(76),d=n(13),p=n(3);n.d(t,"a",(function(){return h}));var h=function(){function e(){}return e.isPointInElement=function(t,n){return e.isPointInBounds(e.getElementBounds(t),n)},e.isPointInBounds=function(e,t){return t.x>=e.x&&t.y>=e.y&&t.x<e.x+e.width&&t.y<e.y+e.height},e.isBoundsEqual=function(e,t){return e.width===t.width&&e.height===t.height&&e.x===t.x&&e.y===t.y},e.getBoundingWidth=function(t){return e.getElementBounds(t).width},e.getBoundingTop=function(t){return e.getElementBounds(t).y},e.getBoundingLeft=function(t){return e.getElementBounds(t).x},e.getBoundingBottom=function(t){var n=e.getElementBounds(t);return n.y+n.height},e.getBoundingRight=function(t){var n=e.getElementBounds(t);return n.x+n.width},e.getElementBounds=function(e){n(9).Debug;if(e)try{var t=e.getBoundingClientRect(),i=t.left,r=t.top,a=t.right,o=t.bottom;return new Sys.UI.Bounds(i,r,a-i,o-r)}catch(e){if(p.ULS.sendTraceTag(40138062,306,50,"Failed to get element bounds {0}",e),!c.a.isInternetExplorer)throw e;return new Sys.UI.Bounds(0,0,0,0)}return new Sys.UI.Bounds(0,0,0,0)},e.getElementUnroundedPointWidthAndHeight=function(e,t,i){n(9).Debug;if(e){var r=e.getBoundingClientRect(),a=r.left,o=r.top,l=r.right,c=r.bottom;return t.val=l-a,i.val=c-o,new s(a,o)}return t.val=-1,i.val=-1,new s(-1,-1)},e.getElementOffsetWidth=function(e){n(9).Debug;return e?e.offsetWidth:0},e.getElementLocation=function(t){var n=e.getElementBounds(t);return new Sys.UI.Point(n.x,n.y)},e.getElementAbsolutePosition=function(e,t,n){for(t.val=0,n.val=0;e;)t.val+=e.offsetLeft,n.val+=e.offsetTop,e=e.offsetParent},e.getElementAtPoint=function(e){return document.elementFromPoint(e.x,e.y)},e.getOpacity=function(e){if(e){var t=n(52).CssUtils.getCurrentStyle(e);if(t){var i=t.filter;if(c.a.isNonStandardsCompliantIE&&i){if(-1!==i.indexOf("opacity"))return parseInt(i.substring(i.indexOf("=")+1,i.indexOf(")")))}else if(t.opacity)return 100*parseFloat(t.opacity)}}return 100},e.setOpacity=function(e,t){n(9).Debug;c.a.isNonStandardsCompliantIE?e.style.filter="alpha(opacity="+t+")":e.style.opacity=100===t?"1":(.01*t).toString()},e.clearOpacity=function(e){c.a.isNonStandardsCompliantIE?e.style.filter="":e.style.opacity=""},e.addWhitespace=function(e,t,n){var i=t.ownerDocument.createTextNode(e),r=t.firstChild;n||!r?t.appendChild(i):t.insertBefore(i,r)},e.dumpHtmlWithoutText=function(t){var n=t.nodeName;if(3===t.nodeType)n+=" ("+t.nodeValue.length+")";else if(""!==t.className&&(n+="."+t.className),t.childNodes.length>0){n+=" (";for(var i=0;i<t.childNodes.length;i++)n+=e.dumpHtmlWithoutText(t.childNodes[i])+(i===t.childNodes.length-1?")":",")}return n},e.getParentWindow=function(e){return e.parentWindow||e.defaultView},e.getWindowLocation=function(e){return"undefined"!=typeof e.screenLeft?new Sys.UI.Point(e.screenLeft,e.screenTop):new Sys.UI.Point(e.screen.left,e.screen.top)},e.getRelativeLocation=function(e,t){var i=n(22).DomUtils,r=Sys.UI.DomElement.getLocation(e),a=Sys.UI.DomElement.getLocation(t),o=0,s=0,l=t;do{if(l=l.parentNode,!i.isValidElement(l))return p.ULS.sendTraceTag(24975303,306,10,String.format("Invalid walker element in GetRelativeLocation. Caller may have input a target (id:{0} type:{1} class:{2}) that is not a child of parent (id:{3} type:{4} class:{5}).",t.id,t.nodeType,t.className,e.id,e.nodeType,e.className)),new Sys.UI.Point(0,0);o+=l.scrollTop,s+=l.scrollLeft}while(l!==e);return new Sys.UI.Point(a.x-r.x+s,a.y-r.y+o)},e.getRelativePoint=function(t,n,i){var r=e.getRelativeLocation(t,n);return new Sys.UI.Point(i.x-r.x+n.scrollLeft,i.y-r.y+n.scrollTop)},e.getRelativeBounds=function(t,n,i){var r=new Sys.UI.Point(i.x,i.y),a=e.getRelativePoint(t,n,r);return new Sys.UI.Bounds(a.x,a.y,i.width,i.height)},e.getInputTypeFromElement=function(e){var t=n(22).DomUtils;if(!e||3!==t.getTag(e))return null;var i=e,r=i.type;return null==r?null:d.a.toLower(i.type)},e.isRadioInputElement=function(t){return"radio"===e.getInputTypeFromElement(t)},e.isSupportedInputType=function(e){n(9).Debug;return"text"===e||"password"===e||"search"===e||"url"===e},e.isTextField=function(t){var i=n(22).DomUtils;if(!t||1!==t.nodeType)return!1;var r=e.getInputTypeFromElement(t);return e.isSupportedInputType(r)||5===i.getTag(t)||"true"===t.getAttribute("contenteditable")},e.selectAllTextInInput=function(e){n(9).Debug;if(void 0!==e.select&&null!==e.select)try{e.select()}catch(t){window.setTimeout((function(){e.select()}),0)}else 0},e.clearSelectionInInput=function(e){if(void 0!==e.setSelectionRange&&null!==e.setSelectionRange){var t=e.value.length;e.setSelectionRange(t,t)}},e.selectAllTextInElement=function(e){n(9).Debug;try{if(c.a.supportsDomL2Selection){var t=window.self.getSelection();t.removeAllRanges();var i=e.ownerDocument.createRange();i.setStart(e.firstChild,0),i.setEnd(e.firstChild,o.a(e).length),t.addRange(i)}else if(c.a.isNonStandardsCompliantIE){var r=document.body.createTextRange();r.moveToElementText(e),r.select()}else 0}catch(e){p.ULS.sendTraceTag(38835597,306,10,"Exception caught in SelectAllTextInElement: {0}",e)}},e.clearSelectionInElement=function(e){n(9).Debug;var t=!1;if(c.a.supportsDomL2Selection)try{return void window.self.getSelection().removeAllRanges()}catch(e){0,t=!0}if(c.a.isNonStandardsCompliantIE||t)try{var i=document.body.createTextRange();return i.moveToElementText(e),i.setEndPoint("EndToStart",i),void i.select()}catch(e){0}else 0},e.clearSelectionIfNecessary=function(){var t=n(22).DomUtils,i=document.activeElement;i&&1===i.nodeType&&(3===t.getTag(i)&&"text"===i.getAttribute("type")||5===t.getTag(i))&&e.clearSelectionInInput(i)},e.isFieldNullOrUndefined=function(e,t){return void 0===e[t]||null===e[t]},e.executeDocumentCommand=function(e,t,i,r){void 0===i&&(i=!1),void 0===r&&(r=null);var a=new(n(501).IgnoreTaskManagerRunningScope);try{return e.execCommand(t,i,r)}finally{a&&a.dispose()}},e.getActiveElement=function(e){var t=null;try{t=e.activeElement}catch(e){}return t},e.isActiveElement=function(t){return!!t&&t===e.getActiveElement(t.ownerDocument)},e.hasFocusableTabIndex=function(t,n){void 0===n&&(n=!1);var i=e.getAttributeValue(t,"tabIndex");if(null!=i){var r=parseInt(i);return!isNaN(r)&&r>=0}return!!n},e.getAttributeValue=function(e,t){return null!=e?e.getAttribute(t):null},e.getCurrentSelectionRange=function(e){if(c.a.supportsDomL2Selection){var t=e.getSelection();if(t)if(t.rangeCount)try{return t.getRangeAt(0)}catch(e){return p.ULS.sendTraceTag(36491728,306,15,"Exception when calling getRangeAt."),null}}return null},e.isRangeAnIp=function(t){n(9).Debug;var i=t.startContainer,r=t.endContainer,a=t.startOffset,o=t.endOffset;if(i!==r){if(i.parentNode!==r.parentNode)return!1;var s=e.getOffsetInParent(i,a),l=e.getOffsetInParent(r,o);return-1===s||-1===l||s===l}return a===o},e.getOffsetInParent=function(e,t){n(9).Debug;var i=e.parentNode;if(!i||!i.childNodes)return-1;for(var r=0,a=0;a<i.childNodes.length;a++){var o=i.childNodes[a];if((o=i.childNodes[a])===e)return r+t;o.nodeValue&&(r+=o.nodeValue.length)}return-1},e.isRangeAtStartOfFrame=function(e){n(9).Debug;var t=e.startContainer;if(e.startOffset)return!1;for(var i=t;i.parentNode&&(!i.tagName||"body"!==i.tagName.toLowerCase());){var r=i.parentNode;if(r.childNodes[0]!==i)return!1;i=r}return!0},e.isRangeAtEndOfFrame=function(e){n(9).Debug;var t=e.endContainer;if(e.endOffset!==n(22).DomUtils.getElementTextLength(t))return!1;for(var i=t;i.parentNode&&(!i.tagName||"body"!==i.tagName.toLowerCase());){var r=i.parentNode,a=r.childNodes.length-1;if(r.childNodes[a]!==i)return!1;i=r}return!0},e.getCommonDataToPost=function(t){var i=n(1).AFrameworkApplication,r=n(1).AFrameworkApplication.appSettingsManager.appSettings,a={};(i.accessToken&&(a[i.accessTokenParamName]=i.accessToken),i.accessTokenTtl&&(a[i.accessTokenTtlParamName]=i.accessTokenServerExpirationTime.toString()),t&&r[e.miniCheckTtlParamName])&&(Number.parseInvariant(r[e.miniCheckTtlParamName])>(new Date).getTime()&&(a[e.miniCheckDataInfoParamName]=r[e.miniCheckDataInfoParamName],a[e.miniCheckSignatureInfoParamName]=r[e.miniCheckSignatureInfoParamName],a[e.miniCheckTtlParamName]=r[e.miniCheckTtlParamName]));i.hostCanary&&(a[e.hostCanaryParamname]=i.hostCanary),i.appSettingsManager.getBooleanAppSetting(e.isJsApiParamName)&&(a.jsApi="1"),i.isUIEmbedMode&&(a.uiembed="1"),i.appSettingsManager.getBooleanAppSetting("PassUserIdOwnerIdViaPdcCookieIsEnabled")&&(e.loggableUserIdAppSettingName in r&&(a[e.loggableUserIdViaPdcParamName]=r[e.loggableUserIdAppSettingName]),e.loggableOwnerIdAppSettingName in r&&(a[e.loggableOwnerIdViaPdcParamName]=r[e.loggableOwnerIdAppSettingName]));var o=n(1).AFrameworkApplication.appSettingsManager.getStringAppSetting(n(1).AFrameworkApplication.hostUIControlSettingName);return o&&(a.huictrls=o),i.isControllerServicesQueryParamNeeded&&(a[i.controllerServicesParamName]="1"),a},e.removePostParamsFromUrl=function(e,t){for(var n in t){var i={key:n,value:t[n]};e=l.a.removeParameter(e,i.key)}return e},e.openWindow=function(t,i,o,s,c){void 0===o&&(o=!0),void 0===s&&(s=36e5),void 0===c&&(c=null);n(9).Debug;var d=n(1).AFrameworkApplication;var h=e.getCommonDataToPost(o);if(!u.c(h))return!!e.safelyOpenWindow(i,e.windowTargetToString(t),void 0,void 0,"OpenWindow");var m=e.removePostParamsFromUrl(i,h);if(1===t){var g="pdc"+n(188).randomBetween(0,32767).toString(16);m=l.a.addOrReplaceParameterValue(m,"pdcn",g),c&&(d.dataPlumber.RenavigationReason=c,m=l.a.addOrReplaceParameterValue(m,d.sessionOriginParamName,c,!0));var f=new Date;f.setTime(f.getTime()+s);var v=!(n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordDisableCookiesOnAppModeSwitchIsEnabled")&&c===r.a.renavigate_AppModeSwitch);return d.accessToken&&d.accessToken.length||p.ULS.sendTraceTag(591693726,306,10,"Access token is null or empty"),v&&a.a.setDictionaryValueWithDomain(g,h,f,"/",m)?window.location.replace(m):(v||p.ULS.sendTraceTag(591685456,306,50,"Navigating without cookies because of config WordDisableCookiesOnAppModeSwitchIsEnabled"),e.postToWindow(e.windowTargetToString(t),m,h)),!0}return e.postToWindow(e.windowTargetToString(t),m,h),!0},e.safelyOpenWindow=function(e,t,n,i,r){void 0===t&&(t=null),void 0===n&&(n=""),void 0===i&&(i=!1),void 0===r&&(r="");var a=null;try{a=window.open(e,t,n,i)}catch(e){p.ULS.sendTraceTag(590881243,306,15,"Window.Open failed with error: {0}, while trying to open: {1}",e,r)}return a},e.openWindowWithAttributes=function(t,i,r,a,o,s,l){void 0===l&&(l=!0);n(9).Debug;var c=n(1).AFrameworkApplication;var p=s?e.getCommonDataToPost(l):null;if(!s||!p||!u.c(p))return e.safelyOpenWindow(i,e.windowTargetToString(t),a,o,"OpenWindowWithAttributes");e._accessTokenHash||(e._accessTokenHash=d.a.calcHashCode(c.accessToken)),e._openWindowCount++;var h=(r||"wacwindow")+e._accessTokenHash+e._openWindowCount,m=e.removePostParamsFromUrl(i,p);return e.postToWindowWithAttributes(m,h,a,o,p)},e.postToWindowWithAttributes=function(t,i,r,a,o){n(9).Debug;var s;return s=e.safelyOpenWindow("",i,r,a,"PostToWindowWithAttributes"),e.postToWindow(i,t,o),s},e.postToWindow=function(t,i,r){void 0===r&&(r=null);n(9).Debug;for(var a in r=r||{},e._postWindowForm&&(document.body.removeChild(e._postWindowForm),e._postWindowForm=null),e._postWindowForm=document.createElement("form"),e._postWindowForm.action=i,e._postWindowForm.method="post",e._postWindowForm.target=t,r){var o={key:a,value:r[a]},s=document.createElement("input");s.type="hidden",s.name=o.key,s.value=o.value,e._postWindowForm.appendChild(s)}document.body.appendChild(e._postWindowForm),e._postWindowForm.submit()},e.windowTargetToString=function(e){n(9).Debug;switch(e){case 1:return"_self";case 2:return"_parent";case 3:return"_top";case 4:return"_blank";default:return""}},e.setButtonEnabledState=function(e,t){n(9).Debug;null!=e&&e.disabled!==!t&&(e.disabled=!t,t?Sys.UI.DomElement.removeCssClass(e,"DisabledButton"):Sys.UI.DomElement.addCssClass(e,"DisabledButton"))},e.getWindowPerformanceTimingObject=function(){var e=window.self.performance||null;return e&&e.timing||null},e.isVisible=function(t){var i=n(22).DomUtils,r=n(52).CssUtils;return 7!==i.getTag(t)&&"hidden"!==e.getInputTypeFromElement(t)&&e.styleVisible(r.getCurrentStyle(t)||t.style)},e.styleVisible=function(e){return!("none"===d.a.toLower(e.display)||"hidden"===d.a.toLower(e.visibility)||"collapse"===d.a.toLower(e.visibility))},e.setOuterEdge=function(e,t,n){n?e.style.right=t+"px":e.style.left=t+"px"},e.rtlInvertIfNecessary=function(e){return n(1).AFrameworkApplication.isRtl?-e:e},e.followHyperlinkWithNoReferrer=function(t){if(c.a.supportsNoReferrer()){var n=document.createElement("a");n.target="_blank",n.href=t,n.setAttribute("rel","noreferrer"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}else e.safelyOpenWindow(t,void 0,void 0,void 0,"FollowHyperlinkWithNoReferrer")},e.leftBoundsOverlapsRightBounds=function(t,n,i){return e.leftBoundsOverlapsRightBoundsByAmount(t,n,i)>=1},e.leftBoundsOverlapsRightBoundsByAmount=function(e,t,n){var i=n?t:e,r=n?e:t,a=new Sys.UI.Point(r.x,r.y);return i.x+i.width-a.x},e.getTickCount=function(){try{if(c.a.supportsPerformanceNow)return window.performance.now()}catch(e){p.ULS.sendTraceTag(50677923,306,15,"Calling Window.Performance.Now() failed with exception: {0}",e.toString())}return(new Date).getTime()},e.getLinkAroundElement=function(t){return t&&1===t.nodeType?"A"===t.tagName.toUpperCase()?t:e.getLinkAroundElement(t.parentNode):null},e.downloadFile=function(t){e._downloadFrame||(e._downloadFrame=document.createElement("iframe"),e._downloadFrame.id="DownloadFileFrame",e._downloadFrame.style.cssText="height:0;width:0;display:none",document.body.appendChild(e._downloadFrame)),e._downloadFrame.src=t},e.measureTimeToNextFrame=function(t,n){var i=e.getTickCount();window.requestAnimationFrame((function(r){window.setTimeout((function(){var r=e.getTickCount()-i;p.ULS.sendTraceTag(40637981,340,50,"Action: {0}, ControlId: {1}, TimeToFirstFrame: {2}",n,t,r)}),0)}))},e.requestIdleCallbackExists=function(){return!!window.requestIdleCallback},e.cancelIdleCallbackExists=function(){return!!window.cancelIdleCallback},e}();h.miniCheckDataInfoParamName="mci",h.miniCheckTtlParamName="mcttl",h.miniCheckSignatureInfoParamName="mcsi",h.hostCanaryParamname="cy",h.loggableUserIdViaPdcParamName="loggable_user_id",h.loggableOwnerIdViaPdcParamName="loggable_owner_id",h.loggableUserIdAppSettingName="LoggableUserId",h.loggableOwnerIdAppSettingName="LoggableOwnerId",h.isJsApiParamName="IsJsApi",h._openWindowCount=0,h._accessTokenHash=0,h._postWindowForm=null,h._downloadFrame=null,Object(i.a)(h,"WindowUtils",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=(n(54),n(16)),a=n(49);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){this._controlledElements=[],this._isEnabled=!0,this._allocationCallstack=null;n(9).Debug;this._postEventCallback=function(){},e._refCount++,this._supressEvents=!1}var t,i,a,s=e.prototype;return s.dispose=function(){n(9).Debug;for(this.releaseCapture(),this.resume();this._controlledElements.length>0;)this.deinitializeForElement(this._controlledElements[0]);Array.clear(this._controlledElements),e._refCount--},s.suspend=function(){this._supressEvents=!0},s.resume=function(){this._supressEvents=!1},s.registerPostEventCallback=function(e){this._postEventCallback=e},s.releaseCapture=function(){},s.initializeForElement=function(e){Array.add(this._controlledElements,e)},s.deinitializeForElement=function(e){Array.remove(this._controlledElements,e)},s.addDomEventHandler=function(e,t,n,i){void 0===i&&(i=!1),i?e.addEventListener(t,n,i):$addHandler(e,t,n)},s.removeDomEventHandler=function(e,t,n,i){void 0===i&&(i=!1),i?e.removeEventListener(t,n,i):$removeHandler(e,t,n)},e.add_onInputCancelled=function(t){e._eventSource.addHandler("InputCancelled",t)},e.remove_onInputCancelled=function(t){e._eventSource.removeHandler("InputCancelled",t)},e.setEnsureAppAwakeCallback=function(t){e._ensureAppAwakeCallback=t},e.setEnsureAppAwakeIfAsleepCallback=function(t){e._ensureAppAwakeIfAsleepCallback=t},e.ensureAppAwake=function(){e._ensureAppAwakeCallback&&e._ensureAppAwakeCallback()},e.ensureAppAwakeIfAsleep=function(){e._ensureAppAwakeIfAsleepCallback&&e._ensureAppAwakeIfAsleepCallback()},e.addHandler=function(e,t,i){n(48).EventHandlerManager.instance.registerRawEventHandler(t,e,i)},e.removeHandler=function(e,t,i){n(48).EventHandlerManager.instance.unregisterRawEventHandler(t,e,i)},e.registerEventsToBeIgnored=function(t,i){n(48).EventHandlerManager.instance.initializeListForElement(i,t,0,(function(t,n,i){return i.rawEvent[e.markerFieldForEventsToBeIgnored]=!0,!1}))},e.removeAllHandlers=function(e){$clearHandlers(e)},e.cancelEventNoPreventDefault=function(t){e.cancelEventInternal(t,!1)},e.cancelEvent=function(t){e.cancelEventInternal(t,!0)},e.cancelEventInternal=function(t,i){n(129).ADebugOptionsTab,n(185).CommonDebugOptions,n(9).Debug;var r=n(4).EventNames;if(t.stopPropagation(),i&&t.preventDefault(),t.rawEvent&&t.rawEvent.keyCode)try{t.rawEvent.keyCode=0}catch(e){}Array.contains(r.get_keyTypedEvents(),t.type)&&e._eventSource.raiseEvent("InputCancelled")},e.eventLandedBeyondSourceElement=function(e){n(9).Debug,n(4).EventNames;var t=e.rawEvent,i=n(41).EventHandlerArgs.getSourceElement(e);if(!i.ownerDocument)return!1;if(Sys.UI.DomElement.containsCssClass(i,"ignore-scroll-bounds-check"))return!1;var a=!1,o=i.clientWidth,s=i.clientHeight;if(o&&s){if(o===i.offsetWidth&&s===i.offsetHeight)return!1;var l=r.a.getElementBounds(i),c=new Sys.UI.Bounds(l.x,l.y,o,s);if(r.a.isBoundsEqual(l,c))return!1;var u=new Sys.UI.Point(t.clientX,t.clientY);a=!r.a.isPointInBounds(c,u)}return a},t=e,(i=[{key:"isEnabled",get:function(){return this._isEnabled},set:function(e){this._isEnabled=e}}])&&o(t.prototype,i),a&&o(t,a),e}();s.markerFieldForEventsToBeIgnored="shouldBeIgnoredByMsospHandlers",s._refCount=0,s._ensureAppAwakeIfAsleepCallback=null,s._ensureAppAwakeCallback=null,s._eventSource=new a.a,s._allocatedInputManagers=void 0,s._trackedKeys=void 0,s._uniqueTrackedKeys=void 0,s._trackedMap=void 0,s._nextUniqueId=void 0,s.isLeakDetectionEnabled=void 0,s.cancelEventHandler=s.cancelEvent,Object(i.a)(s,"InputManager",null,[4])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}return e.getNameFromId=function(e){switch(e){case 146879195:return"AnimateScrollStarted";case 4038446671:return"BeforeAnimateScroll";case 3614810735:return"BeginSelection";case 940168130:return"BinaryConvert";case 3686078251:return"BroadcastOnScroll";case 2474762090:return"BrowserCopied";case 1041156544:return"BuildClipboard";case 2718896640:return"CommentDownloadCorrupt";case 3383614517:return"Copy";case 482496454:return"DirectPrintForPdfMode";case 3571000895:return"DocumentLoadFinished";case 3082914623:return"DoubleClickSelection";case 1485307652:return"DownloadAsPdf";case 1045098306:return"DownloadATranslatedCopy";case 1074370255:return"EndSelection";case 2719151194:return"FitHeight";case 2289035997:return"FitWidth";case 2268993336:return"HandleEscKeyDown";case 2376600552:return"HideAllPanes";case 2599343072:return"HideSearchPane";case 1925081555:return"LaunchImmersiveReader";case 1548165396:return"NextPage";case 716333338:return"NextSearchResult";case 3346400015:return"OnAppReady";case 2092285007:return"OnContainerResizeForSelection";case 1314702013:return"OnCurrentPageChange";case 1008943434:return"OnLabelPoll";case 2854499422:return"OnScroll";case 3006111724:return"OnZoomChange";case 1381613595:return"OpenAccessibleView";case 3588168074:return"OpenInClient";case 2947452783:return"OpenInWordViewer";case 3870085532:return"OpenSharedNotes";case 2936063169:return"PageCacheChanged";case 2491927299:return"PageSetResized";case 2589737880:return"PopulateContextMenu";case 1568572584:return"PopulateZoomFlyout";case 3940382077:return"PreventWarningsOnAppClose";case 1693292334:return"PreviousSearchResult";case 3537571872:return"PrevPage";case 1480533506:return"PrintAccessibilityDocument";case 3321901940:return"PrintDocument";case 127034278:return"PrintXml";case 310212246:return"QueryAccessibleModeButtonToggledState";case 1122736542:return"QueryCurrentPageLabel";case 936755515:return"QueryPresenterPageLabel";case 1289223352:return"QueryToggleSearchPane";case 495441999:return"QueryZoomLevel";case 433063458:return"QueryZoomText";case 2918606216:return"RebuildCommentHints";case 3838916066:return"RebuildCommentHintsWithoutAnimation";case 702693766:return"RepositionScroller";case 2778760596:return"RepositionScrollerWithoutAnimation";case 569132212:return"ResizeCache";case 541818074:return"ResizeCacheWithoutAnimation";case 2385100972:return"ResizeScroller";case 662384170:return"ResizeScrollerWithoutAnimation";case 2866603464:return"SaveAndEditATranslatedCopy";case 3456074588:return"ScrollDownArrow";case 135979168:return"ScrollEnd";case 3369669304:return"ScrollHome";case 340039443:return"ScrollLeftArrow";case 2180939724:return"ScrollPageDown";case 1783913247:return"ScrollPageUp";case 4117423060:return"ScrollRightArrow";case 3073381345:return"ScrollUpArrow";case 1297807363:return"SelectFromScroll";case 3828858224:return"SetCurrentPage";case 231667503:return"SetZoomLevel";case 3458683028:return"ShowContextMenuFromKey";case 2802067523:return"ShowContextMenuInDocument";case 1725824390:return"ShowFileEmbedInfo";case 3402718245:return"ShowPdfConvertAndEditDialog";case 4205256019:return"ShowPdfCopyAndEditDialog";case 2893474578:return"ShowReembedCode";case 428795035:return"ShowSearchPane";case 2666100903:return"SLPageReady";case 4125937875:return"StatusBarTest";case 329275380:return"SwitchToEditMode";case 1254572192:return"SwitchToUnifiedReadMode";case 3349150556:return"SyncToPresenter";case 2281051331:return"ToggleCommentPane";case 583433745:return"ToggleMenu";case 976411380:return"ToggleSearchPane";case 2680748364:return"ToggleViewMode";case 573791575:return"TranslateBackToOriginal";case 2612243365:return"TranslateDocument";case 3917526816:return"UpdateCommentHighlight";case 851844167:return"UpdateSearchHighlight";case 2195537549:return"UpdateSelection";case 3850825085:return"UpdateZoomOnWindowResize";case 779228655:return"XmlPageDownloaded";case 4224281129:return"XmlPageDownloaded2";case 1495397774:return"XmlPageDownloaded3";case 1281912385:return"ZoomToNextLevel"}return null},e}();r.animateScrollStarted=146879195,r.beforeAnimateScroll=4038446671,r.beginSelection=3614810735,r.binaryConvert=940168130,r.broadcastOnScroll=3686078251,r.browserCopied=2474762090,r.buildClipboard=1041156544,r.commentDownloadCorrupt=2718896640,r.copy=3383614517,r.directPrintForPdfMode=482496454,r.documentLoadFinished=3571000895,r.doubleClickSelection=3082914623,r.downloadAsPdf=1485307652,r.downloadATranslatedCopy=1045098306,r.endSelection=1074370255,r.fitHeight=2719151194,r.fitWidth=2289035997,r.handleEscKeyDown=2268993336,r.hideAllPanes=2376600552,r.hideSearchPane=2599343072,r.launchImmersiveReader=1925081555,r.nextPage=1548165396,r.nextSearchResult=716333338,r.onAppReady=3346400015,r.onContainerResizeForSelection=2092285007,r.onCurrentPageChange=1314702013,r.onLabelPoll=1008943434,r.onScroll=2854499422,r.onZoomChange=3006111724,r.openAccessibleView=1381613595,r.openInClient=3588168074,r.openInWordViewer=2947452783,r.openSharedNotes=3870085532,r.pageCacheChanged=2936063169,r.pageSetResized=2491927299,r.populateContextMenu=2589737880,r.populateZoomFlyout=1568572584,r.preventWarningsOnAppClose=3940382077,r.previousSearchResult=1693292334,r.prevPage=3537571872,r.printAccessibilityDocument=1480533506,r.printDocument=3321901940,r.printXml=127034278,r.queryAccessibleModeButtonToggledState=310212246,r.queryCurrentPageLabel=1122736542,r.queryPresenterPageLabel=936755515,r.queryToggleSearchPane=1289223352,r.queryZoomLevel=495441999,r.queryZoomText=433063458,r.rebuildCommentHints=2918606216,r.rebuildCommentHintsWithoutAnimation=3838916066,r.repositionScroller=702693766,r.repositionScrollerWithoutAnimation=2778760596,r.resizeCache=569132212,r.resizeCacheWithoutAnimation=541818074,r.resizeScroller=2385100972,r.resizeScrollerWithoutAnimation=662384170,r.saveAndEditATranslatedCopy=2866603464,r.scrollDownArrow=3456074588,r.scrollEnd=135979168,r.scrollHome=3369669304,r.scrollLeftArrow=340039443,r.scrollPageDown=2180939724,r.scrollPageUp=1783913247,r.scrollRightArrow=4117423060,r.scrollUpArrow=3073381345,r.selectFromScroll=1297807363,r.setCurrentPage=3828858224,r.setZoomLevel=231667503,r.showContextMenuFromKey=3458683028,r.showContextMenuInDocument=2802067523,r.showFileEmbedInfo=1725824390,r.showPdfConvertAndEditDialog=3402718245,r.showPdfCopyAndEditDialog=4205256019,r.showReembedCode=2893474578,r.showSearchPane=428795035,r.slPageReady=2666100903,r.statusBarTest=4125937875,r.switchToEditMode=329275380,r.switchToUnifiedReadMode=1254572192,r.syncToPresenter=3349150556,r.toggleCommentPane=2281051331,r.toggleMenu=583433745,r.toggleSearchPane=976411380,r.toggleViewMode=2680748364,r.translateBackToOriginal=573791575,r.translateDocument=2612243365,r.updateCommentHighlight=3917526816,r.updateSearchHighlight=851844167,r.updateSelection=2195537549,r.updateZoomOnWindowResize=3850825085,r.xmlPageDownloaded=779228655,r.xmlPageDownloaded2=4224281129,r.xmlPageDownloaded3=1495397774,r.zoomToNextLevel=1281912385,Object(i.a)(r,"Commands",null,[])},function(e,t,n){"use strict";function i(e,t){if("number"==typeof e||"string"==typeof e){if(null==t||!Object.getType(t).implementsInterface(e))return null}else if(!e.isInstanceOfType(t))return null;return t}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(4),o=n(196),s=n(282),l=n(25),c=n(17),u=(n(9),n(54),n(200)),d=n(48),p=n(41),h=n(10);function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var g=function(e){var t,n,i,r,a;function o(t,n,i){return e.call(this,t,n,i,1)||this}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.create=function(e,t){return new o(e,p.EventHandlerArgs.getSourceElement(t),t)},i=o,(r=[{key:"commandKey",get:function(){var e=this.innerEvent.rawEvent;return!!e&&(h.a.isMac?e.metaKey:e.ctrlKey)}}])&&m(i.prototype,r),a&&m(i,a),o}(p.EventHandlerArgs);Object(i.a)(g,"KeyEventArgs",p.EventHandlerArgs,[]);var f=n(49);var v=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.add_onCtrlKeyDown=function(e){this.addHandler(i.onCtrlKeyDownEventKey,e)},r.remove_onCtrlKeyDown=function(e){this.removeHandler(i.onCtrlKeyDownEventKey,e)},r.add_onCtrlKeyUp=function(e){this.addHandler(i.onCtrlKeyUpEventKey,e)},r.remove_onCtrlKeyUp=function(e){this.removeHandler(i.onCtrlKeyUpEventKey,e)},i.instance=function(){return i._instance||(i._instance=new i)},i}(f.a);v.onCtrlKeyDownEventKey="OnCtrlKeyDown",v.onCtrlKeyUpEventKey="OnCtrlKeyUp",v._instance=null,Object(i.a)(v,"PressCtrlKeyEvent",f.a,[]);var _=n(101);function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var b=function(){function e(){this.keyCode=0}var t,n,i;return e.getAnInstanceWithResolvedDependencies=function(){return new _.a((function(){return new e}))},t=e,i=[{key:"instance",get:function(){return e._instance.value}}],(n=null)&&y(t.prototype,n),i&&y(t,i),e}();b._instance=b.getAnInstanceWithResolvedDependencies(),Object(i.a)(b,"PressOnlyKeyArgs",null,[]);var S=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.add_onKeyCodeWasPressedOnly=function(e){this.addHandler(i.onKeyCodeWasPressedOnlyEventKey,e)},r.remove_onKeyCodeWasPressedOnly=function(e){this.removeHandler(i.onKeyCodeWasPressedOnlyEventKey,e)},i.instance=function(){return i._instance||(i._instance=new i)},i}(f.a);S.onKeyCodeWasPressedOnlyEventKey="OnKeyCodeWasPressedOnly",S._instance=null,Object(i.a)(S,"PressOnlyKeyEvent",f.a,[]);var C=n(60),A=n(50),I=n(16),w=n(13),T=n(3);function E(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function M(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"KeyInputManager",(function(){return P}));var P=function(e){var t,i;function p(t,n,i,r){var c;return(c=e.call(this)||this)._keyEvents=[a.EventNames.keyUp,a.EventNames.keyDown,a.EventNames.keyPress],c._keyDownValues=new o.a(s.a.get_default()),c._pressOnlyKeys=[l.a.vK_Ctrl,l.a.vK_RightCtrl,l.a.vK_Shift,l.a.vK_Alt,l.a.vK_ContextMenu],c._currentEventArgs=null,c._forwardKeyPressToKeyDown=!0,c._lastKeyDownReceived=-1,c._isAltRight=!1,c._eventHandlerManager=t,c._focusManager=n,c._supressEvents=!1,c._capturedHandler=null,c._pressOnlyKeyEvent=i,c._pressCtrlKeyEvent=r,c._lastKeyStroke=new Date,c._lastKeyStrokeTimestamp=I.a.getTickCount(),c}i=e,(t=p).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var m,f,_,y=p.prototype;return y.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(a.EventNames.get_keyEvents(),t.ownerDocument,2,Object(r.d)(this,this.onKeyEvent,"onKeyEvent"))},y.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t.ownerDocument,a.EventNames.get_keyEvents())},y.registerHandler=function(e,t,n){this.registerHandlerWithCaptureOption(e,t,n)},y.registerHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onKeyEvent,"onKeyEvent"),n,null,i)},y.registerHandlerForAllKeyEvents=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];for(var o,s=function(e){return!!Array.contains(i,e.innerEvent.keyCode)&&(e.eventName!==a.EventNames.keyUp||t(e))},l=E(this._keyEvents);!(o=l()).done;){var c=o.value;this.registerHandler(c,e,s)}return s},y.registerHandlerWithData=function(e,t,n,i){this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onKeyEvent,"onKeyEvent"),n,i)},y.registerHandlerWithDocument=function(e,t,n,i){void 0===i&&(i=null),this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onKeyEvent,"onKeyEvent"),n,i)},y.unregisterHandler=function(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n)},y.unregisterHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this._eventHandlerManager.unregisterHandler(e,t,n,i)},y.unregisterHandlerForAllKeyEvents=function(e,t){for(var n,i=E(this._keyEvents);!(n=i()).done;){var r=n.value;this.unregisterHandler(r,e,t)}},y.unregisterHandlerWithDocument=function(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)},y.capture=function(e,t){this._capturedHandler=new u.a(e,t)},y.releaseCapture=function(){this._capturedHandler=null},y.resume=function(){e.prototype.resume.call(this),this._forwardKeyPressToKeyDown=!0},y.fireKeyEvent=function(e,t,n,i){var r=1==(1&i),o=2==(2&i),s=4==(4&i),l=8==(8&i);if(t.createEvent){var c=t.createEvent("KeyboardEvent"),u="";switch(e){case a.EventNames.keyDown:u="keydown";break;case a.EventNames.keyUp:u="keyup";break;case a.EventNames.keyPress:u="keypress"}if(c.initKeyEvent)c.initKeyEvent(u,!0,!0,t.parentWindow,o,r,s,l,n,0);else if(c.initKeyboardEvent){for(var d=w.a.charCodeAt(w.a.toUpper(w.a.fromCharCode(n)),0),p=w.a.getHexString(d);p.length<4;)p="0"+p;p="U+"+p,c.initKeyboardEvent(u,!1,!0,t.defaultView,p,0,o,r,s,l,!1)}t.dispatchEvent(c)}else if(t.createEventObject){var h="";switch(e){case a.EventNames.keyDown:h="keydown";break;case a.EventNames.keyUp:h="keyup";break;case a.EventNames.keyPress:h="keypress"}var m=t.createEventObject();m.keyCode=n,m.altKey=r,m.ctrlKey=o,m.shiftKey=s,m.metaKey=l,t.body.fireEvent("on"+h,m)}},y.rerouteKeyEvent=function(e,t,n){this.onKeyEvent(t,n,e)},y.processKeyActions=function(e){if(C.a.instance.isYielding)return T.ULS.sendTraceTag(24699481,324,50,"Key event dropped."),!0;var t=this._focusManager.processInput(e);return 4!==t&&(c.a.cancelEvent(e),2!==t)},y.onKeyEvent=function(e,t,n){var i=this.onKeyEventInternal(e,t,n);return this._postEventCallback(),i},y.onKeyEventInternal=function(e,t,i){var r=n(24).FocusManager,o=n(1).AFrameworkApplication,s=!1;if(r.instance().tryGrabFocus(o.postmessageFocusId),h.a.isMac&&h.a.isFirefox)if(e===a.EventNames.keyDown)this._forwardKeyPressToKeyDown=!1,this._lastKeyDownReceived=i.keyCode;else if(e===a.EventNames.keyPress){if(this._forwardKeyPressToKeyDown&&!s){var l=i.keyCode;i.keyCode=this._lastKeyDownReceived,s=this.processKeyEvent(i,a.EventNames.keyDown,t),i.keyCode=l}this._forwardKeyPressToKeyDown=!0}if(e===a.EventNames.keyPress&&h.a.isFirefox&&(!(n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BypassNonPrintableKeysCheckForKeyPressEvent")&&!!window.event)&&p.getKeyCodeFromDomEvent(i)||i.altKey||i.ctrlKey||p.getFieldFromDomEvent(i,"metaKey")))return!1;return e===a.EventNames.keyDown&&h.a.isIPad&&(h.a.iPadOsVersion<=6||t===window.document)&&window.focus(),s||(s=this.processKeyEvent(i,e,t)),s},y.processKeyEvent=function(e,t,n){if(!this.isEnabled)return!1;if(this._supressEvents)return c.a.cancelEvent(e),!0;if(this._lastKeyStroke=new Date,this._lastKeyStrokeTimestamp=I.a.getTickCount(),c.a.ensureAppAwake(),this._capturedHandler)return this._currentEventArgs=g.create(t,e),this._capturedHandler.handler(this._currentEventArgs),c.a.cancelEvent(e),this._currentEventArgs=null,!0;var i=p.getBeforeKeyEventName(t);this._currentEventArgs=g.create(i,e);var r=this._eventHandlerManager.processEvent(i,n,this._currentEventArgs);return r?(this._currentEventArgs=null,!1):(t===a.EventNames.keyDown&&(this._keyDownValues.add(e.keyCode),r=this.processKeyActions(e),this.raiseKeyDownEvents(e)),t===a.EventNames.keyUp&&this.keyUpHandler(e),r||(this._currentEventArgs=g.create(t,e),r=this._eventHandlerManager.processEvent(t,n,this._currentEventArgs)),r&&c.a.cancelEvent(e),this._currentEventArgs=null,r)},y.raiseKeyDownEvents=function(e){e.keyCode===(h.a.isMac?l.a.vK_Meta:l.a.vK_Ctrl)&&this._pressCtrlKeyEvent.raiseEvent(v.onCtrlKeyDownEventKey)},y.keyUpHandler=function(e){var t=n(1).AFrameworkApplication;if(1===this._keyDownValues.get_count()&&Array.contains(this._pressOnlyKeys,e.keyCode))if(t.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordKeyCodeCheckPressOnlyKeySettings"),!p.keyCodeCheckPressOnlyKeyIsEnabled||this._keyDownValues.contains(e.keyCode)){var i=b.instance;i.keyCode=e.keyCode,this._pressOnlyKeyEvent.raiseEvent(S.onKeyCodeWasPressedOnlyEventKey,i)}else T.ULS.sendTraceTag(578318552,324,15,"_keyDownValues missing a key");this._keyDownValues=new o.a(s.a.get_default()),e.keyCode===(h.a.isMac?l.a.vK_Meta:l.a.vK_Ctrl)&&this._pressCtrlKeyEvent.raiseEvent(v.onCtrlKeyUpEventKey)},y.setAltRight=function(e){var t=p.getFieldFromDomEvent(e,"location");this._isAltRight=null==t||1!==t},y.handleAltGr=function(e,t){return(e||t)&&this._isAltRight?":G":":A"},p.getInstance=function(){var e=n(24).FocusManager;return new p(d.EventHandlerManager.instance,e.instance(),S.instance(),v.instance())},p.disposeInputManager=function(){A.a(p._instance),p._instance=null},p.isKeyEventName=function(e){return Array.contains(a.EventNames.get_keyEvents(),e)},p.isImeKeyPress=function(e){var t;return t=void 0===e.innerEvent.keyCode||null===e.innerEvent.keyCode?e.innerEvent.charCode:e.innerEvent.keyCode,w.a.isEastAsianChar(t)},p.getBeforeKeyEventName=function(e){switch(e){case a.EventNames.keyDown:return a.EventNames.beforeKeyDown;case a.EventNames.keyUp:return a.EventNames.beforeKeyUp;case a.EventNames.keyPress:return a.EventNames.beforeKeyPress;default:return e}},p.hashEvent=function(e){e.keyCode===l.a.vK_Alt&&p.instance.setAltRight(e);var t=e.keyCode!==l.a.vK_Ctrl&&e.ctrlKey,n=e.keyCode!==l.a.vK_Windows&&p.getFieldFromDomEvent(e,"metaKey"),i=void 0===e.keyCode||null===e.keyCode?l.a.VK_UNDEFINED:e.keyCode;return p.hash(i,e.altKey,t,e.shiftKey,n,!0)},p.hasKeyModifiers=function(e){if(e&&e.innerEvent.rawEvent){var t=e.innerEvent.rawEvent;return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey}return!1},p.hashKeyString=function(e){var t=e.indexOf(":"),n=(-1===t?e:e.substring(0,t)).toLowerCase();var i=l.a.fromString(n).toString()+(t>0?e.substr(t):"");return i=i.replace(":X",h.a.isMac?":M":":C")},p.hashKey=function(e,t){return p.hash(e,1==(1&t),2==(2&t),4==(4&t),8==(8&t),!1)},p.hash=function(e,t,n,i,r,a){var o=e.toString();return t&&(o+=a?p.handleAltGrHelper(n,r):":A"),i&&(o+=":S"),n&&(o+=":C"),r&&(o+=":M"),o},p.handleAltGrHelper=function(e,t){return p.instance.handleAltGr(e,t)},p.getKeyCodeFromDomEvent=function(e){return e?e.rawEvent?e.rawEvent.keyCode:e.keyCode:0},p.getFieldFromDomEvent=function(e,t){return e?e.rawEvent?e.rawEvent[t]:e[t]:null},m=p,_=[{key:"keyCodeCheckPressOnlyKeyIsEnabled",get:function(){var e=n(1).AFrameworkApplication;return null==p._keyCodeCheckPressOnlyKeyIsEnabled&&(p._keyCodeCheckPressOnlyKeyIsEnabled=!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("KeyCodeCheckPressOnlyKeyIsEnabled")),p._keyCodeCheckPressOnlyKeyIsEnabled}},{key:"commandKeyModifier",get:function(){return h.a.isMac?8:2}},{key:"instance",get:function(){return p._instance||(p._instance=p.getInstance()),p._instance}},{key:"usable",get:function(){return!!p._instance}}],(f=[{key:"lastKeyStroke",get:function(){return this._lastKeyStroke}},{key:"lastKeyStrokeTimestamp",get:function(){return this._lastKeyStrokeTimestamp}},{key:"currentKeyEvent",get:function(){return this._currentEventArgs}}])&&M(m.prototype,f),_&&M(m,_),p}(c.a);P._keyCodeCheckPressOnlyKeyIsEnabled=null,P._instance=null,Object(i.a)(P,"KeyInputManager",c.a,[12,13,4])},function(e,t,n){"use strict";var i=n(0),r=n(11),a=n(163),o=n(2);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(e,t,n,i,a){var o;if(this._instance=null,this._factoryBeingCalled=!1,this._futures=[],this._isSingleton=!1,this._container=e,this._registrationCache=t,this._factory=a,this._serviceName=i,this._registrationCache.storeRegistration(i,this),this._registrationCache.tryLookupFuture(i,Object(r.a)((function(){return o}),(function(e){return o=e})))&&this.linkFuture(o),this._isContainerTelemetryEnabled=n,this._isContainerTelemetryEnabled){var s=String.format(" [RG: {0} T: {1}]",i,this.getCurrentTime());this._container.logNewInstanceMetadata(s)}}var t,n,i,l=e.prototype;return l.as=function(e){var t=e;return this.storeInRegistrationCache(t)},l.asExtern=function(e){var t=e;return this.storeInRegistrationCache(t)},l.linkFuture=function(e){Array.add(this._futures,e)},l.singleInstance=function(){return this._isSingleton=!0,this},l.usingFactory=function(e){return this._factory=e,this},l.usingTypeResolver=function(e){return this.usingResolveCallback(Object(o.d)(e,e.createInstance,"createInstance"))},l.usingResolveCallback=function(e){var t=this;return this.usingFactory((function(){return e(t._container,!1)}))},l.internalCreate=function(){if(this.isSingleton){if(!this._instance){this._instance=this.createInstance();for(var e=0;e<this._futures.length;e++)this._futures[e].setInstance(this._instance)}return this._instance}return this.createInstance()},l.createInstance=function(){if(this._futures.length>0&&!this.isSingleton)throw a.b("Futures can only be used for singleton types");var e;if(!this._factory){var t=String.format("Type '{0}' does not have a factory function. Did you overwrite the default with with null?",this._serviceName);throw a.b(t)}if(this._factoryBeingCalled){var n=String.format("Type '{0}' contains a circular reference in the IoC container.",this._serviceName);throw a.b(n)}this._factoryBeingCalled=!0;try{e=this._factory()}finally{this._factoryBeingCalled=!1}if(this._isContainerTelemetryEnabled){var i=String.format(" [RS: {0} T: {1}]",this._serviceName,this.getCurrentTime());this._container.logNewInstanceMetadata(i)}return e},l.storeInRegistrationCache=function(e){var t;return this._registrationCache.storeRegistration(e,this),this._registrationCache.tryLookupFuture(e,Object(r.a)((function(){return t}),(function(e){return t=e})))&&this.linkFuture(t),this},l.getCurrentTime=function(){return(new Date).toISOString()},t=e,(n=[{key:"isSingleton",get:function(){return this._isSingleton}},{key:"instance",get:function(){return this._instance}}])&&s(t.prototype,n),i&&s(t,i),e}();Object(i.a)(l,"ContainerRegistration",null,[51,52]);n(112);var c=function(){function e(e){void 0===e&&(e=null),this._cache={},this._registrations=void 0,this._allowedDuplicateRegistrationsFunc_DEBUG=null,this._futureCache={}}var t=e.prototype;return t.storeFuture=function(e,t){this._futureCache[e]=t},t.storeRegistration=function(e,t){var n=e;this._cache[n]=t},t.tryLookupFuture=function(e,t){var n=e;return n in this._futureCache?(t.val=this._futureCache[n],!0):(t.val=null,!1)},t.tryLookupRegistration=function(e,t){return e in this._cache?(t.val=this._cache[e],!0):(t.val=null,!1)},e}();Object(i.a)(c,"ContainerRegistrationCache",null,[]);var u=n(165),d=n(170);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(){function e(){this._tcs=null}var t,n,i;return e.prototype.execute=function(e){this.taskCompletionSource.get_task().CWOo((function(t,n){e(t.get_result())}),u.a.get_none(),8)},e.create=function(){return new e},t=e,(n=[{key:"instance",get:function(){return this._tcs&&this._tcs.get_task().get_isCompleted()?this._tcs.get_task().get_result():null},set:function(e){this.taskCompletionSource.setResult(e)}},{key:"taskCompletionSource",get:function(){return this._tcs||(this._tcs=new d.a)}}])&&p(t.prototype,n),i&&p(t,i),e}();function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(h,"Future",null,[74]);var g=function(){function e(e,t){var n;if(this._future=h.create(),t.tryLookupRegistration(e,Object(r.a)((function(){return n}),(function(e){return n=e})))){if(!n.isSingleton)throw a.b("Futures can only be used for singleton types");n.instance?this.setInstance(n.instance):n.linkFuture(this)}}var t,n,i;return e.prototype.setInstance=function(e){this.future.instance=e},t=e,(n=[{key:"future",get:function(){return this._future}}])&&m(t.prototype,n),i&&m(t,i),e}();Object(i.a)(g,"FutureRegistration",null,[50]);var f=n(101);function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return _}));var _=function(){function e(){var e=this;this.allowedDuplicateRegistrations_DEBUG=null,this._containerRegistrationLog="",this._registractionCache=new c((function(){return e.allowedDuplicateRegistrations_DEBUG})),new c,this._isContainerTelemetryEnabled=this.isContaninerTelemetryEnabled()}var t,n,i,o=e.prototype;return o.isContaninerTelemetryEnabled=function(){try{return window.g_isContainerTelemetryEnabled}catch(e){return!1}},o.register=function(e,t){var n=t;return new l(this,this._registractionCache,this._isContainerTelemetryEnabled,n,(function(){return new e}))},o.registerUsingResolveCallback=function(e,t,n){return this.register(e,n).usingResolveCallback(t)},o.registerUsingTypeResolver=function(e,t,n){return this.register(e,n).usingTypeResolver(t)},o.resolve=function(e){var t,n=e;if(!this._registractionCache.tryLookupRegistration(n,Object(r.a)((function(){return t}),(function(e){return t=e})))){var i=String.format("Type '{0}' is not registered in the IoC container. Make sure you have registered the type.",n);throw a.a(i,"T")}return t.internalCreate()},o.resolveFuture=function(e){var t,n=e;return this._registractionCache.tryLookupFuture(n,Object(r.a)((function(){return t}),(function(e){return t=e})))||(t=new g(n,this._registractionCache),this._registractionCache.storeFuture(n,t)),t.future},o.resolveLazy=function(e){var t=this;return new f.a((function(){return t.resolve(e)}))},o.tryResolve=function(e){var t,n=e;return this._registractionCache.tryLookupRegistration(n,Object(r.a)((function(){return t}),(function(e){return t=e})))?t.internalCreate():null},o.getContainerLog=function(){return this._containerRegistrationLog},o.logNewInstanceMetadata=function(e){this._isContainerTelemetryEnabled&&(this._containerRegistrationLog+=e)},o.testCouldResolve=function(e){var t=e;return this.isTypeNameRegistered(t)},o.testCouldResolveType=function(e){var t=e.getName();return this.isTypeNameRegistered(t)},o.isTypeNameRegistered=function(e){var t;return this._registractionCache.tryLookupRegistration(e,Object(r.a)((function(){return t}),(function(e){return t=e})))},e.getAnInstance=function(){return new f.a((function(){return new e}))},t=e,i=[{key:"instance",get:function(){return e._instance.value}}],(n=null)&&v(t.prototype,n),i&&v(t,i),e}();_._instance=_.getAnInstance(),Object(i.a)(_,"Container",null,[33])},function(e,t,n){"use strict";n.r(t),n.d(t,"DomUtils",(function(){return d}));var i=n(0),r=(n(9),n(54),n(153)),a=n(10),o=n(13),s=n(63);function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(){function e(){}var t,n,i;return e.ensureCSSClassOnElement=function(e,t){return!Sys.UI.DomElement.containsCssClass(e,t)&&(Sys.UI.DomElement.addCssClass(e,t),!0)},e.removeCSSClassFromElement=function(e,t){return!!Sys.UI.DomElement.containsCssClass(e,t)&&(Sys.UI.DomElement.removeCssClass(e,t),!0)},e.getChildById=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&n.id!==t;)n=n.nextSibling;return n},e.getChildByIdEndsWith=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&!r.a(n.id,t,0);)n=n.nextSibling;return n},e.addAsFirstChild=function(e,t){if(e&&t){var n=e.firstChild;n?e.insertBefore(t,n):e.appendChild(t)}},e.removeElement=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},e.getLeafElements=function(t){var n=new s.a;if(t){var i=t.children;if(!i||!i.length)return n.add(t),n;for(var r=0,a=i.length;r<a;r++)n.addRange(e.getLeafElements(i[r]))}return n},e.getAllElements=function(t,n){var i=new s.a;if(!t)return i;for(var r=t.childNodes.length,a=0;a<r;++a)i.addRange(e.getAllElements(t.childNodes[a],n));return(n||1===t.nodeType)&&i.add(t),i},e.getAllElementsCount=function(t,n){var i=0;if(!t)return i;for(var r=t.childNodes.length,a=0;a<r;++a)i+=e.getAllElementsCount(t.childNodes[a],n);return(n||1===t.nodeType)&&i++,i},e.getFirstChildByTagName=function(e,t){if(!e||!t)return null;t=o.a.toUpper(t);for(var n=0,i=e.childNodes.length;n<i;n++){var r=e.childNodes[n];if(1===r.nodeType&&o.a.toUpper(r.tagName)===t)return r}return null},e.clearElement=function(e){if(e)try{for(;e.hasChildNodes();)e.removeChild(e.firstChild)}catch(e){0}},e.clearElementRecursively=function(t){if(t)for(;t.firstChild;)e.clearElementRecursively(t.firstChild),t.removeChild(t.firstChild)},e.isDescendantOf=function(e,t){return!!e&&e.contains(t)},e.setElementText=function(e,t){e&&(e.innerText="",t&&t.length>0&&(1===e.childNodes.length?e.replaceChild(e.ownerDocument.createTextNode(t),e.firstChild):e.appendChild(e.ownerDocument.createTextNode(t))))},e.getDOMElementClassName=function(e){return e?e.className&&Object.getType(e.className)===String?e.className:1===e.nodeType&&e.getAttribute("class")?e.getAttribute("class").toString():"":""},e.getFirstNodeValueByTagNameOrDefault=function(e,t){if(!e||!t)return null;var n=e.getElementsByTagName(t);return n&&n[0]&&n[0].firstChild?n[0].firstChild.nodeValue:null},e.domTagToString=function(e){var t=null;switch(e){case 1:t="a";break;case 2:t="button";break;case 10:t="canvas";break;case 8:t="div";break;case 6:t="iframe";break;case 3:t="input";break;case 11:t="object";break;case 13:t="p";break;case 7:t="param";break;case 4:t="select";break;case 12:t="span";break;case 15:t="td";break;case 14:t="th";break;case 5:t="textarea"}return t},e.createElementWithInnerTextSafe=function(t,n){var i=null,r=e.domTagToString(t);return r&&((i=document.createElement(r)).innerText=n),i},e.createElementWithInnerText=function(e,t){var n=document.createElement(e);return n.innerText=t,n},e.getAncestorContainingCssClass=function(e,t){if(!e||!t)return null;for(var n=e.parentNode;n&&!Sys.UI.DomElement.containsCssClass(n,t);)n=n.parentNode;return n},e.getAncestorByClassName=function(e,t){if(!e||!t)return null;for(var n=e.parentNode;n&&n.className!==t;)n=n.parentNode;return n},e.getFirstAncestorElement=function(e){if(!e)return null;for(var t=e;t&&1!==t.nodeType;)t=t.parentNode;return t},e.getChildByClassNameNonExclusive=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&!Sys.UI.DomElement.containsCssClass(n,t);)n=n.nextSibling;return n},e.getChildByClassName=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&n.className!==t;)n=n.nextSibling;return n},e.getChildByClassNameStartWith=function(t,n){if(!t||!n)return null;for(var i=t.firstChild;i&&!r.b(e.getDOMElementClassName(i),n,0);)i=i.nextSibling;return i},e.getChildByClassNameStartWithRecursively=function(t,n){if(!t||!n)return null;var i=e.getChildByClassNameStartWith(t,n);if(!i)for(var r=0;r<t.childNodes.length&&!i;r++)i=e.getChildByClassNameStartWithRecursively(t.childNodes[r],n);return i},e.getChildByIdStartWith=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&!r.b(n.id,t,0);)n=n.nextSibling;return n},e.getChildrenByClassName=function(e,t){for(var n=e.firstChild,i=new s.a;n;)n.className&&n.className.trim()===t&&i.add(n),n=n.nextSibling;return i.toArray()},e.parseCssSize=function(e){return!e||r.a(e,"%",0)||isNaN(parseInt(e))?0:parseInt(e)},e.parseCssSizeDouble=function(e){return!e||r.a(e,"%",0)||isNaN(parseFloat(e))?0:parseFloat(e)},e.setElementCssFloat=function(t,n){if(t)for(var i,r=l(e._cssFloatValues);!(i=r()).done;){if(i.value===n){var a=String.format("float: {0};",n),o=e._cssFloatRegex.exec(t.style.cssText);if(o){var s=o.toString();s!==a&&(t.style.cssText=t.style.cssText.replace(s,a));break}t.style.cssText+=a;break}}},e.setElementStyleTopInPixels=function(t,n){if(e.isValidElement(t)){var i=n+"px";t.style.top=i}},e.setElementStyleLeftInPixels=function(t,n){if(e.isValidElement(t)){var i=n+"px";t.style.left=i}},e.setElementStyleWidthInPixels=function(t,n){if(e.isValidElement(t)){var i=n+"px";t.style.width=i}},e.setElementStyleHeightInPixels=function(t,n){if(e.isValidElement(t)){var i=n+"px";t.style.height=i}},e.getElementStyleTopInPixels=function(t){return e.isValidElement(t)?e.getPixelSize(t.style.top):0},e.getElementStyleLeftInPixels=function(t){return e.isValidElement(t)?e.getPixelSize(t.style.left):0},e.getElementStyleWidthInPixels=function(t){return e.isValidElement(t)?e.getPixelSize(t.style.width):0},e.getElementStyleHeightInPixels=function(t){return e.isValidElement(t)?e.getPixelSize(t.style.height):0},e.getPixelSize=function(e){if(e&&-1!==e.indexOf("px")){var t=parseInt(o.a.substring(e,0,e.indexOf("px")));if(!isNaN(t))return t}return 0},e.getChildrenByTagName=function(e,t){t=o.a.toUpper(t);for(var n=new s.a,i=0,r=e.childNodes.length;i<r;i++){var a=e.childNodes[i];1===a.nodeType&&o.a.toUpper(a.tagName)===t&&n.add(a)}return n.toArray()},e.copyChildNodes=function(t,n,i){void 0===i&&(i=!1),e.clearElement(n);var r=t.childNodes;if(r.length>0){for(var a=document.createDocumentFragment(),o=0,s=r.length;o<s;o++){var l=r[o];(i||"IFRAME"!==l.tagName)&&a.appendChild(l.cloneNode(!0))}n.appendChild(a)}},e.clearElementHtml=function(e){e&&""!==e.innerHTML&&(e.innerHTML="")},e.elementAttached=function(t){return!e.rootElementIfNotAttached(t)},e.getRootElementIfNotAttached=function(t){return e.rootElementIfNotAttached(t)},e.getTag=function(t){var n=e.tagStrings[o.a.toLower(t.tagName||"")];return null!=n?n:0},e.isInDocument=function(e){return!!e&&!!e.parentNode&&!!e.parentNode.ownerDocument},e.isValidElement=function(e){return!!e&&!!e.ownerDocument},e.getElementText=function(t){if(!t)return"";if(3===t.nodeType){t.nodeValue;return t.nodeValue}for(var n="",i=0,r=t.childNodes.length;i<r;i++)n+=e.getElementText(t.childNodes[i]);return n},e.getElementTextLength=function(t,n){if(void 0===n&&(n=!1),n)return 1;if(3===t.nodeType){t.nodeValue;return t.nodeValue.length}for(var i=0,r=0,a=t.childNodes.length;r<a;r++)i+=e.getElementTextLength(t.childNodes[r]);return i},e.isListTag=function(e){if(!e)return!1;var t=e.tagName.toLocaleLowerCase();return"ol"===t||"ul"===t},e.isEditable=function(e){return!(!e||a.a.isInternetExplorer11Up&&"undefined"==typeof e.getAttribute)&&(("INPUT"===e.tagName&&"button"!==e.getAttribute("type")&&"image"!==e.getAttribute("type")&&"checkbox"!==e.getAttribute("type")||"SELECT"===e.tagName||"true"===e.getAttribute("contenteditable")||"TEXTAREA"===e.tagName)&&!e.disabled)},e.rootElementIfNotAttached=function(t){return 9===t.nodeType||1===t.nodeType&&"HTML"===r.c(t.tagName)?null:t.parentNode&&e.elementHasChild(t.parentNode,t)?e.rootElementIfNotAttached(t.parentNode):t},e.elementHasChild=function(e,t){for(var n=0,i=e.childNodes.length;n<i;n++)if(e.childNodes[n]===t)return!0;return!1},e.getViewPortWidth=function(){return window.innerWidth},e.getViewPortHeight=function(){return window.innerHeight},e.setFormattedTextToPlaceholders=function(e,t,n,i){for(void 0===i&&(i=null);e.hasChildNodes();)e.removeChild(e.firstChild);if(n&&"undefined"!=typeof n&&n.length){var r=new RegExp("{(\\d+)}|(?:{{)+|(?:(?!{\\d+}|(?:{{)+).)+","g");t.replace(r,(function(t,r){var a;if(r){var o,s=parseInt(r);o=isNaN(s)||s>=n.length?t:n[s]||"",i?a=i(o):((a=document.createElement("span")).setAttribute("dir","auto"),a.innerText=o)}else a=document.createTextNode(t);return e.appendChild(a),null}))}else e.innerText=t},t=e,i=[{key:"tagStrings",get:function(){return e._tagStrings||(e._tagStrings={},e._tagStrings.a=1,e._tagStrings.button=2,e._tagStrings.input=3,e._tagStrings.select=4,e._tagStrings.textarea=5,e._tagStrings.iframe=6,e._tagStrings.param=7,e._tagStrings.body=9,e._tagStrings.canvas=10),e._tagStrings}}],(n=null)&&u(t.prototype,n),i&&u(t,i),e}();d._cssFloatValues=["left","right","none","initial","inherit"],d._cssFloatRegex=new RegExp("float: *[A-Za-z]+;"),d._tagStrings=null,Object(i.a)(d,"DomUtils",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(11),o=n(1),s=(n(9),n(7)),l=n(335),c=n(64);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(){function e(){this._controlComponentDomCollection={}}var t,n,i,r=e.prototype;return r.addDomObject=function(e){this._controlComponentDomCollection[e.displayMode]=e},r.forEach=function(e){var t=this._controlComponentDomCollection;for(var n in t){e({key:n,value:t[n]}.value)}},r.get_item=function(e){return this._controlComponentDomCollection[e]},r.clear=function(){this._controlComponentDomCollection={}},t=e,(n=[{key:"small",get:function(){return this._controlComponentDomCollection.Small||this._controlComponentDomCollection.Small14}},{key:"medium",get:function(){return this._controlComponentDomCollection.Medium||this._controlComponentDomCollection.Medium14}},{key:"large",get:function(){return this._controlComponentDomCollection.Large||this._controlComponentDomCollection.FloatieLarge}},{key:"smallMenu",get:function(){return this._controlComponentDomCollection.Menu||this._controlComponentDomCollection.Menu16||this._controlComponentDomCollection.MenuTellMe}},{key:"largeMenu",get:function(){return this._controlComponentDomCollection.Menu32||this._controlComponentDomCollection.Menu48}}])&&u(t.prototype,n),i&&u(t,i),e}();Object(i.a)(d,"ControlComponentDomCache",null,[]);var p=n(180),h=n(123),m=n(87),g=n(82),f=n(162),v=n(5),_=n(45),y=n(6);function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"Control",(function(){return S}));var S=function(){function e(e,t,n){this._components=[],this._enabledHasBeenSet=!1,this._isForceSetEnabledState=!1,this.labelText=null,this.tooltip=null,this.parentKeytipsIds=null,this.parentKeytipsKeys=null,this.behavior=null,this.inMenu=!1,this._stateProperties=null,this._commandProperties=null,this._activeComponentWhenVisible=null,this._parentMenu=null,this._parentMenuComputed=!1,this._parentGrid=null,this._parentGridComputed=!1,this._disposed=!1,this.enabledInternal=!1,this._root=e,this._id=t,this._properties=n,this._displayModes=",",this._controlComponentDomCache=new d,this._visible=!y.a.isFalse(n.Visible),this.stateProperties[_.a.sourceControlId]=t,e.registerControl(this),this.connectControlBehaviorIfAvailable()}var t,i,u,S=e.prototype;return S.getMenuItemId=function(){return this.controlProperties.MenuItemId},S.getCommandValueId=function(){return v.b(this.controlProperties.CommandValueId)?this.getMenuItemId():this.controlProperties.CommandValueId},S.getTextValue=function(){return""},S.connectControlBehaviorIfAvailable=function(){if(!this.behavior){var e=l.a.controlBehaviorFactory;e&&(this.behavior=e.getBehaviorForControl(this))}},S.ensureValidDisplayMode=function(e){if(-1===this._displayModes.indexOf(","+e+","))throw Error.create("The display mode with name: "+e+" is not valid for this control with id: "+this.id)},S.refreshDOMElements=function(){this.onStateChanged(),this.enabled||this.onEnabledChanged(!1)},S.onStateChanged=function(){},S.createDOMElementForDisplayMode=function(e,t){this.ensureValidDisplayMode(e);var n=this.createComponentDomForDisplayMode(e);return this.controlComponentDomCache.addDomObject(n),this.behavior&&this.behavior.attachEvents(n),t&&t.hasKeytip&&this.ensureKeytipForControl(t,n.elmControl),n.elmControl},S.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,t,this.parentKeytipsIds,this.parentKeytipsKeys)},S.getDOMElementForDisplayMode=function(e,t){this.ensureValidDisplayMode(e);var n=this.controlComponentDomCache.get_item(e);if(n&&n.elmControl)return n.elmControl;var i=this.createDOMElementForDisplayMode(e,t);return v.b(i.id)&&(i.id=this.id+"-"+e),this.refreshDOMElements(),i},S.createComponentForDisplayMode=function(e){var t=this.createComponentForDisplayModeInternal(e);return Array.add(this._components,t),t},S.createComponentForDisplayModeInternal=function(e){return c.a.isDisplayModeMenu(e)?this.root.createMenuItem(this.getComponentId(e),e,this):this.root.createControlComponent(this.getComponentId(e),e,this)},S.getComponentId=function(e){return this.id+"-"+e+this.root.getUniqueNumber()},S.dispose=function(){this.disposed||(this.releaseEventHandlers(),this._root=null,this._components=null,this._displayModes=null,this.controlComponentDomCache.clear(),this._disposed=!0)},S.releaseEventHandlers=function(){this.controlComponentDomCache.forEach((function(e){y.a.releaseEventHandlersRecursively(e.elmControl)}))},S.addDisplayMode=function(e){-1===this._displayModes.indexOf(","+e+",")&&(this._displayModes+=e+",")},S.ensureCorrectChildType=function(e){throw Error.create("Child Components may not be added to this type of ControlComponent.")},S.constructClonedControlForMenu=function(e,t){return this.constructClonedControl(e,t)},S.clone=function(t,n){void 0===n&&(n=null);var i=e.generateCloneProperties(this._properties,n);return this.constructClonedControl(t,i)},S.cloneForMenu=function(t,n){void 0===n&&(n=null);var i=e.generateCloneProperties(this._properties,n);return this.constructClonedControlForMenu(t,i)},S.onEnabledChanged=function(t){var n=this;this.controlComponentDomCache.forEach((function(i){y.a.setEnabledOnElement(i.elmControl,t,n.controlType===e.labelControlType,n.isEditable)}))},S.onVisibleChanged=function(e){if(12===this.root.rootType&&this.displayedComponent)this.displayedComponent.elementInternal.style.display=e?"inline-block":"none";else for(var t=this._components.length,n=0;n<t;++n){var i=this._components[n];i.visible=e,i.onDirtyingChange()}},S.onMenuClosed=function(){this.behavior&&this.behavior.onMenuClosed()},S.doDefaultAction=function(e,t,n){this.behavior&&this.behavior.doDefaultAction(e,t,n)},S.doDefaultActionPublic=function(e,t,n){this.doDefaultAction(e,t,n)},S.onKeyDown=function(e){return!!this.behavior&&this.behavior.onKeyDown(e)},S.onKeyUp=function(e){return!!this.behavior&&this.behavior.onKeyUp(e)},S.onPointerDown=function(e){return!!this.behavior&&this.behavior.onPointerDown(e)},S.onModalBodyPointerDown=function(e){return!!this.behavior&&this.behavior.onModalBodyPointerDown(e)},S.onModalBodyPointerUp=function(e){return!!this.behavior&&this.behavior.onModalBodyPointerUp(e)},S.onModalBodyPointerMove=function(e){return!!this.behavior&&this.behavior.onModalBodyPointerMove(e)},S.onModalBodyPointerOut=function(e){return!!this.behavior&&this.behavior.onModalBodyPointerOut(e)},S.onModalBodyClick=function(e){return!!this.behavior&&this.behavior.onModalBodyClick(e)},S.onModalBodyMouseWheel=function(e){return!!this.behavior&&this.behavior.onModalBodyMouseWheel(e)},S.deactivateElement=function(e){return!!this.behavior&&this.behavior.deactivateElement(e)},S.forceSetEnabledState=function(e){this._isForceSetEnabledState=!0;var t=this.enabled;this.enabledInternal=e,t!==e&&this.onEnabledChanged(e)},S.setEnabledAndForceUpdate=function(e){this.enabledInternal=e,this.onEnabledChanged(e)},S.pollForStateAndUpdate=function(){this.behavior?(this.enabled=!0,this.behavior.pollForStateAndUpdate()):this.enabled=!1},S.pollForStateAndUpdateInternal=function(e,t,n){return this.behavior?this.behavior.pollForStateAndUpdateInternal(e,t,n):0},S.ensureBehaviorAttachedIfAvailable=function(){if(!this.behavior){this.connectControlBehaviorIfAvailable();var e=this.behavior;e&&(this.controlComponentDomCache.forEach(Object(r.d)(e,e.attachEvents,"attachEvents")),e.initialize())}},S.focusNext=function(e){return!!this.behavior&&this.behavior.focusNext(e)},S.getDisplayedComponentElement=function(){var e=this.displayedComponent;return v.c(e)?null:e.elementInternal},S.setFocusOnControl=function(){return!!this.behavior&&this.behavior.setFocusOnControl()},S.commitPendingChange=function(){},S.isStandardMenuItem=function(){return Object(r.c)(g.a,this.displayedComponent)&&!Object(r.c)(h.Jewel,this.root)},S.isMemberOfContextMenuDropDown=function(){return!!this.parentMenu&&this.parentMenu.isFloatieContextMenuDropDown},e.generateCloneProperties=function(e,t){var n={};for(var i in e){var r={key:i,value:e[i]};n[r.key]=r.value}for(var a in t){var o={key:a,value:t[a]};n[o.key]=o.value}return n},e.focusNextIndexInGrid=function(t,n,i,r){switch(r){case 0:return e.focusForwardIndex(t,i);case 1:return e.focusBackwardIndex(t,i);case 2:return e.focusLeftIndex(t,n,i);case 4:return e.focusRightIndex(t,n,i);case 5:return e.focusUpIndex(t,n,i);case 6:return e.focusDownIndex(t,n,i);default:return-1}},e.focusForwardIndex=function(e,t){var n=-1===e?0:e+1;return n<t?n:e},e.focusBackwardIndex=function(e,t){var n=-1===e?t-1:e-1;return n>=0?n:e},e.focusLeftIndex=function(e,t,n){var i;-1===e?i=n-1:i=e%t>0?e-1:Math.min(e+(t-1),n-1);return i},e.focusRightIndex=function(e,t,n){var i;if(-1===e)i=0;else{var r=e%t;i=r<t-1&&e<n-1?e+1:e-r}return i},e.focusUpIndex=function(e,t,n){var i;if(-1===e){var r=n%t;i=r?n-r:n-t}else i=e-t;return i>=0?i:e},e.focusDownIndex=function(e,t,n){var i=-1===e?0:e+t;return i<n?i:e},e.getControlSize=function(e){var t=6;switch(e){case"Large":case"LargeNoText":t=0;break;case"Large30":t=1;break;case"Large16":t=2;break;case"FloatieLarge":t=3;break;case"Medium20":t=5;break;case"Medium14":case"Small14":t=7;break;case"Small20":t=5;break;case"Small24":t=8;break;case"Menu20":t=5;break;case"Menu32":case"Initials":t=0;break;case"Menu48":t=4}return t},e.updateStyle=function(e,t,n,i,r){switch(e){case"Large":t.val="cui-ctl-large";break;case"LargeNoText":case"Large30":n.val=!1,t.val="cui-ctl-large";break;case"Large16":t.val="cui-ctl-medium";break;case"FloatieLarge":t.val="cui-ctl";break;case"Medium20":case"Medium":case"Medium14":t.val="cui-ctl-medium";break;case"MediumCompact":t.val="cui-ctl-medium cui-ctl-compact";break;case"Small":case"Small14":case"Small20":case"Small24":n.val=!1,t.val="cui-ctl";break;case"Menu":case"Menu16":case"MenuTellMe":i.val="Menu16"===e||"MenuTellMe"===e,t.val="cui-ctl-menu cui-ctl-menu16";break;case"Menu20":i.val=!0,t.val="cui-ctl-menu cui-ctl-menu20";break;case"Menu32":i.val=!0,t.val="cui-ctl-menu cui-ctl-menu32";break;case"Initials":i.val=!0,r.val=!0,t.val="cui-ctl-menu cui-ctl-menu32";break;case"Menu48":i.val=!0,t.val="cui-ctl-menu cui-ctl-menu48";break;case"Thin":n.val=!1,t.val="cui-ctl-thin";break;default:t.val="cui-ctl"}},e.setImageProperties=function(e,t,n,i,r,a,o){switch(e){case 0:i.val=t.Image32by32,r.val=t.Image32by32Class,a.val=5,o.val=n?"cui-ctl-iconContainer":"cui-ctl-largeIconContainer";break;case 1:i.val=t.Image30by30,r.val=t.Image30by30Class,a.val=14,o.val="cui-ctl-large30IconContainer";break;case 2:i.val=t.Image16by16,r.val=t.Image16by16Class,a.val=4,o.val="cui-ctl-large16IconContainer";break;case 3:i.val=t.Image24by24,r.val=t.Image24by24Class,a.val=12,o.val="cui-ctl-largeFloatieIconContainer";break;case 4:i.val=t.Image48by48,r.val=t.Image48by48Class,a.val=7;break;case 8:i.val=t.Image24by24,r.val=t.Image24by24Class,a.val=12,o.val="cui-ctl-iconContainer24";break;case 5:i.val=t.Image20by20,r.val=t.Image20by20Class,a.val=13,o.val="cui-ctl-iconContainer20";break;case 7:i.val=t.Image16by16,r.val=t.Image16by16Class,a.val=11,o.val="cui-ctl-iconContainer14";break;case 6:default:i.val=t.Image16by16,r.val=t.Image16by16Class,a.val=4}},e.createLabel=function(t,n,i,r,a,o,l){var c=e.createElementLabel(t);if(n){!i&&!r||3===i?(y.a.ensureCSSClassOnElement(c,"cui-ctl-largelabel"),y.a.setLargeControlText(c,a.val,o)):(o&&i&&4!==i&&(a.val+=" "),y.a.ensureCSSClassOnElement(c,"cui-ctl-mediumlabel"),2===i&&y.a.ensureCSSClassOnElement(c,"UISmallFont"),y.a.setControlText(c,a.val,t.LabelTextUserGeneratedPlaceholderReplacements),t.AriaLabel&&(c.setAttribute(s.a.ariaLabelAttribute,t.AriaLabel),c.setAttribute("id",e.elmLabelText+l.id)));var u=t.LabelCss;v.b(u)||(c.style.cssText=u)}else 8===i?y.a.ensureCSSClassOnElement(c,"cui-ctl-small24label"):y.a.ensureCSSClassOnElement(c,"cui-ctl-smalllabel");return c},e.createDescription=function(t,n,i,a,o){var s=y.a.createElement("span");s.className="cui-ctl-menulabel",s.appendChild(t);var l=n.Description;return o.val=y.a.createElement("span"),y.a.ensureCSSClassOnElement(o.val,"cui-btn-menu-description"),s.appendChild(o.val),o.val.style.display="block",v.c(l)?Object(r.c)(h.Jewel,a)||y.a.ensureCSSClassOnElement(t,"cui-ctl-mediumlabel-nodescription"):(o.val.innerText=l,n.AriaDescribedById&&(o.val.setAttribute("id",e.elmDescriptionText+i.id),o.val.setAttribute("aria-hidden","True")),Object(r.c)(h.Jewel,a)||y.a.ensureCSSClassOnElement(t,"UIFontBold"),v.c(i.id)||v.c(n.AriaDescribedByText)||s.appendChild(e.createHiddenElement("elmDescriptionPreText"+i.id,n.AriaDescribedByText)),v.c(n.AriaLabelledById)||v.c(n.AriaLabelledByText)||s.appendChild(e.createHiddenElement(n.AriaLabelledById,n.AriaLabelledByText))),s},e.createArrow=function(e,t,n){var i=null,r=y.a.createElement("img");return r.alt="",e?(i=y.a.createClusteredImageContainerNew(3,t.properties.ImageSideArrow,t.properties.ImageSideArrowClass,r,!1,!1),y.a.ensureCSSClassOnElement(i,"cui-fa-menu-arrow")):i=n.isVisualRefreshEnabled?y.a.createClusteredImageContainerNew(2,t.properties.ImageDownArrow8by8,t.properties.ImageDownArrow8by8Class,r,!0,!1):y.a.createClusteredImageContainerNew(1,t.properties.ImageDownArrow,t.properties.ImageDownArrowClass,r,!0,!1),i},e.createStandardControlDOMElement=function(t,n,i,r,o,s,l,u,d){var p=!1;"MenuTellMeExtended"===i&&(i="MenuTellMe",p=!0),"Menu16DescriptionEnabled"===i&&(i="Menu16",p=!0);var h=r.LabelText||"";""===h&&"MenuTellMe"===i&&(h=r.LabelText=r.Alt||"");var m=c.a.isDisplayModeMenu(i);t.inMenu=m;var g=!0,f=e.getControlSize(i),_=!1,b=!1,S=null;e.updateStyle(i,Object(a.a)((function(){return S}),(function(e){return S=e})),Object(a.a)((function(){return g}),(function(e){return g=e})),Object(a.a)((function(){return _}),(function(e){return _=e})),Object(a.a)((function(){return b}),(function(e){return b=e})));var C=e.createOuterElement(S,t,!v.c(r.Description));n.supportsEmphasizedControls&&y.a.isTrue(r.IsEmphasized)&&y.a.ensureCSSClassOnElement(C,"cui-emphasized");var A=r.Alt;v.b(A)&&(A=h),g&&A===h||(C.title=A);var I=null,w=null,T=null,E=null,k=null,M=0,P="cui-ctl-iconContainer";e.setImageProperties(f,r,m,Object(a.a)((function(){return E}),(function(e){return E=e})),Object(a.a)((function(){return k}),(function(e){return k=e})),Object(a.a)((function(){return M}),(function(e){return M=e})),Object(a.a)((function(){return P}),(function(e){return P=e})));var F=!v.b(E);if(b)w=y.a.createElement("div"),y.a.ensureCSSClassOnElement(w,"cui-ctl-initials"),P="cui-ctl-initials",w.innerText="KB";else if(F||_){(I=y.a.createElement("img")).alt="";var D=y.a.createClusteredImageContainerNew(M,E,k,I,!0,!1);(w=y.a.createElement("span")).className=P,w.appendChild(D)}var O=null;(g||o)&&(O=e.createLabel(r,g,f,m,Object(a.a)((function(){return h}),(function(e){return h=e})),o,t));var R=null;((!f||4===f)&&m||p&&!v.b(r.Description))&&(y.a.ensureCSSClassOnElement(O,"cui-btn-title"),R=e.createDescription(O,r,t,n,Object(a.a)((function(){return T}),(function(e){return T=e}))));var x=null;return o&&(x=e.createArrow(m,n,t)),v.c(w)||C.appendChild(w),v.c(R)?v.c(O)||C.appendChild(O):C.appendChild(R),v.c(x)||(m?C.appendChild(x):3===f&&!v.c(w)&&o?w.appendChild(x):v.c(R)?O.appendChild(x):R.appendChild(x)),s.val=O,l.val=I,u.val=T,d.val=w,C},e.createElementLabel=function(e){return e.hasOwnProperty("For")?y.a.createElement("label"):y.a.createElement("span")},e.createOuterElement=function(t,n,i){var r;return void 0===i&&(i=!1),r=n.controlType===e.labelControlType?y.a.createBlockSpan():y.a.createNoOpLink(),y.a.ensureCSSClassOnElement(r,t),r.setAttribute("mscui:controltype",n.controlType),"1959943459"===n.controlProperties.Command||"2155708348"===n.controlProperties.Command?r.setAttribute(s.a.ariaRoleAttribute,s.a.ariaLinkRole):n.controlType!==e.labelControlType&&r.setAttribute(s.a.ariaRoleAttribute,n.ariaRole),i&&r.setAttribute(s.a.ariaDescribedByAttribute,e.elmDescriptionPreText+n.id+" "+e.elmDescriptionText+n.id),r},e.createHiddenElement=function(e,t){var n=y.a.createElement("span");return y.a.ensureCSSClassOnElement(n,"cui-btn-menu-"+e),n.innerText=t,t&&(n.setAttribute("id",e),n.setAttribute("aria-hidden","True"),n.setAttribute("hidden","True")),n},e.hasTextSpace=function(e){switch(e){case"LargeNoText":case"Large30":case"Small":case"Small14":case"Small20":case"Small24":case"Thin":return!1}return!0},t=e,(i=[{key:"id",get:function(){return this._id}},{key:"needsAKeytip",get:function(){return!1}},{key:"controlComponentDomCache",get:function(){return this._controlComponentDomCache}},{key:"isVisualRefreshEnabled",get:function(){return!!o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled}},{key:"controlProperties",get:function(){return this._properties}},{key:"stateProperties",get:function(){return v.c(this._stateProperties)&&(this._stateProperties={}),this._stateProperties}},{key:"commandProperties",get:function(){return v.c(this._commandProperties)&&(this._commandProperties={}),this._commandProperties}},{key:"isDefinitive",get:function(){return y.a.isTrue(this.controlProperties.IsDefinitive)}},{key:"shouldIgnoreTitle",get:function(){return y.a.isFalse(this.controlProperties.ShouldSetTitle)}},{key:"templateAlias",get:function(){return this.controlProperties.TemplateAlias}},{key:"ariaRole",get:function(){return this.inMenu?s.a.ariaMenuItemRole:s.a.ariaButtonRole}},{key:"components",get:function(){return this._components}},{key:"root",get:function(){return this._root}},{key:"displayedComponent",get:function(){if(!this._components)return null;for(var e=this._components.length,t=0;t<e;t++){var n=this._components[t];if(n.visibleInDOM)return n}return null}},{key:"displayMode",get:function(){var e=this.displayedComponent;return e?e.displayMode:null}},{key:"activeComponentWhenVisible",get:function(){return this._activeComponentWhenVisible||(this._components&&this._components.length>0?this._components[0]:null)},set:function(e){this._activeComponentWhenVisible=e}},{key:"parentMenu",get:function(){if(!this._parentMenuComputed){var e=this.displayedComponent;Object(r.c)(g.a,e)&&(e=e.parent,Object(r.c)(p.a,e)&&(e=e.parent),Object(r.c)(f.a,e)&&(e=e.parent,Object(r.c)(m.Menu,e)&&(this._parentMenu=e))),this._parentMenuComputed=!0}return this._parentMenu}},{key:"parentGrid",get:function(){var e=n(228).ColorPicker;if(!this._parentGridComputed){var t=this.displayedComponent;if(Object(r.c)(g.a,t)){var i=t,a=!1;Object(r.c)(e,i.control)&&(a=!0),!a&&Object(r.c)(101,i.control)&&(a=!0),a||(t=t.parent,Object(r.c)(p.a,t)&&(a=!0)),a&&(this._parentGrid=t),this._parentGridComputed=!0}}return this._parentGrid}},{key:"activatesOnPress",get:function(){return!1}},{key:"enabled",get:function(){return this.enabledInternal},set:function(e){this._isForceSetEnabledState||this.enabledInternal===e&&this._enabledHasBeenSet||(this.enabledInternal=e,this._enabledHasBeenSet=!0,this.onEnabledChanged(e))}},{key:"visible",get:function(){return this._visible},set:function(e){var t=e;if(!t&&!this.root.supportsInvisibleControls)throw Error.create("This root does not support dynamically showing or hiding controls.");t!==this._visible&&(this._visible=t,this.stateProperties[_.a.visible]=t,this.onVisibleChanged(t))}},{key:"disposed",get:function(){return this._disposed}},{key:"focusableElement",get:function(){return null}},{key:"isEditable",get:function(){return!1}}])&&b(t.prototype,i),u&&b(t,u),e}();S.buttonControlType="Button",S.colorPickerControlType="ColorPicker",S.comboBoxControlType="ComboBox",S.contextMenuControlType="ContextMenuControl",S.contextMenuLauncherControlType="ContextMenuLauncher",S.dialogMenuLauncherControlType="DialogMenuLauncher",S.fileMenuButtonControlType="FileMenuButton",S.flyoutAnchorControlType="FlyoutAnchor",S.galleryButtonControlType="GalleryButton",S.insertTableControlType="InsertTable",S.jewelMenuLauncherControlType="JewelMenuLauncher",S.labelControlType="Label",S.placeholderControlType="Placeholder",S.searchBoxControlType="SearchBox",S.separatorControlType="Separator",S.splitButtonControlType="SplitButton",S.statefulColorFlyoutAnchorControlType="StatefulColorFlyoutAnchor",S.statefulColorSplitButtonControlType="StatefulColorSplitButton",S.statefulImageSplitButtonControlType="StatefulImageSplitButton",S.sliderControlType="Slider",S.spinnerControlType="Spinner",S.textBoxControlType="TextBox",S.toggleButtonControlType="ToggleButton",S.dropDownControlType="DropDown",S.elmDescriptionPreText="elmDescriptionPreText",S.elmDescriptionText="elmDescriptionText",S.elmLabelText="LabelText",S.activeClassName="cui-ctl-active",Object(i.a)(S,"Control",null,[4,87,71,102])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(20),o=n(25),s=n(49),l=(n(61),n(9),n(54),n(4)),c=n(17),u=n(22),d=n(16),p=n(10),h=function(){function e(e,t,n){this._focusHandledElements=[],this._blurHandledElements=[],this.looped=!1,this.contained=!1,this.enabled=!0,this.scope=e,this.listing=t,this._root=n}var t=e.prototype;return t.dispose=function(){this.listing.dispose(),this.listing=null,this._root=null;for(var t=this._focusHandledElements.length,n=0;n<t;n++)c.a.removeHandler(this._focusHandledElements[n],"focus",Object(r.d)(this,this.focusEventHandler,"focusEventHandler"));if(Array.clear(this._focusHandledElements),this._focusHandledElements=null,p.a.isInternetExplorerNonEdge){for(var i=this._blurHandledElements.length,a=0;a<i;a++)c.a.removeHandler(this._blurHandledElements[a],"blur",e.blurEventHandler);Array.clear(this._blurHandledElements),this._blurHandledElements=null}this.scope=null},t.moveForward=function(){var e=n(1).AFrameworkApplication;return d.a.clearSelectionIfNecessary(),this.listing.currentElement===this.listing.lastElement?this.looped?this.listing.trySetCurrentElement(this.listing.firstElement):(this.contained||e.activeFrame.theF6Manager.handleF6(0,null,2,null,null),!0):this.listing.trySetCurrentElement(this.listing.nextElement)},t.moveBackward=function(){var e=n(1).AFrameworkApplication;return d.a.clearSelectionIfNecessary(),this.listing.currentElement===this.listing.firstElement?this.looped?this.listing.trySetCurrentElement(this.listing.lastElement):!!this.contained||e.activeFrame.theF6Manager.handleTabFromBottom():this.listing.trySetCurrentElement(this.listing.previousElement)},t.moveIntoFromTop=function(){this.listing.forceSetCurrentElement(this.listing.firstElement)},t.moveIntoFromBottom=function(){this.listing.forceSetCurrentElement(this.listing.lastElement)},t.moveIntoRestore=function(){var e=n(78).DOMFocusListing,t=n(24).FocusManager,i=this.listing.currentElement;i&&e.elementFocusable(i)&&t.tryFocus(i)||this.listing.trySetCurrentElement(this.listing.firstElement)},t.rememberFocusStealers=function(){this.processFocusStealer(this._root())},t.processFocusStealer=function(t){if(void 0!==t.tagName&&null!==t.tagName){var n=u.DomUtils.getTag(t);if(p.a.isInternetExplorerNonEdge&&"text"===d.a.getInputTypeFromElement(t)&&(c.a.addHandler(t,"blur",e.blurEventHandler),Array.add(this._blurHandledElements,t)),3===n||4===n||6===n||5===n)c.a.addHandler(t,"focus",Object(r.d)(this,this.focusEventHandler,"focusEventHandler")),Array.add(this._focusHandledElements,t);else for(var i=t.firstChild;i;)this.processFocusStealer(i),i=i.nextSibling}},t.focusEventHandler=function(e){n(24).FocusManager.instance().setScope(this.scope.name),this.listing&&this.listing.trySetCurrentElement(e.target)},e.blurEventHandler=function(e){var t=e.target;t.value=t.value},e}();Object(i.a)(h,"FocusRegion",null,[4]);var m=function(){this.action=0,this.preventHandleExternally=!1,this.argumentsGenerator=null};Object(i.a)(m,"ActionInfo",null,[]);var g=n(8),f=n(3);function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _=function(){function e(e){this._actions={},this._dispose=[],this._setFocus=[],this._onFocus=[],this._onBlur=[],this._useBrowserClick=!1,this.parent=null,this.restoreFocusHandledExternally=!1,this.keyDownHandledExternally=!1,this.containerScope=null,this.name=e}var t,i,r,a=e.prototype;return a.dispose=function(){for(var e=0;e<this._dispose.length;e++)this._dispose[e]();this._actions=null,Array.clear(this._dispose),this._dispose=null,Array.clear(this._setFocus),this._setFocus=null,Array.clear(this._onFocus),this._onFocus=null,Array.clear(this._onBlur),this._onBlur=null},a.addDispose=function(e){Array.add(this._dispose,e)},a.addSetFocus=function(e){Array.add(this._setFocus,e)},a.clearSetFocus=function(){Array.clear(this._setFocus)},a.addOnFocus=function(e){Array.add(this._onFocus,e)},a.addOnBlur=function(e){Array.add(this._onBlur,e)},a.bindAction=function(e,t){this.bindActionWithArguments(e,t,null)},a.bindActionWithArguments=function(e,t,i){var r=n(1).AFrameworkApplication,a=this._actions[e];if(a&&a.action!==g.a.doNothing){if(a.action===t||t===g.a.doNothing)return;f.ULS.sendTraceTag(41739609,310,15,"Key bound to two different actions. Key={0}, Action={1}, SecondAction={2} UICulture={3}.",e,t,a.action,r.uiCulture)}else{var o=new m;o.action=t,o.argumentsGenerator=i,o.preventHandleExternally=!!a,this._actions[e]=o}},a.unBindAction=function(e){delete this._actions[e]},a.getAction=function(e){return this._actions[e]},a.runOnBlur=function(e){this.runFocusActions(this,e,this._onBlur)},a.runOnFocus=function(e){this.runFocusActions(e,this,this._onFocus)},a.runSetFocus=function(e){this.runFocusActions(e,this,this._setFocus)},a.runFocusActions=function(e,t,n){for(var i=0;i<n.length;i++)n[i](e,t)},t=e,(i=[{key:"hasSetFocus",get:function(){return!!this._setFocus&&this._setFocus.length>0}},{key:"useBrowserClick",get:function(){return this._useBrowserClick},set:function(e){this._useBrowserClick=e}}])&&v(t.prototype,i),r&&v(t,r),e}();Object(i.a)(_,"FocusScope",null,[4]);var y=function(e,t){this.previousScope=e,this.nextScope=t};Object(i.a)(y,"OnFocusScopeChangedEventArgs",null,[]);var b=n(69),S=n(50),C=n(13),A=n(21),I=n(35);function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"FocusManager",(function(){return T}));var T=function(){function e(t){var i;this._highlightedScopes=void 0,this._highlightedElements=void 0,this._highlightActivated=void 0,this._tabInput=a.KeyInputManager.hashKey(o.a.vK_Tab,0),this._tabShiftInput=a.KeyInputManager.hashKey(o.a.vK_Tab,4),this._scopeNames=[],this._scopes=[],this._scopeStack=[],this._regions={},this._regionList=[],this._switchingTasks=[],this._delegatesEnabled=!0,this._currentWithDelegates=!1,this._root=null,this._validTags=null,this._tabChecksDocument=null,this._tabChecksKeyInputManager=null,this._isDisposed=!1,this._addTriggerTimeTelemetryEnabled=null,this._eventSource=new s.a,this._editableFocusScopesActiveStateMap=((i={}).document=!0,i.CommentPane=!1,i.FloatingContainersHostFocusScope=!1,i),this._lastEditableFocusScope=null,this.inSetFocus=!1,this.inForceSetFocus=!1;var l=n(1).AFrameworkApplication;this._actionManager=l.theActionManager,this._currentScopeIndex=-1,this.defaultScopeName=null,this._actionManager.addAction(g.a.regionMoveForward,I.a.frame,e.moveForwardAction),this._actionManager.addAction(g.a.regionMoveBackward,I.a.frame,e.moveBackwardAction),this._keyDownHandler=Object(r.d)(this,this.keyDownHandler,"keyDownHandler"),this._processInputStrategyFuture=t}var t,i,c,m=e.prototype;return m.add_onFocusScopeChanged=function(t){this._eventSource.addHandler(e.onFocusScopeChangedEventKey,t)},m.remove_onFocusScopeChanged=function(t){this._eventSource.removeHandler(e.onFocusScopeChangedEventKey,t)},m.addFocusableScope=function(t,i,r){var a=this,o=this.getScope(t);o.parent=i,o.addSetFocus((function(i,o){var s=n(31).AFrame;e.tryFocus(r)||(a.defaultScopeName&&t!==a.defaultScopeName?a.setScopeToDefault():a.defaultScopeName===s.appFocusId?a.setScope(null):a.setScope(s.appFocusId))}))},m.dispose=function(){if(!this._isDisposed){null!==this._tabChecksDocument&&(this._tabChecksKeyInputManager.unregisterHandlerWithDocument(l.EventNames.keyDown,this._tabChecksDocument,this._keyDownHandler),this._keyDownHandler=null,this._tabChecksDocument=null,this._tabChecksKeyInputManager=null);for(var e=0;e<this._scopes.length;e++)this.getScopeAtIndex(e).dispose();Array.clear(this._scopes),Array.clear(this._scopeNames),this._currentScopeIndex=-1;for(var t=0;t<this._regionList.length;t++)this._regionList[t].dispose();Array.clear(this._regionList),this._regionList=null,this._regions=null,this._root=null,this._validTags&&(Array.clear(this._validTags),this._validTags=null),this._isDisposed=!0}},m.setScope=function(e){this.updateCurrentScope(e,!0,!1),this.clearScopeStackIfNewScope(e)},m.scopeChanged=function(e){this.updateCurrentScope(e,!1,!1),this.clearScopeStackIfNewScope(e)},m.forceScopeChange=function(e){this.updateCurrentScope(e,!0,!0),this.clearScopeStackIfNewScope(e)},m.setScopeFromTop=function(e){var t=n(1).AFrameworkApplication,i=this.getRegion(e);i&&!this.getScope(e).hasSetFocus||t.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&"EditingRibbonPanelFocus"===e?(this.scopeChanged(e),i.moveIntoFromTop()):this.setScope(e)},m.setScopeFromBottom=function(e){var t=this.getRegion(e);return t?(this.scopeChanged(e),t.moveIntoFromBottom(),!0):(this.scopeChanged(e),!1)},m.setScopeRestore=function(e,t){if(!this.canScopeReceiveFocus(e))return!1;var n=this.getRegion(e);return n?(this.scopeChanged(e),t&&n.moveIntoRestore()):this.setScope(e),!0},m.canScopeReceiveFocus=function(t){return!e.f6Manager.hasF6KeyBindings(t)||(e.f6Manager.isFocusScopeActive(t)||this.ribbonIntegrationWithCommentsIsEnabled&&t in this._editableFocusScopesActiveStateMap&&this._editableFocusScopesActiveStateMap[t])},m.processInput=function(e){var t=a.KeyInputManager.hashEvent(e);if(t){var n=null,i=this._processInputStrategyFuture?this._processInputStrategyFuture.instance:null;if(n=i?i.findAction(this,this.currentScope,t):this.findAction(this.currentScope,t)){var r,o=null;n.argumentsGenerator&&(o=n.argumentsGenerator()),this._actionManager.commandLocation=6,this._actionManager.invocationMethod=1;var s=null;if(this.addTriggerTimeTelemetryEnabled&&e&&e.rawEvent){var l=0;if(e.rawEvent.srcElement&&e.rawEvent.srcElement.ownerDocument){if(e.rawEvent.srcElement.ownerDocument!==window.document){var c=this.getPerformanceNowByDOMDocument(e.rawEvent.srcElement.ownerDocument),u=this.getPerformanceNowByDOMDocument(window.document);l=c&&u?u-c:null}l&&((s={}).TriggerTime=e.rawEvent.timeStamp+l)}}return 4===(r=i?i.handleInputAction(n.action,o,s):this._actionManager.processActionWithData(n.action,2,o,s))&&n.preventHandleExternally?32:r}}return 4},m.focusToBrowser=function(t,n,i,r,a){return this.pushScope(e.browserFocusId,!0),4},m.addSwitchingTask=function(e){Array.add(this._switchingTasks,e)},m.addScope=function(e){if(!Array.contains(this._scopeNames,e)){var t=new _(e);Array.add(this._scopeNames,e),Array.add(this._scopes,t)}},m.removeScope=function(e){n(31).AFrame;if(Array.contains(this._scopeNames,e)){var t=this.getScopeIndex(e);t===this._currentScopeIndex?this.setScope(null):t<this._currentScopeIndex&&this._currentScopeIndex--,this.getScopeAtIndex(t).dispose();var i=this._regions[e];i&&(this._regions[e]=null,Array.remove(this._regionList,i),i.dispose()),Array.removeAt(this._scopes,t),Array.removeAt(this._scopeNames,t)}},m.getScope=function(e){return e?(this.addScope(e),this.getScopeAtIndex(this.getScopeIndex(e))):null},m.pushScope=function(e,t){-1!==this._currentScopeIndex&&Array.insert(this._scopeStack,0,this.currentScope.name),this.updateCurrentScope(e,t,!1)},m.popScope=function(t,n){void 0===n&&(n=!0);var i=null;if(this._scopeStack.length>0)if(this.currentScope&&this.currentScope.name===t){var r=this._scopeStack[0],a=this.getScope(r);this.restoreToPreviousScope(!a.restoreFocusHandledExternally&&n)&&(i=this.currentScope.name)}else 0;i||(i=e.f6Manager.getHighestPriority())&&this.setScopeRestore(i,n)},m.peekNonReactTransientUiScope=function(){for(var e=n(31).AFrame,t=0;t<this._scopeStack.length;t++)if(this._scopeStack[t]!==e.reactTransientUIFocusId)return this._scopeStack[t];return""},m.tryGrabFocus=function(e){var t=!!this.currentScope&&this.currentScope.name===e;return t&&this.popScope(e),t},m.focusLastEditableSurface=function(){n(1).AFrameworkApplication.activeFrame.restoreFocusAfterExecutingActionFromRibbon()},m.addEditableFocusScope=function(e){this._editableFocusScopesActiveStateMap[e]=!1},m.activateEditableFocusScope=function(e){this.ribbonIntegrationWithCommentsIsEnabled&&e in this._editableFocusScopesActiveStateMap&&(this._editableFocusScopesActiveStateMap[e]=!0)},m.deactivateEditableFocusScope=function(e){this.ribbonIntegrationWithCommentsIsEnabled&&e in this._editableFocusScopesActiveStateMap&&(this._editableFocusScopesActiveStateMap[e]=!1)},m.isEditableFocusScopeActivated=function(e){return e in this._editableFocusScopesActiveStateMap&&this._editableFocusScopesActiveStateMap[e]},m.restoreToPreviousScope=function(e){var t=!1;if(this._scopeStack.length){var n=this._scopeStack[0];if(Array.removeAt(this._scopeStack,0),Array.contains(this._scopeNames,n)){var i=this.getScope(n);!i.containerScope||i.name in this._editableFocusScopesActiveStateMap&&this._editableFocusScopesActiveStateMap[i.name]||(n=i.containerScope),(t=this.setScopeRestore(n,e))||(t=this.restoreToPreviousScope(e))}else t=this.restoreToPreviousScope(e)}else this.setScopeToDefault();return t},m.tryChangeScopeOnStealingFocusEvent=function(e,t,n,i){(t||u.DomUtils.isEditable(i.sourceElement))&&(this.scopeChanged(e),n&&i.innerEvent.stopPropagation())},m.buildRegion=function(e,t,n){return this.buildRegionWithDelegate((function(){return e}),t,n)},m.buildRegionWithDelegate=function(e,t,n){this.removeRegion(t);var i=new h(t,n,e);return this._regions[t.name]=i,Array.add(this._regionList,i),t.bindAction(this._tabInput,g.a.regionMoveForward),t.bindAction(this._tabShiftInput,g.a.regionMoveBackward),i},m.removeRegion=function(e){if(this._regions[e.name]){var t=this._regions[e.name];Array.remove(this._regionList,t),t.dispose(),this._regions[e.name]=null,e.unBindAction(this._tabInput),e.unBindAction(this._tabShiftInput)}},m.getRegion=function(e){for(var t=e,n=null;t&&!n;)(n=this._regions[t])||(t=this.getScope(t).parent);return n},m.getCurrentRegion=function(){return void 0===this.currentScope||null===this.currentScope?null:this.getRegion(this.currentScope.name)},m.tabIntoRegionTop=function(e){for(var t=this.getCurrentRegion(),n=0;n<this._regionList.length;n++){var i=this._regionList[n];if(i.enabled&&i.listing.firstElement===e&&i!==t)return this.scopeChanged(i.scope.name),i.listing.forceSetCurrentElement(e),!0}return!1},m.tabIntoRegionBottom=function(e){for(var t=this.getCurrentRegion(),n=0;n<this._regionList.length;n++){var i=this._regionList[n];if(i.enabled&&i.listing.lastElement===e&&i!==t)return this.scopeChanged(i.scope.name),i.listing.forceSetCurrentElement(e),!0}return!1},m.setupTabChecks=function(e,t,n,i){this._root=t,this._validTags=n,this._tabChecksDocument=e,this._tabChecksKeyInputManager=i,this._tabChecksKeyInputManager.registerHandlerWithDocument(l.EventNames.keyDown,this._tabChecksDocument,this._keyDownHandler,null)},m.keyDownHandler=function(e){if(this.currentScope&&this.currentScope.keyDownHandledExternally)return!1;var t=e.innerEvent,n=a.KeyInputManager.hashEvent(t),i=t.target;return n===this._tabInput&&this.checkTab(i)||n===this._tabShiftInput&&this.checkTabShift(i)},m.checkTab=function(e){if(null!=e&&"body"!==C.a.toLower(e.tagName)){b.a.mark(4698);var t=n(78).DOMFocusListing.findNextElement(e,this._root,this._validTags),i=!!t&&(this.tabIntoRegionTop(t)||e===n(78).DOMFocusListing.firstInElement(this._root,this._validTags)&&this.tabIntoRegionTop(e));return b.a.mark(4699),i}return!1},m.checkTabShift=function(e){if(null!=e&&"body"!==C.a.toLower(e.tagName)){b.a.mark(4698);var t=n(78).DOMFocusListing.findPreviousElement(e,this._root,this._validTags),i=!!t&&(this.tabIntoRegionBottom(t)||e===n(78).DOMFocusListing.lastInElement(this._root,this._validTags)&&this.tabIntoRegionBottom(e));return b.a.mark(4699),i}return!1},m.getPerformanceNowByDOMDocument=function(e){var t=null,n=e.defaultView;if(n){var i=n.performance;if(i)i.now&&(t=i.now())}return t},m.runSwitchingTasks=function(e,t){for(var n=0;n<this._switchingTasks.length;n++){(0,this._switchingTasks[n])(e,t)}},m.setScopeToDefault=function(){this.defaultScopeName&&this.setScope(this.defaultScopeName)},m.updateCurrentScope=function(t,i,r){n(502).A11yTab;var a=this.currentScope,o=this.currentScope;if(!a&&t||a&&(a.name!==t||r)){if(t&&this.addScope(t),a&&this.delegatesEnabled&&this._currentWithDelegates&&this.runOnBlur(a,t?this.getScope(t):null),this.ribbonIntegrationWithCommentsIsEnabled&&t in this._editableFocusScopesActiveStateMap&&(this._lastEditableFocusScope=t),i&&this.delegatesEnabled&&this.runSwitchingTasks(a,this.getScope(t)),this._currentScopeIndex=this.getScopeIndex(t),-1!==this._currentScopeIndex){var s=a;a=this.currentScope,this.delegatesEnabled?(i&&this.runSetFocus(a,s),this.runOnFocus(a,s),this._currentWithDelegates=!0):this._currentWithDelegates=!1}0,this._eventSource.raiseEvent(e.onFocusScopeChangedEventKey,new y(o,this.getScope(t)))}else 0},m.getScopeIndex=function(e){return Array.contains(this._scopeNames,e)?Array.indexOf(this._scopeNames,e):-1},m.getScopeAtIndex=function(e){return-1===e?null:this._scopes[e]},m.findAction=function(e,t){if(!e)return null;var n=e.getAction(t);return!n&&e.parent&&(n=this.findAction(this.getScope(e.parent),t)),n},m.runOnBlur=function(e,t){e.runOnBlur(t);var n=this.getScope(e.parent);n&&this.runOnBlur(n,t)},m.runOnFocus=function(e,t){var n=this.getScope(e.parent);n&&this.runOnFocus(n,t),e.runOnFocus(t)},m.runSetFocus=function(e,t){var n=this.getScope(e.parent);n&&this.runSetFocus(n,t),e.runSetFocus(t)},m.clearScopeStackIfNewScope=function(e){this._scopeStack.length>0&&this._scopeStack[0]===e&&Array.clear(this._scopeStack)},e.usable=function(){return!!n(1).AFrameworkApplication.activeFrame&&!!e._instance},e.instance=function(){return e._instance||(e._instance=new e(A.a.instance.resolveFuture("Common.IProcessInputStrategy")))},e.tryFocus=function(e){try{return e.focus(),!0}catch(e){return!1}},e.trySetActive=function(e){try{return e.setActive(),!0}catch(e){return!1}},e.trySetActiveIfNotFocus=function(t){p.a.browserSupportsSetActive(t)?e.trySetActive(t):e.tryFocus(t)},e.tryBlur=function(e){try{return e.blur(),!0}catch(e){return!1}},e.tryBlurActiveElement=function(){try{return p.a.isInternetExplorer?document.body.focus():document.activeElement.blur(),!0}catch(e){return!1}},e.registerActions=function(t){t.addAction(g.a.blockIfFocusedTextField,I.a.frame,e.blockIfFocusedTextField),t.addActionWithFlags(g.a.blockIfNotFocusedTextField,I.a.frame,e.blockIfNotFocusedTextField,96)},e.registerShortcuts=function(e){e.getScope(n(31).AFrame.appFocusId).bindAction(a.KeyInputManager.hashKey(o.a.vK_Backspace,0),g.a.blockIfNotFocusedTextField)},e.blockIfFocusedTextField=function(e,t,n,i,r){var a=document.body.ownerDocument,o=d.a.getActiveElement(a);return o&&d.a.isTextField(o)?32:4},e.blockIfNotFocusedTextField=function(e,t,n,i,r){var a=document.body.ownerDocument,o=d.a.getActiveElement(a);return o&&d.a.isTextField(o)?4:32},e.moveForwardAction=function(t,n,i,r,a){var o=e.instance().getCurrentRegion();return o?o.moveForward()?32:4:(f.ULS.sendTraceTag(19261475,310,10,"CurrentRegion is null with scope name {0}.",e.instance().currentScope?e.instance().currentScope.name:"[NotExist]"),8)},e.moveBackwardAction=function(t,n,i,r,a){var o=e.instance().getCurrentRegion();return o?o.moveBackward()?32:4:(f.ULS.sendTraceTag(19261504,310,10,"CurrentRegion is null with scope name {0}.",e.instance().currentScope?e.instance().currentScope.name:"[NotExist]"),8)},e.disposeInputManager=function(){S.a(e._instance)},e.reset=function(){e._instance=null},t=e,c=[{key:"f6Manager",get:function(){var e=n(1).AFrameworkApplication;return e.activeFrame?e.activeFrame.theF6Manager:null}}],(i=[{key:"previousEditableScopeName",get:function(){return this._lastEditableFocusScope}},{key:"delegatesEnabled",get:function(){var e=n(1).AFrameworkApplication;return this._delegatesEnabled&&!e.isShuttingDown},set:function(e){this._delegatesEnabled=e}},{key:"currentScope",get:function(){return-1===this._currentScopeIndex?null:this.getScopeAtIndex(this._currentScopeIndex)}},{key:"addTriggerTimeTelemetryEnabled",get:function(){var e=n(1).AFrameworkApplication;return!this._addTriggerTimeTelemetryEnabled&&e.appSettingsManager&&(this._addTriggerTimeTelemetryEnabled=e.appSettingsManager.getBooleanAppSetting("AddTriggerTimeTelemetryEnabled")),!!this._addTriggerTimeTelemetryEnabled&&this._addTriggerTimeTelemetryEnabled}},{key:"ribbonIntegrationWithCommentsIsEnabled",get:function(){var e=n(1).AFrameworkApplication;return!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("RibbonIntegrationWithCommentsIsEnabled")}}])&&w(t.prototype,i),c&&w(t,c),e}();T.browserFocusId="Browser",T.editingFocusId="editing",T._instance=null,T.onFocusScopeChangedEventKey="OnFocusScopeChanged",Object(i.a)(T,"FocusManager",null,[4,11])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(10);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){}var t,n,i;return e.fromString=function(t){var n=e.keyCodePairs[t];return n||0},e.isAlphanumericKeyCode=function(e){return e>=48&&e<=57||e>=65&&e<=90},t=e,i=[{key:"vK_SemiColon",get:function(){return r.a.isFirefox?59:186}},{key:"vK_EqualSign",get:function(){return r.a.isFirefox?61:187}},{key:"vK_Hyphen",get:function(){return r.a.isFirefox?173:189}},{key:"keyCodePairs",get:function(){var t;return e._keyCodePairs||(e._keyCodePairs=((t={})[void 0]=e.VK_UNDEFINED,t.backspace=e.vK_Backspace,t.tab=e.vK_Tab,t.enter=e.vK_Enter,t.shift=e.vK_Shift,t.control=e.vK_Control,t.ctrl=e.vK_Ctrl,t.alt=e.vK_Alt,t.pause=e.vK_Pause,t.capslock=e.vK_CapsLock,t.esc=e.vK_Esc,t.escape=e.vK_Escape,t.space=e.vK_Space,t.spacebar=e.vK_Spacebar,t.pageup=e.vK_PageUp,t.pagedown=e.vK_PageDown,t.end=e.vK_End,t.home=e.vK_Home,t.left=e.vK_Left,t.leftarrow=e.vK_LeftArrow,t.up=e.vK_Up,t.uparrow=e.vK_UpArrow,t.right=e.vK_Right,t.rightarrow=e.vK_RightArrow,t.down=e.vK_Down,t.downarrow=e.vK_DownArrow,t.ins=e.vK_Ins,t.insert=e.vK_Insert,t[0]=e.VK_0,t[1]=e.VK_1,t[2]=e.VK_2,t[3]=e.VK_3,t[4]=e.VK_4,t[5]=e.VK_5,t[6]=e.VK_6,t[7]=e.VK_7,t[8]=e.VK_8,t[9]=e.VK_9,t.a=e.VK_A,t.b=e.VK_B,t.c=e.VK_C,t.d=e.VK_D,t.e=e.VK_E,t.f=e.VK_F,t.g=e.VK_G,t.h=e.VK_H,t.i=e.VK_I,t.j=e.VK_J,t.k=e.VK_K,t.l=e.VK_L,t.m=e.VK_M,t.n=e.VK_N,t.o=e.VK_O,t.p=e.VK_P,t.q=e.VK_Q,t.r=e.VK_R,t.s=e.VK_S,t.t=e.VK_T,t.u=e.VK_U,t.v=e.VK_V,t.w=e.VK_W,t.x=e.VK_X,t.y=e.VK_Y,t.z=e.VK_Z,t.windows=e.vK_Windows,t.openapple=e.vK_OpenApple,t.meta=e.vK_Meta,t.contextmenu=e.vK_ContextMenu,t.numpad0=e.vK_NumPad0,t.numpad1=e.vK_NumPad1,t.numpad2=e.vK_NumPad2,t.numpad3=e.vK_NumPad3,t.numpad4=e.vK_NumPad4,t.numpad5=e.vK_NumPad5,t.numpad6=e.vK_NumPad6,t.numpad7=e.vK_NumPad7,t.numpad8=e.vK_NumPad8,t.numpad9=e.vK_NumPad9,t.numpadmultiply=e.vK_NumPadMultiply,t.numpadplus=e.vK_NumPadPlus,t.numpadminus=e.vK_NumPadMinus,t.numpaddot=e.vK_NumPadDot,t.numpaddivide=e.vK_NumPadDivide,t.f1=e.VK_F1,t.f2=e.VK_F2,t.f3=e.VK_F3,t.f4=e.VK_F4,t.f5=e.VK_F5,t.f6=e.VK_F6,t.f7=e.VK_F7,t.f8=e.VK_F8,t.f9=e.VK_F9,t.f10=e.VK_F10,t.f11=e.VK_F11,t.f12=e.VK_F12,t.del=e.vK_Del,t.delete=e.vK_Delete,t.numlock=e.vK_NumLock,t.scrolllock=e.vK_ScrollLock,t.printscreen=e.vK_PrintScreen,t.semicolon=e.vK_SemiColon,t.equalsign=e.vK_EqualSign,t.comma=e.vK_Comma,t.dash=e.vK_Dash,t.hyphen=e.vK_Hyphen,t.period=e.vK_Period,t.slash=e.vK_Slash,t.backquote=e.vK_BackQuote,t.leftbracket=e.vK_LeftBracket,t.backslash=e.vK_BackSlash,t.rightbracket=e.vK_RightBracket,t.singlequote=e.vK_SingleQuote,t.f13=e.VK_F13,t.f14=e.VK_F14,t.f15=e.VK_F15,t.f16=e.VK_F16,t.f17=e.VK_F17,t.f18=e.VK_F18,t.f19=e.VK_F19,t.f20=e.VK_F20,t.f21=e.VK_F21,t.f22=e.VK_F22,t.f23=e.VK_F23,t.f24=e.VK_F24,t))}}],(n=null)&&a(t.prototype,n),i&&a(t,i),e}();o.VK_UNDEFINED=0,o.vK_Backspace=8,o.vK_Tab=9,o.vK_Enter=13,o.vK_Shift=16,o.vK_Control=17,o.vK_Ctrl=17,o.vK_Alt=18,o.vK_Pause=19,o.vK_CapsLock=20,o.vK_RightCtrl=25,o.vK_Esc=27,o.vK_Escape=27,o.vK_Space=32,o.vK_Spacebar=32,o.vK_PageUp=33,o.vK_PageDown=34,o.vK_End=35,o.vK_Home=36,o.vK_Left=37,o.vK_LeftArrow=37,o.vK_Up=38,o.vK_UpArrow=38,o.vK_Right=39,o.vK_RightArrow=39,o.vK_Down=40,o.vK_DownArrow=40,o.vK_Ins=45,o.vK_Insert=45,o.VK_0=48,o.VK_1=49,o.VK_2=50,o.VK_3=51,o.VK_4=52,o.VK_5=53,o.VK_6=54,o.VK_7=55,o.VK_8=56,o.VK_9=57,o.VK_A=65,o.VK_B=66,o.VK_C=67,o.VK_D=68,o.VK_E=69,o.VK_F=70,o.VK_G=71,o.VK_H=72,o.VK_I=73,o.VK_J=74,o.VK_K=75,o.VK_L=76,o.VK_M=77,o.VK_N=78,o.VK_O=79,o.VK_P=80,o.VK_Q=81,o.VK_R=82,o.VK_S=83,o.VK_T=84,o.VK_U=85,o.VK_V=86,o.VK_W=87,o.VK_X=88,o.VK_Y=89,o.VK_Z=90,o.vK_Windows=91,o.vK_OpenApple=91,o.vK_Meta=91,o.vK_ContextMenu=93,o.vK_NumPad0=96,o.vK_NumPad1=97,o.vK_NumPad2=98,o.vK_NumPad3=99,o.vK_NumPad4=100,o.vK_NumPad5=101,o.vK_NumPad6=102,o.vK_NumPad7=103,o.vK_NumPad8=104,o.vK_NumPad9=105,o.vK_NumPadMultiply=106,o.vK_NumPadPlus=107,o.vK_NumPadMinus=109,o.vK_NumPadDot=110,o.vK_NumPadDivide=111,o.VK_F1=112,o.VK_F2=113,o.VK_F3=114,o.VK_F4=115,o.VK_F5=116,o.VK_F6=117,o.VK_F7=118,o.VK_F8=119,o.VK_F9=120,o.VK_F10=121,o.VK_F11=122,o.VK_F12=123,o.vK_Del=127,o.vK_Delete=127,o.vK_NumLock=144,o.vK_ScrollLock=145,o.vK_PrintScreen=154,o.vK_Comma=188,o.vK_Dash=189,o.vK_Period=190,o.vK_Slash=191,o.vK_BackQuote=192,o.vK_LeftBracket=219,o.vK_BackSlash=220,o.vK_RightBracket=221,o.vK_SingleQuote=222,o.VK_IME=229,o.VK_INVALID_BEGIN=256,o.VK_INVALID_END=61439,o.VK_F13=61440,o.VK_F14=61441,o.VK_F15=61442,o.VK_F16=61443,o.VK_F17=61444,o.VK_F18=61445,o.VK_F19=61446,o.VK_F20=61447,o.VK_F21=61448,o.VK_F22=61449,o.VK_F23=61450,o.VK_F24=61451,o._keyCodePairs=null,Object(i.a)(o,"KeyCode",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.close="UI_Close",r.fileProperties="UI_FileProperties",r.sharing="UI_Sharing",r.moveToFolder="App_MoveToFolder",r.moveToFolderResponse="Host_MoveToFolder",r.fileEmbed="UI_FileEmbed",r.copyAndEdit="UI_CopyAndEdit",r.replyWithChanges="UI_ReplyWithChanges",r.fileVersions="UI_FileVersions",r.fileClose="UI_Close",r.openInClient="UI_OpenInClient",r.signIn="UI_SignIn",r.redeemForCommenting="UI_RedeemForCommenting",r.workflow="UI_Workflow",r.checkUserAccessAndGrantPermissions="UI_CheckUserAccessAndGrantPermissions",r.checkUserAccessAndGrantPermissionsResult="CheckUserAccessAndGrantPermissions_Result",r.blurFocus="BlurFocus",r.grabFocus="GrabFocus",r.shareForm="UI_ShareForm",r.reportAbuse="UI_ReportAbuse",r.fileRename="File_Rename",r.fileRenameFailed="File_RenameFailed",r.blur_Focus="Blur_Focus",r.grab_Focus="Grab_Focus",r.conversation="UI_Conversation",r.openInBrowser="UI_OpenInBrowser",r.download="UI_Download",r.editMode="UI_Edit",r.canEmbed="CanEmbed",r.queryLoadingStatus="QueryLoadingStatus",r.appLoadingStatus="App_LoadingStatus",r.appTempError="App_TempError",r.appAllOK="App_AllOK",r.appFatalError=" App_FatalError",r.appNavigated="App_Navigated",r.broadcastGlobalId="Broadcast_GlobalId",r.broadcastInSync="Broadcast_InSync",r.broadcastLinkedNotesInfo="Broadcast_LinkedNotesInfo",r.broadcastNavigateToPage="Broadcast_NavigateToPage",r.broadcastOpenInClient="Broadcast_OpenInClient",r.broadcastOutOfSync="Broadcast_OutOfSync",r.broadcastError="Broadcast_Error",r.broadcastInitialized="Broadcast_Initialized",r.broadcastLocationChanged="Broadcast_LocationChanged",r.broadcastMediaState="Broadcast_MediaState",r.broadcastNavigate="Broadcast_Navigate",r.broadcastResize="Broadcast_Resize",r.broadcastSetOptions="Broadcast_SetOptions",r.broadcastState="Broadcast_State",r.broadcastSyncToPresenter="Broadcast_SyncToPresenter",r.checkPolicy="CheckPolicy",r.checkPolicyResponse="CheckPolicyResponse",r.hostPerfTiming="Host_PerfTiming",r.hostPostMessageReady="Host_PostmessageReady",r.loadTestSlice="Test_LTAS",r.editNotification="Edit_Notification",r.userActivity="User_Activity",r.addItem="AddItem",r.insert="Insert",r.addOtelEvent="AddOtelEvent",r.launchM365Upsell="LaunchM365Upsell",r.upgradeFeatureTier="UpgradeFeatureTier",r.getCustomHeaders="GetCustomHeaders",r.getSessionId="GetSessionId",r.getCID="GetCID",r.insertImage="UI_InsertImage",r.insertImageHost="Host_InsertImage",r.insertFileLink="UI_InsertFileLink",r.insertFileLinkHost="Host_InsertFileLink",r.setCustomHeaders="SetCustomHeaders",r.setSessionId="SetSessionId",r.setCID="SetCID",r.cancelDialog="CancelDialog",r.showError="ShowError",r.showCFD="ShowCFD",r.showMOSS="ShowMOSS",r.commanding="Commanding",r.exitLT="Exit_LT",r.readyForStorageLT="readyForStorageId",r.requestLTFullScreen="immersiveReader-requestFullScreen",r.exitLTFullScreen="immersiveReader-exitFullScreen",r.getAccessToken="GetAccessToken",r.postAccessToken="PostAccessToken",r.getAuthToken="App_GetAuthToken",r.postAuthToken="Host_SetAuthToken",r.defaultAckMessage="Ack",r.wopiPendingComplete="WopiPendingSession_Complete",r.wopiPendingFail="WopiPendingSession_Fail",r.wopiStartSessionComplete="WopiStartSession_Complete",r.wopiSessionCompleteAck="WopiSession_Complete_Ack",r.jsApiDiagnostics="JsApiDiagnostics",r.wacInitializeReady="WacInitialize_Ready",r.wacInitializeReadyAck="WacInitialize_Ready_Ack",r.wacAppBootState="Wac_AppBootState",r.wacAppCompleted="Wac_AppCompleted",r.wacAppCompletedAck="Wac_AppCompleted_Ack",r.wacAppFailed="Wac_AppFailed",r.wacAppFailedAck="Wac_AppFailed_Ack",r.wacBeforeUnloadApp="Wac_BeforeUnloadApp",r.wacUnloadingApp="Wac_UnloadingApp",r.wacAppDataSavedStatus="Wac_AppDataSavedStatus",r.wacUnloadApp="Wac_UnloadApp",r.wacActionComplete="Wac_ActionComplete",r.hostCacheDiagnostic="HostCacheDiagnostic",r.setZoomLevel="SetZoomLevel",r.setCurrentPage="SetCurrentPage",r.appStateEvent="AppState",r.zoomChangeEvent="ZoomChanged",r.pageChangeEvent="PageChanged",r.pageCountEvent="PageCount",r.frameStateChangeEvent="StateChanged",r.browserEvent="BrowserEvent",r.zoomChangeEventAck="ZoomChanged_Ack",r.pageChangeEventAck="PageChanged_Ack",r.pageCountEventAck="PageCount_Ack",r.uI_SaveStatus="UI_SaveStatus",r.accessibilityLoopComplete="App_AccessibilityLoopComplete",r.hostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",r.appSwitchMode="App_SwitchMode",r.hostSwitchMode="Host_SwitchMode",r.appRefreshSessionInfo="App_RefreshSessionInfo",r.hostRefreshSessionInfo="Host_RefreshSessionInfo",r.aadAuthSuccess="Aad_AuthSuccess",r.aadAuthSuccessAck="Aad_AuthSuccess_Ack",r.appUnloaded="App_Unloaded",r.hostUnload="Host_Unload",r.app_IsFrameTrusted="App_IsFrameTrusted",r.host_IsFrameTrusted="Host_IsFrameTrusted",r.documentRefresh="App_DocReboot",r.createNewDocument="App_CreateNewDocument",r.appWopiInfoFromUrl="App_WopiInfoFromUrl",r.hostWopiInfoFromUrl="Host_WopiInfoFromUrl",r.setOverlayContent="SetOverlayContent",r.getCustomAuthConfig="App_GetCustomAuthConfig",r.setCustomAuthConfig="Host_SetCustomAuthConfig",r.hostFrameCacheEvict="Excel_HostFrameCacheEvict",r.hostFrameCacheSave="Excel_HostFrameCacheSave",r.sharedAuthInit="SharedAuth_Init",r.sharedAuthTryGetToken="SharedAuth_TryGetToken",r.sharedAuthScriptLoaded="SharedAuth_ScriptLoaded",r.sharedAuthScriptInitialized="SharedAuth_ScriptInitialized",r.sharedAuthGetTokenResponse="SharedAuth_GetTokenResponse",r.saveHostRenderingData="App_SaveHostRenderingData",r.saveSSRData="App_SaveSSRData",r.hostTelemetry="Host_Telemetry",r.purgeDataInHostCache="App_PurgeDataInHostCache",r.closeTab="App_CloseTab",r.storeHostKeyValue="App_StoreHostKeyValue",r.getHostKeyValue="App_GetHostKeyValue",r.hostKeyValue="Host_KeyValue",r.test=void 0,r.unitTest=void 0,Object(i.a)(r,"CrossDocumentMessageId",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),r=n(13),a=n(112);function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l=function(){function e(){}return e.getParametersFromUrl=function(t,n){for(var i,r=new a.a,s=o(n);!(i=s()).done;){var l=i.value,c=e.getParameterValueDecoded(t,l);c&&r.add(l,c)}return r},e.removeParameter=function(t,n,i){return void 0===i&&(i=!1),e.addOrReplaceParameterValue(t,n,null,i)},e.removeParameters=function(t,n){for(var i,r=t,a=o(n);!(i=a()).done;){var s=i.value;r=e.removeParameter(r,s)}return r},e.addOrReplaceParameterValue=function(t,i,r,a){void 0===a&&(a=!1);n(9).Debug;if(t||(t=""),!i)return t;var o=t,s=!r,l=o.indexOf("?");if(-1===l)return s?t:o+"?"+i+"="+r;var c=o.substr(l+1),u=e.addOrReplaceParameterValueInQueryParams(c,i,r,a);return o=o.replace(c,u)},e.addOrReplaceParameterValueInQueryParams=function(e,t,i,r){void 0===r&&(r=!1);n(9).Debug;var a=!i;if(!t)return e;for(var o=e,s=e.split("&"),l=t+"=",c=r?l.toLowerCase():l,u=!1,d=0;d<s.length;++d){if(0===(r?s[d].toLowerCase():s[d]).indexOf(c)){o=o.replace(s[d],a?"":l+i),u=!0;break}}return u||a||(e.length>0&&(o+="&"),o+=l+i),o},e.addParameterValue=function(e,t,i){var r=new(n(158).QueryStringBuilder)(e);return r.addParam(t,i),r.toString()},e.getAbsoluteUrl=function(e){var t=new Sys.Net.WebRequest;return t.set_url(e),t.getResolvedUrl()},e.getOrigin=function(t){return e.executeHostPartRegExp(t,0)},e.getHost=function(t){return e.executeHostPartRegExp(t,1)},e.executeHostPartRegExp=function(t,n){if(!t)return"";var i=e._hostPartRegExp.exec(t);return i&&i.length>n?i[n]:""},e.getHostname=function(t){if(!t)return"";var n=e._hostnamePartRegExp.exec(t);return n&&n.length>1?n[1]:""},e.getParameterValueDecoded=function(t,n){var i=e.getParameterValue(t,n);return null==i?i:unescape(i)},e.getParameterValue=function(e,t,n){void 0===n&&(n=!1);var i=n?r.a.toLower(e):e,a=n?r.a.toLower(t):t,o=i.indexOf("&"+a+"=");if(-1===o&&(o=i.indexOf("?"+a+"=")),-1===o)return null;var s=o+(t.length+2),l=e.indexOf("&",s);return-1===l?e.substr(s):e.substring(s,l)},e.removeAllUrlParameters=function(e){if(!e)return"";var t=new RegExp("[?#&]").exec(e);if(!t)return e;var n=t.index;return n?e.substring(0,n):""},e.getFwLinkUrl=function(t){return e.addParameterValue("https://go.microsoft.com/fwlink/","LinkID",t)},e.getFwLinkForUpsellFeatures=function(t){return t?e.getFwLinkUrl("862405")+String.format("&pc={0}",t):e.getFwLinkUrl("522402")},e.getPageName=function(e){if(!e)return"";var t=-1===e.indexOf("#")?e.length:e.indexOf("#"),n=e.lastIndexOf("/",t);if(-1!==n&&n+1===e.indexOf("://")+"://".length)return"";n+=1;var i=e.indexOf("?");if(-1!==(i=i>=t?-1:i)&&n>i)return"";var r=-1===i?t:i;return n>=r?"":e.substring(n,r)},e.addOrReplaceParametersValue=function(t,n){for(var i,r=o(n);!(i=r()).done;){var a=i.value;t=e.addOrReplaceParameterValue(t,a.get_key(),a.get_value())}return t},e}();l._hostPartRegExp=new RegExp("^[a-z+.-]+://([^/:]*(:[0-9]{1,5})?)","i"),l._hostnamePartRegExp=new RegExp("^[a-z+.-]+://([^/:]*)","i"),Object(i.a)(l,"UrlUtils",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(10),o=(n(9),n(54),n(3)),s=function(){function e(e,t){this._lastMsPointerDownTime=0,this._currentTimeGetter=e,this._ulsReporter=t}var t=e.prototype;return t.markPointerDownEventTime=function(){this._lastMsPointerDownTime=this._currentTimeGetter()},t.markMouseDownEventTime=function(){var e=this._currentTimeGetter()-this._lastMsPointerDownTime;e>250&&this._ulsReporter(e)},e.getAnInstance=function(){return new e(e.getCurrentTime,e.reportToUls)},e.getCurrentTime=function(){return(new Date).getTime()},e.reportToUls=function(e){o.ULS.sendTraceTag(4248472,310,15,"msPointerDown before mousedown was {0}ms",e)},e}();Object(i.a)(s,"MissingPointerEventsTracker",null,[]);var l=n(17),c=n(41),u=n(48),d=n(4),p=n(247);function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var m=function(e){var t,n,i,r,o;function s(t,n,i,r,a,o,s,l,c){var u,d;((u=e.call(this,t,r,a,o)||this)._pointerId=0,u._button=n,u._clientPoint=i,u._shiftKey=s,u._ctrlKey=l,u._metaKey=c,a.rawEvent)?d=a.rawEvent.pointerId:d=a.pointerId;return u._pointerId=null!=d?d:-1,u}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,s.create=function(e,t,n,i){var r,a,o=!1;if(n.rawEvent){var l=n.rawEvent;r=c.EventHandlerArgs.getMouseButton(l),a=new Sys.UI.Point(l.clientX,l.clientY),o=l.metaKey,void 0!==l.clientX&&null!==l.clientX&&void 0!==l.clientX&&null!==l.clientX||3!==i||(a=c.EventHandlerArgs.getClientPointFromTouchEvent(n))}else r=n.button,a=new Sys.UI.Point(n.clientX,n.clientY);return new s(e,r,a,t,n,i,n.shiftKey,n.ctrlKey,o)},i=s,(r=[{key:"mouseButton",get:function(){return this._button}},{key:"shiftKey",get:function(){return this._shiftKey}},{key:"ctrlKey",get:function(){return this._ctrlKey}},{key:"metaKey",get:function(){return this._metaKey}},{key:"commandKey",get:function(){return a.a.isMac?this._metaKey:this._ctrlKey}},{key:"clientPoint",get:function(){return this._clientPoint}},{key:"pointerId",get:function(){return this._pointerId}}])&&h(i.prototype,r),o&&h(i,o),s}(c.EventHandlerArgs);Object(i.a)(m,"PointerEventArgs",c.EventHandlerArgs,[]);var g=n(50);function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return v}));var v=function(e){var t,i;function h(){var t;return(t=e.call(this)||this)._browserPointerEventsEnabled=window.navigator.pointerEnabled||!!window.PointerEvent&&a.a.isInternetExplorerEdge,t._msPointerEventsEnabled=window.navigator.msPointerEnabled,t._missingPointerEventsTracker=s.getAnInstance(),t._eventHandlerManager=u.EventHandlerManager.instance,t._pointerEventToBrowserEvents={},t._browserEventToPointerEvent={},t._browserPointerEventsEnabled?(t.setupPointerEventDicts(d.EventNames.pointerDown,[d.EventNames.browserPointerDown,d.EventNames.touchStart,d.EventNames.mouseDown]),t.setupPointerEventDicts(d.EventNames.pointerMove,[d.EventNames.browserPointerMove,d.EventNames.mouseMove]),t.setupPointerEventDicts(d.EventNames.pointerUp,[d.EventNames.browserPointerUp,d.EventNames.mouseUp]),t.setupPointerEventDicts(d.EventNames.pointerOver,[d.EventNames.browserPointerOver,d.EventNames.mouseOver]),t.setupPointerEventDicts(d.EventNames.pointerOut,[d.EventNames.browserPointerOut,d.EventNames.mouseOut]),t.setupPointerEventDicts(d.EventNames.pointerEnter,[d.EventNames.browserPointerEnter,d.EventNames.mouseEnter]),t.setupPointerEventDicts(d.EventNames.pointerLeave,[d.EventNames.browserPointerLeave,d.EventNames.mouseLeave])):t._msPointerEventsEnabled?(t.setupPointerEventDicts(d.EventNames.pointerDown,[d.EventNames.msPointerDown,d.EventNames.touchStart,d.EventNames.mouseDown]),t.setupPointerEventDicts(d.EventNames.pointerMove,[d.EventNames.msPointerMove,d.EventNames.mouseMove]),t.setupPointerEventDicts(d.EventNames.pointerUp,[d.EventNames.msPointerUp,d.EventNames.mouseUp]),t.setupPointerEventDicts(d.EventNames.pointerOver,[d.EventNames.msPointerOver,d.EventNames.mouseOver]),t.setupPointerEventDicts(d.EventNames.pointerOut,[d.EventNames.msPointerOut,d.EventNames.mouseOut]),t.setupPointerEventDicts(d.EventNames.pointerEnter,[d.EventNames.msPointerEnter,d.EventNames.mouseEnter]),t.setupPointerEventDicts(d.EventNames.pointerLeave,[d.EventNames.msPointerLeave,d.EventNames.mouseLeave])):(t.setupPointerEventDicts(d.EventNames.pointerDown,[d.EventNames.touchStart,d.EventNames.mouseDown]),t.setupPointerEventDicts(d.EventNames.pointerMove,[d.EventNames.mouseMove]),t.setupPointerEventDicts(d.EventNames.pointerUp,[d.EventNames.mouseUp]),t.setupPointerEventDicts(d.EventNames.pointerOver,[d.EventNames.mouseOver]),t.setupPointerEventDicts(d.EventNames.pointerOut,[d.EventNames.mouseOut]),t.setupPointerEventDicts(d.EventNames.pointerEnter,[d.EventNames.mouseEnter]),t.setupPointerEventDicts(d.EventNames.pointerLeave,[d.EventNames.mouseLeave])),t}i=e,(t=h).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var v,_,y,b=h.prototype;return b.setupPointerEventDicts=function(e,t){this._pointerEventToBrowserEvents[e]=t;for(var n=0;n<t.length;++n)this._browserEventToPointerEvent[t[n]]=e},b.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t);for(var n=d.EventNames.get_pointerEvents(),i=0;i<n.length;++i)this.initializeBrowserEvents(n[i],t)},b.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t);for(var n=d.EventNames.get_pointerEvents(),i=0;i<n.length;++i)this.deInializeBrowserEvents(n[i],t)},b.registerHandler=function(e,t,n){this.registerHandlerWithCaptureOption(e,t,n,!1)},b.registerHandlerWithData=function(e,t,n,i){this.registerHandlerInternal(e,t,n,i)},b.registerHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this.registerHandlerInternal(e,t,n,null,i)},b.unregisterHandler=function(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n,!1)},b.unregisterHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this._eventHandlerManager.unregisterHandler(e,t,n,i),this.deInializeBrowserEvents(e,t,i)},b.registerOnBeforeEventProcessed=function(e,t){var n=this._pointerEventToBrowserEvents[e],i=this.buildOnBeforeEventProcessedHandler(t);this._eventHandlerManager.registerOnBeforeEventsProcessed(n,i)},b.registerHandlerInternal=function(e,t,n,i,a){void 0===a&&(a=!1),this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onPointerEvent,"onPointerEvent"),n,i,a),this.initializeBrowserEvents(e,t,a)},b.buildOnBeforeEventProcessedHandler=function(e){var t=this;return function(i){if(!n(1).AFrameworkApplication.theTaskManager.isYielding){var r=d.EventNames.eventNameFromString(i.type);if(!t.shouldIgnoreDuplicateEvent(r)){var a=t.buildPointerEventArgs(r,i);e(a)}}}},b.initializeBrowserEvents=function(e,t,n){void 0===n&&(n=!1);var i=this._pointerEventToBrowserEvents[e];if(null!=i)for(var a=0;a<i.length;++a)this._eventHandlerManager.initializeForElementInternal(i[a],t,2,Object(r.d)(this,this.onPointerEvent,"onPointerEvent"),n)},b.deInializeBrowserEvents=function(e,t,n){void 0===n&&(n=!1);var i=this._pointerEventToBrowserEvents[e];if(null!=i)for(var r=0;r<i.length;++r)this._eventHandlerManager.deinitializeForElementInternal(t,i[r],n)},b.onPointerEvent=function(e,t,i){if(n(1).AFrameworkApplication.theTaskManager.isYielding)return o.ULS.sendTraceTag(24699483,324,50,"Pointer event dropped."),!1;if(e!==d.EventNames.msPointerDown&&e!==d.EventNames.browserPointerDown||this._missingPointerEventsTracker.markPointerDownEventTime(),(this._msPointerEventsEnabled||this._browserPointerEventsEnabled)&&e===d.EventNames.mouseDown&&this._missingPointerEventsTracker.markMouseDownEventTime(),this.shouldIgnoreDuplicateEvent(e))return!1;var r=this.buildPointerEventArgs(e,i),a=this._eventHandlerManager.processEvent(r.eventName,t,r);return a&&l.a.cancelEvent(i),a},b.shouldIgnoreDuplicateEvent=function(e){var t=e.startsWith("MSPointer");if(this._browserPointerEventsEnabled&&t)return!0;var n=e.startsWith("mouse");return(this._browserPointerEventsEnabled||this._msPointerEventsEnabled)&&n},b.buildPointerEventArgs=function(e,t){var n;n=t.rawEvent?c.EventHandlerArgs.getSourceElement(t):t.target;var i=h.getIeInputMethod(t);i||(i=Array.contains(d.EventNames.get_touchEvents(),e)?3:2);var r=this._browserEventToPointerEvent[e];return m.create(r,n,t,i)},h.disposeInputManager=function(){g.a(h._instance)},h.getIeInputMethod=function(e){var t;if(null!=(t=p.a(e)))switch(t){case 4:case 3:return 2;case 2:return 3}return 0},v=h,y=[{key:"instance",get:function(){return h._instance||(h._instance=new h),h._instance},set:function(e){h._instance=e}}],(_=null)&&f(v.prototype,_),y&&f(v,y),h}(l.a);v._instance=null,Object(i.a)(v,"PointerInputManager",l.a,[104,13,4])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=(n(9),n(54),n(39));function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(e,t,n,i,r){this._element=null,this._afterHandler=null,this._timeRemaining=e,this._animationEvent=t,this.set_element(n),this._beforeHandler=i,this.set_afterHandler(r)}var t,n,i,r=e.prototype;return r.set_element=function(e){return this._element=e,e},r.set_afterHandler=function(e){return this._afterHandler=e,e},e.create=function(t,n,i,r,a){return new e(t,n,i,r,a)},t=e,(n=[{key:"timeRemaining",get:function(){return this._timeRemaining}},{key:"animationEvent",get:function(){return this._animationEvent}},{key:"element",get:function(){return this._element?this._element:null}},{key:"beforeHandler",get:function(){return this._beforeHandler}},{key:"afterHandler",get:function(){return this._afterHandler}}])&&a(t.prototype,n),i&&a(t,i),e}();function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(o,"AnimationHandlerArgs",null,[]);var l=function(){function e(e){this._runTime=e}var t,n,i;return t=e,(n=[{key:"runTime",get:function(){return this._runTime}}])&&s(t.prototype,n),i&&s(t,i),e}();function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(l,"AnimationResultProperties",null,[]);var u=function(){function e(e,t,n,i,r,a,o){this._fps=e,this._min=t,this._max=n,this._stdDev=i,this._startTime=r,this._endTime=a,this._elementIds=o}var t,n,i;return t=e,(n=[{key:"fps",get:function(){return this._fps}},{key:"min",get:function(){return this._min}},{key:"max",get:function(){return this._max}},{key:"stdDev",get:function(){return this._stdDev}},{key:"startTime",get:function(){return this._startTime}},{key:"endTime",get:function(){return this._endTime}},{key:"elementIds",get:function(){return this._elementIds}}])&&c(t.prototype,n),i&&c(t,i),e}();Object(i.a)(u,"AnimationStat",null,[]);var d,p=n(2);function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e){e[e.onAlways=1]="onAlways",e[e.onHide=2]="onHide",e[e.onMove=3]="onMove",e[e.onOpacityChanged=4]="onOpacityChanged",e[e.onResize=5]="onResize",e[e.onShow=6]="onShow",e[e.onScroll=7]="onScroll",e[e.onRotate=8]="onRotate"}(d||(d={})),Object(i.b)("AnimationType",d);var m,g,f=function(){function e(e){this.animationArgs=e,this._numberOfAnimationsRunning=1,this._afterAnimationHandlerArgObjects=[],this._afterAnimationHandlerIndex=0}var t,n,i,r=e.prototype;return r.increaseAnimationCount=function(){this._numberOfAnimationsRunning=this.numberOfAnimationsRunning+1},r.decreaseAnimationCount=function(){this._numberOfAnimationsRunning=this.numberOfAnimationsRunning-1},r.delayAfterAnimationHandler=function(e){this._afterAnimationHandlerArgObjects[this._afterAnimationHandlerIndex]=e,this._afterAnimationHandlerIndex++},r.callDelayedAfterAnimationHandlers=function(){for(var e=0;e<this._afterAnimationHandlerIndex;e++){var t=this._afterAnimationHandlerArgObjects[e];t.afterHandler(t)}},t=e,(n=[{key:"numberOfAnimationsRunning",get:function(){return this._numberOfAnimationsRunning}}])&&h(t.prototype,n),i&&h(t,i),e}();function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(f,"CurrentAnimation",null,[]);var _=function(){function e(){}var t,n,i;return e.getAnimationToRun=function(t){return e._animationMapping[t]},e.getAnimationRunTime=function(t){var n=e.getAnimationToRun(t);return e._animationTimes[n.toString()]},t=e,i=[{key:"animationAliases",get:function(){return e._animationAliases}}],(n=null)&&v(t.prototype,n),i&&v(t,i),e}();function y(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}_._animationMapping=((m={})["SHARED_QUICKESTCLASS&ONSHOW"]=1,m["SHARED_QUICKCLASS&ONMOVE"]=6,m["SHARED_QUICKCLASS&ONRESIZE"]=7,m["SHARED_QUICKCLASS&ONOPACITYCHANGED"]=8,m["SHARED_QUICKCLASS&ONSHOW"]=9,m["SHARED_QUICKCLASS&ONHIDE"]=10,m["SHARED_BASICCLASS&ONMOVE"]=11,m["SHARED_BASICCLASS&ONRESIZE"]=12,m["SHARED_BASICCLASS&ONOPACITYCHANGED"]=13,m["SHARED_BASICCLASS&ONSHOW"]=14,m["SHARED_BASICCLASS&ONHIDE"]=15,m["SHARED_BASICCLASS&ONSCROLL"]=16,m["ONENOTE_BASICCLASS&ONMOVE"]=22,m["ONENOTE_BASICCLASS&ONRESIZE"]=23,m["ONENOTE_BASICCLASS&ONOPACITYCHANGED"]=24,m["ONENOTE_BASICCLASS&ONSHOW"]=25,m["ONENOTE_BASICCLASS&ONHIDE"]=26,m["SHARED_SLOWCLASS&ONMOVE"]=17,m["SHARED_SLOWCLASS&ONRESIZE"]=18,m["SHARED_SLOWCLASS&ONOPACITYCHANGED"]=19,m["SHARED_SLOWCLASS&ONSHOW"]=20,m["SHARED_INSTANTCLASS&ONOPACITYCHANGED"]=0,m["UEX_UPPERCONTEXTUALTABDRAMATIC&ONSHOW"]=29,m["CXE_UPPERCONTEXTUALTABVISUALREFRESH&ONSHOW"]=30,m["CXE_UPPERCONTEXTUALTABVISUALREFRESH&ONHIDE"]=31,m["UEX_CONTEXTUALTABMOVEMENT&ONMOVE"]=28,m["MSOHELP_FOLLOWTHEDOTCLASS&ONMOVE"]=35,m["MSOHELP_FOLLOWTHEDOTCLASS&ONOPACITYCHANGED"]=13,m["MSOHELP_FOLLOWTHEDOTCLASS&ONHIDE"]=15,m["MSOHELP_SPOTLIGHTCLASS&ONOPACITYCHANGED"]=13,m["MSOHELP_SPOTLIGHTCLASS&ONSHOW"]=14,m["MSOHELP_SPOTLIGHTCLASS&ONHIDE"]=15,m["WAC_DELAYSHOWCLASS&ONSHOW"]=36,m["WAC_DELAYMOVECLASS&ONMOVE"]=37,m["WAC_RIBBONCLASS&ONMOVE"]=38,m["WAC_RIBBONCLASS&ONSHOW"]=39,m["WAC_RIBBONCLASS&ONHIDE"]=40,m["UEX_WINDOWTRANSITION&ONMOVE"]=11,m["UEX_WINDOWTRANSITION&ONRESIZE"]=12,m["UEX_WINDOWTRANSITION&ONOPACITYCHANGED"]=13,m["UEX_WINDOWTRANSITION&ONSHOW"]=14,m["UEX_STEALTHUITRANSITION&ONMOVE"]=6,m["UEX_STEALTHUITRANSITION&ONRESIZE"]=7,m["VISIO_PAGEENTERING&ONMOVE"]=11,m["VISIO_PAGEENTERING&ONOPACITYCHANGED"]=13,m["VISIO_PAGEENTERING&ONRESIZE"]=12,m["VISIO_PAGEENTERING&ONSHOW"]=14,m["VISIO_PAGEENTERING&ONHIDE"]=15,m["VISIO_PAGEENTERING&ONSCROLL"]=16,m["VISIO_PAGEEXITING&ONRESIZE"]=12,m["VISIO_PAGEEXITING&ONSHOW"]=14,m["VISIO_PAGEEXITING&ONHIDE"]=15,m["VISIO_PAGEEXITING&ONSCROLL"]=16,m),_._animationAliases={},_._animationTimes=((g={})[0]=0,g[1]=.05,g[2]=.167,g[3]=.167,g[4]=.167,g[5]=.167,g[6]=.1,g[7]=.1,g[8]=.1,g[9]=.1,g[10]=.1,g[11]=.267,g[12]=.267,g[13]=.267,g[14]=.267,g[15]=.267,g[16]=.267,g[17]=.75,g[18]=.75,g[19]=.75,g[20]=.75,g[21]=1,g[22]=.367,g[23]=.367,g[24]=.367,g[25]=.367,g[26]=.367,g[27]=.05,g[28]=.433,g[29]=.1,g[30]=.35,g[31]=.267,g[32]=.267,g[33]=.3,g[34]=.3,g[35]=.75,g[36]=.5,g[37]=.267,g[38]=.267,g[39]=.267,g[40]=.267,g),Object(i.a)(_,"WacAirSpaceAnimationClasses",null,[]);var S=function(){function e(){this._animatingDomElements={}}var t=e.prototype;return t.animate=function(t){var i,r=n(1).AFrameworkApplication,a=t.element,o=t.animationEvent,s=e.getAnimationClassAndEvent(t),c=_.getAnimationToRun(s),u=this.createAnimationState(o),d=new WacAnimation.Object(c,0,a,u,Object(p.d)(this,this.defaultAfterAnimationHandler,"defaultAfterAnimationHandler"),t),h=e.getAnimationRunTime(s);return r.theTaskManager.pauseForAnimation(h),t.beforeHandler&&t.beforeHandler(t),this._animatingDomElements[a.id]?((i=this._animatingDomElements[a.id]).increaseAnimationCount(),i.animationArgs=t):(i=new f(t),this._animatingDomElements[a.id]=i),u?d.RunAnimation():this.defaultAfterAnimationHandler(t),new l(h)},t.createAnimationState=function(e){var t=!1,n=new WacAnimation.State;return isNaN(e.finalX)||e.isXConstant||(n.SetAttribute(1,e.finalX),n.SetAnimateRight(e.useRightAttributeForX),t=!0),isNaN(e.finalY)||e.isYConstant||(n.SetAttribute(2,e.finalY),t=!0),isNaN(e.finalHeight)||e.isHeightConstant||(n.SetAttribute(3,e.finalHeight),t=!0),isNaN(e.finalWidth)||e.isWidthConstant||(n.SetAttribute(4,e.finalWidth),t=!0),isNaN(e.finalOpacity)||e.isOpacityConstant||(n.SetAttribute(5,e.finalOpacity),t=!0),isNaN(e.finalScrollTop)||e.isScrollTopConstant||(n.SetAttribute(6,e.finalScrollTop),t=!0),isNaN(e.finalScrollLeft)||e.isScrollLeftConstant||(n.SetAttribute(7,e.finalScrollLeft),t=!0),isNaN(e.finalRotateZ)||e.isRotateZConstant||(n.SetAttribute(8,e.finalRotateZ),t=!0),t?n:null},t.defaultAfterAnimationHandler=function(e){var t=n(1).AFrameworkApplication,i=n(321).generateAnimationStatsDiv;if(!t.isShuttingDown){var r=e.element;if(document.URL.endsWith("&WacAirReport=1")&&i(),this._animatingDomElements[r.id]){var a=this._animatingDomElements[r.id];a.decreaseAnimationCount(),a.numberOfAnimationsRunning<0||(e.afterHandler&&a.delayAfterAnimationHandler(e),a.numberOfAnimationsRunning||(a.callDelayedAfterAnimationHandlers(),delete this._animatingDomElements[r.id]))}else e.afterHandler&&e.afterHandler(e)}},e.getAnimationRunTime=function(e){var t=_.getAnimationRunTime(e);return parseInt((1e3*t).toString())},e.getAnimationClassAndEvent=function(t){var i=n(29).WacAirSpace,r=t.element,a=t.animationEvent;if(!r||!r.className)return"";for(var o,s=null,l=y(r.className.split(" "));!(o=l()).done;){var c=o.value;if(c.startsWith(i.animationClassPrefix)){s=c.substr(i.animationClassPrefix.length);break}}if(!(s=e.resolveAnimationClass(s))||""===s.trim())return"";var u=d[a.type];return s.toUpperCase()+"&"+u.toUpperCase()},e.resolveAnimationClass=function(e){if(!e)return null;for(var t=e.toUpperCase(),n=0;n<10;n++){var i=_.animationAliases[t];if(!i)return t;t=i}return null},e}();Object(i.a)(S,"WacAirSpaceEngine",null,[]);var C=n(52),A=n(22),I=n(10),w=n(122);n.d(t,"WacAirSpace",(function(){return T}));var T=function(){function e(){}return e.registerDomEvents=function(){$addHandler(window,"resize",e.onResize)},e.onResize=function(t){e.temporarilyDisableAnimation(500)},e.temporarilyDisableAnimation=function(t){var i=n(1).AFrameworkApplication;if(!e.isAnimationTurnedOff()&&i.theTaskManager){e.toggleAnimation();var a=new r.a(4,1,t,e.toggleAnimationTask,18);0,i.theTaskManager.addTask(a)}},e.toggleAnimationTask=function(t){e.toggleAnimation()},e.animate=function(t,i,r){var a=n(1).AFrameworkApplication;if(e.isAnimationTurnedOff())return e.moveElementWithoutAnimation(t,i,r),new l(0);try{if(!t.element)return null;if(!t.element.id||""===t.element.id.trim())return e.moveElementWithoutAnimation(t,i,r),new l(0);new WacAnimation.State;var s=o.create(-1,t,t.element,i,r);return e.initWacAirSpaceEngine(),a.theWacAirSpaceEngine.animate(s)}catch(n){return e.moveElementWithoutAnimation(t,i,r),new l(0)}},e.isAnimationTurnedOff=function(){return!!I.a.isIPad||!e._isAnimationEnabled},e.toggleAnimation=function(){e._isAnimationEnabled=!e._isAnimationEnabled},e.initWacAirSpaceEngine=function(){var e=n(1).AFrameworkApplication;e.theWacAirSpaceEngine||(e.theWacAirSpaceEngine=new S)},e.moveElementWithoutAnimation=function(t,n,i){var r=o.create(0,t,t.element,n,i);n&&n(r),e.setX(t),e.setY(t),e.setHeight(t),e.setWidth(t),e.setOpacity(t),e.setScroll(t),e.setRotateZ(t),i&&i(r)},e.cloneElement=function(t,n,i){if(!t||!t.parentNode)return null;if(t.id&&-1!==t.id.indexOf("_clone"))return t;var r=document.getElementById(t.id+"_clone");if(!r){r=document.createElement("div");var a=t.style,o=e.isCssSizeInPixels(a.top)?A.DomUtils.parseCssSizeDouble(a.top):t.offsetTop,s=t.parentNode;s.offsetTop>o&&(o=s.offsetTop);var l,c,u=e.isCssSizeInPixels(a.left)?A.DomUtils.parseCssSizeDouble(a.left):t.offsetLeft;l=e.isCssSizeInPixels(a.width)?A.DomUtils.parseCssSizeDouble(a.width):t.offsetWidth?t.offsetWidth:s.offsetWidth,c=e.isCssSizeInPixels(a.height)?A.DomUtils.parseCssSizeDouble(a.height):t.offsetHeight?t.offsetHeight:s.offsetHeight;var d=C.CssUtils.getCurrentStyle(t).zIndex,p=r.style;p.position="absolute",p.display=a.display,p.top=o+"px",p.left=u+"px",null!=l&&(p.width=l+"px"),null!=c&&(p.height=c+"px"),p.zIndex=d,A.DomUtils.copyChildNodes(t,r),r.className=t.className+" AirspaceClone",r.id=t.id+"_clone",n&&I.a.setOpacity(t,0),i?s.insertBefore(r,t):s.appendChild(r)}return r},e.setContextVariable=function(e,t){if(e&&""!==e.trim())try{(new WacAnimation.ContextVariableManager).SetContextVariable(e.toUpperCase(),t)}catch(e){throw e}},e.setAnimationClass=function(t,n){t&&(Sys.UI.DomElement.addCssClass(t,e.animationClassPrefix+n),e.assignUniqueId(t))},e.removeAnimationClass=function(t,n){Sys.UI.DomElement.removeCssClass(t,e.animationClassPrefix+n)},e.assignUniqueId=function(e){e.id&&""!==e.id.trim()||(e.id="WacAirSpace"+w.a.create())},e.getAnimationStats=function(){for(var e=WacAnimation.Telemetry.GetRecentAnimationStats(),t=new Array(e.length),n=0;n<e.length;n++){var i=e[n];if(i){var r=i[1],a=i[2],o=i[3],s=i[5],l=i[9],c=i[10],d=i[11];t[n]=new u(r,a,o,s,l,c,d)}}return t},e.setX=function(e){isNaN(e.finalX)||(e.useRightAttributeForX?e.useRelativePositioning?e.element.style.marginRight=e.finalX+"px":e.element.style.right=e.finalX+"px":e.useRelativePositioning?e.element.style.marginLeft=e.finalX+"px":e.element.style.left=e.finalX+"px")},e.setY=function(e){isNaN(e.finalY)||(e.useRelativePositioning?e.element.style.marginTop=e.finalY+"px":e.element.style.top=e.finalY+"px")},e.setHeight=function(e){isNaN(e.finalHeight)||(e.element.style.height=e.finalHeight+"px")},e.setWidth=function(e){isNaN(e.finalWidth)||(e.element.style.width=e.finalWidth+"px")},e.setOpacity=function(e){isNaN(e.finalOpacity)||I.a.setOpacity(e.element,e.finalOpacity)},e.setScroll=function(e){isNaN(e.finalScrollTop)&&isNaN(e.finalScrollLeft)||(isNaN(e.finalScrollTop)||(e.element.scrollTop=e.finalScrollTop),isNaN(e.finalScrollLeft)||(e.element.scrollLeft=e.finalScrollLeft))},e.setRotateZ=function(e){isNaN(e.finalRotateZ)||C.CssUtils.setRotation(e.element,e.finalRotateZ)},e.isCssSizeInPixels=function(e){if(!e)return!1;var t=e.trim(),n=t.charAt(0),i=t.charAt(t.length-1);return!(n<"0"||n>"9")&&!((i<"0"||i>"9")&&!t.endsWith("px"))},e}();T.animationClassPrefix="WacAirSpace",T._isAnimationEnabled=!0,Object(i.a)(T,"WacAirSpace",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.startWacBoot="StartWacBoot",r.userClickedHostUI="UserClickedHostUI",r.hostDuration="HostDuration",r.hostPageFetchStart="HostPageFetchStart",r.serverDiagnostics="ServerDiagnostics",r.bootDiagnostics="BootDiagnostics",r.eupl="EUPL",r.bootResourceStart="BootResourceStart",r.bootResourceForContentEditableEnd="BootResourceForContentEditableEnd",r.bootResourceForContentViewableStart="BootResourceForContentViewableStart",r.bootResourceForContentViewableEnd="BootResourceForContentViewableEnd",r.additionalBootResourceStart="AdditionalBootResourceStart",r.additionalBootResourceEnd="AdditionalBootResourceEnd",r.resourceDownload="ResourceDownload",r.resourceDownloadStart="ResourceDownloadStart",r.resourceDownloadDuration="ResourceDownloadDuration",r.firstSliceLoad="FirstSliceLoad",r.firstSliceLoadStart="FirstSliceLoadStart",r.firstSliceLoadDuration="FirstSliceLoadDuration",r.secondSliceLoadStart="SecondSliceLoadStart",r.secondSliceLoadDuration="SecondSliceLoadDuration",r.collabSliceLoad="CollabSliceLoad",r.collabSliceLoadStart="CollabSliceLoadStart",r.collabSliceLoadDuration="CollabSliceLoadDuration",r.contentFetch="ContentFetch",r.contentFetchStart="ContentFetchStart",r.contentRequestStartToFirstByteDuration="ContentRequestStartToFirstByteDuration",r.contentResponseStart="ContentResponseStart",r.contentDownloadDuration="ContentDownloadDuration",r.serverContentResponseStart="ServerContentResponseStart",r.checkFileInfoStartTime="CheckFileInfoStartTime",r.checkFileInfoEndTime="CheckFileInfoEndTime",r.getFlightedAppSettingsStartTime="GetFlightedAppSettingsStartTime",r.getFlightedAppSettingsEndTime="GetFlightedAppSettingsEndTime",r.acquireLockStartTime="AcquireLockStartTime",r.acquireLockEndTime="AcquireLockEndTime",r.getDocumentStartTime="GetDocumentStartTime",r.getDocumentEndTime="GetDocumentEndTime",r.hostRenderingContentViewable="HostRenderingContentViewable",r.initialRequestInvokedTime="InitialRequestInvokedTime",r.initialResponseReceivedTime="InitialResponseReceivedTime",r.initialResponseReadyTime="InitialResponseReadyTime",r.skeletalDismissStart="SkeletalDismissStart",r.skeletalDismissDuration="SkeletalDismissDuration",r.fastViewOpenTime="FastViewOpenTime",r.fastViewEntryPoint="FastViewEntryPoint",r.fastViewDismissStart="FastViewDismissStart",r.fastViewDismissDuration="FastViewDismissDuration",r.contentViewable="ContentViewable",r.contentViewableHiddenSSR="ContentViewableHiddenSSR",r.contentEditableEnd="ContentEditableEnd",r.editable="Editable",r.contentEditable="ContentEditable",r.coreEditingStart="CoreEditingStart",r.coreEditingDuration="CoreEditingDuration",r.browserFetchStartToContentViewableDuration="StartToContentViewableDuration",r.browserFetchStartToContentEditableDuration="StartToContentEditableDuration",r.documentLoadedTime="DocumentLoadedTime",r.appInit="AppInit",r.appInitStart="AppInitStart",r.appInitDuration="AppInitDuration",r.wopiPendingInitialize="WopiPendingInitialize",r.wopiPendingComplete="WopiPendingComplete",r.startSessionStart="StartSessionStart",r.startSessionComplete="StartSessionComplete",r.readyMessageReceiveTime="ReadyMessageReceiveTime",r.completeMessageCreateTime="CompleteMessageCreateTime",r.completeMessageSendTime="CompleteMessageSendTime",r.isStartSessionFromWac="IsStartSessionFromWac",r.appSettingsFetched="AppSettingsFetched",r.frameNavigationStart="FrameNavigationStart",r.frameFetchStart="FrameFetchStart",r.frameDomainLookupStart="FrameDomainLookupStart",r.frameDomainLookupEnd="FrameDomainLookupEnd",r.frameConnect="FrameConnect",r.frameConnectStart="FrameConnectStart",r.frameSecureConnectionStart="FrameSecureConnectionStart",r.frameConnectEnd="FrameConnectEnd",r.frameRequest="FrameRequest",r.frameRequestStart="FrameRequestStart",r.frameResponse="FrameResponse",r.frameResponseStart="FrameResponseStart",r.frameDownloadDuration="FrameDownloadDuration",r.frameRequestStartToFirstByteDuration="FrameRequestStartToFirstByteDuration",r.frameTransferSize="FrameTransferSize",r.frameDecodedSize="FrameDecodedSize",r.frameEncodedSize="FrameEncodedSize",r.inbound="Inbound",r.inboundStart="InboundStart",r.inboundEnd="InboundEnd",r.parseResponse="ParseResponse",r.parseResponseStart="ParseResponseStart",r.parseResponseDuration="ParseResponseDuration",r.parseResponseDeserialization="ParseResponseDeserialization",r.parseResponseDeserializationStart="ParseResponseDeserializationStart",r.parseResponseDeserializationDuration="ParseResponseDeserializationDuration",r.pageViewSize="PageViewSize",r.pageViewValidationStart="PageViewValidationStart",r.pageViewValidationEnd="PageViewValidationEnd",r.pageViewValidationDuration="PageViewValidationDuration",r.pageViewValidation="PageViewValidation",r.validationPhaseDurations="ValidationPhaseDurations",r.renderDuration="RenderDuration",r.navPaneValidation="NavPaneValidation",r.navPaneValidationStart="NavPaneValidationStart",r.navPaneValidationDuration="NavPaneValidationDuration",r.navPaneValidationPhaseDurations="NavPaneValidationPhaseDurations",r.navPaneRenderDuration="NavPaneRenderDuration",r.pageViewInitSelection="PageViewInitSelection",r.pageViewInitSelectionStart="PageViewInitSelectionStart",r.scrollDuration="Scroll Duration",r.scrollDurationStart=":Scroll:Start",r.scrollDurationEnd=":Scroll:End",r.getCellsStartToClientGetCellsFetchStartDuration="GetCellsStartToClientGetCellsFetchStartDuration",r.getCellsBrowserStats="GetCellsBrowserStats",r.graphObjectUsage="GraphObjectUsage",r.paragraphUsage="ParagraphUsage",r.metadataContentBytes="ContentBytes",r.metadataEmptyDoc="EmptyDoc",r.userActions="UserActions",r.visiToggled="VisiToggled",r.pageTargetSource="PageTargetSource",r.isNewFile="IsNewFile",r.newFileTemplateName="TemplateName",r.newFileTemplateLcid="TemplateLcid",r.toExtendedGuidAvgCallDuration="ToExtendedGuidAvgCallDuration",r.toExtendedGuidTotalCallDuration="ToExtendedGuidTotalCallDuration",r.indexedDBErrorMessage="IndexedDBErrorMessage",r.indexedDBOpenStart="IndexedDBOpenStart",r.indexedDBOpenDuration="IndexedDBOpenDuration",r.indexedDBUpgradeDuration="IndexedDBUpgradeDuration",r.indexedDBOpenErrorDuration="IndexedDBOpenErrorDuration",r.indexedDBGetDuration="IndexedDBGetDuration",r.indexedDBGetErrorDuration="IndexedDBGetErrorDuration",r.indexedDBPutStart="IndexedDBPutStart",r.indexedDBPutDuration="IndexedDBPutDuration",r.indexedDBPutErrorDuration="IndexedDBPutErrorDuration",r.indexedDBCacheHitState="IndexedDBCacheHitState",r.isContentSync="IsContentSync",r.socketInitStart="SocketInitStart",r.socketConnectDuration="SocketConnectDuration",r.socketOpenDuration="SocketOpenDuration",r.socketOpenTimeout="SocketOpenTimeout",r.socketCloseBeforeOpen="SocketCloseBeforeOpen",r.tenantId="OneNoteTenantId",r.isEduUser="IsEduUser",r.contentSyncFallbackMessage="ContentSyncFallbackMessage",r.hierarchyFetch="HierarchyFetch",r.hierarchyTransformation="HierarchyTransformation",r.isDullScript="IsDullScript",r.isWacBootNewJS="IsWacBootNewJS",r.officeInitializationTime="OfficeInitializationTime",r.modeSwitchTime="ModeSwitchTime",r.isFallback="IsFallback",r.isInstant="IsInstant",r.hostInitDiagnostics="HostInitializeDiagnostics",r.jsApiDiagnostics="JsApiDiagnostics",r.digitalPrintSaveDuration="DigitalPrintSaveDuration",r.digitalPrintTimeSpent="DigitalPrintTimeSpent",r.swayPreviewRequestDuration="SwayPreviewRequestDuration",r.swayPreviewFailedRequestDuration="SwayPreviewFailedRequestDuration",r.swayCheckSwayLicenseRequestDuration="SwayCheckSwayLicenseRequestDuration",r.swayCheckSwayLicenseFailedRequestDuration="SwayCheckSwayLicenseRequestFailedDuration",r.ribbonInteractiveReady="RibbonInteractiveReady",r.deepLinkingCommentSelected="SharedCommentsDeepLinkComplete",r.isJsApi="IsJsApi",r.bootstrapper="Bootstrapper",r.navigationViewableCacheUsed="NavigationViewableCacheUsed",r.navigationEditableCacheUsed="NavigationEditableCacheUsed",r.bootSSRHtmlStringLength="BootSSRHtmlStringLength",r.networkType="NetworkType",r.appStaticResourceMetrics="AppStaticResources",r.onPollHitWhenResponseWasReadyButWasNotParsedCount="OnPollHitWhenResponseWasReadyButWasNotParsedCount",r.onPollHitWhenResponseWasReadyStart="OnPollHitWhenResponseWasReadyStart",r.wordBootPerfDebuggingMetrics="WordBootPerfDebuggingMetrics",r.splashScreenShown="SplashScreenShown",r.firstPaint="FirstPaint",r.firstContentfulPaint="FirstContentfulPaint",r.cloudFontFetchStart="CloudFontFetchStart",r.cloudFontRequestStartToFirstByteDuration="CloudFontRequestStartToFirstByteDuration",r.cloudFontResponseStart="CloudFontResponseStart",r.cloudFontDownloadDuration="CloudFontDownloadDuration",r.loadRibbonProcessStart="LoadRibbonProcessStart",r.loadRibbonProcessEnd="LoadRibbonProcessEnd",r.renderRibbonStart="RenderRibbonStart",r.renderRibbonDuration="RenderRibbonDuration",r.initializeWordRibbonStart="InitializeWordRibbonStart",r.ribbonCommandDefinitionMappingStart="RibbonCommandDefinitionMappingStart",r.ribbonCommandDefinitionMappingEnd="RibbonCommandDefinitionMappingEnd",r.loadGraphicsEditorRibbonInitialLaunchProcessStart="LoadGraphicsEditorRibbonInitialLaunchProcessStart",r.loadGraphicsEditorRibbonInitialLaunchProcessEnd="LoadGraphicsEditorRibbonInitialLaunchProcessEnd",r.loadGraphicsEditorRibbonProcessStart="LoadGraphicsEditorRibbonProcessStart",r.loadGraphicsEditorRibbonProcessEnd="LoadGraphicsEditorRibbonProcessEnd",r.disposeEndAfterParse="DisposeEndAfterParse",r.setInitialSelectionTaskAdded="SetInitialSelectionTaskAdded",r.disposeStartAfterSetInitialSelection="DisposeStartAfterSetInitialSelection",r.disposeEndAfterSetInitialSelection="DisposeEndAfterSetInitialSelection",r.setupInitialFocusStart="SetupInitialFocusStart",r.setupInitialFocusEnd="SetupInitialFocusEnd",r.synchronizeWithFastViewStart="SynchronizeWithFastViewStart",r.synchronizeWithFastViewEnd="SynchronizeWithFastViewEnd",r.graphTransactionStart="GraphTransactionStart",r.renderedOutlineView="RenderedOutlineView",r.shouldRenderOutlineGroup="ShouldRenderOutlineGroup",r.wacPerfObserver="WacPerfObserver",r.reactNotificationManagerStart="ReactNotificationManagerStart",r.reactNotificationManagerDuration="ReactNotificationManagerDuration",r.networkDisconnectedStart="NetworkDisconnectedStart",r.networkDisconnectedEnd="NetworkDisconnectedEnd",r.loggingDuringBootDuration="LoggingDuringBootDuration",Object(i.a)(r,"Metrics",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(1),o=n(205),s=n(186);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(){function e(){this._regionNames=null}var t,n,i,r=e.prototype;return r.getRegion=function(e){return null},r.registerBoundingWindowRectsChanged=function(e,t){},r.unregisterBoundingWindowRectsChanged=function(e,t){},r.registerLayoutBreakpointChanged=function(e,t){},r.unregisterLayoutBreakpointChanged=function(e){},r.getLayoutBreakpoint=function(){return"Default"},r.getWindowMode=function(){return"undefined"},r.getKeyboardSegment=function(){return null},r.getWindowRectsWithoutKeyboard=function(){return null},r.show=function(e){void 0===e&&(e=null)},t=e,(n=[{key:"regionNames",get:function(){return this._regionNames||(this._regionNames=new o.a(s.a.get_ordinalIgnoreCase()),this._regionNames.add("Header","Header"),this._regionNames.add("Ribbon","Ribbon"),this._regionNames.add("NotificationBar","NotificationBar"),this._regionNames.add("BusinessBar","BusinessBar"),this._regionNames.add("Canvas","Canvas"),this._regionNames.add("FarPane","FarPane"),this._regionNames.add("StatusBar","StatusBar"),this._regionNames.add("Ruler","Ruler")),this._regionNames}}])&&l(t.prototype,n),i&&l(t,i),e}();Object(i.a)(c,"AAdaptiveLayout",null,[225]);var u=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(c);Object(i.a)(u,"AdaptiveLayoutEmptyImpl",c,[]);var d=n(321),p=function(){this.selector=null,this.definition=null,this.index=0};function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(p,"CssRule",null,[]);var m=function(){function e(e,t,n,i){this._model=e,this._broswerRule=t,this._parentSheet=n,this._readOnly=i}var t,n,i;return t=e,(n=[{key:"style",get:function(){return this._broswerRule.style}},{key:"selectorText",get:function(){return this._broswerRule.selectorText}},{key:"parentSheet",get:function(){return this._parentSheet}},{key:"isReadOnly",get:function(){return this._readOnly}}])&&h(t.prototype,n),i&&h(t,i),e}();Object(i.a)(m,"StyleRule",null,[]);n(9);var g=n(17),f=n(39),v=n(10),_=n(3);function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var b=function(){function e(e,t,n,i,r){this._styleElementOnLoad=null,this._retryDelay=0,this._retryAttempts=0,this._onLoadCallbacks=[],this._ownerDocument=e,this._model=t,this._browserSheet=n,this._styleElement=i,this._readOnly=r,this._loaded=!r,this._pendingCssRules=[]}var t,n,i,o=e.prototype;return o.dispose=function(){this._styleElement=null,this._browserSheet=null,this._ownerDocument=null},o.remove=function(){this._browserSheet&&this._styleElement&&this._styleElement.parentNode.removeChild(this._styleElement)},o.addLoadHandler=function(e){e&&(this._loaded?e(this):(Array.add(this._onLoadCallbacks,e),this._styleElementOnLoad||(this._styleElementOnLoad=Object(r.d)(this,this.onLoad,"onLoad"),g.a.addHandler(this._styleElement,"load",this._styleElementOnLoad))))},o.addRule=function(e,t,n){if(t&&!t.length)throw Error.argument("css definition must be valid css or null");switch(_.ULS.shipAssertTag(17154717,324,this._loaded&&!!this._browserSheet),this._model){case 1:this._browserSheet.addRule(e,t,n);break;case 2:if(this._browserSheet){var i=t||"";this._browserSheet.insertRule(e+" {"+i+"}",n)}else{if(!this._loaded&&this._retryAttempts<5){var r=new p;r.selector=e,r.definition=t,r.index=n,Array.add(this._pendingCssRules,r)}_.ULS.sendTraceTag(17342615,324,15,"Fail to insert Css Rule since _brwoserSheet is null. selector={0} definition={1} index={2} _retryAttempts={3}",e,t,n,this._retryAttempts)}break;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}},o.removeRule=function(e){switch(_.ULS.shipAssertTag(17154718,324,this._loaded&&!!this._browserSheet),this._model){case 1:this._browserSheet.removeRule(e);break;case 2:this._browserSheet.deleteRule(e)}},o.getRuleCount=function(){switch(_.ULS.shipAssertTag(17154719,324,this._loaded&&!!this._browserSheet),this._model){case 1:return this._browserSheet.rules.length;case 2:return this._browserSheet.cssRules.length;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}},o.getRule=function(e){var t;switch(_.ULS.shipAssertTag(17154720,324,this._loaded&&!!this._browserSheet),this._model){case 1:return(t=this._browserSheet.rules.item(e))?new m(1,t,this,this._readOnly):null;case 2:return(t=this._browserSheet.cssRules[e])?new m(1,t,this,this._readOnly):null;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}},o.onLoad=function(e){if(this._browserSheet){this._loaded=!0;for(var t=0;t<this._onLoadCallbacks.length;t++){(0,this._onLoadCallbacks[t])(this)}Array.clear(this._onLoadCallbacks),this._styleElementOnLoad&&(g.a.removeHandler(this._styleElement,"load",this._styleElementOnLoad),this._styleElementOnLoad=null);for(var n=0;n<this._pendingCssRules.length;n++){var i=this._pendingCssRules[n],r=i.definition||"";this._browserSheet.insertRule(i.selector+" {"+r+"}",i.index)}Array.clear(this._pendingCssRules)}},o.findSheet=function(e){for(var t=this._ownerDocument.styleSheets,n=0;n<t.length;n++){var i=t[n].ownerNode;if(this._styleElement===i)return this._browserSheet=t[n],void this.onLoad(null)}++this._retryAttempts<5?(this._retryDelay*=3,this.createFindhCallbackTask()):_.ULS.sendTraceTag(17154721,324,10,"Failed to load stylesheet after max retry attempts, abandoning search")},o.createFindhCallbackTask=function(){var e=new f.a(2,1,this._retryDelay,Object(r.d)(this,this.findSheet,"findSheet"),11);a.AFrameworkApplication.theTaskManager.addTask(e)},e.createStyleSheet=function(t,n){return void 0===n&&(n=null),e.createOrImportStyleSheet(t,n)},e.importStyleSheet=function(t,n,i){return e.createOrImportStyleSheet(t,i,n)},e.createOrImportStyleSheet=function(t,n,i){void 0===i&&(i=null);var r=null;return t.createStyleSheet?r=e.createStylesheetUsingCreateStyleSheetFunction(t,i,n):t.styleSheets&&(r=e.createStylesheetUsingStyleSheetsCollection(t,i,n)),r},e.createStylesheetUsingCreateStyleSheetFunction=function(t,n,i){var r=n?t.createStyleSheet(n):t.createStyleSheet(),a=new e(t,1,r,r.owningElement,!!n);return i&&a.addLoadHandler(i),a},e.createStylesheetUsingStyleSheetsCollection=function(t,n,i){var r=n?e.createLinkElement(t,n):e.createStyleElement(t),a=new e(t,2,null,r,!!n);return t.getElementsByTagName("head")[0].appendChild(r),e.attemptToLoadSheet(t,a,r,i),a},e.createLinkElement=function(e,t){var n=e.createElement("link");return n.rel="stylesheet",n.href=t,n.type="text/css",n},e.createStyleElement=function(e){var t=e.createElement("style"),n=e.createTextNode(" ");return t.appendChild(n),t},e.attemptToLoadSheet=function(e,t,n,i){for(var r=e.styleSheets,o=0;o<r.length;o++){if(n===r[o].ownerNode){t._browserSheet=r[o],t.addLoadHandler(i);var s=new f.a(0,1,0,(function(e){t.onLoad(null)}),10);0,a.AFrameworkApplication.theTaskManager.addTask(s)}}t._browserSheet||(t._retryDelay=100,t._loaded=!1,t.addLoadHandler(i),t.createFindhCallbackTask())},e.importStyleSheetFromText=function(e){try{var t=document.createElement("style");return t.type="text/css",t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t),t}catch(t){_.ULS.sendTraceTag(40137891,210,10,"ImportStyleSheetFromText error message : {0}.",t.message);var n=document.createStyleSheet();return n.cssText=e,n.owningElement}},t=e,(n=[{key:"styleElement",get:function(){return this._styleElement}},{key:"isReadOnly",get:function(){return this._readOnly}},{key:"isLoaded",get:function(){return this._loaded}}])&&y(t.prototype,n),i&&y(t,i),e}();Object(i.a)(b,"StyleSheet",null,[4]);var S=n(52),C=n(50),A=function(){function e(t){this._styleSheet=null,this._selectors=[],this._numCssRules=0,this._rulesErrorFirstHitTime=0,this._rulesErrorLogged=!1,this._cssState=0,this._controllerID=e._currentControllerCount++,this._controlledElement=t,this._selectorText="cursorControl"+this._controllerID,Array.addRange(this._selectors,["."+this._selectorText,"."+this._selectorText+" *"]),t.id&&""!==t.id&&Array.add(this._selectors,"#"+t.id+" *"),Sys.UI.DomElement.addCssClass(this._controlledElement,this._selectorText)}var t=e.prototype;return t.dispose=function(){C.a(this._styleSheet),this._styleSheet=null,this._controlledElement=null},t.setCursor=function(e){switch(e){case 1:this.setCursorString("crosshair");break;case 2:this.setCursorString("pointer");break;case 3:this.setCursorString("move");break;case 4:this.setCursorString("e-resize");break;case 5:this.setCursorString("ne-resize");break;case 6:this.setCursorString("nw-resize");break;case 7:this.setCursorString("n-resize");break;case 8:this.setCursorString("se-resize");break;case 9:this.setCursorString("sw-resize");break;case 10:this.setCursorString("s-resize");break;case 11:this.setCursorString("w-resize");break;case 12:this.setCursorString("text");break;case 13:this.setCursorString("wait");break;case 14:this.setCursorString("help");break;case 20:this.setCursorString("col-resize");break;case 21:this.setCursorString("row-resize");break;case 15:this.setCursorString("not-allowed");break;case 22:this.setCursorString("default");break;default:0}},t.setCursorUrl=function(e,t){var n;switch(t){case 1:n="crosshair";break;case 2:n="pointer";break;case 3:n="move";break;case 4:n="e-resize";break;case 5:n="ne-resize";break;case 6:n="nw-resize";break;case 7:n="n-resize";break;case 8:n="se-resize";break;case 9:n="sw-resize";break;case 10:n="s-resize";break;case 11:n="w-resize";break;case 12:n="text";break;case 13:n="wait";break;case 14:n="help";break;case 20:n="col-resize";break;case 21:n="row-resize";break;default:return void 0}this.setCursorString("url('"+e+"'), "+n)},t.resetCursor=function(){var e=this;this.ensureCssIsLoaded((function(){if(3===e._cssState){for(var t=0;t<e._numCssRules;++t)e.updateCssRuleCursorStyleSafe("",t);e._cssState=2}}))},t.pinCursor=function(e){var t=S.CssUtils.getCurrentStyle(e);t&&this.setCursorString(t.cursor)},t.setCursorString=function(e){var t=this;this.ensureCssIsLoaded((function(){if(2===t._cssState){for(var n=0;n<t._numCssRules;++n)t.updateCssRuleCursorStyleSafe(e,n);t._cssState=3}}))},t.updateCssRuleCursorStyleSafe=function(e,t){var n=null;try{n=this._styleSheet.getRule(t)}catch(e){_.ULS.sendTraceTag(17342976,324,15,"GetRule({0}) threw an exception:{1}.",t,e.message)}n?n.style.cursor=e:this.monitorNullCssRuleError(t)},t.monitorNullCssRuleError=function(e){if(this._rulesErrorFirstHitTime<=0)this._rulesErrorFirstHitTime=Date.now(),_.ULS.sendTraceTag(17342977,324,15,"GetRule({0}) returned null.",e);else if(!this._rulesErrorLogged){var t=(Date.now()-this._rulesErrorFirstHitTime)/1e3;t>30&&(_.ULS.sendTraceTag(17342978,324,10,"GetRule({0}) still returns null, causing improper cursor/drag experience, {1} seconds after first hit!",e,t),this._rulesErrorLogged=!0)}},t.ensureCssIsLoaded=function(e){this._cssState?e():this.createStylesheet(e)},t.createStylesheet=function(e){var t=this;this._styleSheet=b.createStyleSheet(this._controlledElement.ownerDocument,(function(n){t._styleSheet=n;for(var i=0,r=t._selectors.length;i<r;++i)t._styleSheet.addRule(t._selectors[i],null,i),t._numCssRules++;t._cssState=2,e()})),this._styleSheet||(this._cssState=1)},e}();A._currentControllerCount=0,Object(i.a)(A,"CursorManager",null,[205,4]);n(54);var I=n(71),w=n(41);var T=function(e){var t,n;function i(t,n,i){return e.call(this,t,n,i,1)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(w.EventHandlerArgs);Object(i.a)(T,"CompositionEventHandlerArgs",w.EventHandlerArgs,[]);var E=n(4),k=function(){function e(e){this._eventHandlerManager=e}var t=e.prototype;return t.registerHandler=function(e,t,n,i){this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onCompositionEvent,"onCompositionEvent"),n,i)},t.unregisterHandler=function(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)},t.onCompositionEvent=function(e,t,n){return this._eventHandlerManager.processEvent(e,t,new T(e,t,n))},e.isCompositionEventName=function(e){return e===E.EventNames.compositionStart||e===E.EventNames.compositionUpdate||e===E.EventNames.compositionEnd},e}();Object(i.a)(k,"CompositionEventManager",null,[]);var M=n(140),P=n(182),F=n(48),D=n(24),O=n(20),R=n(73),x=n(28);var U=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i,1)||this).text=i.data,r}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(w.EventHandlerArgs);Object(i.a)(U,"TextInputEventHandlerArgs",w.EventHandlerArgs,[]);var B=function(){function e(e){this._eventHandlerManager=e}var t=e.prototype;return t.registerHandler=function(e,t,n,i){this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onTextInputEvent,"onTextInputEvent"),n,i)},t.unregisterHandler=function(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)},t.onTextInputEvent=function(e,t,n){return this._eventHandlerManager.processEvent(e,t,new U(e,t,n))},e.isTextInputEventName=function(e){return e===E.EventNames.textInput||e===E.EventNames.input},e}();Object(i.a)(B,"TextInputEventManager",null,[]);var L=n(57),N=n(108),H=n(102),W=n(7),j=n(11),V=function(){function e(){this.foregroundTextColor=null,this.backgroundColor=null,this.linkColor=null}return e.prototype.toString=function(){return String.format("ForegroundTextColor: {0}, BackgroundColor: {1}, LinkColor: {2}",this.foregroundTextColor,this.backgroundColor,this.linkColor)},e}();Object(i.a)(V,"HighContrastColors",null,[]);var K=n(13);function z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var q=function(){function e(t){this._areAllHighContrastValuesValid=!0,this._validColorPatternRegularExpression=new RegExp("#[0-9A-Fa-f]{6}"),this._highContrastColors=null,this.screenReaderDetector=null,this._isScreenReaderPresent=!1,this._highContrastColorsQueryParameter=null;var n=t.ownerDocument.createElement("div");n.id=e.highContrastDetectionDivId,n.setAttribute(W.a.ariaRoleAttribute,W.a.ariaPresentationRole),n.setAttribute(W.a.ariaHiddenAttribute,W.a.ariaTrueValue);var i=t.ownerDocument.createElement("a");i.setAttribute("href","#"),i.id=e.highContrastDetectionAnchorId,i.setAttribute(W.a.ariaRoleAttribute,W.a.ariaPresentationRole),i.setAttribute(W.a.ariaHiddenAttribute,W.a.ariaTrueValue),n.appendChild(i),t.appendChild(n);var r=S.CssUtils.getCurrentStyle(n),a=S.CssUtils.getCurrentStyle(i);this._isInHighContrastMode=!!a&&-1===a.backgroundImage.toLowerCase().indexOf(e.highContrastDetectionAnchorDefaultBackgroundImageName),r&&a||_.ULS.sendTraceTag(25523335,334,50,"HighContrastDetector foregroundBackgroundCurrentStyle is null:[{0}] and linkCurrentStyle is null:[{1}]",!r,!a),this._isInHighContrastMode&&(this._highContrastColors=r?this.getNormalizedHighContrastHexValuesFromColor(r.color.toLowerCase(),r.backgroundColor.toLowerCase(),a.color.toLowerCase()):null,this._areAllHighContrastValuesValid||_.ULS.sendTraceTag(19223450,334,15,"We believe the user is in high contrast mode, but encountered an invalid color value (transparent or window)")),_.ULS.sendTraceTag(18458837,334,50,"HighContrastDetector.ctor: IsInHighContrastMode=[{0}], HighContrastColors=[{1}]",this._isInHighContrastMode,this._highContrastColors),t.removeChild(n);var o=t.ownerDocument.createElement("div");o.id="screenReaderDetectionDiv",o.setAttribute(W.a.ariaRoleAttribute,W.a.ariaPresentationRole),o.setAttribute(W.a.ariaHiddenAttribute,W.a.ariaTrueValue),t.appendChild(o)}var t,n,i,r=e.prototype;return r.getNormalizedHighContrastHexValuesFromColor=function(e,t,n){var i,r,a,o=this.tryGetNormalizedColor(e,Object(j.a)((function(){return i}),(function(e){return i=e}))),s=this.tryGetNormalizedColor(t,Object(j.a)((function(){return r}),(function(e){return r=e}))),l=this.tryGetNormalizedColor(n,Object(j.a)((function(){return a}),(function(e){return a=e})));return o&&s&&l?Object.assign(new V,{backgroundColor:r,foregroundTextColor:i,linkColor:a}):(_.ULS.sendTraceTag(18458838,334,15,"Failed to parse system colors. isParsingForegroundTextColorSucceed({0}): {1}, isParsingBackgroundColorSucceed({2}): {3}, isParsingLinkColorSucceed({4}): {5}",o,e,s,t,l,n),null)},r.tryGetNormalizedColor=function(e,t){return this._validColorPatternRegularExpression.test(e)?t.val=e:"transparent"===e||"window"===e?(t.val="transparent",this._areAllHighContrastValuesValid=!1):t.val=this.convertRgbRawToHex(e),!!t.val},r.convertRgbRawToHex=function(e){if(e.startsWith("rgb(")){var t=e.indexOf("("),n=e.indexOf(","),i=e.lastIndexOf(","),r=e.indexOf(")");if(-1!==t&&-1!==n&&-1!==i&&n!==i&&-1!==r){var a=e.substring(t+1,n),o=e.substring(n+1,i),s=e.substring(i+1,r);return this.convertRgbToHex(a,o,s)}}return null},r.convertRgbToHex=function(e,t,n){return"#"+(e=K.a.convertToHex(parseInt(e),2))+(t=K.a.convertToHex(parseInt(t),2))+(n=K.a.convertToHex(parseInt(n),2))},t=e,(n=[{key:"isInHighContrastMode",get:function(){return this._isInHighContrastMode}},{key:"isScreenReaderPresent",get:function(){if(!this._isScreenReaderPresent&&(this.screenReaderDetector=document.getElementById("screenReaderDetectionDiv"),this.screenReaderDetector)){var e=S.CssUtils.getCurrentStyle(this.screenReaderDetector);e||_.ULS.sendTraceTag(25523334,334,50,"HighContrastDetector.IsScreenReaderPresent=false, current style is null"),this._isScreenReaderPresent=!!e&&-1===e.borderBottomStyle.toLowerCase().indexOf("dashed"),this._isScreenReaderPresent&&_.ULS.sendTraceTag(19137420,334,50,"HighContrastDetector.IsScreenReaderPresent=true")}return this._isScreenReaderPresent}},{key:"areAllHighContrastValuesValid",get:function(){return this._areAllHighContrastValuesValid}},{key:"highContrastColors",get:function(){return this._highContrastColors}},{key:"highContrastColorsQueryParameter",get:function(){return!this._highContrastColorsQueryParameter&&this._isInHighContrastMode&&this._highContrastColors&&this._areAllHighContrastValuesValid&&(this._highContrastColorsQueryParameter=String.format("{0}_{1}_{2}",this._highContrastColors.foregroundTextColor,this._highContrastColors.backgroundColor,this._highContrastColors.linkColor)),this._highContrastColorsQueryParameter}}])&&z(t.prototype,n),i&&z(t,i),e}();q.highContrastDetectionDivId="highContrastDetectionDiv",q.highContrastDetectionAnchorId="highContrastDetectionAnchor",q.highContrastDetectionAnchorDefaultBackgroundImageName="highcontrastdetectordefault",Object(i.a)(q,"HighContrastDetector",null,[201]);var G=n(16),Q=n(117);function Z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $=function(){function e(){}var t,n,i;return t=e,i=[{key:"cookieBannerId",get:function(){return Q.a.instance.isCookieComplianceEnabled?CookieComplianceConstants.cookieBannerId:"wacMsccBanner"}},{key:"msccCookieName",get:function(){return Q.a.instance.isCookieComplianceEnabled?CookieComplianceConstants.msccCookieName:"MSCC"}},{key:"msccLearnMoreId",get:function(){return Q.a.instance.isCookieComplianceEnabled?CookieComplianceConstants.msccLearnMoreId:"msccLearnMore"}}],(n=null)&&Z(t.prototype,n),i&&Z(t,i),e}();Object(i.a)($,"CookieComplianceConstantsWrapper",null,[]);var X=n(35),J=n(49),Y=n(8),ee=n(101);function te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"AFrame",(function(){return ie}));var ie=function(e){var t,n;function i(t,n){var o;return(o=e.call(this,n)||this)._mode=0,o._theCompositionEventManager=null,o._theTextInputEventManager=null,o._frameState=0,o._isDisposed=!1,o._lowerRibbonHeight=0,o._styleSheet=null,o._taskPaneManager=null,o._adaptiveLayoutInstance=null,o.theContextMenuInputManager=null,o.thePageManager=null,o.theErrorHandler=null,o.theF6Manager=null,o.upperRibbonHeight=0,o._isStaticUiTouchMode=!1,o._activeModalDivZIndex=-1,o._isOffline=!1,o._applicationInstance=t,o._eventSource=new J.a,o.eventHandlerManager=F.EventHandlerManager.instance,o.theFocusManager=D.FocusManager.instance(),o.theFocusManager.getScope(i.mainAppFocusId).parent=i.appFocusId,o.theKeyInputManager=O.KeyInputManager.instance,o.theKeyInputManager.initializeForElement(o.get_element()),o.theMouseInputManager=R.a.instance,o.theMouseInputManager.initializeForElement(o.get_element()),o.theTouchInputManager=L.a.instance,a.AFrameworkApplication.nativeSelectionAndContextMenu||o.theTouchInputManager.initializeForElement(o.get_element()),o.theClickInputManager=I.a.instance,o.theClickInputManager.initializeForElement(o.get_element()),o.theDragInputManager=P.a.instance,a.AFrameworkApplication.nativeSelectionAndContextMenu||o.theDragInputManager.initializeForElement(o.get_element()),a.AFrameworkApplication.nativeSelectionAndContextMenu||x.a.instance.initializeForElement(o.get_element()),o.theCursorManager=new A(o.get_element()),a.AFrameworkApplication.cursorPinningIsEnabled&&P.a.instance.registerCursorPinningTool(o.theCursorManager),o.theActionManager=a.AFrameworkApplication.theActionManager,D.FocusManager.registerActions(o.theActionManager),d.registerActions(o.theActionManager),D.FocusManager.registerShortcuts(o.theFocusManager),d.registerShortcuts(o.theFocusManager),o.theActionManager.addAction(Y.a.focusToBrowser,X.a.frame,Object(r.d)(o.theFocusManager,o.theFocusManager.focusToBrowser,"focusToBrowser")),o.theActionManager.addActionWithFlags(Y.a.doNothing,X.a.frame,i.doNothing,96),o.theActionManager.addActionWithFlags(Y.a.doNothingInEdit,X.a.frame,i.doNothing,100),o.theActionManager.addActionWithFlags(Y.a.doBrowserDefault,X.a.frame,Object(r.d)(ne(o),o.doBrowserDefault,"doBrowserDefault"),96),v.a.isInternetExplorerNonEdge?(Sys.UI.DomElement.addCssClass(document.body,"InternetExplorer"),v.a.isInternetExplorer8?Sys.UI.DomElement.addCssClass(document.body,"v8"):v.a.isInternetExplorer9&&Sys.UI.DomElement.addCssClass(document.body,"v9")):v.a.isInternetExplorerEdge?Sys.UI.DomElement.addCssClass(document.body,"IEEdge"):v.a.isFirefox?Sys.UI.DomElement.addCssClass(document.body,"FireFox"):v.a.isWebKit?Sys.UI.DomElement.addCssClass(document.body,"Safari"):v.a.isOpera12Older&&Sys.UI.DomElement.addCssClass(document.body,"Opera"),v.a.isIPad&&(Sys.UI.DomElement.addCssClass(document.body,"iPad"),v.a.iPadOsVersion>=6&&Sys.UI.DomElement.addCssClass(document.body,"v6up")),v.a.isIPhone&&Sys.UI.DomElement.addCssClass(document.body,"iPhone"),v.a.isMac&&Sys.UI.DomElement.addCssClass(document.body,"Mac"),v.a.isWindows&&Sys.UI.DomElement.addCssClass(document.body,"Windows"),v.a.isLinux&&Sys.UI.DomElement.addCssClass(document.body,"Linux"),v.a.isIPad||Sys.UI.DomElement.addCssClass(document.body,"usehover"),o._documentFocusHandler=Object(r.d)(ne(o),o.onDocumentFocus,"onDocumentFocus"),o._theLazyStopwatchBuilder=new ee.a(Object(r.d)(ne(o),o.makeStopwatchBuilder,"makeStopwatchBuilder")),o.applyTouchStyles(),o.applyScrollBarStyles(),g.a.addHandler(document.body,"focus",o._documentFocusHandler),g.a.addHandler(window.document,"focus",o._documentFocusHandler),b.createStyleSheet(n.ownerDocument,Object(r.d)(ne(o),o.updateStyleSheetWithLocalizableStyles,"updateStyleSheetWithLocalizableStyles")),a.AFrameworkApplication.hasExternalHeader&&o.buildExternalHeaderPanel(o.get_element(),!!o.applicationInstance&&o.applicationInstance.isRibbonFlexBoxLayoutEnabled),o._highContrastDetector=new q(n),o}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o,s,l,c=i.prototype;return c.getDOMElement=function(){return this.get_element()},c.set_businessBar=function(e){return e},c.add_modeSwitched=function(e){this.get_events().addHandler("ModeSwitched",e)},c.remove_modeSwitched=function(e){this.get_events().removeHandler("ModeSwitched",e)},c.add_onSetOffline=function(e){this.get_events().addHandler("OnSetOffline",e)},c.remove_onSetOffline=function(e){this.get_events().removeHandler("OnSetOffline",e)},c.updateCommandUI=function(e){void 0===e&&(e=!1)},c.setStaticUiTouchMode=function(e){this.isStaticUiTouchMode!==e&&(this._isStaticUiTouchMode=e,this.isStaticUiTouchMode?Sys.UI.DomElement.addCssClass(this.get_element(),"msosp-touch"):Sys.UI.DomElement.removeCssClass(this.get_element(),"msosp-touch"))},c.beginModal=function(e){-1===this.activeModalDivZIndex?this._activeModalDivZIndex=this.defaultModalDivZIndex:this._activeModalDivZIndex=this.activeModalDivZIndex+2},c.endModal=function(e){this._activeModalDivZIndex=this.activeModalDivZIndex-2,this.activeModalDivZIndex<this.defaultModalDivZIndex&&(this._activeModalDivZIndex=-1)},c.applyTouchStyles=function(){this.setStaticUiTouchMode(v.a.supportsTouch);a.AFrameworkApplication.appSettingsManager;var e=a.AFrameworkApplication.isMultiTouchGestureEnabled()&&a.AFrameworkApplication.isPinchToZoomEnabled();e&&Sys.UI.DomElement.addCssClass(document.body,i.touchPanOnlyCssClass)},c.applyScrollBarStyles=function(){a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ModernScrollBarIsEnabled")?Sys.UI.DomElement.addCssClass(document.body,i.modernScrollBarCssClass):Sys.UI.DomElement.addCssClass(document.body,i.legacyScrollBarCssClass)},c.updateStyleSheetWithLocalizableStyles=function(e){this._styleSheet=e;var t="font-family:"+this.uiFontFamily+";font-size:"+this.uiFontSize+";",n="font-family:"+this.uiFontFamilyLight+";font-size:"+this.uiFontSize+";",i="font-size:"+this.uiSmallFontSize+";",r="font-weight:"+this.uiFontWeightBold+";",a="text-transform:"+this.uiTextTranformUpperCase+";",o="font-family:"+this.uiFontFamily+";font-size:"+this.uiSmallFontSize+";";this._styleSheet.addRule(".UIFont, .AppHeaderPanel, .WACFrame, .WACFrameWord, .ewa-root-ltr, .ewa-root-rtl, .cui-menu, .WACDialogButtonNormal, .WACBusinessBarButton, .WACDialogPanel, .AppRegionComposer",t,0),this._styleSheet.addRule(".cui-floatie",o,0),this._styleSheet.addRule(".UIFontLight",n,0),this._styleSheet.addRule(".UISmallFont",i,0),this._styleSheet.addRule(".UIFontBold",r,0),this._styleSheet.addRule(".UITextTranformUpperCase",a,0);this.headerLargeFontSize;var s="-webkit-font-smoothing: antialiased;",l="font-size:"+this.jewelMenuFontSize+";"+s,c="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuFontSize+";font-weight:300;"+s,u="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuMainTitleFontSize+";font-weight:200;"+s,d="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuFileNameFontSize+";font-weight:300;"+s;this._styleSheet.addRule(".cui-jewelmenu .cui-ctl-mediumlabel",l,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-mediumlabel",c,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-menusection-titleAtTop",u,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-filenamelabel",d,0);var p="font-family:"+this.uiFontFamily+";font-weight:400;"+s,h="font-family:"+this.uiFontFamily+";font-size:"+this.uiFontSizeReactSmall+"pt;font-weight:400;"+s,m="font-family:"+this.uiFontFamily+";font-size:"+this.uiFontSizeReactLarge+"pt !important;font-weight:300;"+s,g="font-family:"+this.uiFontFamily+" !important;font-weight:400 !important;"+s;this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-filenamelabel.cui-menusection-filenametitle",h,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-menulabel",p,0),this._styleSheet.addRule(".cui-jewelmenu .cui-ctl-mediumlabel .cui-btn-title",p,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-menusection-titleAtTop",m,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-mediumlabel",g,0),this._styleSheet.addRule(".cui-jewelsubmenu #lblWheresTheSaveButton-MenuSaveButton .cui-btn-menu-description","font-weight:400;-webkit-font-smoothing: antialiased;",0);var f="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuMruButtonTitleFontSize+";",v="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuFooterButtonFontSize+";";this._styleSheet.addRule(".cui-jewelsubmenu .cui-mrubutton-title",f,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-footerbutton",v,0);var _="font-size:"+this.dialogTitleFontSize+";",y="font-size:"+this.dialogButtonFontSize+";",b="font-size:"+this.dialogTextFontSize+";",S="font-size:"+this.dialogTextLargeFontSize+";";this._styleSheet.addRule(".UIFontDialogTitle",_,0),this._styleSheet.addRule(".UIFontDialogButton",y,0),this._styleSheet.addRule(".UIFontDialogText",b,0),this._styleSheet.addRule(".UIFontDialogTextLarge",S,0);var C="font-family:"+this.uiFontFamilyLight+";font-size:"+this.taskPaneTitleFontSize+";";this._styleSheet.addRule(".cui-taskPaneTitle",C,0)},c.buildStatusBarPanel=function(){var e=document.createElement("div");return e.id=i._statusPanelId,e.className="WACStatusBarContainer",this.applicationInstance&&this.applicationInstance.isReactStatusBarEnabled?Sys.UI.DomElement.addCssClass(e,"reactStatusBar"):e.style.height=i.statusBarHeight+"px",this.applicationInstance&&this.applicationInstance.isRegionComposerEnabled&&Sys.UI.DomElement.addCssClass(e,"regionComposer"),this.applicationInstance&&this.applicationInstance.isRibbonFlexBoxLayoutEnabled&&Sys.UI.DomElement.addCssClass(e,"FlexBoxLayout"),this.applicationInstance&&this.applicationInstance.isRibbonVisualRefreshEnabled&&Sys.UI.DomElement.addCssClass(e,"MLRVisualRefresh"),this.get_element().appendChild(e),e},c.updateExistingStatusBarPanel=function(e,t){},c.buildExternalHeaderPanel=function(e,t){if(e.parentNode){var n=a.AFrameworkApplication.externalHeaderPanelClassName;t&&!a.AFrameworkApplication.hideHeaderEmbedded&&(n+=" FlexBoxLayout"),a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShyRibbonIsEnabled")&&(n+=" RaisedZIndex");var r=this.addAppHearderPanelIfNeeded(n,e);r.setAttribute("role","toolbar"),W.a.appendHiddenLabel(r,a.AFrameworkApplication.externalHeaderPanelId+"-label",a.AFrameworkApplication.externalHeaderLabel||CommonUIStrings.l_AppHeader_Label),O.KeyInputManager.instance.initializeForElement(r),R.a.instance.initializeForElement(r),L.a.instance.initializeForElement(r),I.a.instance.initializeForElement(r),P.a.instance.initializeForElement(r),x.a.instance.initializeForElement(r),M.a.instance.initializeForElement(r),M.a.instance.registerHandler(r,i.suppressContextMenuHandler,null)}},c.addAppHearderPanelIfNeeded=function(e,t){var n=document.getElementById(a.AFrameworkApplication.externalHeaderPanelId)||document.createElement("div");return n.id=a.AFrameworkApplication.externalHeaderPanelId,n.className.indexOf(e)<0&&(n.className=e+" "+n.className),t.parentNode.insertBefore(n,t),n},c.dispose=function(){this._isDisposed||(C.a(this._styleSheet),this._styleSheet=null,this._documentFocusHandler&&(g.a.removeHandler(document.body,"focus",this._documentFocusHandler),g.a.removeHandler(window.document,"focus",this._documentFocusHandler)),this._documentFocusHandler=null,H.a.currentDialog&&H.a.currentDialog.hide(),O.KeyInputManager.instance.deinitializeForElement(this.get_element()),R.a.instance.deinitializeForElement(this.get_element()),a.AFrameworkApplication.nativeSelectionAndContextMenu||L.a.instance.deinitializeForElement(this.get_element()),I.a.instance.deinitializeForElement(this.get_element()),a.AFrameworkApplication.nativeSelectionAndContextMenu||(P.a.instance.deinitializeForElement(this.get_element()),x.a.instance.deinitializeForElement(this.get_element())),C.a(this.theCursorManager),i.disposeExternalHeader(),a.AFrameworkApplication.unRegisterFrame(this.get_element().id),this._applicationInstance=null,Sys.Component.prototype.dispose.call(this),this._isDisposed=!0)},c.switchToMode=function(e){if(this._mode!==e){switch(e){case 0:throw Error.argumentNull("newMode");case 1:this._mode=e,a.AFrameworkApplication.theActionManager.mode=1;break;case 2:this._mode=e,a.AFrameworkApplication.theActionManager.mode=3;break;default:throw Error.argumentOutOfRange("newMode")}var t=this.get_events().getHandler("ModeSwitched");t&&t(this)}},c.setOffline=function(e){if(this.isOffline!==e){this._isOffline=e,a.AFrameworkApplication.theActionManager.isOffline=e;var t=this.get_events().getHandler("OnSetOffline");t&&t(e)}},c.prepareForDialog=function(){},c.animateDocumentPanel=function(e,t){},c.updateOpenMenu=function(e){return!1},c.doBrowserDefault=function(e,t,n,i,r){return 4},c.restoreFocusAfterDismissingPopup=function(e,t){try{e.focus()}catch(e){0}},c.setFocusOnDocument=function(){},c.restoreFocusAfterExecutingActionFromRibbon=function(){this.theFocusManager&&this.theFocusManager.currentScope&&(this.theFocusManager.currentScope.name===this.ribbonFocusScopeName||this.theFocusManager.currentScope.name===this.headerFocusScopeName||this.theFocusManager.currentScope.name===i.reactTransientUIFocusId&&this.theFocusManager.peekNonReactTransientUiScope()===this.ribbonFocusScopeName)&&(this.theFocusManager.previousEditableScopeName&&this.theFocusManager.isEditableFocusScopeActivated(this.theFocusManager.previousEditableScopeName)?this.theFocusManager.setScope(this.theFocusManager.previousEditableScopeName):this.setFocusOnDocument())},c.onFloatieDismissed=function(e){},c.signInInternal=function(e){},c.onDocumentFocus=function(e){this.theFocusManager.currentScope&&this.theFocusManager.currentScope.name===D.FocusManager.browserFocusId&&this.theFocusManager.popScope(D.FocusManager.browserFocusId)},c.navigateToHostUrl=function(e,t,n){if(void 0===n&&(n=!1),!t)return 8;if(e){_.ULS.sendTraceTag(6070364,306,50,"AFrame::NavigateToHostUrl openInNewWindow:{0}",n);try{if(n||a.AFrameworkApplication.isEmbedded){var i=G.a.safelyOpenWindow(t,"_blank",void 0,void 0,"AFrame.NavigateToHostUrl");(null==i||i.closed)&&_.ULS.sendTraceTag(5325278,306,15,"Window.Open did not succeed.")}else window.top.location=t}catch(e){var r="Unable to get exception message";try{r=e.toString()}catch(e){}return _.ULS.sendTraceTag(6070365,306,10,"AFrame::NavigateToHostUrl caught exception: {0}",r),8}}return 32},c.beforeRefreshDocument=function(){return!0},c.refreshDocument=function(e){},c.onBeforeOpenSwitcher=function(){return!0},c.onBeforeCloseSwitcher=function(){return!0},c.add_onResize=function(e){this._eventSource.addHandler(i.resizeEventKey,e)},c.remove_onResize=function(e){this._eventSource.removeHandler(i.resizeEventKey,e)},c.notifyResize=function(){this._eventSource.raiseEvent(i.resizeEventKey)},i.reflowCookieBannerIfNecessary=function(e){void 0===e&&(e=!0);var t=!1;if(!a.AFrameworkApplication.isCookieBannerVisible)return t;var n=document.getElementById($.cookieBannerId);if(n&&n.parentNode===document.body){var i=document.getElementById(a.AFrameworkApplication.applicationOuterContainerId),r=document.getElementById(a.AFrameworkApplication.externalHeaderPanelId),o=document.getElementById(a.AFrameworkApplication.applicationDivId);if(i&&r&&o){var s=S.CssUtils.getCurrentStyle(r),l=S.CssUtils.getCurrentStyle(o);if(s&&l&&"absolute"===s.position&&"absolute"===l.position&&(!e||"none"!==s.display)){i.insertBefore(n,i.firstChild);var c=n.offsetHeight;r.style.top=c+r.offsetTop+"px",o.style.top=c+o.offsetTop+"px";var u=null;u=function(){r.style.top=Math.max(0,r.offsetTop-c)+"px",o.style.top=Math.max(0,o.offsetTop-c)+"px",Q.a.instance.remove_onConsentReceived(u)},Q.a.instance.add_onConsentReceived(u),t=!0}}}return t},i.reflowCookieBannerIfNecessaryForEmbed=function(e){if(i.reflowCookieBannerIfNecessary(e)&&a.AFrameworkApplication.isCookieBannerVisible){var t=document.getElementById($.cookieBannerId),n=document.getElementById(a.AFrameworkApplication.applicationDivId);if(t&&n){var r=t.offsetHeight;n.style.top=Math.max(0,n.offsetTop-r)+"px",n.style.height="auto",n.style.bottom="0px"}}},i.suppressContextMenuHandler=function(e){return!0},i.disposeExternalHeader=function(){var e=document.getElementById(a.AFrameworkApplication.externalHeaderPanelId);e&&(O.KeyInputManager.instance.deinitializeForElement(e),R.a.instance.deinitializeForElement(e),L.a.instance.deinitializeForElement(e),I.a.instance.deinitializeForElement(e),P.a.instance.deinitializeForElement(e),x.a.instance.deinitializeForElement(e),M.a.instance.deinitializeForElement(e),M.a.instance.unregisterHandler(e,i.suppressContextMenuHandler),e=null)},i.bindWithDoNothingFallback=function(e,t,n,r){i._appScope||(i._appScope=D.FocusManager.instance().getScope(i.appFocusId)),r?(e.bindActionWithArguments(t,n,r),i._appScope.bindActionWithArguments(t,Y.a.doNothing,r)):(e.bindAction(t,n),i._appScope.bindAction(t,Y.a.doNothing))},i.doNothing=function(e,t,n,i,r){return 32},o=i,(s=[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"theStopwatchBuilder",get:function(){return this._theLazyStopwatchBuilder.value}},{key:"theCompositionEventManager",get:function(){return this._theCompositionEventManager||(this._theCompositionEventManager=new k(this.eventHandlerManager))},set:function(e){this._theCompositionEventManager=e}},{key:"theTextInputEventManager",get:function(){return this._theTextInputEventManager||(this._theTextInputEventManager=new B(this.eventHandlerManager))},set:function(e){this._theTextInputEventManager=e}},{key:"taskPaneManager",get:function(){return this._taskPaneManager},set:function(e){this._taskPaneManager=e}},{key:"adaptiveLayoutInstance",get:function(){return this._adaptiveLayoutInstance||(this._adaptiveLayoutInstance=new u)},set:function(e){this._adaptiveLayoutInstance=e}},{key:"applicationInstance",get:function(){return this._applicationInstance}},{key:"modeName",get:function(){return""}},{key:"state",get:function(){return this._frameState},set:function(e){this._frameState=e}},{key:"businessBar",get:function(){return null}},{key:"hasStatusBar",get:function(){return!1}},{key:"statusBarPanel",get:function(){if(!this.hasStatusBar)return null;var e=document.getElementById(i._statusPanelId);return e?this.updateExistingStatusBarPanel(e,this.applicationInstance):e=this.buildStatusBarPanel(),e}},{key:"lowerRibbonHeight",get:function(){return this._lowerRibbonHeight},set:function(e){this._lowerRibbonHeight=e}},{key:"documentPanelWithRibbonTop",get:function(){return this.upperRibbonHeight+this.lowerRibbonHeight}},{key:"documentPanelWithoutRibbonTop",get:function(){return this.upperRibbonHeight}},{key:"isStaticUiTouchMode",get:function(){return this._isStaticUiTouchMode}},{key:"highContrastDetector",get:function(){return this._highContrastDetector}},{key:"headerFocusScopeName",get:function(){return"NoOpHeaderUi"}},{key:"canSaveACopy",get:function(){var e=1===this.mode,t=N.a.instance.isSessionExpired(a.AFrameworkApplication.accessTokenTtl)||N.a.instance.isSessionAboutToExpire(a.AFrameworkApplication.accessTokenTtl,a.AFrameworkApplication.accessTokenExpirationPromptSeconds),n=a.AFrameworkApplication.protectFile||a.AFrameworkApplication.protectedFile||a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ProtectedFile");return!(e&&t)&&!n&&a.AFrameworkApplication.webEditingEnabled}},{key:"defaultModalDivZIndex",get:function(){return 1002}},{key:"activeModalDivZIndex",get:function(){return this._activeModalDivZIndex}},{key:"activeModalUIZIndex",get:function(){return this.activeModalDivZIndex+1}},{key:"holdRequestsWhenSessionHasExpired",get:function(){return!0}},{key:"runRequestCallbackWhenSessionHasExpired",get:function(){return!1}},{key:"isOffline",get:function(){return this._isOffline}}])&&te(o.prototype,s),l&&te(o,l),i}(Sys.UI.Control);ie.ribbonMinimizedStateCookieName="WACRibbonMinimized",ie.uiCookieExpirationDays=365,ie._statusPanelId="WACStatusBarContainer",ie.touchPanOnlyCssClass="TouchPanOnly",ie.modernScrollBarCssClass="customScrollBar",ie.legacyScrollBarCssClass="legacyScrollBar",ie.allowBrowserClickClassname="AllowBrowserClick",ie.dynamicTouchModeCssClass="msosp-touch-dyn",ie._appScope=null,ie.appFocusId="app",ie.mainAppFocusId="main",ie.documentFocusID="document",ie.flexPaneFocusId="FlexPane",ie.commentPaneFocusId="CommentPane",ie.accCheckerPaneFocusId="AccessibilityCheckerPane",ie.cookieConsentBannerFocusId="CookieConsentBanner",ie.activityPaneFocusId="ActivityTaskPane",ie.catchUpNotificationFocusId="CatchUpNotification",ie.catchUpFlyoutFocusId="CatchUpFlyout",ie.floatingContainersHostFocusId="FloatingContainersHostFocusScope",ie.modalCommandUIFocusId="CUIModal",ie.reactTransientUIFocusId="ReactTransientUI",ie.modelessDialogFocusId="dialog/modeless",ie.switcherFocusId="SwitcherFocus",ie.activityFeedPaneFocusId="ActivityFeedTaskPane",ie.previewPanelId="PreviewPanelOverlay",ie.versionHistoryOverlayId="VersionHistoryOverlay",ie.statusBarHeight=23,ie.resizeEventKey="Resize",Object(i.a)(ie,"AFrame",Sys.UI.Control,[6,4,7])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.cookieComplianceBanner_Shown=1,r.cookieComplianceBanner_ConsentedReceived=2,r.privacyNotice_MightBeNeeded=1,r.privacyNotice_Forced=2,r.privacyNotice_CommercialUsersShown=4,r.privacyNotice_CommercialUsersTrustCenterClicked=8,r.privacyNotice_CommercialUsersDismissed=16,r.privacyNotice_SettingsRoamedBusinessBarShown=32,r.privacyNotice_SettingsRoamedBusinessBarDismissed=64,r.privacyNotice_BusinessBarForAnonymousUsersShown=128,r.privacyNotice_BusinessBarForAnonymousUsersDismissed=256,r.privacyNotice_SaveNoticeShownSucceeded=512,r.privacyNotice_SaveNoticeShownFailed=1024,r.privacyNotice_NotShown_OCPSDisabled=2048,r.privacyNotice_NotShown_CantWriteCachedCookie=4096,r.privacyNotice_NotShown_AlreadySeenFromCachedCookie=8192,r.privacyNotice_NotShown_AlreadySeenFromHost=16384,r.privacyNotice_Error=32768,r.privacy_OCPSCCSDisabled=65536,r.privacy_OCPSFailure=131072,r.privacy_UserSettingsSourceRoaming=262144,r.privacy_UserSettingsSourceCookie=524288,r.privacy_UserSettingsSourceQUeryParam=1048576,r.privacyTrustCenter_Shown=2097152,r.privacyTrustCenter_Dismissed=4194304,r.privacyTrustCenter_UserPrivacyOptionsAvailable=8388608,r.privacyTrustCenter_SaveSettingsSucceeded=16777216,r.privacyTrustCenter_SaveSettingsFailed=33554432,r.privacyTrustCenter_UserPrivacyOptionCCSChecked=67108864,r.privacyTrustCenter_UserPrivacyOptionCCSUnChecked=134217728,r.privacyTrustCenter_RefreshRequiredDialogShownForAnonUser=268435456,r.privacyTrustCenter_RefreshRequiredDialogShownForSignedInUser=536870912,r.privacyTrustCenter_RefreshRequiredDialogDismissed=1073741824,r.feedback_Attempted=1,r.feedback_ResourcesDownloadSuccessful=2,r.feedback_ResourcesDownloadFailed=4,r.feedback_Opened=8,r.feedback_Cancelled=16,r.feedback_Submitted=32,r.feedback_Error=64,r.renavigate_AppModeSwitch="AppModeSwitch",r.renavigate_HotStoreSaveFailedError="HotStoreSaveFailedError",r.renavigate_UnifiedFallback="UnifiedAppFallback",r.renavigate_DatacenterRedirect="DatacenterRedirect",r.renavigate_ErrorDialogSwitchToView="ErrorDialogSwitchToView",r.renavigate_InteractiveViewDisabled="InteractiveViewDisabled",Object(i.a)(r,"Constants",null,[])},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return o}));var i=function(e){return JSON.stringify(e)},r=function(e){return JSON.parse(e)},a=function(e,t){try{t.val=o(e)}catch(e){return t.val=null,!1}return!0},o=function(e){return JSON.parse(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.application=1,Object(i.a)(r,"ContextIds",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}return e.getNameFromId=function(t){switch(t){case e.frame:return"Frame";case e.set:return"Set";case e.testApplication:case e.testFrame:case e.testView:}return null},e}();r.frame=2147483648,r.set=2147483649,r.testApplication=void 0,r.testFrame=void 0,r.testView=void 0,Object(i.a)(r,"CommonContextIds",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(1),o=n(43),s=(n(9),n(164)),l=n(314),c=n(58),u=n(96),d=n(33),p=n(26),h=n(21),m=n(3),g=n(39),f=n(60),v=function(){function e(e,t){void 0===t&&(t=null),this._actionId=e,this._downloadFirstSlice=t}var t=e.prototype;return t.areReady=function(){return 32===a.AFrameworkApplication.theActionManager.processAction(this._actionId,1)},t.waitForReady=function(e,t,n){var i=this;void 0===t&&(t=null),void 0===n&&(n=null);var r=isNaN(t)?0:t,o=a.AFrameworkApplication.theActionManager.processAction(this._actionId,1),s=!!h.a.instance.tryResolve("Common.IOfficeTrialExperience");2!==o||s?e(this,null):r<20?(r||this._downloadFirstSlice&&this._downloadFirstSlice(),f.a.instance.addTask(new g.a(2,1,500,(function(t){i.waitForReady(e,r+1,n)}),127))):n&&n()},t.invokeOpenInClientHandlerAfterReady=function(){var e=this;this.waitForReady((function(t,n){a.AFrameworkApplication.theActionManager.processActionWithData(e._actionId,2,!0)}),0,(function(){m.ULS.sendTraceTag(20711443,211,10,"ShowOpenInClient is not available after timeout");var e=new c.StandardDialog;e.buttonsOption=0,e.showError(o.a.openInClientFailedDelayed,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemInitialDialogDescription,null)}))},e}();Object(i.a)(v,"OpenInClientOperationDependencies",null,[54]);var _=n(213),y=n(37),b=n(229),S=n(18);function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return A}));var A=function(){function e(){}var t,i,g;return e.getPageSetFromPage=function(e){var t=n(14).App;return Math.ceil(e/t.instance.theConfig.pageSetSize)},e.getStartPageFromPageSet=function(e){return(e-1)*n(14).App.instance.theConfig.pageSetSize+1},e.getEndPageFromPageSet=function(e){var t=n(14).App,i=e*n(14).App.instance.theConfig.pageSetSize;return Math.min(i,t.instance.theDocument.pageCount)},e.getPageSetName=function(t){var i=e.getStartPageFromPageSet(t);return"p_"+i+"_"+(i+n(14).App.instance.theConfig.pageSetSize-1)+".zip"},e.getPageSetXmlFromPage=function(e){var t=n(14).App;return Math.ceil(e/t.instance.theConfig.pageSetXmlSize)},e.getStartPageFromPageSetXml=function(e){return(e-1)*n(14).App.instance.theConfig.pageSetXmlSize+1},e.getEndPageFromPageSetXml=function(e){var t=n(14).App,i=e*n(14).App.instance.theConfig.pageSetXmlSize;return Math.min(i,t.instance.theDocument.pageCount)},e.getPageSetXmlName=function(t){var i=e.getStartPageFromPageSetXml(t);return"p_"+i+"_"+(i+n(14).App.instance.theConfig.pageSetXmlSize-1)+".xml"},e.getPageFromXmlLine=function(e){parseInt(e.attributes.getNamedItem("id").nodeValue);var t=e.parentNode,n=(parseInt(t.attributes.getNamedItem("storyId").nodeValue),t.selectSingleNode("ancestor::Page"));return parseInt(n.attributes.getNamedItem("id").nodeValue)},e.parseXmlAttribute=function(e,t){if(!e)return null;var n=e.attributes.getNamedItem(t);return n?n.text:null},e.createWaitImage=function(){var e=new l.a(WordViewerIntl.WordViewerStrings.L_Progress);return e.isSmall=!1,e.element.style.position="absolute",e.element},e.createSpanElement=function(e){var t=document.createElement("span");return t.innerText=e,t},e.getErrorCodeFromStatus=function(e){var t=0;switch(e){case"ItemNotGenerated":t=y.a.itemNotGenerated;break;case"AccessDenied":t=y.a.accessDenied;break;case"CantFindSourceDocument":t=y.a.cannotFindSourceDocument;break;case"ServiceBusy":t=y.a.serviceBusy;break;case"InProgress":t=y.a.inProgress;break;case"NoManagerAvailable":t=y.a.noManagerAvailable;break;case"DocumentFileExtensionDisabled":t=y.a.documentFileExtensionDisabled;break;case"DocumentIsIRMProtected":t=y.a.documentIsIRMProtected;break;case"DocumentIsEncrypted":t=y.a.documentIsEncrypted;break;case"FileTypeBlocked":t=y.a.fileTypeBlocked;break;case"CantCreateDocument":t=y.a.cantCreateDocument;break;case"CantOpenDocument":t=y.a.cantOpenDocument;break;case"DocumentCorrupt":t=y.a.documentCorrupt;break;case"DocumentHasOCX":t=y.a.documentHasOcx;break;case"DocumentRejectedByGatekeeper":t=y.a.documentRejectedByGatekeeper;break;case"FileTypeUnsupported":t=y.a.fileTypeUnsupported;break;case"WorkerException":t=y.a.workerException;break;case"WorkerCrashed":t=y.a.workerCrashed;break;case"WorkerHung":t=y.a.workerHung;break;case"UnexpectedError":t=y.a.unexpectedError;break;case"UnknownError":t=y.a.unknownError;break;case"ApplicationServerError":t=y.a.applicationServerError;break;case"DocumentAlreadyOpen":t=y.a.documentAlreadyOpen;break;case"DocumentCannotBeTranslated":t=y.a.documentCannotBeTranslated;break;case"DocumentPasswordProtected":t=y.a.documentPasswordProtected;break;case"DocumentTooLong":t=y.a.documentTooLong;break;case"InvalidCurrentDocument":t=y.a.invalidCurrentDocument;break;case"InvalidParameter":t=y.a.invalidParameter;break;case"ThirdPartyPDFRendererFailed":t=y.a.thirdPartyPDFRendererFailed;break;case"ThirdPartyXPSRendererFailed":t=y.a.thirdPartyXPSRendererFailed;break;case"TranslationServiceUnavailable":t=y.a.translationServiceUnavailable;break;case"UnexpectedDocDataResponse":t=y.a.unexpectedDocDataResponse;break;case"UserConversionQuotaExceeded":t=y.a.userConversionQuotaExceeded}return t},e.showErrorDialog=function(t){var i=n(14).App,r=n(515).PDFConvertFailureDialog;if(t){var s=t.selectSingleNode("/docdata/dialog/title"),l=t.selectSingleNode("/docdata/dialog/description"),c=t.selectSingleNode("/docdata/status"),d=t.selectSingleNode("/docdata/dialog/extraErrorHandling"),p=s?s.text:CommonUIStrings.l_DefaultDialogTitle,h=l?l.text:CommonUIStrings.l_CannotOpenFile,g=c?c.text:"UnexpectedDocDataResponse";m.ULS.sendTraceTag(17634565,301,10,"Error dialog status: {0}",g);var f=!!d&&Boolean.parse(d.text),v=e.getErrorCodeFromStatus(g);v===y.a.unexpectedDocDataResponse&&m.ULS.sendTraceTag(8462864,301,10,"Unknown docdata response. {0}",e.getUnexpectedDocDataResponse(t));var _=!1;if(v===y.a.documentRejectedByGatekeeper&&(_=!0),a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerPDFConverterFailureDownloadLinkEnabled")&&i.instance.isPdfMode&&u.a.documentType===CommonUIStrings.l_DocumentType_Pdf&&a.AFrameworkApplication.downloadACopyUrl&&("WorkerException"===g||"WorkerCrashed"===g||"WorkerHung"===g||"CantOpenDocument"===g))a.AFrameworkApplication.reportError(v),e._errorDlg||(e._errorDlg=new r(a.AFrameworkApplication.downloadACopyUrl));else{var b=u.a.formatSingleString(h);0;var S=u.a.formatSingleString(p);f?e.showSendUsYourFileDialog(v,S,b,_):e.showErrorDialogEx(v,S,b,!1,_)}}else e.showErrorDialogEx(o.a.cannotOpenFile,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_CannotOpenFile)},e.showSendUsYourFileDialog=function(t,i,r,o){void 0===o&&(o=!1);var s=n(14).App;if(s.instance.status=3,!e._errorDlg&&1!==s.get_activeAppFrame().state){var l=a.AFrameworkApplication.activeFrame.theStopwatchBuilder.makeAndStartStopwatch("DialogShown","OpenSendUsYourFileDialogWordViewer");new v(S.a.openInClient,b.a).waitForReady((function(n,s){h.a.instance.resolveFuture("Wac.Common.SendUsYourFile.ISendUsYourFileController").execute((function(n){a.AFrameworkApplication.reportError(t),n.showDialog((function(){e.showErrorDialogEx(t,i,r,!0,o)})),l.stop()}))}))}},e.showErrorDialogEx=function(t,i,r,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);var l=n(14).App;l.instance.status=3,e._errorDlg||1!==l.get_activeAppFrame().state&&(e._errorDlg=new c.StandardDialog,e._errorDlg.hasCloseGlyph=a.AFrameworkApplication.isCloseable,new v(S.a.openInClient,b.a).waitForReady((function(n,c){var u=e.errorDialogOkHandler,d=n.areReady()&&!s;a.AFrameworkApplication.isCloseable&&d?(e._errorDlg.buttonsOption=4,e._errorDlg.setButtonText(2,CommonUIStrings.l_DialogClose),e._errorDlg.setButtonText(1,WordViewerIntl.WordViewerStrings.L_EditInWord),u=e.errorHandlerDialogHandler):d?(e._errorDlg.buttonsOption=0,e._errorDlg.setButtonText(1,WordViewerIntl.WordViewerStrings.L_EditInWord),u=e.errorHandlerDialogHandler):a.AFrameworkApplication.isCloseable?(e._errorDlg.buttonsOption=0,e._errorDlg.setButtonText(1,CommonUIStrings.l_DialogClose)):(e._errorDlg.hasCloseGlyph=!1,e._errorDlg.buttonsOption=5),t===y.a.documentIsEncrypted&&l.instance.isPdfMode&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerPDFDownloadInErrorDialogIsEnabled")&&e._errorDlg.addDownloadLink(CommonUIStrings.l_PdfConvertFailureDialogLinkSuggestion,a.AFrameworkApplication.downloadACopyUrl),e._errorDlg.showError(t,i,r,u,o)})))},e.propagateError=function(t,n,i,o,s){var l;if(void 0===s&&(s=null),s&&m.ULS.sendTraceTag(50960590,301,50,"PropagateError: [Status: {0}]",s),a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi")){var c,u,d=((l={}).errorType=n,l.errorCode=i,l.message=o,l);if(t)if(a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReturnSuccessOnExpectedErrorIsEnabled")&&e.isExpectedError(s))m.ULS.sendTraceTag(50960591,301,15,"PropagateError: Reporting success for expected error.[Status: {0}]",s),e.postMessenger.reportAppCompleted(!0);else if(a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")){var h;e.postMessenger.sendMessageWithRetry(p.a.wacAppFailed,((h={}).Error=d,h))}else{var g;e.postMessenger.sendAppFailedWithRetry(new _.a(p.a.wacAppFailed,((g={}).Error=d,g),Object(r.d)(e.postMessenger,e.postMessenger.sendAppFailedWithRetry,"sendAppFailedWithRetry")))}else if(a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2"))e.postMessenger.sendErrorWithRetry(((c={}).Error=d,c));else e.postMessenger.sendError(((u={}).Error=d,u))}},e.isExpectedError=function(t){if(!t)return!1;switch(e.getErrorCodeFromStatus(t)){case y.a.documentIsIRMProtected:case y.a.documentCorrupt:case y.a.documentPasswordProtected:case y.a.documentIsEncrypted:return!0;default:return!1}},e.errorHandlerDialogHandler=function(t,n){1===t?a.AFrameworkApplication.theActionManager.processActionWithData(S.a.openInClient,2,!0):e.errorDialogOkHandler(t,!1),e._errorDlg=null},e.errorDialogOkHandler=function(t,i){var r=n(14).App;r.get_activeAppFrame().ribbonUser&&r.get_activeAppFrame().ribbonUser.poll(),s.a.closeAppOnErrorWithFailoverToBlank(),r.get_activeAppFrame().workspace.dispose(),e._errorDlg=null},e.getUnexpectedDocDataResponse=function(e){var t=null;if(e.documentElement)(t=e.documentElement.outerHTML)&&!t.length&&(t=e.documentElement.text);else try{t=d.c(e)}catch(n){t=e.toString()}return t},t=e,g=[{key:"postMessenger",get:function(){return h.a.instance.resolve("WordViewer.IWordViewerPostMessenger")}}],(i=null)&&C(t.prototype,i),g&&C(t,g),e}();A._errorDlg=null,Object(i.a)(A,"Utils",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.accessDenied=5373953,r.cannotFindSourceDocument=5373954,r.serviceBusy=5373955,r.inProgress=5373956,r.noManagerAvailable=5373957,r.documentFileExtensionDisabled=5373958,r.documentIsIRMProtected=5373959,r.documentIsEncrypted=5373960,r.fileTypeBlocked=5373961,r.printPdfNotGenerated=5373962,r.itemNotGenerated=5373963,r.cantCreateDocument=5373964,r.cantOpenDocument=5373965,r.documentHasOcx=5373966,r.documentRejectedByGatekeeper=5373967,r.fileTypeUnsupported=5373968,r.workerException=5373969,r.workerCrashed=5373970,r.workerHung=5373971,r.unexpectedError=5373972,r.unknownError=5373973,r.commentBeginInvalidPropertyData=5373974,r.commentBeginPermissionDenied=5373975,r.commentBeginUnspecifiedFailure=5373976,r.commentBeginOldProductDigitalSignature=5373977,r.commentBeginDocumentProtectionSettings=5373978,r.commentBeginDocumentPasswordEncrypted=5373979,r.commentBeginFileCheckedOut=5373980,r.commentBeginFileRequiresCheckout=5373981,r.commentBeginFileLockedForOfflineCheckout=5373982,r.commentBeginFileLockedByOtherInterface=5373983,r.commentBeginCorruptedFile=5373984,r.commentBeginNumberOfCoauthorsReachedMax=5373985,r.commentBeginDocumentMarkedFinal=5373986,r.commentBeginPreReleaseFile=5373987,r.commentBeginClientServerNormalizationConflict=5373988,r.commentBeginLockExpired=5373989,r.commentBeginWordFileVersionMismatch=5373990,r.commentBeginFileEditedInRichClient=5373991,r.commentBeginRequestCountTooLarge=5373992,r.commentSaveInvalidPropertyData=5373993,r.commentSaveUnspecifiedFailure=5373994,r.commentSavePermissionDenied=5373995,r.commentSaveOldProductDigitalSignature=5373996,r.commentSaveDocumentProtectionSettings=5373997,r.commentSaveDocumentPasswordEncrypted=5373998,r.commentSaveFileCheckedOut=5373999,r.commentSaveFileRequiresCheckout=5374e3,r.commentSaveFileLockedForOfflineCheckout=5374001,r.commentSaveFileLockedByOtherInterface=5374002,r.commentSaveNumberOfCoauthorsReachedMax=5374003,r.commentSaveWordFileVersionMismatch=5374004,r.commentSaveDocxCoherencyFailure=5374005,r.commentSaveCorruptedFile=5374006,r.commentSaveDocumentMarkedFinal=5374007,r.commentSavePreReleaseFile=5374008,r.commentSaveLockExpired=5374009,r.commentSaveFileEditedInRichClient=5374010,r.commentSaveRequestCountTooLarge=5374011,r.commentBeginCanaryFailure=5374012,r.commentSaveCanaryFailure=5374013,r.commentSaveRetryCountExceeded=5374014,r.commentNewSelectSomething=5374015,r.commentNewInvalidContent=5374016,r.commentBeginRefreshVersion=5374017,r.commentBeginRefreshNormalization=5374018,r.commentBeginNetworkError=5374019,r.commentLockRefreshCanaryFailure=5374020,r.stringsFailedToLoadWordViewer=5374021,r.stringsFailedToLoadCommonUI=5374022,r.hostCanaryFailure=5374023,r.unexpectedDocDataResponse=5374024,r.documentCorrupt=5374025,r.applicationServerError=5374026,r.documentAlreadyOpen=5374027,r.documentCannotBeTranslated=5374028,r.documentPasswordProtected=5374029,r.documentTooLong=5374030,r.invalidCurrentDocument=5374031,r.invalidParameter=5374032,r.thirdPartyPDFRendererFailed=5374033,r.thirdPartyXPSRendererFailed=5374034,r.translationServiceUnavailable=5374035,r.userConversionQuotaExceeded=5374036,Object(i.a)(r,"WordViewerErrorCode",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(11),a=n(100),o=n(119),s=n(248),l=n(1),c=n(22),u=n(21),d=n(8),p=n(3),h=function(){function e(){}return e.createRibbonUpsellButton=function(t,i,r){if(i&&t&&!e.hideButton){var a="1274543852";switch(l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FreemiumUpsellShowDialogIsEnabled")&&(a="4180531998"),r){case 1:var o=n(38).CuiHelper.addButton(e.freemiumUpsellEligibleButtonId+e.buttonCount.toString(),a,CommonUIStrings.l_FreemiumUpsell,e.freemiumUpsellButtonImageName,null,"Medium20",i,t);Sys.UI.DomElement.addCssClass(o,"FreemiumUpsellButton"),i.appendChild(o),e.registerRemoveCallback(o),l.AFrameworkApplication.theActionManager.processAction(d.a.reportFreemiumUpsellEligibleDisplayed,2),p.ULS.sendTraceTag(40739802,340,50,"Go Premium Upsell button created"),e.buttonCount++}}},e.registerRemoveCallback=function(t){t&&u.a.instance.resolveFuture("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute((function(n){n.registerFeatureStateChangeCallback("MsoPremiumBadge",(function(n){t&&n.isEnabled&&(c.DomUtils.removeElement(t),e.hideButton=!0)}))}))},e}();h.freemiumUpsellButtonImageName="UpgradeProductGlyph_20x20x32",h.freemiumUpsellEligibleButtonId="btnFreemiumUpsellEligible",h.freemiumUpsellBadgeButtonId="btnFreemiumUpsellBadge",h.buttonCount=0,h.hideButton=!1,Object(i.a)(h,"RibbonUpsellButtonCreator",null,[]);var m=function(e){var t,n;function i(t){var n;return(n=e.call(this)||this).withoutSaveStatus=t,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Sys.EventArgs);Object(i.a)(m,"TopRowCreatedEventArgs",Sys.EventArgs,[]);var g=n(256),f=n(104),v=n(40),_=n(80),y=(n(9),n(129),n(185),n(55)),b=n(71),S=n(48),C=n(4),A=function(e,t){this.cluster=e,this.css=t};Object(i.a)(A,"ImageInfo",null,[]);var I=function(e,t,n,i,r,a,o,s,l,c,u,d,p,h,m,g){void 0===m&&(m=null),void 0===g&&(g=null),this.groupChatButtonGlyph32=null,this.id=e,this.actionIdCommand=t,this.actionIdQueryStatus=n,this.actionIdPopulateFlyout=i,this.actionIdCommandMenuOpen=r,this.actionIdCommandMenuClose=a,this.actionIdUserButtonClick=o,this.actionIdRefreshControl=s,this.singleUserCollabGlyph16=new A(l,c),this.singleUserCollabGlyph32=new A(u,d),this.multipleUserCollabGlyph16=new A(p,h),m&&g&&(this.groupChatButtonGlyph32=new A(m,g))};Object(i.a)(I,"PeoplesWellBaseSettings",null,[]);var w=function(){this.breadcrumbContainer=null,this.breadcrumbItems=null};Object(i.a)(w,"BreadcrumbControls",null,[]);var T=function(){function e(e,t,n,i,r,a,o,s){void 0===t&&(t=d.a.toggleChatPane),void 0===n&&(n=d.a.queryDocChatButtonStatus),void 0===i&&(i=d.a.refreshChatControl),void 0===r&&(r=d.a.joinChatThread),void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=!1),this.id=e,this.togglePaneActionId=t,this.queryStatusActionId=n,this.refreshControlActionId=i,this.joinChatActionId=r,this.imageName=a,this.unreadImageName=o,this.hideUnreadMessageCount=s}return e.getChatButtonSettings=function(){return e.swxDocChatSettings},e}();T.swxDocChatSettings=new T("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32"),Object(i.a)(T,"ChatButtonSettings",null,[]);var E=function(){this.command=null,this.label=null,this.image=null,this.id=null,this.swxExperience=0};Object(i.a)(E,"SkypeButtonInfo",null,[]);var k=function(){this.breadcrumb=null,this.titleSection=null,this.userControl=null};Object(i.a)(k,"TopRowControls",null,[]);var M=n(242),P=n(13);function F(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"CuiHelper",(function(){return R}));var R=function(){function e(t,n,i,r,o){void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),this._imagePath=t,this._intlStringClasses=M.c(n,o),this._intlStringClasses.push(CommonUIStrings),this._isOfficePresentationAttendeeMode=a.b(),e._actionManager=null==i?l.AFrameworkApplication.theActionManager:i,null==r?this.buildHeaderStringsDictionary():e._headerStrings=r,e._officeOnlineBrandWidth=l.AFrameworkApplication.unifiedHeaderOfficeOnlineLogoWidth,e._officeOnlineBrandHeight=e.unifiedHeaderHeight}var t,i,A,D=e.prototype;return D.buildHeaderStringsDictionary=function(){var t;e._headerStrings=((t={}).SignoutLink=CommonUIStrings.l_SignoutLink,t.SignInLink=CommonUIStrings.l_SignIn,t.SwitcherTooltip=CommonUIStrings.l_SwitcherTooltip,t)},D.updateData=function(t){var n={},i=e.getNodeAttributes(t);for(var r in i){var a={key:r,value:i[r]},o=a.value.toString();o&&(this.replaceIntlString(i,a.key,o),this.replaceImagePath(i,a.key,o),this.replaceImageMap(i,a.key,o,n))}for(var s in n){var l={key:s,value:n[s]};i[l.key+"Class"]=l.value}for(var c=e.getNodeChildren(t),u=0;u<c.length;u++)this.updateData(c[u])},D.replaceIntlString=function(e,t,n){if(-1!==n.indexOf("STR@")){var i=n.replace("STR@","");e[t]=this.getIntlString(i)}},D.replaceImagePath=function(e,t,n){-1!==n.indexOf("IMAGEPATH@")&&(e[t]=v.a.staticContentHost+n.replace("IMAGEPATH@",this._imagePath)+v.a.staticContentQueryParameter)},D.replaceImageMap=function(e,t,n,i){if(-1!==n.indexOf("IMGMAP@")){var r=n.split("@");if(3===r.length){var a=l.AFrameworkApplication.imageClusterPath,o=y.getImageClass(r[2]),s=r[1],c=l.AFrameworkApplication.imageClusterName;s!==c&&(a=a.replace(c+".png",s+".png"),o=o.replace(c,s)),e[t]=a,i[t]=o}}},D.getIntlString=function(e){for(var t,n=F(this._intlStringClasses);!(t=n()).done;){var i=t.value[e];if(null!=i)return i}return""},D.createTopRowControls=function(e,t,n,i,r,a,o){return void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),this.createTopRowControlsInternal(e,t,n,i,!r,!r,a,o)},D.createTopRowControlsInternal=function(t,n,i,r,c,u,d,p){var g=new k,f=this.createTopLeftControls(t,c&&!this._isOfficePresentationAttendeeMode);f&&(g.breadcrumb=f,n.appendChild(f.breadcrumbContainer));var v=e.createGenericPeripheralSection(t,o.a.topRowCenter),_=!!l.AFrameworkApplication.activeFrame.applicationInstance&&4===l.AFrameworkApplication.activeFrame.applicationInstance.officeAppType||!this._isOfficePresentationAttendeeMode;l.AFrameworkApplication.docPropertiesProvider.breadcrumbDocName&&u&&_&&e.createDocumentTitleElement(v),g.titleSection=v,n.appendChild(v),e.headerDocumentTitleSpanId=v.id;var y=e.createGenericPeripheralSection(t,o.a.topRowRight);if(y){if(i?this.createActionButton(r,i,y,e.actionButtonDisplayModeInHeader):a.f(p)&&s.a(y),r&&a.h()&&h.createRibbonUpsellButton(r,y,l.AFrameworkApplication.freemiumUpsellMode),r&&a.d()){var b=e.getTopRightSkypeButtonInfo(),S=b.id+(e._topRowControlsCount>0?e._topRowControlsCount.toString():""),C=e.addButton(S,b.command,b.label,b.image,null,e.skypeButtonDisplayMode,y,r);e.skypeButtonId?e.secondSkypeButtonId=S:e.skypeButtonId=S,e._topRowControlsCount++,Sys.UI.DomElement.addCssClass(C,"SkypeButton"),C.style.display="none";var A=document.createElement("div");Sys.UI.DomElement.addCssClass(A,"SkypeUnreadConversationsDiv"),C.appendChild(A);var I=document.createElement("span");A.appendChild(I),Sys.UI.DomElement.addCssClass(I,"SkypeUCBBackground"),Sys.UI.DomElement.addCssClass(I,e.skypeUnreadConversationsBubbleClass),I.style.display="none"}if(!l.AFrameworkApplication.isEmbedded){if(l.AFrameworkApplication.userNameUnknown&&!l.AFrameworkApplication.signoutUrl||l.AFrameworkApplication.limitedEdit){var w=this.createSignInLink(l.AFrameworkApplication.signInUrl);w&&y.appendChild(w),g.userControl=w}else{var T=this.createUserNameAndSignOutLink();T&&y.appendChild(T),g.userControl=T}}n.appendChild(y)}return e._topRowControlsCount++,e.headerEventSource.raiseTopRowControlsCreatedEvent(r,new m(d)),g},D.createBottomRowRightControls=function(t,n,i,r,a,s,c,u){void 0===a&&(a=null),void 0===s&&(s=null),void 0===c&&(c=null),void 0===u&&(u=null);var d=e.createGenericPeripheralSection(t,o.a.bottomRowRight);if(r){if(e.createPeopleWellControl(i,r,d),e.createDocChatButton(r,d),a&&this.createActionButton(r,a,d,e.actionButtonDisplayModeInRibbon),u&&d)e.addButton(u.id,u.command,u.label,u.image,null,e.copyLinkButtonDisplayMode,d,r).className+=" DocumentActionButton";if(s&&d)e.addToggleButton(s.id,s.command,s.queryCommand,s.label,s.image,s.keytip,e.commentsButtonDisplayMode,d,r).className+=" CommentsButton";if(c&&d){var p=e.addToggleButton(c.id,c.command,c.queryCommand,c.label,c.image,c.keytip,e.changesButtonDisplayMode,d,r);p.className+=" ChangesButton",l.AFrameworkApplication.activeFrame.applicationInstance.shouldHideChangesButtonInitially&&(p.style.display="none")}}n.appendChild(d)},D.createActionButton=function(t,n,i,r){(void 0===r&&(r="Medium20"),i&&n&&t)&&(e.addButton(n.id+(e._topRowControlsCount>0?e._topRowControlsCount.toString():""),n.command,n.label,n.image,null,r,i,t).className+=" DocumentActionButton")},D.createBottomRowCenterControls=function(t,n,i,r,a,s,l){var c=e.createGenericPeripheralSection(t,o.a.bottomRowCenter);e.addPrintButton(i,c,l),e.addTellMeSearchBox(r,c,l),a&&e.addSeparator(c,l),e.addOpenInClientButton(a,c,l),e.addFeedbackButton(s,l,c),n.appendChild(c)},D.createOfficeBrandElement=function(){var t=null;return void 0!==e._officeOnlineBrandWidth&&((t=document.createElement("span")).style.width=e._officeOnlineBrandWidth+"px",t.style.height=e._officeOnlineBrandHeight+"px",t.style.lineHeight=e._officeOnlineBrandHeight+"px",t.className="headBrand",t.innerText=CommonUIStrings.l_AppNameShort,p.ULS.shipAssertTag(40978313,344,CommonUIStrings.l_AppNameShort.indexOf("webappshort")<0)),t},D.createTopRowSeparatorElement=function(e,t){t&&(!!l.AFrameworkApplication.breadcrumbBrandName,l.AFrameworkApplication.breadcrumbFolderName);var n=null;return e&&((n=document.createElement("span")).className=e?"OfficeOnlineBrandSwitcherSeparator":"OfficeOnlineBrandBreadcrumbSeparator"),n},D.createTopLeftControls=function(t,i){var r=n(427).AppSwitcher,s=a.g(),l=e.createGenericPeripheralSection(t,o.a.topRowLeft);Sys.UI.DomElement.addCssClass(l,"BreadcrumbContainer");var c=new w;c.breadcrumbContainer=l,c.breadcrumbItems=[];var u=e.createUnifiedAppAndBrandContainer(t);if(s?(r.createSwitcherDropdown(t,u,c,e._headerStrings,s),r.setupFocusRegionForSwitcher()):this.createAppIcon(u),e.isTransistionalHeaderUIEnabled()||this.addSeparatorToContainer(u,s,i),this.createAndAddBreadCrumbToContainer(u,c.breadcrumbItems),l.appendChild(u),i)for(var d,p=F(e.createHostBrandAndFolderElements(l,e.breadcrumbSeparatorImageName));!(d=p()).done;){var h=d.value;Array.add(c.breadcrumbItems,h)}return c},D.addSeparatorToContainer=function(e,t,n){var i=this.createTopRowSeparatorElement(t,n);i&&e.appendChild(i)},D.createAndAddBreadCrumbToContainer=function(e,t){var n=this.createOfficeBrandElement();n&&(e.appendChild(n),Array.add(t,n))},D.createAppIcon=function(e){var t=y.createClusteredImage(36,36,"AppLogoSilhouette_36x36x32","AppHeaderIconFloat",!0,null);e.appendChild(t)},D.createSignInLink=function(t){var n=null;return t&&((n=document.createElement("a")).className="SignInLink",n.href=t,n.id=e.signInLinkId,n.innerText=e._headerStrings.SignInLink.toString(),n.target="_top",b.a.instance.registerHandlerWithBrowserClickOption(C.EventNames.click,n,e.onSignInLinkClick,null,!0)),n},D.createUserNameAndSignOutLink=function(){var t=null;if(l.AFrameworkApplication.userName||l.AFrameworkApplication.signoutUrl){t=document.createElement("span"),Sys.UI.DomElement.addCssClass(t,"UsernameContainer");var n=document.createElement("span");if(n.className="UsernameNameContainer",t.appendChild(n),!l.AFrameworkApplication.userNameUnknown){var i=document.createElement("span");i.className="UsernameNameItem",i.setAttribute("dir","auto"),i.innerText=l.AFrameworkApplication.userName,n.appendChild(i)}var r=l.AFrameworkApplication.signoutUrl;if(r){if(!e.isTransistionalHeaderUIEnabled()){var a=document.createElement("span");a.className="UserNameSeparator",t.appendChild(a)}var o=document.createElement("a");o.className="SignoutLink",o.href=r,o.id=e.signoutLinkId,o.innerText=e._headerStrings.SignoutLink.toString(),t.appendChild(o)}}return t},e.registerOnClickBreadcrumbLink=function(t){e._breadcrumbLinkClickHandler=t},e.getNodeAttributes=function(e){return e.attrs},e.getNodeChildren=function(t){var n=t.children;return null==n?e.emptyArray:n},e.getPeoplesWellDefaultControlSettings=function(t,n,i,r,a,o,s,l){return void 0===s&&(s=null),void 0===l&&(l=null),new I(e.peoplesWellControlId,d.a.coauthoringCommand,d.a.coauthoringQueryStatus,d.a.coauthoringPopulateFlyout,d.a.coauthoringCommandMenuOpen,d.a.coauthoringCommandMenuClose,d.a.coauthoringUserButtonClick,d.a.coauthoringRefreshControl,t,n,i,r,a,o,s,l)},e.addFeedbackButton=function(t,n,i){if(t&&n){var r=_.a(e.feedbackButtonId,t.command,t.label,null),a=n.hostControl(e.feedbackButtonId,r,"Medium");a&&i&&(Sys.UI.DomElement.addCssClass(a,"UITextTranformUpperCase"),Sys.UI.DomElement.addCssClass(a,"GiveFeedbackControl"),i.appendChild(a))}},e.createPeopleWellControl=function(e,t,n){if(e&&t){var i=_.j(e),r=t.hostControl(e.id,i,"Medium");if(r){var a=!1;l.AFrameworkApplication.appSettingsManager&&(a=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ColorPresenceHashIsEnabled")),a?Sys.UI.DomElement.addCssClass(r,"PeoplesWellControl2"):Sys.UI.DomElement.addCssClass(r,"PeoplesWellControl"),n.appendChild(r)}}},e.createDocChatButton=function(t,n){var i,r=T.swxDocChatSettings;var a=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DocChatIsEnabled"),o=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BasicChatIsEnabled");a&&r&&t&&(i=!o&&a?_.i(r.id,r.id,r.togglePaneActionId.toString(),r.queryStatusActionId.toString(),CommonUIStrings.l_DocChatButtonLabel,CommonUIStrings.l_DocChatButtonTooltip,r.imageName,!1):_.a(r.id,r.togglePaneActionId.toString(),CommonUIStrings.l_DocChatButtonLabel,r.imageName,r.id,null,CommonUIStrings.l_DocChatButtonTooltip,"Medium",null,r.queryStatusActionId.toString(),void 0,void 0,void 0,!1),t.addControl(r.id,i)&&e.addDocChatButtonToContainer(n,t.getDOMElementForControlDisplayMode(r.id,"Medium")))},e.getTopRightSkypeButtonInfo=function(){var t=l.AFrameworkApplication.appSettingsManager.getIntAppSetting("SkypeExperience",0),n=1===t?e.skypeConsumerButtonWhite:e.skypeBusinessButtonWhite;return e.isTransistionalHeaderUIEnabled()&&(n=e.skypeNewHeaderButton),Object.assign(new E,{label:CommonUIStrings.l_SkypeTooltip,command:"3476734992",image:n,id:e.skypeButtonPrefixId,swxExperience:t})},e.addDocChatButtonToContainer=function(e,t){t&&(t.style.display="none",e.appendChild(t))},e.disposeTopRowControls=function(t){var i,a=n(427).AppSwitcher;t.breadcrumb&&(e.disposeTopLeftControls(t.breadcrumb),t.breadcrumb=null),t.titleSection&&(e.disposeTitleElement(),t.titleSection=null),t.userControl&&(e.disposeUserControl(t.userControl),t.userControl=null),a.disposeSwitcher(),e.headerEventSource.raiseOnTopRowControlsDisposingEvent(),f.a.tryEnsuredHeaderPanelInitialized(Object(r.a)((function(){return i}),(function(e){return i=e})),!1)&&(c.DomUtils.clearElementHtml(i),e.skypeButtonId=e.secondSkypeButtonId=null)},e.createDocumentTitleElement=function(t){return e.createDocumentTitleElementInternal(t,l.AFrameworkApplication.isRenameSupported())},e.createDocumentTitleElementInternal=function(t,n){var i=l.AFrameworkApplication.docPropertiesProvider.breadcrumbDocName;l.AFrameworkApplication.documentIsFolder||(i=P.a.getFileNameWithoutExtension(i));var r=e.createBreadcrumbItem(t,e.breadcrumbTitleId,i,null,n);return n&&(l.AFrameworkApplication.documentTitleInputElement=r),r},e.createEmptyHeaderAndToolbar=function(t){var n,i,a,o,s=document.createElement("div");return s.className="cui-viewerchrome",e.ensureTopBars(s,Object(r.a)((function(){return n}),(function(e){return n=e})),Object(r.a)((function(){return i}),(function(e){return i=e}))),e.ensureTopBars1And2(t,n,i,Object(r.a)((function(){return a}),(function(e){return a=e})),Object(r.a)((function(){return o}),(function(e){return o=e}))),s.appendChild(i),s},e.ensureTopBars=function(e,t,n){var i;n.val=document.createElement("div"),n.val.className="cui-ribbonTopBars",f.a.tryEnsuredHeaderPanelInitialized(Object(r.a)((function(){return i}),(function(e){return i=e})))?(t.val=document.createElement("div"),t.val.id="EmptyHeaderTopBars",t.val.className="cui-viewerchrome cui-ribbonTopBars empty",i.appendChild(t.val),Sys.UI.DomElement.addCssClass(e,"cui-exth")):t.val=n.val},e.ensureTopBars1And2=function(e,t,n,i,r){i.val=document.createElement("div"),i.val.className="cui-topBar1",l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LegacyHeaderAppColorIsEnabled")&&(i.val.className+=" cui-topBar1-transistionalHeaderUI"),e&&(i.val.style.display="none"),t.appendChild(i.val),r.val=document.createElement("div"),r.val.className="cui-topBar2",n.appendChild(r.val),l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(i.val.className+=" cui-color-update")},e.disposeEmptyHeaderAndToolbar=function(e){c.DomUtils.removeElement(e);var t=document.getElementById("EmptyHeaderTopBars");t&&c.DomUtils.removeElement(t)},e.initializeRenameUIHandler=function(){l.AFrameworkApplication.theActionManager.processAction(d.a.initializeRenameUIHandler,2)},e.disposeTitleElement=function(){l.AFrameworkApplication.documentTitleInputElement&&S.EventHandlerManager.instance.unregisterAllHandlers(l.AFrameworkApplication.documentTitleInputElement)},e.addPrintButton=function(t,n,i){t&&i&&e.addButton(e.printButtonId,t.command,t.label,null,CommonUIStrings.l_PrintKeytip,"Medium",n,i)},e.addTellMeSearchBox=function(t,n,i){if(t&&i){var r=e.buildSearchBoxXml(e.tellMeSearchBoxId,t.accessibilityTextCommand,t.command,t.commandMenuClose,t.commandMenuOpen,t.menuControlExecutedCommand,t.onInteractionBegin,t.onRestoreFocus,t.onInputBoxFocus,t.onInputBoxBlur,t.populateQueryCommand,t.populateAsyncTriggerCommand,!0,!1,t.altText,t.placeHolderText,t.keytip,"182px",l.AFrameworkApplication.imageClusterPath,y.getImageClass("Oz_16x16x32"),y.getImageClass("OzSilhouette_Glyph_16x16x32"),y.getImageClass("OzSilhouette_16x16x32")),a=i.hostControl(e.tellMeSearchBoxId,r,"Medium");Sys.UI.DomElement.addCssClass(a,e.tellMeSearchBoxClass),a&&(l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled")&&e.hideTellMeSearchBoxOnlyTillFeatureIsEnabled(a,n),n.appendChild(a))}},e.hideTellMeSearchBoxOnlyTillFeatureIsEnabled=function(e,t){for(var n=e.childNodes,i=0;i<n.length;i++)n[i].style.display="none";u.a.instance.resolveFuture("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute((function(e){e.isFeatureEnabled("ConnectedServices",!0).then((function(e){if(e)for(var t=0;t<n.length;t++)n[t].style.display="";return null}))}))},e.addOpenInClientButton=function(t,n,i){if(t&&i){var r=e.addButton(e.openInClientButtonId,t.command,t.label,null,CommonUIStrings.l_OpenInClientKeytip,"Medium",n,i);Sys.UI.DomElement.addCssClass(r,e.openInClientButtonClass)}},e.buildSearchBoxXml=function(e,t,n,i,r,a,o,s,l,c,u,d,p,h,m,g,f,v,_,y,b,S){var C,A=((C={}).Id=e,C.AccessibilityTextCommand=t,C.Command=n,C.CommandMenuClose=i,C.CommandMenuOpen=r,C.MenuControlExecutedCommand=a,C.InteractionBeginCommand=o,C.RestoreFocusCommand=s,C.InputBoxFocusCommand=l,C.InputBoxBlurCommand=c,C.PopulateQueryCommand=u,C.PopulateAsyncTriggerCommand=d,C.PopulateDynamically=p,C.PopulateOnlyOnce=h,C.Alt=m,C.PlaceholderText=g,C.Keytip=f,C.Width=v,C.Image16by16=_,C.Image16by16Class=y,C.LightImage16by16Class=b,C.DarkImage16by16Class=S,C),I="<SearchBox ";for(var w in A){var T={key:w,value:A[w]};T.value&&(I+=T.key+'="'+P.a.xmlEncode(T.value.toString())+'" ')}return I+"/>"},e.addSeparator=function(e,t){if(t){var n=_.g("BottomRowCenterSeparator"),i=t.hostControl("BottomRowCenterSeparator",n,"Small");i&&e.appendChild(i)}},e.addButton=function(e,t,n,i,r,a,o,s){var l=_.a(e,t,n,i,null,null,null,a,null,null,void 0,void 0,r),c=s.hostControl(e,l,a);return c&&o.appendChild(c),c},e.addToggleButton=function(e,t,n,i,r,a,o,s,l){var c=_.i(e,null,t,n,i,i,r,void 0,a),u=l.hostControl(e,c,o);return u&&s.appendChild(u),u},e.createGenericPeripheralSection=function(t,n){var i=document.createElement("span");return i.className="cui-"+n,i.id=e.generatePeripheralSectionID(t,n),i.style.display="none",i},e.generatePeripheralSectionID=function(e,t){return e+"-"+t},e.createUnifiedAppAndBrandContainer=function(e){var t=document.createElement("span");return Sys.UI.DomElement.addCssClass(t,"AppAndBrandContainer"),t.id=e+"-AppAndBrandContainer",t},e.createAppBrandElement=function(t){return e.createBreadcrumbItem(t,e.breadcrumbAppBrandId,CommonUIStrings.l_AppNameShort,null,!1)},e.createAppBrandSeparatorElement=function(e){var t=document.createElement("span");return t.className="AppBrandSeparator",e.appendChild(t),t},e.createHostBrandAndFolderElements=function(t,n){var i=!!l.AFrameworkApplication.breadcrumbBrandName,r=!!l.AFrameworkApplication.breadcrumbFolderName,a=[],o=null;if(i&&(o=e.createBreadcrumbItem(t,e.breadcrumbBrandId,l.AFrameworkApplication.breadcrumbBrandName,l.AFrameworkApplication.breadcrumbBrandUrl,!1),Array.add(a,o),r)){var s=y.createClusteredImage(6,16,n,"BreadcrumbItem FolderSeparator",!0,"");s.id=e.folderSeparatorId,t.appendChild(s),Array.add(a,s)}return r&&(o=e.createBreadcrumbItem(t,e.breadcrumbFolderId,l.AFrameworkApplication.breadcrumbFolderName,l.AFrameworkApplication.breadcrumbFolderUrl,!1),Array.add(a,o)),a},e.createBreadcrumbItem=function(t,n,i,r,a){var o;return!!r?((o=document.createElement("a")).href=r,o.target="_top",b.a.instance.registerHandlerWithBrowserClickOption(C.EventNames.click,o,e.onBreadcrumbLinkClick,null,!0)):a?(o=document.createElement("div")).tabIndex=0:o=document.createElement("span"),o.className="BreadcrumbItem"+(a?" Selectable":""),o.id=n,o.innerText=i,o.setAttribute("dir","auto"),t.appendChild(o),o},e.disposeTopLeftControls=function(e){e.breadcrumbItems&&S.EventHandlerManager.instance.unregisterAllHandlersForDOMArray(e.breadcrumbItems)},e.onBreadcrumbLinkClick=function(t){var n,i=g.a.instance.startActivity(d.a.breadcrumbLinkClick);return i.properties.add("id",t.caughtElement.id),i.end(),p.ULS.sendTraceTag(595732178,207,50,"Breadcrumb link clicked: {0}",((n={}).id=t.caughtElement.id,n)),!!e._breadcrumbLinkClickHandler&&e._breadcrumbLinkClickHandler(t)},e.disposeUserControl=function(t){b.a.instance.unregisterHandlerWithBrowserClickOption(C.EventNames.click,t,e.onSignInLinkClick,!0)},e.onSignInLinkClick=function(e){if(l.AFrameworkApplication.useSignInCommandPostMessage){var t=l.AFrameworkApplication.activeFrame.applicationInstance.getSignInParams();l.AFrameworkApplication.activeFrame.signInInternal(t),l.AFrameworkApplication.useSignInCommandPostMessage=!1}else window.top.location=l.AFrameworkApplication.signInUrl;return!0},e.isTransistionalHeaderUIEnabled=function(){return!!l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.isTransistionalHeaderUIEnabled},t=e,A=[{key:"headerEventSource",get:function(){return e._headerEventSource||(e._headerEventSource=u.a.instance.resolve("Common.App.Header.HeaderEventSource"))}},{key:"emptyArray",get:function(){return void 0!==e.s_emptyArray&&null!==e.s_emptyArray||(e.s_emptyArray=[]),e.s_emptyArray}}],(i=null)&&O(t.prototype,i),A&&O(t,A),e}();R._headerEventSource=null,R.shareButtonImg20="ShareServerWhite_20x20x32",R.skypeConsumerButtonBlack="WACSkypeButtonBlack_20x20x32",R.skypeConsumerButtonWhite="WACSkypeButtonWhite_20x20x32",R.skypeBusinessButtonBlack="WACSkypeBusinessButtonBlack_20x20x32",R.skypeBusinessButtonWhite="WACSkypeBusinessButtonWhite_20x20x32",R.skypeNewHeaderButton="SkypeTitlebar_20x20x32",R.externalHeaderFullTopBarsId="ExternalHeaderFullTopBars",R.externalHeaderViewerChromeTopBarsId="ExternalHeaderViewerChromeTopBars",R.headerTopBarsId="HeaderTopBars",R.breadcrumbAppBrandId="BreadcrumbAppBrand",R.breadcrumbBrandId="BreadcrumbBrand",R.breadcrumbFolderId="BreadcrumbFolder",R.breadcrumbTitleId="BreadcrumbTitle",R.folderSeparatorId="FolderSeparator",R.signoutLinkId="SignoutLink",R.signInLinkId="SignInLink",R.tellMeSearchBoxId="sbTellMe",R.simplifiedTellMeSearchBoxId="TellMe-SearchBox",R.openInClientButtonId="btnOpenInClient",R.printButtonId="btnPrint",R.shareButtonId="btnFileSharing",R.skypeButtonPrefixId="BasicChat",R.replyWithChangesButtonId="btnReplyWithChanges",R.feedbackButtonId="jbtnGiveFeedback",R.peoplesWellControlId="PeoplesWellControl",R.editableBreadcrumbItemClass="EditableBreadcrumbItem",R.tellMeSearchBoxClass="TellMeSearchBox",R.openInClientButtonClass="ButtonOpenInClient",R.skypeUnreadConversationsBubbleClass="SkypeUnreadConversationsBubble",R._actionManager=null,R._headerStrings=null,R._breadcrumbLinkClickHandler=null,R._officeOnlineBrandWidth=0,R._officeOnlineBrandHeight=0,R.unifiedHeaderHeight=50,R._topRowControlsCount=0,R.breadcrumbSeparatorImageName="BreadcrumbCaret_6x16x32",R.breadcrumbAlternateSeparatorImageName="BreadcrumbCaretAlt_6x16x32",R.skypeButtonDisplayMode="Small20",R.actionButtonDisplayModeInRibbon="Medium",R.actionButtonDisplayModeInHeader="Medium20",R.commentsButtonDisplayMode="Medium",R.changesButtonDisplayMode="Medium",R.copyLinkButtonDisplayMode="Medium",R.headerDocumentTitleSpanId=null,R.skypeButtonId=null,R.secondSkypeButtonId=null,R.s_emptyArray=null,Object(i.a)(R,"CuiHelper",null,[86])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);n(9),n(54);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(e,t,n,i,r,a,o,s){void 0===r&&(r=0),void 0===a&&(a=null),void 0===o&&(o=!1),void 0===s&&(s=0),this._description=null,this._acceptableTickRange=null,this._lastDelayTick=0,this._deleted=!1,this._taskManagerUtils=null,this.customData=null,this.data=null,this._priority=e,this._type=t,this._tickInterval=n,this._process=i,this._runImmediately=o,this._lastProcessed=0,this._taskItemId=r,this.name=a,this._idleTaskTimeout=s}var t,n,i,a=e.prototype;return a.process=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){this._lastProcessed=this._lastProcessed+this.interval,this._lastDelayTick=this.getTimeStamp()-this._lastProcessed,this._process&&this._process(this);var e=this.getTimeStamp();this._lastProcessed=Math.max(e,this._lastProcessed)})),a.onEnqueue=function(e){this._taskManagerUtils=e,5!==this._priority||e&&e.isOnIdleTasksEnabled()||(this._priority=4),this.priority?this._runImmediately?this._runImmediately=!1:this._lastProcessed=Math.max(this.getTimeStamp(),this._lastProcessed):this._lastProcessed=this.getTimeStamp(),this._deleted=!1},a.shouldOnIdleTaskBePromoted=function(e){return!(5!==this.priority||this._idleTaskTimeout<=0)&&e-this.nextIntervalTime>this._idleTaskTimeout},a.getTimeStamp=function(){return this._taskManagerUtils?this._taskManagerUtils.getTimeStamp():0},e.create=function(t,n,i,r,a,o,s){return void 0===a&&(a=0),void 0===o&&(o=null),void 0===s&&(s=!1),new e(t,n,i,r,a,o,s,0)},e.createOnIdle=function(t,n,i,r,a,o){return void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=null),new e(5,t,n,i,a,o,!1,r)},t=e,(n=[{key:"priority",get:function(){return this._priority}},{key:"taskType",get:function(){return this._type}},{key:"interval",get:function(){return this._tickInterval},set:function(e){this._tickInterval=e}},{key:"idleTimeout",get:function(){return this._idleTaskTimeout}},{key:"loggingName",get:function(){return this.name?this.taskItemId.toString()+"_"+this.name:this.taskItemId.toString()}},{key:"acceptableTickRange",get:function(){return null!=this._acceptableTickRange?this._acceptableTickRange:this._taskManagerUtils?this._taskManagerUtils.getDefaultTaskAcceptableTickRange(this):0},set:function(e){this._acceptableTickRange=e}},{key:"lastProcessed",get:function(){return this._lastProcessed}},{key:"nextIntervalTime",get:function(){return this.lastProcessed+this.interval}},{key:"lastDelayTick",get:function(){return this._lastDelayTick}},{key:"queueTick",get:function(){return this._lastDelayTick+this._tickInterval}},{key:"isDeleted",get:function(){return this._deleted},set:function(e){this._deleted=e}},{key:"taskItemId",get:function(){return this._taskItemId}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"TaskItem",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=(n(9),n(106)),a=n(13);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){}var t,n,i;return e.removeBroltiFlightFromStaticContentQueryParameter=function(t){return t&&((t=t.replace("?UseBrotli=true",""))!==e.staticContentQueryParameter&&""!==t&&(t="?"+t),t=t.replace("&UseBrotli=true","")),t},e.commonImage=function(t){return r.a.instance.isEnabled?e.createHashedResourcePath(t,e.commonImageBase,!0,!0):e.sharedStaticContentHost+e.commonImageBase+a.a.escape(t)+e.removeBroltiFlightFromStaticContentQueryParameter(e.staticContentQueryParameter)},e.commonCss=function(t){return r.a.instance.isEnabled?e.createHashedResourcePath(t,e.commonCssBase,!0,!1):e.sharedStaticContentHost+e.commonCssBase+a.a.escape(t)+e.staticContentQueryParameter},e.commonScripts=function(t){return e.commonScriptsPath(t)+e.staticContentQueryParameter},e.commonScriptsPath=function(t){return r.a.instance.isEnabled?e.createHashedResourcePath(t,e.commonScriptsBase,!1,!1):e.sharedStaticContentHost+e.commonScriptsBase+a.a.escape(t)},e.commonScriptsLocalized=function(t){return r.a.instance.isEnabled?e.createHashedResourcePath(t,e.commonScriptsLcidBase,!0,!1):e.sharedStaticContentHost+e.commonScriptsLcidBase+a.a.escape(t)+e.staticContentQueryParameter},e.createHashedResourcePath=function(t,n,i,o){var s=r.a.instance.getHashedCommonResourceHost(n+t)||e.sharedStaticContentHost,l="";return i&&(l=o?e.removeBroltiFlightFromStaticContentQueryParameter(e.staticContentQueryParameter):e.staticContentQueryParameter),s+n+a.a.escape(t)+l},e.combineUrlPaths=function(e,t){return e?e.endsWith("/")?e+t:e+"/"+t:t},e.isAbsolute=function(t){return e._absolutePatExp.test(e._prefixExp.exec(t)[1])},e.absolutePath=function(t){return e.isAbsolute(t)?t:t.startsWith("/")?e.pageHost+t:t.startsWith("~")?null:e.pageBase+t},e.commonImageLocation=function(t){var n=e.commonImage(t);return n.substring(0,n.length-t.length)},t=e,i=[{key:"staticContentQueryParameter",get:function(){return e._StaticContentQueryParameter},set:function(t){e._StaticContentQueryParameter=t?t.replace("&","&amp;"):""}},{key:"pagePath",get:function(){return e._pagePath||(e._pagePath=e._prefixExp.exec(document.URL)[1])}},{key:"pageBase",get:function(){return e._pageBase||(e._pageBase=e._absolutePatExp.exec(e.pagePath)[1])}},{key:"pageHost",get:function(){return e._pageHost||(e._pageHost=new RegExp("^([a-z+.-]+://[^/]*)").exec(document.URL)[1])}}],(n=null)&&o(t.prototype,n),i&&o(t,i),e}();s.commonImageBase=null,s.commonCssBase=null,s.commonScriptsBase=null,s.commonScriptsLcidBase=null,s._StaticContentQueryParameter=null,s.staticContentHost=null,s.sharedStaticContentHost=null,s._prefixExp=new RegExp("^([^?]+)"),s._absolutePatExp=new RegExp("^([a-z+.-]+://(?:[^/]*/)*)[^/]*$"),s._pagePath=null,s._pageBase=null,s._pageHost=null,Object(i.a)(s,"CommonPath",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"EventHandlerArgs",(function(){return a}));var i=n(0);n(9),n(54),n(4);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(e){var t,n,i,a,o;function s(t,n,i,r){var a;return(a=e.call(this)||this).userData=null,a.eventName=t,a.innerEvent=i,a._source=n,a._inputSource=r,a}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,s.getSourceElement=function(e){var t=e.rawEvent;if(!t)return e.target;var n=t.srcElement||t.target;return n?3===n.nodeType&&n.parentNode?n.parentNode:n:null},s.getFirstTouchInfo=function(e){var t=null,n=null,i=null;return(i=e.rawEvent?e.rawEvent:e).touches&&(!(n=i.touches).length&&i.changedTouches&&(n=i.changedTouches),t=n[0]),t},s.getClientPointFromTouchEvent=function(e){var t=e.clientX?e:s.getFirstTouchInfo(e);return new Sys.UI.Point(t.clientX,t.clientY)},s.getScreenPointFromTouchEvent=function(e){var t=s.getFirstTouchInfo(e);return t?new Sys.UI.Point(t.screenX,t.screenY):new Sys.UI.Point(0,0)},s.getElementPoint=function(e,t){var n=Sys.UI.DomElement.getLocation(t);return new Sys.UI.Point(e.x-n.x,e.y-n.y)},s.getMouseButton=function(e){var t=e.button;return"undefined"!=typeof e.which?t:4===t?1:2===t?2:0},i=s,(a=[{key:"clientPoint",get:function(){return null}},{key:"screenPoint",get:function(){return null}},{key:"elementPoint",get:function(){return null}},{key:"shiftKey",get:function(){return!1}},{key:"ctrlKey",get:function(){return!1}},{key:"sourceElement",get:function(){return this._source}},{key:"inputSource",get:function(){return this._inputSource}}])&&r(i.prototype,a),o&&r(i,o),s}(Sys.EventArgs);Object(i.a)(a,"EventHandlerArgs",Sys.EventArgs,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(23),a=n(6);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.elmLabel=null,this.elmDescription=null,this.elmImage=null,this.elmIconContainer=null,this._displayMode=e,this.elmControl=t,this._domStrategy=n}var t,n,i,s=e.prototype;return s.setLabelText=function(e){var t=!1;this._domStrategy&&(t=this._domStrategy.updateLabel(this.elmLabel,e)),!t&&this.elmLabel&&("Large"===this.displayMode||"Large16"===this.displayMode||"FloatieLarge"===this.displayMode?a.a.setLargeControlText(this.elmLabel,e,!1):this.elmLabel.innerText=e)},s.setTooltip=function(e){this.elmControl&&(!r.Control.hasTextSpace(this.displayMode)||this.elmLabel&&this.elmLabel.innerText!==e)&&(this.elmControl.title=e)},t=e,(n=[{key:"displayMode",get:function(){return this._displayMode}}])&&o(t.prototype,n),i&&o(t,i),e}();Object(i.a)(s,"ControlComponentDom",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.unknown=0,r.unknownCause=0,r.unknownResolution=0,r.unhandledError=1,r.cannotOpenFile=2,r.conversionFailed=3,r.openInClientFailed=4,r.openInClientOffice14Required=5,r.openFileNetworkProblem=6,r.networkProblem=7,r.conversionFileExists=8,r.openInClientWithC2RFailed=9,r.jsonErrorResponse=12,r.failedToContactServer=13,r.openInClientSecondaryFailed=14,r.downloadFailed=15,r.configError=16,r.saveToCloudStorageUploadFailed_Deprecated=17,r.saveToCloudStorageReturnedNotJSON_Deprecated=18,r.fullAppSettingDownloadFailed=19,r.unexpectedPostMessage=20,r.applicationCrashed=21,r.roamingControlMissing=22,r.commentNewSelectSomething=23,r.commentNewInvalidContent=24,r.renameFileFailed_Deprecated=25,r.saveAsToHostFailed=26,r.launchAddInCommandsFailed=27,r.sessionAccessTokenExpired=28,r.downloadAccessiblePdfViewFailed=29,r.feedbackPackageLoadFailed=30,r.learningToolsLaunchFailed=31,r.saveAsFileSizeTooLarge=32,r.openInClientFailedDelayed=33,r.oneDriveFilePickerNotJSON=34,r.saveAsToOneDriveFailed_FilePicker=35,r.saveAsToSharePointFailed_Error=36,r.saveAsToSharePointFailed_Warning=37,r.saveAsToSharePointFailed_Unspecified=38,r.dictation_Error=39,r.unsupportedBrowserWarning=40,r.unsupportedBrowserCrashed=41,r.noGraphTransactionCrashSaved=42,r.sessionExpiredDueToScheduledShutdown=43,Object(i.a)(r,"CommonErrorCode",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(2),r=n(1),a=n(0),o=function(){this.getBooleanFeatureGate=null,this.getStringFeatureGate=null,this.getIntFeatureGate=null};Object(a.a)(o,"FeatureGateManager",null,[]);var s=n(329),l=n(79);n.d(t,"appChromeAlreadyLoaded",(function(){return c})),n.d(t,"appChromeContainsAction",(function(){return u})),n.d(t,"apiExists",(function(){return d})),n.d(t,"selectorExists",(function(){return p})),n.d(t,"apiExtensionExists",(function(){return h})),n.d(t,"isSimplifiedReactRibbonUxEnabled",(function(){return m})),n.d(t,"getRenderAppChromeSettings",(function(){return g})),n.d(t,"initializeAppChrome",(function(){return f})),n.d(t,"setFeatureGateManager",(function(){return v})),n.d(t,"getUILocationFromPayload",(function(){return _}));var c=function(){return!!(window.appChrome&&appChrome.api&&appChrome.actions&&appChrome.selectors)},u=function(e){return c()&&!!appChrome.actions[e]},d=function(e){return c()&&!!appChrome.api[e]},p=function(e){return c()&&!!appChrome.selectors[e]},h=function(e){return c()&&!!appChrome[e]},m=function(){return!!r.AFrameworkApplication.activeFrame&&r.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled},g=function(){var e={};e.negativeSign=r.AFrameworkApplication.numberFormat.negativeSign,e.numberDecimalDigits=r.AFrameworkApplication.numberFormat.numberDecimalDigits,e.numberDecimalSeparator=r.AFrameworkApplication.numberFormat.numberDecimalSeparator,e.numberNegativePattern=r.AFrameworkApplication.numberFormat.numberNegativePattern,e.numberGroupSeparator=r.AFrameworkApplication.numberFormat.numberGroupSeparator,e.numberGroupSizes=r.AFrameworkApplication.numberFormat.numberGroupSizes;var t={};return t.numberFormatInfo=e,t},f=function(e){d("setCookieWithExpirationCallback")&&d("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((function(e,t){return l.a.setWithExpiration(e,t,l.a.maxComplianceAllowedRetentionInDays)})),appChrome.api.setGetCookieValueCallback((function(e){return l.a.get(e)}))),appChrome.setAppSettings(r.AFrameworkApplication.appSettingsManager.appSettings),v(),appChrome.api.setWebpackPublicPath(r.AFrameworkApplication.staticContentScriptNameBase),appChrome.setScriptLoader(Object(i.d)(e,e.loadScript,"loadScript")),appChrome.api.initializeLogger(new s.a)},v=function(){d("setFeatureGateManager")&&appChrome.api.setFeatureGateManager(Object.assign(new o,{getBooleanFeatureGate:Object(i.d)(r.AFrameworkApplication.appSettingsManager,r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(i.d)(r.AFrameworkApplication.appSettingsManager,r.AFrameworkApplication.appSettingsManager.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(i.d)(r.AFrameworkApplication.appSettingsManager,r.AFrameworkApplication.appSettingsManager.getStringFeatureGate,"getStringFeatureGate")}))},_=function(e){if(e)switch(e.location){case"ContextMenu":return 19;case"Floatie":return 9;case"SingleLineRibbon":return 14;case"MultilineRibbon":return 15;case"Overflow":return 16;case"TellMe":return 17;case"FarPeripheralControls":return 18;case"Header":return 21;case"FileMenu":return 22;case"Ribbon":default:return 2}return 2}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.alt="Alt",r.iconColor="IconColor",r.image16by16Class="Image16by16Class",r.image30by30Class="Image30by30Class",r.image32by32Class="Image32by32Class",r.image48by48Class="Image48by48Class",r.labelText="LabelText",r.labelTextUserGeneratedPlaceholderReplacements="LabelTextUserGeneratedPlaceholderReplacements",r.visible="Visible",r.sourceControlId="SourceControlId",r.customTooltip="CustomTooltip",r.Icon="Icon",r.IconSet="IconSet",r.reduxActions="ReduxActions",Object(i.a)(r,"SharedControlCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.name=null,this.bool=null,this.string=null,this.int64=null,this.double=null,this.date=null,this.contract=null};Object(i.a)(r,"DataField",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}return e.sendTraceTagNoop=function(e,t,n){},e.debugAssertTagNoop=function(e,t,n){void 0===n&&(n=null)},e}();r.sendTraceTag=r.sendTraceTagNoop,r.debugAssertTag=r.debugAssertTagNoop,Object(i.a)(r,"BULS",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(17),o=n(224),s=(n(9),n(54),n(200)),l=function(e){this.proxyElement=e,this.eventProcessors={},this.eventNameBindings={}};Object(i.a)(l,"EventHandlerProxyData",null,[]);var c=function(){this.eventHandlerBindings=[],this.domEventHandlerBindings=[],this.isHandlerRegistered=!1,this.isPersistent=0};Object(i.a)(c,"EventNameBinding",null,[]);var u=n(4),d=function(){function e(e,t){var n,i;this.eventHandlerProxyData=new l(t),this.eventHandlerProxy=(n=e,i=this.eventHandlerProxyData,function(e){n(e,i)})}return e.prototype.getEventNameBinding=function(e){var t=this.eventHandlerProxyData.eventNameBindings[e];return t||(t=new c,this.eventHandlerProxyData.eventNameBindings[e]=t),t},e}();Object(i.a)(d,"EventHandlerProxyCache",null,[]);var p=n(73),h=n(198),m=n(39),g=n(60),f=n(50),v=n(325),_=n(16),y=n(10),b=n(114),S=n(117),C=n(21),A=n(3);function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"EventHandlerManager",(function(){return w}));var w=function(e){var t,i;function l(t,n,i){var r;return(r=e.call(this)||this)._eventHandlerRegistrationStrategy=null,r._enableClicksTask=null,r._clicksEnabled=!0,r._isEventHandlingDisabled=!1,r._ignoreTaskManagerRunningRefCount=0,r._onBeforeEventProcessedCallbacks={},r._onAfterEventProcessedCallbacks={},r._onAfterTouchEndProcessedHandlers=[],r._onTouchMoveHandlers=[],r._onEventInterruptedTask=null,r._onExceptionOccurred=null,r._eventBeingProcessed=null,r._lastClickEventTime=0,r._isDragging=!1,r.cookieConsentClickHandler=null,r._cpuMeter=t,r._wacCookieCompliance=n,i.execute((function(e){r._eventHandlerRegistrationStrategy=e})),r}i=e,(t=l).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var c,w,T,E=l.prototype;return E.startIgnoringTaskManagerRunning=function(){this._ignoreTaskManagerRunningRefCount++},E.stopIgnoringTaskManagerRunning=function(){this._ignoreTaskManagerRunningRefCount>0&&this._ignoreTaskManagerRunningRefCount--},E.initializeListForElement=function(e,t,n,i){for(var r=0;r<e.length;r++)this.initializeEventForElement(e[r],t,n,i)},E.initializeEventForElement=function(e,t,n,i){this.initializeForElement(t),this.initializeForElementInternal(e,t,n,i)},E.initializeForElementInternal=function(e,t,n,i,r){void 0===r&&(r=!1),this.bindEventName(e,t,n,i,r).isPersistent++},E.deinitializeListForElement=function(e,t){for(var n=0;n<t.length;n++)this.deinitializeEventForElement(e,t[n])},E.deinitializeEventForElement=function(e,t){this.deinitializeForElement(e),this.deinitializeForElementInternal(e,t)},E.deinitializeForElementInternal=function(e,t,n){if(void 0===n&&(n=!1),t){var i=l.getEventNameBinding(t,e);if(!i)return void A.ULS.sendTraceTag(4032353,310,15,"No event name binding found on element {0}.",e);this.deinitializeEventNameBinding(e,t,i,n)}else{var r=l.retrieveHandlerProxyCache(e).eventHandlerProxyData.eventNameBindings;for(var a in r){var o={key:a,value:r[a]},s=o.key,c=o.value;c?c.isHandlerRegistered&&this.deinitializeEventNameBinding(e,s,c):A.ULS.sendTraceTag(4032354,310,15,"No event name binding found on element {0} and event name for binding {1}.",e,s||"null")}}},E.deinitializeEventNameBinding=function(e,t,n,i){void 0===i&&(i=!1),n.isPersistent--,this.releaseEventListenerIfUnused(t,e,i)},E.setOnEventInterruptedTask=function(e){this._onEventInterruptedTask=e},E.setOnExceptionOccurred=function(e){this._onExceptionOccurred=e},E.registerHandler=function(e,t,n,i,r,a,o){void 0===o&&(o=!1),this.registerHandlerInternal(e,t,new s.a(r,a),!0,n,i,o)},E.registerRawEventHandler=function(e,t,n){this.registerHandlerInternal(e,t,n,!1)},E.registerHandlerInternal=function(e,t,n,i,r,a,o){void 0===r&&(r=2),void 0===a&&(a=null),void 0===o&&(o=!1);var s=this.bindEventName(e,t,r,a,o);Array.add(i?s.eventHandlerBindings:s.domEventHandlerBindings,n)},E.unregisterHandler=function(e,t,n,i){void 0===i&&(i=!1),this.unregisterHandlerInternal(e,t,(function(e){return n===e.handler}),!0,i)},E.unregisterRawEventHandler=function(e,t,n){this.unregisterHandlerInternal(e,t,(function(e){return n===e}),!1)},E.unregisterHandlerInternal=function(e,t,n,i,r){void 0===r&&(r=!1);var a=l.getEventNameBinding(e,t);a&&(this.removeHandlersFromBinding(i?a.eventHandlerBindings:a.domEventHandlerBindings,e,t,n),this.releaseEventListenerIfUnused(e,t,r))},E.removeHandlersFromBinding=function(e,t,n,i){void 0===i&&(i=null);for(var r=e.length-1;r>=0;r--)i&&!i(e[r])||Array.removeAt(e,r)},E.unregisterAllHandlers=function(e){var t=l.retrieveHandlerProxyCache(e);if(t){var n=t.eventHandlerProxyData.eventNameBindings;for(var i in n){var r={key:i,value:n[i]},a=r.key,o=r.value;for(this.removeHandlersFromBinding(o.eventHandlerBindings,a,e),this.removeHandlersFromBinding(o.domEventHandlerBindings,a,e),this.releaseEventListenerIfUnused(a,e);o.isPersistent>0;)this.deinitializeForElementInternal(e,a)}}},E.unregisterAllHandlersForDOMArray=function(e){for(var t=0;t<e.length;++t)this.unregisterAllHandlers(e[t])},E.registerOnBeforeEventProcessed=function(e,t){this._onBeforeEventProcessedCallbacks[e]||(this._onBeforeEventProcessedCallbacks[e]=[]);var n=this._onBeforeEventProcessedCallbacks[e];Array.add(n,t)},E.registerOnBeforeEventsProcessed=function(e,t){for(var n=0;n<e.length;++n)this.registerOnBeforeEventProcessed(e[n],t)},E.registerOnAfterEventProcessed=function(e,t){this._onAfterEventProcessedCallbacks[e]||(this._onAfterEventProcessedCallbacks[e]=[]);var n=this._onAfterEventProcessedCallbacks[e];Array.add(n,t)},E.registerOnAfterEventsProcessed=function(e,t){for(var n=0;n<e.length;++n)this.registerOnAfterEventProcessed(e[n],t)},E.registerOnAfterTouchEndProcessed=function(e){Array.add(this._onAfterTouchEndProcessedHandlers,e)},E.unregisterOnAfterTouchEndProcessed=function(e){Array.contains(this._onAfterTouchEndProcessedHandlers,e)&&Array.remove(this._onAfterTouchEndProcessedHandlers,e)},E.registerOnTouchMove=function(e){Array.add(this._onTouchMoveHandlers,e)},E.unregisterOnTouchMove=function(e){Array.contains(this._onTouchMoveHandlers,e)&&Array.remove(this._onTouchMoveHandlers,e)},E.bindEventName=function(e,t,n,i,a){void 0===n&&(n=2),void 0===i&&(i=null),void 0===a&&(a=!1);var o=l.retrieveHandlerProxyCache(t);if(o||(o=new d(Object(r.d)(this,this.eventProxy,"eventProxy"),t),l.storeHandlerProxyCache(t,o)),i){var s=!1,c=o.eventHandlerProxyData,p=c.eventProcessors[e];if(p){for(var h=0,m=p.length;h<m;h++)if(p.peekAt(h)===i){0,s=!0;break}}else c.eventProcessors[e]=p=new v.a;s||p.enqueue(n,i)}var g=o.getEventNameBinding(e);return g.isHandlerRegistered||u.EventNames.isSimulated(e)||(this._eventHandlerRegistrationStrategy?this._eventHandlerRegistrationStrategy.addDomEventHandler(t,e,o.eventHandlerProxy,a):this.addDomEventHandler(t,e,o.eventHandlerProxy,a),g.isHandlerRegistered=!0),g},E.eventProxy=function(e,t){var n=this;if(!this._isEventHandlingDisabled){var i=t,r=u.EventNames.eventNameFromString(e.type),o=String.format("{0} / {1}[{2}]",r,i.proxyElement.tagName,i.proxyElement.id);if(!(!(null==e)&&!(void 0===e.rawEvent||null===e.rawEvent)&&e.rawEvent[a.a.markerFieldForEventsToBeIgnored]))if(this._onExceptionOccurred)try{this._cpuMeter.profileTopLevelTask((function(){n.eventProxyInternal(e,r,i)}),o,0)}catch(e){A.ULS.sendTraceTag(17114121,310,10,"EventProxy: Exception during event {0}",o),this._onExceptionOccurred(e)}else this._cpuMeter.profileTopLevelTask((function(){n.eventProxyInternal(e,r,i)}),o,0)}},E.eventProxyInternal=function(e,t,i){var r=this,a=n(1).AFrameworkApplication;if(t===u.EventNames.mouseDown||t===u.EventNames.msPointerDown||t===u.EventNames.browserPointerDown||t===u.EventNames.touchStart||t===u.EventNames.keyDown){var o=new Date;a.latestActivityTime=o}if(this._wacCookieCompliance.checkConsentWithSettings((function(){return Object.assign(new ConsentSettings(e,t),{clickEventCheckHandler:r.cookieConsentClickHandler})})),!this.filterClickAndMouseEvents(t,e)&&(this._ignoreTaskManagerRunningRefCount||!g.a.instance.isRunning||!this.handleEventInterruptedTask(e,t))&&(void 0!==i.eventProcessors[t]||this.hasDomEventHandlersToExecute(i,t))){if(this._eventBeingProcessed=t,this.executeOnBeforeEventProcessedCallbacks(e,t),this.executeDomEventHandlers(i,t,e),this.executeEventProcessors(i,t,e),this.executeOnAfterEventProcessedCallbacks(e,t),t===u.EventNames.touchEnd)for(var s=0;s<this._onAfterTouchEndProcessedHandlers.length;++s){(0,this._onAfterTouchEndProcessedHandlers[s])()}if(t===u.EventNames.touchMove)for(var l=0;l<this._onTouchMoveHandlers.length;++l){(0,this._onTouchMoveHandlers[l])()}this._eventBeingProcessed=null}},E.executeOnBeforeEventProcessedCallbacks=function(e,t){var n=this._onBeforeEventProcessedCallbacks[t];if(n){0;for(var i=0;i<n.length;++i)n[i](e)}},E.executeOnAfterEventProcessedCallbacks=function(e,t){var n=this._onAfterEventProcessedCallbacks[t];if(n){0;for(var i=0;i<n.length;++i)n[i](e)}},E.executeEventProcessors=function(e,t,n){var i=e.eventProcessors[t];if(void 0!==i)for(var r=0;r<i.length;r++){if(i.peekAt(r)(t,e.proxyElement,n))break}},E.hasDomEventHandlersToExecute=function(e,t){if(!e.eventNameBindings[t])return!1;var n=e.eventNameBindings[t].domEventHandlerBindings;return!!n&&n.length>0},E.executeDomEventHandlers=function(e,t,n){if(this.hasDomEventHandlersToExecute(e,t))for(var i=e.eventNameBindings[t].domEventHandlerBindings,r=0;r<i.length;r++){(0,i[r])(n)}},E.handleEventInterruptedTask=function(e,t){return(t!==u.EventNames.message||!y.a.isInternetExplorer8)&&(this._onEventInterruptedTask&&this._onEventInterruptedTask(t),t!==u.EventNames.touchStart&&t!==u.EventNames.touchEnd||this.temporarilyDisableBrowserClicks(),t===u.EventNames.touchEnd&&h.TouchAndHoldAdapter.cancelAnyPendingTouchAndHold(),a.a.cancelEvent(e),!0)},E.simulateBubblingEvent=function(e,t,n){var i=t,r=!1;for(0;!r&&i;){var a=l.retrieveHandlerProxyCache(i);if(a){var o=a.eventHandlerProxyData.eventProcessors[e];if(o)for(var s=0;s<o.length;s++){if(r=o.peekAt(s)(e,i,n)||r)break}}i=i.parentNode}},E.processEvent=function(e,t,n){var i=!1,r=l.retrieveHandlerProxyCache(t).eventHandlerProxyData.eventNameBindings[e];if(r)for(var a=0;a<r.eventHandlerBindings.length&&!i;a++){var o=r.eventHandlerBindings[a];n.userData=o.userData,i=o.handler(n)}return i},E.releaseEventListenerIfUnused=function(e,t,n){void 0===n&&(n=!1);var i=l.retrieveHandlerProxyCache(t);var r=i.getEventNameBinding(e);if(r)try{r.isHandlerRegistered&&!r.eventHandlerBindings.length&&!r.domEventHandlerBindings.length&&r.isPersistent<=0&&(this._eventHandlerRegistrationStrategy?this._eventHandlerRegistrationStrategy.removeDomEventHandler(t,e,i.eventHandlerProxy,n):this.removeDomEventHandler(t,e,i.eventHandlerProxy,n),r.isHandlerRegistered=!1,delete i.eventHandlerProxyData.eventProcessors[e])}catch(i){var a;A.ULS.sendTraceTag(51196386,310,15,"ReleaseEventListenerIfUnused: {0}",((a={}).Exception=i,a.ClassName=t.className,a.ID=t.id,a.eventName=e,a.useCapture=n,a))}else A.ULS.sendTraceTag(51196385,310,15,"binding is null when we try to release event listener")},E.filterClickAndMouseEvents=function(e,t){if(!this._clicksEnabled){if(e===u.EventNames.click)return this.cancelBrowserClick(t),!0;if(p.a.isMouseEventName(e)&&!_.a.isTextField(t.rawEvent?t.rawEvent.srcElement:t.target))return a.a.cancelEvent(t),!0}return!1},E.temporarilyDisableBrowserClicks=function(){this._clicksEnabled=!1,this._enableClicksTask?(g.a.instance.deleteTask(this._enableClicksTask),g.a.instance.addTask(this._enableClicksTask)):(this._enableClicksTask=new m.a(2,1,l.maxClickDisabledTime,Object(r.d)(this,this.reenableBrowserClicks,"reenableBrowserClicks"),13),g.a.instance.addTask(this._enableClicksTask))},E.reenableBrowserClicks=function(e){this._clicksEnabled=!0,this._enableClicksTask=null},E.forceReenableBrowserClicks=function(){this.reenableBrowserClicks(null)},E.cancelBrowserClick=function(e){a.a.cancelEvent(e),g.a.instance.deleteTask(this._enableClicksTask),this.reenableBrowserClicks(null)},E.enableEventHandling=function(e){this._isEventHandlingDisabled=!e},l.createEventHandlerManager=function(){return new l(o.a.instance,S.a.instance,C.a.instance.resolveFuture("Common.IEventHandlerRegistrationStrategy"))},l.disposeInputManager=function(){f.a(l._instance)},l.getEventNameBinding=function(e,t){var n=l.retrieveHandlerProxyCache(t);return n?n.getEventNameBinding(e):null},l.retrieveHandlerProxyCache=function(e){return b.a(e,l.inputDataName)},l.storeHandlerProxyCache=function(e,t){b.b(e,l.inputDataName,t)},c=l,T=[{key:"instance",get:function(){return l._instance||(l._instance=l.createEventHandlerManager()),l._instance}}],(w=[{key:"processingEvent",get:function(){return!!this.eventBeingProcessed}},{key:"eventBeingProcessed",get:function(){return this._eventBeingProcessed}},{key:"lastClickEventTime",get:function(){return this._lastClickEventTime}},{key:"isDragging",get:function(){return this._isDragging}}])&&I(c.prototype,w),T&&I(c,T),l}(a.a);w.initializeForElementRegistrationType=void 0,w.registerHandlerRegistrationType=void 0,w.browserRegistrationType=void 0,w.inputDataName="HandlerCache",w.maxClickDisabledTime=1e3,w._instance=null,Object(i.a)(w,"EventHandlerManager",a.a,[20])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(63),a=n(112);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){this._events=null,this._recordedEvents=null}var t,n,i,s=e.prototype;return s.dispose=function(){this._events=null,this._recordedEvents=null},s.addHandler=function(e,t){this.recordedEvents.containsKey(e)||this.recordedEvents.set_item(e,new r.a),this.events.addHandler(e,t),this.recordedEvents.get_item(e).add(t)},s.removeHandler=function(e,t){if(this.recordedEvents.containsKey(e)){var n=this.recordedEvents.get_item(e);n.remove(t)&&(this.events.removeHandler(e,t),n.get_count()||this.recordedEvents.remove(e))}},s.raiseEvent=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var i=this.events.getHandler(e);return!!i&&(i(n||this,t||Sys.EventArgs.Empty),!0)},t=e,(n=[{key:"hasSubscribers",get:function(){return this.recordedEvents.get_count()>0}},{key:"events",get:function(){return this._events||(this._events=new Sys.EventHandlerList)}},{key:"recordedEvents",get:function(){return this._recordedEvents||(this._recordedEvents=new a.a)}}])&&o(t.prototype,n),i&&o(t,i),e}();Object(i.a)(s,"EventSource",null,[4])},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));n(19),n(3);var i=function(e){if(e)for(var t=0,n=e.length;t<n;t++)r(e[t])},r=function(e){if(e)try{e.dispose()}catch(e){0,n(305).setExceptionCallStack(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i=function(e,t,n){for(var i=Object.getPrototypeOf(e),r=Object.getOwnPropertyDescriptor(i,n);null==r&&null!=i;)i=Object.getPrototypeOf(i),r=Object.getOwnPropertyDescriptor(i,n);return r},r=function(e,t,n){var r=i(e,0,n);return"get"in r?r.get.call(t):r.value},a=function(e,t,n,r){var a=i(e,0,n);"set"in a?a.set.call(t,r):a.value=r}},function(e,t,n){"use strict";n.r(t),n.d(t,"CssUtils",(function(){return o}));var i=n(0),r=n(2),a=(n(9),n(3)),o=function(){function e(){}return e.getCurrentStyle=function(t){var n=null;if(t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.getComputedStyle&&(n=t.ownerDocument.defaultView.getComputedStyle(t,"")),!n){if(t.currentStyle)return t.currentStyle;e._isFirstNullCurrentStyle&&(a.ULS.sendTraceTag(6587334,210,15,"The current Style object from element was null"),e._isFirstNullCurrentStyle=!1)}return n},e.copyStyle=function(t,n){n.className="",n.style.cssText="";var i=e.getCurrentStyle(t),a=n.style;for(var o in i){var s={key:o,value:i[o]};try{Object(r.c)(String,s.value)&&""!==s.value&&(a[s.key]=s.value)}catch(e){0}}},e.setStyle=function(t,n,i){e.checkStyleExist(t,n)&&(t.style[n]=i)},e.removeStyle=function(t,n){e.setStyle(t,n,"")},e.clearStyles=function(e){e.removeAttribute("style")},e.setRotation=function(t,n){var i="rotate("+n+"deg)";e.setTransform(t,i)},e.setFlipTransForms=function(t,n,i){var r="";n&&(r+="scaleX(-1) "),i&&(r+="scaleY(-1) "),e.setTransform(t,r)},e.setTransform=function(t,n){e.checkStyleExist(t,"transform")?t.style.transform=n:e.checkStyleExist(t,"msTransform")?t.style.msTransform=n:e.checkStyleExist(t,"MozTransform")?t.style.MozTransform=n:e.checkStyleExist(t,"webkitTransform")&&(t.style.webkitTransform=n)},e.getTransform=function(t){return t&&t.style?e.checkStyleExist(t,"transform")?t.style.transform:e.checkStyleExist(t,"msTransform")?t.style.msTransform:e.checkStyleExist(t,"MozTransform")?t.style.MozTransform:e.checkStyleExist(t,"webkitTransform")?t.style.webkitTransform:null:null},e.setTransformOrigin=function(t,n){e.checkStyleExist(t,"transform")?t.style["transform-origin"]=n:e.checkStyleExist(t,"msTransform")?t.style["-ms-transform-origin"]=n:e.checkStyleExist(t,"MozTransform")?(t.style["-moz-transform-origin"]=n,t.style.transformOrigin=n):e.checkStyleExist(t,"webkitTransform")&&(t.style["-webkit-transform-origin"]=n)},e.checkStyleExist=function(e,t){return!(!e||void 0===e.style[t])},e.setScale=function(t,n){var i="scale("+n+")";e.setTransform(t,i),e.setTransformOrigin(t,"0% 0%")},e.parseIntDefaultZero=function(e){var t=parseInt(e);return!e||isNaN(t)?0:t},e.isReducedAnimations=function(){var e=window&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;return e||!1},e}();o._isFirstNullCurrentStyle=!0,Object(i.a)(o,"CssUtils",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.hostPerfTiming_Click="Click",r.hostPerfTiming_FetchStart="FetchStart",r.hostPerfTiming_FetchStartAlt="HostFrameFetchStart",r.hostPerfTiming_Iframe="Iframe",r.hostPerfTiming_RedirectCount="RedirectCount",r.appLoadingStatus_DocumentLoadedTime="DocumentLoadedTime",r.surveyTitle="SurveyTitle",r.fileRename_NewName="NewName",r.fileRename_FailureMessage="FailureMessage",r.shareCorrelation="ShareCorrelation",r.shareNavId="nav",r.shareMode="mode",r.addinControlId="AddinControlId",r.addinApplicationResource="AddinApplicationResource",r.accessToken="AccessToken",r.addinSSOError="AddinSSOError",r.addinSSOAuthChallenge="AddinSSOAuthChallenge",r.addinIsFirstParty="AddinIsFirstParty",r.addinName="AddinName",r.addinStoreType="AddinStoreType",r.allowConsentPrompt="AllowConsentPrompt",r.allowSignInPrompt="AllowSignInPrompt",r.hostApplicationType="HostApplicationType",r.userName="UserName",r.userEmail="UserEmail",r.federationProvider="FederationProvider",r.getTokenSilentTime="GetTokenSilentTime",r.getTokenPopupTime="GetTokenPopupTime",r.getIDTokenTime="GetIDTokenTime",r.tokenCached="TokenCached",r.authLibrary="AuthLibrary",r.ssoRequestId="SsoRequestId",r.ssoResource="SsoResource",r.ssoScope="SsoScope",r.ssoAuthChallenge="SsoAuthChallenge",r.ssoSilentLogin="SsoSilentLogin",r.ssoOptions="SsoOptions",r.ssoAccessToken="SsoAccessToken",r.ssoTokenExpiration="SsoTokenExpiration",r.ssoAuthority="SsoAuthority",r.ssoUserDisplayName="SsoUserDisplayName",r.ssoUserEmail="SsoUserEmail",r.ssoError="SsoError",r.ssoAuthTokenRequestId="RequestId",r.ssoAuthTokenResource="Resource",r.ssoAuthTokenScope="Scope",r.ssoAuthTokenIdentityType="IdentityType",r.ssoAuthTokenSilentLogin="SilentLogin",r.ssoAuthTokenUpn="Upn",r.ssoAuthTokenClaims="Claims",r.ssoAuthTokenCorrelationId="CorrelationId",r.ssoAuthToken="AuthToken",r.ssoAuthTokenTokenExpiration="TokenExpiration",r.ssoAuthTokenError="Error",r.ssoAuthTokenClientId="ClientId",r.cacAuthConfig="AuthConfig",r.diagnostics="Diagnostics",r.officeFrameRequestStartTime="officeFrameRequestStartTime",r.officeFrameFirstFlushTime="officeFrameFirstFlushTime",r.officeFrameBootResourcesStartTime="officeFrameBootResourcesStartTime",r.officeFrameBootResourcesEndTime="officeFrameBootResourcesEndTime",r.officeFrameBootScriptsStartTime="officeFrameBootScriptsStartTime",r.officeFrameBootScriptsEndTime="officeFrameBootScriptsEndTime",r.officeFrameDocumentFlushTime="officeFrameDocumentFlushTime",r.documentLoadedFromWopiPrecheckInfo="documentLoadedFromWopiPrecheckInfo",r.cacheHit="cacheHit",r.cacheAboutToExpire="cacheAboutToExpire",r.cacheInvalid="cacheInvalid",r.officeFrameServerStartTime="officeFrameServerStartTime",r.officeFrameServerFirstFlushTime="officeFrameServerFirstFlushTime",r.officeFrameServerFirstFlushEndTime="officeFrameServerFirstFlushEndTime",r.bundleRequestsData="bundleRequestsData",r.fileRequestsData="fileRequestsData",r.officeServerDocumentProcessStartTime="officeServerDocumentProcessStartTime",r.officeServerDocumentProcessEndTime="officeServerDocumentProcessEndTime",r.officeFrameServerDocumentFlushTime="officeFrameServerDocumentFlushTime",r.officeServerSsrFlushTime="officeServerSsrFlushTime",r.checkFileInfoStartTime="CheckFileInfoStartTime",r.checkFileInfoEndTime="CheckFileInfoEndTime",r.getFlightedAppSettingsStartTime="GetFlightedAppSettingsStartTime",r.getFlightedAppSettingsEndTime="GetFlightedAppSettingsEndTime",r.acquireLockStartTime="AcquireLockStartTime",r.acquireLockEndTime="AcquireLockEndTime",r.acquireLockRequestStatus="AcquireLockRequestStatus",r.getDocumentStartTime="GetDocumentStartTime",r.getDocumentEndTime="GetDocumentEndTime",r.getDocumentRequestStatus="GetDocumentRequestStatus",r.documentLoadedTime="documentLoadedTime",r.appCompletedTime="appCompletedTime",r.wopiCheckLastModifiedTime="wopiCheckLastModifiedTime",r.officeAppEndpoint="officeAppEndpoint",r.officeServerVersion="officeServerVersion",r.hostInitializeDiagnostics="HostInitializeDiagnostics",r.jsApiDiagnostics="JsApiDiagnostics",r.wacAction="Action",r.ackExpected="ackExpected",r.hostCacheLoadTime="HostCacheLoadTime",r.oAuthToken="access_token",r.oAuthError="error",r.oAuthResource="resource",r.newZoomLevel="newLevel",r.oldZoomLevel="oldLevel",r.newPage="newPage",r.oldPage="oldPage",r.pageCount="pageCount",r.isDisabled="isDisabled",r.type="type",r.keyCode="keyCode",r.altKey="altKey",r.ctrlKey="ctrlKey",r.metaKey="metaKey",r.shiftKey="shiftKey",r.direction="Direction",r.sessionInfo_TokenName="Name",r.sessionInfo_TokenExpiry="Expiry",r.sessionInfo_TokenValue="Value",r.sessionInfo_TokenNamesField="Tokens",r.sessionInfo_ErrorId="Id",r.sessionInfo_ErrorDetails="Details",r.sessionInfo_AccessToken="AccessToken",r.sessionInfo_FileGetUrl="FileGetUrl",r.newMode="NewMode",r.editable="Editable",r.wopiInfo_Url="Url",r.wopiInfo_WopiSrc="WopiSrc",r.wopiInfo_AccessToken="AccessToken",r.wopiInfo_AccessTokenExpiry="AccessTokenExpiry",r.wopiInfo_Error="Error",r.isTopFrameTrusted="isTopFrameTrusted",r.ignoreForEUPL="ignoreForEUPL",r.errorObject="errorObject",r.documentUrl="documentUrl",r.rebootMode="rebootMode",r.mode="mode",r.queryOverrides="queryOverrides",r.isNewSession="isNewSession",r.reason="reason",r.template="template",r.appID="appID",r.lcid="lcid",r.overlayContent="overlayContent",r.supportCrossSite="supportsCrossSiteMove",r.moveButtonClickTime="moveStartTime",r.isMoveSuccessful="isMoveSuccessful",r.updatedDocumentUrl="updatedDocumentUrl",r.isCrossSiteMove="isCrossSiteMove",r.ssrKey="ssrKey",r.ssrValue="ssrValue",r.entryPoint="entryPoint",r.workbookList="workbookList",r.evictAllExceptListed="evictAllExceptListed",r.cacheItemKey="cacheItemKey",r.cacheItemValue="cacheItemValue",r.hostKey="hostKey",r.hostValue="hostValue",Object(i.a)(r,"CrossDocumentMessageFields",null,[])},function(e,t,n){"use strict";var i=n(0),r=function(){};r.actionManager="ActionManager",r.actionManager_UnitTest="ActionManager_UnitTest",r.actions="Actions",r.activities="Activities",r.animation="Animation",r.broadcast="Broadcast",r.businessBar="BusinessBar",r.clickInputManager="ClickInputManager",r.clientRequest="ClientRequest",r.clientRequestTest="ClientRequestTest",r.collabControls="CollabControls",r.comment="Comment",r.commonUlsHost="CommonUlsHost",r.compositionEventManager="CompositionEventManager",r.controls="Controls",r.cookies="Cookies",r.createNew="CreateNew",r.crossDocumentMessenger="CrossDocumentMessenger",r.cursorManager="Cursor Manager",r.debugMessage="Debug Message",r.debugPanel="DebugPanel",r.domUtil="DomUtil",r.dragInputManager="DragInputManager",r.downloadQueue="DownloadQueue",r.editNotification="EditNotification",r.error="Error",r.eventHandlerManager="EventHandlerManager",r.f6Manager="F6Manager",r.focus="Focus",r.focusManager="FocusManager",r.focusManagement="FocusManagement",r.fonts="Fonts",r.frameMode="FrameMode",r.graph="Graph",r.inputManager="InputManager",r.insertFile="InsertFile",r.insights="Insights",r.keyInputManager="KeyInputManager",r.logUtCat1="Log UT Cat1",r.logUtCat2="Log UT Cat2",r.metrics="Metrics",r.mouseInputManager="MouseInputManager",r.mruActor="MruActor",r.mruFonts="MRU Fonts",r.notificationBar="NotificationBar",r.o365Shell="O365Shell",r.pageManager="Page Manager",r.panning="Panning",r.peoplesWell="PeoplesWell",r.priorityQueue="Priority Queue",r.properties="Properties",r.realtimeChannel="RealtimeChannel",r.renameFile="RenameFile",r.ribbon="Ribbon",r.safeLinks="SafeLinks",r.searchUI="SearchUI",r.selection="Selection",r.docChat="DocChat",r.smartLookup="SmartLookup",r.statusBar="StatusBar",r.stringUtilities="StringUtilities",r.taskManager="TaskManager",r.taskPane="TaskPane",r.taskPaneManager="TaskPaneManager",r.tasks="Tasks",r.test="Test",r.testContentEditable="TestContentEditable",r.textMetrics="TextMetrics",r.throttlingManager="ThrottlingManager",r.touchInputManager="TouchInputManager",r.showPageStats="ShowPageStats",r.styleSheet="StyleSheet",r.unitTest="Unit Test",r.utilities="Utilities",r.versionHistory="VersionHistory",r.wacAirSpace="WacAirSpace",r.webTOAD="WebTOAD",r.webSiteAnalytics="WebSiteAnalytics",r.wordBreakUtilities="WordBreakUtilities",Object(i.a)(r,"DebugLogCategory",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"oneNoteImageMapName",(function(){return a})),n.d(t,"pptAttendeeImageMapName",(function(){return o})),n.d(t,"pptEditorImageMapName",(function(){return s})),n.d(t,"pptViewerImageMapName",(function(){return l})),n.d(t,"wordEditorImageMapName",(function(){return c})),n.d(t,"wordViewerImageMapName",(function(){return u})),n.d(t,"createClusteredImage",(function(){return d})),n.d(t,"createClusteredImageFromCluster",(function(){return p})),n.d(t,"createClusteredImageFromClusterWithImageClass",(function(){return h})),n.d(t,"getImageClass",(function(){return f})),n.d(t,"getImageClassWithCluster",(function(){return v})),n.d(t,"setImageTooltip",(function(){return _}));var i=n(1),r=(n(9),n(7)),a=(n(13),"one"),o="pat",s="per",l="prt",c="we",u="wv",d=function(e,t,n,r,a,o){return p(e,t,n,i.AFrameworkApplication.imageClusterName,i.AFrameworkApplication.imageClusterPath,r,null,a,o)},p=function(e,t,n,i,r,a,o,s,l,c){return void 0===c&&(c=null),h(e,t,v(i,n),r,a,o,s,l,c)},h=function(e,t,n,i,r,a,o,s,l,c){void 0===l&&(l=null),void 0===c&&(c=null);var u=m(l,"span"),d=String.format("clip{0}x{1}",e.toString(),t.toString());return u.className=r?r+" "+d:d,u.setAttribute("Unselectable","on"),u.style.zIndex="0",o&&(u.style.display="inline-block"),c||(c=g(n,i,r,a,s,l)),u.appendChild(c),u},m=function(e,t){return(e||window.document).createElement(t)},g=function(e,t,n,i,a,o){void 0===o&&(o=null);var s=m(o,"img");return s.className=i?i+" "+e:e,s.setAttribute("Unselectable","on"),s.setAttribute(r.a.ariaRoleAttribute,r.a.ariaPresentationRole),s.src=t,a&&(s.alt=a,s.title=a),s},f=function(e){return String.format("{0}_{1}",i.AFrameworkApplication.imageClusterName,e)},v=function(e,t){return String.format("{0}_{1}",e,t)},_=function(e,t){var n=e.children[0];n.alt=t,n.title=t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(0),r=n(2),a=n(17),o=(n(9),n(41)),s=n(48),l=(n(4),n(50));function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._eventHandlerManager=s.EventHandlerManager.instance,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var u,d,p,h=i.prototype;return h.registerHandler=function(e,t,n){this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onEvent,"onEvent"),n,null)},h.unregisterHandler=function(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)},h.onEvent=function(e,t,n){var i=o.EventHandlerArgs.getSourceElement(n),r=new o.EventHandlerArgs(e,i,n,0),s=this._eventHandlerManager.processEvent(e,t,r);return s&&a.a.cancelEvent(n),s},i.disposeInputManager=function(){l.a(i._instance)},u=i,p=[{key:"instance",get:function(){return i._instance||(i._instance=new i),i._instance}}],(d=null)&&c(u.prototype,d),p&&c(u,p),i}(a.a);u._instance=null,Object(i.a)(u,"BasicInputManager",a.a,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(17),o=(n(9),n(129),n(185),n(54),n(4)),s=n(324),l=function(){function e(e){this.touchAdapters=new s.a,this.target=e}var t=e.prototype;return t.canHandleEvent=function(e){for(var t=0;t<this.touchAdapters.length;t++){if(this.touchAdapters.get_item(t).canHandleEvent(e))return!0}return!1},t.getFirstAdapter=function(e){for(var t=0;t<this.touchAdapters.length;t++){var n=this.touchAdapters.get_item(t);if(n.canHandleEvent(e))return n}return null},t.addAdapter=function(e,t){this.touchAdapters.add(e,t)},t.removeAdapter=function(e){this.touchAdapters.remove(e)},t.isEmpty=function(){return!this.touchAdapters.length},e}();Object(i.a)(l,"TouchAdapterRegister",null,[]);var c=n(246),u=n(97),d=n(60),p=n(22),h=n(50),m=n(16),g=n(10),f=n(8),v=n(3);function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return y}));var y=function(e){var t,i;function s(){var t;(t=e.call(this)||this)._touchRegions=[],t._touchAdapter=null,t._firstDownEvent=null,t._shouldShowContextMenuOnTouchEnd=!1;var i=n(24).FocusManager,r=n(48).EventHandlerManager;return t._eventHandlerManager=r.instance,t._focusManager=i.instance(),t}i=e,(t=s).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var y,b,S,C=s.prototype;return C.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(o.EventNames.get_touchEvents(),t,0,Object(r.d)(this,this.onTouchEvent,"onTouchEvent"))},C.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t,o.EventNames.get_touchEvents())},C.registerHandler=function(e,t,n,i){this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onTouchEvent,"onTouchEvent"),n,i)},C.unregisterHandler=function(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)},C.setShowContextMenuOnTouchEnd=function(e){this._shouldShowContextMenuOnTouchEnd=e},C.onTouchEvent=function(e,t,i){var l=n(1).AFrameworkApplication,u=n(198).TouchAndHoldAdapter;if(!this.isEnabled)return!1;if(s.isOneNoteInkingImprovementsEnabled())return!0;if(d.a.instance.isYielding)return v.ULS.sendTraceTag(24699484,324,50,"Touch event dropped."),!1;if(this._supressEvents)return a.a.cancelEvent(i),!0;if(s.isMultiTouch(i)&&(l.appSettingsManager.getBooleanAppSetting("LogMultiTouchIsEnabled")&&s.logMultiTouchIfNeeded(),u.cancelAnyPendingTouchAndHold(),!this._touchRegions.length))return!1;var h=c.a.create(e,t,null,i);if(this._touchRegions.length>0&&this.canHandleEvent(h)&&!this.onHandleEvent(h))return!1;var f=n(198).TouchAndHoldAdapter.getTouchAndHoldAdapter(h.sourceElement);f.cancelTouchAndHoldIfNecessary(h),e===o.EventNames.touchStart&&(f.beginTouchAndHold(h,Object(r.d)(this,this.onTouchAndHold,"onTouchAndHold"),this._shouldShowContextMenuOnTouchEnd),s.logTouchStartIfNeeded()),e===o.EventNames.touchEnd&&(g.a.isIPad&&(g.a.iPadOsVersion<=6||6!==p.DomUtils.getTag(m.a.getActiveElement(window.document)))&&window.focus(),this._shouldShowContextMenuOnTouchEnd&&f.touchAndHoldBeforeTouchEndSatisfied&&(this.fireTouchContextMenuEvent(h.innerEvent.rawEvent),f.cancelTouchAndHold()),this._touchAdapter&&(this._touchAdapter.onTouchEnd(h),this._touchAdapter=null,a.a.cancelEvent(i)));var _=this._eventHandlerManager.processEvent(e,t,h);return _&&a.a.cancelEvent(i),_},C.canHandleEvent=function(e){if(this._touchAdapter&&(o.EventNames.touchEnd===e.action||o.EventNames.touchMove===e.action))return!0;for(var t=e.innerEvent.target;t;t=t.parentNode){var n=this.getRegisterEntry(t);if(n&&n.canHandleEvent(e))return!0}return!1},C.onHandleEvent=function(e){var t=!1;if(this._touchAdapter)return o.EventNames.touchEnd===e.action?(t=this._touchAdapter.onTouchEnd(e),this._touchAdapter=null,a.a.cancelEvent(e.innerEvent)):e.action===o.EventNames.touchMove&&(t=this._touchAdapter.onTouchMove(e),a.a.cancelEvent(e.innerEvent)),t;if(o.EventNames.touchStart===e.action){for(var n=e.innerEvent.target;n;n=n.parentNode){this._firstDownEvent=e;var i=this.getRegisterEntry(e.caughtElement);if(i){var r=i.getFirstAdapter(e);if(r)return this._touchAdapter=r,r.onTouchStart(e)}}return t}return t},C.onTouchAndHold=function(e){this.fireTouchContextMenuEvent(e.innerEvent.rawEvent)},C.fireTouchContextMenuEvent=function(e){var t=e.srcElement||e.target,n=new Sys.UI.DomEvent(e);this._eventHandlerManager.simulateBubblingEvent(o.EventNames.touchContextMenu,t,n)},C.addControlFocus=function(e,t,n,i){var r=this;void 0===n&&(n=!1),void 0===i&&(i=!1);var a=function(t){return r._focusManager.tryChangeScopeOnStealingFocusEvent(e,i,n,t),!1};this.registerHandler(o.EventNames.touchStart,t,a,null),this._focusManager.getScope(e).addDispose((function(){r.unregisterHandler(o.EventNames.touchStart,t,a)}))},C.registerTouchRegion=function(e){Array.add(this._touchRegions,e),this._eventHandlerManager.initializeListForElement(o.EventNames.get_touchEvents(),e.target,0,Object(r.d)(this,this.onTouchEvent,"onTouchEvent"))},C.unregisterTouchRegion=function(e){Array.remove(this._touchRegions,e),this._eventHandlerManager.deinitializeListForElement(e.target,o.EventNames.get_touchEvents())},C.registerTouchAdapterWithPriority=function(e,t,n){var i=this.getRegisterEntry(e);i||(i=new l(e)),i.isEmpty()&&this.registerTouchRegion(i),i.addAdapter(n,t)},C.unregisterTouchAdapter=function(e,t){var n=this.getRegisterEntry(e);n&&(n.removeAdapter(t),n.isEmpty()&&this.unregisterTouchRegion(n))},C.getRegisterEntry=function(e){for(var t=0;t<this._touchRegions.length;t++)if(this._touchRegions[t].target===e)return this._touchRegions[t];return null},s.disposeInputManager=function(){h.a(s._instance)},s.logTouchStartIfNeeded=function(){var e=n(1).AFrameworkApplication;s._haveLoggedTouchStart||(v.ULS.sendTraceTag(42821152,324,15,"Touch input used in session"),e.theActionManager.processActionWithData(f.a.touchStart,2,null),s._haveLoggedTouchStart=!0)},s.logMultiTouchIfNeeded=function(){s._haveLoggedMultiTouch||(u.c(f.a.multiTouch),s._haveLoggedMultiTouch=!0)},s.isMultiTouch=function(e){var t=s.getTouchArrayFromEvent(e);return!!t&&t.length>1},s.isOneNoteInkingImprovementsEnabled=function(){return n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInkingImprovementsIsEnabled")&&s.isInInkingMode},s.isWebkitStyleTouchEvent=function(e){return!!s.getTouchArrayFromEvent(e)},s.getTouchArrayFromEvent=function(e){var t=e.rawEvent;return t?t.touches:null},y=s,S=[{key:"instance",get:function(){return s._instance||(s._instance=new s)}}],(b=null)&&_(y.prototype,b),S&&_(y,S),s}(a.a);y._haveLoggedTouchStart=!1,y._haveLoggedMultiTouch=!1,y.isInInkingMode=!1,y.touchAndHoldTimeThreshold=400,y.touchAndHoldDistanceThreshold=10,y._instance=null,y._touchPoints=void 0,Object(i.a)(y,"TouchInputManager",a.a,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(102),o=n(67),s=n(43),l=function(){};l.sessionIdString="sessionID",l.P1="p1",l.P2="p2",l.appMode="AppMode",l.appVersion="Version",l.isProd="isProd",l.isMac="isMac",l.isIPad="isIPad",l.flightId="FlightId",l.crash="Crash",l.featureName="FeatureName",l.featureData="FeatureData",l.error="Error",l.errorCode="ErrorCode",l.officeBrowserFeedbackComment="officeBrowserFeedbackComment",l.officeBrowserFeedbackContactInfoEmailInput="officeBrowserFeedbackContactInfoEmailInput",l.feedbackOverall="feedbackOverall",l.dismissHandler="DismissHandler",Object(i.a)(l,"CustomerFeedbackParams",null,[]);n(9);var c=n(17),u=n(68),d=function(){this.additionalVetos=null,this.additionalValues=null};Object(i.a)(d,"CustomBsqmQosEvent",null,[]);var p=function(){function e(){}return e.prototype.processBsqmQosError=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),Object.assign(new d,{additionalVetos:t||["NonDismissibleDialog"],additionalValues:n})},e}();Object(i.a)(p,"CustomRecordQosDialogError",null,[57]);var h=n(7),m=n(39),g=n(60),f=n(8),v=n(3),_=function(){function e(){}var t=e.prototype;return t.areReady=function(){return 32===n(1).AFrameworkApplication.theActionManager.processAction(f.a.giveFeedback,1)},t.waitForReady=function(e,t,i){var r=this;void 0===t&&(t=0),void 0===i&&(i=null),2!==n(1).AFrameworkApplication.theActionManager.processAction(f.a.giveFeedback,1)?e(this,null):t<20?g.a.instance.addTask(new m.a(2,1,500,(function(n){r.waitForReady(e,t+1,i)}),93)):i&&i()},t.invokeFeedbackHanlderAfterReady=function(e){this.waitForReady((function(t,i){n(1).AFrameworkApplication.theActionManager.processActionWithData(f.a.giveFeedback,2,e)}),0,(function(){v.ULS.sendTraceTag(20575889,201,10,"Feedback package is not available after timeout");var e=new(n(58).StandardDialog);e.buttonsOption=0,e.showError(s.a.feedbackPackageLoadFailed,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemInitialDialogDescription,null)}))},e}();Object(i.a)(_,"FeedbackDependencies",null,[]);var y=n(188);function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"StandardDialog",(function(){return S}));var S=function(e){var t,i;function a(t){var i;(i=e.call(this,t,!1,!!n(1).AFrameworkApplication.activeFrame&&n(1).AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled)||this)._downloadLinkFileName=null,i._showHelpLink=!1,i._showFeedbackPanel=!1,i._helpLinkText=null,i._feedbackUIParameters=null,i._helpContextID=null,i._showDownloadLink=!1,i._showMicrosoftLogo=!1,i._downloadLinkText=null,i._downloadLinkUrl=null,i._standardDialogHandler=null,i._helpFwlinkId=null,i._hideFeedbackDescription=!1,i._feedbackLinkText="Give feedback to Microsoft",i._feedbackDescriptionText="Your feedback helps Microsoft improve Office",i._errorText="Error",i._warningText="Warning",i._infoText="Information",i._questionText="Question",i._sessionInfoText="Session ID: {0}",i._showSaveErrorReportPanel=!1,i._saveErrorReportTitleText=null,i._saveErrorReportDescriptionText=null,i._privacyPolicyLinkText=null,i._privacyPolicyLinkClickHandler=null,i._additionalBodyTextContent=null,i._iconPanel=null,i._textElement=null,i._textPanel=null,i._checkboxPanel=null,i._contentRow=null,i._dontShowCheckBox=null,i._helpLink=null,i._feedbackLink=null,i._feedbackPanel=null,i._feedbackDescription=null,i._downloadLink=null,i._saveErrorReportPanel=null,i._saveErrorReportTitle=null,i._saveErrorReportDescription=null,i._privacyPolicyLink=null,i._showExtraLink=!1,i._extraLinkText=null,i._extraLinkUrl=null,i._extraLink=null,i._dontShowCheckboxChecked=!1,i._dialogIcon=0,i._customRecordQosDialogError=null,i.isDismissable=!1,i.dismissLabel="Don't show this dialog again.",i._isErrorDialog=!1,i.showSessionId=!1,i._notifyHandlersBeforeDismiss=!1,i._feedbackLinkClickHandler=Object(r.d)(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i),i.onFeedbackClickHandler,"onFeedbackClickHandler");try{i.dismissLabel=CommonUIStrings.l_DialogDoNotShow,i._feedbackLinkText=CommonUIStrings.l_ErrorDialogFeedbackLinkText,i._feedbackDescriptionText=CommonUIStrings.l_ErrorDialogFeedbackText,i._errorText=CommonUIStrings.l_DialogError,i._warningText=CommonUIStrings.l_DialogWarning,i._infoText=CommonUIStrings.l_DialogInfo,i._questionText=CommonUIStrings.l_DialogQuestion,i._sessionInfoText=CommonUIStrings.l_DialogSessionInfo}catch(e){v.ULS.sendTraceTag(39321886,207,10,"Failed to get CommonUIStrings. Exception: {0}",e)}return i}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var d,m,g,S=a.prototype;return S.dispose=function(){this._iconPanel=null,this._textElement=null,this._textPanel=null,this._checkboxPanel=null,this._dontShowCheckBox=null,this._contentRow=null,this._helpLink&&(c.a.removeHandler(this._helpLink,"click",Object(r.d)(this,this.onHelpClickHandler,"onHelpClickHandler")),this._helpLink=null),this._feedbackLink&&(c.a.removeHandler(this._feedbackLink,"click",this._feedbackLinkClickHandler),this._feedbackLink=null,this._feedbackDescription=null,this._feedbackPanel=null,this._showFeedbackPanel=!1,this._feedbackUIParameters=null),this._downloadLink&&(this._downloadLink=null,this._showDownloadLink=!1),this._privacyPolicyLink&&(c.a.removeHandler(this._privacyPolicyLink,"click",this._privacyPolicyLinkClickHandler),this._privacyPolicyLink=null,this._saveErrorReportDescription=null,this._saveErrorReportTitle=null,this._saveErrorReportPanel=null,this._showSaveErrorReportPanel=!1),e.prototype.dispose.call(this)},S.prepareDialog=function(){var t=n(94).Redirect;e.prototype.prepareDialog.call(this),this._contentRow=this._document.createElement("div"),this._contentRow.className=a._contentRowClass,this._body.appendChild(this._contentRow),this._iconPanel=this._document.createElement("div"),this._iconPanel.id=this.myId(a._iconPanelId),this._iconPanel.className=a._iconCssClass,this._contentRow.appendChild(this._iconPanel),this._textPanel=this._document.createElement("div"),this._textPanel.id=this.myId(a._textPanelId),this._textPanel.className=a._textPanelCssClass,this._contentRow.appendChild(this._textPanel),this._textElement=this._document.createElement("div"),this._textElement.id=this.myId(a._textId),this._textPanel.appendChild(this._textElement),this._showDownloadLink&&this.appendDownloadLink(),this._showHelpLink&&t.isHelpAvailable()&&this.appendHelpLink(),this._showFeedbackPanel&&this.appendFeedbackLinkPanel(),this.showSessionId&&this.appendSessionId(),this._showSaveErrorReportPanel&&this.appendSaveErrorReportPanel()},S.getAdditionalMessageIds=function(){return this._showSaveErrorReportPanel?String.format("{0} {1} {2}",a._saveErrorReportTitleId,a._saveErrorReportDescriptionId,a._privacyPolicyLinkId):""},S.useSimpleErrorDialog=function(){var e=n(86).UISurfaces;return this.isErrorDialog&&!o.a.get_instance().isCompleted(8)&&!e.isDialogAPILoaded()},S.messageBoxImpl=function(e,t,i,r,a,o,s){void 0===s&&(s=!1);var l=n(86).UISurfaces;if(this.dialogId=void 0===this.dialogId||null===this.dialogId?y.randomBetween(0,Number.MAX_VALUE).toString():this.dialogId,this._useReactDialog){if(null==o&&!this.useSimpleErrorDialog())return void this.reactMessageBoxImpl(e,t,i,r,a,s);this._useReactDialog=!1,l.getDialogAPIAsync().then((function(e){return e.dispose(),null}))}this.legacyMessageBoxImpl(e,t,i,r,a,o,s)},S.reactMessageBoxImpl=function(e,t,i,o,s,l){var c;void 0===l&&(l=!1),this._messageBoxHandler=Object(r.d)(this,this.baseDialogHandler,"baseDialogHandler"),this._standardDialogHandler=s;var u=((c={}).type="StandardDialogProps",c.id=this.dialogId,c.headerText=e,c.titleText=t,c.additionalBodyTextContent=this._additionalBodyTextContent,c.dialogIcon=this._dialogIcon,c.resultHandler=this._messageBoxHandler,c.messageAreaLink=this._showExtraLink?this.createReactLinkProps(a._extraLinkId):null,c.downloadLink=this._showDownloadLink?this.createReactLinkProps(a._downloadLinkId):null,c.helpLink=this._showHelpLink&&n(94).Redirect.isHelpAvailable()?this.createReactLinkProps(a._helpLinkId):null,c.feedbackDescription=this._showFeedbackPanel&&!this._hideFeedbackDescription?this._feedbackDescriptionText:null,c.feedbackLink=this._showFeedbackPanel?this.createReactLinkProps(a._feedbackLinkId):null,c.sessionId=this.showSessionId?String.format(this._sessionInfoText,n(1).AFrameworkApplication.userSessionId):null,c.permanentDismissCheckbox=this.isDismissable?this.createReactDismissCheckboxProps():null,c.saveErrorReportTitle=this._showSaveErrorReportPanel?this._saveErrorReportTitleText:null,c.saveErrorReportDescription=this._showSaveErrorReportPanel?this._saveErrorReportDescriptionText:null,c.privacyPolicyLink=this._showSaveErrorReportPanel?this.createReactLinkProps(a._privacyPolicyLinkId):null,c.renderMicrosoftLogoInHeader=this._showMicrosoftLogo,c);l?this.update(u):this.show(u)},S.legacyMessageBoxImpl=function(e,t,i,o,s,l,c){void 0===c&&(c=!1);var u=n(55).createClusteredImage;if(this.prepareDialog(),this._messageBoxHandler=Object(r.d)(this,this.baseDialogHandler,"baseDialogHandler"),this._standardDialogHandler=s,t||null!=l||(t=" "),t){if(this._textElement.innerText=t,this._showExtraLink&&(this._extraLink=this._document.createElement("a"),this._extraLink.href=this._extraLinkUrl,this._extraLink.id=a._extraLinkId,this._extraLink.innerText=this._extraLinkText,this._extraLink.target="_blank",this._textElement.appendChild(this._document.createTextNode(" ")),this._textElement.appendChild(this._extraLink)),t.trim().length>0){var d=this._textElement.id,p=this.getAdditionalMessageIds();p&&p.length>0&&(d=String.format("{0} {1}",d,p)),this.setDescribedByForDialog(d)}}else this._textElement.appendChild(l);i?this._iconPanel.appendChild(u(32,32,i,null,!0,o)):this._contentRow.removeChild(this._iconPanel),this._bodyPanel.style.maxWidth="375px",this._divMessageBox.style.display="Block",this.isDismissable&&this.setupCheckBoxPanel(),this._titleText.innerText=e,c?this.update():this.show()},S.showWarning=function(e,t,n){this.messageBox(e,t,1,n)},S.showError=function(e,t,i,r,o,s,c){var d=n(1).AFrameworkApplication;d.appSettingsManager.getBooleanAppSetting("ShowSessionIdOnError")&&(this.showSessionId=!0),v.ULS.sendTraceTag(38111394,207,50,"Show error dialog. ErrorType: {0}",e),this._customRecordQosDialogError=new p,o||d.reportError(e,this._customRecordQosDialogError),this.shouldShowFeedbackLinkForError(e)&&d.activeFrame&&u.a.instance.tryInitializePackage(a._customerFeedbackPackageName)&&(this._feedbackUIParameters={},this._feedbackUIParameters[l.error]=!0,this._feedbackUIParameters[l.crash]=a.isCrashingErrorCode(e),this._feedbackUIParameters[l.errorCode]=e,this._showFeedbackPanel=!0);var h=s?1:2;this._hideFeedbackDescription=c,this.isErrorDialog=!0,d.appSettingsManager.getBooleanAppSetting("IsBetterErrorHandlingEnabled")||d.appSettingsManager.getBooleanAppSetting("IsCrashDialogImprovementEnabled")?this.messageBox(t,i,0,r):this.messageBox(t,i,h,r)},S.showInformation=function(e,t,n){this.messageBox(e,t,3,n)},S.showQuestion=function(e,t,n){this.messageBox(e,t,4,n)},S.messageBox=function(e,t,n,i,r){this._dialogIcon=n;var o=null,s=null;switch(n){case 2:o=a._errorIconName,s=this._errorText;break;case 1:o=a._warningIconName,s=this._warningText;break;case 3:o=a._infoIconName,s=this._infoText;break;case 4:o=a._questionIconName,s=this._questionText;break;case 0:break;default:0}this.messageBoxImpl(e,t,o,s,i,r)},S.addHelpLink=function(e,t,n){void 0===n&&(n=null),this._showHelpLink=!0,this._helpLinkText=e,this._helpContextID=t,this._helpFwlinkId=n},S.addDownloadLink=function(e,t,n){void 0===n&&(n=null),this._showDownloadLink=!0,this._downloadLinkText=e,this._downloadLinkUrl=t,this._downloadLinkFileName=n},S.addExtraLink=function(e,t){this._showExtraLink=!0,this._extraLinkText=e,this._extraLinkUrl=t},S.addFeedbackLink=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!0),this._showFeedbackPanel=!0,this._feedbackLinkText=e,this._feedbackLinkClickHandler=t||this._feedbackLinkClickHandler,this._hideFeedbackDescription=n},S.addAdditionalTextBodyContent=function(e,t){void 0===t&&(t=null),this._additionalBodyTextContent={},this._additionalBodyTextContent.textContent=e,this._additionalBodyTextContent.links=t},S.addSaveErrorReportPanel=function(e,t,n,i){this._showSaveErrorReportPanel=!0,this._saveErrorReportTitleText=e,this._saveErrorReportDescriptionText=t,this._privacyPolicyLinkText=n,this._privacyPolicyLinkClickHandler=i},S.baseDialogHandler=function(e){var t=!1;this.isDismissable&&(t=this._useReactDialog?this._dontShowCheckboxChecked:this._dontShowCheckBox.checked),this.notifyHandlersBeforeDismiss||this._hideOnButtonClick&&this.hide(),this._standardDialogHandler&&this._standardDialogHandler(e,t),this.notifyHandlersBeforeDismiss&&this._hideOnButtonClick&&this.hide(),this._hideOnButtonClick&&(this._standardDialogHandler=null)},S.onHelpClickHandler=function(e){var t=n(94).Redirect;this._helpFwlinkId?t.toFwlink(this._helpFwlinkId):t.showHelp(this._helpContextID)},S.onFeedbackClickHandler=function(e){var t=n(1).AFrameworkApplication;this._useReactDialog&&this.hidePreservingMessageBoxElement(),this._feedbackUIParameters||(this._feedbackUIParameters={}),this._feedbackUIParameters[l.dismissHandler]=Object(r.d)(this,this.onFeedbackUIClosed,"onFeedbackUIClosed"),t.appSettingsManager.getBooleanAppSetting("FeedbackDelayLoadHandlerEnabled")?(new _).invokeFeedbackHanlderAfterReady(this._feedbackUIParameters):t.theActionManager.processActionWithData(f.a.giveFeedback,2,this._feedbackUIParameters)},S.onFeedbackUIClosed=function(){this._useReactDialog&&this.show(this._dialogValues)},S.setupCheckBoxPanel=function(){var e=this.myId(a._checkboxPanelId),t=this.myId(a._checkboxId),n=this.myId(a._doNotShowLabelId);this._checkboxPanel=this._document.createElement("div"),this._checkboxPanel.id=e,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._checkboxPanel);var i=this._document.createElement("div");i.className=a._dontShowCheckboxDivClass,this._checkboxPanel.appendChild(i),this._dontShowCheckBox=this._document.createElement("input"),this._dontShowCheckBox.type="checkbox",this._dontShowCheckBox.id=t,h.a.setAriaAttribute(this._dontShowCheckBox,h.a.ariaLabelledByAttribute,n),i.appendChild(this._dontShowCheckBox);var r=this._document.createElement("div");r.className=a._dontShowLabelDivClass,this._checkboxPanel.appendChild(r);var o=this._document.createElement("label");o.innerText=this.dismissLabel,o.id=n,o.setAttribute("for",t),r.appendChild(o)},S.shouldShowFeedbackLinkForError=function(e){var t=n(1).AFrameworkApplication;return t.showFeedbackButton&&(a.isCrashingErrorCode(e)&&t.appSettingsManager.getBooleanAppSetting("ShowFeedbackLinkOnCrashDialog")||!a.isCrashingErrorCode(e)&&t.appSettingsManager.getBooleanAppSetting("ShowFeedbackLinkOnErrorDialog"))},S.createReactLinkProps=function(e){var t,n=null,i=null,o=null;switch(e){case a._extraLinkId:var s;n=this._extraLinkText,(s={}).href=this._extraLinkUrl,s.target="_blank",i=s;break;case a._downloadLinkId:var l;if(n=this._downloadLinkText,(l={}).href=this._downloadLinkUrl,i=l,this._downloadLinkFileName){var c=this._downloadLinkFileName.trim();c.length>0&&(i.download=c)}break;case a._helpLinkId:n=this._helpLinkText,o=Object(r.d)(this,this.onHelpClickHandler,"onHelpClickHandler");break;case a._feedbackLinkId:n=this._feedbackLinkText,o=this._feedbackLinkClickHandler;break;case a._privacyPolicyLinkId:n=this._privacyPolicyLinkText,o=this._privacyPolicyLinkClickHandler;break;default:return null}return(t={}).type="AppLinkProps",t.id=e,t.text=n,t.handler=i||o,t},S.createReactDismissCheckboxProps=function(){var e,t=Object(r.d)(this,this.onCheckboxExecute,"onCheckboxExecute");return(e={}).type="AppCheckboxProps",e.id=a._checkboxId,e.label=this.dismissLabel,e.onExecute=t,e},S.onCheckboxExecute=function(e){this._dontShowCheckboxChecked=e.checked||!this._dontShowCheckboxChecked},S.appendDownloadLink=function(){this._downloadLink=this._document.createElement("a"),this._downloadLink.href=this._downloadLinkUrl,this._downloadLink.id=a._downloadLinkId,this._downloadLink.innerText=this._downloadLinkText,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._downloadLink),this._textPanel.appendChild(this._document.createElement("br"))},S.appendHelpLink=function(){this._helpLink=this._document.createElement("a"),this._helpLink.href="#",this._helpLink.id=a._helpLinkId,this._helpLink.innerText=this._helpLinkText,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._helpLink),c.a.addHandler(this._helpLink,"click",Object(r.d)(this,this.onHelpClickHandler,"onHelpClickHandler"))},S.appendSessionId=function(){var e=n(1).AFrameworkApplication,t=this._document.createElement("span");t.className="Selectable",t.innerText=String.format(this._sessionInfoText,e.userSessionId),t.id=a._sessionInfoId,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(t)},S.appendFeedbackLinkPanel=function(){this._feedbackPanel=this._document.createElement("div"),this._feedbackPanel.id=a._feedbackPanelId,this._feedbackLink=this._document.createElement("a"),this._feedbackLink.href="#",this._feedbackLink.id=a._feedbackLinkId,this._feedbackLink.innerText=this._feedbackLinkText,c.a.addHandler(this._feedbackLink,"click",this._feedbackLinkClickHandler),this._hideFeedbackDescription||(this._feedbackDescription=this._document.createElement("span"),this._feedbackDescription.id=a._feedbackDescriptionId,this._feedbackDescription.innerText=this._feedbackDescriptionText,this._feedbackPanel.appendChild(this._feedbackDescription),this._feedbackPanel.appendChild(this._document.createTextNode(" "))),this._feedbackPanel.appendChild(this._feedbackLink),this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._feedbackPanel)},S.appendSaveErrorReportPanel=function(){var e=n(1).AFrameworkApplication;this._saveErrorReportPanel=this._document.createElement("div"),this._saveErrorReportPanel.id=a._saveErrorReportPanelId,this._saveErrorReportPanel.appendChild(this._document.createElement("br")),this._saveErrorReportTitle=this._document.createElement("div"),this._saveErrorReportTitle.id=this.myId(a._saveErrorReportTitleId),this._saveErrorReportTitle.innerText=this._saveErrorReportTitleText,this._saveErrorReportTitle.style.fontWeight="bold",this._saveErrorReportPanel.appendChild(this._saveErrorReportTitle),this._saveErrorReportDescription=this._document.createElement("div"),this._saveErrorReportDescription.id=this.myId(a._saveErrorReportDescriptionId),this._saveErrorReportDescription.innerText=this._saveErrorReportDescriptionText,this._saveErrorReportPanel.appendChild(this._saveErrorReportDescription),e.privacyUrl&&(this._saveErrorReportPanel.appendChild(this._document.createElement("br")),this._privacyPolicyLink=this._document.createElement("a"),this._privacyPolicyLink.id=this.myId(a._privacyPolicyLinkId),this._privacyPolicyLink.href="#",this._privacyPolicyLink.innerText=this._privacyPolicyLinkText,this._saveErrorReportPanel.appendChild(this._privacyPolicyLink),c.a.addHandler(this._privacyPolicyLink,"click",this._privacyPolicyLinkClickHandler)),this._textPanel.appendChild(this._saveErrorReportPanel)},a.isCrashingErrorCode=function(e){return e===s.a.unhandledError||e===s.a.applicationCrashed},d=a,(m=[{key:"isErrorDialog",get:function(){return this._isErrorDialog},set:function(e){this._isErrorDialog=e}},{key:"showMicrosoftLogo",get:function(){return this._showMicrosoftLogo},set:function(e){this._showMicrosoftLogo=e}},{key:"notifyHandlersBeforeDismiss",get:function(){return this._notifyHandlersBeforeDismiss},set:function(e){this._notifyHandlersBeforeDismiss=e}}])&&b(d.prototype,m),g&&b(d,g),a}(a.a);S._iconId="WACDialogIcon",S._iconCssClass="WACDialogIcon",S._textPanelId="WACDialogTextPanel",S._textPanelCssClass="WACDialogTextPanel",S._textId="WACDialogText",S._checkboxPanelId="WACDialogDontShowPanel",S._checkboxId="WACDialogDontShow",S._dontShowCheckboxDivClass="WACDialogDontShowCheckboxDiv",S._dontShowLabelDivClass="WACDialogDontShowLabelDiv",S._doNotShowLabelId="WACDialogDontShowLabelText",S._iconPanelId="WACDialogIconPanel",S._helpLinkId="WACDialogHelpLink",S._feedbackPanelId="WACDialogFeedbackPanel",S._feedbackLinkId="WACDialogFeedbackLink",S._feedbackDescriptionId="WACDialogFeedbackDescription",S._downloadLinkId="WACDialogDownloadLink",S._extraLinkId="WACDialogExtraLink",S._contentRowClass="WACDialogRow",S._sessionInfoId="WACDialogSessionInfo",S._saveErrorReportPanelId="WACDialogSaveErrorReportPanel",S._saveErrorReportTitleId="WACSaveErrorReportTitle",S._saveErrorReportDescriptionId="WACSaveErrorReportDescription",S._privacyPolicyLinkId="WACSaveErrorReportPrivacy",S._errorIconName="CancelRequest_32x32x32",S._warningIconName="Risks_32x32x32",S._infoIconName="Info_32x32x32",S._questionIconName="OfficeAssistant_32x32x32",S._customerFeedbackPackageName="Common.App.CustomerFeedback",Object(i.a)(S,"StandardDialog",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}return e.fromPropertyDefinition=function(e){return e.type},e.definePropertyType=function(e,t){return e|t<<16},e.getStorageType=function(e){return e>>>16},e.isStringType=function(t){return t===e.string||t===e.byteArray},e.isSimpleType=function(t){return t===e.uInt_8||t===e.uInt_16||t===e.uInt_32||t===e.int_8||t===e.int_16||t===e.int_32||t===e.float_32||t===e.float_64||t===e.oneByte||t===e.twoBytes||t===e.fourBytes||t===e.eightBytes||t===e.guid||t===e.objectId||t===e.objectSpaceId||t===e.contextId||t===e.extendedGuid},e.isDateTimeType=function(t){return t===e.dateTime_32||t===e.dateTime_64},e.isBoolType=function(t){return t===e.bool},e.isArrayOfPrimitiveType=function(t){return t===e.arrayOfUInt_16s||t===e.arrayOfUInt_32s||t===e.arrayOfFloat_32s},e.isArrayOfObjectSpaceType=function(t){return t===e.arrayOfObjectIds||t===e.arrayOfObjectSpaceIds||t===e.arrayOfContextIds},e.isArrayOfBools=function(t){return t===e.arrayOfBools},e.isArrayOfPropertySets=function(t){return t===e.arrayOfPropertySets},e.isArrayOfPropertyValues=function(t){return t===e.arrayOfPropertyValues},e.isArrayOfStrings=function(t){return t===e.arrayOfStrings},e.isArrayOfGuids=function(t){return t===e.arrayOfGuids},e.isArrayOfExtendedGuids=function(t){return t===e.arrayOfExtendedGuids},e.isArrayOfDateTimes=function(t){return t===e.arrayOfDateTime_64s},e.isPropertySetType=function(t){return t===e.propertySet},e.isNullAllowedForPropertyType=function(t){return!(e.isSimpleType(t)||e.isDateTimeType(t)||e.isArrayOfPrimitiveType(t)||e.isArrayOfObjectSpaceType(t)||e.isArrayOfBools(t)||e.isArrayOfPropertyValues(t))},e}();r.nil=r.definePropertyType(0,0),r.noData=r.definePropertyType(1,1),r.bool=r.definePropertyType(2,2),r.oneByte=r.definePropertyType(3,3),r.twoBytes=r.definePropertyType(4,4),r.fourBytes=r.definePropertyType(5,5),r.eightBytes=r.definePropertyType(6,6),r.byteArray=r.definePropertyType(7,7),r.objectId=r.definePropertyType(8,8),r.arrayOfObjectIds=r.definePropertyType(9,9),r.objectSpaceId=r.definePropertyType(10,10),r.arrayOfObjectSpaceIds=r.definePropertyType(11,11),r.contextId=r.definePropertyType(12,12),r.arrayOfContextIds=r.definePropertyType(13,13),r.reserved14=r.definePropertyType(14,14),r.reserved15=r.definePropertyType(15,15),r.arrayOfPropertyValues=r.definePropertyType(16,16),r.propertySet=r.definePropertyType(17,17),r.iUnknown=r.definePropertyType(18,18),r.iUnknownInPropertySet=r.definePropertyType(19,19),r.reserved20=r.definePropertyType(20,20),r.reserved21=r.definePropertyType(21,21),r.reserved22=r.definePropertyType(22,22),r.reserved23=r.definePropertyType(23,23),r.reserved24=r.definePropertyType(24,24),r.reserved25=r.definePropertyType(25,25),r.reserved26=r.definePropertyType(26,26),r.reserved27=r.definePropertyType(27,27),r.reserved28=r.definePropertyType(28,28),r.reserved29=r.definePropertyType(29,29),r.reserved30=r.definePropertyType(30,30),r.conflict=r.definePropertyType(31,31),r.int_8=r.definePropertyType(32,3),r.int_16=r.definePropertyType(33,4),r.int_32=r.definePropertyType(34,5),r.uInt_8=r.definePropertyType(36,3),r.uInt_16=r.definePropertyType(37,4),r.uInt_32=r.definePropertyType(38,5),r.float_32=r.definePropertyType(40,5),r.float_64=r.definePropertyType(41,6),r.arrayOfUInt_16s=r.definePropertyType(47,7),r.arrayOfUInt_32s=r.definePropertyType(48,7),r.arrayOfFloat_32s=r.definePropertyType(50,7),r.sz=r.definePropertyType(54,7),r.string=r.definePropertyType(58,7),r.wt=r.definePropertyType(59,7),r.arrayOfStrings=r.definePropertyType(61,7),r.arrayOfBools=r.definePropertyType(62,7),r.guid=r.definePropertyType(63,7),r.arrayOfGuids=r.definePropertyType(64,7),r.pointer=r.definePropertyType(65,6),r.dateTime_64=r.definePropertyType(67,6),r.arrayOfDateTime_64s=r.definePropertyType(68,7),r.color=r.definePropertyType(71,5),r.dateTime_32=r.definePropertyType(75,5),r.arrayOfPropertySets=r.definePropertyType(78,7),r.extendedGuid=r.definePropertyType(79,7),r.arrayOfExtendedGuids=r.definePropertyType(80,7),Object(i.a)(r,"PropertyType",null,[])},function(e,t,n){"use strict";var i=n(0);n(9),n(54);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){}var t,n,i,a=e.prototype;return a.addTask=function(e){0},a.deleteTask=function(e){0},a.pause=function(){0},a.delayTasks=function(e){0},a.pauseForAnimation=function(e){0},a.resume=function(){0},a.yield=function(e){0},a.stop=function(){0},a.restart=function(){0},a.addAggregator=function(e,t){0},a.resetInterval=function(e,t){0},a.removeTasks=function(e){0},a.startToCollectTaskDetails=function(){},a.getDiagnosticStateForLogging=function(){return{}},t=e,(n=[{key:"isYielding",get:function(){return!1}},{key:"isRunning",get:function(){return!1}},{key:"isCallbackRunning",get:function(){return!1},set:function(e){}},{key:"hasStopped",get:function(){return!1}},{key:"timeToWaitAfterLastKeyStroke",get:function(){return 0},set:function(e){}},{key:"runningTaskItemID",get:function(){return null}},{key:"yieldResponseOperation",get:function(){return null}},{key:"pendingTaskCount",get:function(){return 0}},{key:"maximumTimeOfOneCpuWakeUp",get:function(){return 0},set:function(e){}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"NoOpTaskManager",null,[43]);var o=n(2),s=n(11),l=n(49),c=n(224),u=n(16);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(){function e(){}var t,i,r,a=e.prototype;return a.getTimeStamp=function(){return u.a.getTickCount()},a.isOnIdleTasksEnabled=function(){var t=n(1).AFrameworkApplication;return null==e._isOnIdleTasksEnabled&&(e._isOnIdleTasksEnabled=!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("TaskManagerOnIdleTasksEnabled")&&!u.a.requestIdleCallbackExists()),e._isOnIdleTasksEnabled},a.getDefaultTaskAcceptableTickRange=function(e){var t=e.interval;return t<=1e3?0:t<=5e3?Math.floor(t/2):2500},t=e,r=[{key:"defaultUtils",get:function(){return e._defaultInstance=e._defaultInstance?e._defaultInstance:new e,e._defaultInstance}}],(i=null)&&d(t.prototype,i),r&&d(t,r),e}();p._defaultInstance=null,p._isOnIdleTasksEnabled=null,Object(i.a)(p,"TaskManagerUtils",null,[62]);var h=n(3),m=n(323);function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(){function e(t,n,i){this._disposed=!1,this._isProcessing=!1,this._processingQueue=0,this._eventSource=new l.a,this._queues=[[],[],[],[],[],[],[]],this._lastProcessedTasks=[-1,-1,-1,-1,-1,-1,-1],this._pendingDeletes=!1,this._pausedSince=null,this._yieldingSince=null,this._stoppedSince=null,this._disposedSince=null,this._callbackRunningSince=null,this._timerSetAt=null,this._timerSetSince=null,this._processingSince=null,this._runningSince=null,this._timerLength=0,this._isRunning=!1,this._isCallbackRunning=!1,this._timerId=0,this._requestIdleCallbackId=0,this._startToCollectTaskDetails=!1,this._isYielding=!1,this._yieldOperation=null,this._hasStopped=!1,this._runningTaskDescription=null,this._runningTaskItemID=null,this._yieldResponseOperation=null,this._pauseRef=0,this._resumeTasksTimeoutId=-1,this._componentDependencies=null,this._cpuMeter=t,this._keyInputManager=n,this._taskManagerUtils=i,this._timerSet=!1,this._processDelegate=Object(o.d)(this,this.process,"process"),this._taskAggregators=new m.a,this.maximumTimeOfOneCpuWakeUp=50,this._timeToWaitAfterLastKeyStroke=250,e.keepOriginalWindowFunc()}var t,i,r,a=e.prototype;return a.dispose=function(){this._disposed=!0,this._disposedSince=new Date,this._queues=[[],[],[],[],[],[],[]],this.updateNextWakeUpIfNecessary()},a.addTask=function(e){if(this._disposed){var t;h.ULS.sendTraceTag(7078544,218,15,"TaskManager: Not adding task as it has been disposed. {0}",((t={}).Id=e.taskItemId,t.Name=e.name,t))}else{if(!(e.isDeleted&&Array.indexOf(this._queues[e.priority],e)>=0)){var n=e.priority;this._taskManagerUtils.isOnIdleTasksEnabled()||5!==e.priority||(n=4),Array.add(this._queues[n],e)}var i;if(e.onEnqueue(this._taskManagerUtils),this.hasStopped)h.ULS.sendTraceTag(7078545,218,50,"TaskManager: Added task when TaskManager is stopped. {0}",((i={}).Id=e.taskItemId,i));this.updateNextWakeUpIfNecessary(),this._startToCollectTaskDetails&&this._cpuMeter.onTaskAdded(e)}},a.deleteTask=function(e){if(!this._disposed)if(e.isDeleted=!0,this._isProcessing&&this._processingQueue===e.priority)this._pendingDeletes=!0;else{var t=Array.indexOf(this._queues[e.priority],e);t>-1&&(t<=this._lastProcessedTasks[e.priority]&&this._lastProcessedTasks[e.priority]--,Array.removeAt(this._queues[e.priority],t)),this.updateNextWakeUpIfNecessary()}},a.process=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){this._timerSet=!1,this._timerSetAt=null,this._timerSetSince=null;var t=this._taskManagerUtils.getTimeStamp();if(this.canProcessTasks()){var n=this.maximumTimeOfOneCpuWakeUp,i=t-this.lastUserKeystrokeTimestamp()<this.timeToWaitAfterLastKeyStroke,r=this._queues[0].length>0;if(!i||r){this._cpuMeter.onBeforeProcess(),this._isProcessing=!0,this._processingSince||(this._processingSince=new Date);var a=e.numQueues-1;i&&r&&(a=0);for(var o=0;o<=a&&n>0;o++)5!==o&&(this._taskManagerUtils.isOnIdleTasksEnabled()&&4===o&&(n=this.processQueueTasks(5,!0,t,n),this.cleanupQueuePendingDeletedTasks(5)),n>0&&(n=this.processQueueTasks(o,!1,t,n),this.cleanupQueuePendingDeletedTasks(o)));this._isProcessing=!1,this._processingSince=null,this._cpuMeter.onAfterProcess()}this.updateNextWakeUpIfNecessary()}})),a.processOnIdleTasks=function(e){if(this._taskManagerUtils.isOnIdleTasksEnabled()&&(this._requestIdleCallbackId=0,this.canProcessTasks()))if(this._isProcessing)this.requestIdleCallback();else{0;var t=this._taskManagerUtils.getTimeStamp();this._cpuMeter.onBeforeProcess(),this._isProcessing=!0,this._processingSince||(this._processingSince=new Date),this._processingQueue=5,this.processQueueTasks(this._processingQueue,!1,t,e),this._isProcessing=!1,this._processingQueue=-1,this._processingSince=null,this._cpuMeter.onAfterProcess(),this.updateNextWakeUpIfNecessary()}},a.requestIdleCallback=function(){var t=this;this._taskManagerUtils.isOnIdleTasksEnabled()&&(this._requestIdleCallbackId||(this._requestIdleCallbackId=e._originalRequestIdleCallback((function(e){t.processOnIdleTasks(e.timeRemaining())}),null)))},a.cancelIdleCallbackIfScheduled=function(){this._taskManagerUtils.isOnIdleTasksEnabled()&&this._requestIdleCallbackId>0&&(e._originalCancelIdleCallback(this._requestIdleCallbackId),this._requestIdleCallbackId=0)},a.callProcessTask=function(e){this._isRunning=!0,this._runningSince||(this._runningSince=new Date);try{this._runningTaskItemID=e.taskItemId,this._cpuMeter.profileTopLevelTask(Object(o.d)(e,e.process,"process"),e.loggingName,Math.round(e.lastDelayTick),e)}finally{this._runningTaskItemID=null,this._isRunning=!1,this._runningSince=null}},a.shouldTaskBeExecuted=function(e,t,n){return!(!e||e.isDeleted)&&(n?e.shouldOnIdleTaskBePromoted(t):t+e.acceptableTickRange>e.nextIntervalTime)},a.lastUserKeystrokeTimestamp=function(){return this._keyInputManager&&this._keyInputManager.lastKeyStroke?this._keyInputManager.lastKeyStrokeTimestamp:0},a.processQueueTasks=function(e,t,n,i){var r=this._queues[e].length;if(!r)return i;this._processingQueue=e;var a=this._queues[e],o=this._lastProcessedTasks[e],s=r;do{var l=a[o=(o+=1)>=r?0:o];if(this.shouldTaskBeExecuted(l,n,t)){new Date;var c=this._taskManagerUtils.getTimeStamp();2!==l.taskType&&(Array.removeAt(a,o),r--,o--),this.callProcessTask(l);var u=this._taskManagerUtils.getTimeStamp()-c;i-=u,this.updateAggregator(l.taskItemId,Math.round(u))}s--}while(r>0&&s>0&&i>0);return this._lastProcessedTasks[e]=o,this._processingQueue=-1,i},a.cleanupQueuePendingDeletedTasks=function(e){if(this._pendingDeletes){for(var t=this._lastProcessedTasks[e],n=this._queues[e],i=0;i<n.length;i++){n[i].isDeleted&&(Array.removeAt(n,i),i<=t&&t--,i--)}this._pendingDeletes=!1,this._lastProcessedTasks[e]=t}},a.pause=function(){this.pauseRef||(this._pausedSince=new Date),this._pauseRef=this.pauseRef+1,this.updateNextWakeUpIfNecessary()},a.delayTasks=function(t){-1===this.resumeTasksTimeoutId?this.pause():e._originalClearTimeout(this.resumeTasksTimeoutId),this._resumeTasksTimeoutId=e._originalSetTimeout(Object(o.d)(this,this.delayEnableTasks,"delayEnableTasks"),t)},a.delayEnableTasks=function(){this._resumeTasksTimeoutId=-1,this.resume()},a.pauseForAnimation=function(t){this.pause(),e._originalSetTimeout(Object(o.d)(this,this.afterAnimationPause,"afterAnimationPause"),t)},a.afterAnimationPause=function(){this.resume()},a.resume=function(){this._pauseRef=this.pauseRef-1,this.pauseRef<0&&(this._pauseRef=0),this.pauseRef||(this._pausedSince=null),this.updateNextWakeUpIfNecessary()},a.yield=function(t){this.isYielding&&h.ULS.sendTraceTag(7078546,218,15,"TaskManager: Yield was called when already yielding"),this._isYielding=!0,this._yieldingSince||(this._yieldingSince=new Date),this._yieldOperation=t,e._originalSetTimeout(Object(o.d)(this,this.yieldResponse,"yieldResponse"),0),this.updateNextWakeUpIfNecessary()},a.isCurrentlyDeactivated=function(){return this.isYielding||this.hasStopped||this._disposed||this.pauseRef>0},a.canProcessTasks=function(){return!this.isCurrentlyDeactivated()},a.yieldResponse=function(){this._isRunning=!0,this._runningSince||(this._runningSince=new Date),this._yieldResponseOperation=this.yieldOperation;var e=this.yieldOperation;this._yieldOperation=null,this._isYielding=!1,this._yieldingSince=null;try{if(e){var t=e.operationName?"128_"+e.operationName:"128";this._cpuMeter.profileTopLevelTask(Object(o.d)(e,e.run,"run"),t,+new Date-+e.startTime)}}finally{0,this._yieldResponseOperation=null,this._isRunning=!1,this._runningSince=null}this.updateNextWakeUpIfNecessary()},a.stop=function(){this._hasStopped=!0,this._stoppedSince||(this._stoppedSince=new Date),this.updateNextWakeUpIfNecessary()},a.restart=function(){this.hasStopped&&!this._disposed&&(this._hasStopped=!1,this._stoppedSince=null,this.updateNextWakeUpIfNecessary())},a.resetInterval=function(e,t,n){var i,r=this._queues[e.priority],a=Array.indexOf(r,e);-1!==a?(r[a].interval=t,r[a].acceptableTickRange=n,r[a].onEnqueue(this._taskManagerUtils),this.updateNextWakeUpIfNecessary()):h.ULS.sendTraceTag(7078547,218,15,"TaskManager: Can't reset interval for task because it's not present in the taskmanager. {0}",((i={}).Id=e.taskItemId,i))},a.addAggregator=function(e,t){this._taskAggregators.set_item(e,t)},a.removeTasks=function(e){for(var t=0;t<this._queues.length;t++)for(var n=this._queues[t],i=n.length-1;i>=0;i--){var r=n[i];e(r)&&this.deleteTask(r)}},a.startToCollectTaskDetails=function(){this._startToCollectTaskDetails=!0},a.updateAggregator=function(e,t){var n,i=e.toString();this._taskAggregators.tryGetValue(e,Object(s.a)((function(){return n}),(function(e){return n=e})))&&n.track(t,i)},a.updateNextWakeUpIfNecessary=function(){if(!this._isProcessing&&!this._isRunning){if(this.isCurrentlyDeactivated())return this.clearTimeoutInternalIfSet(),void this.cancelIdleCallbackIfScheduled();var t=this.lastUserKeystrokeTimestamp(),n=this._taskManagerUtils.getTimeStamp(),i=-1,r=-1,a=!1,o=!1,s=!1;0;for(var l=0;l<e.numQueues;l++)for(var c=0;c<this._queues[l].length;c++){var u=this._queues[l][c];if(!u||u.isDeleted)Array.removeAt(this._queues[l],c),c--;else{var d=u.nextIntervalTime-n;if(this._taskManagerUtils.isOnIdleTasksEnabled()&&5===u.priority&&!u.shouldOnIdleTaskBePromoted(n)){s=s||d<10;continue}(!a||d<i)&&(i=d,a=!0),u.priority||(!o||d<r)&&(r=d,o=!0)}}if(s?this.requestIdleCallback():this.cancelIdleCallbackIfScheduled(),a){var p=t+this.timeToWaitAfterLastKeyStroke-n;i<p&&(i=p),o&&i>r&&(i=r),i<0&&(i=0),i<10&&(i=0),this.clearTimeoutInternalIfSet();var h=Math.round(i);this._timerId=e._originalSetTimeout(this._processDelegate,h),this._timerSet=!0;var m=new Date;this._timerSetSince||(this._timerSetSince=m),this._timerSetAt=m,this._timerLength=h}else this.clearTimeoutInternalIfSet()}},a.clearTimeoutInternalIfSet=function(){this._timerSet&&(e._originalClearTimeout(this._timerId),this._timerSet=!1,this._timerSetSince=null,this._timerLength=-1)},a.getQueueLength=function(e){return this._queues[e].length},a.getDiagnosticStateForLogging=function(){var e={};this.pauseRef>0&&(e.PA=1,this._pausedSince&&(e.PAS=this._pausedSince.toISOString())),this.isYielding&&(e.Y=1,this._yieldingSince&&(e.YS=this._yieldingSince.toISOString())),this.hasStopped&&(e.S=1,this._stoppedSince&&(e.SS=this._stoppedSince.toISOString())),this._disposed&&(e.D=1,this._disposedSince&&(e.DS=this._disposedSince.toISOString())),this._isProcessing&&(e.PR=1,this._processingSince&&(e.PRS=this._processingSince.toISOString())),this._isRunning&&(e.R=1,this._runningSince&&(e.RS=this._runningSince.toISOString())),this._timerSet&&(e.TS=1,this._timerSetSince&&(e.TSS=this._timerSetSince.toISOString()),this._timerSetAt&&(e.TSA=this._timerSetAt.toISOString()),e.TI=this._timerId,e.TL=this._timerLength),this._isCallbackRunning&&(e.ICR=1,this._callbackRunningSince&&(e.ICRS=this._callbackRunningSince.toISOString()));for(var t={},n=0;n<this._queues.length;n++){var i=this._queues[n];i&&(t["Q"+n]=i.length)}return e.Q=t,null!=this.runningTaskItemID&&(e.RTID=this.runningTaskItemID),e},e.createTaskManagerImpl=function(){var t=n(20).KeyInputManager;return new e(c.a.instance,t.instance,p.defaultUtils)},e.keepOriginalWindowFunc=function(){if(!e._isOriginalWindowFuncSet){var t=window.setTimeout,n=window.clearTimeout;if(e._originalSetTimeout=function(e,n){return t(e,n)},e._originalClearTimeout=function(e){n(e)},p.defaultUtils.isOnIdleTasksEnabled()){var i=window.requestIdleCallback,r=window.cancelIdleCallback;e._originalRequestIdleCallback=function(e,t){return i(e,t)},e._originalCancelIdleCallback=function(e){r(e)}}e._isOriginalWindowFuncSet=!0}},t=e,(i=[{key:"isYielding",get:function(){return this._isYielding}},{key:"yieldOperation",get:function(){return this._yieldOperation}},{key:"isRunning",get:function(){return this._isRunning||this._isCallbackRunning}},{key:"isCallbackRunning",get:function(){return this._isCallbackRunning},set:function(e){this._isCallbackRunning=e,!this._callbackRunningSince&&e?this._callbackRunningSince=new Date:e||(this._callbackRunningSince=null)}},{key:"hasStopped",get:function(){return this._hasStopped}},{key:"timeToWaitAfterLastKeyStroke",get:function(){return this._timeToWaitAfterLastKeyStroke},set:function(e){this._timeToWaitAfterLastKeyStroke=e}},{key:"runningTaskItemID",get:function(){return this._runningTaskItemID}},{key:"yieldResponseOperation",get:function(){return this._yieldResponseOperation}},{key:"pendingTaskCount",get:function(){for(var e=0,t=0;t<this._queues.length;++t)e+=this._queues[t].length;return e}},{key:"pauseRef",get:function(){return this._pauseRef}},{key:"resumeTasksTimeoutId",get:function(){return this._resumeTasksTimeoutId}},{key:"componentName",get:function(){return 4}},{key:"componentDependencies",get:function(){return this._componentDependencies}}])&&g(t.prototype,i),r&&g(t,r),e}();f.numQueues=7,f._isOriginalWindowFuncSet=!1,f._originalSetTimeout=null,f._originalClearTimeout=null,f._originalRequestIdleCallback=null,f._originalCancelIdleCallback=null,Object(i.a)(f,"TaskManagerImpl",null,[43,4,44]);var v=n(50);function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return y}));var y=function(){function e(){}var t,n,i;return e.dispose=function(){e._instanceToReturn=new a,v.a(e._realTaskManager),e._realTaskManager=null},e.keepOriginalWindowFuncInTaskManager=function(){f.keepOriginalWindowFunc()},t=e,i=[{key:"instance",get:function(){return e._instanceToReturn||(e._realTaskManager=f.createTaskManagerImpl(),e._instanceToReturn=e._realTaskManager),e._instanceToReturn}}],(n=null)&&_(t.prototype,n),i&&_(t,i),e}();y._realTaskManager=null,y._instanceToReturn=null,Object(i.a)(y,"TaskManager",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=function(){this.flags=[],this.handlers=[],this.asyncHandlers=[],this.defaultActionDataGenerator=null};Object(i.a)(a,"ActionMetadata",null,[]);var o=n(258),s=n(178);n(9);var l=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._stage=0,t._actionManager=null,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.run=function(){if(this._stage||(this._actionManager.beforeAction(this.childOperation),this._stage=1),1===this._stage){if(this.childOperation.run(),this.childOperation.hasYielded)return;this._stage=2}2===this._stage&&(this._actionManager.afterAction(this.childOperation),this.childOperation.recycle(),this.setIsCompleted(),this.recycle())},r.recycle=function(){e.prototype.recycle.call(this),Array.add(i._instances,this)},i.registerInstance=function(e,t){var n,r=i._instances.length;return r?(n=i._instances[r-1],Array.removeAt(i._instances,r-1)):n=new i,n.init(e),n.setDebugName("ActionNotificationOperation"),n._stage=0,n._actionManager=t,n},i}(o.a);l._instances=[],Object(i.a)(l,"ActionNotificationOperation",o.a,[]);var c=function(e){var t,i;function r(){var t;return(t=e.call(this)||this)._actionResultCallback=null,t._callbackUserData=null,t._stage=0,t._currentIndex=0,t}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var a=r.prototype;return a.recycle=function(){e.prototype.recycle.call(this),Array.add(r._instances,this)},a.run=function(){var e=n(61).ActionManager;if(1===this._stage){if(1===this.processCurrentOperation())return;for(var t=this._actionManager.applicationContextCollection.length,i=this._currentIndex;i<t;i++){var r=this._actionManager.applicationContextCollection[i];if(this._currentIndex=i+1,this.setCurrentOperationFromContext(r),1===this.processCurrentOperation())return;if(this.timeoutExceeded&&i!==t-1)return void this.yield()}this._stage=3}3===this._stage&&(this._response=e.mergeResponses(this.response,2),this.setIsCompleted(),!this.isSynchronous&&this._actionResultCallback&&this._actionResultCallback(this,this._callbackUserData))},r.registerInstance=function(e,t,i,a,o,s,l,c,u){n(61).ActionManager;var d,p=r._instances.length;return p?(d=r._instances[p-1],Array.removeAt(r._instances,p-1)):d=new r,d.init(t),d.setDebugName("ProcessActionOperation"),d.initAction(e,i,a,o,s,u),d._actionResultCallback=l,d._callbackUserData=c,d._stage=1,d._currentIndex=0,d._actionManager=e,d},r}(s.a);c._instances=[],Object(i.a)(c,"ProcessActionOperation",s.a,[]);var u=n(320),d=n(319),p=function(){this.dataValue1=0,this.dataValue2=0};Object(i.a)(p,"ReportingData",null,[]);n(54);var h=n(76),m=n(117),g=n(3);function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"ActionManager",(function(){return v}));var v=function(){function e(e){void 0===e&&(e=null),this._commandTabName=null,this._actionCollection=[],this._actionDepth=[],this._applicationContextCollection=[],this._listeners=[],this.commandLocation=0,this.invocationMethod=0,this.throttlingManager=null,this.mode=3,this.isOffline=!1,this._actionsWithoutHandlers={},this._applicationFeatureHelperFuture=e}var t,i,o,s=e.prototype;return s.registerApplication=function(e){Array.add(this._applicationContextCollection,e)},s.logUnhandledKeyboardActions=function(){h.d(this._actionsWithoutHandlers).length>0&&(g.ULS.sendTraceTag(23658528,306,15,"Unhandled actions: {0}",JSON.stringify(this._actionsWithoutHandlers)),this._actionsWithoutHandlers=null)},s.logUnhandledAction=function(e){var t=e.toString();if(t in this._actionsWithoutHandlers){var n=this._actionsWithoutHandlers[t];this._actionsWithoutHandlers[t]=n+1}else this._actionsWithoutHandlers[t]=1},s.unregisterApplication=function(e){Array.remove(this._applicationContextCollection,e)},s.registerListener=function(e){Array.add(this._listeners,e)},s.unregisterListener=function(e){Array.remove(this._listeners,e)},s.addAction=function(e,t,n){this.registerAction(e,t,n,null)},s.removeAction=function(e,t,n){this.unregisterAction(e,t,n,null)},s.addActionWithFlags=function(e,t,n,i){this.registerAction(e,t,n,null),this.setActionFlags(e,i)},s.addAsyncAction=function(e,t,n){this.registerAction(e,t,null,n)},s.addAsyncActionWithFlags=function(e,t,n,i){this.registerAction(e,t,null,n),this.setActionFlags(e,i)},s.setActionFlags=function(e,t){if(0!==t){this._actionCollection[e]||(this._actionCollection[e]=new a);var n=this._actionCollection[e];0;for(var i=1;i<=t;i*=2)t&i&&(n.flags[i]=!0)}},s.setActionDataGenerator=function(e,t){this._actionCollection[e].defaultActionDataGenerator=t},s.processAction=function(e,t,n){void 0===n&&(n=null);var i=null;return this._actionCollection[e]&&this._actionCollection[e].defaultActionDataGenerator&&(i=this._actionCollection[e].defaultActionDataGenerator()),this.processActionWithData(e,t,i,n)},s.processActionAsync=function(e,t,n,i,r,a){void 0===a&&(a=null);var o=null;return this._actionCollection[t]&&this._actionCollection[t].defaultActionDataGenerator&&(o=this._actionCollection[t].defaultActionDataGenerator()),this.processActionWithDataAsync(e,t,n,o,i,r,null)},s.processActionWithDataInternal=function(t,n,i,r,a,o,s,u){if(n===e.nullAction)return 2;if(!this._actionCollection[n])return this._actionsWithoutHandlers&&2===i&&6===this.commandLocation&&this.logUnhandledAction(n),2;var d=this.getActionMetadata(n);if(d.flags[16]&&this.throttlingManager&&!this.throttlingManager.shouldRunThrottledAction)return 2;var h=l.registerInstance(t,this);h.isSynchronous=u;var m=c.registerInstance(this,h,n,i,new p,r,o,s,a);h.run();var g=+h.endTime-+h.startTime;return d.flags[16]&&this.throttlingManager&&this.throttlingManager.recordThrottledActionTime(g),m.response},s.processActionWithData=function(e,t,n,i){return void 0===i&&(i=null),this.processActionWithDataInternal(null,e,t,n,i,null,null,!0)},s.processActionWithDataAsync=function(e,t,n,i,r,a,o){return void 0===o&&(o=null),this.processActionWithDataInternal(e,t,n,i,o,r,a,!1)},s.processContextSet=function(e,t,n,i,r,a,o){void 0===o&&(o=null);var s=l.registerInstance(null,this);s.isSynchronous=!0;var c=d.ProcessContextSetOperation.registerInstance(this,s,e,t,n,i,r,a,o);return s.run(),c.response},s.processContextSetAsync=function(e,t,n,i,r,a,o,s){void 0===s&&(s=null);var c=l.registerInstance(e,this),u=d.ProcessContextSetOperation.registerInstance(this,c,t,n,i,r,a,o,s);return c.run(),u.response},s.processActionAgainstContext=function(e,t,n,i,r,a,o){if(void 0===o&&(o=null),!e)return 8;if(e.isContextSet)return this.processContextSet(e,t,n,i,r,a,o);var s=l.registerInstance(null,this);s.isSynchronous=!0;var c=u.ProcessContextOperation.registerInstance(this,s,e,t,n,i,r,a,o);return s.run(),c.response},s.processActionAgainstContextAsync=function(e,t,n,i,r,a,o,s){if(!t)return 8;if(t.isContextSet)return this.processContextSetAsync(e,t,n,i,r,a,o,s);var c=l.registerInstance(e,this),d=u.ProcessContextOperation.registerInstance(this,c,t,n,i,r,a,o,s);return c.run(),d.response},s.removeActionIfFeatureIsDisabled=function(e,t,n,i,r,a){var o=this;void 0===a&&(a=null),this._applicationFeatureHelperFuture&&this._applicationFeatureHelperFuture.execute((function(s){s.isFeatureEnabled(e,t).then((function(e){return e||(o.removeAction(n,i,r),a&&a(n)),null}))}))},s.beforeAction=function(t){var i=n(1).AFrameworkApplication,r=t.actionId;1!==t.behavior&&i.appSettingsManager&&i.appSettingsManager.getBooleanAppSetting("LoggingActionsEnabled")&&e.logActionForAutomation(r),this._actionDepth[r]?this._actionDepth[r]++:(this.notifyOnBeforeAction(t),this._actionDepth[r]=1)},s.afterAction=function(e){var t=e.actionId;this._actionDepth[t]--,this._actionDepth[t]||(this.invocationMethod=0,this.commandLocation=0,this.commandTabName=null,e.response>1&&this.notifyOnAfterAction(e),2!==e.behavior||32!==e.response&&4!==e.response||!this.getActionMetadata(t).flags[256]||m.a.instance.consentGiven(),delete this._actionDepth[t])},s.registerAction=function(e,t,i,r){n(1).AFrameworkApplication;this._actionCollection[e]||(this._actionCollection[e]=new a);var o=this._actionCollection[e];i?o.handlers[t]=i:o.asyncHandlers[t]=r},s.unregisterAction=function(e,t,i,r){var a=n(1).AFrameworkApplication;if(this._actionCollection[e]){var o=this._actionCollection[e];0,o.handlers[t]===i?o.handlers[t]=null:o.asyncHandlers[t]===r&&(o.asyncHandlers[t]=null),a.appSettingsManager&&a.appSettingsManager.getBooleanAppSetting("CleanActionFlagsIsEnabled")&&(o.flags=[])}},s.notifyOnBeforeAction=function(e){for(var t=0;t<this._listeners.length;t++)this._listeners[t].onBeforeAction(e)},s.notifyOnAfterAction=function(e){for(var t=0;t<this._listeners.length;t++)this._listeners[t].onAfterAction(e)},s.getActionMetadata=function(e){return this._actionCollection[e]},e.logActionForAutomation=function(e){var t=document.getElementById("ActionLog");t||((t=document.createElement("div")).id="ActionLog",t.style.display="none",document.body.appendChild(t));var n=document.createElement("div");n.innerText=e.toString(),t.appendChild(n)},e.actionIdResolver=function(t){return e.actionIdResolverDelegate(t)},e.commandIdResolver=function(t){return e.commandIdResolverDelegate(t)},e.contextIdResolver=function(t){return e.contextIdResolverDelegate(t)},e.nullIdResolver=function(e){return null},e.nullCommandIdResolver=function(e){return null},e.doNothing=function(e,t,n,i,r){return 32},e.doNothingButReport=function(e,t,n,i,a){if(Object(r.c)(p,a)){var o=a;i.dataValue1=o.dataValue1,i.dataValue2=o.dataValue2}return 32},e.mergeResponses=function(e,t){return t>e?t:e},t=e,(i=[{key:"commandTabName",get:function(){return this._commandTabName},set:function(e){this._commandTabName=e}},{key:"applicationContextCollection",get:function(){return this._applicationContextCollection}}])&&f(t.prototype,i),o&&f(t,o),e}();v.doNothingHandler=v.doNothing,v.doNothingButReportHandler=v.doNothingButReport,v.nullAction=null,v.emptyActionId=371857150,v.actionIdResolverDelegate=v.nullIdResolver,v.commandIdResolverDelegate=v.nullCommandIdResolver,v.contextIdResolverDelegate=v.nullIdResolver,Object(i.a)(v,"ActionManager",null,[26,27])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(1),a=(n(9),n(54),n(13)),o=n(126),s=function(){function e(e,t){this._isEndedNormal=!1,this.duration=0,this.title=null,this.serverMeasurements=null,this.beginTime=null,this.endTime=null,this.parent=null,this.children=[],this.isFromServer=!1,this.attributes=null,t?(this.serverMeasurements=e,this.isFromServer=!0):(this.title=e,this.isFromServer=!1),this._hasBeenProcessed=!1}var t=e.prototype;return t.process=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return this._hasBeenProcessed||(this.endTime?this._isEndedNormal=!0:(this.endTime=new Date,this._isEndedNormal=!1),this.duration=this.endTime.getTime()-this.beginTime.getTime(),this._hasBeenProcessed=!0),this.duration.toString()})),t.addChild=function(e){Array.add(this.children,e),e.parent=this},t.removeChild=function(e){Array.remove(this.children,e)},t.addAttribute=function(e,t){this.attributes||(this.attributes={}),this.attributes[e]=t},t.toFixedLengthString=function(e,t){for(var n=e.toString(),i=t-n.length,r=0;r<i;r++)n="0"+n;return n},t.toFormatedTimeString=function(e){var t=e.getUTCFullYear(),n=e.getUTCMonth()+1,i=e.getUTCDate(),r=e.getUTCHours(),a=e.getUTCMinutes(),o=e.getUTCSeconds(),s=e.getUTCMilliseconds();return String.format("{0}-{1}-{2} {3}:{4}:{5}.{6}",this.toFixedLengthString(t,4),this.toFixedLengthString(n,2),this.toFixedLengthString(i,2),this.toFixedLengthString(r,2),this.toFixedLengthString(a,2),this.toFixedLengthString(o,2),this.toFixedLengthString(s,3))},t.toStatistics=function(e,t,n){for(var i="",r=0;r<e;r++)i+=o.a.indent;if(this.isFromServer)return i+this.serverMeasurements+"\n";var s=n;s||(s=this.beginTime);var l=this.beginTime.getTime()-s.getTime(),c=i+String.format('<{0} {1}="{2}" {3}="{4}" {5}="{6}"',o.a.measurementTag,o.a.titleAttr,a.a.xmlEncode(this.title),o.a.beginTimeAttr,a.a.xmlEncode(l.toString()),o.a.spendTimeAttr,a.a.xmlEncode(this.process()));if(n||(c+=String.format(' {0}="{1}" {2}="{3}"',o.a.machineAttr,a.a.xmlEncode(t),o.a.timeStampeAttr,a.a.xmlEncode(this.toFormatedTimeString(s)))),this.attributes){var u=this.attributes;for(var d in u){var p,h={key:d,value:u[d]};p=h.value.toString(),c+=String.format(' {0}="{1}"',h.key,p)}}var m="";if(this._isEndedNormal||(m+=String.format("<{0}>{1}</{0}>\n",o.a.errorTag,"Inaccurate")),this.children&&this.children.length>0)for(var g=0;g<this.children.length;g++)m+=this.children[g].toStatistics(e+1,t,s);return""===m?c+=" />\n":(c+=">\n",c+=m,c+=i+String.format("</{0}>\n",o.a.measurementTag)),c},e}();Object(i.a)(s,"Measurement",null,[]);var l=function(){function e(){this._buffer=[],this._currentSize=0,this._isStopWriting=!1}var t=e.prototype;return t.write=function(t){var i=n(62).PageStats;r.AFrameworkApplication.collectPageStats&&(this._isStopWriting||(this._currentSize+t.length>1048576&&(this._isStopWriting=!0,t=e.pageStatsBufferOverflowWarningMessage),Array.add(this._buffer,t),this._currentSize+=t.length,i.pageStatsControl&&i.pageStatsControl.isDialogDisplayed()&&i.pageStatsControl.displayStatisticIncremental(t)))},t.read=function(){return r.AFrameworkApplication.collectPageStats?this._buffer.join(""):null},e}();l.pageStatsBufferOverflowWarningMessage="ShowPageStats message size reaches 1MB. Stop writing.",Object(i.a)(l,"PageStatsBuffer",null,[]);var c=n(2),u=n(4),d=n(75),p=n(102),h=n(52),m=function(){};m.dialogHtml="<div class='WACDialogRow' id='PageStatsResultBlock'> <textarea id='PageStatsResult' class='PageStatsResult' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div> <div class='WACDialogCheckBoxDiv' id='PageStatsAutoApplyBlock'> <input type='checkbox' id='PageStatsAutoApplyCheckBox' class='WACDialogCheckBox' title='Apply showpagestats automatically'></input> <label id='\"\"' class='WACDialogLabel' for='PageStatsAutoApplyCheckBox' >Apply showpagestats automatically</label> </div>",Object(i.a)(m,"PageStatsDialogHtml",null,[]);var g=function(e){var t,n;function i(t,n){var i,r;(r=e.call(this)||this).dialogHtml=m.dialogHtml,r.dialogId="PageStatsDialog",r.buttonsOption=0,r.setButtonText(1,CommonUIStrings.l_DialogClose);var a=((i={}).PageStatsResult=n,i);return r.initializeAndShow("ShowPageStats",Object(c.d)(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r),r.pageStatsDialogHandler,"pageStatsDialogHandler"),a),r.setDescribedByForDialog(r.myId("PageStatsResultBlock")),r._textAreaElement=document.getElementById("PageStatsResult"),r._textAreaElement.focus(),r._pageStatsControl=t,r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=i.prototype;return a.pageStatsDialogHandler=function(e,t){this._pageStatsControl.dialogClosed()},a.appendText=function(e){r.AFrameworkApplication.showPageStats&&(this._textAreaElement.value=this._textAreaElement.value+e)},a.getHeightMinusPadding=function(e,t){var n=h.CssUtils.getCurrentStyle(t),i=e-Number.parseInvariant(n.paddingTop.replace("px",""))-Number.parseInvariant(n.paddingBottom.replace("px",""));return i<0?0:i},a.getWidthMinusOffset=function(e,t){var n=e-t.offsetLeft;return n<0?0:n},a.getWidthMinusPadding=function(e,t){var n=h.CssUtils.getCurrentStyle(t),i=e-Number.parseInvariant(n.paddingLeft.replace("px",""))-Number.parseInvariant(n.paddingRight.replace("px",""));return i<0?0:i},a.setDialogProperties=function(t){e.prototype.setDialogProperties.call(this,t),this.setPageStatsDialogProperties()},a.setPageStatsDialogProperties=function(){var e=2*p.a.pageWidth/3;e=(e=e>600?600:e)<50?50:e;var t=Number.parseInvariant(this._divMessageBox.style.top.replace("px","")),n=p.a.pageHeight-(t<0?0:t)-50;n=n<50?50:n,this._divMessageBox.style.width=String.format("{0}px",e),this._divMessageBox.style.height=String.format("{0}px",n);var i=this._body.parentNode;var r=this._textElement.children[0];var a=r.children[0],o=new Sys.UI.Bounds(0,0,0,0);o.height=this._divMessageBox.clientHeight-i.offsetTop-this._buttonPanel.offsetHeight,o.width=this.getWidthMinusOffset(this._divMessageBox.clientWidth,i),o.height=this.getHeightMinusPadding(o.height,i),o.height=this.getHeightMinusPadding(o.height,r),o.width=this.getWidthMinusPadding(o.width,i),a.style.height=String.format("{0}px",o.height),a.style.width=String.format("{0}px",o.width)},a.sizeFix=function(t){this.setPageStatsDialogProperties(),e.prototype.sizeFix.call(this,t)},i}(d.a);Object(i.a)(g,"PageStatsDialog",d.a,[]);var f=function(){function e(e){this._controlElement=null,r.AFrameworkApplication.showPageStats&&(this._pageStatsDialog=null,this._target=e,this._initialized=!1)}var t=e.prototype;return t.init=function(){var e=n(62).PageStats;r.AFrameworkApplication.showPageStats&&(this._initialized||(e.activeFrame.theClickInputManager.registerHandlerWithData(u.EventNames.click,this._controlElement,Object(c.d)(this,this.pageStatsControlClickHandler,"pageStatsControlClickHandler"),this),e.activeFrame.add_onResize(Object(c.d)(this,this.resizeHandler,"resizeHandler")),e.registerControl(this),this._initialized=!0))},t.resizeHandler=function(){},t.dispose=function(){var e=n(62).PageStats;r.AFrameworkApplication.showPageStats&&(this._initialized&&(e.activeFrame.theMouseInputManager&&e.activeFrame.theClickInputManager.unregisterHandler(u.EventNames.click,this._controlElement,Object(c.d)(this,this.pageStatsControlClickHandler,"pageStatsControlClickHandler")),e.activeFrame.remove_onResize(Object(c.d)(this,this.resizeHandler,"resizeHandler")),e.unregisterControl()),this._target.removeChild(this._controlElement),this._controlElement=null)},t.isDialogDisplayed=function(){return!!r.AFrameworkApplication.showPageStats&&!!this._pageStatsDialog},t.displayStatisticIncremental=function(e){r.AFrameworkApplication.showPageStats&&this._pageStatsDialog&&this._pageStatsDialog.appendText(e)},t.pageStatsControlClickHandler=function(e){var t=n(62).PageStats;return!!r.AFrameworkApplication.showPageStats&&(this._pageStatsDialog=new g(this,t.bufferedStats()),!0)},t.dialogClosed=function(){r.AFrameworkApplication.showPageStats&&(this._pageStatsDialog=null)},e}();Object(i.a)(f,"PageStatsControl",null,[4]);var v=function(e){var t,i;function a(t){var i;i=e.call(this,t)||this;n(62).PageStats;if(!r.AFrameworkApplication.showPageStats)return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i);var a=t.ownerDocument;i._controlElement=a.createElement("div"),i._controlElement.id="WACPageStatsButton",i._controlElement.className="WACPageStatsButton",i._controlElement.style.display="block",i._controlElement.innerText="",i._controlElement.style.zIndex="500";var o=n(62).PageStats.activeFrame.get_element().clientWidth-200,s=n(62).PageStats.activeFrame.get_element().clientHeight-180;return i._controlElement.style.top=s.toString()+"px",i._controlElement.style.left=o.toString()+"px",t.appendChild(i._controlElement),i.init(),i}return i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,a.prototype.resizeHandler=function(){var e=n(62).PageStats.activeFrame.get_element().clientWidth-200,t=n(62).PageStats.activeFrame.get_element().clientHeight-180;this._controlElement.style.top=t.toString()+"px",this._controlElement.style.left=e.toString()+"px"},a}(f);Object(i.a)(v,"PageStatsFloatingButton",f,[]);var _=n(50);function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"PageStats",(function(){return b}));var b=function(){function e(){}var t,n,i;return e.start=function(t){r.AFrameworkApplication.collectPageStats&&(e._activeFrame=t,e._isStarted=!0)},e.stop=function(){_.a(e.pageStatsControl),e._pageStatsControl=null,e._pageStatsBuffer=null,e._inProgressMeasurement=null,e._rootMeasurement=null,e._activeFrame=null,e._isStarted=!1},e.bufferedStats=function(){return e._pageStatsBuffer.read()},e.isEnabled=function(){return!!r.AFrameworkApplication.collectPageStats&&(!!e._isStarted&&(e._pageStatsBuffer||(e._pageStatsBuffer=new l),!e.pageStatsControl&&r.AFrameworkApplication.showPageStats&&(e._pageStatsControl=new v(document.getElementsByTagName("body")[0])),!0))},e.beginRootMeasurement=function(t,n){if(e.isEnabled()){if(n||(n=new Date),e._inProgressMeasurement){0;for(var i=e._inProgressMeasurement;i.parent;)i=i.parent;e._pageStatsBuffer.write(i.toStatistics(0,"Client",null)),e._inProgressMeasurement=null,e._rootMeasurement=null}e.beginMeasurement(t,n)}},e.beginMeasurement=function(t,n){if(e.isEnabled()){0,n||(n=new Date);var i=new s(t,!1);i.beginTime=n,e._inProgressMeasurement?(e._inProgressMeasurement.addChild(i),e._inProgressMeasurement=i):(e._inProgressMeasurement=i,e._rootMeasurement=i)}},e.beginChildMeasurement=function(t,n){e.isEnabled()&&(n||(n=new Date),e._inProgressMeasurement&&e.beginMeasurement(t,n))},e.endRootMeasurement=function(t){e.isEnabled()&&e._inProgressMeasurement&&(e._inProgressMeasurement.parent&&(e._inProgressMeasurement=e._rootMeasurement),e.endMeasurement(t))},e.endMeasurement=function(t,n){if(e.isEnabled()&&e._inProgressMeasurement)if(n||(n=new Date),e._inProgressMeasurement.title,e._inProgressMeasurement.endTime=n,e._inProgressMeasurement.process(),e._inProgressMeasurement.parent){e._inProgressMeasurement;e._inProgressMeasurement=e._inProgressMeasurement.parent}else e._pageStatsBuffer.write(e._inProgressMeasurement.toStatistics(0,"Client",null)),e._inProgressMeasurement=null,e._rootMeasurement=null},e.endChildMeasurement=function(t,n){e.isEnabled()&&e.endMeasurement(t,n)},e.addServerMeasurements=function(t){if(e.isEnabled()&&""!==t)if(e._inProgressMeasurement){var n=new s(t,!0);e._inProgressMeasurement.addChild(n)}else e._pageStatsBuffer.write(t+"\n")},e.addAttribute=function(t,n){e.isEnabled()&&e._inProgressMeasurement&&e._inProgressMeasurement.addAttribute(t,n)},e.registerControl=function(t){e._pageStatsControl=t},e.unregisterControl=function(){e._pageStatsControl=null},t=e,i=[{key:"pageStatsControl",get:function(){return e._pageStatsControl}},{key:"activeFrame",get:function(){return e._activeFrame}}],(n=null)&&y(t.prototype,n),i&&y(t,i),e}();b._inProgressMeasurement=null,b._rootMeasurement=null,b._pageStatsBuffer=null,b._isStarted=!1,b._activeFrame=null,b.showPageStatsQueryParam="showpagestats",b.showPageStatsXHRHeader="X-ShowPageStats",b.pageStatsResponseXHRHeader="X-PageStats",b._pageStatsControl=null,Object(i.a)(b,"PageStats",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(244),a=function(){function e(e){this._index=-1,this._array=e}var t=e.prototype;return t.get_current=function(){if(-1===this._index||this._index>=this._array.length)throw Error.invalidOperation();return this._array[this._index]},t.moveNext=function(){return this._index++,this._index<this._array.length},t.reset=function(){this._index=-1},t.next=function(){return this._index++,this._index<this._array.length?{done:!1,value:this._array[this._index]}:{done:!0,value:void 0}},e}();function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}Object(i.a)(a,"ArrayEnumerator",null,[2]),n.d(t,"a",(function(){return l}));var l=function(){function e(){this.$$ge=this.$$lge,this.getEnumerator=this.getEnumerator$p,this._items=new Array(0)}var t=e.prototype;return t.$$lge=function(){return new r.a(this._items)},t.getEnumerator$p=function(){return new a(this._items)},t[Symbol.iterator]=function(){return this._items[Symbol.iterator]()},t.get_count=function(){return this._items.length},t.add=function(e){Array.add(this._items,e)},t.clear=function(){this._items=new Array(0)},t.contains=function(e){return Array.contains(this._items,e)},t.remove=function(e){return!!this.contains(e)&&(Array.remove(this._items,e),!0)},t.indexOf=function(e){return Array.indexOf(this._items,e)},t.removeAt=function(e){if(e>=this.get_count())throw Error.argumentOutOfRange("index");Array.removeAt(this._items,e)},t.get_item=function(e){if(e>=this.get_count())throw Error.argumentOutOfRange("index");return this._items[e]},t.set_item=function(e,t){if(e>=this.get_count())throw Error.argumentOutOfRange("index");return this._items[e]=t,t},t.addRange=function(e){for(var t,n=o(e);!(t=n()).done;){var i=t.value;this.add(i)}},t.insert=function(e,t){if(e>this.get_count())throw Error.argumentOutOfRange("index");Array.insert(this._items,e,t)},t.insertRange=function(e,t){if(e>this.get_count())throw Error.argumentOutOfRange("index");for(var n,i=o(t);!(n=i()).done;){var r=n.value;Array.insert(this._items,e++,r)}},t.toArray=function(){return Array.clone(this._items)},t.sort=function(){this._items.sort()},t.Sc=function(e){this._items.sort((function(t,n){return e(t,n)}))},e}();Object(i.a)(l,"List",null,[45,35,1])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(65),a=n(51);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,"",r.controlProperties.Keytip,void 0,!1)||this)._control=r,a.visible=a.control.visible,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,s,l,c=i.prototype;return c.isMenuItem=function(){return i.isDisplayModeMenu(this.displayMode)},c.refreshInternal=function(){this.dirty=!1},c.onEnabledChanged=function(e){this.control.onEnabledChanged(e)},c.ensureCorrectChildType=function(e){this.control.ensureCorrectChildType(e)},c.pollForStateAndUpdateInternal=function(){this.control.pollForStateAndUpdate()},c.ensureBehaviorAttached=function(){this.control.ensureBehaviorAttachedIfAvailable()},c.onMenuClosed=function(){this.control.onMenuClosed()},c.setFocusOnFirstControl=function(){return this.control.setFocusOnControl()},c.dispose=function(){this.control.dispose(),this._control=null,e.prototype.dispose.call(this)},i.isDisplayModeMenu=function(e){return e.startsWith("Menu")||"Initials"===e},r=i,(s=[{key:"displayMode",get:function(){return this.title}},{key:"elementInternal",get:function(){return this.control.getDOMElementForDisplayMode(this.title,this)},set:function(e){throw Error.create("Cannot set the DOM Element of ControlComponents.  They get their DOM Elements from the Control.")}},{key:"componentElement",get:function(){return Object(a.a)(i.prototype,this,"elementInternal")}},{key:"control",get:function(){return this._control}},{key:"enabled",get:function(){return this.control.enabled},set:function(e){this.control.enabled=e}},{key:"visible",get:function(){return!(this.root.supportsInvisibleControls&&!this.control.visible)&&Object(a.a)(i.prototype,this,"visible")},set:function(e){Object(a.b)(i.prototype,this,"visible",e)}},{key:"keytipDomContainer",get:function(){return this.control.displayedComponent.elementInternal}},{key:"textValue",get:function(){return this.control.getTextValue()}}])&&o(r.prototype,s),l&&o(r,l),i}(r.a);Object(i.a)(s,"ControlComponent",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n(0),r=n(2),a=n(1),o=(n(9),n(7)),s=n(190),l=n(204),c=n(5),u=n(6),d=n(3);function p(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var g=function(){function e(e,t,n,i,r,a,o){void 0===r&&(r=null),void 0===a&&(a=!0),void 0===o&&(o=!0),this._elmDOM=null,this._enabled=!0,this._disposed=!1,this._enabledHasBeenSet=!1,this._keytip=null,this._originalCssDisplay="",this._visibleInDOM=!0,this._parent=null,this._children=null,this.dirty=!0,this.ignoreDirtyingEvents=!1,this._delayedInitHandler=null,this._delayedInitData=null,this._delayedInitOptions=null,this._delayedInitInProgress=!1,this._lastPollTime=null,this._id=t,this._root=e,this.titleInternal=n,this._description=i,this._visible=a,o&&this.ensureChildren(),r&&(this._keytip=new s.a(r,this.id))}var t,i,h,g=e.prototype;return g.ensureChildren=function(){c.c(this.children)&&(this._children=new l.a)},g.updateFocusedIndex=function(e){return this===e},g.resetFocusedIndex=function(){},g.focusNext=function(e){return!1},g.getChildInternal=function(e){for(var t,n=p(this.children);!(t=n()).done;){var i=t.value;if(i.id===e)return i}return null},g.getChild=function(e){return this.getChildInternal(e)},g.getChildByTitle=function(e){for(var t,n=p(this.children);!(t=n()).done;){var i=t.value;if(i.title===e)return i}return null},g.addChild=function(e){this.addChildInternal(e,!0)},g.addChildInternal=function(e,t){this.addChildAtIndexInternal(e,-1,t)},g.addChildAtIndex=function(e,t){this.addChildAtIndexInternal(e,t,!0)},g.addChildAtIndexInternal=function(t,n,i){if(i&&this.ensureCorrectChildType(t),!c.c(t.parent)){var r=String.format(e.addChildAlreadyAddedExcpetionMessage,t.id,this.id,t.parent.id);throw d.ULS.shipAssertTag(4334035,201,!1,r),Error.create(r)}-1===n?this.children.add(t):this.children.insert(n,t),t._parent=this,this.onDirtyingChange()},g.removeChild=function(e){var t=this.getChildInternal(e);if(c.c(t))throw Error.create("The child with id: "+e+" is not as child of this Component");this.children.remove(t),t._parent=null,this.onDirtyingChange()},g.removeChildren=function(){for(var e,t=p(this.children);!(e=t()).done;){var n=e.value;n&&(n._parent=null)}this.children.clear(),this.onDirtyingChange()},g.ensureCorrectChildType=function(e){},g.initRootMember=function(e){if(!c.c(this.root))throw Error.create("Root member has already been set for this Component.");this._root=e},g.onChildrenVisibleChanged=function(){if(this.children&&this.children.count>0){for(var e,t=!1,n=p(this.children);!(e=n()).done;){if(e.value.visible){t=!0;break}}this.visible=t}},g.onEnabledChanged=function(e){},g.setDirtyRecursively=function(e){if(this.dirty=e,!c.c(this.children))for(var t,n=p(this.children);!(t=n()).done;){t.value.setDirtyRecursively(e)}},g.onDirtyingChange=function(){this.dirty||this.ignoreDirtyingEvents||(this.dirty=!0,c.c(this.parent)||this.parent.onDirtyingChange())},g.refreshInternal=function(){this.dirty=!1},g.ensureRefreshed=function(){this.dirty&&this.refreshInternal()},g.ensureDOMElement=function(){this._elmDOM||(this._elmDOM=u.a.createElement(this.domElementTagName),this._elmDOM.className=this.cssClass,this.id&&(this._elmDOM.id=this.id))},g.setFocusOnFirstControl=function(){if(!this.visible)return!1;for(var e,t=p(this.children);!(e=t()).done;){if(e.value.setFocusOnFirstControl())return!0}return!1},g.ensureDOMElementAndEmpty=function(){c.c(this.elementInternal)?this.ensureDOMElement():this.elementInternal=u.a.removeChildNodes(this.elementInternal)},g.appendChildrenToElement=function(e){for(var t,n=this.root.supportsInvisibleControls,i=document.createDocumentFragment(),r=p(this.children);!(t=r()).done;){var a=t.value;a.ensureDOMElement(),n&&!a.visible||i.appendChild(a.elementInternal),a.ensureRefreshed()}e.appendChild(i)},g.getTextValue=function(){return null},g.onMenuClosed=function(){if(!c.c(this.children))for(var e,t=p(this.children);!(e=t()).done;){e.value.onMenuClosed()}},g.setDelayedInitData=function(e,t,n){this._delayedInitHandler=e,this._delayedInitData=t,this._delayedInitOptions=n},g.doDelayedInit=function(){if(!this._delayedInitInProgress){if(c.c(this._delayedInitHandler))throw Error.create("No delayedinit handler present in this component: "+this.id);this._delayedInitInProgress=!0,this._delayedInitHandler(this,this._delayedInitData,this._delayedInitOptions)}},g.onDelayedInitFinished=function(e){e&&(this._delayedInitHandler=null,this._delayedInitData=null,this._delayedInitOptions=null,this.onDirtyingChange()),this._delayedInitInProgress=!1},g.pollForStateAndUpdateInternal=function(){if(this.children)for(var e,t=p(this.children);!(e=t()).done;){e.value.pollForStateAndUpdateInternal()}else this._disposed?d.ULS.sendTraceTag(35129304,220,15,"PollForStateAndUpdateInternal is called after component is disposed"):d.ULS.sendTraceTag(35129305,220,50,"PollForStateAndUpdateInternal is called and children is null")},g.ensureBehaviorAttached=function(){for(var e,t=p(this.children);!(e=t()).done;){e.value.ensureBehaviorAttached()}},g.pollIfRootPolledSinceLastPoll=function(){this.rootPolledSinceLastPoll&&this.pollForStateAndUpdateInternal()},g.applyHideElementOverride=function(){"none"!==this.elementInternal.style.display&&(this._originalCssDisplay=this.elementInternal.style.display),this.elementInternal.style.display="none"},g.removeHideElementOverride=function(){this.elementInternal.style.display=this._originalCssDisplay},g.dispose=function(){if(!c.c(this.children)){for(var e,t=p(this.children);!(e=t()).done;){e.value.dispose()}this._children=null}this._parent=null,this._root=null,this._delayedInitData=null,this._delayedInitHandler=null,this._delayedInitOptions=null,this._elmDOM=null,this._disposed=!0},g.ensureKeytip=function(e,t,i,l){var u=n(123).Jewel;if(this.hasKeytip&&c.c(this.keytip.element)&&!c.c(e)&&!c.c(t)){e.appendChild(this.keytip.createKeytipElement());var d="";if(Object(r.c)(u,this.root)&&a.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled){var p=this.keytip.key.toLocaleLowerCase(),h=l?String.format("ktp-{0}-{1}",l,p):String.format("ktp-{0}",p);d=String.format("ktp-layer-id {0}",h),t.setAttribute("data-ktp-target",h),t.setAttribute("data-ktp-execute-target",h)}else d=i?String.format("{0} {1}",i,this.keytip.elementId):String.format("{0} {1}",s.a.ribbonShortcutId,this.keytip.elementId);o.a.setAriaAttribute(t,o.a.ariaDescribedByAttribute,d)}},g.showKeytip=function(e){return!(!this.visible||!this.hasKeytip)&&(!this.keytip.element&&this.keytipDomContainer&&this.keytipDomContainer.appendChild(this.keytip.createKeytipElement()),this.keytip.show(e),!0)},g.hideKeytip=function(){this.hasKeytip&&this.keytip.hide()},t=e,(i=[{key:"id",get:function(){return this._id}},{key:"elementInternal",get:function(){return this._elmDOM},set:function(e){this._elmDOM=e}},{key:"root",get:function(){return this._root}},{key:"parent",get:function(){return this._parent}},{key:"children",get:function(){return this._children}},{key:"visible",get:function(){return this._visible},set:function(e){this.visibleInternal=e}},{key:"visibleInternal",get:function(){return this.visible},set:function(e){var t=this._visible;this._visible=e,t!==this._visible&&(this.onDirtyingChange(),c.c(this.parent)||this.parent.onChildrenVisibleChanged())}},{key:"enabled",get:function(){return this._enabled},set:function(e){if(this._enabled!==e||!this._enabledHasBeenSet){if(!c.c(this.parent)&&!this.parent.enabled&&e)throw Error.create("This Component with id: "+this.id+" cannot be Enabled because its parent is Disabled");this._enabled=e,this._enabledHasBeenSet=!0;for(var t,n=p(this.children);!(t=n()).done;)t.value.enabled=e;this.onEnabledChanged(e)}}},{key:"title",get:function(){return this.titleInternal},set:function(e){this.titleInternal=e,this.onDirtyingChange()}},{key:"description",get:function(){return this._description},set:function(e){this._description=e,this.onDirtyingChange()}},{key:"domElementTagName",get:function(){return"span"}},{key:"cssClass",get:function(){return""}},{key:"visibleInDOM",get:function(){return!c.c(this.parent)&&this._visibleInDOM&&this.parent.visibleInDOM},set:function(e){this.root.supportsDynamicDisplayMode&&(this._visibleInDOM=e,this._visibleInDOM?this.removeHideElementOverride():this.applyHideElementOverride())}},{key:"needsDelayIniting",get:function(){return!c.c(this._delayedInitHandler)}},{key:"lastPollTime",get:function(){return c.c(this._lastPollTime)&&(this._lastPollTime=new Date,this._lastPollTime.setTime(0)),this._lastPollTime},set:function(e){this._lastPollTime=e}},{key:"rootPolledSinceLastPoll",get:function(){return this.lastPollTime.getTime()<this.root.lastPollTime.getTime()||!this.lastPollTime.getTime()}},{key:"keytip",get:function(){return this._keytip}},{key:"hasKeytip",get:function(){return!!this._keytip}},{key:"keytipDomContainer",get:function(){return this._elmDOM}}])&&m(t.prototype,i),h&&m(t,h),e}();g.addChildAlreadyAddedExcpetionMessage="Child with id '{0}' cannot be added to component id '{1}', already been added to component id '{2}'.",Object(i.a)(g,"Component",null,[87,4])},function(e,t,n){"use strict";var i=n(0),r=n(19),a=n(11),o=n(187),s=n(175),l=n(3),c=n(150),u=n(46);var d=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).actionId=null,t.actionName=null,t.commandSurface=null,t.parentName=null,t.triggerMethod=null,t.timeOffsetMs=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(c.a);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(d,"UserActionEvent",c.a,[]),n.d(t,"a",(function(){return h}));var h=function(){function e(){}var t,i,h;return e.isEnabledLogSessionStartAndEndDataFromClientToOTel=function(t){return e.logSessionStartAndEndDataFromClientToOTelIsEnabled||(e.logSessionStartAndEndDataFromClientToOTelIsEnabled=e.determineLogSessionStartAndEndDataFromClientToOTelIsEnabled(t)?2:1),2===e.logSessionStartAndEndDataFromClientToOTelIsEnabled},e.determineLogSessionStartAndEndDataFromClientToOTelIsEnabled=function(e){var t=n(1).AFrameworkApplication;return!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("LogSessionStartAndEndDataFromClientToOTel")},e.isUserActionLoggingToOtelEnabled=function(t){return void 0===t&&(t=null),e.userActionLoggingToOtelIsEnabled||(e.userActionLoggingToOtelIsEnabled=e.determineUserActionLoggingToOtelIsEnabled(t)?2:1),2===e.userActionLoggingToOtelIsEnabled},e.determineUserActionLoggingToOtelIsEnabled=function(t){void 0===t&&(t=null);var i=n(1).AFrameworkApplication;return!!i.appSettingsManager&&i.appSettingsManager.getBooleanAppSetting(e.getUberBRSControllingUserActionLoggingToOtel())},e.getUberBRSControllingUserActionLoggingToOtel=function(){return"WACUserActionToOtelIsEnabled"},e.getOtelActivityEventTableName=function(){return e.getOtelNonUserActionEventTableName()},e.getOtelNonUserActionEventTableName=function(){var e=Object(r.a)(String,n(1).AFrameworkApplication.sessionStartInfoSettings.Application)||"";return e="Office."+e+(""===e?"":".")+"Online.NonUserInitiatedAction"},e.getOtelNonUserActionEventTablePrefix=function(){var e=Object(r.a)(String,n(1).AFrameworkApplication.sessionStartInfoSettings.Application)||"";return e="Office."+e+(""===e?"":".")+"Online.NonUser."},e.dictionaryToDataFields=function(t,n,i){if(void 0===n&&(n=null),void 0===i&&(i=null),!t)return null;var r=new Array(0);try{for(var a in t){var o={key:a,value:t[a]};if(!i||!i.contains(o.key)){var s=n&&n.containsKey(o.key)?n.get_item(o.key):2,c=e.getDataField(o.key,o.value?o.value.toString():null,s);c&&Array.add(r,c)}}}catch(e){l.ULS.sendTraceTag(39978634,207,15,"Exception: "+e)}return r},e.getDataField=function(e,t,n){if(!t||!e)return null;var i=null;switch(n){case 1:i=Object.assign(new u.a,{name:e,bool:Boolean.parse(t.toString())});break;case 3:var r=parseInt(t);isNaN(r)||(i=Object.assign(new u.a,{name:e,int64:r}));break;case 4:var a=parseFloat(t);isNaN(a)||(i=Object.assign(new u.a,{name:e,double:a}));break;case 2:i=Object.assign(new u.a,{name:e,string:t});break;case 5:var o=Date.parse(t);isNaN(o)||(i=Object.assign(new u.a,{name:e,date:new Date(o).getTime()}));break;default:0}return i},e.shouldReplaceWithUnknownValue=function(e){var t=!0;if(e&&!(t=!e.length)){var n=e.toLowerCase();t="notdefined"===n||"unknown"===n}return t},e.sanitizeValues=function(t,n,i){e.shouldReplaceWithUnknownValue(t.val)&&(t.val=e.unknownValueString),e.shouldReplaceWithUnknownValue(n.val)&&(n.val=e.unknownValueString),e.shouldReplaceWithUnknownValue(i.val)&&(i.val=e.unknownValueString)},e.sanitizeValue=function(t){e.shouldReplaceWithUnknownValue(t.val)&&(t.val=e.unknownValueString)},e.createUserActionCustomData=function(t,n,i,r,a,o,s,l,c){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=null),e.createUserActionEvent(t,n,i,r,e.dictionaryToDataFields(a),o,s,l,c)},e.createUserActionEvent=function(t,n,i,r,o,s,l,c,u){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=null),void 0===u&&(u=null),e.sanitizeValues(Object(a.a)((function(){return n}),(function(e){return n=e})),Object(a.a)((function(){return i}),(function(e){return i=e})),Object(a.a)((function(){return r}),(function(e){return r=e}))),Object.assign(new d,{actionName:t,parentName:n,triggerMethod:i,commandSurface:r,dataFields:o,actionId:s,timeOffsetMs:l,succeeded:c,durationMs:u})},e.createActivityEvent=function(e,t,n,i){return Object.assign(new c.a,{name:e,succeeded:t,durationMs:n,dataFields:i})},e.createNonUserAction=function(t,n,i,r,l,d,p,h){e.sanitizeValue(Object(a.a)((function(){return i}),(function(e){return i=e})));var m=[Object.assign(new u.a,{name:"ActionName",string:t}),Object.assign(new u.a,{name:"CommandSurface",string:o.a[l]}),Object.assign(new u.a,{name:"ParentName",string:i}),Object.assign(new u.a,{name:"TriggerMethod",string:s.a[r]}),Object.assign(new u.a,{name:"StartTime",double:d}),Object.assign(new u.a,{name:"EndTime",double:p}),Object.assign(new u.a,{name:"Succeeded",bool:n})];return m.push.apply(m,e.dictionaryToDataFields(h)),Object.assign(new c.a,{name:t&&t.length>0?e.getOtelNonUserActionEventTablePrefix()+t:e.getOtelNonUserActionEventTableName(),durationMs:p-d>0?p-d:0,dataFields:m})},e.shouldRegisterOtelListener=function(t){var i=n(1).AFrameworkApplication;return!!i.appSettingsManager&&i.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled")&&e.isUserActionLoggingToOtelEnabled(t)},e.oldActionsPipelineIsEnabled=function(){var t=n(1).AFrameworkApplication;return e.oldActionsPipelineStatusIsEnabled||(e.oldActionsPipelineStatusIsEnabled=t.appSettingsManager.getBooleanAppSetting("OldPipelineActionLoggingDisabled")?1:2,1===e.oldActionsPipelineStatusIsEnabled&&l.ULS.sendTraceTag(51140033,383,15,"OldPipelineActionLoggingDisabled is true, actions / bSqm actions will not be logged.")),2===e.oldActionsPipelineStatusIsEnabled},t=e,h=[{key:"MAX_SAFE_INTEGER",get:function(){return 9007199254740991}}],(i=null)&&p(t.prototype,i),h&&p(t,h),e}();h.unknownValueString="",h.logSessionStartAndEndDataFromClientToOTelIsEnabled=0,h.userActionLoggingToOtelIsEnabled=0,h.oldActionsPipelineStatusIsEnabled=0,Object(i.a)(h,"OtelUtils",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(283),a=n(170),o=function(){this.duration=0,this.taskCompletionSourceObject=new a.a};Object(i.a)(o,"TaskCompletionObjectWithDuration",null,[]);n(9);var s=n(113),l=n(89),c=n(39),u=n(60);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(e){var t,n,i,r,a;function o(t){var n;return(n=e.call(this)||this)._taskManager=t,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.prototype.queueTask=function(e){var t=this;this._taskManager.addTask(new c.a(2,1,0,(function(n){t.tryExecuteTask(e)}),78))},i=o,a=[{key:"instance",get:function(){return o._singletonInstance||(o._singletonInstance=new o(u.a.instance))}}],(r=null)&&d(i.prototype,r),a&&d(i,a),o}(l.a);p._singletonInstance=null,Object(i.a)(p,"TaskManagerExecutionScheduler",l.a,[]);var h=n(16),m=n(3),g=n(245);var f=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(g.a);Object(i.a)(f,"EnumDictionary",g.a,[]);var v=n(165);n.d(t,"a",(function(){return _}));var _=function(){function e(e){this._appCtorStarted=!1,this._taskScheduler=e,this._appStateTasks=new f,this._appStateTasks.add(1,new o),this._appStateTasks.add(2,new o),this._appStateTasks.add(3,new o),this._appStateTasks.add(4,new o),this._appStateTasks.add(5,new o),this._appStateTasks.add(6,new o),this._appStateTasks.add(7,new o),this._appStateTasks.add(8,new o),this._appStateTasks.add(9,new o),this._appStateTasks.add(10,new o),this._appStateTasks.add(11,new o),this._appStateTasks.add(12,new o),this._appStateTasks.add(13,new o),this._appStateTasks.add(14,new o),this._appStateTasks.add(15,new o),this._appStateTasks.add(16,new o),this._appStateTasks.add(17,new o)}var t=e.prototype;return t.getInitStatusName=function(e){return e.toString()},t.setAppInitializationStatus=function(e){m.ULS.sendTraceTag(20025679,306,50,"SetAppInitializationStatus: {0}",r.a[e]),s.a.instance.addMetric("AppInitStatus_"+r.a[e],(new Date).getTime());try{window.performance&&window.performance.mark&&(window.performance.mark(this.getInitStatusName(e)),1===e&&(this._appCtorStarted=!0),this._appCtorStarted&&1!==e&&window.performance.measure(this.getInitStatusName(e),this.getInitStatusName(1),this.getInitStatusName(e)))}catch(e){}this._appStateTasks.get_item(e).taskCompletionSourceObject.setResult(!0)},t.clearAppInitializationStatus=function(e){this._appStateTasks.set_item(e,new o)},t.isCompleted=function(e){return this._appStateTasks.get_item(e).taskCompletionSourceObject.get_task().get_isCompleted()},t.durationTakenToExecuteTasksAtState=function(e){return this._appStateTasks.get_item(e).duration},t.executeWhen=function(e,t,n){var i=this;return void 0===n&&(n=3),this._appStateTasks.get_item(e).taskCompletionSourceObject.get_task().CWCT((function(n){var r=h.a.getTickCount();t&&t();var a,o=h.a.getTickCount()-r;(a=i._appStateTasks.get_item(e)).duration=a.duration+o}),v.a.get_none(),n,this._taskScheduler)},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=new e(p.instance))},e}();_._singletonInstance=null,Object(i.a)(_,"AppLifecycleManager",null,[16])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(11),o=n(112),s=n(63),l=n(67),c=(n(9),function(e,t,n){this.packageInstanceInstance=e,this.status=t,this.appStatusForInitialization=n});Object(i.a)(c,"PackageRegistration",null,[]);var u=n(39),d=n(117),p=n(35),h=n(8),m=n(3);function g(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return _}));var _=function(){function e(e,t,i){var a=this;this._packages=new o.a,this._taskSet=!1,this._retriedTask=!1,this._pendingOnInitCallbacks={},this._readyToInit=!1,this._readyToConfigure=!1,this._container=null,this._registerAfterCookieConsent=new s.a,this._isContainerTelemetryLogged=!1;var l=n(1).AFrameworkApplication;this._appLifecycleManager=e,this._isSettingEnabledFunc=t,this._cookieCompliance=i,i.add_onConsentReceived(Object(r.d)(this,this.onCookieConsentReceived,"onCookieConsentReceived")),l.subscribeToBeforeAppShutDown((function(e,t){a.logContainerTelemetry()}))}var t,i,f,_=e.prototype;return _.registerActions=function(e){e.addActionWithFlags(h.a.queryPackageInitialized,p.a.frame,Object(r.d)(this,this.queryPackageInitialized,"queryPackageInitialized"),96)},_.queryPackageInitialized=function(e,t,n,i,r){return this.callQueryPackageInitialized(r)},_.callQueryPackageInitialized=function(e){return this._readyToInit&&this._packages.tryGetValue(e,Object(a.a)((function(){return t}),(function(e){return t=e})))&&t.status>=3?32:2;var t},_.registerPackage=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1);var i=new c(e,0,t);n&&this._cookieCompliance.isConsentNeeded?this._registerAfterCookieConsent.add(i):this.registerPackageInternal(i)},_.registerPackageInternal=function(e){var t=e.packageInstanceInstance;this._packages.containsKey(t.name)?m.ULS.sendTraceTag(40722710,306,10,"Package name '{0}' was already registered with the PackageLifecycleManager",t.name):(this._packages.set_item(t.name,e),this._isSettingEnabledFunc("InitializePackagesInTask")?this._readyToConfigure&&!this._taskSet&&this.scheduleTask():(this._readyToConfigure&&this.configurePackage(t),this._readyToInit&&this.initializePackage(t)))},_.onCookieConsentReceived=function(){for(var e,t=g(this._registerAfterCookieConsent);!(e=t()).done;){var n=e.value;this.registerPackageInternal(n)}this._registerAfterCookieConsent.clear()},_.scheduleTask=function(){var e=this,t=n(1).AFrameworkApplication,i=new u.a(2,1,0,(function(t){if(!e._readyToConfigure||!e._readyToInit)return m.ULS.shipAssertTag(6350740,324,!1),void(e._retriedTask||(e._retriedTask=!0,e.scheduleTask()));e._taskSet=!1,e.notifyReadyToConfigure(e._container),e.notifyReadyToInit()}),95);t.theTaskManager.addTask(i),this._taskSet=!0},_.notifyReadyToConfigure=function(e){this._readyToConfigure=!0,this._container=e;for(var t,n=g(this._packages);!(t=n()).done;){var i=t.value;i.get_value().status||this.configurePackage(i.get_value().packageInstanceInstance)}},_.configurePackage=function(e){var t=this._packages.get_item(e.name);m.ULS.shipAssertTag(6575509,306,!!t&&!t.status,e.name),e.configure(this._container),t.status=1},_.registerOnPackageInit=function(e,t){this._readyToInit&&this._packages.containsKey(e)&&3===this._packages.get_item(e).status?t():this._pendingOnInitCallbacks[e]=t},_.notifyReadyToInit=function(){this._readyToInit=!0;for(var e,t=g(this._packages);!(e=t()).done;){var n=e.value;if(this._isSettingEnabledFunc("InitializePackagesInTask")){if(!n.get_value().status){this._taskSet||this.scheduleTask();continue}}else 0;n.get_value().status<2&&this.initializePackage(n.get_value().packageInstanceInstance)}},_.initializePackage=function(e){var t=this,n=this._packages.get_item(e.name);m.ULS.shipAssertTag(6575511,306,!!n&&n.status<3,e.name);var i=function(){(e.init(),n.status=3,e.name in t._pendingOnInitCallbacks)&&(0,t._pendingOnInitCallbacks[e.name])()};n.appStatusForInitialization&&this._isSettingEnabledFunc("Box4DelayedPackageInitEnabled")?(n.status=2,this._appLifecycleManager.executeWhen(n.appStatusForInitialization,i)):i()},_.tryInitializePackage=function(e){var t;if(this._packages.tryGetValue(e,Object(a.a)((function(){return t}),(function(e){return t=e})))){if(t.status<2)return this.initializePackage(t.packageInstanceInstance),!0;if(3===t.status)return!0}return m.ULS.sendTraceTag(40489671,306,15,"Failed to initialize {0} package.",e),!1},_.dispose=function(){for(var e,t=g(this._packages);!(e=t()).done;){var n=e.value;3===n.get_value().status&&(n.get_value().packageInstanceInstance.dispose(),n.get_value().status=4)}},_.logContainerTelemetry=function(){if(!!this._container&&!!n(1).AFrameworkApplication.appSettingsManager&&n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ContainerTelemetryIsEnabled")&&!this._isContainerTelemetryLogged){for(var t=this._container.getContainerLog(),i=e.zeroPad(Math.ceil(t.length/3e3).toString(),3),r=1;t.length>0;r++)m.ULS.sendTraceTag(592041543,324,50,"Chunk {0} of {1} ContainerTelemetry: {2}",e.zeroPad(r.toString(),3),i,t.substr(0,3e3)),t=t.substr(3e3);this._isContainerTelemetryLogged=!0}},e.zeroPad=function(e,t){for(var n="",i=e.length;i<t;i++)n+="0";return n+e},t=e,f=[{key:"instance",get:function(){return e._singletonInstance||(e._singletonInstance=new e(l.a.get_instance(),(function(e){var t=n(1).AFrameworkApplication;return!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting(e)}),d.a.instance))}}],(i=null)&&v(t.prototype,i),f&&v(t,f),e}();_._singletonInstance=null,Object(i.a)(_,"PackageLifecycleManager",null,[9])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){}var t,n,i;return e.start=function(){e._outputElement||(e._outputElement=document.getElementById("perf-markers"),e._outputElement||(e._outputElement=document.createElement("div"),e._outputElement.id="perf-markers",e._outputElement.style.display="none",document.body.appendChild(e._outputElement)),e.mark(1),e.mark(4808),e.mark(4809))},e.isStarted=function(){return!!e._outputElement},e.stop=function(){e.mark(4807),e._outputElement=null},e.msWriteProfilerMark=function(e){window.self.msWriteProfilerMark&&window.self.msWriteProfilerMark(e)},e.mark=function(t){if(e._outputElement){var n=(new Date).format("MM/dd/yyyy HH:mm:ss.fffffff");e.exportToPerfMetricsDiv(t,n),e.browserSupportsPerformanceMark&&window.performance.mark(t.toString())}},e.exportToPerfMetricsDiv=function(t,n){if(e._outputElement){var i=document.createElement("p"),r=document.createElement("span");r.className="time",r.innerText=n,i.appendChild(r);var a=document.createTextNode(" - ");i.appendChild(a);var o=document.createElement("span");o.className="marker",o.innerText=t.toString(),i.appendChild(o),e._outputElement.appendChild(i),e.msWriteProfilerMark(""+t)}},t=e,i=[{key:"browserSupportsPerformanceMark",get:function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.mark||null===window.performance.mark)}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();a._outputElement=null,Object(i.a)(a,"PerfMetrics",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(11),o=n(170),s=n(67),l=function(e,t){var n;void 0===t&&(t=null);var i=t?((n={}).detail=t,n):{},r=new CustomEvent(e,i);window.dispatchEvent(r)},c=function(e,t,n){void 0!==e.addEventListener&&null!==e.addEventListener&&e.addEventListener(t,n,!1)},u=(n(9),n(54),n(85)),d=n(97),p=n(30),h=n(113),m=n(79),g=n(33),f=function(){};f.appMetricReported="WacAppMetricReported",f.bootKpiMetricsReported="WacBootKpiMetricsReported",Object(i.a)(f,"WacCustomEvents",null,[]);var v=n(10),_=n(76),y=n(122),b=n(3),S=n(46);function C(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return w}));var w=function(){function e(e){this._timestampBaseline=Number.MAX_VALUE,this._timestamps={},this._datapoints={},this._bootKpiMetrics={},this._wsaClient=null,this._isAppInteractive=!1,this._appIsInteractiveTask=new o.a,this.isContentDisplayTimeAlreadySet=!1,this.hasQueuedStopVisibilityMetrics=!1,this.userSessionId=null,this._isRealContentDisplayedForBoot=!1,this._pageLoadPerfRecorder=e,this.addReportKpiMetricsEventListener()}var t,i,A,w=e.prototype;return w.initWsaClient=function(e){if(this._wsaClient=e,this._timestampBaseline<Number.MAX_VALUE){this.updateBaseline(this._timestampBaseline);var t=this._datapoints;for(var n in t){var i={key:n,value:t[n]},r=Number.parseInvariant(i.key);this._wsaClient.setDw(r,i.value)}}},w.recordResourceDownloadStart=function(){var t=window.g_firstByte;if(null!=t){var n=t.getTime();this.recordTimestamp(e.DATAID_BSQM_RESOURCEDOWNLOADSTART,n),this._pageLoadPerfRecorder.addMetric(p.a.resourceDownloadStart,n)}},w.recordResourceDownloadEnd=function(){var t=window.g_jsLT,n=window.g_afterJs,i=null!=t?t.getTime():0,r=null!=n?n.getTime():0,a=Math.max(i,r);if(a>0){var o=i>r?"g_jsLT":"g_afterJs";this.measureMarks(p.a.resourceDownload,"g_firstByte",o),this.recordTimestamp(e.DATAID_BSQM_RESOURCEDOWNLOADEND,a),this._pageLoadPerfRecorder.addDurationMetric(p.a.resourceDownloadStart,p.a.resourceDownloadDuration,a)}},w.recordPaintTimings=function(){if(e.browserSupportsPerformanceTiming&&e.browserSupportsPerformanceGetEntriesByType)for(var t,n=C(window.performance.getEntriesByType("paint"));!(t=n()).done;){var i=t.value;switch(i.name){case"first-paint":this._pageLoadPerfRecorder.addMetric(p.a.firstPaint,i.startTime);break;case"first-contentful-paint":this._pageLoadPerfRecorder.addMetric(p.a.firstContentfulPaint,i.startTime)}}},w.recordBootResourceTimings=function(){var t=n(1).AFrameworkApplication;if(e.browserSupportsPerformanceTiming&&e.browserSupportsPerformanceGetEntriesByType){for(var i,r=window.performance.getEntriesByType("resource"),a=window.performance.timing.navigationStart,o=0,s=0,l=!1,c=C(r);!(i=c()).done;){var u=i.value;"script"!==u.initiatorType&&"link"!==u.initiatorType||(a+u.startTime>t.bootTime||(l?(u.startTime<o&&(o=u.startTime),u.responseEnd>s&&(s=u.responseEnd)):(o=u.startTime,s=u.responseEnd,l=!0)))}if(l){this._pageLoadPerfRecorder.addMetric(p.a.bootResourceStart,o),this._pageLoadPerfRecorder.addMetric(p.a.bootResourceForContentEditableEnd,s);var d=window.g_bootScriptsStartTime;if(null!=d){var h=d.getTime();this._pageLoadPerfRecorder.addMetric(p.a.bootResourceForContentViewableStart,h)}var m=window.g_bootScriptsEndTime;if(null!=m){var g=m.getTime();this._pageLoadPerfRecorder.addMetric(p.a.bootResourceForContentViewableEnd,g)}}}},w.addMark=function(t){e.browserSupportsPerformanceMarkAndMeasure&&window.performance.mark(t)},w.measureMarks=function(t,n,i,r){void 0===r&&(r=!1);var a=null;if(e.browserSupportsPerformanceMarkAndMeasure)try{window.performance.measure(t,n,i),r&&(a=window.performance.getEntriesByName(t,"measure"))}catch(e){}return a},w.recordContentFetchStart=function(t){this.recordTimestamp(e.DATAID_BSQM_CONTENTFETCHSTART,t)},w.recordContentFetchEnd=function(t){this.recordTimestamp(e.DATAID_BSQM_CONTENTFETCHEND,t)},w.recordContentToModelConversion=function(){this.recordTimestamp(e.DATAID_BSQM_CONTENTTOMODELCONVERSIONEND,(new Date).getTime())},w.recordAppInitStart=function(t){this.recordTimestamp(e.DATAID_BSQM_APPINITCODESTART,t),this._pageLoadPerfRecorder.addMetric(p.a.appInitStart,t)},w.recordAppInitEnd=function(){var t=(new Date).getTime();this.addMark(p.a.appInitDuration),this.measureMarks(p.a.appInit,p.a.appInitStart,p.a.appInitDuration),this.recordTimestamp(e.DATAID_BSQM_APPINITCODEEND,t),this._pageLoadPerfRecorder.addDurationMetric(p.a.appInitStart,p.a.appInitDuration,t)},w.recordDocumentLoadedTime=function(e){this._pageLoadPerfRecorder.addMetric(p.a.documentLoadedTime,e),this.dispatchAppMetricReportedEvent(p.a.documentLoadedTime,e)},w.recordOfficeFrameRequestStart=function(){void 0!==window.performance&&null!==window.performance&&void 0!==window.performance.timing&&null!==window.performance.timing&&this._pageLoadPerfRecorder.addMetric(p.a.frameRequestStart,window.performance.timing.requestStart)},w.recordSplashScreenShown=function(){this.sendBeaconForBootPhase("SplashScreenShown"),this.postBootState("SplashScreenShown");var t=window.g_cssLT,n=window.__startTime,i=window.g_splashScreenShown,r=null!=i?i.getTime():Math.max(null!=t?t.getTime():0,null!=n?n.getTime():0);r>0&&(this.recordTimestamp(e.DATAID_BSQM_SPLASHSCREENSHOWN,r),this._pageLoadPerfRecorder.addMetric(p.a.splashScreenShown,r))},w.recordContentViewableHiddenSSR=function(e){this._pageLoadPerfRecorder.addMetric(p.a.contentViewableHiddenSSR,e)},w.recordFastViewEntryPoint=function(e){this._pageLoadPerfRecorder.addMetric(p.a.fastViewEntryPoint,e)},w.recordContentDisplayed=function(e){this.sendBeaconForBootPhase("RecordContentDisplayed"),this.postBootState("ContentDisplayed"),this.recordContentDisplayedAfterBeaconSent(e)},w.recordPerceivedContentDisplayed=function(e){this.recordContentDisplayedAfterBeaconSent(e,!1)},w.recordContentDisplayedAfterBeaconSent=function(t,n){if(void 0===n&&(n=!0),this._isAppInteractive&&n){var i=this.getSessionStartInfo();e.logBootFinished(this.userSessionId,i),this.logBootstrapperMetrics(i)}this._isRealContentDisplayedForBoot=n,this.isContentDisplayTimeAlreadySet||(this.recordTimestamp(e.DATAID_BSQM_CONTENTDISPLAYED,t),this._pageLoadPerfRecorder.addMetric(p.a.contentViewable,t),this.isContentDisplayTimeAlreadySet=!0,this.dispatchAppMetricReportedEvent(p.a.contentViewable,t))},w.recordInteractivityContentDisplayed=function(t){this.recordDatapoint(e.DATAID_BSQM_INTERACTIVITYCONTENTDISPLAYED,t)},w.recordAppInteractive=function(e){this.sendBeaconForBootPhase("RecordAppInteractive"),this.postBootState("AppInteractive"),this.recordAppInteractiveAfterBeaconSent(e)},w.recordAppInteractiveAfterBeaconSent=function(t){var i=n(1).AFrameworkApplication;if(this.isRealContentDisplayedForBoot){var r=this.getSessionStartInfo();e.logBootFinished(this.userSessionId,r),this.logBootstrapperMetrics(r)}this._isAppInteractive=!0,this._appIsInteractiveTask.setResult(!0),this.recordTimestamp(e.DATAID_BSQM_APPINTERACTIVE,t),i.appSettingsManager&&i.appSettingsManager.getBooleanAppSetting("WacPerfObserverEntriesIsEnabled")&&(this.addStableInteractiveEventListener(),this.dispatchAppInteractiveEvent(),this.dispatchAppMetricReportedEvent(p.a.contentEditable,t)),this.addAppLoadMetricReportEventListener(),this._pageLoadPerfRecorder.addMetric(p.a.contentEditable,t)},w.recordUserClickedInHostUi=function(t){this._pageLoadPerfRecorder.addMetric(p.a.userClickedHostUI,t),this.recordTimestamp(e.DATAID_BSQM_USERCLICKEDHOSTUI,t)},w.recordWacIframeGeneratedInHost=function(t){this.recordTimestamp(e.DATAID_BSQM_HOSTIFRAMEGENERATED,t)},w.recordHostPageFetchStart=function(t){this._pageLoadPerfRecorder.addMetric(p.a.hostPageFetchStart,t),this.recordTimestamp(e.DATAID_BSQM_HOSTPAGEFETCHSTART,t)},w.recordHostPageRedirectCount=function(t){var n=e.DATAID_BSQM_HOSTPAGEREDIRECTCOUNT;this.recordDatapoint(n,t)},w.recordEditClickedInWebApp=function(t){this.recordTimestamp(e.DATAID_BSQM_EDITINWEBAPPCLICKED,t)},w.recordViewClickedInWebApp=function(t){this.recordTimestamp(e.DATAID_BSQM_VIEWINWEBAPPCLICKED,t)},w.recordBrowserFetchStart=function(t){this.recordTimestamp(e.DATAID_BSQM_BROWSERFETCHSTART,t)},w.recordBrowserNavigationStart=function(t){this.recordTimestamp(e.DATAID_BSQM_BROWSERNAVIGATIONSTART,t)},w.recordWacRenderTimeFromBrowserFetchStart=function(e){var t;this.tryGetBrowserFetchStart(Object(a.a)((function(){return t}),(function(e){return t=e})))&&this.recordWacRenderTime(e-t),this.recordLegacyWacRenderTimeIfNeeded()},w.recordWacRenderTime=function(t){this.recordDatapoint(e.DATAID_BSQM_WACRENDERTIME,t)},w.recordLegacyWacRenderTimeIfNeeded=function(){n(1).AFrameworkApplication.reportRenderTime(null,!e.browserSupportsPerformanceTiming)},w.recordWindowVisibilityMetrics=function(e){void 0===e&&(e=null);var t=0;if(e||(e=this.getWindowVisibilityMetricsModule()),!e)return b.ULS.sendTraceTag(21307853,326,10,"visibilitymetrics module not found"),t;var n=e.metrics;if(!n)return b.ULS.sendTraceTag(21307854,326,10,"visibilitymetrics lookup failed"),t;b.ULS.sendTraceTag(21307855,326,50,"WindowVisibilityMetrics: {0}",n);var i=this.getVisibilityToggledTime(n);if(i){var r;t=i.getTime();var a=((r={}).VisiToggled=t,r);this._pageLoadPerfRecorder.addMetrics(p.a.userActions,a)}return this.hasQueuedStopVisibilityMetrics||(this.hasQueuedStopVisibilityMetrics=!0,s.a.get_instance().executeWhen(8,(function(){e.stop()}))),t},w.recordNewFileMetrics=function(e,t,n){if(this._pageLoadPerfRecorder.addMetric(p.a.isNewFile,e),e){var i=t||"blank",r=n||"";this._pageLoadPerfRecorder.addMetric(p.a.newFileTemplateName,i.toUpperCase()),this._pageLoadPerfRecorder.addMetric(p.a.newFileTemplateLcid,r)}},w.recordHostInitDiagnostics=function(e){this._pageLoadPerfRecorder.addMetrics(p.a.hostInitDiagnostics,e)},w.recordJsApiDiagnostics=function(e){this._pageLoadPerfRecorder.addMetric(p.a.jsApiDiagnostics,e)},w.tryGetBrowserFetchStart=function(t){return t.val=0,!!e.browserSupportsPerformanceTiming&&(t.val=window.performance.timing.fetchStart>0?window.performance.timing.fetchStart:window.performance.timing.navigationStart,!0)},w.recordTimestamp=function(e,t){e.toString()in this._timestamps&&b.ULS.sendTraceTag(3515215,306,15,"Timestamp recorded twice: "+e),this._timestamps[e.toString()]=t,t<this._timestampBaseline?this.updateBaseline(t):this._wsaClient&&this._wsaClient.setDw(e,t-this._timestampBaseline)},w.updateBaseline=function(t){if(this._timestampBaseline=t,this._wsaClient){this._wsaClient.setDw(e.DATAID_BSQM_TIMESTAMPBASELINEHIGH,Math.floor(t/4294967296)),this._wsaClient.setDw(e.DATAID_BSQM_TIMESTAMPBASELINELOW,t%4294967296);var n=this._timestamps;for(var i in n){var r={key:i,value:n[i]},a=Number.parseInvariant(r.key),o=r.value-this._timestampBaseline;this._wsaClient.setDw(a,o)}}},w.recordDatapoint=function(e,t){this._wsaClient?this._wsaClient.setDw(e,t):this._datapoints[e.toString()]=t},w.logBootstrapperMetrics=function(e){e&&(this._pageLoadPerfRecorder.addMetric(p.a.isJsApi,e.IsJsApi||""),this._pageLoadPerfRecorder.addMetric(p.a.bootstrapper,e.Bootstrapper||""))},w.getSessionStartInfo=function(){var e=n(1).AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson;return e?g.b(e.toString()):{}},w.dispatchAppInteractiveEvent=function(){v.a.browserSupportsCustomEvent()&&l("WacAppInteractive")},w.dispatchAppMetricReportedEvent=function(e,t){var n;if(v.a.browserSupportsCustomEvent()){var i=((n={}).metric=e,n.value=t,n);l(f.appMetricReported,i)}},w.addAppLoadMetricReportEventListener=function(){c(window,"Wac-AppLoadMetricReport",Object(r.d)(this,this.recordAppLoadMetricReportInActivity,"recordAppLoadMetricReportInActivity"))},w.recordAppLoadMetricReportInActivity=function(e){var t=n(1).AFrameworkApplication;if(t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("RumShepherdIsEnabled")){var i=e.detail,r=i.timeOrigin;this.recordAppLoadMetric(i,r);try{if(i.auxMetrics)for(var a=i.auxMetrics,o=0;o<a.length;o++)this.recordAppLoadMetric(a[o],r)}catch(e){b.ULS.sendTraceTag(587560797,306,15,"RecordAppLoadMetricReportInActivity error: "+e.toString())}}},w.recordAppLoadMetric=function(e,t){if(e)try{var n=e.metric.toString(),i=e.time,r=[Object.assign(new S.a,{name:"metric",string:n}),Object.assign(new S.a,{name:"monitor",string:e.monitor?e.monitor.toString():""}),Object.assign(new S.a,{name:"error",string:e.error?e.error.toString():""}),Object.assign(new S.a,{name:"clickTime",double:this._pageLoadPerfRecorder.containsMetric(p.a.userClickedHostUI)?this._pageLoadPerfRecorder.getMetric(p.a.userClickedHostUI):0}),Object.assign(new S.a,{name:"timeOrigin",double:t}),Object.assign(new S.a,{name:"time",double:i})];if(e.measures){var a=e.measures;for(var o in a){var s={key:o,value:a[o]};Array.add(r,Object.assign(new S.a,{name:s.key,double:s.value?s.value:0}))}}if("stable-interactivity"===n&&(Array.add(r,Object.assign(new S.a,{name:p.a.contentViewable,double:this._pageLoadPerfRecorder.containsMetric(p.a.contentViewable)?this._pageLoadPerfRecorder.getMetric(p.a.contentViewable):0})),Array.add(r,Object.assign(new S.a,{name:p.a.contentEditable,double:this._pageLoadPerfRecorder.containsMetric(p.a.contentEditable)?this._pageLoadPerfRecorder.getMetric(p.a.contentEditable):0}))),e.data){var l=e.data;for(var c in l){var u={key:c,value:l[c]};Array.add(r,Object.assign(new S.a,{name:u.key,string:u.value?u.value.toString():""}))}}for(var h=n.split("-"),m="AppLoadMetric",g=0;g<h.length;g++)m+=h[g].substring(0,1).toUpperCase()+h[g].substring(1,h[g].length);d.b(m,i,1,!e.error,0,r)}catch(e){b.ULS.sendTraceTag(577843343,306,15,"RecordAppLoadMetric error: "+e.toString())}},w.addStableInteractiveEventListener=function(){c(window,"WacStableInteractive",Object(r.d)(this,this.recordPerfObserverMetricsInKpi,"recordPerfObserverMetricsInKpi"))},w.addReportKpiMetricsEventListener=function(){var e=this;c(window,f.bootKpiMetricsReported,(function(t){var i=n(1).AFrameworkApplication;if(i.appSettingsManager&&i.appSettingsManager.getBooleanAppSetting("WacPerfObserverEntriesIsEnabled")&&t.detail){var r=t.detail.metrics,a=t.detail.kpiName;if(a){a in e._bootKpiMetrics||(e._bootKpiMetrics[a]={});var o=e._bootKpiMetrics[a];for(var s in r){var l={key:s,value:r[s]};o[l.key]=l.value}}}}))},w.recordPerfObserverMetricsInKpi=function(t){var i=n(1).AFrameworkApplication;if(i.appSettingsManager&&i.appSettingsManager.getBooleanAppSetting("WacPerfObserverEntriesIsEnabled")){var r=window.wacPerfObserver;if(_.g(r))b.ULS.sendTraceTag(592734347,306,15,"wacPerfObserver entries is null or empty");else{e.reportPerfMetricsInKpi("PerfObserver",r);var a=this._bootKpiMetrics;for(var o in a){var s={key:o,value:a[o]};e.reportPerfMetricsInKpi(s.key,s.value)}}}},w.sendBeaconForBootPhase=function(e){"undefined"!=typeof _bB&&"function"==typeof _bB.sendBeacon&&_bB.sendBeacon(e,"BootPhaseCompleted")},w.postBootState=function(e){try{"undefined"!=typeof _bB&&"function"==typeof _bB.postBootState&&_bB.postBootState(e)}catch(e){0}},w.getWindowVisibilityMetricsModule=function(){return window.self.WindowVisibilityMetrics},w.getVisibilityToggledTime=function(e){if("hidden"===e.initialVisibility)return e.initializeTime;var t=e.events;return t&&t.length>0?t[0].time:null},e.logBootFinished=function(e,t){void 0===t&&(t=null);var i=n(1).AFrameworkApplication,r={};r.UserSessionId=e;try{if(!t){if(!i.appSettingsManager.appSettings.SessionStartInfoJson)return void b.ULS.sendTraceTag(36718624,306,10,"PerfReporting.LogBootFinished: SessionStartInfoJson is null");t=g.b(i.appSettingsManager.appSettings.SessionStartInfoJson.toString())}r.Application=t.Application||"",r.ApplicationModeExtended=t.ApplicationModeExtended||"",r.UserSessionApplicationMode=t.UserSessionApplicationMode||"",r.ApplicationVersion=t.ApplicationVersion||"",r.Browser=t.Browser||"",r.BrowserMajorVersion=t.BrowserMajorVersion||"",r.Host=t.Host||"",r.IsSynthetic=t.IsSynthetic||"",r.Ring=t.Ring||"",r.WACDatacenter=t.WACDatacenter||"",r.UiHost=t.UiHost||"",r.UiHostIntegrationType=t.UiHostIntegrationType||"",t.EmbedModes&&(r.EmbedModes=t.EmbedModes);var a=r.Application,o=r.ApplicationModeExtended?r.ApplicationModeExtended.toUpperCase():"";if("Excel"===a&&"UNIFIED"===o){if(b.ULS.sendTraceTag(39933443,306,15,"PerfReporting.LogBootFinished: SessionStarts[ApplicationModeExtended] remained UNIFIED"),i.appSettingsManager.getBooleanAppSetting("ExcelFixupApplicationModeOnBootFinishedAndSessionEnd"))switch(i.activeFrame.mode){case 2:r.ApplicationModeExtended="EDIT";break;case 1:r.ApplicationModeExtended="VIEW";break;default:b.ULS.sendTraceTag(34219405,306,15,"PerfReporting.LogBootFinished: ActiveFrame.Mode is FrameMode.None")}}else if("OneNote"===a&&i.appSettingsManager.getBooleanAppSetting("OneNoteDeviceIdLoggingIsEnabled")){var s=m.a.get("DeviceId")||y.a.create().toString();m.a.setWithExpiration("DeviceId",s,m.a.maxComplianceAllowedRetentionInDays),r.DeviceId=s}}catch(e){var l={Context:"Deserializing SessionStartInfoJson for BootFinished logging"};l.ExceptionMessage=e.message,b.ULS.sendTraceTag(22552780,306,15,"{0}",l)}b.ULS.sendTraceTag(6959176,306,50,"SessionBootFinished: {0}",r),b.ULS.host.flushAsynchronous()},e.reportPerfMetricsInKpi=function(e,t){var n=new Map;for(var i in t){var r={key:i,value:t[i]};try{n.set(r.key,r.value.toString())}catch(e){n.set(r.key,"")}}u.Health.instance.recordKpiUsage(e,0,"wacberf",n)},t=e,A=[{key:"instance",get:function(){return e._instance||(e._instance=new e(h.a.instance))}},{key:"browserSupportsPerformanceMarkAndMeasure",get:function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.mark||null===window.performance.mark||void 0===window.performance.measure||null===window.performance.measure)}},{key:"browserSupportsPerformanceTiming",get:function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.timing||null===window.performance.timing)}},{key:"browserSupportsPerformanceGetEntriesByType",get:function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.getEntriesByType||null===window.performance.getEntriesByType)}}],(i=[{key:"isRealContentDisplayedForBoot",get:function(){return this._isRealContentDisplayedForBoot}},{key:"appIsInteractiveTask",get:function(){return this._appIsInteractiveTask.get_task()}}])&&I(t.prototype,i),A&&I(t,A),e}();w.DATAID_BSQM_TIMESTAMPBASELINEHIGH=11040,w.DATAID_BSQM_TIMESTAMPBASELINELOW=11041,w.DATAID_BSQM_RESOURCEDOWNLOADSTART=11031,w.DATAID_BSQM_RESOURCEDOWNLOADEND=11032,w.DATAID_BSQM_CONTENTFETCHSTART=11033,w.DATAID_BSQM_CONTENTFETCHEND=11034,w.DATAID_BSQM_APPINITCODESTART=11036,w.DATAID_BSQM_APPINITCODEEND=11037,w.DATAID_BSQM_SPLASHSCREENSHOWN=11035,w.DATAID_BSQM_CONTENTDISPLAYED=11038,w.DATAID_BSQM_INTERACTIVITYCONTENTDISPLAYED=11337,w.DATAID_BSQM_APPINTERACTIVE=11039,w.DATAID_BSQM_USERCLICKEDHOSTUI=11028,w.DATAID_BSQM_HOSTIFRAMEGENERATED=11042,w.DATAID_BSQM_EDITINWEBAPPCLICKED=11029,w.DATAID_BSQM_VIEWINWEBAPPCLICKED=11043,w.DATAID_BSQM_BROWSERFETCHSTART=11044,w.DATAID_BSQM_HOSTPAGEFETCHSTART=11221,w.DATAID_BSQM_HOSTPAGEREDIRECTCOUNT=11219,w.DATAID_BSQM_CONTENTTOMODELCONVERSIONEND=11220,w.DATAID_BSQM_WACRENDERTIME=9086,w.DATAID_BSQM_BROWSERNAVIGATIONSTART=11338,w._instance=null,Object(i.a)(w,"PerfReporting",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var i=n(0),r=n(2),a=n(17),o=(n(9),n(54),n(326)),s=n(200),l=n(48),c=n(4),u=n(24),d=n(247),p=n(198),h=n(327),m=n(328),g=n(246),f=n(57),v=n(60),_=n(22),y=n(50),b=n(16),S=n(10);function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var I=function(e){var t,i;function I(){var t;return(t=e.call(this)||this)._capturedHandler=null,t._clickStartedOutsideCanvas=!1,t._lastTouchEventArgs=null,t._inTouchClick=!1,t._eventHandlerManager=l.EventHandlerManager.instance,t._focusManager=u.FocusManager.instance(),l.EventHandlerManager.instance.registerOnBeforeEventProcessed(c.EventNames.msPointerDown,Object(r.d)(A(t),t.onMsPointerDown,"onMsPointerDown")),l.EventHandlerManager.instance.registerOnBeforeEventProcessed(c.EventNames.browserPointerDown,Object(r.d)(A(t),t.onMsPointerDown,"onMsPointerDown")),t}i=e,(t=I).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var w,T,E,k=I.prototype;return k.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(c.EventNames.get_clickEvents(),t,2,Object(r.d)(this,this.onClickEvent,"onClickEvent"))},k.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t,c.EventNames.get_clickEvents())},k.registerHandler=function(e,t,n){this.registerHandlerWithBrowserClickOption(e,t,n,null,!1)},k.registerHandlerWithData=function(e,t,n,i){this.registerHandlerWithBrowserClickOption(e,t,n,i,!1)},k.registerHandlerWithBrowserClickOption=function(e,t,n,i,r){this.registerHandlerWithCaptureOption(e,t,n,i,r,!1)},k.registerHandlerWithCaptureOption=function(e,t,n,i,a,o){void 0===o&&(o=!1),this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onClickEvent,"onClickEvent"),n,i,o),a||(this._eventHandlerManager.initializeForElementInternal(c.EventNames.touchStart,t,2,Object(r.d)(this,this.onTouchEvent,"onTouchEvent"),o),this._eventHandlerManager.initializeForElementInternal(c.EventNames.touchMove,t,2,Object(r.d)(this,this.onTouchEvent,"onTouchEvent"),o),this._eventHandlerManager.initializeForElementInternal(c.EventNames.touchEnd,t,2,Object(r.d)(this,this.onTouchEvent,"onTouchEvent"),o))},k.unregisterHandler=function(e,t,n){this.unregisterHandlerWithBrowserClickOption(e,t,n,!1)},k.unregisterHandlerWithBrowserClickOption=function(e,t,n,i){this.unregisterHandlerWithCaptureOption(e,t,n,i,!1)},k.unregisterHandlerWithCaptureOption=function(e,t,n,i,r){void 0===r&&(r=!1),this._eventHandlerManager.unregisterHandler(e,t,n,r),i||(this._eventHandlerManager.deinitializeForElementInternal(t,c.EventNames.touchStart,r),this._eventHandlerManager.deinitializeForElementInternal(t,c.EventNames.touchMove,r),this._eventHandlerManager.deinitializeForElementInternal(t,c.EventNames.touchEnd,r))},k.registerDefaultHandler=function(e,t,n){for(var i=0;i<c.EventNames.get_clickEvents().length;++i)c.EventNames.isInternalEvent(c.EventNames.get_clickEvents()[i])||this._eventHandlerManager.registerHandler(c.EventNames.get_clickEvents()[i],e,3,Object(r.d)(this,this.onClickEvent,"onClickEvent"),t,n)},k.unregisterDefaultHandler=function(e,t){for(var n=0;n<c.EventNames.get_clickEvents().length;++n)c.EventNames.isInternalEvent(c.EventNames.get_clickEvents()[n])||this._eventHandlerManager.unregisterHandler(c.EventNames.get_clickEvents()[n],t,e)},k.onClickEvent=function(e,t,n){var i=this.inTouchClick?3:2;S.a.isIPad&&(i=3);var r=o.a.createFromMouseEvent(e,t,null,n,i),a=e===c.EventNames.click,s=e===c.EventNames.doubleClick;return this.processClick(r,a,s)},k.onTouchEvent=function(e,t,i){var r=g.a.create(e,t,null,i),a=h.a.getTouchClickAdapter(t);if(f.a.isOneNoteInkingImprovementsEnabled())return!0;if(f.a.isMultiTouch(i))return a.cancelPendingClick(),!1;if(t.disabled)return!1;var o=new m.a;if(e===c.EventNames.touchStart)a.onTouchStart(r,this._lastTouchEventArgs);else if(e===c.EventNames.touchMove)a.onTouchMove(r);else if(e===c.EventNames.touchEnd){if((o=a.onTouchEnd(r,this._lastTouchEventArgs)).isTouchClick||o.isTouchDoubleClick)this._eventHandlerManager.temporarilyDisableBrowserClicks(),p.TouchAndHoldAdapter.getTouchAndHoldAdapter(r.sourceElement).cancelTouchAndHoldIfNecessary(r),n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SelectWordOnDoubleTapIsEnabled")&&i.rawEvent&&(o.isTouchDoubleClick?this._lastTouchEventArgs=null:this._lastTouchEventArgs=r)}else e===c.EventNames.touchCancel&&a.onTouchCancel(r);if(o.isTouchClick||o.isTouchDoubleClick){this._inTouchClick=!0;var s=this.processClick(o.clickArgs,o.isTouchClick,o.isTouchDoubleClick);return this._inTouchClick=!1,s}return!1},k.onMsPointerDown=function(e){this._inTouchClick=2===d.a(e)},k.processClick=function(e,t,n){if(!this.isEnabled)return!1;if(!_.DomUtils.isValidElement(e.sourceElement))return!1;if(v.a.instance.isYielding)return!1;if(this._supressEvents)return this.cancelClick(e),!0;if(this.clickStartedOutsideCanvas)return this.clickStartedOutsideCanvas=!1,!0;var i=!1;if(this._capturedHandler)return e.userData=this._capturedHandler.userData,(i=this._capturedHandler.handler(e))&&this.cancelClick(e),i;if(n){if(l.EventHandlerManager.instance.isDragging)return this.cancelClick(e),!0;i=this._eventHandlerManager.processEvent(c.EventNames.doubleClick,e.caughtElement,e)}else t&&(this._eventHandlerManager._lastClickEventTime=(new Date).getTime(),i=this._eventHandlerManager.processEvent(c.EventNames.click,e.caughtElement,e));return i&&this.cancelClick(e),i},k.cancelClick=function(e){var t=!0;3===e.inputSource&&b.a.isTextField(e.sourceElement)&&(t=!1),a.a.cancelEventInternal(e.innerEvent,t)},k.capture=function(e,t){this._capturedHandler=new s.a(e,t)},k.releaseCapture=function(){this._capturedHandler=null},k.addFocusEvent=function(e,t,n){var i=this;void 0===n&&(n=!1);var r=function(t){return!t.sourceElement.disabled&&i._focusManager&&i._focusManager.scopeChanged(e),!1};this.registerHandlerWithBrowserClickOption(c.EventNames.click,t,r,null,n),this._focusManager.getScope(e).addDispose((function(){i.unregisterHandler(c.EventNames.click,t,r)}))},I.disposeInputManager=function(){y.a(I._instance),I._instance=null},w=I,E=[{key:"instance",get:function(){return I._instance||(I._instance=new I),I._instance}}],(T=[{key:"inTouchClick",get:function(){return this._inTouchClick}},{key:"clickStartedOutsideCanvas",get:function(){return this._clickStartedOutsideCanvas},set:function(e){this._clickStartedOutsideCanvas=e}}])&&C(w.prototype,T),E&&C(w,E),I}(a.a);I._instance=null,Object(i.a)(I,"ClickInputManager",a.a,[92,13,4])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(45),a=function(){};a.CommandValueId="CommandValueId",a.Description="Description",a.Image16by16Class=r.a.image16by16Class,a.Image30by30Class=r.a.image30by30Class,a.Image32by32Class=r.a.image32by32Class,a.Image48by48Class=r.a.image48by48Class,a.On="On",a.LabelText=r.a.labelText,a.Visible=r.a.visible,a.SourceControlId="SourceControlId",a.DisplayMode="DisplayMode",a.Alt=r.a.alt,Object(i.a)(a,"ToggleButtonCommandProperties",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(17),o=(n(9),n(54),n(200)),s=n(4),l=n(41),c=n(10);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(e){var t,n,i,r,a;function o(t,n,i,r,a,o,s,l,c,u,d,p,h,m){var g;return(g=e.call(this,t,s,m,2)||this)._client=i,g._element=r,g._screen=a,g._caught=l,g._wheel=o,g._button=n,g._shiftKey=c,g._altKey=u,g._ctrlKey=d,g._metaKey=p,g.userData=h,g}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.create=function(e,t,n,i){if(i.rawEvent){var r=i.rawEvent,a=l.EventHandlerArgs.getSourceElement(i),c=new Sys.UI.Point(r.screenX,r.screenY),u=new Sys.UI.Point(r.clientX,r.clientY),d=0;return e===s.EventNames.mouseWheel&&(r.wheelDelta?(d=-r.wheelDelta/120,window.self.opera&&(d*=-1)):d=r.detail/3),new o(e,l.EventHandlerArgs.getMouseButton(r),u,null,c,d,a,t,r.shiftKey,r.altKey,r.ctrlKey,r.metaKey,n,i)}var p=l.EventHandlerArgs.getSourceElement(i),h=new Sys.UI.Point(i.screenX,i.screenY),m=new Sys.UI.Point(i.clientX,i.clientY);return new o(e,i.button,m,null,h,0,p,t,i.shiftKey,i.altKey,i.ctrlKey,!1,n,i)},o.changeUserData=function(e,t){e.userData=t},i=o,(r=[{key:"mouseButton",get:function(){return this._button}},{key:"clientPoint",get:function(){return this._client}},{key:"screenPoint",get:function(){return this._screen}},{key:"elementPoint",get:function(){return this._element||(this._element=l.EventHandlerArgs.getElementPoint(this._client,this.sourceElement)),this._element}},{key:"wheelData",get:function(){return this._wheel}},{key:"caughtElement",get:function(){return this._caught}},{key:"shiftKey",get:function(){return this._shiftKey}},{key:"altKey",get:function(){return this._altKey}},{key:"ctrlKey",get:function(){return this._ctrlKey}},{key:"metaKey",get:function(){return this._metaKey}},{key:"commandKey",get:function(){return c.a.isMac?this._metaKey:this._ctrlKey}}])&&u(i.prototype,r),a&&u(i,a),o}(l.EventHandlerArgs);Object(i.a)(d,"MouseEventArgs",l.EventHandlerArgs,[]);var p=n(60),h=n(22),m=n(50),g=n(3);function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return v}));var v=function(e){var t,i;function l(){var t;t=e.call(this)||this;var i=n(24).FocusManager,r=n(48).EventHandlerManager;return t._supressEvents=!1,t._capturedHandler=null,t._eventHandlerManager=r.instance,t._focusManager=i.instance(),t}i=e,(t=l).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var c,u,v,_=l.prototype;return _.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(s.EventNames.get_mouseEvents(),t,2,Object(r.d)(this,this.onMouseEvent,"onMouseEvent"))},_.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t,s.EventNames.get_mouseEvents())},_.registerHandler=function(e,t,n,i){this.registerHandlerWithCaptureOption(e,t,n,i,!1)},_.registerHandlerWithCaptureOption=function(e,t,n,i,a){void 0===a&&(a=!1),this._eventHandlerManager.registerHandler(e,t,2,Object(r.d)(this,this.onMouseEvent,"onMouseEvent"),n,i,a)},_.unregisterHandler=function(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n,!1)},_.unregisterHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this._eventHandlerManager.unregisterHandler(e,t,n,i)},_.capture=function(e,t){this._capturedHandler=new o.a(e,t)},_.releaseCapture=function(){this._capturedHandler=null},_.onMouseEvent=function(e,t,i){var r=n(24).FocusManager,o=n(1).AFrameworkApplication;if(e!==s.EventNames.click&&e!==s.EventNames.doubleClick&&e!==s.EventNames.mouseWheel||r.instance().tryGrabFocus(o.postmessageFocusId),!this.isEnabled)return!1;if(!h.DomUtils.isValidElement(i.target))return!1;if(p.a.instance.isYielding)return g.ULS.sendTraceTag(24699482,324,50,"Mouse event dropped."),!1;if(e===s.EventNames.mouseMove&&a.a.ensureAppAwakeIfAsleep(),this._supressEvents)return a.a.cancelEvent(i),!0;var l=null,c=!1;return this._capturedHandler?(l=d.create(e,t,this._capturedHandler.userData,i),(c=this._capturedHandler.handler(l))&&a.a.cancelEvent(i),c):(l=d.create(e,t,null,i),(c=this._eventHandlerManager.processEvent(e,t,l))&&a.a.cancelEvent(i),c)},_.addControlFocus=function(e,t,n,i){var r=this;void 0===n&&(n=!1),void 0===i&&(i=!1);var a=function(t){return r._focusManager.tryChangeScopeOnStealingFocusEvent(e,i,n,t),!1};this.registerHandler(s.EventNames.mouseDown,t,a,null),this._focusManager.getScope(e).addDispose((function(){r.unregisterHandler(s.EventNames.mouseDown,t,a)}))},l.disposeInputManager=function(){m.a(l._instance),l._instance=null},l.fireMouseEvent=function(e,t,n,i){var r=l.createMouseEvent(e,t,n,i);t.dispatchEvent?t.dispatchEvent(r):t.fireEvent&&t.fireEvent("on"+e,r)},l.createMouseEvent=function(e,t,n,i){var r=null;if(window.document.createEvent)(r=window.document.createEvent("MouseEvents")).initMouseEvent(e,!0,!0,window.self,0,n.x+Sys.UI.DomElement.getLocation(t).x+window.self.screenX,n.y+Sys.UI.DomElement.getLocation(t).y+window.self.screenY,n.x+Sys.UI.DomElement.getLocation(t).x,n.y+Sys.UI.DomElement.getLocation(t).y,!1,!1,!1,!1,i,null);else if(window.document.createEventObject)switch((r=window.document.createEventObject()).offsetX=n.x,r.offsetY=n.y,r.clientX=n.x+Sys.UI.DomElement.getLocation(t).x,r.clientY=n.y+Sys.UI.DomElement.getLocation(t).y,r.screenX=n.x+Sys.UI.DomElement.getLocation(t).x+window.screenX,r.screenY=n.y+Sys.UI.DomElement.getLocation(t).y+window.screenY,i){case 0:r.button=1;break;case 1:r.button=4;break;case 2:r.button=2}return r},l.isMouseEventName=function(e){return Array.contains(s.EventNames.get_mouseEvents(),e)},c=l,v=[{key:"instance",get:function(){return l._instance||(l._instance=new l),l._instance}}],(u=null)&&f(c.prototype,u),v&&f(c,v),l}(a.a);v.__inputDataName="#m",v._instance=null,Object(i.a)(v,"MouseInputManager",a.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"MenuLauncher",(function(){return u}));var i=n(0),r=n(2),a=n(23),o=n(7),s=n(87),l=(n(161),n(141),n(5));function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(e){var t,i;function a(t,n,i,r){var a;return(a=e.call(this,t,n,i)||this)._isContextMenuDropDown=!1,a.onMenuLaunchCallback=null,a.onMenuCloseCallback=null,a._menu=null,a.elmHadFocus=null,a._cachedMenuVersions=null,a.menu=r,a.menuLaunched=!1,a._sendFocusToMenuDrop=!0,a}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var u,d,p,h=a.prototype;return h.launchMenu=function(e){this.menuLauncherBehavior&&this.menuLauncherBehavior.launchMenu(e)},h.setInitialAriaMenuLauncherAttributes=function(e){o.a.setAriaAttribute(e,o.a.ariaHasPopupAttribute,o.a.ariaTrueValue),this.updateAriaMenuLauncherAttributes(e,!1)},h.updateAriaMenuLauncherAttributes=function(e,t){o.a.setAriaAttribute(e,o.a.ariaExpandedAttribute,t?o.a.ariaTrueValue:o.a.ariaFalseValue)},h.selectDropdownItem=function(e){},h.sendNotifyAsyncMenuTrigger=function(){this.menuLauncherBehavior&&this.menuLauncherBehavior.sendNotifyAsyncMenuTrigger()},h.onKeyDown=function(e){return!!this.menuLauncherBehavior&&this.menuLauncherBehavior.onKeyDown(e)},h.onPointerDown=function(e){return!!this.menuLauncherBehavior&&this.menuLauncherBehavior.onPointerDown(e)},h.getLauncherBounds=function(){return this.menuLauncherBehavior?this.menuLauncherBehavior.getLauncherBounds():new Sys.UI.Bounds(0,0,0,0)},h.closeMenu=function(e){void 0===e&&(e=!0),this.menuLauncherBehavior&&this.menuLauncherBehavior.closeMenu()},h.ensureBehaviorAttachedIfAvailable=function(){e.prototype.ensureBehaviorAttachedIfAvailable.call(this),this.menu&&this.menu.ensureBehaviorAttached()},h.notifyCommandExecuted=function(e,t){},h.refreshMenuCallback=function(){this.refreshMenu()},h.refreshMenu=function(){this.menuLauncherBehavior&&this.menuLauncherBehavior.refreshMenu()},h.ensureCorrectChildType=function(e){if(!Object(r.c)(s.Menu,e))throw Error.create("This Component can only have Menu Components as children.")},h.getCommandPopulateProperties=function(){var e={};return e.MenuId=this.id,e},h.pollForDynamicMenu=function(e){return this.menuLauncherBehavior?this.menuLauncherBehavior.pollForDynamicMenu(e):null},h.populateMenuFromXml=function(e,t){return void 0===t&&(t=!1),!!this.menuLauncherBehavior&&this.menuLauncherBehavior.populateMenuFromXml(e,t)},h.cloneMenu=function(e){var t=n(152).Builder,i=null;return this.menu&&t.shouldBuildMenu(this.properties,this.menu.children.toArray())&&(i=this.menu.clone(e)),i},h.constructClonedMenuLauncherForMenu=function(e,t,n){return this.constructClonedMenuLauncher(e,t,n)},h.constructClonedControl=function(e,t){var n=this.cloneMenu(e);return this.constructClonedMenuLauncher(e,t,n)},h.constructClonedControlForMenu=function(e,t){var n=this.cloneMenu(e);return this.constructClonedMenuLauncherForMenu(e,t,n)},h.dispose=function(){if(e.prototype.dispose.call(this),l.c(this.menu)||this.menu.dispose(),!l.c(this._cachedMenuVersions)){var t=this._cachedMenuVersions;for(var n in t){({key:n,value:t[n]}).value.dispose()}}this.menu=null},u=a,(d=[{key:"sendFocusToMenuDrop",get:function(){return this._sendFocusToMenuDrop}},{key:"needsAKeytip",get:function(){return!0}},{key:"menuLauncherBehavior",get:function(){return this.behavior}},{key:"isFloatieContextMenuDropDown",get:function(){return this._isContextMenuDropDown},set:function(e){this._isContextMenuDropDown=e,l.c(this.menu)||(this.menu.isFloatieContextMenuDropDown=e)}},{key:"menu",get:function(){return this._menu},set:function(e){this._menu=e,l.c(this._menu)||(this._menu.isFloatieContextMenuDropDown=this.isFloatieContextMenuDropDown)}},{key:"launcherComponent",get:function(){return this.displayedComponent}},{key:"launcher",get:function(){return this.getDisplayedComponentElement()}},{key:"menuDirection",get:function(){return 2}},{key:"additionalMenuCssClass",get:function(){return""}},{key:"properties",get:function(){return this.controlProperties}},{key:"cachedMenuVersions",get:function(){return l.c(this._cachedMenuVersions)&&(this._cachedMenuVersions={}),this._cachedMenuVersions}},{key:"focusableElement",get:function(){return this.getDisplayedComponentElement()}}])&&c(u.prototype,d),p&&c(u,p),a}(a.Control);u.menuDroppedClassName="cui-fa-dropped",Object(i.a)(u,"MenuLauncher",a.Control,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(0),r=n(2),a=n(11),o=n(102),s=(n(9),n(58)),l=n(188),c=n(13),u=n(93);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(e){var t,i;function p(t,n,i,r){var a;return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),(a=e.call(this,t,n,i,r)||this)._textElement=null,a._customDialogHandler=null,a._reactDialogHandler=null,a._controlValues=null,a._customCssClass="",a.dialogHtml=null,a.autoSize=!1,a}i=e,(t=p).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var h,m,g,f=p.prototype;return f.baseDialogHandler=function(e){var t=this._controlValues;for(var n in t){var i={key:n,value:t[n]},r=document.getElementById(i.key);r&&(this._controlValues[i.key]=this.getControlValue(r))}this._hideOnButtonClick&&this.hide(),this._customDialogHandler&&this._customDialogHandler(e,this._controlValues),this._hideOnButtonClick&&(this._customDialogHandler=null)},f.reactBaseDialogHandler=function(e,t){this._hideOnButtonClick&&this.hide(),this._customDialogHandler&&this._customDialogHandler(e,t),this._hideOnButtonClick&&(this._customDialogHandler=null)},f.setControlValue=function(e,t){switch(c.a.toLower(e.tagName)){case"input":switch(c.a.toLower(e.type)){case"text":case"hidden":case"password":case"number":e.value=t;break;case"checkbox":case"radio":e.checked=t;break;default:e.innerText=t}break;case"textarea":e.value=t;break;case"select":e.selectedIndex=t;break;case"img":e.src=t;break;default:e.innerText=t}},f.getControlValue=function(e){var t;switch(c.a.toLower(e.tagName)){case"input":switch(c.a.toLower(e.type)){case"text":case"hidden":case"password":t=e.value;break;case"checkbox":case"radio":t=e.checked;break;case"number":t=e.value;break;default:t=e.innerText}break;case"textarea":t=e.value;break;case"select":t=e.selectedIndex;break;case"img":t=e.src;break;default:t=e.innerText}return t},f.setInnerHtml=function(){this._textElement.innerHTML=this.dialogHtml,this.onInnerHtmlSet()},f.setDialogProperties=function(e){this.prepareDialog(),this.sizeAndPositionDialog(),this.setInnerHtml(),this._titleText.innerText=e},f.prepareDialog=function(){e.prototype.prepareDialog.call(this),Sys.UI.DomElement.addCssClass(this._divMessageBox,this._customCssClass);var t=document.createElement("div");t.id=this.myId("WACDialogHtmlPanel"),t.className="WACDialogHtmlPanel",this._body.appendChild(t),this._textElement=document.createElement("div"),this._textElement.id=this.myId("WACDialogText"),t.appendChild(this._textElement)},f.sizeAndPositionDialog=function(){var e=o.a.posTop+(this.getPageHeight()-p._defaultHeight)/2-12,t=o.a.posLeft+(this.getPageWidth()-p._defaultWidth)/2-12;this.sizeAndPositionDialogWorker(e,t)},f.sizeAndPositionDialogWorker=function(e,t){var i=n(1).AFrameworkApplication,r=e,a=t;"DL"!==this._windowMode&&(this._divMessageBox.style.top=(r<0?0:r)+"px"),"DP"!==this._windowMode&&(i.isRtl?this._divMessageBox.style.right=(a<0?0:a)+"px":this._divMessageBox.style.left=(a<0?0:a)+"px"),this._divMessageBox.style.display="Block"},f.onInnerHtmlSet=function(){},f.showDialog=function(e,t){this.initializeAndShow(e,t,null)},f.initializeAndShow=function(e,t,n){this.dialogId=void 0===this.dialogId||null===this.dialogId?l.randomBetween(0,Number.MAX_VALUE).toString():this.dialogId,this._useReactDialog?this.reactInitializeAndShow(e,t,n):this.legacyInitializeAndShow(e,t,n)},f.reactInitializeAndShow=function(e,t,n){this.setupReactCustomDialogControlValues(e,t,Object(a.a)((function(){return n}),(function(e){return n=e}))),this.show(n)},f.legacyInitializeAndShow=function(e,t,n){if(this._messageBoxHandler=Object(r.d)(this,this.baseDialogHandler,"baseDialogHandler"),this._customDialogHandler=t,this._controlValues=n,this.setDialogProperties(e),n)for(var i in n){var a={key:i,value:n[i]},o=document.getElementById(a.key);o&&this.setControlValue(o,a.value)}this.show()},f.updateDialog=function(e,t,n){this._useReactDialog&&this.reactUpdate$3(e,t,n)},f.reactUpdate$3=function(e,t,n){this.setupReactCustomDialogControlValues(e,t,Object(a.a)((function(){return n}),(function(e){return n=e}))),this.update(n)},f.setupReactCustomDialogControlValues=function(e,t,n){void 0!==n.val&&null!==n.val&&(this._customDialogHandler=t,this._reactDialogHandler=Object(r.d)(this,this.reactBaseDialogHandler,"reactBaseDialogHandler"),n.val.headerText=n.val.headerText||e,n.val.type="CustomDialogProps",n.val.id=n.val.id||this.dialogId,n.val.resultHandler=this._reactDialogHandler)},f.dispose=function(){this._textElement=null,e.prototype.dispose.call(this)},f.setFailed=function(e,t){var n=new s.StandardDialog;n.buttonsOption=0,n.showWarning(CommonUIStrings.l_DefaultDialogTitle,e,t)},p.formatHtml=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return String.format.apply(null,[e].concat(u.toArray(u.select(u.asEnumerable(n),c.a.htmlEncode))))},h=p,(m=[{key:"canBePreempted",get:function(){return!0}}])&&d(h.prototype,m),g&&d(h,g),p}(o.a);p._defaultWidth=350,p._defaultHeight=200,Object(i.a)(p,"CustomDialog",o.a,[])},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return m}));var i=n(33);function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var o=function(e){var t=0;for(var n in e){e[n];t++}return t},s=function(e,t){for(var n in e){var i={key:n,value:e[n]};if(t(i.key,i.value))return!0}return!1},l=function(e){return!e||c(e)},c=function(e){for(var t in e){e[t];return!1}return!0},u=function(e){var t=[];for(var n in e){var i={key:n,value:e[n]};Array.add(t,i.key)}return t},d=function(e){var t=[];for(var n in e){var i={key:n,value:e[n]};Array.add(t,i.value)}return t},p=function(e,t){if(void 0===t&&(t=null),t=t||{},e)for(var n,i=r(e);!(n=i()).done;){t[n.value]=!0}return t},h=function(e,t,n){if(!e)return null;var i="";for(var r in e){var a={key:r,value:e[r]};""!==i&&(i+=t),i+=a.key+n+a.value}return i},m=function(e){return e?i.c(e):null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){}var t,n,i;return e.prototype.updateLabel=function(e,t){return!1},t=e,(n=[{key:"focusableElement",get:function(){return null}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"IControlDomStrategy",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"DOMFocusListing",(function(){return u}));var i=n(0),r=n(1),a=(n(9),n(54),n(24)),o=n(22),s=n(16),l=n(13);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(e){this._validTags=[],this._cachedFirstElement=null,this._cachedLastElement=null,this.rememberFirstElement=!1,this.rememberLastElement=!1,this._currentElement=null,this._root=e}var t,n,i,u=e.prototype;return u.dispose=function(){this._currentElement=null,Array.clear(this._validTags),this._validTags=null,this._root=null,this._cachedFirstElement=null,this._cachedLastElement=null},u.addValidTag=function(e){Array.add(this._validTags,e)},u.trySetCurrentElement=function(e){return this.setCurrentElement(e,!1)},u.forceSetCurrentElement=function(e){this.setCurrentElement(e,!0)},u.setCurrentElement=function(e,t){var n=!0;if(e&&(this.currentElement!==e||t)){if(!this.isFileInputElement(e)&&!a.FocusManager.tryFocus(e))return this._currentElement=null,!0;if(1===e.nodeType&&3===o.DomUtils.getTag(e)){var i=s.a.getAttributeValue(e,"type");switch(null==i?"text":l.a.toLower(i)){case"password":case"text":e.select();break;case"file":n=!1}}}return this.handleTabIndexOnSetCurrentElement(e),this._currentElement=e,!e&&r.AFrameworkApplication.activeFrame.applicationInstance.isFocusManagerBugFixEnabled&&(n=!1),n},u.isFileInputElement=function(e){if(1!==e.nodeType)return!1;if(3!==o.DomUtils.getTag(e))return!1;var t=s.a.getAttributeValue(e,"type");return null!=t&&"file"===l.a.toLower(t)},u.handleTabIndexOnSetCurrentElement=function(t){s.a.isRadioInputElement(t)&&(s.a.hasFocusableTabIndex(t)||(e.setElementAsFocusable(t),this.setAllOtherRadioButtonInRadioGroupToNonFocusable(t)))},u.setAllOtherRadioButtonInRadioGroupToNonFocusable=function(t){for(var n=this.firstElement;n;)e.shouldSetRadioButtonElementAsNonFocusableDueToOtherRadioButtonFocus(n,t)&&e.setElementAsNonFocusableDueToOtherRadioButtonFocus(n),n=e.findNextElement(n,this._root(),this._validTags)},e.findNextElement=function(t,n,i){return e.findAdjacentElement(t,n,i,!0)},e.findPreviousElement=function(t,n,i){return e.findAdjacentElement(t,n,i,!1)},e.findAdjacentElement=function(t,n,i,r){if(!t)return null;var a=e.highestInvalidElement(t,n);if(!a){var s=o.DomUtils.getTag(t);if(!Array.contains(i,s)){var l=e.getFirstOrLastInElement(t,i,r);if(l&&l!==t)return l}a=t}return e.adjacentElementFromCurrent(a,n,i,r)},e.highestInvalidElement=function(t,n){if(t===n||!t||1!==t.nodeType)return null;var i=e.highestInvalidElement(t.parentNode,n);return i||e.elementFocusable(t)||(i=t),i},e.adjacentElementFromCurrent=function(t,n,i,r){for(var a=null,o=r?t.nextSibling:t.previousSibling;o&&!a;)a=e.getFirstOrLastInElement(o,i,r),o=r?o.nextSibling:o.previousSibling;var s=t.parentNode;return!a&&s!==n&&s?e.adjacentElementFromCurrent(s,n,i,r):a},e.firstInElement=function(t,n){return e.getFirstOrLastInElement(t,n,!0)},e.lastInElement=function(t,n){return e.getFirstOrLastInElement(t,n,!1)},e.getFirstOrLastInElement=function(t,n,i){var r=null;if(t&&1===t.nodeType&&e.elementFocusable(t)){var a=o.DomUtils.getTag(t);(Array.contains(n,a)||s.a.hasFocusableTabIndex(t))&&(r=t);for(var l=i?t.firstChild:t.lastChild;l&&!r;)r=e.getFirstOrLastInElement(l,n,i),l=i?l.nextSibling:l.previousSibling}return r},e.elementFocusable=function(e){var t=!0;if(1===o.DomUtils.getTag(e))try{s.a.hasFocusableTabIndex(e)||void 0!==s.a.getAttributeValue(e,"href")&&null!==s.a.getAttributeValue(e,"href")||(t=!1)}catch(e){0}else 8===o.DomUtils.getTag(e)?s.a.hasFocusableTabIndex(e)||(t=!1):s.a.isRadioInputElement(e)&&!s.a.hasFocusableTabIndex(e,!0)&&(t=!1);return t&&!e.disabled&&s.a.isVisible(e)},e.shouldSetRadioButtonElementAsNonFocusableDueToOtherRadioButtonFocus=function(e,t){var n=s.a.getAttributeValue(t,"name");return e.id!==t.id&&s.a.isRadioInputElement(e)&&s.a.getAttributeValue(e,"name")===n},e.setElementAsNonFocusableDueToOtherRadioButtonFocus=function(e){e.setAttribute("tabIndex","-1")},e.setElementAsFocusable=function(e){e.setAttribute("tabIndex","0")},t=e,(n=[{key:"currentElement",get:function(){return this._currentElement}},{key:"previousElement",get:function(){return e.findPreviousElement(this.currentElement,this._root(),this._validTags)}},{key:"nextElement",get:function(){return e.findNextElement(this.currentElement,this._root(),this._validTags)}},{key:"firstElement",get:function(){if(this._cachedFirstElement){if(this.rememberFirstElement)return this._cachedFirstElement;this._cachedFirstElement=null}var t=e.firstInElement(this._root(),this._validTags);return this.rememberFirstElement&&(this._cachedFirstElement=t),t}},{key:"lastElement",get:function(){if(this._cachedLastElement){if(this.rememberLastElement)return this._cachedLastElement;this._cachedLastElement=null}var t=e.lastInElement(this._root(),this._validTags);return this.rememberLastElement&&(this._cachedLastElement=t),t}}])&&c(t.prototype,n),i&&c(t,i),e}();Object(i.a)(u,"DOMFocusListing",null,[21])},function(e,t,n){"use strict";var i,r=n(0);!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(i||(i={})),Object(r.b)("SameSite",i);var a=n(27),o=n(76),s=n(13),l=n(3),c=n(196),u=n(186);function d(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,"a",(function(){return h}));var h=function(){function e(){}return e.getBool=function(t,n){var i=e.get(t);return"true"===i||"false"!==i&&n},e.get=function(e){return function(e){if(!e)return"";if(e.indexOf("=")>=0)throw Error.argumentOutOfRange();var t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=t.match(n);return!i||i.length<2?"":i[1]}(e)},e.sanitizeCookies=function(){var t=n(1).AFrameworkApplication;if(t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("SanitizeCookiesEnabled")&&(e._cookiesToBeSanitized||e.computeCookiesToBeSanitized(),e._cookiesToBeSanitized)){var i=new Date(0),r=document.cookie;if(!r)return;for(var a,o=d(e._cookiesToBeSanitized);!(a=o()).done;){var s=a.value;r.indexOf(s)>-1&&e.setStringOrDictionaryValueWithDomainInternal(s,e.get(s),null,i,"","")}}},e.set=function(t,n){return e.setWithExpiration(t,n,24)},e.setWithoutExpiration=function(t,n,i,r){return e.setStringOrDictionaryValueWithDomain(t,n,null,null,i,r)},e.setWithExpiration=function(t,n,i){return e.setWithExpirationAndPath(t,n,i,"")},e.setWithExpirationAndPath=function(t,n,i,r){var a=new Date;return a.setTime(a.getTime()+864e5*i),e.setStringOrDictionaryValueWithDomain(t,n,null,a,r,"")},e.setWithAllTheThings=function(t,n,i,r,a){var o=new Date;return o.setTime(o.getTime()+864e5*i),e.setStringOrDictionaryValueWithDomain(t,n,null,o,r,a)},e.setWithExpirationMillisecondsAndPath=function(t,n,i,r){var a=new Date;return a.setTime(a.getTime()+i),e.setStringOrDictionaryValueWithDomain(t,n,null,a,r,"")},e.setDictionaryValueWithDomain=function(t,n,i,r,a){return e.setStringOrDictionaryValueWithDomain(t,null,n,i,r,a)},e.setStringOrDictionaryValueWithDomain=function(t,i,r,a,o,s,c){void 0===c&&(c=1);var u=n(1).AFrameworkApplication;return u.appSettingsManager&&u.appSettingsManager.getBooleanAppSetting("SanitizeCookiesEnabled")&&(e._cookiesToBeSanitized||e.computeCookiesToBeSanitized(),e._cookiesToBeSanitized&&e._cookiesToBeSanitized.contains(t))?(l.ULS.sendTraceTag(577042052,209,15,"Not setting the cookie { 0 }",t),!1):e.setStringOrDictionaryValueWithDomainInternal(t,i,r,a,o,s,c)},e.setStringOrDictionaryValueWithDomainInternal=function(t,n,r,a,c,u,d){if(void 0===d&&(d=1),t.indexOf("=")>=0)throw Error.argumentOutOfRange();var p="",h=u;(u=e.getSharedDomain(u))&&(p=";domain="+escape(u));var m="",g=new Date;g.setTime(g.getTime()+864e5*e.maxComplianceAllowedRetentionInDays),a>g&&(a=g),a&&(n||r)&&(m=";expires="+a.toUTCString());var f="";c&&(f=";path="+escape(c));var v="";document.URL.toLowerCase().startsWith("https://")&&(v=";Secure");var _="";d&&(_=";SameSite="+i[d],""===v&&l.ULS.sendTraceTag(51262751,209,15,"New versions of Chrome will ignore insecure SameSite cookies, which we attempted to write. SameSite:{0}",d));var y=t+"="+(n?s.a.urlKeyValueEncode(n):r?o.h(e.encodeDictionary(r),"&","="):"");return document.cookie=y+p+m+f+v+_,!(!document.cookie||-1===document.cookie.indexOf(y))||1===d&&e.setStringOrDictionaryValueWithDomain(t,n,r,a,c,h,0)},e.remove=function(e){document.cookie=e+"="},e.getSharedDomain=function(e){var t=window.location.hostname;if(!(e=a.a.getOrigin(e)))return"";if(e=e.replace("http://","").replace("https://",""),(t=t.replace("http://","").replace("https://",""))===e)return"";for(var n=t.split("."),i=e.split("."),r="",o=n.length-1,s=i.length-1;o>=0&&s>=0;){var l=n[o];if(l!==i[s])break;r="."+l+r,o--,s--}return r},e.encodeDictionary=function(e){var t={};if(!e)return t;for(var n in e){var i={key:n,value:e[n]};t[s.a.urlKeyValueEncode(i.key)]=s.a.urlKeyValueEncode(i.value)}return t},e.computeCookiesToBeSanitized=function(){var t=n(1).AFrameworkApplication;if(t.appSettingsManager&&t.appSettingsManager.containsAppSetting("CookiesToBeSanitized")){var i=n(1).AFrameworkApplication.appSettingsManager.getListAppSetting("CookiesToBeSanitized");e._cookiesToBeSanitized=new c.a(u.a.get_ordinal());for(var r=0;r<i.length;r++)e._cookiesToBeSanitized.add(i[r])}},e}();h._cookiesToBeSanitized=null,h.maxComplianceAllowedRetentionInDays=365,Object(r.a)(h,"Cookie",null,[])},function(e,t,n){"use strict";var i=n(19),r=n(11),a=n(1),o=n(310),s=n(336),l=n(118),c=(n(9),n(241)),u=n(337),d=n(55),p=n(0),h=n(92);var m=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).LabelText=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(h.a);Object(p.a)(m,"LabelProps",h.a,[]);n(306),n(221);var g=n(227),f=n(13);n.d(t,"a",(function(){return v})),n.d(t,"j",(function(){return b})),n.d(t,"f",(function(){return S})),n.d(t,"i",(function(){return C})),n.d(t,"b",(function(){return A})),n.d(t,"h",(function(){return I})),n.d(t,"e",(function(){return w})),n.d(t,"c",(function(){return T})),n.d(t,"d",(function(){return E})),n.d(t,"g",(function(){return k})),n.d(t,"k",(function(){return M}));var v=function(e,t,n,i,r,o,s,l,c,u,p,h,m,g,f,v,y,b,S,C){return void 0===p&&(p=null),void 0===h&&(h=null),void 0===m&&(m=null),void 0===g&&(g=!0),void 0===f&&(f=null),void 0===v&&(v=null),void 0===y&&(y=null),void 0===b&&(b=null),void 0===S&&(S=null),void 0===C&&(C=null),_(e,t,n,i?a.AFrameworkApplication.imageClusterPath:null,i?d.getImageClass(i):null,r,o,s,l,c,u,p,h,m,g,f,v,y,b,S,null,C)},_=function(e,t,n,i,r,a,o,s,l,c,u,d,p,h,m,g,f,v,_,y,b,S){var C;void 0===d&&(d=null),void 0===p&&(p=null),void 0===h&&(h=null),void 0===m&&(m=!0),void 0===g&&(g=null),void 0===f&&(f=null),void 0===v&&(v=null),void 0===_&&(_=null),void 0===y&&(y=null),void 0===b&&(b=null),void 0===S&&(S=null);var A='<Button Id="{0}" Command="{1}" LabelText="{2}" Visible="{3}"';A=String.format(A,e,t,n,m);var I=((C={}).MenuItemId=a,C.CommandValueId=o,C.Alt=s,C.DisplayMode=l,C.LabelCss=c,C.QueryCommand=u,C.Description=d,C.ImageBackColor=p,C.Keytip=h,C.LabelTextUserGeneratedPlaceholderReplacements=b,C.ShortcutHint=S,C);for(var w in g&&(I.AriaLabel=g),f&&(I.AriaLabelledById=f),v&&(I.AriaLabelledByText=v),_&&(I.AriaDescribedById=_),y&&(I.AriaDescribedByText=y),i&&(l&&"Small"!==l&&"Medium"!==l&&"Menu16"!==l?"Small20"===l||"Medium20"===l?(I.Image20by20=i,I.Image20by20Class=r):("Large"===l||"Menu32"===l||"Initials"===l)&&(I.Image32by32=i,I.Image32by32Class=r):(I.Image16by16=i,I.Image16by16Class=r)),I){var T={key:w,value:I[w]};T.value&&(A+=String.format(' {0}="{1}"',T.key,T.value))}return A+=" />"},y=function(e,t,n,i,r,a,o,s,l,c,u,d,p,h,m,g,f,v,_){var y;void 0===_&&(_=null);var b='<FlyoutAnchor Id="{0}" ';b=String.format(b,e);var S=((y={}).Command=t,y.CommandMenuOpen=n,y.CommandMenuClose=i,y.PopulateDynamically=r?"True":"False",y.PopulateOnlyOnce=a?"True":"False",y.QueryCommand=o,y.PopulateQueryCommand=s,y.Alt=d,y.SequenceType=p,y.LabelText=h,y.LabelCss=m,y.ShouldRefreshWhenDropped=g?"True":"False",y.RefreshableMenu=f?"True":"False",y.Visible=v?"True":"False",y),C=null,A=null;for(var I in"None"!==l&&(C=l,A=l+"Class"),c&&C&&(S[C]=c),u&&A&&(S[A]=u),S){var T={key:I,value:S[I]};T.value&&(b+=String.format(' {0}="{1}"',T.key,T.value))}return b+=">",_&&(b+=w(_)),b+="</FlyoutAnchor>"},b=function(e){return y(e.id,e.actionIdCommand.toString(),e.actionIdCommandMenuOpen.toString(),e.actionIdCommandMenuClose.toString(),!0,!1,e.actionIdQueryStatus.toString(),e.actionIdPopulateFlyout.toString(),"Image16by16",e.singleUserCollabGlyph16.cluster,e.singleUserCollabGlyph16.css,null,null,null,null,!1,!1,!1)},S=function(e,t,n){var i="";return f.a.formatNumberToString(n,6,a.AFrameworkApplication.numberFormat,Object(r.a)((function(){return i}),(function(e){return i=e}))),v(e,t,i,null,n.toString())},C=function(e,t,n,i,r,o,s,l,c,u,p){void 0===o&&(o=null),void 0===s&&(s=null),void 0===l&&(l=!0),void 0===c&&(c=null),void 0===u&&(u=!1),void 0===p&&(p=null);var h='<ToggleButton Id="{0}" MenuItemId="{1}" Command="{2}" QueryCommand="{3}" LabelText="{4}" Visible="{5}" UpdateHtmlPostToggle="{6}" ';return h=String.format(h,e,t,n,i,r,l,u),null!=o&&r!==o&&(h+=String.format('Alt="{0}" ',o)),null!=s&&(h+=String.format('Image16by16="{0}" Image16by16Class="{1}" ',a.AFrameworkApplication.imageClusterPath,d.getImageClass(s))),null!=c&&(h+=String.format('Keytip="{0}" ',c)),null!=p&&(h+=String.format('AriaLabel="{0}" ',p)),h+="/>"},A=function(e,t,n,i,r,a,o,s,l,c,u,d,p){void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=!1),void 0===l&&(l=!0),void 0===c&&(c=null),void 0===u&&(u=null),void 0===d&&(d=null),void 0===p&&(p=!1);var h=a||r,m=o?String.format('Keytip="{0}"',o):"",g=i?String.format('QueryCommand="{0}"',i):"",f=c?String.format('IsChecked="{0}"',null!=c&&c):"",v=u?String.format('CheckedImageClass="{0}"',u):"",_=d?String.format('CheckedImage="{0}"',d):"";return String.format('<ToggleButton Id="{0}"\r\n\tMenuItemId="{1}"\r\n\tCommand="{2}"\r\n\t{3}\r\n\tLabelText="{4}"\r\n\tAlt="{5}"\r\n\t{6}\r\n\tUseCheckMark="true"\r\n\tUseUncheckedImage="{7}"\r\n\tCloseMenuWhenExecuted="{8}"\r\n\t{9}\r\n\t{10}\r\n\t{11}\r\n\tUpdateHtmlPostToggle="{12}"\r\n/>',e,t,n,g,r,h,m,s,l,f,v,_,p)},I=function(e,t,n,i,r,o){var s='<SplitButton Id="{0}" Command="{1}" QueryCommand="{2}" LabelText="{3}" Image16by16="{4}" Image16by16Class="{5}">';return s=String.format(s,e,t,n,i,a.AFrameworkApplication.imageClusterPath,d.getImageClass(r)),s+=w(o),s+="</SplitButton>"},w=function(e,t){var n="<Menu";null!=t&&(n+=' Id="'+t+'"'),n+=">";for(var i=0;i<e.length;++i)n+=e[i];return n+="</Menu>"},T=function(e,t){for(var n=null==e?"<Controls>":String.format('<Controls Id="{0}">',e),i=0;i<t.length;i++)n+=t[i];return n+="</Controls>"},E=function(e,t,n,i,r,o,s){void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null);var l="<MenuSection ";return e&&(l+=String.format('Id="{0}" ',e)),n&&(l+=String.format('DisplayMode="{0}" ',n)),i&&(l+=String.format('Title="{0}" ',i),!r||n&&"Menu16"!==n&&"Menu16DescriptionEnabled"!==n||(l+=String.format('Image="{0}" ',a.AFrameworkApplication.imageClusterPath),l+=String.format('ImageClass="{0}" ',d.getImageClass(r)))),o&&(l+=String.format('Language="{0}" ',o)),s&&(l+=String.format('ariaLabelledById="{0}" ',s)),l+=">",l+=t,l+="</MenuSection>"},k=function(e){var t='<Separator Id="{0}" />';return t=String.format(t,e)},M=function(e){var t=new Sys.StringBuilder;t.append(String.format('<Menu Id="{0}"',e.Id)),e.MaxWidth&&t.append(String.format(' MaxWidth="{0}"',e.MaxWidth)),t.append(">");for(var n=0;n<e.MenuSectionList.length;n++){var i=e.MenuSectionList[n];i&&t.append(P(i))}return t.append("</Menu>"),t.toString()},P=function(e){if(!e.ControlList.length)return"";var t=new Sys.StringBuilder;return t.append("<MenuSection"),e.Id&&t.append(String.format(' Id="{0}"',e.Id)),e.DisplayMode&&t.append(String.format(' DisplayMode="{0}"',e.DisplayMode)),e.Title&&t.append(String.format(' Title="{0}"',e.Title)),e.TitleId&&t.append(String.format(' TitleId="{0}"',e.TitleId)),e.Theme&&t.append(String.format(' Theme="{0}"',e.Theme)),e.ShowMenuSectionSeparator||t.append(String.format(' ShowMenuSectionSeparator="{0}"',e.ShowMenuSectionSeparator)),e.ShowMenuSectionTitleIcon||t.append(String.format(' ShowMenuSectionTitleIcon="{0}"',e.ShowMenuSectionTitleIcon)),e.ShowMenuSectionTitleBackground||t.append(String.format(' ShowMenuSectionTitleBackground="{0}"',e.ShowMenuSectionTitleBackground)),e.MenuSectionTitleFocusable||t.append(String.format(' MenuSectionTitleFocusable="{0}"',e.MenuSectionTitleFocusable)),e.ControlsId?t.append(String.format('><Controls Id="{0}">',e.ControlsId)):t.append(">"),t.append(U(e.ControlList)),e.ControlsId&&t.append("</Controls>"),t.append("</MenuSection>"),t.toString()},F=function(e){var t=new Sys.StringBuilder;return e&&(t.append(String.format('<Button Id="{0}"',e.Id)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.CommandValueId&&t.append(String.format(' CommandValueId="{0}"',e.CommandValueId)),e.CommandPreviewId&&t.append(String.format(' CommandPreview="{0}"',e.CommandPreviewId)),e.CommandRevertId&&t.append(String.format(' CommandRevert="{0}"',e.CommandRevertId)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.MenuItemId&&t.append(String.format(' MenuItemId="{0}"',e.MenuItemId)),e.LabelCss&&t.append(String.format(' LabelCss="{0}"',e.LabelCss)),e.Image16by16Class&&t.append(String.format(' Image16by16="{0}" Image16by16Class="{1}"',e.Image16by16,e.Image16by16Class)),e.Image32by32Class&&t.append(String.format(' Image32by32="{0}" Image32by32Class="{1}"',e.Image32by32,e.Image32by32Class)),e.DisplayMode&&t.append(String.format(' DisplayMode="{0}"',e.DisplayMode)),e.Description&&t.append(String.format(' Description="{0}"',e.Description)),e.ImageBackColor&&t.append(String.format(' ImageBackColor="{0}"',e.ImageBackColor)),e.LabelTextUserGeneratedPlaceholderReplacements&&t.append(String.format(' LabelTextUserGeneratedPlaceholderReplacements="{0}"',e.LabelTextUserGeneratedPlaceholderReplacements)),e.KeyTip&&t.append(String.format(' Keytip="{0}"',e.KeyTip)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),t.append("/>")),t.toString()},D=function(e){return e?C(e.Id,e.MenuItemId,e.Command,e.QueryCommand,e.LabelText,e.Alt,e.Image16by16Class,e.Visible,e.KeyTip,e.UpdateHtmlPostToggle,e.AriaLabel):null},O=function(e){var t=new Sys.StringBuilder;return e&&(t.append(String.format('<GalleryButton Id="{0}"',e.Id)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&t.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.VerticalCenterAlign&&t.append(String.format(' VerticalCenterAlign="{0}"',e.VerticalCenterAlign)),e.MenuItemId&&t.append(String.format(' MenuItemId="{0}"',e.MenuItemId)),e.Image&&t.append(String.format(' Image="{0}"',e.Image)),e.ImageClass&&t.append(String.format(' ImageClass="{0}"',e.ImageClass)),e.InnerHTML&&t.append(String.format(' InnerHTML="{0}"',e.InnerHTML)),e.Image||e.InnerHTML||t.append(' InnerHTML=""'),e.ShouldSetTitle&&t.append(String.format(' ShouldSetTitle="{0}"',e.ShouldSetTitle)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),t.append("/>")),t.toString()},R=function(e){var t=new Sys.StringBuilder;if(e){t.append(String.format('<Gallery Id="{0}" Width="{1}" ElementDimensions="{2}">',e.Id,e.Width,e.ElementDimensions));for(var n=0;n<e.GalleryItems.length;n++)t.append(O(e.GalleryItems[n]));t.append("</Gallery>")}return t.toString()},x=function(e){var t,n=new Sys.StringBuilder;if(e){n.append(String.format('<ColorPicker Id="{0}" Width="{1}"',e.Id,e.Width)),e.McuLayout&&n.append(String.format(' McuLayout="{0}"',e.McuLayout.toString())),e.Command&&n.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&n.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.Stateful&&n.append(String.format(' Stateful="{0}"',e.Stateful)),n.append("><Colors>");for(var i=0;i<e.Colors.length;i++)n.append((t=e.Colors[i],String.format('<Color Color="{0}" Alt="{1}" DisplayColor="{2}"/>',t.Color,t.Alt,t.DisplayColor)));n.append("</Colors></ColorPicker>")}return n.toString()},U=function(e){for(var t,n=new Sys.StringBuilder,r=0;r<e.length;r++){var a=R(Object(i.a)(u.a,e[r]));a?n.append(a):((a=(t=Object(i.a)(o.a,e[r]))?A(t.Id,t.MenuItemId,t.Command,t.QueryCommand,t.LabelText,t.Alt,t.KeyTip,t.UseUncheckedImage,t.CloseMenuWhenExecuted,t.IsChecked,t.CheckedImageClass,t.CheckedImage,t.UpdateHtmlPostToggle):null)||(a=D(Object(i.a)(g.a,e[r])))||(a=F(Object(i.a)(l.a,e[r])))||(a=x(Object(i.a)(s.a,e[r])))||(a=B(Object(i.a)(c.a,e[r])))||(a=L(Object(i.a)(m,e[r]))))&&n.append(a)}return n.toString()},B=function(e){var t=new Sys.StringBuilder;return e&&(t.append(String.format('<FlyoutAnchor Id="{0}" ',e.Id)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),e.KeyTip&&t.append(String.format(' Keytip="{0}"',e.KeyTip)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&t.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.PopulateQueryCommand&&t.append(String.format(' PopulateDynamically="true" PopulateQueryCommand="{0}"',e.PopulateQueryCommand)),e.PopulateOnlyOnce&&t.append(String.format(' PopulateOnlyOnce="{0}"',e.PopulateOnlyOnce)),e.MenuOpenCommand&&t.append(String.format(' MenuOpenCommand="{0}"',e.MenuOpenCommand)),e.MenuCloseCommand&&t.append(String.format(' MenuCloseCommand="{0}"',e.MenuCloseCommand)),e.Image16by16Class&&t.append(String.format(' Image16by16="{0}" Image16by16Class="{1}"',e.Image16by16,e.Image16by16Class)),e.Image32by32Class&&t.append(String.format(' Image32by32="{0}" Image32by32Class="{1}"',e.Image32by32,e.Image32by32Class)),e.ImageIsVisible&&t.append(String.format(' ImageIsVisible="{0}"',e.ImageIsVisible)),e.ImageUsesSpaceWhileInvisible&&t.append(String.format(' ImageUsesSpaceWhileInvisible="{0}"',e.ImageUsesSpaceWhileInvisible)),t.append(">"),e.Menu&&t.append(M(e.Menu)),t.append("</FlyoutAnchor>")),t.toString()},L=function(e){var t=new Sys.StringBuilder;return e&&(t.append(String.format('<Label Id="{0}" ',e.Id)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),t.append("/>")),t.toString()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.Alt="Alt",r.Number="Number",r.UnitType="UnitType",r.Text="Text",r.MaxValue="MaxValue",Object(i.a)(r,"SpinnerCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(64);var a=function(e){var t,n;function i(t,n,i,r){return e.call(this,t,n,i,r)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.focusNext=function(e){return this.control.focusNext(e)},i}(r.a);Object(i.a)(a,"MenuItem",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(e,t){this.findExpression=e,this.replaceValue=t}return e.prototype.performReplaceOn=function(e){return e&&""!==e?e.replace(this.findExpression,this.replaceValue):e},e.createGlobalSearchFindReplacePair=function(t,n){return new e(new RegExp(t,"g"),n)},e}();Object(i.a)(r,"FindReplacePair",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.blur="Blur",r.click="Click",r.focus="Focus",r.keyUp="KeyUp",r.keyDown="KeyDown",r.menuChanged="MenuChanged",r.interactionBegin="InteractionBegin",r.interactionEnd="InteractionEnd",r.mouseOver="MouseOver",r.mouseOut="MouseOut",Object(i.a)(r,"EventKeys",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"Health",(function(){return s}));var i=n(0),r=n(99),a=n(3);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){}var t,n,i;return e.getInstance=function(){if(!e._singleton){var t=health.HealthFactoryGlobal.createHealthConfigInstance();try{t.setIsHealthEnabled(r.a.isHealthTelemetrySystemEnabled),t.setIsQosEnabled(r.a.isQosRecorderEnabled),t.setIsKpiEnabled(r.a.isKpiRecorderEnabled),t.setShouldUseNewLogger(r.a.shouldUseNewLogger),t.setShouldUseOtelCsForAllEvents(r.a.shouldUseOtelCsForAllEvents),t.setShouldUseXhr(r.a.shouldUseXhr),t.setRemoteTelemetryUrl(r.a.remoteTelemetryUrl),t.setHeartbeatIntervalMs(r.a.heartbeatIntervalMs),t.setRecordPillarToWarmPipelineIntervalMs(r.a.recordQosPillarToWarmPipelineIntervalMs),t.setLoggerMaxQueueSize(r.a.loggerMaxQueueSize),t.setLoggerMaxIntervalMs(r.a.loggerMaxIntervalMs),t.setExternalLogger(e.logHealthEventToUls),t.setDimensions(r.a.getSessionDimensions()),t.setQosVetoClassifier(qosWac.QosWacFactoryGlobal.createQosVetoClassificationInstance((function(){return health.HealthFactoryGlobal.createQosVetoInstance()})))}catch(e){a.ULS.sendTraceTag(589825178,383,10,"Failed to initialize health: "+e),t.setIsHealthEnabled(!1),t.setIsQosEnabled(!1),t.setIsKpiEnabled(!1)}e.setInstance(health.HealthFactoryGlobal.createHealthInstance(t))}return e._singleton},e.setInstance=function(t){if(!t)throw Error.argumentNull("health");e._singleton=t},e.logHealthEventToUls=function(t,n,i){a.ULS.sendTraceTag(t,383,e.getUlsLevelFromHealthLevel(n),i)},e.getUlsLevelFromHealthLevel=function(e){switch(e){case 1:return 50;case 2:return 15;case 3:return 10;default:return 100}},t=e,i=[{key:"instance",get:function(){return e.getInstance()}}],(n=null)&&o(t.prototype,n),i&&o(t,i),e}();s._singleton=null,Object(i.a)(s,"Health",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"UISurfaces",(function(){return s}));var i=n(0),r=n(1),a=n(44),o=n(21),s=function(){function e(){}return e.setAppChromeProvider=function(t){e._appChromeProvider=t},e.setAppChromeProviderDelegate=function(t){e._appChromeProviderDelegate=t},e.isLoaded=function(){return!!e._uiSurfacesAPI},e.isDialogAPILoaded=function(){return!!e._dialogAPI},e.getUISurfacesAPI=function(){return appChrome.loadUISlice20().then((function(t){return e._uiSurfacesAPI=t,t}))},e.loadScripts=function(){if(e.isLoaded())return Promise.resolve(e._uiSurfacesAPI);if(e._appChromeProvider)return e._appChromeProvider.then((function(t){return e.getUISurfacesAPI()}));if(e._appChromeProviderDelegate)return e._appChromeProviderDelegate().then((function(t){return e.getUISurfacesAPI()}));var t=o.a.instance.resolve("Common.IDynamicScriptLoaderProvider").getScriptLoader();return t.loadScript("appChrome").then((function(n){return r.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled||a.initializeAppChrome(t),e.getUISurfacesAPI()}))},e.getContextualAPIAsync=function(){return e.loadScripts().then((function(t){return e._uiSurfacesAPI.contextualUI}))},e.getTaskPaneAPIAsync=function(){return e.loadScripts().then((function(t){return e._uiSurfacesAPI.taskPane}))},e.getDialogAPIAsync=function(){return e.loadScripts().then((function(t){return e._dialogAPI=e._uiSurfacesAPI.dialog,e._dialogAPI}))},e.getStatusBarAPIAsync=function(){return e.loadScripts().then((function(t){return e._statusBarAPI=e._uiSurfacesAPI.statusBar,e._statusBarAPI}))},e.getMessageBarAPIAsync=function(){return e.loadScripts().then((function(t){return e._messageBarAPI=e._uiSurfacesAPI.messageBar,e._messageBarAPI}))},e.getDictationFloatieUIAsync=function(){return e.loadScripts().then((function(t){return e._uiSurfacesAPI.dictationFloatieUI}))},e.getNotificationsAPIAsync=function(){return r.AFrameworkApplication.activeFrame.applicationInstance.isReactNotificationsEnabled?(e.notificationsApi||(e.notificationsApi=e.loadScripts().then((function(t){var n=document.createElement("div");return r.AFrameworkApplication.activeFrame.get_element().appendChild(n),t.notifications.initializeCalloutNotifications(n),e._uiSurfacesAPI.notifications}))),e.notificationsApi):Promise.reject("React Notifications not enabled")},e.getRulerAPI=function(){return e.loadScripts().then((function(t){return e._rulerAPI=e._uiSurfacesAPI.ruler,e._rulerAPI}))},e}();s._uiSurfacesAPI=null,s._dialogAPI=null,s._statusBarAPI=null,s._messageBarAPI=null,s._appChromeProvider=null,s._appChromeProviderDelegate=null,s._rulerAPI=null,s.notificationsApi=null,Object(i.a)(s,"UISurfaces",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"Menu",(function(){return E}));var i=n(0),r=n(2),a=n(19),o=n(65),s=n(1),l=(n(9),n(54),n(140)),c=n(4),u=n(25),d=n(20),p=n(28),h=n(44),m=n(7),g=n(16),f=n(10),v=n(64),_=n(204),y=n(162),b=n(141),S=n(5),C=n(6),A=n(51);function I(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var E=function(e){var t,i;function o(t,n,i,r,a,o,s,l){var c;return void 0===o&&(o=null),void 0===s&&(s=!1),void 0===l&&(l=1),(c=e.call(this,t,n,i,r)||this)._focusedIndex=-1,c.isFloatieContextMenuDropDown=!1,c._innerDiv=null,c.stackIndex=-1,c.launched=!1,c._maxWidth=a,c._rootManager=o,c._isComboboxListbox=s,c._horizontalAlignment=l,c}i=e,(t=o).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var w,E,k,M=o.prototype;return M.refreshInternal=function(){this.needsDelayIniting&&this.doDelayedInit(),this.ensureDOMElementAndEmpty();var t=this.root.textDirection,n=this.elementInternal;t?1===t&&(C.a.ensureCSSClassOnElement(n,"cui-rtl"),n.style.direction="rtl"):n.style.direction="ltr",S.c(this.innerDiv)&&(this._innerDiv=C.a.createElement("div"),this.innerDiv.className="cui-smenu-inner"),n.setAttribute(m.a.ariaRoleAttribute,this._isComboboxListbox?m.a.ariaListboxRole:m.a.ariaMenuRole),n.appendChild(this.innerDiv),S.b(this._maxWidth)||(n.style.maxWidth=this._maxWidth),this.appendChildrenToElement(this.innerDiv),e.prototype.refreshInternal.call(this)},M.setParentKeytipsIdsForMenuItems=function(e,t){for(var n,i=I(this.children);!(n=i()).done;)for(var a,o=I(n.value.children);!(a=o()).done;){var s=a.value;Object(r.c)(v.a,s)&&s.hasKeytip&&(s.control.parentKeytipsIds=e,s.control.parentKeytipsKeys=t)}},M.attachEvents=function(){d.KeyInputManager.instance.registerHandler(c.EventNames.keyDown,this.elementInternal,Object(r.d)(this,this.onKeyDown,"onKeyDown")),d.KeyInputManager.instance.registerHandler(c.EventNames.keyPress,this.elementInternal,Object(r.d)(this,this.onKeyPress,"onKeyPress")),d.KeyInputManager.instance.registerHandler(c.EventNames.keyUp,this.elementInternal,Object(r.d)(this,this.onKeyUp,"onKeyUp")),l.a.instance.registerHandler(this.elementInternal,Object(r.d)(this,this.onContextMenu,"onContextMenu")),p.a.instance.registerHandler(c.EventNames.pointerOver,this.elementInternal,Object(r.d)(this,this.onPointerOver,"onPointerOver")),p.a.instance.registerHandler(c.EventNames.pointerOut,this.elementInternal,Object(r.d)(this,this.onPointerOut,"onPointerOut"))},M.ensureCorrectChildType=function(e){if(!Object(r.c)(y.a,e))throw Error.create("Only MenuSection Components can be added to Menu Components.")},M.getSectionSelectableStartIndex=function(e){for(var t,n=0,i=I(this.children);!(t=i()).done;){var r=t.value;if(r===e)break;n+=r.selectableItemsCount}return n},M.pollMenuState=function(){this.pollForStateAndUpdateInternal()},M.pollForStateAndUpdateInternal=function(){this.lastPollTime=new Date,e.prototype.pollForStateAndUpdateInternal.call(this)},M.onContextMenu=function(e){return!0},M.onKeyDown=function(e){var t=!1;if(!S.c(e.innerEvent)&&!S.c(e.innerEvent.rawEvent)){var i=e.innerEvent.rawEvent,a=e.innerEvent.keyCode,o=i.shiftKey,s=i.altKey,l=!this.root.textDirection,c=!1,u=a===Sys.UI.Key.right&&l||a===Sys.UI.Key.left&&!l,d=a===Sys.UI.Key.left&&l||a===Sys.UI.Key.right&&!l;if(a===Sys.UI.Key.tab&&!o||u)this.focusNext(0),c=!0,t=!0;else if(a===Sys.UI.Key.tab&&o)this.focusNext(1),c=!0,t=!0;else if(a===Sys.UI.Key.down)this.focusNext(6),c=!0,t=!0;else if(a===Sys.UI.Key.up)this.focusNext(5),c=!0,t=!0;else if(d)this.stackIndex>0&&this.root.closeMenuStackAtIndex(this.stackIndex,!0,!1),t=!0;else if(a===Sys.UI.Key.esc||s&&!this.inMasterKeytipMode){var p=Object(r.c)(n(123).Jewel,this.root)&&!this.inMasterKeytipMode?0:this.stackIndex;this.root.closeMenuStackAtIndex(p,!0,!this.inKeytipMode),t=!0}else(e.innerEvent.ctrlKey||a>=112&&a<=123||a===Sys.UI.Key.space)&&(t=!0);c&&(this.elementInternal.tabIndex=-1)}return t},M.onKeyPress=function(e){return!this.inKeytipMode},M.onKeyUp=function(e){var t=!1;if(!S.c(e.innerEvent)&&!S.c(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent;this.inMasterKeytipMode&&e.innerEvent.keyCode===u.a.vK_Alt&&!n.altKey&&(this.root.closeMenuStackAtIndex(0,!0,!0),s.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&h.apiExists("exitKeytipMode")&&appChrome.api.exitKeytipMode(),t=!0)}return t},M.onPointerOver=function(e){for(var t=n(74).MenuLauncher,i=this.stackIndex;i>0;){var r=this.root.menuLauncherStack[i];r.isStandardMenuItem()&&(C.a.ensureCSSClassOnElement(r.launcher,t.menuDroppedClassName),r.elmHadFocus=r.focusableElement),i--}return!1},M.onPointerOut=function(e){if(!g.a.isPointInElement(this.elementInternal,e.clientPoint))if(this.stackIndex===this.root.menuStackDepth-1)this.setFocus(e.inputSource);else{var t=this.root.menuLauncherStack[this.stackIndex+1];t.elmHadFocus!==t.launcher&&(t.elmHadFocus=this.elementInternal,this.resetFocusedIndex())}return!1},M.updateFocusedIndex=function(e){for(var t,n=0,i=I(this.children);!(t=i()).done;){if(t.value.updateFocusedIndex(e))return this._focusedIndex=n,!0;n++}return!1},M.setFocus=function(e){if(1===e)this.focusNext(0);else{if(this.elementInternal.tabIndex=0,f.a.browserSupportsSetActive(this.elementInternal))try{this.elementInternal.setActive()}catch(e){this.elementInternal.focus()}else this.elementInternal.focus();this.resetFocusedIndex()}},M.resetFocusedIndex=function(){if(this.children.count){this._focusedIndex=-1;for(var e,t=I(this.children);!(e=t()).done;){e.value.resetFocusedIndex()}}},M.moveFocusToParentOnNavigationEnd=function(){if(Object(r.c)(v.a,this.parent)){var e=this.parent.control;if(e)if(e.stateProperties.TakeFocusOnMenuNavigationEnd)return e.setFocusOnControl(),!0}return!1},M.focusNext=function(e){var t=this.children.count;if(t<=0)return!1;var n=!e||4===e||6===e;return this.moveFocusFromIndex(this._focusedIndex,e)||this.moveFocusToParentOnNavigationEnd()||this.moveFocusFromIndex(n?0:t-1,e)},M.moveFocusFromIndex=function(e,t){var n=!t||4===t||6===t;-1===e&&(e=n?0:this.children.count-1);for(var i=e,r=this.children.getEnumeratorAtPos(i);n?r.moveNext():r.movePrevious();){if(r.get_current().focusNext(t))return this._focusedIndex=i,!0;i+=n?1:-1}return!1},M.hasItems=function(){for(var e,t=I(this.children);!(e=t()).done;)for(var n,i=I(e.value.children);!(n=i()).done;){if(n.value.visible)return!0}return!1},M.dispose=function(){var t=this.elementInternal;S.c(t)||C.a.unregisterAllHandlers(t),e.prototype.dispose.call(this),this._innerDiv=null},M.clone=function(e){for(var t,n=e.createMenu(this.id,this.title,this.description,this._maxWidth,this._isComboboxListbox),i=I(this.children);!(t=i()).done;){var r=t.value;n.addChild(r.clone(e))}return n},w=o,(E=[{key:"horizontalAlignment",get:function(){return this._horizontalAlignment}},{key:"cssClass",get:function(){return s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled?"cui-menu MLRVisualRefresh":"cui-menu"}},{key:"domElementTagName",get:function(){return"div"}},{key:"inKeytipMode",get:function(){var e=Object(a.a)(b.a,this._rootManager);return!!e&&e.inKeytipMode}},{key:"inMasterKeytipMode",get:function(){var e=this.inKeytipMode;return s.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&h.apiExists("inKeytipMode")&&(e=appChrome.api.inKeytipMode()),e}},{key:"innerDiv",get:function(){return this._innerDiv}},{key:"selectableItemsCount",get:function(){for(var e,t=0,n=I(this.children);!(e=n()).done;)t+=e.value.selectableItemsCount;return t}},{key:"isComboboxListbox",get:function(){return this._isComboboxListbox}},{key:"menuLauncherChildren",get:function(){for(var e,t=n(74).MenuLauncher,i=new _.a,a=I(this.children);!(e=a()).done;)for(var o,s=I(e.value.children);!(o=s()).done;){var l=o.value;if(Object(r.c)(v.a,l)){var c=l;c.visible&&Object(r.c)(t,c.control)&&i.add(c.control)}}return i}},{key:"visibleInDOM",get:function(){return this.launched},set:function(e){Object(A.b)(o.prototype,this,"visibleInDOM",e)}}])&&T(w.prototype,E),k&&T(w,k),o}(o.a);E.menuBorderPx=1,Object(i.a)(E,"Menu",o.a,[82])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}return e.getInstance=function(t){return void 0===t&&(t=null),e._singleton||(e.setInstance(otel.TelemetryFactoryGlobal.createInstance()),t&&t.length>0?(e._actionsTableNamePrefix="Office."+t+".Online.UserAction.",e._activityTableNamePrefix="Office."+t+".Online.Data.Activity."):(e._actionsTableNamePrefix="Office.Online.UserAction.",e._activityTableNamePrefix="Office.Online.Data.Activity.")),e._singleton},e.setInstance=function(t){if(!t)throw Error.argumentNull("telemetryLogger");e._singleton=t},e.sendTelemetryEvent=function(t){e.getInstance().sendTelemetryEvent(t)},e.containsTenantName=function(e){return e.indexOf("Office.")>=0},e.sendActivityEvent=function(t){t&&t.name&&(e.containsTenantName(t.name)||(t.name=e._activityTableNamePrefix+t.name)),e.getInstance().sendActivityEvent(t)},e.sendOtelEvent=function(t){e.getInstance().sendOtelEvent(t)},e.sendOtelCustomerContent=function(e){},e.sendUserActionEvent=function(t){!t||t.name&&t.name.length||t.actionName&&t.actionName.length>0&&(t.name=e._actionsTableNamePrefix+t.actionName),e.getInstance().sendUserActionEvent(t)},e.sendTellMeUserActionEvent=function(t,n){void 0===n&&(n=""),t.name=e.getTellMeActivityName(t.actionName,n),e.sendUserActionEvent(t)},e.sendTellMeActivityEvent=function(t,n){void 0===n&&(n=""),t.name=e.getTellMeActivityName(t.name,n),e.sendActivityEvent(t)},e.getTellMeActivityName=function(e,t){return e&&e.length>0?"Office.TellMe."+t+e:"Office.TellMe."+t+"NoActionName"},e.addNamespaceMapping=function(t,n){e.getInstance().addNamespaceMapping(t,n)},e.setEnabledState=function(t){e.getInstance().setEnabledState(t)},e.registerEventHandler=function(t){e.getInstance().registerEventHandler(t)},e.shutdown=function(){return e._isOtelReady=!1,e.getInstance().shutdown()},e.setOtelFullAvailable=function(){e._isOtelReady=!0},e.isOtelReady=function(){return e._isOtelReady},e}();r._singleton=null,r._actionsTableNamePrefix=null,r._activityTableNamePrefix=null,r._isOtelReady=!1,Object(i.a)(r,"Telemetry",null,[])},function(e,t,n){"use strict";var i=n(0);var r=function(e){var t,n;function i(t){var n;return(n=e.call(this)||this)._exception=null,n.set_exception(t),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.get_exception=function(){return this._exception},r.set_exception=function(e){return this._exception=e,e},i}(Sys.EventArgs);Object(i.a)(r,"UnobservedTaskExceptionEventArgs",Sys.EventArgs,[]),n.d(t,"a",(function(){return a}));var a=function(){function e(){}return e.prototype.tryExecuteTask=function(e){return e.tryExecute()},e.get_events=function(){return e._events||(e._events=new Sys.EventHandlerList)},e.get_default=function(){return e._default},e.get_current=function(){return e._current},e.set_current=function(t){return e._current=t,t},e.add_unobservedTaskException=function(t){e.get_events().addHandler("UnobservedException",t)},e.remove_unobservedTaskException=function(t){e.get_events().removeHandler("UnobservedException",t)},e.runOnSpecific=function(t,i){var r=n(109).Task;(i=i||e.get_current())===e._default?window.setTimeout(e.runCurrent(t,i),0):r.Create(t).Start$Scheduler(i)},e.publishUnobservedTaskException=function(t,n){var i=e.get_events().getHandler("UnobservedException");i&&i(t,new r(n))},e.runCurrent=function(t,n){return function(){var i=e.get_current();e.set_current(n),t(),e.set_current(i)}},e}();a._events=null,Object(i.a)(a,"TaskScheduler",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.Alt="Alt",r.CommandValueId="CommandValueId",r.InnerHTML="InnerHTML",r.On="On",r.IsRtl="IsRtl",r.GalleryButtonProps="GalleryButtonProps",r.Text="Text",r.HighlightOn="HighlightOn",Object(i.a)(r,"GalleryButtonCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(1),a=(n(9),n(21));function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){this._topPage=Number.NaN,this._topZoom=Number.NaN,this._top=Number.NaN,this._leftPage=Number.NaN,this._leftZoom=Number.NaN,this._left=Number.NaN,this._widthPage=Number.NaN,this._widthZoom=Number.NaN,this._width=Number.NaN,this._viewWidth=Number.NaN,this._scrollControl=null}var t,i,s,l=e.prototype;return l.getSectionFromPage=function(e){var t,i=n(14).App,r=1,a=0,o=n(14).App.instance.theDocument.sectionCount;if(e<1||e>i.instance.theDocument.pageCount)return null;for(;r<=o;){if(a=r+o>>1,e>=(t=i.instance.theDocument.getSection(a)).startPage&&e<=t.startPage+t.pageCount-1)return t;e<t.startPage?o=a-1:r=a+1}return null},l.getPageFromScrollTop=function(e,t){var i,r,a,o,s,l=n(14).App,c=1,u=this.pageCount;if(e<0)return 1;for(;c<=u;){if(r=c+u>>1,i=this.getSectionFromPage(r),a=(s=this.getPageTopAtZoom(r,t))-l.instance.theConfig.pageGapPixels+1,o=Math.round(s+i.pageHeight*t),e>=a&&e<=o)return r;e>o?c=r+1:u=r-1}return Math.max(1,u)},l.getPageTopAtZoom=function(e,t){var i=n(14).App;if(this._topPage===e&&this._topZoom===t)return this._top;this._topPage=e,this._topZoom=t;var r=this.getSectionFromPage(e);return this._top=Math.round(r.top*t+(e-r.startPage)*r.pageHeight*t+e*i.instance.theConfig.pageGapPixels-.5*i.instance.theConfig.pageGapPixels),this._top},l.getPageLeftAtZoom=function(e,t,i){var a=n(14).App,o=this.scrollControl.futureContainerWidth;if(this._leftPage===e&&this._leftZoom===t&&o===this._viewWidth)return this._left;this._leftPage=e,this._leftZoom=t,this._viewWidth=o;var s=this.getPageWidthAtZoom(e,t),l=t*this.maxPageWidth;if(o<=s+2*a.instance.theConfig.marginPixels)this._left=a.instance.theConfig.marginPixels,i&&r.AFrameworkApplication.isRtl&&(this._left+=l-s);else if(this._left=Math.round((o-(s+2))/2),i&&r.AFrameworkApplication.isRtl){var c=l+2*n(14).App.instance.theConfig.marginPixels;o<=c&&(this._left=c-(this._left+s))}return this._left},l.getDistanceOfPageLeftFromScrollerRightEdge=function(e,t){var i=this.scrollControl.getWidth(),r=t*this.maxPageWidth+2*n(14).App.instance.theConfig.marginPixels,a=this.getPageLeftAtZoom(e,t,!0);return i<=r?r-a:i-a},l.getPageHeightAtZoom=function(e,t){var n=this.getSectionFromPage(e);return Math.round(n.pageHeight*t)},l.getPageWidthAtZoom=function(e,t){if(this._widthPage===e&&this._widthZoom===t)return this._width;this._widthPage=e,this._widthZoom=t;var n=this.getSectionFromPage(e);return this._width=Math.round(n.pageWidth*t),this._width},t=e,s=[{key:"instance",get:function(){return e._instance||(e._instance=new e)}}],(i=[{key:"scrollControl",get:function(){return this._scrollControl||(this._scrollControl=a.a.instance.resolve("WordViewer.Controls.IScrollControl"))}},{key:"pageCount",get:function(){return n(14).App.instance.theDocument.pageCount}},{key:"sectionCount",get:function(){return n(14).App.instance.theDocument.sectionCount}},{key:"totalPageHeight",get:function(){return n(14).App.instance.theDocument.totalPageHeight}},{key:"maxPageWidth",get:function(){return n(14).App.instance.theDocument.maxPageWidth}},{key:"minPageHeight",get:function(){return n(14).App.instance.theDocument.minPageHeight}},{key:"totalPageGap",get:function(){var e=n(14).App;return e.instance.theConfig.pageGapPixels*e.instance.theDocument.pageCount}},{key:"hasComments",get:function(){return n(14).App.instance.theDocument.hasComments}},{key:"isNormalized",get:function(){return n(14).App.instance.theDocument.isNormalized}}])&&o(t.prototype,i),s&&o(t,s),e}();s._instance=null,Object(i.a)(s,"DocumentDataUtils",null,[3])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){this.Id=null,this.ExternalId=null}var t,n,i;return t=e,(n=[{key:"ControlType",get:function(){return 0}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"CommonControlProps",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(244),a=function(){function e(e){this.$$ge=this.getEnumerator,this._array=e}var t=e.prototype;return t.getEnumerator=function(){return new r.a(this._array)},t[Symbol.iterator]=function(){return this._array[Symbol.iterator]()},e}();Object(i.a)(a,"ArrayEnumerable$1",null,[35]);var o=n(205),s=n(63),l=function(){function e(){}var t=e.prototype;return t.equals=function(e,t){return e===t},t.getHashCode=function(e){return"string"==typeof e?this.getHashCodeForString(e):"number"==typeof e?this.getHashCodeForNumber(e):this.getOrAssignCachedHashCode(e)},t.getHashCodeForNumber=function(e){return 0|e},t.getHashCodeForString=function(e){if(!e)return 0;for(var t=352654597,n=0;n<e.length;n+=2)t=(t<<5)+t+(t>>27)^(e.charCodeAt(n)|e.charCodeAt(n+1)<<16|0);return t},t.getOrAssignCachedHashCode=function(e){if(!e)return 0;var t=e.$$hashCode;if(null!=t)return t;t=Math.random()*Number.MAX_VALUE|0;try{var n;return Object.defineProperty(e,"$$hashCode",((n={}).value=t,n)),t}catch(e){return 0}},e}();function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(l,"DefaultComparer",null,[22]);var u=function(){function e(){}var t,n,i;return t=e,i=[{key:"comparer",get:function(){return e.singleton||(e.singleton=new l)}}],(n=null)&&c(t.prototype,n),i&&c(t,i),e}();u.singleton=null,Object(i.a)(u,"EqualityComparerStore",null,[]);var d=function(){function e(){}return e.get_default=function(){return u.comparer},e}();Object(i.a)(d,"EqualityComparer",null,[]);var p=n(2),h=function(){function e(e){this._sourceEnumerator=null,this._shouldCloneForGetEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._source):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._sourceEnumerator.get_current()},t.moveNext=function(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.getEnumerator()),this._sourceEnumerator.moveNext()},t.reset=function(){this._sourceEnumerator=null},e}();Object(i.a)(h,"CastEnumerable",null,[35,65]);var m=function(){function e(e,t){this._firstComplete=!1,this._enumerator=null,this._shouldCloneForGetEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._first=e,this._second=t}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._first,this._second):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._enumerator.$$cu()},t.moveNext=function(){return this._enumerator||(this._enumerator=this._first.$$ge()),!!this._enumerator.$$mn()||!this._firstComplete&&(this._firstComplete=!0,this._enumerator=this._second.$$ge(),this._enumerator.$$mn())},t.reset=function(){this._firstComplete=!1,this._enumerator=null},e}();Object(i.a)(m,"ConcatEnumerable",null,[35,65]);var g=function(){function e(){this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset}var t=e.prototype;return t.getEnumerator=function(){return this},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){throw Error.invalidOperation()},t.moveNext=function(){return!1},t.reset=function(){},e}();Object(i.a)(g,"EmptyEnumerator",null,[35,65]);var f=function(){function e(e){this._iterator=null,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._getIterator=e}var t=e.prototype;return t.get_current=function(){return this._current},t.moveNext=function(){this._iterator||(this._iterator=this._getIterator());var e=this._iterator.next();return this._current=e.value,!e.done},t.reset=function(){this._iterator=null},e}();Object(i.a)(f,"IteratorEnumerator",null,[65]);var v=function(){function e(e){this.$$ge=this.getEnumerator,this._getIterator=e}var t=e.prototype;return t.getEnumerator=function(){return new f(this._getIterator)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},e}();Object(i.a)(v,"IteratorEnumerable",null,[35]);var _=function(){function e(t,n,i,r,a){this._compare=null,this.$$ge=this.getEnumerator,this._source=t,this._comparisonSelector=n,this._parent=r,this._compare=i?function(e,t){return i.compare(e,t)}:e.compareValues.bind(e),this._mult=a?-1:1}var t=e.prototype;return t.getEnumerator=function(){var e=this,t=n(93).toArray(this._source);return t.sort((function(t,n){return e.doCompare(t,n)})),new r.a(t)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.doCompare=function(e,t){if(this._parent){var n=this._parent.doCompare(e,t);if(n)return n}return this._compare(this._comparisonSelector(e),this._comparisonSelector(t))*this._mult},e.compareValues=function(e,t){return e<t?-1:e>t?1:0},e}();Object(i.a)(_,"OrderByEnumerable",null,[89,35]);var y=function(){function e(e,t){this._index=0,this._shouldCloneForGetEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._element=e,this._count=t}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._element,this._count).getEnumerator():(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._element},t.moveNext=function(){return!(this._index>=this._count)&&(this._index++,!0)},t.reset=function(){this._index=0},e}();Object(i.a)(y,"RepeatEnumerator",null,[35,65]);var b=function(){function e(e,t,n){this._shouldCloneForGetEnumerator=!1,this._index=0,this._sourceEnumerator=null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e,this._indexedSelector=n,this._simpleSelector=t}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._source,this._simpleSelector,this._indexedSelector):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._current},t.moveNext=function(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),!!this._sourceEnumerator.$$mn()&&(this._current=this.runSelector(this._sourceEnumerator.$$cu()),this._index++,!0)},t.next=function(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),this._sourceEnumerator.$$mn()?(this._current=this.runSelector(this._sourceEnumerator.$$cu()),this._index++,{done:!1,value:this._current}):{done:!0,value:void 0}},t.reset=function(){this._sourceEnumerator=null,this._index=-1},t.runSelector=function(e){return this._indexedSelector?this._indexedSelector(e,this._index):this._simpleSelector(e)},e}();Object(i.a)(b,"SelectEnumerator",null,[35,65]);var S=function(){function e(e,t,n){this._shouldCloneForGetEnumerator=!1,this._index=0,this._resultEnumerator=null,this._sourceEnumerator=null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e,this._simpleSelector=t,this._indexedSelector=n}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._source,this._simpleSelector,this._indexedSelector):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._resultEnumerator.$$cu()},t.moveNext=function(){if(this._resultEnumerator&&this._resultEnumerator.$$mn())return!0;do{if(this._resultEnumerator=null,this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),!this._sourceEnumerator.$$mn())return!1;this._resultEnumerator=this.runSelector(this._sourceEnumerator.$$cu()).$$ge(),this._index++}while(!this._resultEnumerator.$$mn());return!0},t.reset=function(){this._sourceEnumerator=null,this._resultEnumerator=null,this._index=0},t.runSelector=function(e){return this._indexedSelector?this._indexedSelector(e,this._index):this._simpleSelector(e)},e}();Object(i.a)(S,"SelectManyEnumerator",null,[35,65]);var C=function(){function e(e,t){this._sourceEnumerator=null,this._shouldCloneForGetEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e,this._count=t}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._source,this._count):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._sourceEnumerator.$$cu()},t.moveNext=function(){if(!this._sourceEnumerator){this._sourceEnumerator=this._source.$$ge();for(var e=0;e<this._count;e++)if(!this._sourceEnumerator.$$mn())return!1}return this._sourceEnumerator.$$mn()},t.reset=function(){this._sourceEnumerator=null},e}();Object(i.a)(C,"SkipEnumerator",null,[35,65]);var A=function(){function e(e,t,n){this._shouldCloneForGetEnumerator=!1,this._index=0,this._sourceEnumerator=null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e,this._simplePredicate=t,this._indexedPreciate=n}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._source,this._simplePredicate,this._indexedPreciate):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._sourceEnumerator.$$cu()},t.moveNext=function(){if(this._sourceEnumerator)return this._sourceEnumerator.$$mn();for(this._sourceEnumerator=this._source.$$ge();this._sourceEnumerator.$$mn();){if(!this.evaluatePredicate(this._sourceEnumerator.$$cu()))return!0;this._index++}return!1},t.reset=function(){this._sourceEnumerator=null,this._index=0},t.evaluatePredicate=function(e){return this._indexedPreciate?this._indexedPreciate(e,this._index):this._simplePredicate(e)},e}();Object(i.a)(A,"SkipWhileEnumerator",null,[35,65]);var I=function(){function e(e,t){this._index=0,this._sourceEnumerator=null,this._shouldCloneForGetEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e,this._count=t}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?(this._shouldCloneForGetEnumerator=!0,this):new e(this._source,this._count).getEnumerator()},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._sourceEnumerator.$$cu()},t.moveNext=function(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),!(this._index>=this._count)&&(this._index++,this._sourceEnumerator.$$mn())},t.reset=function(){this._sourceEnumerator=null},e}();Object(i.a)(I,"TakeEnumerator",null,[35,65]);var w=function(){function e(e,t,n){this._shouldCloneForGetEnumerator=!1,this._index=0,this._sourceEnumerator=null,this._complete=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e,this._simplePredicate=t,this._indexedPreciate=n}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._source,this._simplePredicate,this._indexedPreciate):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._sourceEnumerator.$$cu()},t.moveNext=function(){return!this._complete&&(this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),this._sourceEnumerator.$$mn()&&this.evaluatePredicate(this._sourceEnumerator.$$cu())?(this._index++,!0):(this._complete=!0,this._sourceEnumerator=null,!1))},t.reset=function(){this._sourceEnumerator=null,this._index=0},t.evaluatePredicate=function(e){return this._indexedPreciate?this._indexedPreciate(e,this._index):this._simplePredicate(e)},e}();Object(i.a)(w,"TakeWhileEnumerator",null,[35,65]);var T=function(){function e(e,t){this._sourceEnumerator=null,this._shouldCloneForGetEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e,this._test=t}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._source,this._test):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._sourceEnumerator.$$cu()},t.moveNext=function(){for(this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge());this._sourceEnumerator.$$mn();)if(this._test(this._sourceEnumerator.$$cu()))return!0;return!1},t.next=function(){for(this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge());this._sourceEnumerator.$$mn();)if(this._test(this._sourceEnumerator.$$cu()))return{done:!1,value:this._sourceEnumerator.$$cu()};return{done:!0,value:void 0}},t.reset=function(){this._sourceEnumerator=null},e}();Object(i.a)(T,"WhereEnumerator",null,[35,65]);var E=function(){function e(e,t,n){this._firstEnumerator=null,this._secondEnumerator=null,this._shouldCloneForGetEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._first=e,this._second=t,this._resultSelector=n}var t=e.prototype;return t.getEnumerator=function(){return this._shouldCloneForGetEnumerator?new e(this._first,this._second,this._resultSelector):(this._shouldCloneForGetEnumerator=!0,this)},t[Symbol.iterator]=function(){return Object(p.b)(this.getEnumerator())},t.get_current=function(){return this._current},t.moveNext=function(){return this._firstEnumerator||(this._firstEnumerator=this._first.$$ge(),this._secondEnumerator=this._second.$$ge()),!(!this._firstEnumerator.$$mn()||!this._secondEnumerator.$$mn())&&(this._current=this._resultSelector(this._firstEnumerator.$$cu(),this._secondEnumerator.$$cu()),!0)},t.reset=function(){this._firstEnumerator=null,this._secondEnumerator=null},e}();function k(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}Object(i.a)(E,"ZipEnmerator",null,[35,65]),n.d(t,"asEnumerable",(function(){return P})),n.d(t,"fromIterator",(function(){return F})),n.d(t,"select",(function(){return D})),n.d(t,"Si",(function(){return O})),n.d(t,"SMi",(function(){return R})),n.d(t,"selectMany",(function(){return x})),n.d(t,"skip",(function(){return U})),n.d(t,"skipWhile",(function(){return B})),n.d(t,"SWI",(function(){return L})),n.d(t,"take",(function(){return N})),n.d(t,"takeWhile",(function(){return H})),n.d(t,"TW",(function(){return W})),n.d(t,"where",(function(){return j})),n.d(t,"first",(function(){return V})),n.d(t,"FT",(function(){return K})),n.d(t,"firstOrDefault",(function(){return z})),n.d(t,"FDT",(function(){return q})),n.d(t,"last",(function(){return G})),n.d(t,"LT",(function(){return Q})),n.d(t,"lastOrDefault",(function(){return Z})),n.d(t,"LDT",(function(){return $})),n.d(t,"cast",(function(){return X})),n.d(t,"any",(function(){return J})),n.d(t,"AT",(function(){return Y})),n.d(t,"all",(function(){return ee})),n.d(t,"count",(function(){return te})),n.d(t,"Ct",(function(){return ne})),n.d(t,"CT",(function(){return ie})),n.d(t,"aggregate",(function(){return re})),n.d(t,"AgS",(function(){return ae})),n.d(t,"AgSS",(function(){return oe})),n.d(t,"concat",(function(){return se})),n.d(t,"repeat",(function(){return le})),n.d(t,"zip",(function(){return ce})),n.d(t,"orderBy",(function(){return ue})),n.d(t,"OBc",(function(){return de})),n.d(t,"orderByDescending",(function(){return pe})),n.d(t,"OBdc",(function(){return he})),n.d(t,"thenBy",(function(){return me})),n.d(t,"TBc",(function(){return ge})),n.d(t,"thenByDescending",(function(){return fe})),n.d(t,"TBDc",(function(){return ve})),n.d(t,"toList",(function(){return _e})),n.d(t,"toArray",(function(){return ye})),n.d(t,"toDictionary",(function(){return be})),n.d(t,"TD",(function(){return Se})),n.d(t,"SumS",(function(){return Ce})),n.d(t,"MinS",(function(){return Ae})),n.d(t,"MaxS",(function(){return Ie})),n.d(t,"empty",(function(){return we}));var P=function(e){return new a(e)},F=function(e){return new v(e)},D=function(e,t){return new b(e,t,null)},O=function(e,t){return new b(e,null,t)},R=function(e,t){return new S(e,null,t)},x=function(e,t){return new S(e,t,null)},U=function(e,t){return new C(e,t)},B=function(e,t){return new A(e,t,null)},L=function(e,t){return new A(e,null,t)},N=function(e,t){return new I(e,t)},H=function(e,t){return new w(e,t,null)},W=function(e,t){return new w(e,null,t)},j=function(e,t){return new T(e,t)},V=function(e){var t=e.$$ge();if(!t.$$mn())throw Error.argumentNull("source");return t.$$cu()},K=function(e,t){var n=e.$$ge();do{if(!n.$$mn())throw Error.argumentNull("source")}while(!t(n.$$cu()));return n.$$cu()},z=function(e,t){void 0===t&&(t=null);var n=e.$$ge();return n.$$mn()?n.$$cu():t},q=function(e,t,n){void 0===n&&(n=null);var i=e.$$ge();do{if(!i.$$mn())return n}while(!t(i.$$cu()));return i.$$cu()},G=function(e){var t,n=e.$$ge();if(!n.$$mn())throw Error.argumentNull("source");do{t=n.$$cu()}while(n.$$mn());return t},Q=function(e,t){for(var n,i=e.$$ge();(n=i.$$mn())&&!t(i.$$cu()););if(!n)throw Error.argumentNull("source");for(var r=i.$$cu();i.$$mn();)t(i.$$cu())&&(r=i.$$cu());return r},Z=function(e,t){void 0===t&&(t=null);var n,i=e.$$ge();if(!i.$$mn())return t;do{n=i.$$cu()}while(i.$$mn());return n},$=function(e,t,n){void 0===n&&(n=null);for(var i,r=e.$$ge();(i=r.$$mn())&&!t(r.$$cu()););if(!i)return n;for(var a=r.$$cu();r.$$mn();)t(r.$$cu())&&(a=r.$$cu());return a},X=function(e){return new h(e)},J=function(e){return e.$$ge().$$mn()},Y=function(e,t){for(var n,i=k(e);!(n=i()).done;){if(t(n.value))return!0}return!1},ee=function(e,t){for(var n,i=k(e);!(n=i()).done;){if(!t(n.value))return!1}return!0},te=function(e){for(var t,n=0,i=k(e);!(t=i()).done;){t.value;n++}return n},ne=function(e){for(var t,n=0,i=k(e);!(t=i()).done;){t.value;n++}return n},ie=function(e,t){for(var n=e.$$ge(),i=0;n.$$mn();)t(n.$$cu())&&i++;return i},re=function(e,t){var n=e.$$ge();if(!n.$$mn())throw Error.invalidOperation("source contains no elements");for(var i=n.$$cu();n.$$mn();)i=t(i,n.$$cu());return i},ae=function(e,t,n){for(var i,r=k(e);!(i=r()).done;){t=n(t,i.value)}return t},oe=function(e,t,n,i){for(var r,a=k(e);!(r=a()).done;){t=n(t,r.value)}return i(t)},se=function(e,t){return new m(e,t)},le=function(e,t){return new y(e,t)},ce=function(e,t,n){return new E(e,t,n)},ue=function(e,t){return new _(e,t,null,null,!1)},de=function(e,t,n){return new _(e,t,n,null,!1)},pe=function(e,t){return new _(e,t,null,null,!0)},he=function(e,t,n){return new _(e,t,n,null,!0)},me=function(e,t){return new _(e,t,null,e,!1)},ge=function(e,t,n){return new _(e,t,n,e,!1)},fe=function(e,t){return new _(e,t,null,e,!0)},ve=function(e,t,n){return new _(e,t,n,e,!0)},_e=function(e){for(var t,n=new s.a,i=k(e);!(t=i()).done;){var r=t.value;n.add(r)}return n},ye=function(e){return _e(e).toArray()},be=function(e,t){for(var n,i=new o.a(d.get_default()),r=k(e);!(n=r()).done;){var a=n.value;i.add(t(a),a)}return i},Se=function(e,t,n){for(var i,r=new o.a(d.get_default()),a=k(e);!(i=a()).done;){var s=i.value;r.add(t(s),n(s))}return r},Ce=function(e,t){for(var n,i=0,r=k(e);!(n=r()).done;){i+=t(n.value)}return i},Ae=function(e,t){for(var n,i=Number.POSITIVE_INFINITY,r=k(e);!(n=r()).done;){var a=t(n.value);a<i&&(i=a)}return i},Ie=function(e,t){for(var n,i=Number.NEGATIVE_INFINITY,r=k(e);!(n=r()).done;){var a=t(n.value);a>i&&(i=a)}return i},we=function(){return new g}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(1),a=n(40),o=n(115),s=(n(9),n(16)),l=n(13),c="height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",u=function(e,t,n,i){var r=g(e)+"WAEndUser";if(i){var a=n.indexOf("_")>0?n:r+"_"+n;n?window.parent.HelpWindowKey(a):window.parent.HelpWindow()}else{if(n.indexOf("_")>0){var o=n.split("_");if(2!==o.length)return void 0;r=o[0],n=o[1]}n&&"home"===n.toLowerCase()&&(n="");var s="&p1="+r+"&apps=WDWAENDUSER%2CXLWAENDUSER%2CPPWAENDUSER%2CONWAENDUSER";n&&(s+="&HelpID="+n),d(!0,"rlidOfficeWebHelp",t,s,c)}},d=function(e,t,n,i,r){var a=e?p(t,n):h(t,n);i&&(a+=i),r?s.a.safelyOpenWindow(a,"_blank",r,void 0,"RedirectUrl.OpenWindowToUrl.Blank"):s.a.safelyOpenWindow(a,void 0,void 0,void 0,"RedirectUtil.OpenWindowToUrl")},p=function(e,t){return"https://r.office.microsoft.com/r/"+e+"?clid="+t.toString()+"&ver=15"},h=function(e,t){return"https://go.microsoft.com/fwlink/?LinkID="+e+"&clcid="+l.a.convertToHex(t,4)},m=function(e){switch(e){case 1:return"Excel";case 2:return"Word";case 3:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return""}},g=function(e){switch(e){case 1:return"XL";case 2:return"WD";case 3:return"PP";case 4:return"ON";case 5:return"VI";default:return""}},f=n(8);n.d(t,"Redirect",(function(){return v}));var v=function(){function e(){}return e.registerActions=function(t){var n=r.AFrameworkApplication.theActionManager,i=e.redirectAction;n.addAction(f.a.help,t,i),n.addAction(f.a.privacyLink,t,i),n.addAction(f.a.openTermsOfUseLink,t,i),n.addAction(f.a.showThirdPartyNotices,t,i),n.addAction(f.a.showTrustCenter,t,i)},e.registerAction=function(t,n){var i=r.AFrameworkApplication.theActionManager,a=e.redirectAction;i.addAction(n,t,a)},e.showHelp=function(t){u(e.application,r.AFrameworkApplication.lcid,t,r.AFrameworkApplication.useParentHelpFunction)},e.toFwlink=function(e){d(!1,e,r.AFrameworkApplication.lcid,null,null)},e.isHelpAvailable=function(){return!0},e.redirectAction=function(t,n,i,l,p){var h=4;switch(t){case f.a.accessibilityHelp:h=7;break;case f.a.help:case f.a.privacyLink:case f.a.openTermsOfUseLink:case f.a.showThirdPartyNotices:case f.a.showTrustCenter:break;default:return 2}if(1===i)return 32;switch(t){case f.a.privacyLink:r.AFrameworkApplication.privacyUrl&&s.a.safelyOpenWindow(r.AFrameworkApplication.privacyUrl,void 0,void 0,void 0,"Redirect.PrivayLink");break;case f.a.openTermsOfUseLink:r.AFrameworkApplication.termsUrl&&s.a.safelyOpenWindow(r.AFrameworkApplication.termsUrl,void 0,void 0,void 0,"Redirect.OpenTermsOfUseLink");break;case f.a.help:e.showHelp("");break;case f.a.showThirdPartyNotices:s.a.safelyOpenWindow(a.a.staticContentHost+r.AFrameworkApplication.scriptFolderPath+"TPN\\thirdPartyNotices.html","_blank",c,void 0,"Redirect.ShowThirdPartyNotices");break;case f.a.showTrustCenter:o.PrivacyDialogManager.showCommercialTrustCenterDialog();break;default:!function(e,t,n){m(e);switch(n){case 4:u(e,t,null,!1);break;case 7:2===e?d(!1,"325036",t,"",c):4===e&&d(!1,"864324",t,"",c)}}(e.application,r.AFrameworkApplication.lcid,h)}return 32},e}();v.application=0,Object(i.a)(v,"Redirect",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.IsFreeForm="IsFreeForm",r.Value="Value",r.Key="Key",r.FontStyle="FontStyle",Object(i.a)(r,"ComboBoxCommandProperties",null,[])},function(e,t,n){"use strict";var i=n(0),r=(n(9),n(83));function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(e,t){if(-1===e.indexOf("{"))throw Error.argument("find","find string needs to use curly braces");this._findReplacePair=new r.a(new RegExp(e,"gi"),t),this._includedString=e}var t,n,i;return e.prototype.replaceIn=function(e){return this._findReplacePair.performReplaceOn(e)},t=e,(n=[{key:"includedString",get:function(){return this._includedString}}])&&a(t.prototype,n),i&&a(t,i),e}();Object(i.a)(o,"UserStringReplacement",null,[]),n.d(t,"a",(function(){return s}));var s=function(){function e(){}return e.formatResourceStrings=function(t){var n=t,i=e.buildReplacements(),r=i.length;for(var a in n){var o={key:a,value:n[a]},s=o.value;if("string"==typeof s){var l=s;if(-1===l.indexOf("{"))continue;for(var c=0;c<r;c++)e.shouldSkipUnnecessaryRegexReplace&&i[c].includedString&&l.indexOf(i[c].includedString)<0||(l=i[c].replaceIn(l));n[o.key]=l}}},e.formatSingleString=function(t){var n=e.buildReplacements(),i=n.length,r=t;if(!r||-1===r.indexOf("{"))return r;for(var a=0;a<i;a++)e.shouldSkipUnnecessaryRegexReplace&&n[a].includedString&&r.indexOf(n[a].includedString)<0||(r=n[a].replaceIn(r));return r},e.buildReplacements=function(){return e._replacements||(e._replacements=[new o("{webappfull}",e.applicationNameLong),new o(e._webappshort,e.applicationNameShort),new o("{richclientfull}",e.richClientNameLong),new o("{appshort}",e.applicationNameOnly),new o("{doctype}",e.documentType),new o("{doctypetitlecase}",e.documentTypeTitleCase),new o("{doctypeplural}",e.documentTypePlural),new o("{subdoctype}",e.subDocumentType),new o("{officefull}",CommonUIStrings.l_OfficeNameLong),new o("{officeshort}",CommonUIStrings.l_OfficeNameShort),new o("{onedrive}",CommonUIStrings.l_OneDriveName),new o("{brandingstring}",CommonUIStrings.l_BrandingString),new o("{brandingstringplural}",CommonUIStrings.l_BrandingString),new o("{skype}",CommonUIStrings.l_SkypeName)])},e}();s._webappshort="{webappshort}",s.applicationNameLong=null,s.applicationNameShort=null,s.documentType=null,s.documentTypeTitleCase=null,s.documentTypePlural=null,s.richClientNameLong=null,s.subDocumentType=null,s.applicationNameOnly=null,s.shouldSkipUnnecessaryRegexReplace=!1,s._replacements=null,Object(i.a)(s,"UserStringFormatter",null,[])},function(e,t,n){"use strict";var i,r=n(175),a=n(187),o=n(0);!function(e){e[e.count=0]="count",e[e.avg=1]="avg",e[e.sum=2]="sum"}(i||(i={})),Object(o.b)("ScorecardAggregateMethod",i);var s=n(61),l=n(66),c=n(88),u=n(3),d=n(46);n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return f}));var p="",h=function(e,t,n,i,o,d,h){void 0===t&&(t=!0),void 0===n&&(n=p),void 0===i&&(i=0),void 0===o&&(o=0),void 0===d&&(d=0),void 0===h&&(h=null);var m=s.ActionManager.commandIdResolver(e)||s.ActionManager.actionIdResolver(e)||"";m.length>0?c.a.sendUserActionEvent(l.a.createUserActionCustomData(m,n,r.a[i],a.a[o],h,e,null,t,d)):u.ULS.sendTraceTag(51500117,383,15,"Could not determine action name for actionId: "+e+". Dropping this action")},m=function(e,t,n,i,o,d,h){void 0===t&&(t=!0),void 0===n&&(n=p),void 0===i&&(i=0),void 0===o&&(o=0),void 0===d&&(d=0),void 0===h&&(h=null);var m=s.ActionManager.commandIdResolver(e)||s.ActionManager.actionIdResolver(e)||"";m.length>0?c.a.sendUserActionEvent(l.a.createUserActionEvent(m,n,r.a[i],a.a[o],h,e,null,t,d)):u.ULS.sendTraceTag(51500118,383,15,"Could not determine action name for actionId: "+e+". Dropping this action")},g=function(e,t,n,i){void 0===t&&(t=!0),void 0===n&&(n=0),void 0===i&&(i=null),e&&e.length?c.a.sendActivityEvent(l.a.createActivityEvent(e,t,n,i)):u.ULS.sendTraceTag(588124555,383,15,"Dropping Otel activity because the name is null or empty.")},f=function(e,t,n,r,a,o){if(void 0===t&&(t=null),void 0===n&&(n=0),void 0===r&&(r=!0),void 0===a&&(a=0),void 0===o&&(o=null),e&&e.length)if(!n||t){var s=[Object.assign(new d.a,{name:"WAC_Experiment",string:i[n]}),Object.assign(new d.a,{name:"WAC_Experiment_Value",double:t}),Object.assign(new d.a,{name:"WAC_Experiment_EventName",string:"WAC_Exp_"+e+"_"+i[n]})];o?o.push.apply(o,s):o=s,c.a.sendActivityEvent(l.a.createActivityEvent(e,r,a,o))}else u.ULS.sendTraceTag(588124557,383,15,"Dropping Otel activity for experiment because the activityValue for ({0}) is null when scorecardAggregateMethod is set to ({1}).",e,i[n]);else u.ULS.sendTraceTag(588124556,383,15,"Dropping Otel activity for experiment because the name is null or empty.")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(45),a=function(){};a.LabelText=r.a.labelText,a.LabelTextUserGeneratedPlaceholderReplacements=r.a.labelTextUserGeneratedPlaceholderReplacements,a.Visible=r.a.visible,a.ImageIsVisible="ImageIsVisible",a.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible",a.Image16by16Class=r.a.image16by16Class,a.Image32by32Class=r.a.image32by32Class,a.Image48by48Class=r.a.image48by48Class,a.ImageBackColor="ImageBackColor",a.On="On",a.SourceControlId="SourceControlId",Object(i.a)(a,"FlyoutAnchorCommandProperties",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(19),a=n(67),o=n(68),s=n(27),l=n(88),c=n(3),u=n(150),d=n(46),p=function(){this.application=null,this.applicationLcid=null,this.applicationMode=null,this.applicationModeExtended=null,this.arrVersion=null,this.browser=null,this.browserLcid=null,this.browserMajorVersion=null,this.browserVersion=null,this.clientVersion=null,this.datacenter=null,this.dataCulture=null,this.fileExtension=null,this.flightsImpressionId=null,this.host=null,this.isAnonymousUser=null,this.isBusinessUser=null,this.isEduUser=null,this.isSynthetic=null,this.loggableUserId=null,this.loggableUserIdSpace=null,this.ring=null,this.serverDocId=null,this.session_id=null,this.sessionOrigin=null,this.tenantId=null,this.uiHost=null,this.wfeVersion=null};function h(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}Object(i.a)(p,"HealthDimensions",null,[]),n.d(t,"a",(function(){return g}));var g=function(){function e(){}return e.getSessionDimensions=function(){var e=n(1).AFrameworkApplication;return e.appSettingsManager&&e.sessionStartInfoSettings?Object.assign(new p,{application:Object(r.a)(String,e.sessionStartInfoSettings.Application)||"",applicationLcid:Object(r.a)(String,e.sessionStartInfoSettings.ApplicationLCID)||"",applicationMode:Object(r.a)(String,e.sessionStartInfoSettings.ApplicationMode)||"",applicationModeExtended:Object(r.a)(String,e.sessionStartInfoSettings.ApplicationModeExtended)||"",arrVersion:Object(r.a)(String,e.sessionStartInfoSettings.ARRVersion)||"",browser:Object(r.a)(String,e.sessionStartInfoSettings.Browser)||"",browserLcid:Object(r.a)(String,e.sessionStartInfoSettings.BrowserLCID)||"",browserMajorVersion:Object(r.a)(String,e.sessionStartInfoSettings.BrowserMajorVersion)||"",browserVersion:Object(r.a)(String,e.sessionStartInfoSettings.BrowserVersion)||"",clientVersion:e.buildVersion,datacenter:Object(r.a)(String,e.sessionStartInfoSettings.WACDatacenter)||"",dataCulture:Object(r.a)(String,e.sessionStartInfoSettings.DataCulture)||"",fileExtension:Object(r.a)(String,e.sessionStartInfoSettings.FileExtension)||"",flightsImpressionId:Object(r.a)(String,e.sessionStartInfoSettings.FlightsImpressionId)||"",host:Object(r.a)(String,e.sessionStartInfoSettings.Host)||"",isAnonymousUser:e.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"),isBusinessUser:!!e.sessionStartInfoSettings.IsBusinessUser,isEduUser:!!e.sessionStartInfoSettings.IsEduUser,isSynthetic:Boolean.parse(Object(r.a)(String,e.sessionStartInfoSettings.IsSynthetic)||"false"),loggableUserId:e.appSettingsManager.getStringAppSetting("LoggableUserId")||"",loggableUserIdSpace:e.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||"",ring:Object(r.a)(String,e.sessionStartInfoSettings.Ring)||"-1",serverDocId:Object(r.a)(String,e.sessionStartInfoSettings.ServerDocId)||"",session_id:Object(r.a)(String,e.sessionStartInfoSettings.WACSessionID)||"",sessionOrigin:Object(r.a)(String,e.sessionStartInfoSettings.SessionOrigin)||"",tenantId:e.appSettingsManager.getStringAppSetting("TenantId")||"",uiHost:Object(r.a)(String,e.sessionStartInfoSettings.UiHost)||"",wfeVersion:Object(r.a)(String,e.sessionStartInfoSettings.WFEVersion)||""}):(c.ULS.sendTraceTag(589825177,383,10,"AppSettingsManager is null so we can't initialize the session dimensions"),null)},e.initialize=function(){var t=n(1).AFrameworkApplication,i=n(85).Health;try{if(!t.appSettingsManager)return void c.ULS.sendTraceTag(42554066,383,10,"AppSettingsManager is null so couldn't fully initialize Health.");if(e.isHealthTelemetrySystemEnabled=t.appSettingsManager.getBooleanAppSetting("HealthTelemetrySystemIsEnabled"),e.isHealthTelemetrySystemEnabled){e.isQosRecorderEnabled=t.appSettingsManager.getBooleanAppSetting("IsQosRecorderEnabled"),e.isKpiRecorderEnabled=t.appSettingsManager.getBooleanAppSetting("IsKpiRecorderEnabled"),e.shouldInstallWorkerOnBoot=t.appSettingsManager.getBooleanAppSetting("HealthShouldInstallWorkerOnBoot"),e.shouldUseNewLogger=t.appSettingsManager.getBooleanAppSetting("HealthUseNewRemoteTelemetryLogger"),e.shouldUseOtelCsForAllEvents=t.appSettingsManager.getBooleanAppSetting("HealthUseOtelCsForAllEvents"),e.shouldUseOfflineWorker=t.appSettingsManager.getBooleanAppSetting("HealthUseOfflineWorker"),e.shouldUseXhr=t.appSettingsManager.getBooleanAppSetting("HealthTelemetrySystemShouldUseXhr"),e.offlineWorkerUrl=t.appSettingsManager.getStringAppSetting("HealthOfflineWorkerScriptUrl"),e.remoteTelemetryUrl=t.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),e.heartbeatIntervalMs=t.appSettingsManager.getIntAppSetting("HealthTelemetrySystemHeartbeatIntervalMs",3e5),e.recordQosPillarToWarmPipelineIntervalMs=t.appSettingsManager.getIntAppSetting("HealthTelemetrySystemRecordQosPillarToWarmPipelineIntervalMs",864e5),e.loggerMaxQueueSize=t.appSettingsManager.getIntAppSetting("HealthTelemetrySystemLoggerMaxQueueSize",25),e.loggerMaxIntervalMs=t.appSettingsManager.getIntAppSetting("HealthTelemetrySystemLoggerMaxIntervalMs",3e4);var s=n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsHostTopologyEnabled");if(i.instance){i.instance.setQosHandlerForWarmPipeline((function(t,n,i){e.sendToWarmPipeline(t,n,i)})),i.instance.setKpiHandlerForWarmPipeline((function(t,n,i){e.sendToWarmPipeline(t,n,i)})),i.instance.setQosHandlerForOtelLibraryLoader((function(){try{c.ULS.sendTraceTag(589837636,383,50,"Attempting to download otelfull.min.js after encountering a session ending error"),a.a.get_instance().isCompleted(13)||a.a.get_instance().setAppInitializationStatus(13),o.a.instance.tryInitializePackage("Common.App.OtelLibraryLoader")}catch(e){c.ULS.sendTraceTag(594649997,383,10,"Failed to initialize OTelJS after a session ending error: "+e)}})),i.instance.setHandlerForIsOtelJsReady((function(){return l.a.isOtelReady()&&e.isAppOnline})),i.instance.setHandlerForIsAppShuttingDown((function(){return t.isShuttingDown})),i.instance.addOrUpdatePartCDimension("FileSizeBucket",Object(r.a)(String,t.sessionStartInfoSettings.FileSizeBucket)||""),i.instance.addOrUpdatePartCDimension("HostSessionId",Object(r.a)(String,t.sessionStartInfoSettings.HostSessionId)||"");var u=Object(r.a)(String,n(1).AFrameworkApplication.sessionStartInfoSettings.Application)||"";if("OneNote"!==u&&"Visio"!==u||i.instance.addOrUpdatePartCDimension("IsOcsSession","false"),"Word"===u&&s){var d=function(e){var t="";if(e&&e.HostResponseStats){var i=n(1).AFrameworkApplication.dataPlumber.HostResponseStats.Geo,r=n(1).AFrameworkApplication.dataPlumber.HostResponseStats.Label;i&&i.length>0&&r&&r.length>0?t=i+"/"+r:i&&i.length>0&&(t=i)}return t}(n(1).AFrameworkApplication.dataPlumber);d&&d.length>0&&i.instance.addOrUpdatePartCDimension("HostTopology",d)}e.shouldUseOfflineWorker&&(e.shouldInstallWorkerOnBoot?e.startOfflineWorker():a.a.get_instance().executeWhen(8,e.startOfflineWorker))}i.instance.addQosPillar("Open"),i.instance.addQosPillar("Interruptions"),i.instance.addQosPillar("Consumption"),e.errorIDAlreadyReported={}}e.registerEvents()}catch(t){c.ULS.sendTraceTag(50677138,383,15,"Failed to initialize the health telemetry system: "+t),e.isHealthTelemetrySystemEnabled=!1,e.isQosRecorderEnabled=!1,e.isKpiRecorderEnabled=!1}},e.addConnectivityListener=function(t){var i=n(506).HealthConnectivityListener;e.shouldUseOfflineWorker&&(t?(t.addNetworkConnectivityListener(new i),c.ULS.sendTraceTag(579187396,383,50,"Added HealthConnectivityListener to TheClientRequestManager")):c.ULS.sendTraceTag(579393665,383,15,"AFrameworkApplication.TheClientRequestManager is null, so we can't listen for connectivity changes"))},e.onAppSleepHandler=function(e,t){var i=n(85).Health;c.ULS.sendTraceTag(594616329,383,50,"App going to sleep, pausing health heartbeat"),i.instance.stopAllHealthTimers()},e.onAppWakeupHandler=function(e,t){var i=n(85).Health;c.ULS.sendTraceTag(594616328,383,50,"App waking up, resuming health heartbeat"),i.instance.resumeAllHealthTimers()},e.registerEvents=function(){var t=n(1).AFrameworkApplication;t.add_appSleep(e.onAppSleepHandler),t.add_appWakeup(e.onAppWakeupHandler)},e.sendToWarmPipeline=function(e,t,n){try{var i=new u.a;i.name=e,i.succeeded=t,i.dataFields=new Array(0);for(var r,a=h(n);!(r=a()).done;){var o=r.value;"DurationMs"===o.getName()&&(i.durationMs=Number.parseInvariant(o.getValue()));var s=new d.a;s.name=o.getName();var p=o.getType(),m=o.getValue();"string"===p?s.string=m:"int"===p?s.int64=Number.parseInvariant(m):"boolean"===p&&(s.bool=Boolean.parse(m)),Array.add(i.dataFields,s)}l.a.sendActivityEvent(i)}catch(e){c.ULS.sendTraceTag(50931778,383,15,"Exception in SendToWarmPipeline occurred: "+e)}},e.startOfflineWorker=function(){n(85).Health.instance.startOfflineWorker(s.a.getAbsoluteUrl(e.remoteTelemetryUrl),e.offlineWorkerUrl)},e.recordBSqmQosError=function(t,i,r,a){void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=null);var o=n(85).Health;if(e.isHealthTelemetrySystemEnabled)try{if(e.errorIDAlreadyReported){if(t in e.errorIDAlreadyReported)return void c.ULS.sendTraceTag(595353998,383,50,"Not reporting errorID "+t+" again.");e.errorIDAlreadyReported[t]=1}if(i){var s=i.processBsqmQosError(t,r,a);o.instance.recordBsqmQosError(t,s.additionalVetos,s.additionalValues)}else o.instance.recordBsqmQosError(t,r,a)}catch(e){c.ULS.sendTraceTag(50931779,383,15,"Exception in RecordBSqmQosError occurred: "+e)}},e}();g.isHealthTelemetrySystemEnabled=!1,g.isQosRecorderEnabled=!1,g.isKpiRecorderEnabled=!1,g.isAppOnline=!0,g.shouldInstallWorkerOnBoot=!1,g.shouldUseNewLogger=!1,g.shouldUseOtelCsForAllEvents=!1,g.shouldUseOfflineWorker=!1,g.shouldUseXhr=!1,g.offlineWorkerUrl="",g.remoteTelemetryUrl="",g.heartbeatIntervalMs=3e5,g.recordQosPillarToWarmPipelineIntervalMs=864e5,g.loggerMaxQueueSize=25,g.loggerMaxIntervalMs=3e4,g.errorIDAlreadyReported=null,Object(i.a)(g,"HealthUtils",null,[])},function(e,t,n){"use strict";var i=n(1),r=(n(129),n(185),n(0)),a=function(){this.command=null,this.label=null,this.image=null,this.id=null,this.keytip=null};Object(r.a)(a,"HeaderButtonInfo",null,[]);var o=n(302);n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return g}));var s=function(){return i.AFrameworkApplication.isEmbedded},l=function(){var e=i.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled;return!s()&&!i.AFrameworkApplication.hideHeader&&o.a()&&(e||1===i.AFrameworkApplication.freemiumUpsellMode)},c=function(){return i.AFrameworkApplication.shouldShowSwitcher&&!s()&&!i.AFrameworkApplication.hideHeader},u=function(){return c()&&(e="officecomhwa"===(i.AFrameworkApplication.appSettingsManager.getStringAppSetting(i.AFrameworkApplication.uiHostSettingName)||"").toLowerCase(),!e);var e},d=function(){return c()},p=function(e){return e&&!!i.AFrameworkApplication.activeFrame&&i.AFrameworkApplication.activeFrame.applicationInstance.isSimplifiedReactRibbonUxFlightEnabled&&i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptOutSupportForSimplifiedRibbonIsEnabled")&&!i.AFrameworkApplication.activeFrame.applicationInstance.isSimplifiedUXOptOutInViewTabFlightEnabled&&!i.AFrameworkApplication.activeFrame.applicationInstance.isReactMultilineRibbonEnabled},h=function(){return!s()&&!i.AFrameworkApplication.hideHeader&&i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BasicChatIsEnabled")},m=function(){return!!i.AFrameworkApplication.activeFrame&&i.AFrameworkApplication.activeFrame.applicationInstance.isSimplifiedReactRibbonUxEnabled},g=function(){var e=i.AFrameworkApplication.isReplyWithChangesWorkFlow&&!!i.AFrameworkApplication.replyWithChangesUrl||i.AFrameworkApplication.useReplyWithChangesPostMessage,t=!!i.AFrameworkApplication.activeFrame&&i.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled;if(e&&t)return Object.assign(new a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:n(38).CuiHelper.replyWithChangesButtonId});if(i.AFrameworkApplication.workflowEnabled){var r="";switch(i.AFrameworkApplication.workflowTypeString){case"Assign":r=CommonUIStrings.l_Assign;break;case"Submit":r=CommonUIStrings.l_Submit}if(""!==r)return Object.assign(new a,{command:"2988588587",label:r,id:"btnWorkflow"})}return null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(e){this._valueCreator=e}var t,n,i;return t=e,(n=[{key:"hasValue",get:function(){return!this._valueCreator}},{key:"value",get:function(){return this.hasValue||(this._value=this._valueCreator(),this._valueCreator=null),this._value}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"Lazy",null,[])},function(e,t,n){"use strict";var i,r=n(0),a=n(2),o=n(11);!function(e){e[e.cancel=0]="cancel",e[e.action=1]="action",e[e.ok=1]="ok",e[e.yes=1]="yes",e[e.secondaryAction=2]="secondaryAction",e[e.retry=2]="retry",e[e.no=2]="no",e[e.tertiaryAction=3]="tertiaryAction",e[e.quaternaryAction=4]="quaternaryAction"}(i||(i={})),Object(r.b)("DialogButton",i);n(9);var s=n(4),l=n(24),c=n(17),u=n(25),d=n(20),p=n(97),h=n(66),m=n(8),g=n(7),f=n(22),v=n(16),_=n(13),y=n(21),b=n(35),S=n(3);function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return A}));var A=function(e){var t,r;function A(t,i,r,a){var o;void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===a&&(a=!1),(o=e.call(this,document.createElement("div"))||this)._id=null,o._dialogPanelCssClass="WACDialogPanel",o._messageBoxHandler=null,o._closeClickHandler=null,o._buttonClickHandler=null,o._buttonKeyHandler=null,o._clickManager=null,o._keyInputManager=null,o._dragAdapter=null,o._keyAdapter=null,o._windowScrollHandler=null,o._windowResizeHandler=null,o._btnAction=null,o._btnCancel=null,o._btnSecondary=null,o._btnTertiary=null,o._btnQuaternary=null,o._overlayElement=null,o._divOuterDialogContainer=null,o._divInnerDialogContainer=null,o._divMessageBox=null,o._bodyPanel=null,o._divMessageBoxTitle=null,o._buttonPanel=null,o._body=null,o._titleText=null,o._outerBody=null,o._menuLaunchPoint=null,o._okText="OK",o._cancelText="Cancel",o._closeText="Close",o._yesText="Yes",o._noText="No",o._retryText="Retry",o._permanentlyDeleteText="Permanently Delete",o._shareAndNotifyText="Share and notify",o._actionText="Action",o._secondaryActionText="Secondary Action",o._tertiaryActionText="Tertiary Action",o._quaternaryActionText="Quaternary Action",o._buttonText=new Array(3),o._buttonState=new Array(3),o._buttonDisplay=new Array(3),o._buttons=new Array(3),o._width=15,o._buttonsOption=0,o._keystrokeOnButtonPending=!1,o._revertToLastScope=!1,o._hasCloseGlyph=!1,o._windowMode="undefined",o._isRegisteredWithRegionComposer=!1,o._rectsWithoutKeyboard=[],o._disposed=!1,o._isDisposingAsync=!1,o._tabOrderLooped=!0,o._disposeOnHide=!0,o._hideOnButtonClick=!0,o._showTransparentOverlay=!1,o._dialogValues=null,o._closeAnchor=null,o._closeIconElement=null,o._dialogOnKeyDownHandler=null,o._dialogOnKeyPressHandler=null,o._dialogOnKeyUpHandler=null,o._overlayCssClass="WACDialogOverlay",o._menuRootUser=null,o._dismissFocusScope=null,o._isShowing=!1;var s=n(86).UISurfaces,c=n(31).AFrame,u=n(1).AFrameworkApplication;o._shouldPreemptExistingDialog=t,o._useReactDialog=u.activeFrame?r&&u.activeFrame.applicationInstance.isReactDialogEnabled:r,A.currentDialog&&(A.currentDialog.canBePreempted||t)&&!a&&A.currentDialog.hide(),A.currentDialog=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(o);try{o._okText=CommonUIStrings.l_DialogOk,o._cancelText=CommonUIStrings.l_DialogCancel,o._closeText=CommonUIStrings.l_DialogClose,o._yesText=CommonUIStrings.l_DialogYes,o._noText=CommonUIStrings.l_DialogNo,o._retryText=CommonUIStrings.l_DialogRetry,o._permanentlyDeleteText=CommonUIStrings.l_DialogPermanentlyDelete,o._shareAndNotifyText=CommonUIStrings.l_DialogShareAndNotify}catch(e){}o.isReactRibbonEnvironmentEnabled=!!u.activeFrame&&u.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled;try{o._outerBody=o.isReactRibbonEnvironmentEnabled&&!i||l.FocusManager.instance().currentScope.name===c.previewPanelId?document.body:u.activeFrame.getDOMElement()}catch(e){o._outerBody=document.body}return o._document=o._outerBody.ownerDocument,o._clientId=o.get_element().id,o.buttonsOption=1,o._defaultButton=1,o.hasTitleBar=!0,o.hasCloseGlyph=!0,o.hasButtonPanel=!0,o._useReactDialog&&(o._divOuterDialogContainer=o._document.createElement("div"),o._divOuterDialogContainer.id=o.myId("WACDialogOuterContainer"),o._divOuterDialogContainer.className="WACDialogOuterContainer",o._outerBody.insertBefore(o._divOuterDialogContainer,o._outerBody.firstChild),s.getDialogAPIAsync().then((function(e){return e.initialize(o._divOuterDialogContainer),null}))),o}r=e,(t=A).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var I,w,T,E=A.prototype;return E.prepareDialog=function(){var e=n(1).AFrameworkApplication,t=n(55).createClusteredImage,i=n(505).MoveDragAdapter;if(this.isModalDialog&&!this._overlayElement&&(this._overlayElement=this._document.createElement("div"),this._overlayElement.id=this.myId("WACDialogOverlay"),this._overlayElement.className=this._overlayCssClass),this._divOuterDialogContainer)for(;this._divOuterDialogContainer.firstChild;)this._divOuterDialogContainer.removeChild(this._divOuterDialogContainer.firstChild);else this._divOuterDialogContainer=this._document.createElement("div"),this._divOuterDialogContainer.id=this.myId("WACDialogOuterContainer"),this._divOuterDialogContainer.className="WACDialogOuterContainer";this._divInnerDialogContainer=this._document.createElement("div"),this._divInnerDialogContainer.id=this.myId("WACDialogInnerContainer"),this._divInnerDialogContainer.className="WACDialogInnerContainer",this._divMessageBox=this._document.createElement("div"),this._divMessageBox.id=this.myId("WACDialogPanel"),e.activeFrame&&e.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled?this._divMessageBox.className="MLRVisualRefresh "+this._dialogPanelCssClass:this._divMessageBox.className=this._dialogPanelCssClass,this._divMessageBox.setAttribute(g.a.ariaRoleAttribute,g.a.ariaDialogRole),this._divMessageBox.setAttribute(g.a.ariaLabelledByAttribute,this.myId("WACDialogTitleText")),this._clickManager=e.activeFrame?e.activeFrame.theClickInputManager:null,this._keyInputManager=e.activeFrame?e.activeFrame.theKeyInputManager:null,this._menuLaunchPoint=this._document.createElement("div"),this._menuLaunchPoint.className="WACDialogMenuLaunchPoint",this._divMessageBox.appendChild(this._menuLaunchPoint),this._divMessageBoxTitle=this._document.createElement("div"),this._divMessageBoxTitle.id=this.myId("WACDialogTitlePanel"),this._divMessageBoxTitle.className="WACDialogTitlePanel",this._titleText=this._document.createElement("div"),this._titleText.id=this.myId("WACDialogTitleText"),this._titleText.className="WACDialogTitleText",this._divMessageBoxTitle.appendChild(this._titleText),this.hasCloseGlyph&&(this._closeAnchor=this._document.createElement("a"),this.closeAnchor.className="WACGlyph WACDialogCloseAnchor",this.closeAnchor.setAttribute(g.a.ariaRoleAttribute,g.a.ariaButtonRole),this.closeAnchor.title=this._closeText,this._divMessageBoxTitle.appendChild(this.closeAnchor),this._closeIconElement=t(16,16,"ClosePaneGlyph_16x16x32","WACDialogCloseIcon",!0,""),this.closeAnchor.appendChild(this.closeIconElement)),this.hasTitleBar||(this._divMessageBoxTitle.style.display="none"),this._divMessageBox.appendChild(this._divMessageBoxTitle),this._bodyPanel=this._document.createElement("div"),this._bodyPanel.id=this.myId("WACDialogBodyPanel"),this._bodyPanel.className="WACDialogBodyPanel",this._divMessageBox.appendChild(this._bodyPanel),this._body=this._document.createElement("div"),this._body.id=this.myId("WACDialogBodyContent"),this._body.className="WACDialogBodyContent",this._bodyPanel.appendChild(this._body),this.hasButtonPanel&&(this._buttonPanel=this._document.createElement("div"),this._buttonPanel.id=this.myId("WACDialogButtonPanel"),this._buttonPanel.className="WACDialogButtonPanel",this._divMessageBox.appendChild(this._buttonPanel),this._btnAction=this.prepareButton(1,A._actionButtonId),this._buttonDisplay[2]&&(this._btnSecondary=this.prepareButton(2,A._secondaryButtonId)),this._buttonDisplay[3]&&(this._btnTertiary=this.prepareButton(3,A._tertiaryButtonId)),this._buttonDisplay[4]&&(this._btnQuaternary=this.prepareButton(4,A._quaternaryButtonId)),this._buttonDisplay[0]&&(this._btnCancel=this._document.createElement("button"),this._buttons[0]=this._btnCancel,this._btnCancel.id=this.myId(A._cancelButtonId),this._btnCancel.className="WACButton WACDialogButtonNormal",this.setButtonProperties(this._btnCancel,0),this._buttonPanel.appendChild(this._btnCancel))),this._overlayElement&&this._outerBody.insertBefore(this._overlayElement,this._outerBody.firstChild),this._outerBody.insertBefore(this._divOuterDialogContainer,this._outerBody.firstChild),this._divOuterDialogContainer.appendChild(this._divInnerDialogContainer),this._divInnerDialogContainer.appendChild(this._divMessageBox),this._windowScrollHandler||(this._windowScrollHandler=Object(a.d)(this,this.scrollFix,"scrollFix"),this._windowResizeHandler=Object(a.d)(this,this.sizeFix,"sizeFix"),c.a.addHandler(window.self,"scroll",this._windowScrollHandler),c.a.addHandler(window.self,"resize",this._windowResizeHandler)),this._dragAdapter=new i(this._divMessageBox),e.activeFrame&&e.activeFrame.theDragInputManager.registerDragAdapter(this._divMessageBoxTitle,this._dragAdapter),A.areRegionComposerAPIsAvailable()&&this.registerForRegionComposerEvents()},E.prepareButton=function(e,t){var n=this._document.createElement("button");return this._buttons[e]=n,n.id=this.myId(t),14===this.buttonsOption&&2===e?n.className="WACButton WACDialogButtonNormal WACAlignLeftButton":n.className="WACButton WACDialogButtonNormal",this.setButtonProperties(n,e),this._buttonPanel.appendChild(n),n},E.addMultiScreenClassNames=function(e){"DL"===e?(Sys.UI.DomElement.addCssClass(this._divMessageBox,"DL"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DP")):"DP"===e?(Sys.UI.DomElement.addCssClass(this._divMessageBox,"DP"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DL")):(Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DP"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DL"))},E.registerForRegionComposerEvents=function(){var e=this,t=n(1).AFrameworkApplication;this._windowMode=t.activeFrame.adaptiveLayoutInstance.getWindowMode(),this._rectsWithoutKeyboard=t.activeFrame.adaptiveLayoutInstance.getWindowRectsWithoutKeyboard(),this.addMultiScreenClassNames(this._windowMode),t.activeFrame.adaptiveLayoutInstance.registerBoundingWindowRectsChanged("legacyDialog",(function(n,i){e._rectsWithoutKeyboard=t.activeFrame.adaptiveLayoutInstance.getWindowRectsWithoutKeyboard(),e._windowMode=i,e.addMultiScreenClassNames(i),e.reSizeDialog()})),this._isRegisteredWithRegionComposer||this.reSizeDialog(),this._isRegisteredWithRegionComposer=!0},E.unRegisterForRegionComposerEvents=function(){var e=n(1).AFrameworkApplication;this._isRegisteredWithRegionComposer&&(e.activeFrame.adaptiveLayoutInstance.unregisterBoundingWindowRectsChanged("legacyDialog",null),this._isRegisteredWithRegionComposer=!1)},E.getMaxHeight=function(e){var t=n(1).AFrameworkApplication.activeFrame.adaptiveLayoutInstance.getKeyboardSegment();if(t){var i=t.left?0:t.height;return"DL"===this._windowMode?e:e-i}return e},E.needsToAvoidKeyboard=function(){if(this._rectsWithoutKeyboard&&this._rectsWithoutKeyboard.length>=1){var e=this._rectsWithoutKeyboard[0].height;if(this.getMaxHeight(e)!==e)return!0}return!1},E.getPageHeight=function(){if(A.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()){var e=this._rectsWithoutKeyboard[0].height;return this.getMaxHeight(e)}return A.pageHeight},E.getPageWidth=function(){return A.areRegionComposerAPIsAvailable()&&"DP"===this._windowMode&&this._rectsWithoutKeyboard.length>=1?this._rectsWithoutKeyboard[0].width:A.pageWidth},E.centerDialog=function(){var e=n(1).AFrameworkApplication;if(this._divMessageBox){var t=this._divMessageBox.style.zIndex;if(this._divMessageBox.style.zIndex="-9999",this._divMessageBox.offsetWidth<this.getPageWidth()){var i=String.format("{0}px",Math.floor(-this._divMessageBox.offsetWidth/2));e.isRtl?this._divMessageBox.style.marginRight=i:this._divMessageBox.style.marginLeft=i,"DP"!==this._windowMode&&(e.isRtl?this._divMessageBox.style.right="50%":this._divMessageBox.style.left="50%")}if(this._divMessageBox.offsetHeight<this.getPageHeight()&&this._divMessageBox.offsetTop>=0)if("DL"!==this._windowMode&&(this._divMessageBox.style.top="50%"),A.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()){var r=this.getMaxHeight(this._rectsWithoutKeyboard[0].height);this._divMessageBox.style.marginTop=String.format("{0}px",Math.floor((r-this._divMessageBox.clientHeight)/2)),this._divMessageBox.style.top="unset"}else this._divMessageBox.style.marginTop=String.format("{0}px",Math.floor(-this._divMessageBox.offsetHeight/2));else A.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()&&(this._divMessageBox.style.top="unset");this._divMessageBox.style.zIndex=String(t)}else S.ULS.sendTraceTag(17688785,306,10,"_divMessageBox is null in CenterDialog()")},E.cleanUp=function(){},E.dispose=function(){this.unRegisterForRegionComposerEvents(),this._useReactDialog?this.reactDispose():this.legacyDispose(),Sys.Component.prototype.dispose.call(this)},E.reactDispose=function(){var e=this,t=n(86).UISurfaces,i=n(1).AFrameworkApplication;this._isDisposingAsync||(this._isDisposingAsync=!0,t.getDialogAPIAsync().then((function(t){return t.dispose(),e.removeElement(e._divOuterDialogContainer),e._divOuterDialogContainer=null,A.currentDialog=null,e._disposed=!0,e._dialogValues=null,e.cleanUp(),e._isDisposingAsync=!1,null}))),!i.activeFrame&&this._divOuterDialogContainer&&this.removeElement(this._divOuterDialogContainer)},E.legacyDispose=function(){var e=n(1).AFrameworkApplication;this._disposed||(null!==this._windowScrollHandler&&(c.a.removeHandler(window.self,"scroll",this._windowScrollHandler),c.a.removeHandler(window.self,"resize",this._windowResizeHandler),this._windowScrollHandler=null,this._windowResizeHandler=null),e.activeFrame&&e.activeFrame.theDragInputManager&&this._divMessageBoxTitle&&this._dragAdapter&&e.activeFrame.theDragInputManager.unregisterDragAdapter(this._divMessageBoxTitle,this._dragAdapter),this._dragAdapter=null,this._clickManager=null,this._keyInputManager=null,this._keyAdapter&&this._keyAdapter.inMoveMode&&this._keyAdapter.exitMoveMode(),this._keyAdapter=null,this._divMessageBox&&f.DomUtils.elementAttached(this._divMessageBox)&&this.removeElement(this._divOuterDialogContainer),this._divOuterDialogContainer=null,this._divInnerDialogContainer=null,this._divMessageBox=null,this._btnAction=null,this._btnCancel=null,this._btnSecondary=null,this._btnTertiary=null,this._btnQuaternary=null,this._overlayElement=null,this._divMessageBoxTitle=null,this._buttonPanel=null,this._document=null,this._body=null,this._titleText=null,this._outerBody=null,this._closeAnchor=null,this._closeIconElement=null,A.currentDialog=null,this._disposed=!0)},E.removeElement=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},E.hideAllButtons=function(){this.setButtonVisiblity(1,!1),this.setButtonVisiblity(0,!1),this.setButtonVisiblity(2,!1),this.setButtonVisiblity(3,!1),this.setButtonVisiblity(4,!1)},E.clickHandler=function(e){return this.executeDismissButton(e.sourceElement,2),!0},E.keyHandler=function(e){return this.keyHandlerWithAction(e,Object(a.d)(this,this.executeDismissButtonFromArgs,"executeDismissButtonFromArgs"))},E.dialogDefaultEnterKeyHandler=function(e){var t=n(1).AFrameworkApplication;if(e.innerEvent.keyCode===Sys.UI.Key.enter&&"a"!==e.sourceElement.tagName.toLowerCase()){if(t.dialogDefaultEnterBehaviorIsEnabled&&this.hasButtons){var i=this.getButtonElement(this.getDefaultButton());this.executeDismissButton(i,1)}return!0}return!1},E.keyHandlerWithAction=function(e,t){if(e.innerEvent.ctrlKey||e.innerEvent.altKey||e.innerEvent.keyCode>=u.a.VK_F1&&e.innerEvent.keyCode<=u.a.VK_F12)return!1;if(e.eventName===s.EventNames.keyUp&&this._keystrokeOnButtonPending){var n=e.innerEvent.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||t(e),this._keystrokeOnButtonPending=!1}return e.eventName===s.EventNames.keyDown&&(this._keystrokeOnButtonPending=!0),!0},E.executeDismissButtonFromArgs=function(e){this.executeDismissButton(e.sourceElement,1)},E.onCheckboxFocusOrBlur=function(e){if(e){var t=e.target;0,e.type===s.EventNames.focus?Sys.UI.DomElement.addCssClass(t.parentNode,"WACDialogCheckboxDivHighlight"):Sys.UI.DomElement.removeCssClass(t.parentNode,"WACDialogCheckboxDivHighlight")}else S.ULS.sendTraceTag(18465239,306,10,"event is null in OnCheckboxFocusOrBlur")},E.attachFocusHandlersForCheckbox=function(e){if(e){var t=e.getElementsByTagName("input");if(t)for(var n=0;n<t.length;n++){var i=t[n];"checkbox"===_.a.toLower(i.type)&&(c.a.addHandler(i,s.EventNames.focus,Object(a.d)(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")),c.a.addHandler(i,s.EventNames.blur,Object(a.d)(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")))}}},E.detachFocusHandlersForCheckbox=function(e){if(e){var t=e.getElementsByTagName("input");if(t)for(var n=0;n<t.length;n++){var i=t[n];"checkbox"===_.a.toLower(i.type)&&(c.a.removeHandler(i,s.EventNames.focus,Object(a.d)(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")),c.a.removeHandler(i,s.EventNames.blur,Object(a.d)(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")))}}},E.executeDismissButton=function(e,t){void 0===t&&(t=0);var n=1;e===this._btnAction?n=1:e===this._btnCancel?n=0:e===this._btnSecondary?n=2:e===this._btnTertiary?n=3:e===this._btnQuaternary&&(n=4),this.validateAndHide(n,t)},E.logTelemetryInfo=function(e,t){if(this.ulsLogTelemetryInfo("Dialog"+i[e]),h.a.isUserActionLoggingToOtelEnabled()){var n=function(e){var t=0;switch(e){case 0:t=m.a.dialogCancel;break;case 1:t=m.a.dialogAction;break;case 2:t=m.a.dialogSecondaryAction;break;case 3:t=m.a.dialogTertiaryAction}return t}(e);n?(p.c(n,!0,p.e,t,8),S.ULS.sendTraceTag(39978636,207,50,"Dialog action logged")):S.ULS.sendTraceTag(51500119,207,15,"Dialog action ID not found for DialogButton value: ",e)}},E.ulsLogTelemetryInfo=function(e){var t=n(1).AFrameworkApplication;if(h.a.oldActionsPipelineIsEnabled()){var i={};i.WacSessionId=t.userSessionId,i.ActionName=e,S.ULS.sendTraceTag(35489762,207,50,JSON.stringify(i))}},E.validateAndHide=function(e,t){void 0===t&&(t=0),this.logTelemetryInfo(e,t),e&&!this.validate()||(this._messageBoxHandler&&this._messageBoxHandler(e),this._hideOnButtonClick&&this.hide())},E.openDialogMenu=function(e,t,n,i,r){if(!this.menuLaunchPoint||!this.menuRootUser)return 16;A._dialogMenuInit||(this.menuRootUser.createDialogMenu("DialogMenuId","1245654357","844297214"),A._dialogMenuInit=!0);var a=v.a.getElementLocation(this.menuLaunchPoint);return this.menuRootUser.showDialogMenuAt("DialogMenuId",a.x,a.y,1),32},E.enterMovableMode=function(e,t,n,i,r){return 1===n?32:A.currentDialog&&this.keyMoveAdapter?(this.keyMoveAdapter.enterMoveMode(this.dialogElement),32):16},E.initializeButton=function(e,t){this.setButtonVisiblity(e,!0),this.setButtonState(e,!0),this.setButtonText(e,t)},E.setButtonProperties=function(e,t){var n=t;e.setAttribute("type","button"),e.disabled=!this._buttonState[n],e.style.display=this._buttonDisplay[n]?"inline":"none",e.innerText=this._buttonText[n]},E.closeHandler=function(e){return this.validateAndHide(0,2),!0},E.scrollFix=function(e){this._overlayElement&&(this._overlayElement.style.top=String.format("{0}px",A.posTop),this._overlayElement.style.left=String.format("{0}px",A.posLeft))},E.reSizeDialog=function(){var e=n(1).AFrameworkApplication;e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("WacAutoFitNonModalDialogIsEnabled")?this.autoFitDialog()&&this.centerDialog():this._divMessageBox?(this.resetDialogStyle(),this._divMessageBox.clientWidth>this.getPageWidth()&&(this._divMessageBox.style.width=String.format("{0}px",this.getPageWidth()),this._divMessageBox.style.overflowX="scroll",this._divMessageBox.style.minWidth="0px"),this._divMessageBox.offsetParent&&this._divMessageBox.clientHeight+this._divMessageBox.offsetParent.offsetTop>this.getPageHeight()&&(this._divMessageBox.style.marginTop=-this._divMessageBox.offsetParent.offsetTop+"px"),this._divMessageBox.clientHeight>this.getPageHeight()&&(this._divMessageBox.style.height=String.format("{0}px",this.getPageHeight()),this._divMessageBox.style.overflowY="scroll"),this.centerDialog()):S.ULS.sendTraceTag(19409122,306,10,String.format("_divMessageBox is null in ResizeDialog(), already disposed: {0}",this._disposed))},E.autoFitDialog=function(){return this._divMessageBox?(this.resetDialogStyle(),this._divMessageBox.clientWidth>this.getPageWidth()&&(this._divMessageBox.style.width=String.format("{0}px",this.getPageWidth()),this._divMessageBox.style.overflowX="scroll",this._divMessageBox.style.minWidth="0px"),this._divMessageBox.offsetParent&&this._divMessageBox.clientHeight+this._divMessageBox.offsetParent.offsetTop>this.getPageHeight()&&(this._divMessageBox.style.marginTop=-this._divMessageBox.offsetParent.offsetTop+"px"),this._divMessageBox.clientHeight>this.getPageHeight()&&(this._divMessageBox.style.height=String.format("{0}px",this.getPageHeight()),this._divMessageBox.style.overflowY="scroll"),!0):(S.ULS.sendTraceTag(591013784,306,10,String.format("_divMessageBox is null in AutoFitDialog(), already disposed: {0}",this._disposed)),!1)},E.resetDialogStyle=function(){var e=n(1).AFrameworkApplication;this._divMessageBox.style.height="auto",this._divMessageBox.style.width="auto",this._divMessageBox.style.overflowY="hidden",this._divMessageBox.style.overflowX="hidden",this._divMessageBox.style.marginTop="",this._divMessageBox.style.top="",e.isRtl?(this._divMessageBox.style.right="",this._divMessageBox.style.marginRight=""):(this._divMessageBox.style.left="",this._divMessageBox.style.marginLeft="")},E.sizeFix=function(e){this._overlayElement&&(this._overlayElement.style.height=String.format("{0}px",A.pageHeight),this._overlayElement.style.width=String.format("{0}px",A.pageWidth)),this._menuRootUser&&this._menuRootUser.closeDialogMenu("DialogMenuId"),this.reSizeDialog()},E.setButtonVisiblity=function(e,t){var n=e;this._buttonDisplay[n]=t,this._buttons[n]&&(this._buttons[n].style.display=t?"inline":"none")},E.getButtonElement=function(e){var t=null;switch(e){case 0:t=this._btnCancel;break;case 1:t=this._btnAction;break;case 2:t=this._btnSecondary;break;case 3:t=this._btnTertiary;break;case 4:t=this._btnQuaternary;break;default:0}return t},E.setAriaAttributeForDialog=function(e,t){var i=n(1).AFrameworkApplication;this._useReactDialog||(this._divMessageBox&&e&&t?this._divMessageBox.setAttribute(e,t):S.ULS.sendTraceTag(19449870,306,10,String.format("Invalid state in SetAriaAttributeForDialog(), _divMessageBox == null {0}, already disposed: {1}, AFrameworkApplication.ActiveFrame == null: {2}, ariaAttribute == null: {3}, value == null: {4}",!this._divMessageBox,this._disposed,!i.activeFrame,!e,!t)))},E.myId=function(e){return this._clientId+e},E.validate=function(){return!0},E.showOverlay=function(){this._overlayElement&&(this._overlayElement.style.height="100%",this._overlayElement.style.width="100%",this._overlayElement.style.top="0",this._overlayElement.style.left="0",this._overlayElement.style.display="block",this._showTransparentOverlay&&(this._overlayElement.style.opacity=".0"))},E.unblockOverlay=function(){this._overlayElement&&(this._overlayElement.style.display="none")},E.attachDialogEvents=function(){var e=n(1).AFrameworkApplication;this.hasCloseGlyph&&!this._closeClickHandler&&this._clickManager&&(this._closeClickHandler=Object(a.d)(this,this.closeHandler,"closeHandler"),this._clickManager.registerHandler(s.EventNames.click,this.closeIconElement,this._closeClickHandler)),this._divMessageBox&&this.attachFocusHandlersForCheckbox(this._divMessageBox),this.hasButtons&&(!this._buttonClickHandler&&this._clickManager&&(this._buttonClickHandler=Object(a.d)(this,this.clickHandler,"clickHandler"),this._clickManager.registerHandler(s.EventNames.click,this._btnAction,this._buttonClickHandler),this._btnCancel&&this._clickManager.registerHandler(s.EventNames.click,this._btnCancel,this._buttonClickHandler),this._btnSecondary&&this._clickManager.registerHandler(s.EventNames.click,this._btnSecondary,this._buttonClickHandler),this._btnTertiary&&this._clickManager.registerHandler(s.EventNames.click,this._btnTertiary,this._buttonClickHandler),this._btnQuaternary&&this._clickManager.registerHandler(s.EventNames.click,this._btnQuaternary,this._buttonClickHandler)),!this._buttonKeyHandler&&this._keyInputManager&&(this._buttonKeyHandler=Object(a.d)(this,this.keyHandler,"keyHandler"),this._keyInputManager.registerHandler(s.EventNames.keyDown,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(s.EventNames.keyDown,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(s.EventNames.keyDown,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(s.EventNames.keyDown,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(s.EventNames.keyDown,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.registerHandler(s.EventNames.keyPress,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(s.EventNames.keyPress,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(s.EventNames.keyPress,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(s.EventNames.keyPress,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(s.EventNames.keyPress,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.registerHandler(s.EventNames.keyUp,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(s.EventNames.keyUp,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(s.EventNames.keyUp,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(s.EventNames.keyUp,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(s.EventNames.keyUp,this._btnQuaternary,this._buttonKeyHandler)),this._divMessageBox&&this._keyInputManager&&(this._keyInputManager.registerHandler(s.EventNames.keyDown,this._divMessageBox,this.dialogOnKeyDownHandler),this._keyInputManager.registerHandler(s.EventNames.keyPress,this._divMessageBox,this.dialogOnKeyPressHandler),e.removeWacDialogKeyUpHandler||this._keyInputManager.registerHandler(s.EventNames.keyUp,this._divMessageBox,this.dialogOnKeyUpHandler)))},E.detachDialogEvents=function(){var e=n(1).AFrameworkApplication;this._closeClickHandler&&this._clickManager&&(this._clickManager.unregisterHandler(s.EventNames.click,this.closeIconElement,this._closeClickHandler),this._closeClickHandler=null),this._divMessageBox&&this.detachFocusHandlersForCheckbox(this._divMessageBox),this._buttonClickHandler&&this._clickManager&&(this._clickManager.unregisterHandler(s.EventNames.click,this._btnAction,this._buttonClickHandler),this._btnCancel&&this._clickManager.unregisterHandler(s.EventNames.click,this._btnCancel,this._buttonClickHandler),this._btnSecondary&&this._clickManager.unregisterHandler(s.EventNames.click,this._btnSecondary,this._buttonClickHandler),this._btnTertiary&&this._clickManager.unregisterHandler(s.EventNames.click,this._btnTertiary,this._buttonClickHandler),this._btnQuaternary&&this._clickManager.unregisterHandler(s.EventNames.click,this._btnQuaternary,this._buttonClickHandler),this._buttonClickHandler=null),this._buttonKeyHandler&&this._keyInputManager&&(this._keyInputManager.unregisterHandler(s.EventNames.keyDown,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(s.EventNames.keyDown,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(s.EventNames.keyDown,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(s.EventNames.keyDown,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(s.EventNames.keyDown,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.unregisterHandler(s.EventNames.keyPress,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(s.EventNames.keyPress,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(s.EventNames.keyPress,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(s.EventNames.keyPress,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(s.EventNames.keyPress,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.unregisterHandler(s.EventNames.keyUp,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(s.EventNames.keyUp,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(s.EventNames.keyUp,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(s.EventNames.keyUp,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(s.EventNames.keyUp,this._btnQuaternary,this._buttonKeyHandler),this._divMessageBox&&(this._keyInputManager.unregisterHandler(s.EventNames.keyDown,this._divMessageBox,this.dialogOnKeyDownHandler),this._keyInputManager.unregisterHandler(s.EventNames.keyPress,this._divMessageBox,this.dialogOnKeyPressHandler),e.removeWacDialogKeyUpHandler||this._keyInputManager.unregisterHandler(s.EventNames.keyUp,this._divMessageBox,this.dialogOnKeyUpHandler)),this._buttonKeyHandler=null)},E.show=function(e){if(this._disposed)throw Error.invalidOperation("This dialog has already been disposed and cannot be shown again");this.isShowing||(this._useReactDialog&&null!=e?this.reactShow(e):(this._useReactDialog=!1,this.legacyShow()),this._isShowing=!0,S.ULS.sendTraceTag(50402897,207,50,"Dialog launched for Id: {0}",this.dialogId),this.allowKeytips(!1))},E.update=function(e){this._useReactDialog&&null!=e?this.reactUpdate(e):(this._useReactDialog=!1,this.detachDialogEvents(),this.legacyShow())},E.reactShow=function(e){var t=n(86).UISurfaces;this.addFocusScope(),this.setupReactControlValues(Object(o.a)((function(){return e}),(function(t){return e=t}))),t.getDialogAPIAsync().then((function(t){return t.show(e.id,e),null}))},E.reactUpdate=function(e){var t=n(86).UISurfaces;this.setupReactControlValues(Object(o.a)((function(){return e}),(function(t){return e=t}))),t.getDialogAPIAsync().then((function(t){return t.update(e),null}))},E.setupReactControlValues=function(e){var t=n(1).AFrameworkApplication;if(this._dialogValues=e.val,t.activeFrame){t.dismissSplashScreenImmediately(),t.activeFrame.beginModal(!1);var i={};i.activeDivZIndex=t.activeFrame.activeModalDivZIndex,e.val.dialogHostProperties=i}e.val.dialogButtonsOption=void 0!==e.val.dialogButtonsOption&&null!==e.val.dialogButtonsOption?e.val.dialogButtonsOption:this.buttonsOption,this.addButtonProps(1,e),this.addButtonProps(2,e),this.addButtonProps(3,e),this.addButtonProps(4,e),this.addButtonProps(0,e),e.val.defaultExecutionButton=e.val.defaultExecutionButton||this._defaultButton,e.val.hideCloseButton=e.val.hideCloseButton||!this.hasCloseGlyph,e.val.canBeOverridden=e.val.canBeOverridden||this.canBePreempted,e.val.shouldOverrideExistingDialog=e.val.shouldOverrideExistingDialog||this._shouldPreemptExistingDialog,e.val.hidden=!1},E.addButtonProps=function(e,t){var n;if(this._buttonDisplay[e]){var i;switch(e){case 1:i="actionButtonProps";break;case 2:i="secondaryActionButtonProps";break;case 3:i="tertiaryActionButtonProps";break;case 4:i="quaternaryActionButtonProps";break;case 0:i="cancelButtonProps";break;default:return}t.val[i]=t.val[i]||((n={}).label=this._buttonText[e],n.disabled=!this._buttonState[e],n)}},E.legacyShow=function(){var e=n(1).AFrameworkApplication;if(e.activeFrame&&(e.activeFrame.prepareForDialog(),e.activeFrame.beginModal(!1),this._overlayElement&&(this._overlayElement.style.zIndex=String(e.activeFrame.activeModalDivZIndex)),this._divMessageBox.style.zIndex=String(e.activeFrame.activeModalUIZIndex),e.activeFrame.state=this.isModalDialog?1:2,A._dialogCloseHandler||(A._dialogCloseHandler=A.dialogClose,e.theActionManager.addAction(m.a.dialogClose,b.a.frame,A._dialogCloseHandler)),e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("AccessibleMovingDialogsEnabled")&&(A._dialogOpenMenuHandler||(A._dialogOpenMenuHandler=Object(a.d)(this,this.openDialogMenu,"openDialogMenu"),e.theActionManager.addAction(m.a.showDialogMenu,b.a.frame,A._dialogOpenMenuHandler)),A._dialogMoveModeHandler||(A._dialogMoveModeHandler=Object(a.d)(this,this.enterMovableMode,"enterMovableMode"),e.theActionManager.addAction(m.a.dialogMove,b.a.frame,A._dialogMoveModeHandler))),this.addFocusScope()),e.dismissSplashScreenImmediately(),A.setBackgroundVisibility("hidden"),this.showOverlay(),this.attachDialogEvents(),e.activeFrame&&e.activeFrame.applicationInstance.shouldResizeLegacyDialogBeforeFocus&&this.reSizeDialog(),this.hasButtons){var t=this.getButtonElement(this.getDefaultButton());this.setFocusOnElement(t)}e.activeFrame&&!e.activeFrame.applicationInstance.shouldResizeLegacyDialogBeforeFocus&&this.reSizeDialog()},E.addFocusScope=function(){var e=n(31).AFrame;if(l.FocusManager.usable()){var t=l.FocusManager.instance(),i=t.getScope(this.fullDialogFocusId);i.parent=e.appFocusId;var r=this._useReactDialog?this._divOuterDialogContainer:this._divMessageBox;0;var a=t.currentScope&&t.getCurrentRegion()&&t.getCurrentRegion().listing?t.getCurrentRegion().listing.currentElement:document.activeElement;f.DomUtils.isEditable(a)||t.currentScope&&t.currentScope.parent===l.FocusManager.editingFocusId||t.currentScope&&t.currentScope.name===e.previewPanelId||t.currentScope&&t.currentScope.name===e.versionHistoryOverlayId?(this._revertToLastScope=!0,t.pushScope(this.fullDialogFocusId,!1)):t.scopeChanged(this.fullDialogFocusId),this._useReactDialog||(i.bindAction(d.KeyInputManager.hashKey(u.a.vK_Escape,0),m.a.dialogClose),i.bindAction(d.KeyInputManager.hashKey(u.a.vK_Space,3),m.a.showDialogMenu));var o=new(n(78).DOMFocusListing)((function(){return r}));o.rememberFirstElement=!this.hasRovingTabIndex,o.addValidTag(3),o.addValidTag(2),o.addValidTag(4),o.addValidTag(1),o.addValidTag(6),o.addValidTag(5);var s=t.buildRegionWithDelegate((function(){return r}),t.getScope(this.fullDialogFocusId),o);if(s.rememberFocusStealers(),s.looped=this._tabOrderLooped,s.contained=!0,this._useReactDialog){i.keyDownHandledExternally=!0;var c=d.KeyInputManager.hashKey(u.a.vK_Tab,0),p=d.KeyInputManager.hashKey(u.a.vK_Tab,4);i.unBindAction(c),i.unBindAction(p),i.bindAction(c,m.a.doBrowserDefault),i.bindAction(p,m.a.doBrowserDefault)}}},E.removeFocusScope=function(){var e=n(1).AFrameworkApplication;if(l.FocusManager.usable()&&!e.isShuttingDown){var t=l.FocusManager.instance();this._revertToLastScope?(this._revertToLastScope=!1,t.popScope(this.fullDialogFocusId)):this.dismissFocusScope?t.setScope(this.dismissFocusScope):t.setScope(t.defaultScopeName);var i=t.getRegion(this.fullDialogFocusId);0,i&&i.listing.trySetCurrentElement(null),t.removeScope(this.fullDialogFocusId)}},E.setFocusOnElement=function(e){l.FocusManager.usable()?l.FocusManager.instance().getRegion(this.fullDialogFocusId).listing.forceSetCurrentElement(e):e.focus()},E.setButtonText=function(e,t){var n=e;this._buttonText[n]=t,this._buttons[n]&&(this._buttons[n].innerText=t)},E.getButtonText=function(e){return this._buttonText[e]},E.setButtonState=function(e,t){var n=e;this._buttonState[n]=t,this._buttons[n]&&(this._buttons[n].disabled=!t)},E.getButtonState=function(e){return this._buttonState[e]},E.setDefaultButton=function(e){this._defaultButton=e},E.getDefaultButton=function(){return this._defaultButton},E.setLabelledByForDialog=function(e){this.setAriaAttributeForDialog(g.a.ariaLabelledByAttribute,e)},E.setDescribedByForDialog=function(e){this.setAriaAttributeForDialog(g.a.ariaDescribedByAttribute,e)},E.hide=function(){this.hideInternal(!1)},E.hidePreservingMessageBoxElement=function(){this.hideInternal(!0)},E.hideInternal=function(e){this._isDisposingAsync||(this._useReactDialog?this.reactHideInternal(e):this.legacyHideInternal(e),this._disposeOnHide&&!e&&this.dispose())},E.reactHideInternal=function(e){var t=n(86).UISurfaces,i=n(1).AFrameworkApplication;e&&t.getDialogAPIAsync().then((function(e){return e.hide(),null})),i.activeFrame&&(i.activeFrame.endModal(!1),i.activeFrame.state=0,this.removeFocusScope()),this._isShowing=!1,this.allowKeytips(!0)},E.legacyHideInternal=function(e){var t=n(1).AFrameworkApplication;this.isShowing&&(t.activeFrame&&t.activeFrame.endModal(!1),this._overlayElement&&(this._overlayElement.style.zIndex="-1"),this._divMessageBox.style.zIndex="-1",A.setBackgroundVisibility("visible"),t.activeFrame&&(t.activeFrame.state=0,this.removeFocusScope()),this.detachDialogEvents(),e?(this._overlayElement.style.display="none",this._divMessageBox.style.display="none"):(this._overlayElement&&this.removeElement(this._overlayElement),this._divOuterDialogContainer?this.removeElement(this._divOuterDialogContainer):S.ULS.sendTraceTag(25247879,207,50,"DivOuterDialogContainer is null")),this._isShowing=!1,this.allowKeytips(!0))},E.allowKeytips=function(e){var t=n(44).apiExists;this.isReactRibbonEnvironmentEnabled&&t("allowKeytips")&&this.isModalDialog&&appChrome.api.allowKeytips(e)},A.areRegionComposerAPIsAvailable=function(){var e=n(1).AFrameworkApplication;return!!e.activeFrame&&e.activeFrame.applicationInstance.isRegionComposerEnabled&&!!e.activeFrame.adaptiveLayoutInstance},A.setBackgroundVisibility=function(e){for(var t=["object"],n=0;n<t.length;n++)for(var i=t[n],r=document.getElementsByTagName(i),a=r.length-1;a>=0;a--)(!r[a].className||-1===r[a].className.indexOf(A._objectInDialogCssClass)&&-1===r[a].className.indexOf(A._addinIframeCssClass))&&(r[a].style.visibility=e)},A.dialogClose=function(e,t,n,i,r){var a=A.currentDialog;return a?1===n?32:a.hasCloseGlyph?(a.validateAndHide(0,1),32):2:16},A.isNumber=function(e){return!isNaN(parseInt(e))},A.isPositive=function(e){var t=!1,n=parseInt(e);return!isNaN(n)&&n>=0&&(t=!0),t},I=A,T=[{key:"pageWidth",get:function(){return window.document.documentElement.clientWidth}},{key:"pageHeight",get:function(){return window.document.documentElement.clientHeight}},{key:"posLeft",get:function(){return window.document.documentElement.scrollLeft}},{key:"posTop",get:function(){return window.document.documentElement.scrollTop}}],(w=[{key:"fullDialogFocusId",get:function(){return A.dialogFocusId+"/modal"}},{key:"dialogElement",get:function(){return A.currentDialog?A.currentDialog._divMessageBox:null}},{key:"dialogOuterContainer",get:function(){return this._divOuterDialogContainer}},{key:"menuLaunchPoint",get:function(){return A.currentDialog?A.currentDialog._menuLaunchPoint:null}},{key:"closeAnchor",get:function(){return this._closeAnchor}},{key:"closeIconElement",get:function(){return this._closeIconElement}},{key:"dialogOnKeyDownHandler",get:function(){return this._dialogOnKeyDownHandler?this._dialogOnKeyDownHandler:Object(a.d)(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")},set:function(e){this._dialogOnKeyDownHandler=e}},{key:"dialogOnKeyPressHandler",get:function(){return this._dialogOnKeyPressHandler?this._dialogOnKeyPressHandler:Object(a.d)(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")},set:function(e){this._dialogOnKeyPressHandler=e}},{key:"dialogOnKeyUpHandler",get:function(){return this._dialogOnKeyUpHandler?this._dialogOnKeyUpHandler:Object(a.d)(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")},set:function(e){this._dialogOnKeyUpHandler=e}},{key:"buttonsOption",get:function(){return this._buttonsOption},set:function(e){this._buttonsOption=e,this.hideAllButtons();try{switch(this._buttonsOption){case 0:this.initializeButton(1,this._okText);break;case 1:this.initializeButton(1,this._okText),this.initializeButton(0,this._cancelText);break;case 2:this.initializeButton(1,this._okText),this.initializeButton(0,this._cancelText),this.initializeButton(2,this._retryText);break;case 3:this.initializeButton(1,this._yesText),this.initializeButton(0,this._cancelText),this.initializeButton(2,this._noText);break;case 4:this.initializeButton(1,this._yesText),this.initializeButton(2,this._noText);break;case 6:this.initializeButton(0,this._cancelText);break;case 7:this.initializeButton(1,this._permanentlyDeleteText),this.initializeButton(0,this._cancelText);break;case 8:this.initializeButton(1,this._shareAndNotifyText),this.initializeButton(0,this._cancelText);break;case 9:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(0,this._cancelText);break;case 10:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText),this.initializeButton(0,this._cancelText);break;case 11:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText);break;case 12:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText);break;case 13:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText),this.initializeButton(4,this._quaternaryActionText);break;case 14:this.initializeButton(2,this._secondaryActionText),this.initializeButton(1,this._actionText),this.initializeButton(0,this._cancelText)}}catch(e){switch(this._buttonsOption){case 0:this.initializeButton(1,null);break;case 1:this.initializeButton(1,null),this.initializeButton(0,null);break;case 2:case 3:this.initializeButton(1,null),this.initializeButton(0,null),this.initializeButton(2,null);break;case 4:this.initializeButton(1,null),this.initializeButton(2,null);break;case 6:this.initializeButton(0,null)}}}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"overlayCss",get:function(){return this._overlayCssClass},set:function(e){this._overlayCssClass=e}},{key:"btnAction",get:function(){return this._btnAction},set:function(e){this._btnAction=e}},{key:"canBePreempted",get:function(){return!1}},{key:"hasRovingTabIndex",get:function(){return!1}},{key:"menuRootUser",get:function(){return this._menuRootUser||(this._menuRootUser=y.a.instance.tryResolve("Common.UI.IDialogMenuRootUser"))||S.ULS.sendTraceTag(20824577,207,10,"Could not resolve IDialogMenuRootUser"),this._menuRootUser}},{key:"keyMoveAdapter",get:function(){return this._keyAdapter||(this._keyAdapter=y.a.instance.tryResolve("Common.IKeyMoveAdapter"))||S.ULS.sendTraceTag(21516489,207,10,"Could not resolve dialog KeyMoveAdapter"),this._keyAdapter}},{key:"dismissFocusScope",get:function(){return this._dismissFocusScope},set:function(e){this._dismissFocusScope=e}},{key:"hasButtons",get:function(){return 5!==this._buttonsOption}},{key:"hasCloseGlyph",get:function(){return this._hasCloseGlyph},set:function(e){this._hasCloseGlyph=e}},{key:"isShowing",get:function(){return this._isShowing}},{key:"isModalDialog",get:function(){return!0}},{key:"dialogId",get:function(){return this._id},set:function(e){this._id=e}}])&&C(I.prototype,w),T&&C(I,T),A}(Sys.UI.Control);A._dialogMenuInit=!1,A.dialogFocusId="dialog",A._actionButtonId="WACDialogActionButton",A._secondaryButtonId="WACDialogSecondaryButton",A._tertiaryButtonId="WACDialogTertiaryButton",A._quaternaryButtonId="WACDialogQuaternaryButton",A._cancelButtonId="WACDialogCancelButton",A._objectInDialogCssClass="ObjectInDialog",A._addinIframeCssClass="AddinIframe",A._dialogCloseHandler=null,A._dialogOpenMenuHandler=null,A._dialogMoveModeHandler=null,A.currentDialog=null,Object(r.a)(A,"Dialog",Sys.UI.Control,[])},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var i=n(3),r=function(e,t,n){try{a(e,200,10,"Exception was thrown while {0}: {1}",t,n.toString())}catch(e){}},a=function(e,t,n,a){try{for(var o=arguments.length,c=new Array(o>4?o-4:0),u=4;u<o;u++)c[u-4]=arguments[u];i.ULS.sendTraceTag.apply(null,[e,s(t),l(n),a].concat(c))}catch(t){r(e,"logging",t)}},o=function(e,t,n,a){try{for(var o=arguments.length,l=new Array(o>4?o-4:0),c=4;c<o;c++)l[c-4]=arguments[c];i.ULS.shipAssertTag.apply(null,[e,s(t),n,a].concat(l))}catch(t){r(e,"asserting",t)}},s=function(e){return e},l=function(e){return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(0),r=n(31),a=n(1),o=n(78),s=n(131),l=n(24),c=n(73),u=n(57),d=n(22);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(){function e(){}var t,n,i;return e.tryEnsuredHeaderPanelInitialized=function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!1),e.val=document.getElementById(a.AFrameworkApplication.externalHeaderPanelId),!e.val)return!1;var i=!!a.AFrameworkApplication.activeFrame?a.AFrameworkApplication.activeFrame.get_element():e.val.nextSibling,r=n||!!a.AFrameworkApplication.activeFrame&&a.AFrameworkApplication.activeFrame.applicationInstance.isRibbonFlexBoxLayoutEnabled;return t?(e.val.style.display="",d.DomUtils.ensureCSSClassOnElement(i,"cui-exth"),r&&d.DomUtils.ensureCSSClassOnElement(i,"FlexBoxLayout")):e.val.style.display="none",!0},e.initializeCuiScope=function(e,t,n,i,a,d,p){void 0===p&&(p=!0);var h=l.FocusManager.instance(),m=s.F6Manager.instance,g=c.a.instance,f=u.a.instance,v=h.getScope(e);if(v.parent=r.AFrame.mainAppFocusId,m.addF6(e,p),t&&v.addSetFocus(t),n&&(g.addControlFocus(e,n,i),f.addControlFocus(e,n,i),a)){var _=new o.DOMFocusListing((function(){return n}));_.addValidTag(3),_.addValidTag(2),_.addValidTag(4),_.addValidTag(1),h.buildRegionWithDelegate((function(){return n}),v,_).looped=d}return v},t=e,i=[{key:"topBarOneCssClass",get:function(){var e="cui-topBar1";return a.AFrameworkApplication.activeFrame&&a.AFrameworkApplication.activeFrame.applicationInstance.isTransistionalHeaderUIEnabled&&(e+=" cui-topBar1-transistionalHeaderUI"),a.AFrameworkApplication.appSettingsManager&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(e+=" cui-color-update"),e}}],(n=null)&&p(t.prototype,n),i&&p(t,i),e}();h.externalHeaderFullTopBarsId="ExternalHeaderFullTopBars",h.externalHeaderViewerChromeTopBarsId="ExternalHeaderViewerChromeTopBars",h.breadcrumbBrandId="BreadcrumbBrand",h.breadcrumbFolderId="BreadcrumbFolder",h.signoutLinkId="SignoutLink",h.signInLinkId="SignInLink",h.touchModeCssClass="cui-touch",h.externalHeaderContainerClass="cui-ribbonTopBars",h.externalHeaderContainerClassToMimicRibbon="cui-ribbon",h.ribbonExternalHeaderClass="cui-exth",Object(i.a)(h,"CuiHeaderDomReference",null,[])},function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return g}));var i=n(1),r=n(13),a=n(53),o=n(26),s=n(225),l=n(3),c="modeSwitch",u="translate",d=function(e){return!!e&&(e.getBooleanAppSetting("IsUIEmbedMode")&&e.getBooleanAppSetting("ModeSwitchWithinUIEmbedModeIsEnabled")&&e.getBooleanAppSetting("HostSupportsDocRebootFeaturesInOtherMode"))},p=function(e){return!!e&&(e.getBooleanAppSetting("ModeSwitchWithinUIEmbedModeIsEnabled")&&e.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"))},h=function(e,t,n){if(r.a.checkStringIsNullOrEmpty(e))l.ULS.sendTraceTag(593069254,324,10,"UploadToHostManager mode value is coming empty. failed to switch mode. Mode = {0}",e);else{l.ULS.sendTraceTag(592255191,324,50,"UploadToHostManager switching to {0}",e);var c={};if(c[a.a.rebootMode]="0",c[a.a.mode]=e,c[a.a.reason]=n,t&&t.get_count()>0){var u=r.a.serializeStringDictionaryToJson(t);c[a.a.queryOverrides]=u,l.ULS.sendTraceTag(593069253,324,50,"UploadToHostManager query override {0}",u)}var d=s.a.createRetriableMessage(o.a.documentRefresh,c,i.AFrameworkApplication.userSessionId,3);i.AFrameworkApplication.get_hostPostmessengerFuture().execute((function(e){e.postMessage(d)}))}},m=function(e){if(r.a.checkStringIsNullOrEmpty(e))l.ULS.sendTraceTag(591697177,324,10,"EditUrl is coming null. not able to send post message for docreboot.");else{l.ULS.sendTraceTag(591697178,216,50,"Redirecting to edit url {0}.",e);var t={};t[a.a.rebootMode]="1",t[a.a.documentUrl]=e;var n=s.a.createRetriableMessage(o.a.documentRefresh,t,i.AFrameworkApplication.userSessionId,3);i.AFrameworkApplication.get_hostPostmessengerFuture().execute((function(e){e.postMessage(n)}))}},g=function(){return i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordConsumptionViewToEditRedirectIsEnabled")&&i.AFrameworkApplication.canSupportConsumption}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(0),r=n(2),a=n(33),o=n(76),s=n(103),l=n(101);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(e){if(this._resourceHashMap=null,this._baseCommonResourceDomain=null,this._baseAppResourceDomain=null,this._isEnabled=!1,this._logHashesOnly=!1,this._logOnExitIsEnabled=!1,this._subresourceIntegrityIsEnabled=!1,this._appSettingsManager=e,this._appSettingsManager){this._baseCommonResourceDomain=this.getBaseDomainFromVersionedUrl(this._appSettingsManager.getStringAppSetting("SharedStaticContentHost")),this._baseAppResourceDomain=this.getBaseDomainFromVersionedUrl(this._appSettingsManager.getStringAppSetting("StaticContentHost")),this._isEnabled=this._appSettingsManager.getBooleanAppSetting("HashedResourcePathManagerIsEnabled"),this._logOnExitIsEnabled=this._appSettingsManager.getBooleanAppSetting("HashedResourcePathManagerLogOnExitIsEnabled"),this._logHashesOnly=this._appSettingsManager.getBooleanAppSetting("HashedResourcePathManagerOnlyLogModeIsEnabled"),this._subresourceIntegrityIsEnabled=this._appSettingsManager.getBooleanAppSetting("SubresourceIntegrityIsEnabled");try{this._resourceHashMap=null,this._isEnabled&&("undefined"!=typeof ResourceHashJson&&(this._resourceHashMap=ResourceHashJson),this._resourceHashMap||(this._resourceHashMap=a.b(e.getStringAppSetting("HashedResourceClientManifest")||"{}")),o.g(this._resourceHashMap)?s.b(574993568,200,15,"Client resource hash manifest is invalid"):window.g_versionedUrlHashFunction=Object(r.d)(this,this.getHashedUrlFromVersionedUrl,"getHashedUrlFromVersionedUrl"))}catch(e){s.b(592721431,200,15,"Could not deserialize client resource hash manifest. exception: {0}",e.message),this._resourceHashMap=null}}else this._isEnabled=!1}var t,i,u,d=e.prototype;return d.getHashedCommonResourceHost=function(e){return this._baseCommonResourceDomain?this.getHashedUrl(this._baseCommonResourceDomain,e):null},d.getHashedAppResourceHost=function(e){return this._baseAppResourceDomain?this.getHashedUrl(this._baseAppResourceDomain,e):null},d.getUnusedResourcesOnExit=function(){if(this._isEnabled&&this._logOnExitIsEnabled){var e=[],t=this._resourceHashMap;for(var n in t){var i={key:n,value:t[n]},r=i.value.access;r&&r||e.push(i.key)}if(e.length>0)return e}return null},d.getHashedUrlFromVersionedUrl=function(t){var n=e._versionedUrlRegEx.exec(t);if(n&&n.length>2){var i=n[1],r=n[2],a=this.getHashedUrl(i,r);if(a)return a+r}return null},d.getHashedUrl=function(e,t){var n=this.getHash(t,"UrlHash");return n?e+n+"_":null},d.getSriHash=function(e){return this._subresourceIntegrityIsEnabled?this.getHash(e,"SriHash"):null},d.getHash=function(e,t){if(!this.isEnabled||o.g(this._resourceHashMap))return null;s.b(592721430,200,50,"Getting {0} for [{1}]",t,e),e=e.toLowerCase();var n=this._resourceHashMap[e],i=null;return n?(this._logOnExitIsEnabled&&(this._resourceHashMap[e].access=!0),i=n[t],this._logHashesOnly?(s.b(574993569,200,50,"HashedResourcePathManager LogMode: Would have delivered "+i+" for "+e),null):i):(s.b(591015967,200,50,"Failed to get {0} for [{1}]",t,e),i)},d.getBaseDomainFromVersionedUrl=function(t){var n=e._baseDomainRegEx.exec(t);return n&&n.length>1?n[1]:null},e.getLazySingletonInstance=function(){return new l.a((function(){return new e(n(1).AFrameworkApplication.appSettingsManager)}))},t=e,u=[{key:"instance",get:function(){return e._singletonInstance.value}}],(i=[{key:"isEnabled",get:function(){return this._isEnabled}}])&&c(t.prototype,i),u&&c(t,u),e}();u._baseDomainRegEx=new RegExp("^(.+/)\\d+_$"),u._versionedUrlRegEx=new RegExp("^(.+/)\\d+_(.+)$"),u._singletonInstance=u.getLazySingletonInstance(),Object(i.a)(u,"HashedResourcePathManager",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(132);var a=function(e){var t,n;function i(t){return e.call(this,3,t)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"MoveAnimationEvent",r.a,[])},function(e,t,n){"use strict";var i,r=n(0),a=n(49);!function(e){e[e.accessToken=0]="accessToken",e[e.scheduledShutdown=1]="scheduledShutdown"}(i||(i={})),Object(r.b)("SessionExpirationReason",i);var o=n(3);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return l}));var l=function(){function e(){this._sessionExpiredLogged=!1,this._sessionAboutToExpireLogged=!1,this._ignoreOverride=0,this._eventSource=new a.a,this.sessionExpiredDetectedEventKey="SED",this.sessionAboutToExpireDetectedEventKey="SATED",this.cancelSessionExpiration=null}var t,r,l,c=e.prototype;return c.add_sessionExpiredDetected=function(e){this._eventSource.addHandler(this.sessionExpiredDetectedEventKey,e)},c.remove_sessionExpiredDetected=function(e){this._eventSource.removeHandler(this.sessionExpiredDetectedEventKey,e)},c.add_sessionAboutToExpireDetected=function(e){this._eventSource.addHandler(this.sessionAboutToExpireDetectedEventKey,e)},c.remove_sessionAboutToExpireDetected=function(e){this._eventSource.removeHandler(this.sessionAboutToExpireDetectedEventKey,e)},c.add_onBeforeSessionEndEvent=function(e){this._eventSource.addHandler("BSE",e)},c.remove_onBeforeSessionEndEvent=function(e){this._eventSource.removeHandler("BSE",e)},c.checkAndTriggerSessionHasExpired=function(){var e=n(1).AFrameworkApplication;return this.checkAndTriggerSessionHasExpiredForReason(1,e.scheduledShutdownTtl,e.accessTokenExpirationPromptSeconds)||this.checkAndTriggerSessionHasExpiredForReason(0,e.accessTokenTtl,e.accessTokenExpirationPromptSeconds,!0)},c.checkAndTriggerSessionHasExpiredForReason=function(e,t,n,i){void 0===i&&(i=!1);var r=this.isSessionExpired(t);return i&&r&&this.cancelSessionExpiration&&!this._ignoreOverride&&(this._ignoreOverride=1,r=!this.cancelSessionExpiration(),this._ignoreOverride=r?2:0),r?this.logAndRaiseEvent(!0,t,n,e):this.isSessionAboutToExpire(t,n)&&this.logAndRaiseEvent(!1,t,n,e),r},c.isSessionExpired=function(e){return!!this.isSessionExpiredDueToScheduledShutdown||e>0&&(new Date).getTime()>=e},c.isSessionAboutToExpire=function(e,t){var i=n(1).AFrameworkApplication;return!!this.isSessionAboutToExpireDueToScheduledShutdown||(i.isWopiTokenRefreshEnabled&&i.wopiTokenExpiresAfterMinutes>0?!this.isSessionExpired(e)&&(new Date).getTime()>=i.wopiTokenLastRefreshTime+60*i.wopiTokenExpiresAfterMinutes*1e3:!this.isSessionExpired(e)&&e>0&&(new Date).getTime()>=e-1e3*t)},c.logAndRaiseEvent=function(e,t,r,a){var s,l,c=n(1).AFrameworkApplication;e?this._sessionExpiredLogged||(o.ULS.sendTraceTag(20492681,201,50,"SessionHasExpired: {0}",((s={}).Reason=i[a],s.TTL=t,s.TimeNow=(new Date).getTime(),s.BootTime=c.bootTime,s)),this._sessionExpiredLogged=!0):this._sessionAboutToExpireLogged||(o.ULS.sendTraceTag(20492682,201,50,"SessionAboutToExpire: {0}",((l={}).Reason=i[a],l.ExpirationPromptSeconds=r,l.TTL=t,l.TimeNow=(new Date).getTime(),l.BootTime=c.bootTime,l)),this._sessionAboutToExpireLogged=!0);this._eventSource.raiseEvent(e?this.sessionExpiredDetectedEventKey:this.sessionAboutToExpireDetectedEventKey)},c.raiseBeforeSessionEndEvent=function(){this._eventSource.raiseEvent("BSE")},c.dispose=function(){this._eventSource.dispose()},t=e,l=[{key:"instance",get:function(){return e._singletonInstance||(e._singletonInstance=new e)}}],(r=[{key:"isSessionExpiredDueToScheduledShutdown",get:function(){var e=n(1).AFrameworkApplication;return e.isScheduledShutdownEnabled()&&e.scheduledShutdownTtl>0&&(new Date).getTime()>=e.scheduledShutdownTtl}},{key:"isSessionAboutToExpireDueToScheduledShutdown",get:function(){var e=n(1).AFrameworkApplication;return e.isScheduledShutdownEnabled()&&e.scheduledShutdownTtl>0&&(new Date).getTime()>=e.scheduledShutdownTtl-1e3*e.scheduledShutdownPromptSeconds}}])&&s(t.prototype,r),l&&s(t,l),e}();l._singletonInstance=null,Object(r.a)(l,"SessionExpirationEventSource",null,[4])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(280),o=n(93),s=n(165),l=function(){function e(e){this._task=e}var t=e.prototype;return t.onCompleted=function(e){this._task.OC(e,null,0,null)},t.get_isCompleted=function(){return this._task.get_isCompleted()},t.getResult=function(){if(this._task.get_isFaulted())throw this._task.get_exception();if(this._task.get_isCanceled())throw s.a.createCancellationException()},e}();Object(i.a)(l,"TaskAwaiter",null,[64]);var c=function(e,t,n){this.handler=null,this.taskHandler=null,this.task=null,this.token=e,this.options=t,this.taskScheduler=n};Object(i.a)(c,"Continuation",null,[]);var u=n(89);function d(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var h=function(){function e(){this._actions=new Array(0),this._isCompleted=!1,u.a.runOnSpecific(Object(r.d)(this,this.complete,"complete"),null)}var t=e.prototype;return t.complete=function(){this.set_isCompleted(!0);for(var e,t=d(this._actions);!(e=t()).done;){(0,e.value)()}},t.get_isCompleted=function(){return this._isCompleted},t.set_isCompleted=function(e){return this._isCompleted=e,e},t.getResult=function(){},t.onCompleted=function(e){this.get_isCompleted()?e():Array.add(this._actions,e)},t.getAwaiter=function(){return this},e}();function m(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}Object(i.a)(h,"YieldAwaitable",null,[64]),n.d(t,"Task",(function(){return f}));var f=function(){function e(){this._continuations=null,this._action=null,this._actionWithData=null,this._taskScheduler=null,this._cancelationToken=null,this._exception=null,this._data=null,this._status=0,this.set_status(1)}var t=e.prototype;return t.get_asyncState=function(){return this._data},t.get_id=function(){return this._id||(this._id=++e._nextTaskId),this._id},t.get_status=function(){return this._status},t.set_status=function(e){return this._status=e,e},t.get_exception=function(){return this._exception},t.set_exception=function(e){return s.a.isCancellationException(e)?this.setCanceled():(this._exception=e,this.setCompleted(!1)),e},t.get_isCanceled=function(){return 4===this.get_status()},t.get_isCompleted=function(){return this.get_status()>3},t.get_isFaulted=function(){return 5===this.get_status()},t.g=function(){return new l(this)},t.onCompleted_Synchronous_Deprecated=function(e){this.get_isCompleted()?e():this.g().onCompleted(e)},t.setCanceled=function(){this.trySetCanceled(!1)||e.throwNotActive()},t.trySetCanceled=function(e){return!this.get_isCompleted()&&(!(!e&&3===this.get_status())&&(this.set_status(4),this.runAllContinuations(),!0))},t.setCompleted=function(t){this.trySetCompleted(t)||e.throwNotActive()},t.trySetCompleted=function(e){return!this.get_isCompleted()&&(this.set_status(e?6:5),this.runAllContinuations(),!0)},t.runAllContinuations=function(){var e=this._continuations;this._continuations=null;var t=!1;if(e)for(var n,i=m(e);!(n=i()).done;){var r=n.value;t=this.triggerContinuation(r)||t}this.get_exception()&&!t&&u.a.publishUnobservedTaskException(this,this.get_exception())},t.triggerContinuation=function(t){var n=this;if(t.token&&t.token.get_isCancellationRequested())return t.task&&t.task.trySetCanceled(!1),!1;var i=this.checkShouldExecute(t);if(t.task)e.continueTask(t,i,t.taskScheduler);else{var r=t.handler||function(){t.taskHandler(n)};e.continueAction(t,i,t.taskScheduler,r)}return i},t.checkShouldExecute=function(e){return!(this.get_isFaulted()&&2&e.options)&&(!(this.get_isCanceled()&&1&e.options)&&!(6===this.get_status()&&4&e.options))},t.addContinuation=function(e,t,n,i){var r=Object.assign(new c(t,n,i),{task:e});this.addContinuationInternal(r)},t.OC=function(e,t,n,i){var r=Object.assign(new c(t,n,i),{handler:e,token:t,taskScheduler:i});this.addContinuationInternal(r)},t.OCT=function(e,t,n,i){var r=Object.assign(new c(t,n,i),{taskHandler:e,token:t,taskScheduler:i});this.addContinuationInternal(r)},t.addContinuationInternal=function(e){var t=this;if(e.taskScheduler=e.taskScheduler||u.a.get_current(),e.token&&e.task){if(e.token.get_isCancellationRequested()&&this.handleCancelation(e))return;e.token.R((function(){t.handleCancelation(e)}))}this.get_isCompleted()?this.triggerContinuation(e):this._continuations=a.a(this._continuations,e)},t.handleCancelation=function(e){return!!e.task&&e.task.trySetCanceled(!1)},t.CW=function(e){var t=n(173).ContinuableTask.C(e,this);return this.addContinuation(t,null,0,null),t},t.CWC=function(e,t){var i=n(173).ContinuableTask.C(e,this);return this.addContinuation(i,t,0,null),i},t.CWo=function(e,t){var i=n(173).ContinuableTask.C(e,this);return this.addContinuation(i,null,t,null),i},t.CWT=function(e,t){var i=n(173).ContinuableTask.C(e,this);return this.addContinuation(i,null,0,t),i},t.CWO=function(e,t){var i=n(173).ContinuableTask.CO(e,t,this);return this.addContinuation(i,null,0,null),i},t.CWOC=function(e,t,i){var r=n(173).ContinuableTask.CO(e,t,this);return this.addContinuation(r,i,0,null),r},t.CWOo=function(e,t,i){var r=n(173).ContinuableTask.CO(e,t,this);return this.addContinuation(r,null,i,null),r},t.CWOT=function(e,t,i){var r=n(173).ContinuableTask.CO(e,t,this);return this.addContinuation(r,null,0,i),r},t.CWCT=function(e,t,i,r){var a=n(173).ContinuableTask.C(e,this);return this.addContinuation(a,t,i,r),a},t.CWOCT=function(e,t,i,r,a){var o=n(173).ContinuableTask.CO(e,t,this);return this.addContinuation(o,i,r,a),o},t.CWR=function(e){var t=n(218).ContinuableTask$1.C(e,this);return this.addContinuation(t,null,0,null),t},t.CWRCC=function(e,t){var i=n(218).ContinuableTask$1.C(e,this);return this.addContinuation(i,t,0,null),i},t.CWRCo=function(e,t){var i=n(218).ContinuableTask$1.C(e,this);return this.addContinuation(i,null,t,null),i},t.CWRT=function(e,t){var i=n(218).ContinuableTask$1.C(e,this);return this.addContinuation(i,null,0,t),i},t.CWRO=function(e,t){var i=n(218).ContinuableTask$1.CO(e,t,this);return this.addContinuation(i,null,0,null),i},t.CWRCT=function(e,t,i,r){var a=n(218).ContinuableTask$1.C(e,this);return this.addContinuation(a,t,i,r),a},t.CWROCT=function(e,t,i,r,a){var o=n(218).ContinuableTask$1.CO(e,t,this);return this.addContinuation(o,i,r,a),o},t.start=function(){this.Start$Scheduler(u.a.get_current())},t.Start$Scheduler=function(e){if(1!==this.get_status())throw Error.invalidOperation();this._taskScheduler=e,this.set_status(2),e.queueTask(this)},t.tryExecute=function(){if(this._cancelationToken&&this._cancelationToken.get_isCancellationRequested())return this.get_isCompleted()||this.setCanceled(),!1;if(this.get_isCompleted())return!1;var e=u.a.get_current();return this._taskScheduler=this._taskScheduler||u.a.get_current(),u.a.set_current(this._taskScheduler||u.a.get_current()),this.runSynchronously(),u.a.set_current(e),!0},t.runSynchronously=function(){this.set_status(3);try{if(!this.execute())throw Error.invalidOperation();this.setCompleted(!0)}catch(e){s.a.isCancellationException(e)?this.trySetCanceled(!0):this.set_exception(e)}},t.execute=function(){if(this._action)this._action();else{if(!this._actionWithData)return!1;this._actionWithData(this._data)}return!0},e.get_factory=function(){return e._factory},e.Create=function(t){return Object.assign(new e,{_action:t})},e.Create$object=function(t,n){return Object.assign(new e,{_actionWithData:t,_data:n})},e.throwNotActive=function(){throw Error.invalidOperation()},e.continueAction=function(e,t,n,i){t&&(8&e.options?i():u.a.runOnSpecific(i,n))},e.continueTask=function(e,t,n){var i=e.task;t?8&e.options?i.tryExecute():1===i.get_status()&&(i._cancelationToken=e.token,i.Start$Scheduler(n||u.a.get_current())):i.setCanceled()},e.delay=function(e){var t=new(n(422).CompletableTask);return window.setTimeout(Object(r.d)(t,t.setResult,"setResult"),e),t},e.y=function(){return new h},e.fromResult=function(e){var t=new(n(381).CompletableTask$1);return t.setResult(e),t},e.WAA=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.WAE(o.asEnumerable(n))},e.WAE=function(e){var t=null,i=!1,r=0,o=new(n(422).CompletableTask),s=function(){t?o.SEsA(t):i?o.setCanceled():o.setResult()},l=function(e){e.get_isFaulted()&&(t=a.a(t,e.get_exception())),e.get_isCanceled()&&(i=!0),--r||s()};r++;for(var c,u=m(e);!(c=u()).done;){var d=c.value;r++,d.get_isCompleted()?l(d):d.OCT(l,null,0,null)}return--r||s(),o},e.When=function(t){for(var i,r=new(n(381).CompletableTask$1),a=function(e){r&&(r.setResult(e),r=null)},o=m(t);!(i=o()).done;){var s=i.value;if(s.get_isCompleted())return e.fromResult(s);s.OCT(a,null,0,null)}return r},e.When$Result=function(t){for(var i,r=new(n(381).CompletableTask$1),a=function(e){r&&(r.setResult(e),r=null)},o=m(t);!(i=o()).done;){var s=i.value;if(s.get_isCompleted())return e.fromResult(s);s.OCT((function(e){a(e)}),null,0,null)}return r},e}();f._nextTaskId=0,Object(i.a)(f,"Task",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(19),o=n(189),s=(n(9),n(54),n(85)),l=n(99),c=n(30),u=n(113),d=n(70),p=n(108),h=n(39),m=n(60),g=n(188),f=n(325),v=n(27),_=n(16),y=n(63);function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var S=function(){function e(){this.noOpenConnectionCount=0,this.invokeCount=0,this.invokeSentCount=0,this.invokeFailedCount=0,this.invokeTimeoutCount=0,this.succeededCount=0,this.failedCount=0,this.timeoutCount=0,this.synchronousNotificationCount=0,this._responseNotAvailableIds=null}var t,n,i,r=e.prototype;return r.reset=function(){this.noOpenConnectionCount=0,this.invokeCount=0,this.invokeSentCount=0,this.invokeFailedCount=0,this.invokeTimeoutCount=0,this.succeededCount=0,this.failedCount=0,this.timeoutCount=0,this.synchronousNotificationCount=0,this._responseNotAvailableIds=null},r.addToResponseNotAvailableIds=function(e){this.responseNotAvailableIds||(this._responseNotAvailableIds=new y.a),!this.responseNotAvailableIds.contains(e)&&this.responseNotAvailableIds.get_count()<50&&this.responseNotAvailableIds.add(e)},r.generateLogDictionary=function(){var e={};return e.NoOpenConnectionCount=this.noOpenConnectionCount,e.InvokeCount=this.invokeCount,e.InvokeSentCount=this.invokeSentCount,e.InvokeFailedCount=this.invokeFailedCount,e.InvokeTimeoutCount=this.invokeTimeoutCount,e.SucceededCount=this.succeededCount,e.FailedCount=this.failedCount,e.TimeoutCount=this.timeoutCount,e.SynchronousNotificationCount=this.synchronousNotificationCount,e},t=e,(n=[{key:"responseNotAvailableIds",get:function(){return this._responseNotAvailableIds}}])&&b(t.prototype,n),i&&b(t,i),e}();Object(i.a)(S,"ClientRequestManagerTelemetryStorage",null,[]);var C=n(284),A=n(174);function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var w=function(){function e(e,t){void 0===t&&(t=!1),this._args=e,this.succeeded=t}var t,n,i;return t=e,(n=[{key:"args",get:function(){return this._args}}])&&I(t.prototype,n),i&&I(t,i),e}();function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(w,"RequestManagerResponse",null,[]);var E=function(){function e(e,t){this._requestId=e,this._responsePromise=t}var t,n,i;return e.prototype.registerCallbacks=function(e,t){this.responsePromise&&this.responsePromise.then((function(t){e&&t&&e(t.args)}),(function(e){var n=Object(a.a)(w,e);t&&n&&t(n.args)}))},t=e,(n=[{key:"requestId",get:function(){return this._requestId}},{key:"responsePromise",get:function(){return this._responsePromise}}])&&T(t.prototype,n),i&&T(t,i),e}();function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(E,"QueuedClientRequest",null,[]);var M=function(e){var t,n,i,r,a;function o(t){var n;return(n=e.call(this)||this)._data=t,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=o,(r=[{key:"data",get:function(){return this._data}}])&&k(i.prototype,r),a&&k(i,a),o}(Sys.EventArgs);function P(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(M,"RequestFailedEventArgs",Sys.EventArgs,[95]);var F=function(e){var t,n,i,r,a;function o(t){var n;return(n=e.call(this)||this)._data=t,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=o,(r=[{key:"data",get:function(){return this._data}}])&&P(i.prototype,r),a&&P(i,a),o}(Sys.EventArgs);Object(i.a)(F,"RequestInvokedEventArgs",Sys.EventArgs,[95]);var D=n(423);function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var R=function(e){var t,n,i,r,a;function o(t){var n;return(n=e.call(this)||this)._data=t,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=o,(r=[{key:"data",get:function(){return this._data}}])&&O(i.prototype,r),a&&O(i,a),o}(Sys.EventArgs);Object(i.a)(R,"RequestSucceededEventArgs",Sys.EventArgs,[95]);var x=n(10),U=n(17),B=n(158),L=function(){function e(e,t){var i=n(1).AFrameworkApplication;this._parent=e,this._onAfterSignInCallback=t,this._iframe=document.createElement("iframe"),this._iframe.className="WACSigninFrame";var a=new B.QueryStringBuilder("Signin.aspx");i.addCommonUrlParameters(a),this._iframe.src=a.toString(),this._parent.appendChild(this._iframe),U.a.addHandler(this._iframe,"load",Object(r.d)(this,this.onSigninFrameLoad,"onSigninFrameLoad"))}var t=e.prototype;return t.dispose=function(){this._parent.removeChild(this._iframe),U.a.removeHandler(this._iframe,"load",Object(r.d)(this,this.onSigninFrameLoad,"onSigninFrameLoad")),this._iframe=null,this._parent=null},t.onSigninFrameLoad=function(e){try{0,this._onAfterSignInCallback(this._iframe.contentWindow.document.URL),this.dispose()}catch(e){0}},e}();Object(i.a)(L,"SigninFrame",null,[4]);var N=n(13),H=n(122),W=n(281),j=n(318),V=n(317),K=n(21),z=n(184),q=n(49),G=n(3),Q=n(101),Z=n(170);function $(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return X}));var X=function(){function e(e,t,n,i,a,o,s,c,u,d,p,h,m,g){var v=this;this._lastRequestId=0,this._openConnections=0,this._networkConnectivityListeners=[],this._requestStatusListeners=[],this._firstConsecutiveFailureResponseTime=null,this._machineIds={},this._signInFrame=null,this._onNextSilentAuthCallbacks=[],this._onBeforeRemoveRequestCallbacks=[],this._requestsFailedWith403Error={},this._consecutive403ErrorCount=0,this._consecutive403ErrorStart=0,this._silentAuthFailedWithError=!1,this._isConsecutive403ErrorOccurredEventRaised=!1,this._lastCorrelationId=null,this._wacClusterId=null,this.wacUserAgent=null,this.sendShuttingDownRequest=this.sendShuttingDownRequest$p,this._requests=new f.a,this._userSessionId=e,this._stopwatchBuilder=u,this.maxConnections=t,this._defaultQueueTimeoutMs=n,this._defaultSentTimeoutMs=i,this._taskManager=a,this._nonAuthedUrls=o,this._nonDCSpecificUrls=c,this._lastResponseTime=new Date,this._eventSource=new q.a,this._telemetryStorage=new S,this._getBooleanAppSetting=s,this._getStringAppSetting=m,this._offlineLogger=d,this._markWebRequestOnTimelineIsEnabled=this._getBooleanAppSetting("MarkWebRequestOnTimelineIsEnabled"),this._wacFrontEnd=this._getStringAppSetting("WacWebFrontEnd"),this._shouldBrowserSendWacFrontEndHeader=this._getBooleanAppSetting("ShouldBrowserSendWacFrontEndHeader"),p&&p.execute((function(e){e.add_networkConnectivityChanged(Object(r.d)(v,v.onNetworkConnectionChanged,"onNetworkConnectionChanged"))})),this._sessionStatusManager=g,this.addNetworkConnectivityListener(this._sessionStatusManager),this._officeEndpoint=h,l.a.addConnectivityListener(this)}var t,i,y,b=e.prototype;return b.add_consecutive403ErrorOccurred=function(e){this._eventSource.addHandler("C403EOEK",e)},b.remove_consecutive403ErrorOccurred=function(e){this._eventSource.removeHandler("C403EOEK",e)},b.send=function(e){var t=this,n=-1,i=new Promise((function(i,r){var a=null;e.watchName&&(a=t._stopwatchBuilder.value.makeAndStartStopwatch("WebServiceCall",e.watchName)),n=t.sendRequestInternal(e,(function(e){a&&a.stop(),i(new w(e,!0))}),(function(e){a&&a.stop(),i(new w(e,!1))}))})).catch((function(e){var t=Object(a.a)(Error,e);if(t)throw G.ULS.sendTraceTag(591737751,205,10,"CRM.Send exception:"+t.toString()),t;return G.ULS.sendTraceTag(591737752,205,10,"CRM.Send.Error caught"),Promise.resolve(new w(new M(null),!1))}));return new E(n,i)},b.sendShuttingDown=function(e){this.sendShuttingDownRequest$p(e.url,e.body,e.contentType,e.hostAttributionInfo)},b.sendShuttingDownRequest$p=function(e,t,i,r){var a=!n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DisableFetchKeepAliveOnShutdown")&&x.a.browserSupportsFetchKeepAlive(),o=!a&&x.a.browserSupportsSendBeacon(),s=a?"f":o?"b":"x";window.console&&window.console.log&&e&&window.console.log("SendShuttingDownRequest: "+e+"; requestApi: "+s);if(e=this.createUrlForShuttingDownRequest(e,r),a){var l={};if(l.body=t,l.keepalive=!0,l.method="POST",null!=i){var c={};c["content-type"]=i,l.headers=c,l.mode="same-origin"}window.fetch(e,l)}else if(o)if(null==i)window.navigator.sendBeacon(e,t);else{var u={};u.type=i;var d=[];d.push(t);var p=new Blob(d,u);window.navigator.sendBeacon(e,p)}else this.addRequestInternal(e,2,t,null,[],!1,0,null,null,null,"",!0,null,null,null,null,!1,null,!0,void 0,void 0,r)},b.addRequest=function(e,t,n,i,r,a,o,s,l,c,u,d,p,h,m,g,f,v,_){return void 0===c&&(c=null),void 0===u&&(u=!1),void 0===d&&(d=null),void 0===p&&(p=null),void 0===h&&(h=null),void 0===m&&(m=null),void 0===g&&(g=!1),void 0===f&&(f=null),void 0===v&&(v=!1),void 0===_&&(_=null),this.addRequestInternal(e,t,n,i,_||[],r,a,o,s,l,c||"",u,d,p,h,m,g,f,v)},b.addRequestWithTaskAndStopWatch=function(e,t,n,i,r,a,o,s,l,c,u,d,p,h,m,g){void 0===l&&(l=null),void 0===c&&(c=!1),void 0===u&&(u=null),void 0===d&&(d=null),void 0===p&&(p=null),void 0===h&&(h=null),void 0===m&&(m=!1),void 0===g&&(g=null);var f=null;s&&(f=this._stopwatchBuilder.value.makeAndStartStopwatch("WebServiceCall",s));var v=new Z.a;try{this.addRequestInternal(e,t,n,i,[],r,a,(function(e){f&&f.stop(),v.setResult(new w(e,!0))}),(function(e){f&&f.stop(),v.setResult(new w(e,!1))}),o,l||"",c,u,d,p,h,m)}catch(e){v.trySetException(e)}return v.get_task()},b.addSynchronousRequest=function(e,t,n,i,r,a,o,s,l,c,u,d){return void 0===c&&(c=null),void 0===u&&(u=null),void 0===d&&(d=null),this.addRequestInternal(e,t,n,i,[],r,a,o,s,l,c||"",!0,u,d)},b.addRequestWithHeaderForwarding=function(e,t,n,i,r,a,o,s,l,c,u,d,p,h,m,g,f,v,_,y,b){return void 0===u&&(u=null),void 0===d&&(d=!1),void 0===p&&(p=null),void 0===h&&(h=null),void 0===m&&(m=null),void 0===g&&(g=null),void 0===f&&(f=!1),void 0===v&&(v=null),void 0===_&&(_=!1),void 0===y&&(y=null),void 0===b&&(b=null),this.addRequestInternal(e,t,n,i,r||[],a,o,s,l,c,u||"",d,p,h,m,g,f,v,_,y,b)},b.addSynchronousRequestWithHeaderForwarding=function(e,t,n,i,r,a,o,s,l,c,u,d){return void 0===u&&(u=null),void 0===d&&(d=null),this.addRequestInternal(e,t,n,i,r||[],a,o,s,l,c,"",!0,u,d,"24")},b.sendRequestInternal=function(e,t,n){return this.addRequestInternal(e.url,e.verb,e.body,e.headers,e.responseHeadersToSet||[],e.shouldSetResponseXml,e.priority,t,n,e.state,e.requestorId,e.isSynchronous,e.queueTimeoutMs,e.sentTimeoutMs,e.name,e.overwriteSessionId,e.forceSynchronousNotify,e.overwriteSessionId,!1,e.extraInfo,e.invokedCallback,e.hostAttributionInfo)},b.addRequestInternal=function(t,i,a,o,s,l,c,u,d,m,g,f,v,_,y,b,S,C,A,I,w,T){void 0===v&&(v=null),void 0===_&&(_=null),void 0===y&&(y=null),void 0===b&&(b=null),void 0===S&&(S=!1),void 0===C&&(C=null),void 0===A&&(A=!1),void 0===I&&(I=null),void 0===w&&(w=null),void 0===T&&(T=null);var E=n(1).AFrameworkApplication,k=n(62).PageStats,M=!1;if((E.isWopiTokenRefreshEnabled||this.isAuthedRequest(t))&&(M=p.a.instance.checkAndTriggerSessionHasExpired()),E.activeFrame&&E.activeFrame.holdRequestsWhenSessionHasExpired&&M&&this.isAuthedRequest(t))return G.ULS.sendTraceTag(6636637,205,50,String.format("Session has expired, so hold client request for [Url: {0}].",t)),-1;var P=v||this._defaultQueueTimeoutMs,F=_||this._defaultSentTimeoutMs;this._lastRequestId++,Array.contains(s,e.correlationIdHeaderName)||Array.add(s,e.correlationIdHeaderName),E.collectPageStats&&!Array.contains(s,k.pageStatsResponseXHRHeader)&&Array.add(s,k.pageStatsResponseXHRHeader);var O=new Sys.Net.WebRequest;O.set_url(t),2===i?(O.set_httpVerb("POST"),a&&O.set_body(a)):O.set_httpVerb("GET"),this.setRequestHeaders(O,t,o,b,C,T),S?O.add_completed(Object(r.d)(this,this.onRequestCompletedSynchronousNotify,"onRequestCompletedSynchronousNotify")):O.add_completed(Object(r.d)(this,this.onRequestCompleted,"onRequestCompleted")),F>0&&O.set_timeout(F);var R=new D.a(this._lastRequestId,c,O,s,l,u,d,m,f,g,y,S,I,w);if(A&&E.appSettingsManager.getBooleanAppSetting("UseFetchKeepAliveOnShutdown"))R.request.set_executor(new j.a),R.request.invoke();else{if(P>0){var x=new h.a(2,1,P,Object(r.d)(this,this.timeoutCallbackProcess,"timeoutCallbackProcess"),91);x.customData=R,x.data=R.id.toString(),R.requestQueuedTimeoutTask=x,this._taskManager.addTask(x)}R.status=0,this._requests.enqueue(c,R),R.enqueueTime=new Date,this.onPendingRequestsModified(g,R),this.invoke()}return this._lastRequestId},b.setRequestHeaders=function(t,i,r,a,o,s){var l=n(1).AFrameworkApplication,c=n(62).PageStats,u=t.get_headers();if(u["X-xhr"]="1",a?i=e.addGlobalRequestInfo(u,i,e.userSessionIdHeaderName,l.userSessionIdQueryParam,a):this.userSessionId&&(i=e.addGlobalRequestInfo(u,i,e.userSessionIdHeaderName,l.userSessionIdQueryParam,this.userSessionId)),l.collectPageStats&&(u[c.showPageStatsXHRHeader]=1),l.isLoggingHostRequests&&(u[e.logHostRequestsHeaderName]=1),(o||l.buildVersion)&&(u[e.officeVersionHeaderName]=N.a.httpHeaderEncode(o||l.buildVersion)),this.wacClusterId&&!this.shouldSkipDCSpecificRequest(i)&&(u[e.wacClusterHeaderName]=this.wacClusterId),this._wacFrontEnd&&this._shouldBrowserSendWacFrontEndHeader&&(u[e.wacFEHeaderName]=this._wacFrontEnd),this.wacUserAgent&&(u[e.wacUserAgentHeaderName]=this.wacUserAgent),r)for(var d in r){var p={key:d,value:r[d]};p.value&&(u[p.key]=N.a.httpHeaderEncode(p.value.toString()))}this._getBooleanAppSetting("LogWhenClientRequestFailedEnabled")&&!(e.correlationIdHeaderName in u)&&(u[e.correlationIdHeaderName]=H.a.create().toString()),l.canary&&(u[e.canaryHeaderName]=N.a.httpHeaderEncode(l.canary),l.logCanaryInBrowser&&G.ULS.sendTraceTag(6063237,205,50,"Canary in request: {0}",u[e.canaryHeaderName])),l.accessToken&&(e.checkParamInUrl(t.get_url(),l.accessTokenParamName)||(u[e.accessTokenHeaderName]=N.a.httpHeaderEncode(l.accessToken)),e.checkParamInUrl(t.get_url(),l.accessTokenTtlParamName)||(u[e.accessTokenTtlHeaderName]=l.accessTokenServerExpirationTime.toString())),l.userType&&(u[e.userTypeHeaderName]=N.a.httpHeaderEncode(l.userType)),null!=s?(u[z.a.endpointParamName]=s.endpoint.toString(),u[z.a.scenarioParamName]=s.scenario.toString(),u[z.a.scenarioTypeParamName]=s.scenarioType.toString()):u[z.a.endpointParamName]=this._officeEndpoint.toString()},b.isAuthedRequest=function(e){return!this.isRequestEndingWithSpecificUrl(e,this._nonAuthedUrls)},b.shouldSkipDCSpecificRequest=function(e){return!!this._getBooleanAppSetting("NonDCSpecificSqmRequestIsEnabled")&&this.isRequestEndingWithSpecificUrl(e,this._nonDCSpecificUrls)},b.isRequestEndingWithSpecificUrl=function(e,t){for(var n=v.a.removeAllUrlParameters(e).toLowerCase(),i=0;i<t.length;i++){var r=(0,t[i])();if(r&&n.endsWith(r))return!0}return!1},b.abortRequest=function(e){if(!(e<0)){var t=this.peekById(e);if(!t)throw Error.argument(String.format("No request is found for the given id: {0}",e));this.abortRequestInternal(t)}},b.abortRequestInternal=function(e){e&&(G.ULS.sendTraceTag(20289093,205,50,"Trying to abort request id: [{0}], request status is: [{1}], requestor id is: [{2}]",e.id,e.status,e.requestorId),this.ensureCompletionCallbackTaskRemoved(e),this.ensureQueuedTimeoutTaskRemoved(e),1===e.status?(e.request.get_executor().abort(),this.onPendingRequestsModified(e.requestorId,e)):this._getBooleanAppSetting("RunCompletionCallbackAfterCancelingRequest")&&(e.status=10))},b.ensureCompletionCallbackTaskRemoved=function(e){return this.ensureTaskRemoved((function(){return e.completionCallbackTask}),(function(){e.completionCallbackTask=null}))},b.ensureQueuedTimeoutTaskRemoved=function(e){return this.ensureTaskRemoved((function(){return e.requestQueuedTimeoutTask}),(function(){e.requestQueuedTimeoutTask=null}))},b.ensureTaskRemoved=function(e,t){var n=e();return!!n&&(this._taskManager.deleteTask(n),t(),!0)},b.tryAbortRequest=function(e){var t=this.peekById(e);return!!t&&(this.abortRequestInternal(t),!0)},b.getRequestStatus=function(e){var t=this.peekById(e);return t?t.status:4},b.pendingRequestsCount=function(e){for(var t=0,n=0,i=this._requests.length;n<i;n++)this._requests.peekAt(n).requestorId===e&&t++;return t},b.executingRequestsCount=function(e){for(var t=0,n=0,i=this._requests.length;n<i;n++){var r=this._requests.peekAt(n);r.requestorId===e&&1===r.status&&t++}return t},b.peekAtRequestQueue=function(e){return this._requests.peekAt(e)},b.abortAllOutstandingRequests=function(e){for(var t=this._requests.length-1;t>=0;t--){var n=this._requests.peekAt(t);n.requestorId===e&&this.abortRequest(n.id)}},b.abortRequests=function(e){for(var t=this._requests.length-1;t>=0;t--){var n=this._requests.peekAt(t);e(n)&&this.abortRequest(n.id)}},b.addNetworkConnectivityListener=function(e){Array.add(this._networkConnectivityListeners,e)},b.removeNetworkConnectivityListener=function(e){Array.remove(this._networkConnectivityListeners,e)},b.addRequestStatusListener=function(e){Array.add(this._requestStatusListeners,e)},b.removeRequestStatusListener=function(e){Array.remove(this._requestStatusListeners,e)},b.onNetworkConnectionChanged=function(e,t){t.isConnected||this.isNetworkOffline?t.isConnected&&this.isNetworkOffline&&G.ULS.sendTraceTag(592327897,205,50,"Browser detected a network reconnect. "):(this._offlineLogger&&this._offlineLogger.listenNextTag(592327896,205,50),G.ULS.sendTraceTag(592327896,205,15,"Browser detected a network disconnect. "),this.onNetworkDisconnect())},b.onNetworkDisconnect=function(){n(1).AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordListenToBrowserNetworkEventsSettings");for(var e=Array.clone(this._networkConnectivityListeners),t=0;t<e.length;t++)e[t].networkDisconnected();u.a.instance.addMetric(c.a.networkDisconnectedStart,(new Date).getTime())},b.onNetworkResume=function(){for(var e=Array.clone(this._networkConnectivityListeners),t=0;t<e.length;t++)e[t].networkResumed();u.a.instance.addMetric(c.a.networkDisconnectedEnd,(new Date).getTime())},b.onPendingRequestsModified=function(e,t){for(var n=Array.clone(this._requestStatusListeners),i=0;i<n.length;i++)n[i].pendingRequestsModified(e,t)},b.createAndInvokeCompletionTask=function(e,t){var i=n(1).AFrameworkApplication,a=new h.a(e.priority,1,0,Object(r.d)(this,this.callbackProcess,"callbackProcess"),9);a.data=e.id.toString(),a.name=e.name,i.isShuttingDown||e.isSynchronous||t?this.callbackProcess(a):(e.completionCallbackTask=a,this._taskManager.addTask(a))},b.invoke=function(){var e,t=n(1).AFrameworkApplication;if((e=this.telemetryStorage).invokeCount=e.invokeCount+1,this.hasAvailableConnections){this.removeCancelledItems();for(var i=null,r=0;r<this._requests.length;++r){var a=this._requests.peekAt(r);if(!a.status){i=a;break}}if(i){if(this.ensureQueuedTimeoutTaskRemoved(i),t.activeFrame&&t.activeFrame.runRequestCallbackWhenSessionHasExpired&&p.a.instance.isSessionExpired(t.accessTokenTtl)&&this.isAuthedRequest(i.request.get_url()))return i.status=14,void this.createAndInvokeCompletionTask(i,i.forceSynchronousNotify);i.status=1;var o=null;t.isShuttingDown||i.isSynchronous?(o=Sys.Net.WebRequestManager.get_defaultExecutorType(),t.appSettingsManager.getBooleanAppSetting("DisableSynchronousXMLHttpExecutor")||t.isShuttingDownFromPostMessage||t.appSettingsManager.getBooleanAppSetting("EnableAsyncXHROnNavigateForChrome")&&(t.isShuttingDown||"wsaupload.ashx"===t.theWsaClient.uploadUrl.toLowerCase())&&!x.a.supportsSynchronousXhrDuringNavigate?Sys.Net.WebRequestManager.set_defaultExecutorType(W.a.getName()):(Sys.Net.WebRequestManager.set_defaultExecutorType(V.a.getName()),i.request.get_executor()||G.ULS.sendTraceTag(587207577,205,15,"ClientRequestManager::Invoke: invoking synchronous request: {0}, is during shutdown: {1}",i.name,t.isShuttingDown))):t.requiresCrossDomainAjax?(C.a.corsSimpleResponseHeadersOnlyIsEnabled=this._getBooleanAppSetting("CORSSimpleResponseHeadersOnlyIsEnabled"),o=Sys.Net.WebRequestManager.get_defaultExecutorType(),Sys.Net.WebRequestManager.set_defaultExecutorType(C.a.getName())):(x.a.isInternetExplorer10Up||x.a.isInternetExplorerMobile)&&(o=Sys.Net.WebRequestManager.get_defaultExecutorType(),Sys.Net.WebRequestManager.set_defaultExecutorType(W.a.getName()));var s=!1;try{var l;i.invokedTime=new Date,i.invokedTimeTicks=g.roundNumber(_.a.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&i.shouldMarkOnTimeline&&d.a.instance.addMark("RequestInvoked"+i.invokedTimeTicks),i.invokedCallback&&i.invokedCallback(new F(i)),(l=this.telemetryStorage).invokeSentCount=l.invokeSentCount+1,i.request.invoke(),this.onPendingRequestsModified(i.requestorId,i)}catch(e){var c;(c=this.telemetryStorage).invokeFailedCount=c.invokeFailedCount+1,s=!0}o&&Sys.Net.WebRequestManager.set_defaultExecutorType(o),this._openConnections++,!s||t.isShuttingDown||i.isSynchronous||this.onRequestCompleted(i.request.get_executor())}}else{var u;(u=this.telemetryStorage).noOpenConnectionCount=u.noOpenConnectionCount+1}},b.removeCancelledItems=function(){if(this._getBooleanAppSetting("RunCompletionCallbackAfterCancelingRequest"))for(var e=this._requests.length-1;e>=0;--e){var t=this._requests.peekAt(e);10===t.status&&(this.ensureQueuedTimeoutTaskRemoved(t),this.removeById(t.id))}},b.onRequestCompletedSynchronousNotify=function(e){var t;(t=this.telemetryStorage).synchronousNotificationCount=t.synchronousNotificationCount+1,this.onRequestCompletedInternal(e,!0)},b.onRequestCompleted=function(e){this.onRequestCompletedInternal(e,!1)},b.onRequestCompletedInternal=function(t,i){var a=n(1).AFrameworkApplication;if(t){var o=t.get_webRequest();if(o){var s=this.peekByWebRequest(o);if(s){this._openConnections--;var l=t.get_responseAvailable()?t.get_statusCode():t.get_timedOut()?A.a.requestTimeout_408:-1;s.httpStatus=l;var c=t.get_aborted()?"'Aborted'":t.get_timedOut()?"'Request Timeout'":t.get_responseAvailable()?l.toString():"'Response Not Available'";0,s.completedTime=this._lastResponseTime=new Date,s.completedTimeTicks=g.roundNumber(_.a.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&s.shouldMarkOnTimeline&&d.a.instance.addMark("RequestCompleted"+s.completedTimeTicks);var u=!1;t.get_aborted()&&(s.status=10);var p=null,h=null;if(t.get_responseAvailable()){if(t.getResponseHeader(e.endSessionHeaderName)&&a.endSessionHeaderReceivedCallback)return void a.endSessionHeaderReceivedCallback();var m=t.getResponseHeader(e.officeFEHeaderName);m&&(this._machineIds[m]=1);var f=t.getResponseHeader(e.wacFEHeaderName);f&&(this._wacFrontEnd=f),t.getResponseHeader(e.removeWacFEHeaderName)&&(this._wacFrontEnd=null,G.ULS.sendTraceTag(574956177,205,50,"WacFrontEnd is set to null due to server draining to avoid unnecessary extra latency for subsequent requests."));var y=t.getResponseHeader(e.isCacheableHeaderName);!(null==y)&&Boolean.parse(y)?this._lastCorrelationId=H.a.create().toString():(this._lastCorrelationId=t.getResponseHeader(e.correlationIdHeaderName),p=t.getResponseHeader(e.canaryNewValueHeaderName),e.updateCanary(p)),h=this.lastCorrelationId;var b,S=v.a.getPageName(o.get_url());if(l===A.a.notFound_404)b=4;else if(l===A.a.preconditionFailed_412)b=5;else if(l===A.a.forbidden_403){t.getResponseHeader("OdsiHttpModule")?(this._signInFrame=new L(document.body,Object(r.d)(this,this.runAllSilentAuthCallbacks,"runAllSilentAuthCallbacks")),b=12):b=3,G.ULS.shipAssertTag(8157283,205,!!S),this._requestsFailedWith403Error[S]="1";var C=!1;this._consecutive403ErrorStart?C=++this._consecutive403ErrorCount>=a.appSettingsManager.getIntAppSetting("MaxConsecutive403ErrorCount",2)&&(new Date).getTime()-this._consecutive403ErrorStart>=a.appSettingsManager.getIntAppSetting("Consecutive403ErrorInterval",3e3):(G.ULS.shipAssertTag(8157312,205,!this._consecutive403ErrorCount),G.ULS.sendTraceTag(8157313,205,50,"Try recovering from 403 error"),this._consecutive403ErrorCount=1,this._consecutive403ErrorStart=(new Date).getTime()),!this._isConsecutive403ErrorOccurredEventRaised&&C&&(this._silentAuthFailedWithError?G.ULS.sendTraceTag(8157314,205,50,"OnConsecutive403ErrorOccured: Legitimate since SoftAuth got MSA errors [Count: {0}]",this._consecutive403ErrorCount):G.ULS.sendTraceTag(7352910,205,50,"OnConsecutive403ErrorOccured: [Count: {0}]",this._consecutive403ErrorCount),this._isConsecutive403ErrorOccurredEventRaised=!0,this._eventSource.raiseEvent("C403EOEK"))}else 12029===l||12030===l||12031===l||12152===l||12159===l?b=6:l!==A.a.OK_200?b=A.a.isClientError(l)?11:A.a.isServerError(l)?9:l&&2!==l?3:8:(b=2,u=!0);l!==A.a.forbidden_403&&l&&2!==l&&this._consecutive403ErrorCount>0&&"1"===this._requestsFailedWith403Error[S]&&(this._consecutive403ErrorCount=0,this._consecutive403ErrorStart=0,this._silentAuthFailedWithError=!1,this._requestsFailedWith403Error={}),s.status=b}else t.get_timedOut()?s.status=7:this.telemetryStorage.addToResponseNotAvailableIds(s.id);if(u)this.isNetworkOffline&&(this._offlineLogger&&this._offlineLogger.listenNextTag(4284739,306,50),G.ULS.sendTraceTag(4284739,306,50,"OnNetworkResume"),this.onNetworkResume()),this._firstConsecutiveFailureResponseTime=null;else{var I=l===A.a.preconditionFailed_412&&!!p,w=new Date;this._firstConsecutiveFailureResponseTime||(this._firstConsecutiveFailureResponseTime=w);var T,E=w.getTime()-this._firstConsecutiveFailureResponseTime.getTime();if(!this.isNetworkOffline&&!I&&E>=3e4)this._offlineLogger&&this._offlineLogger.listenNextTag(4284740,306,50),G.ULS.sendTraceTag(4284740,306,50,"NetworkDisconnected {0}",((T={}).TimeSinceFirstFailure=E,T.OfflineRetryInterval=3e4,T.StatusCode=c,T.RequestStatus=s.status,T.Url=v.a.removeAllUrlParameters(o.getResolvedUrl()),T)),this.onNetworkDisconnect();if(this._getBooleanAppSetting("LogWhenClientRequestFailedEnabled")&&(null==h&&t.get_webRequest().get_headers()&&(h=t.get_webRequest().get_headers()[e.correlationIdHeaderName]),null!=h)){var k="Request failed! Correlation: "+h+", StatusCode: "+l.toString();if(this._getBooleanAppSetting("DumpResponseHeadersWhenClientRequestFailedEnabled")&&t.get_responseAvailable()){var M=t.getAllResponseHeaders();if(null!=M)k+=(M.length>2e4?", TruncatedResponseHeaders: ":", ResponseHeaders: ")+M}G.ULS.sendTraceTag(39936897,306,50,k)}}if(t.get_responseAvailable())try{if(s.responseData=t.get_responseData(),void 0!==s.responseHeadersToSet&&null!==s.responseHeadersToSet){s.responseHeaders={};for(var P=0;P<s.responseHeadersToSet.length;++P){var F=s.responseHeadersToSet[P];s.responseHeaders[F]=t.getResponseHeader(F)}}s.shouldSetResponseXml&&(t.get_responseData()&&t.get_responseData().length?s.responseXml=t.get_xml():s.responseXml=null)}catch(e){G.ULS.sendTraceTag(4322132,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}, Status={3}, CorrelationId={4}, Exception={5}",s.id,s.request.get_url(),t.get_responseAvailable(),c,this.lastCorrelationId,e.toString())}this._getBooleanAppSetting("RunCompletionCallbackAfterCancelingRequest")&&10===s.status?this.removeById(s.id):this.createAndInvokeCompletionTask(s,i),this.invoke()}else G.ULS.sendTraceTag(39965911,205,15,"OnRequestCompleted: Request is not found in the queue. Request body: {0}. ",N.a.redactForLogging(o.get_body()))}else G.ULS.sendTraceTag(19161608,205,15,"OnRequestCompleted: Request doesn't exist.")}else G.ULS.sendTraceTag(19161607,205,15,"OnRequestCompleted: Executor doesn't exist.")},b.runAllSilentAuthCallbacks=function(e){var t=e;if(t){var n,i=v.a.getParameterValue(t,"f");if(i)G.ULS.sendTraceTag(8157315,205,50,"SilentAuth failed with error code: {0}",((n={}).f=i,n.MSPPError=v.a.getParameterValue(t,"MSPPError"),n)),this._silentAuthFailedWithError=!0;else this._silentAuthFailedWithError=!1}this._signInFrame&&(this._onNextSilentAuthCallbacks.forEach((function(e){e()})),Array.clear(this._onNextSilentAuthCallbacks),this._signInFrame=null)},b.addNextSilentAuthCallback=function(e){this._signInFrame?Array.add(this._onNextSilentAuthCallbacks,e):e()},b.addOnBeforeRemoveRequestCallback=function(e){Array.add(this._onBeforeRemoveRequestCallbacks,e)},b.removeOnBeforeRemoveRequestCallback=function(e){Array.remove(this._onBeforeRemoveRequestCallbacks,e)},b.timeoutCallbackProcess=function(e){var t=e.data,n=e.customData;if(this.ensureQueuedTimeoutTaskRemoved(n)){var i,r,a,o=v.a.removeAllUrlParameters(n.request.get_url());if(n.status)G.ULS.shipAssertTag(5904529,306,!1,"TimeoutCallbackProcess: Leaving request untouched. It timed out in the queue with unexpected status. {0}",((i={}).Url=o,i.Status=n.status,i));else n.status=13,n.completedTime=new Date,n.completedTimeTicks=g.roundNumber(_.a.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&n.shouldMarkOnTimeline&&d.a.instance.addMark("RequestCompleted"+n.completedTimeTicks),this.removeById(n.id),this.executeCallbackForRequest(n,t),G.ULS.sendTraceTag(5904528,306,15,"TimeoutCallbackProcess: Request timed out in the queue. {0}",((r={}).Url=o,r));(a=this.telemetryStorage).invokeTimeoutCount=a.invokeTimeoutCount+1}},b.callbackProcess=function(e){var t=e.data;var n=this.removeById(parseInt(t));this.executeCallbackForRequest(n,t)},b.executeCallbackForRequest=function(e,t){if(e)if(this.onPendingRequestsModified(e.requestorId,e),2===e.status){var n;e.successCallback&&e.successCallback(new R(e)),(n=this.telemetryStorage).succeededCount=n.succeededCount+1}else{var i,r;if(7===e.status)(i=this.telemetryStorage).timeoutCount=i.timeoutCount+1;else(r=this.telemetryStorage).failedCount=r.failedCount+1;e.failureCallback&&e.failureCallback(new M(e))}else 0},b.removeById=function(e){var t=this.indexofId(e);if(-1===t)return null;var n=this.peekByIndex(t);return this._onBeforeRemoveRequestCallbacks.forEach((function(e){e(n)})),this._requests.removeAt(t),n},b.indexofId=function(e){return this.indexOfRequestWhere((function(t){return t.id===e}))},b.indexofWebRequest=function(e){return this.indexOfRequestWhere((function(t){return t.request===e}))},b.indexOfRequestWhere=function(e){for(var t=0;t<this._requests.length;++t){if(e(this._requests.peekAt(t)))return t}return-1},b.peekById=function(e){return this.peekByIndex(this.indexofId(e))},b.peekByWebRequest=function(e){return this.peekByIndex(this.indexofWebRequest(e))},b.peekByIndex=function(e){return e<0?null:this._requests.peekAt(e)},b.getNextRequestIdAndIncrement=function(){return p.a.instance.checkAndTriggerSessionHasExpired()?-1:(this._lastRequestId++,this._lastRequestId)},b.dump=function(){0},b.getUserTypeQueryStringPair=function(){var t=n(1).AFrameworkApplication;return t.userType?String.format("{0}={1}",e.userTypeQsName,N.a.urlKeyValueEncode(t.userType)):null},b.createUrlForShuttingDownRequest=function(t,i){var r=n(1).AFrameworkApplication;return this.userSessionId&&(t=e.addOrReplaceQueryParameter(t,r.userSessionIdQueryParam,this.userSessionId)),r.buildVersion&&(t=e.addOrReplaceQueryParameter(t,e.officeVersionQueryParam,r.buildVersion)),this.wacClusterId&&!this.shouldSkipDCSpecificRequest(t)&&(t=e.addOrReplaceQueryParameter(t,e.wacClusterQsName,this.wacClusterId)),r.userType&&(t=e.addOrReplaceQueryParameter(t,e.userTypeQsName,r.userType)),r.isLoggingHostRequests&&(t=e.addOrReplaceQueryParameter(t,e.logHostRequestsQueryParam,"1")),r.canary&&(t=e.addOrReplaceQueryParameter(t,e.canaryQueryParam,r.canary)),this.isAuthedRequest(t)&&(t=e.addOrReplaceQueryParameter(t,r.accessTokenParamName,r.accessToken),t=this._getBooleanAppSetting("UseServerAccessTokenTTLInClientRequests")?e.addOrReplaceQueryParameter(t,r.accessTokenTtlParamName,r.accessTokenServerExpirationTime.toString()):e.addOrReplaceQueryParameter(t,r.accessTokenTtlParamName,r.accessTokenTtl.toString())),i?(t=e.addOrReplaceQueryParameter(t,z.a.endpointParamName,i.endpoint.toString()),i.scenario&&(t=e.addOrReplaceQueryParameter(t,z.a.scenarioParamName,i.scenario.toString())),t=e.addOrReplaceQueryParameter(t,z.a.scenarioTypeParamName,i.scenarioType.toString())):t=e.addOrReplaceQueryParameter(t,z.a.endpointParamName,this._officeEndpoint.toString()),t},e.createAnInstance=function(t){return e.createAnInstanceWithResolvedDependencies(t)},e.createAnInstanceWithResolvedDependencies=function(t){var i=n(1).AFrameworkApplication,r=n(1).AFrameworkApplication.appSettingsManager||new o.a({}),a=new Q.a((function(){return n(1).AFrameworkApplication.activeFrame.theStopwatchBuilder})),s=[function(){return n(1).AFrameworkApplication.theWsaClient?n(1).AFrameworkApplication.theWsaClient.uploadUrl.toLowerCase():null},function(){return"remoteuls.ashx"},function(){return"remotetelemetry.ashx"}],l=[function(){return n(1).AFrameworkApplication.theWsaClient?n(1).AFrameworkApplication.theWsaClient.uploadUrl.toLowerCase():null},function(){return"rtc2/findsession"}],c=r.getBooleanAppSetting("ListenToBrowserNetworkEventsIsEnabled")?K.a.instance.resolveFuture("Common.App.NetworkConnectivity.INetworkConnectivityProvider"):null,u=1;i.activeFrame&&i.activeFrame.applicationInstance&&(u=z.a.getOfficeEndpointFromAppType(i.activeFrame.applicationInstance.officeAppType));var d=n(237).SessionStatusManager.instance;return new e(t,r.getIntAppSetting("ClientRequestManagerMaxConnections",2),r.getIntAppSetting("ClientRequestManagerDefaultQueueTimeMs",0),r.getIntAppSetting("ClientRequestManagerDefaultSentTimeMs",0),m.a.instance,s,(function(e){return!!n(1).AFrameworkApplication.appSettingsManager&&n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e)}),l,a,i.theOfflineLogger,c,u,(function(e){return n(1).AFrameworkApplication.appSettingsManager?n(1).AFrameworkApplication.appSettingsManager.getStringAppSetting(e):null}),d)},e.addGlobalRequestInfo=function(t,i,r,a,o){return n(1).AFrameworkApplication.requiresCrossDomainAjax?i=e.addQueryParameterToUrl(i,a,o):t[r]=N.a.httpHeaderEncode(o),i},e.addQueryParameterToUrl=function(t,n,i){if(v.a.getParameterValue(t,n))return G.ULS.sendTraceTag(4301539,205,15,"Param collision: {0}",n),t;var r=v.a.addParameterValue(t,n,i);return r.length>e.maxUrlLength?G.ULS.sendTraceTag(4301568,205,15,"Url too long: {0}. Length: {1}",n,r.length):t=r,t},e.validateAndFixCanary=function(e){var t=e.split(",");if(t.length>4)G.ULS.sendTraceTag(7161414,205,10,"Unexpected canary value [{0}]. Less than 4 commas expected.",e);else if(4===t.length){G.ULS.sendTraceTag(7161415,205,10,"Canary got duplicated header value : {0}",e);var n=t[0].trim()+","+t[1].trim();e=n===t[2].trim()+","+t[3].trim()?n:e,G.ULS.sendTraceTag(7161416,205,50,"Fixed canary value is: {0}",e)}return e},e.updateCanary=function(t){var i=n(1).AFrameworkApplication;t&&(t=e.validateAndFixCanary(t),i.canary=t,i.logCanaryInBrowser&&G.ULS.sendTraceTag(6063238,205,50,"New canary in response: {0}",i.canary))},e.checkParamInUrl=function(e,t){return!(!e||!t)&&(-1!==e.indexOf("?"+t+"=")||-1!==e.indexOf("&"+t+"="))},e.addOrReplaceQueryParameter=function(t,n,i){var r=v.a.addOrReplaceParameterValue(t,N.a.urlKeyValueEncode(n),i?N.a.urlKeyValueEncode(i):null);return r.length>e.maxUrlLength?(G.ULS.sendTraceTag(592318752,205,15,"Url too long: {0}. Length: {1}",n,r.length),t):r},t=e,(i=[{key:"telemetryStorage",get:function(){return this._telemetryStorage}},{key:"userSessionId",get:function(){return this._userSessionId},set:function(e){if(this._userSessionId)throw Error.invalidOperation("User session id is already set");this._userSessionId=e}},{key:"defaultSentTimeoutMs",get:function(){return this._defaultSentTimeoutMs}},{key:"lastResponseTime",get:function(){return this._lastResponseTime}},{key:"isNetworkOffline",get:function(){return!!this._sessionStatusManager.networkState}},{key:"lastCorrelationId",get:function(){return this._lastCorrelationId}},{key:"hasAvailableConnections",get:function(){return this._openConnections<this.maxConnections}},{key:"timeToWaitAfterLastKeyStroke",get:function(){return this._taskManager.timeToWaitAfterLastKeyStroke},set:function(e){this._taskManager.timeToWaitAfterLastKeyStroke=e}},{key:"machineIds",get:function(){var e=new Sys.StringBuilder,t=!1,n=this._machineIds;for(var i in n){var r={key:i,value:n[i]};t&&e.append(",");var a=r.key;a&&(t=!0,e.append(a))}return e.toString()}},{key:"wacClusterId",get:function(){return this._wacClusterId},set:function(e){var t=n(1).AFrameworkApplication;t.appSettingsManager&&n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UpdateTelemetryWithChangesToWacClusterId")&&e&&e.length>0&&(t.dataPlumber.WacSessionDatacenter=e,s.Health.instance.addOrUpdatePartCDimension("WacSessionDatacenter",e)),this._wacClusterId&&this._wacClusterId!==e&&(this._wacFrontEnd=null),this._wacClusterId=e}},{key:"requestQueueLength",get:function(){return this._requests.length}}])&&$(t.prototype,i),y&&$(t,y),e}();X.invalidRequestId=0,X.maxUrlLength=2048,X.canaryHeaderName="X-Key",X.canaryQueryParam="ckey",X.canaryNewValueHeaderName="X-NewKey",X.correlationIdHeaderName="X-CorrelationId",X.isCacheableHeaderName="X-IsCacheable",X.officeFEHeaderName="X-OfficeFE",X.wacFEHeaderName="X-WacFrontEnd",X.removeWacFEHeaderName="X-RemoveWacFrontEnd",X.officeVersionHeaderName="X-OfficeVersion",X.officeVersionQueryParam="build",X.endSessionHeaderName="X-EndSession",X.accessTokenHeaderName="X-AccessToken",X.accessTokenTtlHeaderName="X-AccessTokenTtl",X.userTypeHeaderName="X-UserType",X.userTypeQsName="WacUserType",X.wacClusterHeaderName="X-WacCluster",X.wacClusterQsName="waccluster",X.wacUserAgentHeaderName="X-WacUserAgent",X.wacUserAgentQsName="wdwacuseragent",X.requestApiQueryParam="rapi",X.userSessionIdHeaderName="X-UserSessionId",X.appliedPolicyIdHeaderName="X-AppliedPolicyId",X.selectedPolicyLabelIdHeaderName="X-SelectedPolicyLabelId",X.setPolicyLabelJustificationHeaderName="X-SetPolicyLabelJustification",X.setPolicyLabelActionSourceHeaderName="X-SetPolicyLabelActionSource",X.setPolicyLabelAssignmentMethodHeaderName="X-SetPolicyLabelAssignmentMethod",X.policyLabelVersionTokenHeaderName="X-PolicyLabelVersionToken",X.appLockIdHeaderName="X-AppLockId",X.logHostRequestsHeaderName="X-LogHostRequests",X.logHostRequestsQueryParam="loghostrequests",Object(i.a)(X,"ClientRequestManager",null,[79])},function(e,t,n){"use strict";var i=n(0),r=n(1),a=n(27),o=n(16),s=n(13),l=n(21),c=n(105),u=n(112),d=n(2),p=function(){this.languageId=0,this.name=null,this.displayName=null};Object(i.a)(p,"TranslationLanguageInfo",null,[]);var h=n(33),m=n(197),g=n(3),f=function(){function e(e,t){this._translationLanguages=null,this._translationLanguagesLocalized=!1,this._requestUri=e,this._defaultLanguages=t}var t=e.prototype;return t.requestTranslationLanguagesAppSetting=function(){r.AFrameworkApplication.theClientRequestManager.addRequest(this._requestUri(),1,null,null,!1,2,Object(d.d)(this,this.onAppSettingsRequestSucceeded,"onAppSettingsRequestSucceeded"),Object(d.d)(this,this.onAppSettingsRequestFailed,"onAppSettingsRequestFailed"),null)},t.getLanguages=function(){for(var e=(this._translationLanguages||this._defaultLanguages()).split(","),t=this._translationLanguagesLocalized?e.length/3:e.length/2,n=new Array(t),i=0;i<t;i++){n[i]=new p,n[i].name=e[i];var r=parseInt(e[i+t]);n[i].languageId=r,n[i].displayName=this._translationLanguagesLocalized?e[i+2*t]:m.a.get_l_LanguageNames()[r]}return n},t.updateAppSettings=function(e){this._translationLanguages=e.TranslationLanguages,this._translationLanguagesLocalized=Boolean.parse(e.TranslationLanguagesLocalized||"false")},t.onAppSettingsRequestFailed=function(e){var t,n=((t={}).Status=e.data.status,t.HttpStatus=e.data.httpStatus,t.ResponseData=s.a.trimToLength(e.data.responseData,100),t);g.ULS.sendTraceTag(42295809,301,10,"Failed to get the supported translation languages. The translation languages from BRS setting will be used. Error: {0}",n)},t.onAppSettingsRequestSucceeded=function(e){var t;g.ULS.sendTraceTag(42295810,301,50,"Retrieved the supported translation languages successfully.");try{var n=e.data.responseData;t=h.b(n)}catch(e){return void g.ULS.sendTraceTag(42295811,301,10,"Failed to deserialize the supported translation languages. The translation languages from BRS setting will be used. Exception: {0}",e)}this.updateAppSettings(t)},e}();Object(i.a)(f,"TranslationLanguagesManager",null,[]),n.d(t,"a",(function(){return v}));var v=function(){function e(){}return e.launchDialog=function(){(new(0,n(522).TranslationDialog)).start()},e.downloadATranslatedCopy=function(){var e=n(288).DownloadATranslatedCopyRequest,t=n(14).App;(new e).start(t.get_activeAppFrame().notificationBar)},e.saveAndEditDialog=function(){(new(0,n(516).SaveAndEditDialog)).start()},e.saveAndEditATranslatedCopy=function(){var e=n(517).SaveAndEditATranslatedCopyRequest,t=n(14).App;(new e).start(t.get_activeAppFrame().notificationBar)},e.translateDocument=function(e){var t=n(523).TranslateDocumentRequestFromViewer,i=n(14).App;new t(e).start(i.get_activeAppFrame().notificationBar)},e.navigateToOriginalDocument=function(){if(c.b(r.AFrameworkApplication.appSettingsManager)){var e=new u.a;e.add("language",""),c.f("view",e,c.g)}else{var t=a.a.removeParameter(window.self.location.href,"language");o.a.openWindow(1,t)}},e.triggerFloodgateSurveyForTranslator=function(){var e=l.a.instance.resolveFuture("Common.ISystemInitiatedFeedback");e&&e.execute((function(e){window.setTimeout((function(){e.logActivity("WACTranslatorSurveyTrigger","WACTranslatorFloodgateCampaignEnabled")}),r.AFrameworkApplication.appSettingsManager.getIntAppSetting("WACTranslatorSurveyDelayInMilliseconds",5e3))}))},e.getLanguagesRequestUri=function(){var e=n(14).App;return e.webServiceBase+"translation.ashx?"+e.instance.theDocument.baseDocQuerySignature+"&uilang="+s.a.urlKeyValueEncode(r.AFrameworkApplication.uiCulture)},e.getDefaultTranslationLanguages=function(){return n(14).App.instance.translationLanguages},e}();v.translationLanguages=new f(v.getLanguagesRequestUri,v.getDefaultTranslationLanguages),Object(i.a)(v,"TranslationManager",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(2),a=n(223),o=n(93),s=function(){function e(){this._map=new Map,this.$$ge=this.getEnumerator}var t=e.prototype;return t.getEnumerator=function(){return o.select(o.fromIterator(Object(r.d)(this._map,this._map.entries,"entries")),(function(e){return new a.a(e[0],e[1])})).$$ge()},t[Symbol.iterator]=function(){return Object(r.b)(this.getEnumerator())},t.get_count=function(){return this._map.size},t.get_keys=function(){return o.fromIterator(Object(r.d)(this._map,this._map.keys,"keys"))},t.get_values=function(){return o.fromIterator(Object(r.d)(this._map,this._map.values,"values"))},t.add=function(e,t){if(this._map.has(e))throw Error.create("DuplicateKey");this._map.set(e,t)},t.containsKey=function(e){return this._map.has(e)},t.remove=function(e){return!!this._map.has(e)&&(this._map.delete(e),!0)},t.tryGetValue=function(e,t,n){return void 0===n&&(n=null),this._map.has(e)?(t.val=this._map.get(e),!0):(t.val=n,!1)},t.get_item=function(e){if(!this._map.has(e))throw Error.create("KeyNotFoundException");return this._map.get(e)},t.set_item=function(e,t){return this._map.set(e,t),t},e}();Object(i.a)(s,"StringDictionary",null,[55,35])},function(e,t,n){"use strict";var i=n(0),r=n(19),a=n(106),o=n(30),s=function(){function e(){}return e.prototype.createPerfTelemetryLogger=function(e){var t=n(503).EuplTelemetryLogger,i=n(504).HostCallsTelemetryLogger,r=null;switch(e){case 0:r=new t;break;case 1:r=new i;break;default:r=null}return r},e}();Object(i.a)(s,"PerfTelemetryLoggerFactory",null,[199]);var l=n(33),c=n(21),u=n(3);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return p}));var p=function(){function e(){this._pageLoadPerfMetrics={},this._metadataDict=null,this._logged=!1,this._resourceTimingLoggerFuture=null}var t,i,p,h=e.prototype;return h.addMetrics=function(e,t){this.isValid(e)&&(this._pageLoadPerfMetrics[e]=t)},h.addMetadata=function(e,t){this._logged||(this._metadataDict||(this._metadataDict={}),this.isValidInDictionary(e,this._metadataDict)&&(this._metadataDict[e]=t))},h.isValid=function(e){return this.isValidInDictionary(e,this._pageLoadPerfMetrics)},h.isValidInDictionary=function(e,t){return!this._logged&&!(e in t)},h.addMetric=function(e,t){this.isValid(e)&&(this._pageLoadPerfMetrics[e]=t)},h.addDurationMetric=function(e,t,n){if(this.isValid(t)&&e in this._pageLoadPerfMetrics){var i=this._pageLoadPerfMetrics[e];this._pageLoadPerfMetrics[t]=n-i}},h.getMetric=function(e){return this._pageLoadPerfMetrics?this._pageLoadPerfMetrics[e]:null},h.containsMetric=function(e){return!this._logged&&e in this._pageLoadPerfMetrics},h.clearMetric=function(e){this._logged||delete this._pageLoadPerfMetrics[e]},h.log=function(){var e=this;this._logged?u.ULS.shipAssertTag(19214609,324,!0,"Attempt to log after object is logged."):(this.resourceTimingLoggerFuture.execute((function(t){t.flush(),e.logImpl()})),this._logged=!0)},h.logImpl=function(){var t=n(1).AFrameworkApplication;this.computeAndAddDurationMetrics(),this.addPerformanceObserverEntries();for(var i=l.c(this._pageLoadPerfMetrics),r=e.zeroPad(Math.ceil(i.length/3e3).toString(),3),o=1;i.length>0;o++)u.ULS.sendTraceTag(19214611,324,50,"Chunk {0} of {1} PageLoadPerfRecorder: {2}",e.zeroPad(o.toString(),3),r,i.substr(0,3e3)),i=i.substr(3e3);if(this._pageLoadPerfMetrics=null,t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("AppStaticResourceMonitorIsEnabled")&&this.resourceTimingLoggerFuture.execute((function(t){for(var n=l.c(t.getAppResourceTimingMetrics()),i=e.zeroPad(Math.ceil(n.length/3e3).toString(),3),r=1;n.length>0;r++)u.ULS.sendTraceTag(51652514,324,50,"Chunk {0} of {1} StaticContent: {2}",e.zeroPad(r.toString(),3),i,n.substr(0,3e3)),n=n.substr(3e3)})),t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("HashedResourcePathManagerLogOnExitIsEnabled")){var s=a.a.instance.getUnusedResourcesOnExit();s&&this.resourceTimingLoggerFuture.execute((function(t){for(var n=l.c(s),i=e.zeroPad(Math.ceil(n.length/3e3).toString(),3),r=1;n.length>0;r++)u.ULS.sendTraceTag(591015966,324,50,"Chunk {0} of {1} UnusedResources: {2}",e.zeroPad(r.toString(),3),i,n.substr(0,3e3)),n=n.substr(3e3)}))}},h.logTelemetry=function(){var e=n(1).AFrameworkApplication;e.appSettingsManager&&e.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ResourceDownloadLatencyTelemetryIsEnabled",!1)&&this.resourceTimingLoggerFuture.execute((function(e){e.flush(),e.recordAppResourceTimingMetricsToKpi()})),e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&e.appSettingsManager.getBooleanAppSetting("AcquireLockHostCallLoggingIsEnabled")&&this.sendAcquireLockToMdm(),e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&e.appSettingsManager.getBooleanAppSetting("GetDocumentHostCallLoggingIsEnabled")&&this.sendGetDocumentToMdm(),e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&e.appSettingsManager.getBooleanAppSetting("GetContentBundleHostCallLoggingIsEnabled")&&this.sendGetContentBundleToMdm()},h.sendGetContentBundleToMdm=function(){this.logMetricValue("bundleRequestsData","GetContentBundle")},h.sendGetDocumentToMdm=function(){this.logMetricValue("fileRequestsData","GetDocument")},h.sendAcquireLockToMdm=function(){this.logMetricValue("fileRequestsData","AcquireLock")},h.logMetricValue=function(e,t){var n=this.getDictionaryFromDiagnostics(e,t);if(n){var i=n.endTime,r=n.startTime,a="";"requestStatus"in n&&(a=n.requestStatus);var o=i-r,l=this.getDimensions();l.HostCallName=t,l.RequestStatus=a;var c=(new s).createPerfTelemetryLogger(1);c&&c.logToMdm(o,l)}},h.getDictionaryFromDiagnostics=function(e,t){var n=null;try{var i=this._pageLoadPerfMetrics[o.a.bootDiagnostics];if(!(e in i))return u.ULS.sendTraceTag(594626787,324,100,"Category {0} does not exist in BootDiagnostics",e),null;var r=i[e];if(!(t in r))return u.ULS.sendTraceTag(594626786,324,100,"Metric {0} does not exist under category {1} in BootDiagnostics",t,e),null;n=r[t]}catch(e){u.ULS.sendTraceTag(594626785,324,10,"Encountered the following exception when trying to get metric from boot diagnostics dictionary {0}",e)}return n},h.getDimensions=function(){var e=n(1).AFrameworkApplication,t={};t.Application=Object(r.a)(String,e.sessionStartInfoSettings.Application)||"",t.ApplicationMode=Object(r.a)(String,e.sessionStartInfoSettings.ApplicationMode)||"";var i=Object(r.a)(String,n(1).AFrameworkApplication.sessionStartInfoSettings.UserSessionApplicationMode)||"";return t.AppAndMode=t.Application+"-"+i,t.Browser=Object(r.a)(String,e.sessionStartInfoSettings.Browser)||"",t.BrowserMajorVersion=Object(r.a)(String,e.sessionStartInfoSettings.BrowserMajorVersion)||"",t.BrowserVersion=Object(r.a)(String,e.sessionStartInfoSettings.BrowserVersion)||"",t.Build=Object(r.a)(String,e.sessionStartInfoSettings.WFEVersion)||"",t.Datacenter=Object(r.a)(String,e.sessionStartInfoSettings.WACDatacenter)||"",t.Host=Object(r.a)(String,e.sessionStartInfoSettings.Host)||"",t.Ring=Object(r.a)(String,e.sessionStartInfoSettings.Ring)||"-1",t.IsSynthetic=Object(r.a)(String,e.sessionStartInfoSettings.IsSynthetic)||"",t.OS=Object(r.a)(String,e.sessionStartInfoSettings.OS)||"",t.RoutedVia=Object(r.a)(String,e.sessionStartInfoSettings.RoutedVia)||"",t.SessionOrigin=Object(r.a)(String,e.sessionOriginParamName)||"",t.UiHost=Object(r.a)(String,e.sessionStartInfoSettings.UiHost)||"",t},h.computeAndAddDurationMetrics=function(){this._metadataDict&&(this._pageLoadPerfMetrics.Metadata=this._metadataDict),this.addDuration(o.a.userClickedHostUI,o.a.frameFetchStart,o.a.hostDuration),this.addDuration(o.a.frameFetchStart,o.a.contentViewable,o.a.browserFetchStartToContentViewableDuration),this.addDuration(o.a.frameFetchStart,o.a.contentEditable,o.a.browserFetchStartToContentEditableDuration),this.addGetCellsStartToClientGetCellsFetchStartDuration()},h.addPerformanceObserverEntries=function(){var e=n(1).AFrameworkApplication;if(e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("WacPerfObserverEntriesIsEnabled")){var t=window.wacPerfObserver;t&&this.addMetrics(o.a.wacPerfObserver,t)}},h.addGetCellsStartToClientGetCellsFetchStartDuration=function(){if(o.a.contentFetchStart in this._pageLoadPerfMetrics&&o.a.frameResponseStart in this._pageLoadPerfMetrics&&o.a.frameFetchStart in this._pageLoadPerfMetrics){var e=this._pageLoadPerfMetrics[o.a.contentFetchStart],t=this._pageLoadPerfMetrics[o.a.frameResponseStart],n=this._pageLoadPerfMetrics[o.a.frameFetchStart];this._pageLoadPerfMetrics[o.a.getCellsStartToClientGetCellsFetchStartDuration]=e-(t-n)}},h.addDuration=function(e,t,n){if(t in this._pageLoadPerfMetrics){var i=this._pageLoadPerfMetrics[t];this.addDurationMetric(e,n,i)}},e.zeroPad=function(e,t){for(var n="",i=e.length;i<t;i++)n+="0";return n+e},t=e,p=[{key:"instance",get:function(){return e._instance||(e._instance=new e)}}],(i=[{key:"pageLoadPerfMetrics",get:function(){return this._pageLoadPerfMetrics}},{key:"resourceTimingLoggerFuture",get:function(){return this._resourceTimingLoggerFuture||(this._resourceTimingLoggerFuture=c.a.instance.resolveFuture("Common.NetworkTiming.IResourceTimingLogger"))}},{key:"hasLogged",get:function(){return this._logged}}])&&d(t.prototype,i),p&&d(t,p),e}();p._instance=null,Object(i.a)(p,"PageLoadPerfRecorder",null,[10])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));n(76);var i=function(e,t){var n=e._customData;return n?n[t]:null},r=function(e,t,n){var i=e._customData;i||(i={},e._customData=i),i[t]=n}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(17),o=n(32),s=n(75),l=n(7);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(){}var t,n,i;return t=e,i=[{key:"commercialPrivacyNoticeDialogHtmlTemplate",get:function(){return e.dialogHtmlFormat}}],(n=null)&&c(t.prototype,n),i&&c(t,i),e}();u.dialogHtmlFormat="<div class='PrivacyNoticeDialogContainer' id='PrivacyNoticeContainerId'> <div class='\"\"' id='{0}'> <svg xmlns='http://www.w3.org/2000/svg' class='MsDialogLogo' viewBox='0 0 99 21'><path class='HC c74' d='M34.94384 12.1124l-.59342 1.6608h-.03374a15.86223 15.86223 0 0 0-.56213-1.64266l-3.1758-7.96679h-3.1049V16.83h2.0478V9.0436c0-.48062-.01031-1.0614-.03057-1.72611-.01055-.33629-.04861-.60582-.058-.811h.045c.10406.4772.21219.84074.29036 1.084L33.57659 16.83h1.43266L38.789 7.507a8.2553 8.2553 0 0 0 .2602-1.00052h.04492c-.04934.9227-.09132 1.76588-.097 2.27472V16.83h2.18466V4.16375h-2.98185zM43.23858 7.75293h2.13529v9.07703h-2.13529zM44.32818 3.89545a1.28731 1.28731 0 0 0-.90968.35668 1.17694 1.17694 0 0 0-.38108.89053 1.14511 1.14511 0 0 0 .37691.87288 1.30076 1.30076 0 0 0 .91385.34783 1.31646 1.31646 0 0 0 .91793-.34758 1.13946 1.13946 0 0 0 .38181-.87313 1.19956 1.19956 0 0 0-.37138-.88073 1.27358 1.27358 0 0 0-.92836-.36648zM52.93294 7.66212a5.91561 5.91561 0 0 0-1.19319-.12789 5.26835 5.26835 0 0 0-2.59678.62421 4.20113 4.20113 0 0 0-1.7121 1.761 5.60038 5.60038 0 0 0-.58863 2.60829 4.81649 4.81649 0 0 0 .57156 2.33827 4.01747 4.01747 0 0 0 1.59784 1.61566 4.76026 4.76026 0 0 0 2.33414.56726 5.10923 5.10923 0 0 0 2.57564-.60285l.02823-.01646v-1.95585l-.08958.06553a4.01826 4.01826 0 0 1-1.04469.5437 3.16174 3.16174 0 0 1-1.02312.19835 2.62927 2.62927 0 0 1-1.99855-.7791 3.02828 3.02828 0 0 1-.73738-2.15814 3.14318 3.14318 0 0 1 .7683-2.2158 2.61573 2.61573 0 0 1 2.0025-.82649 3.42846 3.42846 0 0 1 2.03294.70694l.08958.06505V8.01264l-.02871-.01619a3.53811 3.53811 0 0 0-.988-.33433zM59.96821 7.59536a2.18731 2.18731 0 0 0-1.42788.512 2.88955 2.88955 0 0 0-.82155 1.21724h-.0226V7.75293h-2.135V16.83h2.135v-4.64348a3.23654 3.23654 0 0 1 .53217-1.92787 1.63252 1.63252 0 0 1 1.381-.72928 2.51241 2.51241 0 0 1 .64211.09425 1.6279 1.6279 0 0 1 .49781.20129l.08984.0648V7.73722l-.03461-.01472a2.21076 2.21076 0 0 0-.83629-.12714zM65.76756 7.53423a4.73981 4.73981 0 0 0-3.53323 1.30366 4.8866 4.8866 0 0 0-1.27666 3.55874 4.62871 4.62871 0 0 0 1.24622 3.397 4.52193 4.52193 0 0 0 3.34472 1.2553 4.61146 4.61146 0 0 0 3.4635-1.32158 4.87659 4.87659 0 0 0 1.27641-3.5234 4.75509 4.75509 0 0 0-1.19763-3.42251 4.41 4.41 0 0 0-3.32333-1.24721zm1.69763 6.98912a2.16529 2.16529 0 0 1-1.7941.758 2.292 2.292 0 0 1-1.83879-.77224 3.28324 3.28324 0 0 1-.66079-2.18268 3.41139 3.41139 0 0 1 .66079-2.2396 2.25617 2.25617 0 0 1 1.82135-.785 2.2219 2.2219 0 0 1 1.77349.75063 3.34221 3.34221 0 0 1 .64729 2.22145 3.56448 3.56448 0 0 1-.60924 2.24944zM75.02376 11.50364a4.64261 4.64261 0 0 1-1.28156-.66645.93192.93192 0 0 1-.25872-.69907.7783.7783 0 0 1 .32844-.64681 1.47116 1.47116 0 0 1 .91951-.2597A3.75721 3.75721 0 0 1 75.82669 9.4a3.5299 3.5299 0 0 1 .95633.44332l.08836.06015V7.92966l-.03438-.01473a4.71358 4.71358 0 0 0-.97056-.27048 5.95145 5.95145 0 0 0-1.06507-.11022 3.90841 3.90841 0 0 0-2.504.774 2.46926 2.46926 0 0 0-.97524 2.01379 2.80966 2.80966 0 0 0 .21036 1.12521 2.25421 2.25421 0 0 0 .64606.84416 5.62313 5.62313 0 0 0 1.31374.73491 9.79062 9.79062 0 0 1 1.09256.5091 1.51226 1.51226 0 0 1 .48085.395.88377.88377 0 0 1 .13427.5145c0 .61022-.45681.90649-1.39643.90649a3.84033 3.84033 0 0 1-1.18167-.216 4.45107 4.45107 0 0 1-1.21016-.61366l-.08958-.06455v2.0813l.03265.01521a5.36515 5.36515 0 0 0 1.14606.354 6.138 6.138 0 0 0 1.22365.14139 4.15062 4.15062 0 0 0 2.64391-.77812 2.51712 2.51712 0 0 0 .98431-2.06215 2.36906 2.36906 0 0 0-.52948-1.55943 4.53616 4.53616 0 0 0-1.79947-1.14574zM83.09416 7.53423a4.7402 4.7402 0 0 0-3.53323 1.30366 4.88764 4.88764 0 0 0-1.27666 3.55874 4.62784 4.62784 0 0 0 1.24647 3.397 4.52149 4.52149 0 0 0 3.34472 1.2553 4.61122 4.61122 0 0 0 3.46325-1.32158 4.87564 4.87564 0 0 0 1.27666-3.5234 4.75413 4.75413 0 0 0-1.19788-3.42251 4.41 4.41 0 0 0-3.32333-1.24721zm1.69789 6.98912a2.16569 2.16569 0 0 1-1.79411.758 2.29291 2.29291 0 0 1-1.839-.77224 3.28319 3.28319 0 0 1-.66054-2.18268 3.41139 3.41139 0 0 1 .66079-2.2396 2.25548 2.25548 0 0 1 1.82135-.785 2.22224 2.22224 0 0 1 1.77349.75063 3.34221 3.34221 0 0 1 .64729 2.22145 3.56611 3.56611 0 0 1-.60927 2.24944zM99 9.49425V7.75293h-2.16229V5.04546l-.07289.02234-2.031.62176-.04.01229v2.05108H91.49V6.6103a1.811 1.811 0 0 1 .354-1.21038 1.244 1.244 0 0 1 .99-.40526 2.307 2.307 0 0 1 .94012.21428l.07953.03534V3.41019l-.0373-.01327a3.65779 3.65779 0 0 0-1.201-.161 3.52356 3.52356 0 0 0-1.70329.40944 2.91321 2.91321 0 0 0-1.16926 1.15585 3.43992 3.43992 0 0 0-.41409 1.6952v1.25652H87.823v1.74132h1.50569V16.83H91.49V9.49425h3.2038v4.66187c0 1.91953.90551 2.8928 2.69152 2.8928a4.4019 4.4019 0 0 0 .9178-.10187 2.5365 2.5365 0 0 0 .66841-.21207L99 16.71877v-1.75826l-.08787.05866a1.5096 1.5096 0 0 1-.43472.18975 1.66121 1.66121 0 0 1-.42686.07242 1.15891 1.15891 0 0 1-.92023-.33506 1.8056 1.8056 0 0 1-.29261-1.16669V9.49425z'/><path fill='#f05226' d='M0-.06719h10.0444v10.0444H0z'/><path fill='#80bb42' d='M11.09009-.06719h10.04415V9.97698H11.09009z'/><path fill='#339fd9' d='M0 11.02682h10.04415v10.04417H0z'/><path fill='#fdb816' d='M11.09009 11.02682h10.04415v10.04417H11.09009z'/></svg> </div> <div class='PrivacyNoticeDialogInnerContainer' id='PrivacyNoticeInnerContainerId'> <div class='UIFontDialogTitle PrivacyDialogTitle' id='PrivacyDialogTitle'> <div class='WACDialogSectionTitle'>{1}</div> </div> <div class='WACDialogRow' id='ThanksBlock'> <div class='\"\"' id='ThanksTextRow'> <label id='ThanksText' class='WACDialogLabel' >{2}</label> </div> <div class='\"\"' id='AdminInfoRow'> <label id='AdminInfo' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRow' id='LearnMoreLinkRow'> <a id='LearnMoreLinkId' class='LearnMoreLink' href={5} target='_blank' >{4}</a> </div> </div> <div class='WACDialogRow' id='AdjustBlock'> <div class='\"\"' id='AdjustBlockText'> <label id='AdjustText' class='WACDialogLabel' >{6}</label> </div> <div class='\"\"' id='AdjustBlockLink'> <a id='{7}' class='AccountPrivacyLink' href=# target='_self' >{8}</a> </div> </div> <div class='WACDialogRow' id='ServicesAgreementBlock'> <div class='\"\"' id='ServicesAgreementText'> <label id='AgreementText' class='WACDialogLabel' >{9}</label> </div> <div class='\"\"' id='ServicesAgreementLink'> <a id='ServicesAgreementLinkId' class='ServicesAgreementLink' href={11} target='_blank' >{10}</a> </div> </div> </div> </div>",Object(i.a)(u,"CommercialPrivacyNoticeDialogHtml",null,[]);var d=function(){function e(){this.dialog=null,this._callback=null}var t=e.prototype;return t.initializeAndShowDialog=function(e){n(115).PrivacyDialogManager.recordSessionPrivacyActivity(o.a.privacyNotice_CommercialUsersShown),this.dialog=new s.a,this._callback=e,this.dialog.dialogHtml=s.a.formatHtml(u.commercialPrivacyNoticeDialogHtmlTemplate,"MSDialogLogoId",CommonUIStrings.l_PrivacyNoticeDialogTitle,CommonUIStrings.l_PrivacyNoticeDialogMessageText,CommonUIStrings.l_PrivacyNoticeDialogMessageSubText,CommonUIStrings.l_PrivacyDialogLearnMore,"https://go.microsoft.com/fwlink/?linkid=2090814",CommonUIStrings.l_PrivacyNoticeDialogSettingsLocation,"TrustCenterLinkId",CommonUIStrings.l_PrivacyNoticeDialogSettingsLink,CommonUIStrings.l_PrivacyNoticeDialogServicesAgreementText,CommonUIStrings.l_PrivacyNoticeDialogServiesAgreementLink,"https://go.microsoft.com/fwlink/?linkid=2093457"),this.dialog.dialogId="CommercialPrivacyNoticeDialog",this.dialog.buttonsOption=0,this.dialog.setButtonText(1,CommonUIStrings.l_Close),this.dialog.initializeAndShow("",Object(r.d)(this,this.dialogHandler,"dialogHandler"),null);var t=document.getElementById("TrustCenterLinkId");a.a.addHandler(t,"click",Object(r.d)(this,this.onTrustCenterClicked,"onTrustCenterClicked"));var i=document.getElementById("MSDialogLogoId");i&&(i.setAttribute(l.a.ariaRoleAttribute,l.a.ariaImageRole),i.setAttribute("title",CommonUIStrings.l_PrivacySettingsDialogMicrosoftLogoAltText))},t.onTrustCenterClicked=function(e){var t=n(115).PrivacyDialogManager;t.recordSessionPrivacyActivity(o.a.privacyNotice_CommercialUsersTrustCenterClicked),this.dialog&&(this.dialog.hide(),this.dialog=null,t.showCommercialTrustCenterDialog())},t.dialogHandler=function(e,t){n(115).PrivacyDialogManager.recordSessionPrivacyActivity(o.a.privacyNotice_CommercialUsersDismissed),this.dialog=null,this._callback()},e}();function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(d,"CommercialPrivacyNoticeDialog",null,[91]);var h=function(){function e(){}var t,n,i;return t=e,i=[{key:"commercialTrustCenterDialogHtmlTemplate",get:function(){return e.dialogHtmlFormat}}],(n=null)&&p(t.prototype,n),i&&p(t,i),e}();function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}h.dialogHtmlFormat="<div class='TrustCenterDialogOuterContainer' id='PrivacySettingsContainer'> <div class='UIFontDialogTitle PrivacyDialogTitle' id='PrivacyDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='\"\"' id='PrivacyDialogSubTitleContainer'> <label id='PrivacyDialogSubTitle' class='WACDialogLabel' >{1}</label> </div> <br/> <div class='TrustCenterDialogInfoContainer' id='InfoContainer'> <div class='\"\"' id='InfoMessageBlock'> <div class='WACDialogIcon' id='TopInfoIconArea'> <div class='clip24x24' id='TopInfoIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='TopIconInfo' title='{4}' class='{3}' role='img' src={2} /> </div> </div> <div class='TrustCenterDialogInfoText' id='InfoMessageArea'> <label id='MessageInfo' class='\"\"' >{5}</label> </div> </div> </div> <br/> <div class='TrustCenterDialogExperiencesContainer' id='{6}'> <div class='UIFontDialogTextLarge PrivacyDialogTitle' id='OptionalExperiencesTitleArea'> <label id='OptionalExperiencesTitle' class='WACDialogLabel' >{7}</label> </div> <div class='WACDialogRow' id='OptionalExperiencesSubTitleArea'> <label id='OptionalExperiencesSubTitle' class='WACDialogLabel' >{8}</label> </div> <div class='WACDialogRow' id='LearnMoreLinkRow'> <a id='LearnMoreLinkId' class='LearnMoreLink' href={10} target='_blank' >{9}</a> </div> <div class='WACDialogCheckBoxDiv' id='EnableExperiencesCheckBox'> <input type='checkbox' id='{11}' class='WACDialogCheckBox' title='{12}'></input> <label id='\"\"' class='WACDialogLabel' for='{11}' >{12}</label> </div> <br/> <div class='{13}' id='CheckboxInfoContainer'> <div class='\"\"' id='CheckboxInfoMessage'> <div class='WACDialogIcon' id='BottomInfoIconArea'> <div class='clip24x24' id='BottomInfoIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='BottomIconInfo' title='{4}' class='{3}' role='img' src={2} /> </div> </div> <div class='TrustCenterDialogInfoText' id='ExperiencesInfoRow'> <label id='ExperiencesInfo' class='\"\"' >{14}</label> </div> </div> <a id='PrivacyStatementLinkId' class='PrivacyStatementLink' href={16} target='_blank' >{15}</a> </div> <br/> </div>",Object(i.a)(h,"CommercialTrustCenterDialogHtml",null,[]);var g="EnableConnectedExperiencesCheckbox",f=function(){function e(){this.enableConnectedExperiencesCheckbox=null,this._userPrivacySettings=null,this._callback=null}var t,i,l,c=e.prototype;return c.initializeAndShowDialog=function(t,i,a){var l=n(115).PrivacyDialogManager,c=n(1).AFrameworkApplication,u=n(55).getImageClass;l.recordSessionPrivacyActivity(o.a.privacyTrustCenter_Shown),this._callback=a,this._userPrivacySettings=i;var d=new s.a(!1,!1,e.useReactDialog);if(d.dialogId="CommercialTrustCenterDialog",d.buttonsOption=1,e.useReactDialog){var p,m,f,v,_,y,b,S=((b={}).id=d.dialogId,b.bodyControls=((y={}).optionalConnectedExperiencesCheckboxProps=((p={}).label=CommonUIStrings.l_PrivacySettingsDialogCheckboxText,p),y.learnMoreLinkProps=((f={}).text=CommonUIStrings.l_PrivacyDialogLearnMore,f.handler=((m={}).href="https://go.microsoft.com/fwlink/?linkid=2090814",m.target="_blank",m),f),y.privacyStatementLinkProps=((_={}).text=CommonUIStrings.l_PrivacySettingsDialogMicrosoftPrivacyStatement,_.handler=((v={}).href="https://go.microsoft.com/fwlink/?linkid=2090462",v.target="_blank",v),_),y),b.title=CommonUIStrings.l_PrivacySettingsDialogHeader,b.subTitle=CommonUIStrings.l_PrivacySettingsDialogSubHeader,b.infoMessage=t?CommonUIStrings.l_PrivacySettingsDialogMessage:CommonUIStrings.l_PrivacySettingsDialogAdminDisabled,b.optionalExperiencesEnabled=t,b.optionalExperiencesTitle=CommonUIStrings.l_PrivacySettingsDialogExperiencesTitle,b.optionalExperiencesSubTitle=CommonUIStrings.l_PrivacySettingsDialogExperiencesMessage,b.optionalExperiencesInfoMessage=CommonUIStrings.l_PrivacySettingsDialogWarning,b.optionalExperiencesCheckboxInitialValue=2!==i.controllerServicesStateRoaming,b.onOptionalExperiencesCheckboxChanged=Object(r.d)(this,this.recordSessionPrivacyActivityOnStateChange,"recordSessionPrivacyActivityOnStateChange"),b);d.initializeAndShow(CommonUIStrings.l_PrivacySettingsDialogTitle,Object(r.d)(this,this.reactDialogHandler,"reactDialogHandler"),S)}else{var C=2!==i.controllerServicesStateRoaming?"TrustCenterDialogInfoContainer":"TrustCenterExperiencesDisabledDialogInfoContainer";d.dialogHtml=s.a.formatHtml(h.commercialTrustCenterDialogHtmlTemplate,CommonUIStrings.l_PrivacySettingsDialogHeader,CommonUIStrings.l_PrivacySettingsDialogSubHeader,c.imageClusterPath,u(e.iconName),CommonUIStrings.l_DialogInfo,t?CommonUIStrings.l_PrivacySettingsDialogMessage:CommonUIStrings.l_PrivacySettingsDialogAdminDisabled,"ConnectedExperiencesID",CommonUIStrings.l_PrivacySettingsDialogExperiencesTitle,CommonUIStrings.l_PrivacySettingsDialogExperiencesMessage,CommonUIStrings.l_PrivacyDialogLearnMore,"https://go.microsoft.com/fwlink/?linkid=2090814",g,CommonUIStrings.l_PrivacySettingsDialogCheckboxText,C,CommonUIStrings.l_PrivacySettingsDialogWarning,CommonUIStrings.l_PrivacySettingsDialogMicrosoftPrivacyStatement,"https://go.microsoft.com/fwlink/?linkid=2090462");var A={};if(A[g]=2!==i.controllerServicesStateRoaming,t?d.initializeAndShow(CommonUIStrings.l_PrivacySettingsDialogTitle,Object(r.d)(this,this.dialogHandler_PrivacySettingsAdminEnabled,"dialogHandler_PrivacySettingsAdminEnabled"),A):d.initializeAndShow(CommonUIStrings.l_PrivacySettingsDialogTitle,Object(r.d)(this,this.dialogHandler_PrivacySettingsAdminDisabled,"dialogHandler_PrivacySettingsAdminDisabled"),A),this.setUpCheckbox(),!t)document.getElementById("ConnectedExperiencesID").style.display="none"}},c.setUpCheckbox=function(){this.enableConnectedExperiencesCheckbox=document.getElementById(g),a.a.addHandler(this.enableConnectedExperiencesCheckbox,"click",Object(r.d)(this,this.onConnectedExperiencesCheckChanged,"onConnectedExperiencesCheckChanged"))},c.onConnectedExperiencesCheckChanged=function(e){var t=document.getElementById("CheckboxInfoContainer");this.enableConnectedExperiencesCheckbox&&t&&(this.recordSessionPrivacyActivityOnStateChange(this.enableConnectedExperiencesCheckbox.checked),t.className=this.enableConnectedExperiencesCheckbox.checked?"TrustCenterDialogInfoContainer":"TrustCenterExperiencesDisabledDialogInfoContainer")},c.dialogHandler_PrivacySettingsAdminEnabled=function(e,t){if(n(115).PrivacyDialogManager.recordSessionPrivacyActivity(o.a.privacyTrustCenter_Dismissed),1===e&&t){this._userPrivacySettings.controllerServicesStateRoaming=t[g]?1:2;var i=new Date;this._userPrivacySettings.controllerServicesTimeRoaming=i.toISOString(),this._callback(this._userPrivacySettings)}},c.dialogHandler_PrivacySettingsAdminDisabled=function(e,t){n(115).PrivacyDialogManager.recordSessionPrivacyActivity(o.a.privacyTrustCenter_Dismissed)},c.reactDialogHandler=function(e,t){if(n(115).PrivacyDialogManager.recordSessionPrivacyActivity(o.a.privacyTrustCenter_Dismissed),1===e&&t&&t.optionalExperiencesEnabled){this._userPrivacySettings.controllerServicesStateRoaming=t.optionalExperiencesCheckboxChecked?1:2;var i=new Date;this._userPrivacySettings.controllerServicesTimeRoaming=i.toISOString(),this._callback(this._userPrivacySettings)}},c.recordSessionPrivacyActivityOnStateChange=function(e){var t=n(115).PrivacyDialogManager;e?t.recordSessionPrivacyActivity(o.a.privacyTrustCenter_UserPrivacyOptionCCSChecked):t.recordSessionPrivacyActivity(o.a.privacyTrustCenter_UserPrivacyOptionCCSUnChecked)},t=e,l=[{key:"useReactDialog",get:function(){var e=n(1).AFrameworkApplication;return e.activeFrame.applicationInstance.isReactDialogEnabled&&e.activeFrame.applicationInstance.isReactCommercialTrustCenterDialogEnabled}}],(i=null)&&m(t.prototype,i),l&&m(t,l),e}();f.iconName="Info_24x24x32",Object(i.a)(f,"CommercialTrustCenterDialog",null,[]);var v=n(58);var _=function(e){var t,i;function a(){var t;return(t=e.call(this)||this)._callback=null,t}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var s=a.prototype;return s.initializeAndShowDialog=function(e){var t,i,a,s,l;n(115).PrivacyDialogManager.recordSessionPrivacyActivity(o.a.privacyNotice_CommercialUsersShown),this._callback=e,this.dialogId="CommercialPrivacyNoticeDialog",this.buttonsOption=0,this.setButtonText(1,CommonUIStrings.l_Close),this.showMicrosoftLogo=!0;var c=[],u=[];Array.add(c,CommonUIStrings.l_PrivacyNoticeDialogMessageText),Array.add(c,CommonUIStrings.l_PrivacyNoticeDialogMessageSubText),Array.add(c,"{0}"),Array.add(u,((i={}).type="AppLinkProps",i.id="LearnMoreLinkId",i.text=CommonUIStrings.l_PrivacyDialogLearnMore,i.handler=((t={}).href="https://go.microsoft.com/fwlink/?linkid=2090814",t.target="_blank",t),i)),Array.add(c,""),Array.add(c,CommonUIStrings.l_PrivacyNoticeDialogSettingsLocation),Array.add(c,"{0}");var d=Object(r.d)(this,this.onTrustCenterClicked,"onTrustCenterClicked");Array.add(u,((a={}).type="AppLinkProps",a.id="TrustCenterLinkId",a.text=CommonUIStrings.l_PrivacyNoticeDialogSettingsLink,a.handler=d,a)),Array.add(c,""),Array.add(c,CommonUIStrings.l_PrivacyNoticeDialogServicesAgreementText),Array.add(c,"{0}"),Array.add(u,((l={}).type="AppLinkProps",l.id="ServicesAgreementLinkId",l.text=CommonUIStrings.l_PrivacyNoticeDialogServiesAgreementLink,l.handler=((s={}).href="https://go.microsoft.com/fwlink/?linkid=2093457",s.target="_blank",s),l)),this.addAdditionalTextBodyContent(c,u),this.messageBox(CommonUIStrings.l_PrivacyNoticeDialogTitle,null,0,Object(r.d)(this,this.dialogHandler,"dialogHandler"),null)},s.onTrustCenterClicked=function(e){var t=n(115).PrivacyDialogManager;t.recordSessionPrivacyActivity(o.a.privacyNotice_CommercialUsersTrustCenterClicked),this.hide(),t.showCommercialTrustCenterDialog()},s.dialogHandler=function(e,t){n(115).PrivacyDialogManager.recordSessionPrivacyActivity(o.a.privacyNotice_CommercialUsersDismissed),this._callback()},a}(v.StandardDialog);Object(i.a)(_,"ReactCommercialPrivacyNoticeDialog",v.StandardDialog,[91]);var y=function(){function e(){}var t=e.prototype;return t.initializeAndShowDialog=function(e){var t=n(115).PrivacyDialogManager;e?t.recordSessionPrivacyActivity(o.a.privacyTrustCenter_RefreshRequiredDialogShownForAnonUser):t.recordSessionPrivacyActivity(o.a.privacyTrustCenter_RefreshRequiredDialogShownForSignedInUser);var i=n(1).AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled&&n(1).AFrameworkApplication.activeFrame.applicationInstance.isReactRefreshDialogEnabled,a=new v.StandardDialog;a.buttonsOption=4,a.setButtonText(1,CommonUIStrings.l_RefreshRequiredDialogRefreshButton),a.setButtonText(2,CommonUIStrings.l_RefreshRequiredDialogNotNowButton),a.dialogId="RefreshRequiredDialog";var s=document.createElement("span");s.id="RefreshRequiredDialogContent";var l=document.createElement("span");if(l.innerText=CommonUIStrings.l_RefreshRequiredDialogText,s.appendChild(l),s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br")),e){var c=document.createElement("span");c.innerText=CommonUIStrings.l_RefreshRequiredDialogAnonymousText,s.appendChild(c),s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br"))}var u=document.createElement("a");if(u.href="https://go.microsoft.com/fwlink/?linkid=2100681",u.innerText=CommonUIStrings.l_RefreshRequiredDialogLinkText,u.target="_blank",s.appendChild(u),i){var d,p,h=[],m=[];Array.add(h,CommonUIStrings.l_RefreshRequiredDialogText),e&&Array.add(h,CommonUIStrings.l_RefreshRequiredDialogAnonymousText),Array.add(h,"{0}"),Array.add(m,((p={}).type="AppLinkProps",p.id="RefreshRequiredAnchorElement",p.text=CommonUIStrings.l_RefreshRequiredDialogLinkText,p.handler=((d={}).href="https://go.microsoft.com/fwlink/?linkid=2100681",d.target="_blank",d),p)),a.addAdditionalTextBodyContent(h,m)}a.messageBox(CommonUIStrings.l_RefreshRequiredDialogTitle,null,0,Object(r.d)(this,this.dialogHandler,"dialogHandler"),i?null:s)},t.dialogHandler=function(e,t){var i=n(115).PrivacyDialogManager,r=n(1).AFrameworkApplication;i.recordSessionPrivacyActivity(o.a.privacyTrustCenter_RefreshRequiredDialogDismissed),1===e&&r.activeFrame.applicationInstance.privacyRefreshRequested()},e}();Object(i.a)(y,"RefreshRequiredDialog",null,[]);var b=n(79),S=n(134),C=n(130),A=n(10),I=n(21),w=n(3);function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"PrivacyDialogManager",(function(){return E}));var E=function(){function e(){}var t,i,r;return e.showCommercialPrivacyNoticeDialog=function(t,n){(e.useReactCommercialPrivacyNoticeDialog?new _:new d).initializeAndShowDialog((function(){e.saveLocally("1"),t.userPrivacySettingsRoamedNoticeShown=1,t.controllerServicesStateRoaming=1;var i=new Date;t.controllerServicesTimeRoaming=i.toISOString(),e.savePrivateNoticeShown(n,t)}))},e.showPrivacyNoticeBusinessBar=function(t,i){var r=n(1).AFrameworkApplication;e.recordSessionPrivacyActivity(o.a.privacyNotice_BusinessBarForAnonymousUsersShown),r.activeFrame.applicationInstance.addGdprBusinessBarWithCloseCallback(CommonUIStrings.l_AnonymousBusBarPrivacyNotice,CommonUIStrings.l_PrivacyDialogLearnMore,"2090814",(function(n){e.recordSessionPrivacyActivity(o.a.privacyNotice_BusinessBarForAnonymousUsersDismissed),e.saveLocally("1"),t.controllerServicesStateRoaming=1,e.savePrivateNoticeShown(i,t)}))},e.showPrivacyNoticeRoamingBusinessBar=function(t,i){var r=n(1).AFrameworkApplication;e.recordSessionPrivacyActivity(o.a.privacyNotice_SettingsRoamedBusinessBarShown),r.activeFrame.applicationInstance.addGdprBusinessBarWithCloseCallback(CommonUIStrings.l_RoamedSettingsBusBarPrivacyNotice,"","",(function(t){e.recordSessionPrivacyActivity(o.a.privacyNotice_SettingsRoamedBusinessBarDismissed)})),e.saveLocally("1"),t.userPrivacySettingsRoamedNoticeShown=1,e.savePrivateNoticeShown(i,t)},e.savePrivateNoticeShown=function(t,n){t.saveSettings(n).then((function(t){return t?e.recordSessionPrivacyActivity(o.a.privacyNotice_SaveNoticeShownSucceeded):e.recordSessionPrivacyActivity(o.a.privacyNotice_SaveNoticeShownFailed),null}),(function(t){return e.recordSessionPrivacyActivity(o.a.privacyNotice_SaveNoticeShownFailed),null}))},e.showCommercialTrustCenterDialog=function(){I.a.instance.resolveFuture("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").execute((function(t){t.getSettings().then((function(n){e.recordUserPrivacySettingsDataSourceForSession(n);var i=new f;return e.tryGetAdminControllerConnectedServicesState(!0).then((function(r){return i.initializeAndShowDialog(r,n,(function(n){w.ULS.sendTraceTag(51258457,306,50,"PrivacyDialogManager.ShowCommercialTrustCenterDialog Callback, userPrivacySettingsModified = {0}",n),t.saveSettings(n).then((function(t){if(t){e.recordSessionPrivacyActivity(o.a.privacyTrustCenter_SaveSettingsSucceeded);var i=!!n.src;e.showRefreshRequiredDialog(i)}return null}),(function(t){return e.recordSessionPrivacyActivity(o.a.privacyTrustCenter_SaveSettingsFailed),w.ULS.sendTraceTag(50917390,306,10,"PrivacyDialogManager.ShowCommercialTrustCenterDialog: Error Saving Settings, error: {0}",t.toString()),null}))})),null})),null}))}))},e.showRefreshRequiredDialog=function(e){(new y).initializeAndShowDialog(e)},e.showPrivacyDialogIfNecessary=function(){window.Promise||!A.a.isInternetExplorerNonEdge||e._es6PromisePolyfillScriptIsLoaded?e.showPrivacyDialog():e.loadEs6PromisePolyfillScriptAndShowPrivacyDialogIfNecessary()},e.loadEs6PromisePolyfillScriptAndShowPrivacyDialogIfNecessary=function(){var t=n(1).AFrameworkApplication.scriptUrlFromName("es6-promise.auto",2),i=C.a.create(t);i.add_loadFinished((function(t,n){n.succeeded?(e._es6PromisePolyfillScriptIsLoaded=!0,e.showPrivacyDialog()):w.ULS.sendTraceTag(590966793,306,15,"PrivacyDialogmanager failed to load Es6PromisePolyfillScript.")})),S.a.enqueueResourceWithoutEnabling(i)},e.showPrivacyDialog=function(){e.shouldShowPrivacyNotice().then((function(t){return new Promise((function(n){t?(e._seenThisSession=!0,I.a.instance.resolveFuture("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").execute((function(t){t.getSettings().then((function(i){return e.recordUserPrivacySettingsDataSourceForSession(i),n(e.showFRENotice(i,t)),null}))}))):n(!1)}))})).then((function(t){return w.ULS.sendTraceTag(51258458,306,50,"PrivacyDialogManager.ShowPrivacyDialogIfNecessary: Notice shown = {0}",t.toString()),e.logPrivacyNoticeResult(),null}),(function(t){return w.ULS.sendTraceTag(51258459,306,10,"PrivacyDialogManager.ShowPrivacyDialogIfNecessary: Error showing notice {0}",t.toString()),e.recordSessionPrivacyActivity(o.a.privacyNotice_Error),e.logPrivacyNoticeResult(),null}))},e.shouldShowPrivacyNotice=function(){var t=n(1).AFrameworkApplication,i=-1!==window.location.href.indexOf("&wd_pn=1"),r=new Promise((function(e,t){e(!1)})),a=new Promise((function(e,t){e(!0)}));return i?(e.recordSessionPrivacyActivity(o.a.privacyNotice_Forced),a):t.mightNeedPrivacyDialog?(e.recordSessionPrivacyActivity(o.a.privacyNotice_MightBeNeeded),t.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled")?e._seenThisSession?r:t.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")&&!e.canWriteHasSeenNotice()?(e.recordSessionPrivacyActivity(o.a.privacyNotice_NotShown_CantWriteCachedCookie),r):(t.privacyDialogAlreadySeen&&(e.recordSessionPrivacyActivity(o.a.privacyNotice_NotShown_AlreadySeenFromHost),e.saveLocally("1")),e._seenLocally=e.hasSeenLocally("1"),e._seenLocally&&e.recordSessionPrivacyActivity(o.a.privacyNotice_NotShown_AlreadySeenFromCachedCookie),e._seenLocally||t.privacyDialogAlreadySeen?r:e.tryGetAdminControllerConnectedServicesState(!1)):(e.recordSessionPrivacyActivity(o.a.privacyNotice_NotShown_OCPSDisabled),r)):r},e.logPrivacyNoticeResult=function(){var e=n(1).AFrameworkApplication.dataPlumber.PrivacyNotice,t={};e&o.a.privacyNotice_MightBeNeeded&&(t.MightBeNeeded=1),e&o.a.privacyNotice_Forced&&(t.Forced=1),e&o.a.privacyNotice_CommercialUsersShown&&(t.CommercialUsersShown=1),e&o.a.privacyNotice_CommercialUsersTrustCenterClicked&&(t.CommercialUsersTrustCenterClicked=1),e&o.a.privacyNotice_CommercialUsersDismissed&&(t.CommercialUsersDismissed=1),e&o.a.privacyNotice_SettingsRoamedBusinessBarShown&&(t.SettingsRoamedBusinessBarShown=1),e&o.a.privacyNotice_SettingsRoamedBusinessBarDismissed&&(t.SettingsRoamedBusinessBarDismissed=1),e&o.a.privacyNotice_BusinessBarForAnonymousUsersShown&&(t.BusinessBarForAnonymousUsersShown=1),e&o.a.privacyNotice_BusinessBarForAnonymousUsersDismissed&&(t.BusinessBarForAnonymousUsersDismissed=1),e&o.a.privacyNotice_SaveNoticeShownSucceeded&&(t.SaveNoticeShownSucceeded=1),e&o.a.privacyNotice_SaveNoticeShownFailed&&(t.SaveNoticeShownFailed=1),e&o.a.privacyNotice_NotShown_OCPSDisabled&&(t.NotShown_OCPSDisabled=1),e&o.a.privacyNotice_NotShown_CantWriteCachedCookie&&(t.NotShown_CantWriteCachedCookie=1),e&o.a.privacyNotice_NotShown_AlreadySeenFromCachedCookie&&(t.NotShown_AlreadySeenFromCachedCookie=1),e&o.a.privacyNotice_NotShown_AlreadySeenFromHost&&(t.NotShown_AlreadySeenFromHost=1),e&o.a.privacyNotice_Error&&(t.PrivacyNoticeError=1),e&o.a.privacy_OCPSCCSDisabled&&(t.OCPSCCSDisabled=1),e&o.a.privacy_OCPSFailure&&(t.OCPSFailure=1),e&o.a.privacy_UserSettingsSourceRoaming&&(t.UserSettingsSourceRoaming=1),e&o.a.privacy_UserSettingsSourceCookie&&(t.UserSettingsSourceCookie=1),e&o.a.privacy_UserSettingsSourceQUeryParam&&(t.UserSettingsSourceQUeryParam=1),w.ULS.sendTraceTag(37357660,306,50,"PrivacyDialogmanager.LogPrivacyNoticeResult: {0}",t)},e.canWriteHasSeenNotice=function(){return e.saveLocally("-1"),e.hasSeenLocally("-1")},e.hasSeenLocally=function(e){return b.a.get("PrivNote")===e},e.saveLocally=function(e){var t=n(1).AFrameworkApplication.appSettingsManager.getStringAppSetting("PrivacyCookieDomain")||"";b.a.setWithAllTheThings("PrivNote",e,b.a.maxComplianceAllowedRetentionInDays,"/",t)},e.tryGetAdminControllerConnectedServicesState=function(t){return void 0===t&&(t=!0),new Promise((function(n,i){I.a.instance.resolveFuture("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute((function(r){r.getBooleanPolicySetting("ControllerConnectedServicesEnabled",t).then((function(t){return n(t),t||e.recordSessionPrivacyActivity(o.a.privacy_OCPSCCSDisabled),null}),(function(t){return i(t),e.recordSessionPrivacyActivity(o.a.privacy_OCPSFailure),null}))}))}))},e.showFRENotice=function(t,i){var r=n(1).AFrameworkApplication;if(null==t)return!1;if(t.src){if(1===t.src&&!t.controllerServicesStateRoaming&&r.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"))return e.showPrivacyNoticeBusinessBar(t,i),!0}else{if(1===t.userPrivacySettingsRoamedNoticeShown)return!1;if(!t.controllerServicesStateRoaming)return e.showCommercialPrivacyNoticeDialog(t,i),!0;if(!t.userPrivacySettingsRoamedNoticeShown)return e.showPrivacyNoticeRoamingBusinessBar(t,i),!0}return!1},e.recordSessionPrivacyActivity=function(e){n(1).AFrameworkApplication.dataPlumber.PrivacyNotice|=e},e.recordUserPrivacySettingsDataSourceForSession=function(t){switch(t.src){case 0:e.recordSessionPrivacyActivity(o.a.privacy_UserSettingsSourceRoaming);break;case 1:e.recordSessionPrivacyActivity(o.a.privacy_UserSettingsSourceCookie);break;case 2:e.recordSessionPrivacyActivity(o.a.privacy_UserSettingsSourceQUeryParam)}},t=e,r=[{key:"useReactCommercialPrivacyNoticeDialog",get:function(){var e=n(1).AFrameworkApplication;return e.activeFrame.applicationInstance.isReactDialogEnabled&&e.activeFrame.applicationInstance.isReactCommercialPrivacyNoticeDialogEnabled}}],(i=null)&&T(t.prototype,i),r&&T(t,r),e}();E._seenThisSession=!1,E._seenLocally=!1,E._es6PromisePolyfillScriptIsLoaded=!1,Object(i.a)(E,"PrivacyDialogManager",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"FlyoutAnchor",(function(){return f}));var i=n(0),r=(n(2),n(74)),a=(n(9),n(7)),o=n(23),s=n(64),l=n(202),c=n(98),u=n(72),d=(n(162),n(161),n(5),n(6)),p=n(51);function h(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).addDisplayMode("Small"),a.addDisplayMode("Small14"),a.addDisplayMode("Medium"),a.addDisplayMode("Medium14"),a.addDisplayMode("Large"),a.addDisplayMode("Large16"),a.addDisplayMode("Thin"),a.addDisplayMode("Menu"),a.addDisplayMode("Menu16"),a.addDisplayMode("Menu32"),a.addDisplayMode("Menu48"),a.addDisplayMode("MenuTellMe"),a.addDisplayMode("FloatieLarge"),a.addDisplayMode("Small20"),a.addDisplayMode("Small24"),a.addDisplayMode("Medium20"),a.isFloatieContextMenuDropDown=d.a.isTrue(a.properties$2.FloatieContextMenuDropDown),a._imageIsVisible=!d.a.isFalse(i.ImageIsVisible),a._imageUsesSpaceWhileInvisible=d.a.isTrue(i.ImageUsesSpaceWhileInvisible),a.stateProperties[c.a.SourceControlId]=n,a.stateProperties[c.a.LabelText]=a.labelText=a.properties$2.LabelText,a.stateProperties[c.a.LabelTextUserGeneratedPlaceholderReplacements]=a.properties$2.LabelTextUserGeneratedPlaceholderReplacements,a.stateProperties[c.a.Visible]=a.visible,a.stateProperties[c.a.ImageIsVisible]=a.imageIsVisible,a.stateProperties[c.a.ImageBackColor]=a.properties$2.ImageBackColor,a._useCheckMark=d.a.isTrue(i.UseCheckMark),a.stateProperties[c.a.On]=d.a.isTrue(i.IsChecked),a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,m,f,v=i.prototype;return v.onStateChanged=function(){var e=this,t=this.stateProperties[u.a.On];this.useCheckMark&&(this.stateProperties[a.a.ariaCheckedAttribute]=t?a.a.ariaTrueValue:a.a.ariaFalseValue),this.controlComponentDomCache.forEach((function(n){e.updateAriaMenuLauncherAttributes(n.elmControl,t)}))},v.createComponentDomForDisplayMode=function(e){var t=!d.a.isTrue(this.properties$2.HideDefaultArrow),n=new l.a(t).buildControlDom(this,e);return this.populateControlDom(n,e),n},v.populateControlDom=function(e,t){d.a.isTrue(this.properties$2.FloatieContextMenuDropDown)&&d.a.ensureCSSClassOnElement(e.elmControl,"context-menu-dd"),s.a.isDisplayModeMenu(t)&&d.a.ensureCSSClassOnElement(e.elmControl,"cui-fa-menuitem"),t.startsWith("Small")&&d.a.ensureCSSClassOnElement(e.elmControl,"cui-fa-sm"),this.setInitialAriaMenuLauncherAttributes(e.elmControl)},v.setInitialAriaMenuLauncherAttributes=function(t){this.useCheckMark&&a.a.setAriaAttribute(t,a.a.ariaCheckedAttribute,a.a.ariaFalseValue),e.prototype.setInitialAriaMenuLauncherAttributes.call(this,t)},v.updateAriaMenuLauncherAttributes=function(e,t){var n=this.menuLaunched?a.a.ariaTrueValue:a.a.ariaFalseValue;this.useCheckMark?a.a.setAriaAttribute(e,a.a.ariaCheckedAttribute,t?a.a.ariaTrueValue:a.a.ariaFalseValue):this.inMenu&&a.a.setAriaAttribute(e,a.a.ariaSelectedAttribute,n),a.a.setAriaAttribute(e,a.a.ariaExpandedAttribute,n)},v.onImageVisibleChanged=function(e){var t=this;this.controlComponentDomCache.forEach((function(n){t.setDisplay(n.elmIconContainer,e)}))},v.setDisplay=function(e,t){e&&(e.style.display="",e.style.visibility="",t||(this._imageUsesSpaceWhileInvisible?e.style.visibility="hidden":e.style.display="none"))},v.getTextValue=function(){return this.labelText},v.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},v.getControlsInFlyoutAnchorMenu=function(){for(var e,t=new Array(0),n=h(this.menu.children);!(e=n()).done;){0;for(var i,r=h(e.value.children);!(i=r()).done;){var a=i.value;0,t[t.length]=a.control}}return t},r=i,(m=[{key:"useCheckMark",get:function(){return this._useCheckMark}},{key:"ariaRole",get:function(){return this.inMenu?this.useCheckMark?a.a.ariaTreeItemRole:a.a.ariaTabRole:Object(p.a)(i.prototype,this,"ariaRole")}},{key:"controlType",get:function(){return o.Control.flyoutAnchorControlType}},{key:"imageIsVisible",get:function(){return this._imageIsVisible},set:function(e){var t=e;t!==this._imageIsVisible&&(this._imageIsVisible=t,this.onImageVisibleChanged(t))}},{key:"menuDirection",get:function(){var e=2;return this.displayedComponent.isMenuItem()?e=1:this.root.launchMenusUp&&(e=3),e}},{key:"launcherComponent",get:function(){return this.displayedComponent}},{key:"properties$2",get:function(){return this.controlProperties}}])&&g(r.prototype,m),f&&g(r,f),i}(r.MenuLauncher);Object(i.a)(f,"FlyoutAnchor",r.MenuLauncher,[88])},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(0),r=n(2),a=n(32),o=n(49),s=n(3);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(){function e(){this._isCookieComplianceEnabled=!!window.WacCookieCompliance,this._eventSource=new o.a,this.add_onConsentReceived(Object(r.d)(this,this.logConsentReceived,"logConsentReceived"))}var t,i,c,u=e.prototype;return u.add_onConsentReceived=function(e){this._eventSource.addHandler("ConsentReceived",e)},u.remove_onConsentReceived=function(e){this._eventSource.removeHandler("ConsentReceived",e)},u.ensureF6BindingIfNeeded=function(){var e=n(31).AFrame,t=n(131).F6Manager;if(this.isConsentNeeded){var i=n(24).FocusManager.instance().getScope(n(31).AFrame.cookieConsentBannerFocusId);i.parent=e.mainAppFocusId,i.addSetFocus((function(e,t){var n=document.getElementById("msccLearnMore");n&&n.focus()})),t.instance.addF6(e.cookieConsentBannerFocusId)}},u.requestConsentWithSettings=function(e){this._isCookieComplianceEnabled&&(WacCookieCompliance.requestConsentWithSettings(e()),this.add_onConsentReceived((function(){var e=n(131).F6Manager,t=n(31).AFrame;e.instance.deactivateFocus(t.cookieConsentBannerFocusId)})),this.logConsentRequested())},u.checkConsentWithSettings=function(e){return!(!this.isConsentNeeded||!WacCookieCompliance.checkConsentWithSettings(e()))&&(this._eventSource.raiseEvent("ConsentReceived"),!0)},u.setAllowConsent=function(e){this._isCookieComplianceEnabled&&WacCookieCompliance.setAllowConsent(e)},u.consentGiven=function(){this.isConsentNeeded&&(WacCookieCompliance.consentGiven(),this._eventSource.raiseEvent("ConsentReceived"))},u.logConsentRequested=function(){var e=n(1).AFrameworkApplication;s.ULS.sendTraceTag(24686626,221,50,"CookieBarVisible:{0}",e.isCookieBannerVisible),e.dataPlumber.CookieComplianceBanner|=a.a.cookieComplianceBanner_Shown},u.logConsentReceived=function(){var e=n(1).AFrameworkApplication;s.ULS.sendTraceTag(24686627,221,50,"Received Consent"),e.dataPlumber.CookieComplianceBanner|=a.a.cookieComplianceBanner_ConsentedReceived},t=e,c=[{key:"instance",get:function(){return e._instance||(e._instance=new e)}}],(i=[{key:"isConsentNeeded",get:function(){var e=n(1).AFrameworkApplication;return this._isCookieComplianceEnabled&&e.isCookieBannerVisible}},{key:"isCookieComplianceEnabled",get:function(){return this._isCookieComplianceEnabled}}])&&l(t.prototype,i),c&&l(t,c),e}();c._instance=null,Object(i.a)(c,"WacCookieComplianceWrapper",null,[49])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(261);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,r,o;function s(){var t;return(t=e.call(this)||this).MenuItemId=null,t.QueryCommand=null,t.CommandPreviewId=null,t.CommandRevertId=null,t.CommandValueId=null,t.DisplayMode=null,t.Description=null,t.ImageBackColor=null,t.LabelTextUserGeneratedPlaceholderReplacements=null,t.MenuItemsStatefulData=null,t.Visible=!1,t.AriaDescription=null,t.RoleInMenu=null,t}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,(r=[{key:"ControlType",get:function(){return 1}}])&&a(i.prototype,r),o&&a(i,o),s}(r.a);Object(i.a)(o,"CuiButtonProps",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.topRowLeft="QATRowLeft",r.topRowCenter="QATRowCenter",r.topRowRight="QATRowRight",r.bottomRowLeft="TabRowLeft",r.bottomRowCenter="TabRowInline",r.bottomRowRight="TabRowRight",Object(i.a)(r,"RibbonPeripheralSection",null,[])},function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")()}).call(this,n(435))},function(e,t,n){var i=n(120),r=n(368),a=n(139),o=n(298),s=n(374),l=n(407),c=r("wks"),u=i.Symbol,d=l?u:u&&u.withoutSetter||o;e.exports=function(e){return a(c,e)||(s&&a(u,e)?c[e]=u[e]:c[e]=d("Symbol."+e)),c[e]}},function(e,t,n){"use strict";var i=n(0),r=(n(9),n(13)),a=function(e,t){return e<<t|e>>>32-t},o=function(e){var t,n,i=new Sys.StringBuilder;for(t=7;t>=0;t--)n=e>>>4*t&15,i.append(n.toString(16));return i.toString()},s=function(e){var t,n,i,s,l,c,u,d,p=1732584193,h=4023233417,m=2562383102,g=271733878,f=3285377520,v=0,_=new Array(80),y=(e=function(e){e=e.replace("\r\n","\n");for(var t="",n=0;n<e.length;n++){var i=r.a.charCodeAt(e,n);i<128?t+=r.a.fromCharCode(i):i>127&&i<2048?(t+=r.a.fromCharCode(i>>6|192),t+=r.a.fromCharCode(63&i|128)):(t+=r.a.fromCharCode(i>>12|224),t+=r.a.fromCharCode(i>>6&63|128),t+=r.a.fromCharCode(63&i|128))}return t}(e)).length,b=[];for(t=0;t<y-3;t+=4)n=r.a.charCodeAt(e,t)<<24|r.a.charCodeAt(e,t+1)<<16|r.a.charCodeAt(e,t+2)<<8|r.a.charCodeAt(e,t+3),Array.add(b,n);switch(y%4){case 0:v=2147483648;break;case 1:v=r.a.charCodeAt(e,y-1)<<24|8388608;break;case 2:v=r.a.charCodeAt(e,y-2)<<24|r.a.charCodeAt(e,y-1)<<16|32768;break;case 3:v=r.a.charCodeAt(e,y-3)<<24|r.a.charCodeAt(e,y-2)<<16|r.a.charCodeAt(e,y-1)<<8|128}for(Array.add(b,v);b.length%16!=14;)Array.add(b,0);for(Array.add(b,y>>29),Array.add(b,y<<3&4294967295),i=0;i<b.length;i+=16){for(t=0;t<16;t++)_[t]=b[i+t];for(t=16;t<=79;t++)_[t]=a(_[t-3]^_[t-8]^_[t-14]^_[t-16],1);for(s=p,l=h,c=m,u=g,d=f,t=0;t<=19;t++)v=a(s,5)+(l&c|~l&u)+d+_[t]+1518500249&4294967295,d=u,u=c,c=a(l,30),l=s,s=v;for(t=20;t<=39;t++)v=a(s,5)+(l^c^u)+d+_[t]+1859775393&4294967295,d=u,u=c,c=a(l,30),l=s,s=v;for(t=40;t<=59;t++)v=a(s,5)+(l&c|l&u|c&u)+d+_[t]+2400959708&4294967295,d=u,u=c,c=a(l,30),l=s,s=v;for(t=60;t<=79;t++)v=a(s,5)+(l^c^u)+d+_[t]+3395469782&4294967295,d=u,u=c,c=a(l,30),l=s,s=v;p=p+s&4294967295,h=h+l&4294967295,m=m+c&4294967295,g=g+u&4294967295,f=f+d&4294967295}var S=o(p)+o(h)+o(m)+o(g)+o(f);return r.a.toLower(S)},l=n(3);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return u}));var u=function(){function e(t){this._uuid=e.isValid(t)?t:e.nil.toString()}var t,i,r,a=e.prototype;return a.toString=function(){return this._uuid},a.equals=function(e){return!!e&&this._uuid===e.toString()},e.createFromString=function(t){return t=e.normalizeUuidString(t),new e(t)},e.createV5Uuid=function(t){var n=s(e.nameSpace_URL+t),i=parseInt(n.substring(16,17),16);return i=3&i|8,new e(n=n.substring(0,8)+"-"+n.substring(8,12)+"-5"+n.substring(13,16)+"-"+["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"][i]+n.substring(17,20)+"-"+n.substring(20,32))},e.deriveFrom=function(t,n){var i=t._uuid.split("-"),r=n._uuid.split("-"),a=new Array(5);return a[0]=e.convertToHex(parseInt(i[0].substr(0,4),16)^parseInt(r[0].substr(0,4),16),4),a[0]+=e.convertToHex(parseInt(i[0].substr(4,4),16)^parseInt(r[0].substr(4,4),16),4),a[1]=e.convertToHex(parseInt(i[1],16)^parseInt(r[1],16),4),a[2]=e.convertToHex(parseInt(i[2],16)^parseInt(r[2],16),4),a[3]=e.convertToHex(parseInt(i[3],16)^parseInt(r[3],16),4),a[4]=e.convertToHex(parseInt(i[4].substr(0,4),16)^parseInt(r[4].substr(0,4),16),4),a[4]+=e.convertToHex(parseInt(i[4].substr(4,4),16)^parseInt(r[4].substr(4,4),16),4),a[4]+=e.convertToHex(parseInt(i[4].substr(8,4),16)^parseInt(r[4].substr(8,4),16),4),new e(a.join("-"))},e.create=function(){for(var t=new Sys.StringBuilder,n=0;n<4;n++){var i=Math.floor(4294967295*e.getRandomNumber());2===n&&(i=i%1073741824+2147483648),t.append(e.convertToHex(i,8))}var r=t.toString();return new e([r.substr(0,8),"-",r.substr(8,4),"-4",r.substr(12,3),"-",r.substr(16,4),"-",r.substr(20,12)].join(""))},e.getRandomNumber=function(){var t,i="";window.self.crypto&&window.self.crypto.getRandomValues?i="crypto":window.self.msCrypto&&window.self.msCrypto.getRandomValues&&(i="msCrypto");var r=n(1).AFrameworkApplication.appSettingsManager?n(1).AFrameworkApplication.appSettingsManager.getIntAppSetting("MaxRandomUuidIterations",1e5):1e5,a=0;do{if(a>r)throw Error.create("max random number generation iterations exceeded");if(""!==i)try{t=window.self[i].getRandomValues(new Uint32Array(1))[0]/4294967295}catch(n){e._errorLoggedInSession||(l.ULS.sendTraceTag(51447265,306,10,"crypto failed. fallback to random. exception: {0}",n),e._errorLoggedInSession=!0),i="",t=1}else t=Math.random();a++}while(1===t);return t},e.convertToHex=function(e,t){for(var n=e.toString(16);n.length<t;)n="0"+n;return n},e.compare=function(e,t){return e.toString()===t.toString()},e.isValid=function(e){try{return 36===e.length&&5===e.split("-").length}catch(e){return!1}},e.normalizeUuidString=function(e){return e.replace(" ","").replace("{","").replace("}","").toLowerCase()},t=e,r=[{key:"nameSpace_DNS",get:function(){return"6ba7b810-9dad-11d1-80b4-00c04fd430c8"}},{key:"nameSpace_URL",get:function(){return"6ba7b811-9dad-11d1-80b4-00c04fd430c8"}},{key:"nameSpace_OID",get:function(){return"6ba7b812-9dad-11d1-80b4-00c04fd430c8"}},{key:"nameSpace_X500",get:function(){return"6ba7b814-9dad-11d1-80b4-00c04fd430c8"}},{key:"nil",get:function(){return e._nilInstance||(e._nilInstance=new e("00000000-0000-0000-0000-000000000000"))}}],(i=null)&&c(t.prototype,i),r&&c(t,r),e}();u.uuidTotalCount=void 0,u._nilInstance=null,u._errorLoggedInSession=!1,Object(i.a)(u,"Uuid",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"Jewel",(function(){return f}));var i=n(0),r=n(2),a=n(166),o=(n(9),n(16)),s=n(64),l=n(286),c=n(346),u=n(348),d=n(5),p=n(6),h=n(3),m=n(51);function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(e){var t,i;function a(t,n){var i;return(i=e.call(this,t,n)||this)._mainJewelMenuAlreadyCreated=!1,i._flyoutHeight=0,i._isNoIFrameApp=!1,i._appContainer=null,i.jewelMenuLauncher=null,i}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var f,v,_,y=a.prototype;return y.refreshInternal=function(){e.prototype.refreshInternal.call(this),d.c(this.elementInternal)&&this.ensureDOMElement(),this.elementInternal=p.a.removeChildNodes(this.elementInternal),this.appendChildrenToElement(this.elementInternal),this.dirty=!1},y.ensureCorrectChildType=function(e){var t=n(311).JewelMenuLauncher;if(!Object(r.c)(s.a,e))throw Error.create('The child "'+e.id+'" is not a ControlComponent');if(!Object(r.c)(t,e.control))throw Error.create("Only children of type JewelMenuLauncher can be added to a Jewel")},y.configurePropertiesForNoIFrameApp=function(e,t){this._isNoIFrameApp=!0,this._flyoutHeight=e,this._appContainer=t},y.createMenu=function(e,t,n,i,r,a){return void 0===r&&(r=!1),void 0===a&&(a=1),this._mainJewelMenuAlreadyCreated?new c.a(this,e,t,n,i,this.rootManager):(this._mainJewelMenuAlreadyCreated=!0,new l.a(this,e,t,n,i,this.rootManager))},y.setFlyoutCoordinates=function(e,t,n,i){if(d.c(e)||d.c(t))return null;var r=0,a=0,s=0,l=!this.root.textDirection,c=1===n;if(e.style.maxHeight="none",e.style.overflowY="auto",this._isNoIFrameApp){var p=o.a.getElementBounds(this._appContainer);e.style.bottom="",e.style.overflowY="auto",e.style.top=p.y-1+"px",s=this.root.textDirection?window.document.body.offsetWidth-(p.x+p.width):p.x-1}if(c){var h=this.menuLauncherStack[0].menu.elementInternal.offsetWidth;l?r=h+s:a=h+s}else l?r=0+s:a=0+s;if(this._isNoIFrameApp){var m=window.document.body.offsetHeight-2;m>this._flyoutHeight&&(m=this._flyoutHeight),e.style.height=m+"px"}var g=(l?r:a)+"px";return l?(e.style.left=g,e.style.right="auto"):(e.style.right=g,e.style.left="auto"),this.menuStackDepth&&(e.style.maxWidth="600px",e.style.width="calc(100% - "+g+")"),new u.a},y.launchSubMenu=function(e,t){var i,a=n(74).MenuLauncher,o=n(311).JewelMenuLauncher,s=t||this.jewelProperties.DefaultSelection,l=null;if(s&&(l=this.controls[s]),!l){s=null;var c=this.controls;for(var u in c){var d={key:u,value:c[u]};if(Object(r.c)(a,d.value)&&!Object(r.c)(o,d.value)){var m=d.value,g=m.controlProperties;if(m.enabled&&(p.a.isTrue(g.PopulateDynamically)||m.menu.hasItems())){s=m.id;break}0}}if(!s)return;l=this.controls[s]}l?l.launchMenu(e):h.ULS.sendTraceTag(4329748,202,10,"Tried to launch invalid submenu with non-null ID {0}",((i={}).ControlID=s,i))},y.focus=function(){this.jewelMenuLauncher.setFocusOnControl()},f=a,(v=[{key:"jewelProperties",get:function(){return this.properties}},{key:"cssClass",get:function(){return"cui-jewel "+Object(m.a)(a.prototype,this,"cssClass")}},{key:"rootType",get:function(){return 4}},{key:"visibleInDOM",get:function(){return!0},set:function(e){Object(m.b)(a.prototype,this,"visibleInDOM",e)}},{key:"jewelBuilder",get:function(){return this.builder},set:function(e){this.builder=e}}])&&g(f.prototype,v),_&&g(f,_),a}(a.a);Object(i.a)(f,"Jewel",a.a,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(1),o=(n(9),n(62)),s=n(108),l=n(39),c=n(3),u=function(){this.maxRetryAttempts=22,this.retryIntervalInMSecs=1e3,this.retryIntervalLongInMSecs=2e4,this.retryTimeoutInMSecs=18e4};Object(i.a)(u,"Config",null,[]),n.d(t,"a",(function(){return d}));var d=function(){function e(e){this._callback=null,this._url=null,this._retryCountForHttp200=0,this._retryCountForServiceBusy=0,this._useAdvancedRetryLogic=!1,this.pageStats="",this._notificationBar=e}var t=e.prototype;return t.send=function(e,t,n){this._url=e,this._callback=t,this._useAdvancedRetryLogic=n,this.makeRequest(null)},t.makeRequest=function(e){a.AFrameworkApplication.theClientRequestManager.addRequest(this._url,1,null,null,!0,2,Object(r.d)(this,this.onRequestSucceeded,"onRequestSucceeded"),Object(r.d)(this,this.onRequestFailed,"onRequestFailed"),null,void 0,void 0,void 0,void 0,"16")},t.onRequestSucceeded=function(t){this.resetFailedRequestRetryLoop();var n=t.data.responseXml,i=null;if(n){if(e.isValidResponseXMLDoc(n)||(n=Sys.Net.XMLDOM(t.data.responseData,!0)),"undefined"==typeof n.selectSingleNode){var r=t.data.responseData||"[null]";return r.length>800&&(r=r.substring(0,400)+"[...]"+r.substring(r.length-400,r.length)),c.ULS.sendTraceTag(39387396,301,10,'Invalid docdata.xml retrieved.  Contents: "{0}"',r),void this.giveUp(t.data)}i=n.selectSingleNode("/docdata/status")}if(a.AFrameworkApplication.collectPageStats&&t.data.responseHeaders[o.PageStats.pageStatsResponseXHRHeader]&&(this.pageStats+=t.data.responseHeaders[o.PageStats.pageStatsResponseXHRHeader].toString()),!!i&&("InProgress"===i.text&&this._retryCountForHttp200++<e._config.maxRetryAttempts||"ServiceBusy"===i.text&&this._retryCountForServiceBusy++<3))c.ULS.sendTraceTag(39387397,301,50,"Re-requesting; Status: {0}; Retry Count: {1}; Url: {2}",i.text,this._retryCountForHttp200+this._retryCountForServiceBusy,this._url),this.retryRequest(e._config.retryIntervalInMSecs*(this._retryCountForHttp200+this._retryCountForServiceBusy));else{var s=i?i.text:null;c.ULS.sendTraceTag(39387398,301,50,"Request Complete. Result: {0}; Url: {1}",s,this._url),a.AFrameworkApplication.collectPageStats&&""!==this.pageStats&&(t.data.responseHeaders[o.PageStats.pageStatsResponseXHRHeader]=this.pageStats,this.pageStats=""),this._callback(!0,s,t.data)}},t.onRequestFailed=function(t){if(this._useAdvancedRetryLogic)if(e._retryLoopUnderway||(e._lastFailedRequestStamp=new Date,e._retryLoopUnderway=!0,e._retryCountFailure=1),(new Date).getTime()-e._lastFailedRequestStamp.getTime()<e._config.retryTimeoutInMSecs){var n=e._retryCountFailure>=4?e._config.retryIntervalLongInMSecs:e._config.retryIntervalInMSecs;this.retryOnFailure(n),4===e._retryCountFailure&&(e._notificationItem=this._notificationBar.createEntry(CommonUIStrings.l_NetworkProblemToast,!0),this._notificationBar.addEntry(e._notificationItem))}else this.giveUp(t.data);else e._retryCountFailure<4?this.retryOnFailure(2*e._config.retryIntervalInMSecs):this.giveUp(t.data)},t.retryRequest=function(e){var t=new l.a(2,1,e,Object(r.d)(this,this.makeRequest,"makeRequest"),94);a.AFrameworkApplication.theTaskManager.addTask(t)},t.retryOnFailure=function(t){this.retryRequest(t),e._retryCountFailure++},t.giveUp=function(e){this._callback(!1,null,e)},t.resetFailedRequestRetryLoop=function(){if(e._retryLoopUnderway=!1,e._retryCountFailure=0,e._notificationItem){this._notificationBar.removeEntry(e._notificationItem),e._notificationItem=null;var t=this._notificationBar.createEntry(CommonUIStrings.l_NetworkRestoredToast,!1);t.image=3,this._notificationBar.addEntry(t)}},e.doRequest=function(t,n,i){return!(s.a.instance.checkAndTriggerSessionHasExpired()&&a.AFrameworkApplication.activeFrame&&a.AFrameworkApplication.activeFrame.holdRequestsWhenSessionHasExpired)&&(new e(i).send(t,n,!1),!0)},e.doRequestWithNetworkFailureNotification=function(t,n,i){new e(i).send(t,n,!0)},e.isValidResponseXMLDoc=function(e){return!!e&&"undefined"!=typeof e.selectSingleNode},e}();d._lastFailedRequestStamp=null,d._retryLoopUnderway=!1,d._retryCountFailure=0,d._notificationItem=null,d._config=new u,Object(i.a)(d,"ClientRequestWithRetry",null,[])},function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return g}));var i=n(151),r=n(107),a=n(136),o=n(29),s=n(16),l=n(10),c=function(e,t,n){var r=s.a.getOpacity(e)/100;o.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var a=new i.a(e);a.animateOpacity(r,0),o.WacAirSpace.animate(a,t,n)},u=function(e){o.WacAirSpace.setAnimationClass(e,"Shared_QuickClass");var t=new a.a(e);t.animateOpacity(0,1),o.WacAirSpace.animate(t,null,null);var n=new r.a(e);n.animateY(e.clientTop-30,e.clientTop),o.WacAirSpace.animate(n,null,null)},d=function(e,t,n){var r=new i.a(e);r.animateOpacity(1,0),o.WacAirSpace.animate(r,t,n)},p=function(e,t,n){t&&t.length>0&&h(t),o.WacAirSpace.setAnimationClass(e,"Shared_QuickClass");var i=new a.a(e);i.animateOpacity(0,1),o.WacAirSpace.animate(i,null,n)},h=function(e){for(var t=0;t<e.length;t++)s.a.setOpacity(e[t],0)},m=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.style.position="relative",o.WacAirSpace.setAnimationClass(i,"Shared_QuickClass");var c=new a.a(i);if(c.animateOpacity(s.a.getOpacity(i)/100,1),o.WacAirSpace.animate(c,null,null),!l.a.isFirefox){var u=new r.a(i);u.animateY(-100,0),o.WacAirSpace.animate(u,null,null)}}},g=function(e,t){l.a.isInternetExplorer8&&o.WacAirSpace.temporarilyDisableAnimation(1e3);var n=o.WacAirSpace.cloneElement(e,!1,!0),r=n.children[0];n.style.zIndex=String(t),o.WacAirSpace.setAnimationClass(r,"Shared_QuickClass"),o.WacAirSpace.setAnimationClass(n,"Shared_BasicClass");var a=new i.a(n);a.animateOpacity(s.a.getOpacity(n)/100,0),o.WacAirSpace.animate(a,null,f);var c=new i.a(r);c.animateOpacity(s.a.getOpacity(r)/100,0),o.WacAirSpace.animate(c,null,null)},f=function(e){var t=e.element;t.parentNode&&t.parentNode.removeChild(t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.measurementTag="o",r.machineAttr="m",r.titleAttr="n",r.timeStampeAttr="ts",r.beginTimeAttr="t",r.spendTimeAttr="d",r.errorTag="Error",r.indent="  ",r.correlation="c",r.sessionId="sid",r.fileRep="f",Object(i.a)(r,"PageStatsXmlName",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.meControlFlexPaneFocusId="ReactSharedHeaderMeControlFlexPane",r.headerUiFocusId="headerui",r.chatFocusId="chat_wrapper_pane",Object(i.a)(r,"ReactSharedHeaderConstants",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.Value="value",r.MaxValue="MaxValue",r.Text="Text",Object(i.a)(r,"SliderCommandProperties",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"ADebugOptionsTab",(function(){return a}));var i=n(0),r=n(154);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._panel=null,t._contentDiv=null,t._optionElements=void 0,t._optionClickHandler=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"ADebugOptionsTab",r.a,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(255),o=n(58);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(e){var t,n,i,r,a;function o(){return e.call(this)||this}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.display=function(e){o._displayCount||o.instance.showInformation(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_DialogLoading,e),o._displayCount++},o.stopDisplay=function(){o._displayCount--,o._displayCount||(o.instance.hide(),o.instance.dispose(),o._instance=null)},i=o,a=[{key:"instance",get:function(){return o._instance||(o._instance=new o,o._instance.buttonsOption=6,o._instance.setDefaultButton(0)),o._instance}}],(r=null)&&s(i.prototype,r),a&&s(i,a),o}(o.StandardDialog);l._instance=null,l._displayCount=0,Object(i.a)(l,"LoadingDialog",o.StandardDialog,[]);var c=n(27),u=n(8),d=n(63);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return h}));var h=function(e){var t,i;function a(t,n,i,r,a,o,s,l,c,u,d,p,h,m,g,f){var v;return void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===h&&(h=null),void 0===m&&(m=!0),void 0===g&&(g=!1),void 0===f&&(f=null),(v=e.call(this,t,n,i,h,g)||this)._loadingDialogNeeded=!1,v._loadValidationDelegate=r,v._actionId=a,v._context=o,v._behavior=s,v._reportingData=l,v._actionData=c,v._actionHandler=u,v._ignoreCrossOriginResourceSharing=d,v._defer=p,v._async=m,v._sriHash=f,v}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var o,s,h,m=a.prototype;return m.createElement=function(){return this.createElementWithLocation(this.resourceUrl)},m.reloadReference=function(){this.removeEventHandlers();var e=this.element.parentNode;e.removeChild(this.element),this.element=this.createElementWithLocation(c.a.addOrReplaceParameterValue(this.resourceUrl,"retries",this.retryBehavior.failures.toString())),this.addEventHandlers(),e.appendChild(this.element)},m.createHighPriorityResourceElement=function(){var e=n(1).AFrameworkApplication,t=document.createElement("link");return t.setAttribute("as","script"),t.setAttribute("rel","preload"),e.useCrossOriginStaticScripts&&!this._ignoreCrossOriginResourceSharing&&t.setAttribute("crossorigin","anonymous"),t.setAttribute("href",this.resourceUrl),t},m.createElementWithLocation=function(e){var t=n(1).AFrameworkApplication,i=document.createElement("script");return i.setAttribute("type","text/javascript"),t.useCrossOriginStaticScripts&&!this._ignoreCrossOriginResourceSharing&&(i.setAttribute("crossorigin","anonymous"),this._sriHash&&i.setAttribute("integrity",String.format("sha256-{0}",this._sriHash))),this._defer&&i.setAttribute("defer",""),this._async||(i.async=!1),i.setAttribute("src",e),this._actionId&&window.setTimeout(Object(r.d)(this,this.onLoadTimer,"onLoadTimer"),500),i},m.finishedLoadingResource=function(t){var i=n(1).AFrameworkApplication,r=t&&this._loadValidationDelegate?this._loadValidationDelegate():t;e.prototype.finishedLoadingResource.call(this,r),r&&(this._loadingDialogNeeded&&(l.stopDisplay(),this._loadingDialogNeeded=!1,i.theActionManager.processAction(u.a.onDemandLoadingDialogCompleted,2)),this._actionId&&this._actionHandler&&this._actionHandler(this._actionId,this._context,this._behavior,this._reportingData,this._actionData)),this._actionId=0},m.onLoadTimer=function(){2!==this.status&&(this._loadingDialogNeeded||(l.display(Object(r.d)(this,this.loadingDialogHandler,"loadingDialogHandler")),this._loadingDialogNeeded=!0))},m.loadingDialogHandler=function(e,t){var i=n(1).AFrameworkApplication;this._actionId=0,this._loadingDialogNeeded&&(this._loadingDialogNeeded=!1,l.stopDisplay(),i.theActionManager.processAction(u.a.onDemandLoadingDialogCancelled,2))},m.promote=function(e,t,n,i,a,o){!this._actionId&&e&&(this._actionId=e,this._context=t,this._behavior=n,this._reportingData=i,this._actionData=a,this._actionHandler=o,window.setTimeout(Object(r.d)(this,this.onLoadTimer,"onLoadTimer"),500))},a.get_scriptResourceWithActions=function(){return a.scriptResourceWithActions},a.create=function(e,t,n,i,r,o,s,l,c,u){void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=null),void 0===l&&(l=!0),void 0===c&&(c=!1),void 0===u&&(u=null);var p=new a(e,t,n,i,0,null,1,null,null,null,r,o,s,l,c,u);return a.get_scriptResourceWithActions()||(a.scriptResourceWithActions=new d.a),a.get_scriptResourceWithActions().add(p),p},o=a,(s=[{key:"loadValidationDelegate",get:function(){return this._loadValidationDelegate}},{key:"couldGenerateLayout",get:function(){return!1}}])&&p(o.prototype,s),h&&p(o,h),a}(a.a);h.scriptResourceWithActions=null,Object(i.a)(h,"ScriptResourceWithAction",a.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"F6Manager",(function(){return h}));var i=n(0),r=n(20),a=n(25),o=n(1),s=(n(9),n(54),n(24)),l=n(69),c=n(26),u=n(8),d=n(3);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(){function e(e){this._f6KeyInput=r.KeyInputManager.hashKey(a.a.VK_F6,0),this._f6ShiftKeyInput=r.KeyInputManager.hashKey(a.a.VK_F6,4),this._activeFocuses=null,this._f6Scopes={},this._navOrderList=null,this._priorityOrderList=null,this._activeList=null,this._onBeforeF6forScope={},this._onPostF6forScope={},this._focusManager=e}var t,n,i,h=e.prototype;return h.initializeOrder=function(e){this._navOrderList=e;for(var t=[],n=0;n<e.length;n++)Array.add(t,!1);this._activeList=t,this._activeFocuses=[]},h.initializePriorityOrder=function(e){this._priorityOrderList=e},h.getHighestPriority=function(){var e=null,t=0;if(this._priorityOrderList||(this._priorityOrderList=this._navOrderList),!this._priorityOrderList)return null;for(;!e&&t<this._priorityOrderList.length;){var n=this._priorityOrderList[t],i=Array.indexOf(this._navOrderList,n);i>=0&&this._activeList[i]&&(e=n),t++}return e},h.activateFocus=function(e){if(this._navOrderList&&Array.contains(this._navOrderList,e)){var t=Array.indexOf(this._navOrderList,e);this._activeList[t]||(this._activeList[t]=!0,this.updateActiveFocuses())}else 0},h.deactivateFocus=function(e){if(this._navOrderList&&Array.contains(this._navOrderList,e)){var t=Array.indexOf(this._navOrderList,e);this._activeList[t]&&(this._activeList[t]=!1,this.updateActiveFocuses())}else 0},h.isFocusScopeActive=function(e){return Array.contains(this._activeFocuses,e)},h.updateActiveFocuses=function(){for(var e=[],t=0;t<this._activeList.length;t++)this._activeList[t]&&Array.add(e,this._navOrderList[t]);this._activeFocuses=e},h.handleF6=function(e,t,n,i,r){return this.handleF6WithDirection(!0)},h.handleF6Shift=function(e,t,n,i,r){return this.handleF6WithDirection(!1)},h.resumeFocusWithDirection=function(e,t,n,i,r){var a="forward";r?a=r.toLowerCase():d.ULS.sendTraceTag(41502554,321,15,"Didn't find direction in message values");var o=0;return"backward"===a?o=this._activeFocuses.length-1:"forward"===a?o=0:d.ULS.sendTraceTag(41302162,321,15,"Received unknown direction to resume focus: "+a),s.FocusManager.instance().setScopeFromTop(this._activeFocuses[o]),32},h.handleF6WithDirection=function(e){l.a.mark(4696);var t=this.getCurrentIndex();if(-1===t)return 2;var n=this._onBeforeF6forScope[this._activeFocuses[t]];if(n&&n(e),this.setFocusableScope(t,e),-1!==(t=this.getCurrentIndex())){var i=this._onPostF6forScope[this._activeFocuses[t]];i&&i()}return l.a.mark(4697),32},h.handleTabFromBottom=function(){var e=this.getCurrentIndex();return-1!==e&&(--e<0&&(e=this._activeFocuses.length-1),this._focusManager.setScopeFromBottom(this._activeFocuses[e]))},h.setFocusableScope=function(e,t){var n,i=e,r=t?1:-1,a=o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsUIEmbedMode")&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportsAccessibilityLoop");do{if(n=null,(e+=r)>=this._activeFocuses.length){if(a){this.blurFocusAndSendMessage(!0);break}e=0}else if(e<0){if(a){this.blurFocusAndSendMessage(!1);break}e=this._activeFocuses.length-1}this._focusManager.setScopeFromTop(this._activeFocuses[e]);var s=this._focusManager.getCurrentRegion();s&&(n=s.listing)}while(n&&!n.firstElement&&e!==i)},h.blurFocusAndSendMessage=function(e){var t=e?"forward":"backward";this._focusManager.pushScope(o.AFrameworkApplication.postmessageFocusId,!1),o.AFrameworkApplication.get_hostPostmessengerFuture().execute((function(e){var n;e.sendMessage(c.a.accessibilityLoopComplete,((n={}).Direction=t,n))}))},h.getCurrentIndex=function(){var e=this._focusManager.currentScope.name;return e&&Array.contains(this._activeFocuses,e)||(e=this._focusManager.currentScope.containerScope)&&Array.contains(this._activeFocuses,e)?Array.indexOf(this._activeFocuses,e):-1},h.hasFocus=function(){return-1!==this.getCurrentIndex()},h.addF6KeyBindings=function(e){var t=this._focusManager.getScope(e);t.bindAction(this.f6KeyInput,u.a.F6),t.bindAction(this.f6ShiftKeyInput,u.a.f6shift),this._f6Scopes[e]=t},h.hasF6KeyBindings=function(e){return e in this._f6Scopes},h.addF6=function(e,t,n){var i=this;void 0===t&&(t=!0),void 0===n&&(n=!1),this.activateFocus(e),n&&this.reorderScopeAfterCurrent(e),this._focusManager.getScope(e).addDispose((function(){i.deactivateFocus(e)})),t&&this.addF6KeyBindings(e)},h.reorderScopeAfterCurrent=function(e){if(this._navOrderList){var t=Array.indexOf(this._navOrderList,e);if(t>=0&&this._activeList[t]){var n=this.getCurrentIndex();if(-1!==n&&n>=0){var i=Array.indexOf(this._navOrderList,this._activeFocuses[n]);if(i>=0&&i!==t){Array.insert(this._navOrderList,i+1,e),Array.insert(this._activeList,i+1,!0);var r=t>i?t+1:t;Array.removeAt(this._navOrderList,r),Array.removeAt(this._activeList,r),this.updateActiveFocuses()}}}}},h.setOnBeforeF6=function(e,t){this._onBeforeF6forScope[e]=t},h.setOnPostF6=function(e,t){this._onPostF6forScope[e]=t},h.bindFocusToBrowser=function(e){var t=this._focusManager.getScope(e);t.bindAction(r.KeyInputManager.hashKey(a.a.VK_D,1),u.a.focusToBrowser),t.bindAction(r.KeyInputManager.hashKey(a.a.VK_F6,0),u.a.focusToBrowser),t.bindAction(r.KeyInputManager.hashKey(a.a.VK_F6,4),u.a.focusToBrowser)},e.usable=function(){return!!o.AFrameworkApplication.activeFrame&&!!o.AFrameworkApplication.activeFrame.theFocusManager&&!!o.AFrameworkApplication.activeFrame.theF6Manager&&e.enabled},t=e,i=[{key:"instance",get:function(){return e._instance||(e._instance=new e(s.FocusManager.instance())),e._instance}}],(n=[{key:"f6KeyInput",get:function(){return this._f6KeyInput},set:function(e){this._f6KeyInput=e}},{key:"f6ShiftKeyInput",get:function(){return this._f6ShiftKeyInput},set:function(e){this._f6ShiftKeyInput=e}}])&&p(t.prototype,n),i&&p(t,i),e}();h.enabled=!1,h._instance=null,Object(i.a)(h,"F6Manager",null,[72])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=(n(9),n(52)),a=n(10);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(e,t){this._finalOpacity=Number.NaN,this._finalX=Number.NaN,this._finalY=Number.NaN,this._finalHeight=Number.NaN,this._finalWidth=Number.NaN,this._finalScrollTop=Number.NaN,this._finalScrollLeft=Number.NaN,this._finalRotateZ=Number.NaN,this._useRelativePositioning=!1,this._isXConstant=!1,this._useRightAttributeForX=!1,this._isYConstant=!1,this._isHeightConstant=!1,this._isWidthConstant=!1,this.isOpacityConstant=!1,this._isScrollTopConstant=!1,this._isScrollLeftConstant=!1,this._isRotateZConstant=!1,this.type=e,this.element=t,"relative"===this.element.style.position&&(this._useRelativePositioning=!0)}var t,n,i,s=e.prototype;return s.set_finalX=function(e){return this._finalX=e,e},s.animateX=function(e,t,n){this._useRightAttributeForX=n,e!==t?(this._isXConstant=!1,this.setInitialX(e,n),this.set_finalX(t)):this.maintainConstantX(e,n)},s.maintainConstantX=function(e,t){this._isXConstant=!0,this.setInitialX(e,t),this.set_finalX(e)},s.setInitialX=function(e,t){t?this._useRelativePositioning?this.element.style.marginRight=e+"px":this.element.style.right=e+"px":this._useRelativePositioning?this.element.style.marginLeft=e+"px":this.element.style.left=e+"px"},s.animateXRight=function(e,t,n){this._useRightAttributeForX=!n,e!==t?(this._isXConstant=!1,this.setInitialXRight(e,n),this.set_finalX(t)):this.maintainConstantXRight(e,n)},s.maintainConstantXRight=function(e,t){this._isXConstant=!0,this.setInitialXRight(e,t),this.set_finalX(e)},s.setInitialXRight=function(e,t){t?this._useRelativePositioning?this.element.style.marginLeft=e+"px":this.element.style.left=e+"px":this._useRelativePositioning?this.element.style.marginRight=e+"px":this.element.style.right=e+"px"},s.set_finalY=function(e){return this._finalY=e,e},s.animateY=function(e,t){e!==t?(this._isYConstant=!1,this.setInitialY(e),this.set_finalY(t)):this.maintainConstantY(e)},s.maintainConstantY=function(e){this._isYConstant=!0,this.setInitialY(e),this.set_finalY(e)},s.setInitialY=function(e){this._useRelativePositioning?this.element.style.marginTop&&""!==this.element.style.marginTop&&this.element.style.marginTop===e+"px"||(this.element.style.marginTop=e+"px"):this.element.style.top&&""!==this.element.style.top&&this.element.style.top===e+"px"||(this.element.style.top=e+"px")},s.set_finalHeight=function(e){return this._finalHeight=e,e},s.animateHeight=function(e,t){e!==t?(this._isHeightConstant=!1,this.element.style.height&&""!==this.element.style.height&&this.element.style.height!==t+"px"||this.setInitialHeight(e),this.set_finalHeight(t)):this.maintainConstantHeight(e)},s.maintainConstantHeight=function(e){this._isHeightConstant=!0,this.setInitialHeight(e),this.set_finalHeight(e)},s.setInitialHeight=function(e){this.element.style.height=e+"px"},s.set_finalWidth=function(e){return this._finalWidth=e,e},s.animateWidth=function(e,t){e!==t?(this._isWidthConstant=!1,this.element.style.width&&""!==this.element.style.width&&this.element.style.width!==t+"px"||this.setInitialWidth(e),this.set_finalWidth(t)):this.maintainConstantWidth(e)},s.maintainConstantWidth=function(e){this._isWidthConstant=!0,this.setInitialWidth(e),this.set_finalWidth(e)},s.setInitialWidth=function(e){this.element.style.width=e+"px"},s.set_finalOpacity=function(e){return this._finalOpacity=e,e},s.animateOpacity=function(e,t){this.setInitialOpacity(e),this.set_finalOpacity(t)},s.setInitialOpacity=function(e){a.a.setOpacity(this.element,e)},s.set_finalScrollTop=function(e){return this._finalScrollTop=e,e},s.animateScrollTop=function(e,t){e!==t?(this._isScrollTopConstant=!1,this.element.scrollTop===t&&this.setInitialScrollTop(e),this.set_finalScrollTop(t)):this.maintainConstantScrollTop(e)},s.maintainConstantScrollTop=function(e){this._isScrollTopConstant=!0,this.setInitialScrollTop(e),this.set_finalScrollTop(e)},s.setInitialScrollTop=function(e){this.element.scrollTop=e},s.set_finalScrollLeft=function(e){return this._finalScrollLeft=e,e},s.animateScrollLeft=function(e,t){e!==t?(this._isScrollLeftConstant=!1,this.element.scrollLeft===t&&this.setInitialScrollLeft(e),this.set_finalScrollLeft(t)):this.maintainConstantScrollLeft(e)},s.maintainConstantScrollLeft=function(e){this._isScrollLeftConstant=!0,this.setInitialScrollLeft(e),this.set_finalScrollLeft(e)},s.setInitialScrollLeft=function(e){this.element.scrollLeft=e},s.set_finalRotateZ=function(e){return this._finalRotateZ=e,e},s.animateRotateZ=function(e,t){e!==t?(this._isRotateZConstant=!1,this.setInitialRotateZ(e),this.set_finalRotateZ(t)):this.maintainConstantRotateZ(e)},s.maintainConstantRotateZ=function(e){this._isRotateZConstant=!0,this.setInitialRotateZ(e),this.set_finalRotateZ(e)},s.setInitialRotateZ=function(e){r.CssUtils.setRotation(this.element,e)},t=e,(n=[{key:"useRelativePositioning",get:function(){return this._useRelativePositioning}},{key:"finalX",get:function(){return this._finalX}},{key:"isXConstant",get:function(){return this._isXConstant}},{key:"useRightAttributeForX",get:function(){return this._useRightAttributeForX}},{key:"finalY",get:function(){return this._finalY}},{key:"isYConstant",get:function(){return this._isYConstant}},{key:"finalHeight",get:function(){return this._finalHeight}},{key:"isHeightConstant",get:function(){return this._isHeightConstant}},{key:"finalWidth",get:function(){return this._finalWidth}},{key:"isWidthConstant",get:function(){return this._isWidthConstant}},{key:"finalOpacity",get:function(){return this._finalOpacity}},{key:"finalScrollTop",get:function(){return this._finalScrollTop}},{key:"isScrollTopConstant",get:function(){return this._isScrollTopConstant}},{key:"finalScrollLeft",get:function(){return this._finalScrollLeft}},{key:"isScrollLeftConstant",get:function(){return this._isScrollLeftConstant}},{key:"finalRotateZ",get:function(){return this._finalRotateZ}},{key:"isRotateZConstant",get:function(){return this._isRotateZConstant}}])&&o(t.prototype,n),i&&o(t,i),e}();Object(i.a)(s,"AAnimationEvent",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.wordIcon="WordIcon",r.fullScreenButton="fseaFullScreen",r.controlMenu="ControlMenu",r.controlMenuSectionOne="msControlMenu1",r.downloadACopyButton="DownloadACopy",r.printButton="PrintPDF",r.accessibleModeButton="AccessibleMode",r.controlMenuSectionTwo="msControlMenu2",r.documentInformationButton="DocumentInformation",r.controlMenuSectionThree="msControlMenu3",r.privacyButton="Privacy",r.termsOfUseButton="TermsOfUse",r.giveFeedbackButtonEmbed="msControlMenu.Controls.GiveFeedback",Object(i.a)(r,"Embed",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=(n(9),n(39)),o=n(255);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(e){var t,n;function i(t){return e.call(this,t)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,l=i.prototype;return l.createElement=function(){var e=document.createElement("img");return e.setAttribute("src",this.resourceUrl),e},l.createHighPriorityResourceElement=function(){return null},l.reloadReference=function(){this.element.setAttribute("src",""),this.element.setAttribute("src",this.resourceUrl)},r=i,(a=[{key:"couldGenerateLayout",get:function(){return!0}}])&&s(r.prototype,a),o&&s(r,o),i}(o.a);Object(i.a)(l,"ImageResource",o.a,[]);var c=n(130),u=n(35),d=n(8);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return h}));var h=function(){function e(){this._actionsToSlices={},this._queue=[],this._handlers=[],this._scriptsAdded={},this._statusListeners=[],this._paused=!1,this._downloadQueueTask=null,this._taskSet=!1;var t=n(1).AFrameworkApplication,i=n(1).AFrameworkApplication.theActionManager;i.addAction(d.a.onDemandLoadingDialogCompleted,u.a.frame,e.onDemandLoadDialogDismissed),i.addAction(d.a.onDemandLoadingDialogCancelled,u.a.frame,e.onDemandLoadDialogDismissed),t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("PreloadDll1IsEnabled")?this._downloadQueueTask=new a.a(1,2,10,Object(r.d)(this,this.downloadQueueTask,"downloadQueueTask"),20):this._downloadQueueTask=new a.a(3,2,100,Object(r.d)(this,this.downloadQueueTask,"downloadQueueTask"),20),this.ensureTaskSet()}var t,i,o,s=e.prototype;return s.addStatusCallback=function(e){Array.contains(this._statusListeners,e)||Array.add(this._statusListeners,e)},s.removeStatusCallback=function(e){Array.contains(this._statusListeners,e)&&Array.remove(this._statusListeners,e)},s.downloadQueueTask=function(e){var t=n(1).AFrameworkApplication;if(this.updateQueueStatus(String.format("Queue contains {0} elements",this._queue.length)),!this._paused){var i=Array.dequeue(this._queue);i&&(this.updateQueueStatus(String.format("Retrieving {0}",i.resourceUrl)),this.addScriptReference(i)),this._queue.length<=0&&this._taskSet&&(t.theTaskManager.deleteTask(this._downloadQueueTask),this._taskSet=!1)}},s.updateQueueStatus=function(e){for(var t=[],n=[];this._queue.length>0;){var i=Array.dequeue(this._queue);Array.enqueue(n,i),Array.add(t,i.resourceUrl)}this._queue=n;for(var r=0;r<this._statusListeners.length;r++){(0,this._statusListeners[r])(e,t)}},s.ensureTaskSet=function(){var e=n(1).AFrameworkApplication;this._taskSet||(e.theTaskManager.addTask(this._downloadQueueTask),this._taskSet=!0)},s.add=function(e,t,i,a){var o=n(1).AFrameworkApplication.theActionManager;i?o.addActionWithFlags(e,t,Object(r.d)(this,this.actionHandlerStub,"actionHandlerStub"),i):o.addAction(e,t,Object(r.d)(this,this.actionHandlerStub,"actionHandlerStub"));var s=e.toString()+t.toString();this._actionsToSlices[s]=a,Array.enqueue(this._queue,a),this.ensureTaskSet()},s.addImage=function(e){var t=new l(e);return Array.enqueue(this._queue,t),this.ensureTaskSet(),t},s.addResource=function(e){Array.enqueue(this._queue,e),this.downloadQueueTask(null),this._queue.length>0&&this.ensureTaskSet()},s.addHandler=function(e){Array.add(this._handlers,e)},s.addScriptReference=function(e){e.resourceUrl in this._scriptsAdded?e.TCS.setResult(!0):(e.loadResource(),this._scriptsAdded[e.resourceUrl]=e)},s.removeScriptReference=function(e){e in this._scriptsAdded&&delete this._scriptsAdded[e]},s.actionHandlerStub=function(e,t,n,i,a){if(this._handlers.length>0)for(var o=0;o<this._handlers.length;o++){var s=(0,this._handlers[o])(e,t,n,i,a);if(2!==s)return s}if(2===n){var l=e.toString()+t.contextId.toString(),u=this._actionsToSlices[l],d=u.resourceUrl,p=[];this._scriptsAdded[d]&&this._scriptsAdded[d].promote(e,t,n,i,a,Object(r.d)(this,this.actionHandlerStub,"actionHandlerStub"));var h,m=new c.a(d,u.dependencies,u.cdn,u.loadValidationDelegate,e,t,n,i,a,Object(r.d)(this,this.actionHandlerStub,"actionHandlerStub"));for(Array.enqueue(p,m);h=Array.dequeue(this._queue);)h.resourceUrl!==d&&Array.enqueue(p,h);return this._queue=p,this.downloadQueueTask(null),64}return 1===n?32:2},e.onDemandLoadDialogDismissed=function(e,t,n,i,r){return 32},e.enqueueActions=function(t,n){if(t&&n)for(var i=0;i<t.length;i++){var r=t[i];e.instance.add(r.actionId,r.contextId,r.flags,n)}},e.enqueueMultipleActions=function(t,i){var r=c.a.create(n(1).AFrameworkApplication.scriptUrlFromName(i,0));e.enqueueActions(t,r)},e.enqueueImage=function(t){return e.instance.addImage(t)},e.registerDispatchHandler=function(t){e.instance.addHandler(t)},e.enqueueWithoutEnabling=function(t,i,r,a,o,s,l){void 0===i&&(i=null),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===o&&(o=!1),void 0===s&&(s=null),void 0===l&&(l=!0);var u=n(1).AFrameworkApplication.scriptUrlFromName(t,r),d=n(1).AFrameworkApplication.sriHashFromName(t,r),p=c.a.create(u,null,null,null,a,o,s,l,!1,d);p.add_loadFinished((function(e,t){i&&i(e,t)})),e.instance.addResource(p)},e.enqueueResourceWithoutEnabling=function(t){t.isDownloading||t.loadFinishedTask.get_isCompleted()||e.instance.addResource(t)},e.removeReferenceForRetryDownload=function(t){e.instance.removeScriptReference(t)},t=e,o=[{key:"instance",get:function(){return e._instance||(e._instance=new e)}}],(i=null)&&p(t.prototype,i),o&&p(t,o),e}();h._instance=null,Object(i.a)(h,"DownloadQueue",null,[])},function(e,t,n){var i=n(172),r=n(139),a=n(420),o=n(147).f;e.exports=function(e){var t=i.Symbol||(i.Symbol={});r(t,e)||o(t,e,{value:a.f(e)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(132);var a=function(e){var t,n;function i(t){return e.call(this,6,t)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"ShowAnimationEvent",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.pageInfoLabel="PageInfoLabel",r.giveFeedbackButton="GiveFeedback",r.presenterPageLabel="PresenterPageLabel",r.buttonShowZoomDialog="buttonShowZoomDialog",r.zoomFlyout="ZoomFlyout",Object(i.a)(r,"Id",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(40),a=n(13);var o=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.wordViewerImage=function(e){return r.a.staticContentHost+i.wordViewerImageBase+a.a.escape(e)+r.a.removeBroltiFlightFromStaticContentQueryParameter(r.a.staticContentQueryParameter)},i.wordViewerCss=function(e){return r.a.staticContentHost+i.wordViewerCssBase+a.a.escape(e)+r.a.staticContentQueryParameter},i.wordViewerScriptLocalized=function(e){return i.wordViewerScriptsLcidBase+a.a.escape(e)+r.a.staticContentQueryParameter},i.wordViewerScript=function(e){return i.wordViewerScriptsBase+a.a.escape(e)+r.a.staticContentQueryParameter},i.ribbonImage=function(e){return r.a.staticContentHost+i.ribbonImageBase+a.a.escape(e)+r.a.removeBroltiFlightFromStaticContentQueryParameter(r.a.staticContentQueryParameter)},i.ribbonCss=function(e){return r.a.staticContentHost+i.ribbonCssBase+a.a.escape(e)+r.a.staticContentQueryParameter},i.ribbonScript=function(e){return i.ribbonScriptsBase+a.a.escape(e)+r.a.staticContentQueryParameter},i}(r.a);o.wordViewerImageBase=null,o.wordViewerCssBase=null,o.wordViewerScriptsBase=null,o.wordViewerScriptsLcidBase=null,o.ribbonImageBase=null,o.ribbonCssBase=null,o.ribbonScriptsBase=null,Object(i.a)(o,"Path",r.a,[])},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(17),o=n(41),s=(n(9),n(4)),l=n(10);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(e){var t,n,i,r,a;function u(t,n,i,r){var a;return(a=e.call(this,s.EventNames.contextMenu,n,t,r)||this)._clientPoint=i,a}return n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,u.create=function(e,t,n){var i,r;t.rawEvent;if(e===s.EventNames.touchContextMenu)i=3,r=o.EventHandlerArgs.getClientPointFromTouchEvent(t);else{0;var a=t.rawEvent;i=n,r=l.a.isMac||!a?new Sys.UI.Point(t.clientX,t.clientY):new Sys.UI.Point(a.clientX,a.clientY)}return new u(t,o.EventHandlerArgs.getSourceElement(t),r,i)},i=u,(r=[{key:"clientPoint",get:function(){return this._clientPoint}}])&&c(i.prototype,r),a&&c(i,a),u}(o.EventHandlerArgs);Object(i.a)(u,"ContextMenuEventArgs",o.EventHandlerArgs,[]);var d=n(182),p=n(48),h=n(28),m=n(327),g=n(57),f=n(60),v=n(50),_=n(21);function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return S}));var S=function(e){var t,i;function o(){var t;(t=e.call(this)||this)._dragInputManager=null,t._gestureInputManager=null,t._lastInputMethodHeard=0,t.isSuppressingMenus=!1;var i=n(1).AFrameworkApplication;return t._eventHandlerManager=p.EventHandlerManager.instance,h.a.instance.registerOnBeforeEventProcessed(s.EventNames.pointerDown,Object(r.d)(b(t),t.onPointerEventHeard,"onPointerEventHeard")),h.a.instance.registerOnBeforeEventProcessed(s.EventNames.pointerUp,Object(r.d)(b(t),t.onPointerEventHeard,"onPointerEventHeard")),p.EventHandlerManager.instance.registerOnBeforeEventProcessed(s.EventNames.keyDown,Object(r.d)(b(t),t.onKeyEventHeard,"onKeyEventHeard")),p.EventHandlerManager.instance.registerOnBeforeEventProcessed(s.EventNames.keyUp,Object(r.d)(b(t),t.onKeyEventHeard,"onKeyEventHeard")),t._cancelPointersOnContextMenu=!1,i.appSettingsManager&&(t._cancelPointersOnContextMenu=i.isMultiTouchGestureEnabled()&&i.appSettingsManager.getBooleanAppSetting("MultiTouchCancelPointersOnContextMenu")),t._cancelPointersOnContextMenu&&(t._dragInputManager=d.a.instance,t._gestureInputManager=_.a.instance.resolveFuture("Common.IGestureInputManager")),t}i=e,(t=o).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var l,c,S,C=o.prototype;return C.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeEventForElement(s.EventNames.contextMenu,t,2,Object(r.d)(this,this.onContextMenu,"onContextMenu")),this._eventHandlerManager.initializeEventForElement(s.EventNames.touchContextMenu,t,2,Object(r.d)(this,this.onContextMenu,"onContextMenu"))},C.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeEventForElement(t,s.EventNames.contextMenu),this._eventHandlerManager.deinitializeEventForElement(t,s.EventNames.touchContextMenu)},C.registerHandler=function(e,t,n){this._eventHandlerManager.registerHandler(s.EventNames.contextMenu,e,2,Object(r.d)(this,this.onContextMenu,"onContextMenu"),t,n),this._eventHandlerManager.initializeForElementInternal(s.EventNames.touchContextMenu,e,2,Object(r.d)(this,this.onContextMenu,"onContextMenu"))},C.unregisterHandler=function(e,t){this._eventHandlerManager.unregisterHandler(s.EventNames.contextMenu,e,t),this._eventHandlerManager.deinitializeForElementInternal(e,s.EventNames.touchContextMenu)},C.fireContextMenu=function(e){var t=e.srcElement||e.target,n=new Sys.UI.DomEvent(e);this._eventHandlerManager.simulateBubblingEvent(s.EventNames.contextMenu,t,n)},C.onContextMenu=function(e,t,i){var r=n(1).AFrameworkApplication;if(!this.isEnabled)return!1;if(g.a.isOneNoteInkingImprovementsEnabled())return!0;if(i.target&&1===i.target.nodeType&&Sys.UI.DomElement.containsCssClass(i.target,o.allowBrowserContextMenu))return!1;if(this.isSuppressingMenus||r.appSettingsManager.getBooleanAppSetting("OneNoteTeamsEmbedMobileIsEnabled"))return a.a.cancelEvent(i),!0;if(f.a.instance.isYielding)return!0;var l=this._eventHandlerManager.processEvent(s.EventNames.contextMenu,t,u.create(e,i,this._lastInputMethodHeard));return l&&(a.a.cancelEvent(i),e===s.EventNames.touchContextMenu&&(m.a.cancelAllPendingClicks(),this._eventHandlerManager.temporarilyDisableBrowserClicks(),this._cancelPointersOnContextMenu&&(this._dragInputManager.cancelPendingPointerEvents(),this._gestureInputManager.instance&&this._gestureInputManager.instance.cancelPendingPointerEvents()))),l},C.onPointerEventHeard=function(e){this._lastInputMethodHeard=e.inputSource},C.onKeyEventHeard=function(e){this._lastInputMethodHeard=1},o.disposeInputManager=function(){v.a(o._instance),o._instance=null},l=o,S=[{key:"instance",get:function(){return o._instance||(o._instance=new o),o._instance}}],(c=null)&&y(l.prototype,c),S&&y(l,S),o}(a.a);S.allowBrowserContextMenu="AllowBrowserContextMenu",S._instance=null,Object(i.a)(S,"ContextMenuInputManager",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),r=(n(2),n(19));n(9);function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(){this._roots=[],this._ribbon=null}var t,i,o,l=e.prototype;return l.addRoot=function(e){n(195).Ribbon;e&&!Array.contains(this._roots,e)&&Array.add(this._roots,e)},l.removeRoot=function(e){n(195).Ribbon;return Array.remove(this._roots,e)},l.getFirstValidControl=function(e){for(var t,n=a(this.roots);!(t=n()).done;){var i=t.value,o=Object(r.a)(19,i);if(o){var s=e.startsWith(o.controlIdPrefix)?e:o.controlIdPrefix+e,l=o.getValidControl(s);if(l)return l}}return null},l.commitAnyPendingChange=function(){for(var e,t=a(this._roots);!(e=t()).done;){e.value.commitAnyPendingChange()}},l.dispose=function(){this._roots=null},e.initializeRootManager=function(){return e.initializeComponents(),e._instance=new e,e._instance},e.initializeComponents=function(){},t=e,o=[{key:"instance",get:function(){return e._instance||e.initializeRootManager()}}],(i=[{key:"roots",get:function(){return this._roots}},{key:"inKeytipMode",get:function(){return!1}}])&&s(t.prototype,i),o&&s(t,o),e}();l._instance=null,Object(i.a)(l,"RootManager",null,[42,4])},function(e,t,n){"use strict";var i=n(0),r=n(109),a=n(165),o=function(){function e(e){this._task=e}var t=e.prototype;return t.onCompleted=function(e){this._task.OC(e,null,0,null)},t.get_isCompleted=function(){return this._task.get_isCompleted()},t.getResult=function(){if(this._task.get_isFaulted())throw this._task.get_exception();if(this._task.get_isCanceled())throw a.a.createCancellationException();return this._task.get_result()},e}();Object(i.a)(o,"TaskAwaiter$1",null,[64]),n.d(t,"a",(function(){return s}));var s=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._func=null,t._funcWithData=null,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.execute=function(){if(this._func)this.set_result(this._func());else{if(!this._funcWithData)return!1;this.set_result(this._funcWithData(this._data))}return!0},r.get_result=function(){if(6!==this.get_status())throw Error.invalidOperation();return this._result},r.set_result=function(e){return this._result=e,e},r.G=function(){return new o(this)},i.C=function(e){var t=new i;return t._func=e,t},i.CO=function(e,t){var n=new i;return n._funcWithData=e,n._data=t,n},i}(r.Task);Object(i.a)(s,"Task$1",r.Task,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(0),r=n(1),a=(n(129),n(185),n(242)),o=n(197);function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(){}var t,n,i;return e.getPath=function(t,n){return void 0===n&&(n=!0),String.format("{0}{1}{2}",e.appChromeBasePath,t,n?"/":"")},e.isKnownScript=function(e,t){for(var n,i=s(e);!(n=i()).done;){var r=n.value;if(r.identifier===t||r.dependencies&&a.b(r.dependencies,t))return!0}return!1},e.getLocalizationPath=function(t){return e.getPath(String.format("localization/{0}",o.a.getCultureInfo(t).name))},t=e,i=[{key:"isEnabled",get:function(){return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppChromeOverrideEnabled")||!1}},{key:"scriptPath",get:function(){return e.getPath("webpack")}},{key:"fileSuffix",get:function(){return r.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppChromeMinificationOverride")}},{key:"appChromeBasePath",get:function(){return r.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppChromeBaseUrlOverride")}}],(n=null)&&c(t.prototype,n),i&&c(t,i),e}();Object(i.a)(u,"AppChromeOverrideUtilities",null,[])},function(e,t,n){var i=n(145);e.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var i=n(144),r=n(398),a=n(194),o=n(295),s=Object.defineProperty;t.f=i?s:function(e,t,n){if(a(e),t=o(t,!0),a(n),r)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var i=n(0),r=n(1),a=n(151),o=n(107),s=n(132);var l=function(e){var t,n;function i(t){return e.call(this,5,t)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(s.a);Object(i.a)(l,"ResizeAnimationEvent",s.a,[]);var c=function(e){var t,n;function i(t){return e.call(this,7,t)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(s.a);Object(i.a)(c,"ScrollAnimationEvent",s.a,[]);var u=n(136),d=n(29),p=n(22),h=n(16),m=n(10);function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return f}));var f=function(){function e(){}var t,i,s;return e.animateSize=function(e,t,n,i){var r=e.style.height,a=e.style.width,o=p.DomUtils.parseCssSize(r),s=p.DomUtils.parseCssSize(a);""===r.trim()&&(o=t),""===a.trim()&&(s=n),d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var c=new l(e);c.animateHeight(o,t),c.animateWidth(s,n),d.WacAirSpace.animate(c,null,i)},e.animateScroll=function(e,t,n,i){var r=e.scrollLeft,a=e.scrollTop;d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var o=new c(e);return isNaN(t)||o.animateScrollLeft(r,t),isNaN(n)||o.animateScrollTop(a,n),d.WacAirSpace.animate(o,null,i)},e.animatePosition=function(e,t,n){var i;i=r.AFrameworkApplication.isRtl?e.style.right:e.style.left;var a=e.style.top,s=p.DomUtils.parseCssSize(i),l=p.DomUtils.parseCssSize(a);""===i.trim()&&(s=t),""===a.trim()&&(l=n),d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var c=new o.a(e);c.animateX(s,t,r.AFrameworkApplication.isRtl),c.animateY(l,n),d.WacAirSpace.animate(c,null,null)},e.animateYPosition=function(e,t){var n=e.style.top,i=p.DomUtils.parseCssSize(n);""===n.trim()&&(i=t),d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var r=new o.a(e);r.animateY(i,t),d.WacAirSpace.animate(r,null,null)},e.animateFoundCurrentResultHighlight=function(t,n){d.WacAirSpace.setAnimationClass(n,"Shared_QuickClass");var i=new u.a(n);i.animateOpacity(0,.4),d.WacAirSpace.animate(i,null,null),d.WacAirSpace.setAnimationClass(t,"Shared_QuickClass");var r=new a.a(t);r.animateOpacity(.4,0),d.WacAirSpace.animate(r,null,e.onAfterCloneFadeOut)},e.animateClearCurrentResultHighlight=function(t,n){d.WacAirSpace.setAnimationClass(n,"Shared_QuickClass");var i=new u.a(n);i.animateOpacity(0,.4),d.WacAirSpace.animate(i,null,null),d.WacAirSpace.setAnimationClass(t,"Shared_QuickClass");var r=new a.a(t);r.animateOpacity(.4,0),d.WacAirSpace.animate(r,null,e.onAfterCloneFadeOut)},e.animateFindPane=function(e,t,n){d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var i,a=new o.a(e);i=r.AFrameworkApplication.isRtl?e.style.right:e.style.left;var s=p.DomUtils.parseCssSize(i);t?a.animateX(s,0,r.AFrameworkApplication.isRtl):(r.AFrameworkApplication.isRtl?""===e.style.right.trim()&&(s=-1*e.clientWidth):""===e.style.left.trim()&&(s=-1*e.clientWidth),a.animateX(s,-1*e.clientWidth,r.AFrameworkApplication.isRtl)),d.WacAirSpace.animate(a,null,n)},e.animateCommentPane=function(e,t,n){d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var i,a=new o.a(e);i=r.AFrameworkApplication.isRtl?e.style.left:e.style.right;var s=p.DomUtils.parseCssSize(i);if(t)a.animateXRight(s,0,r.AFrameworkApplication.isRtl);else{var l=-1*e.clientWidth;r.AFrameworkApplication.isRtl?""===e.style.left.trim()&&(s=l):""===e.style.right.trim()&&(s=l),a.animateXRight(s,-1*e.clientWidth,r.AFrameworkApplication.isRtl)}d.WacAirSpace.animate(a,null,n)},e.resizeContainerAnimation=function(t,n,i,r){d.WacAirSpace.setAnimationClass(t,"Shared_BasicClass");var a=p.DomUtils.parseCssSize(t.style.left);""===t.style.left.trim()&&(a=n);var s=new o.a(t);s.animateX(a,n,!1),(m.a.isInternetExplorer8||e._firstContainerAnimation)&&d.WacAirSpace.temporarilyDisableAnimation(1e3),e._firstContainerAnimation=!1,d.WacAirSpace.animate(s,null,null);var c=p.DomUtils.parseCssSize(t.style.width);""===t.style.width.trim()&&(c=i);var u=new l(t);u.animateWidth(c,i),d.WacAirSpace.animate(u,null,r)},e.animateChromeInWordViewer=function(t,n){var i=document.getElementById(e.ribbonPanelId);if(i){d.WacAirSpace.setAnimationClass(i,"Shared_BasicClass");var r=new o.a(i);r.animateY(-t,0),d.WacAirSpace.animate(r,null,null)}var a=e.statusBarPanel;if(a){d.WacAirSpace.setAnimationClass(a,"Shared_BasicClass");var s=new l(a);s.animateHeight(0,n),d.WacAirSpace.animate(s,null,null),d.WacAirSpace.setAnimationClass(a,"Shared_BasicClass");var c=new u.a(a);c.animateOpacity(0,1),d.WacAirSpace.animate(c,null,null)}},e.animateCommentHintPosition=function(e,t,n){var i=p.DomUtils.parseCssSize(e.style.top),r=p.DomUtils.parseCssSize(e.style.left);d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var a=new o.a(e);a.animateY(i||t,t),a.animateX(r||n,n,!1),d.WacAirSpace.animate(a,null,null)},e.animateHideHighlight=function(e){h.a.setOpacity(e,0)},e.animateShowHighlight=function(e){var t=h.a.getOpacity(e)/100;d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var n=new u.a(e);n.animateOpacity(t,.4),d.WacAirSpace.animate(n,null,null)},e.onAfterCloneFadeOut=function(e){var t=e.element;t&&t.parentNode&&t.parentNode.removeChild(t)},t=e,s=[{key:"ribbonPanelId",get:function(){var e=n(238).AppFrame;return r.AFrameworkApplication.activeFrame?e.ribbonPanelId:null}},{key:"statusBarPanel",get:function(){return r.AFrameworkApplication.activeFrame?r.AFrameworkApplication.activeFrame.statusBarPanel:null}}],(i=null)&&g(t.prototype,i),s&&g(t,s),e}();f._firstContainerAnimation=!0,Object(i.a)(f,"WordViewerAnimator",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(11),o=n(38),s=n(119),l=n(285),c=n(362),u=n(1),d=(n(9),n(16)),p=function(){function e(e,t,n,i,r){this._elmTopBar1=e,this._elmTopBar2=t,this._breadcrumb=n,this._documentTitle=i,this._toolbarContainer=r}var t=e.prototype;return t.adjustBreadcrumbDisplay=function(){var e=!!u.AFrameworkApplication.breadcrumbBrandName,t=!!u.AFrameworkApplication.breadcrumbFolderName;if(!u.AFrameworkApplication.isEmbedded&&e&&t){var n=this._breadcrumb.getBreadcrumbItem(o.CuiHelper.breadcrumbFolderId),i=this._breadcrumb.getBreadcrumbItem(o.CuiHelper.folderSeparatorId);n&&i&&l.a.adjustBreadcrumbDisplay(i,n)}},t.scaleHerobar=function(){var t=this,n=[function(){e.trimLongestElement(t._breadcrumb,t._documentTitle,200)},function(){e.trimBreadcrumbAndDocumentTitle(t._breadcrumb,t._documentTitle,200)},function(){e.hideDocumentTitleAndUntruncateBreadcrumb(t._breadcrumb,t._documentTitle)},function(){t._breadcrumb.truncateWidth(200)},Object(r.d)(this._breadcrumb,this._breadcrumb.hide,"hide")];e.showAndUntruncateAllElements(this._breadcrumb,this._documentTitle),e.invokeScalingSteps(n,(function(){return e.herobarElementBoundsOverlap(t._breadcrumb,t._documentTitle,t._toolbarContainer,u.AFrameworkApplication.isRtl)}))},t.scaleHeader=function(){this.enhancedMobileViewIsEnabled()?(document.getElementById("application").style.minWidth="0px",new c.a(this._elmTopBar1,this._elmTopBar2,u.AFrameworkApplication.isRtl).scaleHeader()):l.a.scaleHeaderUsingContainers(this._elmTopBar1,this._elmTopBar2,u.AFrameworkApplication.isRtl)},t.enhancedMobileViewIsEnabled=function(){return!!u.AFrameworkApplication.appSettingsManager&&u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")},t.scaleViewerChrome=function(){this.scaleHeader(),this.adjustBreadcrumbDisplay(),this.scaleHerobar()},e.showAndUntruncateAllElements=function(e,t){e&&e.undoScaling(),t&&t.undoScaling()},e.herobarElementBoundsOverlap=function(t,n,i,r){return e.viewerChromeItemsOverlap(t,n,r)||e.viewerChromeItemsOverlap(n,i,r)||e.viewerChromeItemsOverlap(t,i,r)},e.viewerChromeItemsOverlap=function(e,t,n){return!(!e||!t)&&(!(!e.isVisible||!t.isVisible)&&d.a.leftBoundsOverlapsRightBounds(e.containerBounds,t.containerBounds,n))},e.trimLongestElement=function(e,t,n){e&&t&&(e.containerBounds.width>t.containerBounds.width?e.truncateWidth(n):t.truncateWidth(n))},e.trimBreadcrumbAndDocumentTitle=function(e,t,n){e&&e.truncateWidth(n),t&&t.truncateWidth(n)},e.hideDocumentTitleAndUntruncateBreadcrumb=function(e,t){t.hide(),e.undoScaling()},e.invokeScalingSteps=function(e,t){for(var n=0;t()&&n<e.length;)e[n](),n++},e}();Object(i.a)(p,"ViewerChromeScalingManager",null,[]);var h=n(104),m=n(22),g=n(340);function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return v}));var v=function(){function e(e,t,n,i,o,s){var l=this;void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),this._elmViewerChromeContainer=null,this._elmToolbarTopBars=null,this._elmHeaderContainer=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._breadcrumbContainer=null,this._documentTitleContainer=null,this._toolbarContainer=null,this.viewerChromeScalingManager=null,this._resizableContainer=null,this._appExternalHeaderPanel=null,this._peripheralContentContainer=null,this._appHasExternalHeader=h.a.tryEnsuredHeaderPanelInitialized(Object(a.a)((function(){return l._appExternalHeaderPanel}),(function(e){return l._appExternalHeaderPanel=e})),!i),this._headerIsHidden=i,this._hideTitleAndBreadcrumbs=o,this._isExternalToolbar=s,this.createViewerChromeStructure(),e.appendChild(this._elmViewerChromeContainer),this._headerIsHidden||this.populateHeader(t),this._isExternalToolbar||(this.populateHerobarContainers(),this.viewerChromeScalingManager=new p(this.peripheralContentContainer,this._elmTopBar2,this._breadcrumbContainer,this._documentTitleContainer,this._toolbarContainer),this._resizableContainer=n||new g.a,this._resizableContainer.add_onResize(Object(r.d)(this,this.scale,"scale")),this.scale())}var t,i,l,c=e.prototype;return c.createViewerChromeStructure=function(){this._elmViewerChromeContainer=e.createUnselectableElement("div"),this._elmViewerChromeContainer.className=this.viewerChromeCssClass,this.ensureTopBars(),this.ensureTopBars1And2()},c.ensureTopBars=function(){this._elmToolbarTopBars=e.createUnselectableElement("div"),this._elmToolbarTopBars.id=o.CuiHelper.headerTopBarsId,this._elmToolbarTopBars.className="cui-ribbonTopBars",this._elmViewerChromeContainer.appendChild(this._elmToolbarTopBars),this.ensureHeaderDom()},c.ensureHeaderDom=function(){this._appHasExternalHeader?(this._elmHeaderContainer=e.createUnselectableElement("div"),this._elmHeaderContainer.className="cui-ribbonTopBars",this._elmHeaderContainer.id=o.CuiHelper.externalHeaderViewerChromeTopBarsId,this._appExternalHeaderPanel.appendChild(this._elmHeaderContainer),Sys.UI.DomElement.addCssClass(this._elmHeaderContainer,this.viewerChromeCssClass),Sys.UI.DomElement.addCssClass(this._elmViewerChromeContainer,"cui-exth")):this._elmHeaderContainer=this._elmToolbarTopBars},c.ensureTopBars1And2=function(){this._peripheralContentContainer=e.createUnselectableElement("div"),this.peripheralContentContainer.className="cui-topBar1";var t=u.AFrameworkApplication.appSettingsManager.appSettings;"TransitionalHeaderUIInViewEnabled"in t&&Boolean.parse(t.TransitionalHeaderUIInViewEnabled)&&u.AFrameworkApplication.activeFrame&&u.AFrameworkApplication.activeFrame.applicationInstance.isTransistionalHeaderUIEnabled&&(this.peripheralContentContainer.className+=" cui-topBar1-transistionalHeaderUI"),u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LegacyHeaderAppColorIsEnabled")&&(this.peripheralContentContainer.className+=" cui-topBar1-transistionalHeaderUI"),u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(this.peripheralContentContainer.className+=" cui-color-update"),this._headerIsHidden&&(this.peripheralContentContainer.style.display="none"),this._elmHeaderContainer.appendChild(this.peripheralContentContainer),this._elmTopBar2=e.createUnselectableElement("div"),u.AFrameworkApplication.isMobileMode||(this._elmTopBar2.className="cui-topBar2"),this._isExternalToolbar&&(this._elmTopBar2.className+=" elevated-toolbar"),this._elmToolbarTopBars.appendChild(this._elmTopBar2)},c.populateHeader=function(t){this._elmTopRowLeft=document.getElementById(t+"-"+s.a.topRowLeft),this._elmTopRowCenter=document.getElementById(t+"-"+s.a.topRowCenter),this._elmTopRowRight=document.getElementById(t+"-"+s.a.topRowRight),this._elmTopRowLeft&&(this._elmTopRowLeft.parentNode.removeChild(this._elmTopRowLeft),this.peripheralContentContainer.appendChild(this._elmTopRowLeft),this._elmTopRowLeft.style.display="inline-block",e.setUnselectable(this._elmTopRowLeft)),this._elmTopRowCenter&&(this._elmTopRowCenter.parentNode.removeChild(this._elmTopRowCenter),this.peripheralContentContainer.appendChild(this._elmTopRowCenter),this._elmTopRowCenter.style.display="inline-block",e.setUnselectable(this._elmTopRowCenter)),this._elmTopRowRight&&(this._elmTopRowRight.parentNode.removeChild(this._elmTopRowRight),this.peripheralContentContainer.appendChild(this._elmTopRowRight),this._elmTopRowRight.style.display="inline-block",e.setUnselectable(this._elmTopRowRight))},c.populateHerobarContainers=function(){var e=n(512).BreadcrumbContainer,t=n(513).DocumentTitleContainer,i=n(514).ToolbarContainer;this._hideTitleAndBreadcrumbs||(u.AFrameworkApplication.isMobileMode||u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HideBreadCrumbinRibbonforUIHost")||(this._breadcrumbContainer=new e,this._elmTopBar2.appendChild(this._breadcrumbContainer.elmContainer)),u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HideTitleinRibbonforUIHost")||(this._documentTitleContainer=new t,this._elmTopBar2.appendChild(this._documentTitleContainer.elmContainer))),this._toolbarContainer=new i,this._elmTopBar2.appendChild(this._toolbarContainer.elmContainer)},c.scale=function(){u.AFrameworkApplication.isMobileMode||this._hideTitleAndBreadcrumbs||u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HideBreadCrumbinRibbonforUIHost")&&u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HideTitleinRibbonforUIHost")||this.viewerChromeScalingManager.scaleViewerChrome()},c.dispose=function(){this._documentTitleContainer&&(this._documentTitleContainer.dispose(),this._documentTitleContainer=null),this._breadcrumbContainer&&(this._breadcrumbContainer.dispose(),this._breadcrumbContainer=null),this._elmToolbarTopBars=null,this._peripheralContentContainer=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._resizableContainer&&(this._resizableContainer.remove_onResize(Object(r.d)(this,this.scale,"scale")),this._resizableContainer=null),this._appExternalHeaderPanel&&m.DomUtils.clearElementHtml(this._appExternalHeaderPanel)},e.calculateToolbarWithTopBarHeight=function(e,t){return 40+(e||t?0:48)},e.createUnselectableElement=function(t){var n=document.createElement(t);return e.setUnselectable(n),n},e.setUnselectable=function(e){e.setAttribute("unselectable","on")},t=e,(i=[{key:"toolbarWithTopbarHeight",get:function(){return e.calculateToolbarWithTopBarHeight(this._headerIsHidden,this._appHasExternalHeader)}},{key:"viewerChromeCssClass",get:function(){return"cui-viewerchrome"}},{key:"toolbarContainer",get:function(){return this._isExternalToolbar?this._elmTopBar2:this._toolbarContainer.elmContainer}},{key:"peripheralContentContainer",get:function(){return this._peripheralContentContainer}},{key:"toolbarContentContainer",get:function(){return this._elmTopBar2}}])&&f(t.prototype,i),l&&f(t,l),e}();Object(i.a)(v,"ViewerChrome",null,[4,186])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(230);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).durationMs=null,t.succeeded=null,t.count=null,t.aggMode=null,t.CV=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"ActivityEvent",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(132);var a=function(e){var t,n;function i(t){return e.call(this,2,t)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"HideAnimationEvent",r.a,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(1),o=(n(9),n(33)),s=n(340),l=n(10),c=n(249),u=function(e,t){this.units=e,this.specialTextStrings=t};Object(i.a)(u,"SpinnerChildren",null,[]);var d=n(177),p=function(){this.Color=null,this.DisplayColor=null,this.Title=null};Object(i.a)(p,"ColorCellInfo",null,[]);var h=n(228),m=n(385),g=n(291),f=n(116),v=n(278),_=n(191),y=n(392),b=n(23),S=n(42),C=n(6);function A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var I=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i)||this)._element=null,r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.ensureValidDisplayMode=function(e){},s.createComponentDomForDisplayMode=function(e){return this._element=C.a.createElement("span"),this._element.className="cui-ctl cui-placeholder",new S.a(e,this._element)},s.pollForStateAndUpdate=function(){},s.dispose=function(){e.prototype.dispose.call(this),this._element=null},s.constructClonedControl=function(e,t){return new i(e,this.id,t)},r=i,(a=[{key:"controlType",get:function(){return b.Control.placeholderControlType}},{key:"properties",get:function(){return this.controlProperties}}])&&A(r.prototype,a),o&&A(r,o),i}(b.Control);Object(i.a)(I,"Placeholder",b.Control,[]);var w=n(74),T=n(38),E=n(56),k=n(71),M=n(4),P=n(25),F=n(20),D=n(28),O=n(7);function R(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var x=function(){function e(t){this._politeRegion=null,this._assertiveRegion=null,this._alertRegion=null,this._domContainer=t,e.isInternetExplorerNonEdge=Sys.Browser.agent===Sys.Browser.InternetExplorer}var t,n,i,r=e.prototype;return r.getLiveRegion=function(e){return this.getLiveRegionInternal(e,!1)},r.sendNotification=function(e,t){this.sendNotificationInternal(e,t,!1)},r.sendNonInteruptiveNotification=function(e){this.sendNotificationInternal(e,!0,!0)},r.sendNotificationInternal=function(e,t,n){var i=this.getLiveRegionInternal(t,n);i.firstChild&&i.removeChild(i.firstChild),e&&i.appendChild(document.createTextNode(e))},r.getFullId=function(e){return String.format("{0}_{1}",this._domContainer.id,e)},r.getLiveRegionInternal=function(e,t){return t?this.alertRegion:e?this.assertiveRegion:this.politeRegion},r.dispose=function(){this._domContainer.removeChild(this._politeRegion),this._politeRegion=null,this._domContainer.removeChild(this._assertiveRegion),this._assertiveRegion=null,this._domContainer.removeChild(this._alertRegion),this._alertRegion=null},e.createLiveRegion=function(t,n,i,r){void 0===n&&(n="polite"),void 0===i&&(i="marquee"),void 0===r&&(r=!0);var a=document.createElement("div");return a.id=t,a.setAttribute("role",i),e.isInternetExplorerNonEdge&&a.setAttribute("aria-label",""),a.setAttribute("aria-live",n),a.setAttribute("aria-atomic",r?"true":"false"),a.className="WACAriaLiveRegion",a},t=e,(n=[{key:"politeRegion",get:function(){return this._politeRegion||(this._politeRegion=this._domContainer.appendChild(e.createLiveRegion(this.getFullId("PoliteNotifier"))))}},{key:"assertiveRegion",get:function(){return this._assertiveRegion||(this._assertiveRegion=this._domContainer.appendChild(e.createLiveRegion(this.getFullId("AssertiveNotifier"),"assertive")))}},{key:"alertRegion",get:function(){return this._alertRegion||(this._alertRegion=this._domContainer.appendChild(e.createLiveRegion(this.getFullId("AlertNotifier"),"assertive","alert")))}}])&&R(t.prototype,n),i&&R(t,i),e}();x.isInternetExplorerNonEdge=!1,Object(i.a)(x,"AriaNotifier",null,[163,4]);var U=function(){function e(e){this._input=e}return e.prototype.interactionEnd=function(){this._input.value=""},e}();Object(i.a)(U,"ClearInputOnInteractionEndModule",null,[]);var B=function(){function e(e,t,n,i){this._root=e,this._properties=t,this._getControlComponent=n,this._keyboardingState=i}var t=e.prototype;return t.onInputBlur=function(e,t){return this.executeCommand(this._properties.InputBoxBlurCommand,t),!1},t.onInputFocus=function(e,t){return this.executeCommand(this._properties.InputBoxFocusCommand,t),!1},t.onInteractionBegin=function(e,t){return this._properties.InteractionBeginCommand&&this.executeCommand(this._properties.InteractionBeginCommand,null),!1},t.onRestoreFocus=function(e,t){return this._keyboardingState.escaping&&this.executeCommand(this._properties.RestoreFocusCommand,null),!1},t.executeCommand=function(e,t){var n=t?t.inputSource:0;this._root.executeCommand(e,{},this._getControlComponent(),n,!1)},e}();Object(i.a)(B,"FocusBlurEventsToCommandsAdapter",null,[]);var L=n(24);function N(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var H=function(){function e(e){this._searchBox=e}var t,n,i,r=e.prototype;return r.setFocus=function(e){return!(!this._searchBox.menuLaunched||!this._searchBox.menu)&&(this._searchBox.menu.setFocus(e),!0)},r.closeMenuStack=function(){this._searchBox.closeMenuStack()},r.blurInputField=function(){return L.FocusManager.tryBlur(this._searchBox.inputField)},t=e,(n=[{key:"escaping",get:function(){return this._searchBox.escaping},set:function(e){this._searchBox.escaping=e}},{key:"processingKeystroke",get:function(){return this._searchBox.processingKeystroke},set:function(e){this._searchBox._processingKeystroke=e}}])&&N(t.prototype,n),i&&N(t,i),e}();Object(i.a)(H,"FocusableMenu",null,[162]);var W=function(){function e(e){this._target=e}var t=e.prototype;return t.onKeyDown=function(e,t){if(!t||!t.innerEvent)return!1;var n=t.innerEvent.keyCode;return this.shouldMoveFocusToMenu(n)?this._target.setFocus(t.inputSource):n===P.a.vK_Escape?(this._target.escaping=!0,this._target.closeMenuStack(),this._target.blurInputField()):(n===P.a.vK_Tab&&(this._target.processingKeystroke=!0,this._target.closeMenuStack()),!1)},t.shouldMoveFocusToMenu=function(e){return e===P.a.vK_Enter||e===P.a.vK_Down},e}();function j(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(W,"KeyboardNavigationModule",null,[]);var V=function(){function e(e){this._searchBox=e}var t,n,i;return t=e,(n=[{key:"escaping",get:function(){return this._searchBox.escaping},set:function(e){this._searchBox.escaping=e}}])&&j(t.prototype,n),i&&j(t,i),e}();Object(i.a)(V,"KeyboardState",null,[161]);var K=function(){function e(t){this._oldInputText=e.defaultValue,this._adapter=t}var t=e.prototype;return t.onInputKeyUp=function(t,n){var i=!1;return this._adapter.processingKeystroke=!0,this.textChanged()&&(this._adapter.inputText.trim()===e.defaultValue&&this._adapter.closeMenuStack(),this.updateMenu(n.inputSource),i=!0),this._adapter.processingKeystroke=!1,i},t.updateMenu=function(e){this._oldInputText=this._adapter.inputText,this._adapter.pollForResults(e)},t.onSearchButtonClick=function(e,t){return this._adapter.focusSearchbox()},t.onInteractionBegin=function(){this.updateMenu(0)},t.onInteractionEnd=function(){this.updateMenu(0)},t.textChanged=function(){return this._oldInputText!==this._adapter.inputText},e}();K.defaultValue="",Object(i.a)(K,"MenuUpdateModule",null,[]);var z=function(){function e(e,t,n){this._placeholderTextActive=!1,this._input=e,this._placeHolderText=t,this._cssClass=n,this.onInputBlur(null,null)}var t=e.prototype;return t.onInputBlur=function(e,t){return""===this._input.value&&(this._input.value=this._placeHolderText,this._placeholderTextActive=!0,C.a.ensureCSSClassOnElement(this._input,this._cssClass)),!1},t.onInputFocus=function(e,t){return this._placeholderTextActive&&(this._input.value="",this._placeholderTextActive=!1,C.a.removeCSSClassFromElement(this._input,this._cssClass)),!1},e}();function q(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(z,"PlaceholderTextModule",null,[]);var G=function(){function e(e){this._searchBox=e}var t,n,i,r=e.prototype;return r.closeMenuStack=function(){this._searchBox.closeMenuStack()},r.pollForResults=function(e){this._searchBox.pollForResults(e)},r.focusSearchbox=function(){return L.FocusManager.tryFocus(this._searchBox.inputField)},t=e,(n=[{key:"inputText",get:function(){return this._searchBox.inputText}},{key:"processingKeystroke",get:function(){return this._searchBox.processingKeystroke},set:function(e){this._searchBox._processingKeystroke=e}}])&&q(t.prototype,n),i&&q(t,i),e}();function Q(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}Object(i.a)(G,"SeachBoxToUpdateableMenu",null,[142]);var $=function(){function e(){this._handlers=[]}var t=e.prototype;return t.addHandler=function(e){Array.add(this._handlers,e)},t.removeHandler=function(e){Array.remove(this._handlers,e)},t.raiseEvent=function(e,t){for(var n,i=Q(this._handlers);!(n=i()).done;){var r=n.value;if(r&&r(t,e))return!0}return!1},e}();Object(i.a)($,"EventChain",null,[]);var X=function(){function e(){this._eventMap={}}var t=e.prototype;return t.addHandler=function(e,t){this._eventMap[e]||(this._eventMap[e]=new $),this._eventMap[e].addHandler(t)},t.removeHandler=function(e,t){this._eventMap[e]&&this._eventMap[e].removeHandler(t)},t.raiseEvent=function(e,t,n){var i=this._eventMap[e];return!!i&&i.raiseEvent(t,n)},t.dispose=function(){this._eventMap=null},e}();Object(i.a)(X,"SearchBoxEventSource",null,[4]);var J=n(84);function Y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ee=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this)._topLevelElement=null,a._inputField=null,a._imageMask=null,a._searchButton=null,a.searchIcon=null,a._ariaNotifier=null,a._currentImageClass=null,a._inputHasFocus=!1,a._mouseIsOver=!1,a._processingKeystroke=!1,a.escaping=!1,a.addDisplayMode("Medium"),a._sendFocusToMenuDrop=!1,n===T.CuiHelper.tellMeSearchBoxId&&(a.stateProperties.TakeFocusOnMenuNavigationEnd=!0),a._eventSource=new X,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o,s,l,c=i.prototype;return c.createComponentDomForDisplayMode=function(e){this._topLevelElement=C.a.createElement("span"),C.a.ensureCSSClassOnElement(this.topLevelElement,"cui-sb");var t=a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeRedesignIsEnabled");return t&&C.a.ensureCSSClassOnElement(this.topLevelElement,"tellme-flight"),this.topLevelElement.setAttribute("mscui:controltype",this.controlType),C.a.addToTabLoop(this.topLevelElement),this.topLevelElement.tabIndex=-1,this._inputField=C.a.createSelectableElement("input"),C.a.ensureCSSClassOnElement(this.inputField,"cui-sb-input"),this.inputField.setAttribute("data-lpignore","true"),t&&C.a.ensureCSSClassOnElement(this.inputField,"tellme-flight"),this.inputField.type="text",this.inputField.setAttribute("Autocomplete","off"),this.inputField.style.width=this.sbProperties.Width,this.inputField.id=this.sbProperties.Id,this.inputField.title=this.sbProperties.Alt,this.inputField.setAttribute("maxlength","256"),this.inputField.setAttribute("tabindex","0"),this._searchButton=C.a.createElement("a"),this._searchButton.setAttribute(O.a.ariaHiddenAttribute,O.a.ariaTrueValue),this._searchButton.id=this.id+"-icon",this._searchButton.tabIndex=-1,this.searchIcon=C.a.createElement("img"),this._ariaNotifier=new x(this.topLevelElement),C.a.ensureCSSClassOnElement(this._searchButton,"cui-sb-image-button"),t&&C.a.ensureCSSClassOnElement(this._searchButton,"tellme-flight"),this._currentImageClass=t?this.sbProperties.DarkImage16by16Class:this.sbProperties.Image16by16Class,this._imageMask=C.a.createClusteredImageContainerNew(4,this.sbProperties.Image16by16,this._currentImageClass,this.searchIcon,!0,!1),C.a.ensureCSSClassOnElement(this._imageMask,"sb-img"),t&&this.topLevelElement.appendChild(this._searchButton),this._searchButton.appendChild(this._imageMask),this.topLevelElement.appendChild(this.inputField),t||this.topLevelElement.appendChild(this._searchButton),this.attachEvents(),this.attachModules(),new S.a(e,this.topLevelElement)},c.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,this.inputField,this.parentKeytipsIds,this.parentKeytipsKeys)},c.attachModules=function(){var e=this,t=new K(new G(this));this.add_onInputKeyUp(Object(r.d)(t,t.onInputKeyUp,"onInputKeyUp")),this.add_onSearchButtonClick(Object(r.d)(t,t.onSearchButtonClick,"onSearchButtonClick"));var n=new B(this.root,this.sbProperties,(function(){return e.displayedComponent}),new V(this));this.add_onInputBlur(Object(r.d)(n,n.onInputBlur,"onInputBlur")),this.add_onInputFocus(Object(r.d)(n,n.onInputFocus,"onInputFocus")),this.add_onInteractionBegin(Object(r.d)(n,n.onInteractionBegin,"onInteractionBegin")),this.add_onInteractionEnd(Object(r.d)(n,n.onRestoreFocus,"onRestoreFocus"));var a=new W(new H(this));this.add_onInputKeyDown(Object(r.d)(a,a.onKeyDown,"onKeyDown"));var o=new U(this.inputField);if(this.add_onInteractionEnd(i.actionToEventDelegate(Object(r.d)(o,o.interactionEnd,"interactionEnd"))),this.add_onInteractionEnd(i.actionToEventDelegate(Object(r.d)(t,t.onInteractionEnd,"onInteractionEnd"))),this.add_onInteractionBegin(i.actionToEventDelegate(Object(r.d)(t,t.onInteractionBegin,"onInteractionBegin"))),"placeholder"in this.inputField)this.inputField.setAttribute("placeholder",this.sbProperties.PlaceholderText);else{var s=new z(this.inputField,this.sbProperties.PlaceholderText,"cui-sb-placeholder");this.add_onInputBlur(Object(r.d)(s,s.onInputBlur,"onInputBlur")),this.add_onInputFocus(Object(r.d)(s,s.onInputFocus,"onInputFocus"))}this.add_onMenuChange(Object(r.d)(this,this.onMenuChangedAriaNotification,"onMenuChangedAriaNotification")),this.add_onInputKeyDown((function(e,t){return C.a.preventDefaultKeyAction(t,P.a.vK_Esc)})),this.add_onInputKeyDown((function(t,n){return w.MenuLauncher.prototype.onKeyDown.call(e,n)})),this.add_onInputKeyUp((function(t,n){return b.Control.prototype.onKeyUp.call(e,n)}))},c.attachEvents=function(){E.a.instance.registerHandler(M.EventNames.focus,this.inputField,Object(r.d)(this,this.onInputBoxFocus,"onInputBoxFocus")),E.a.instance.registerHandler(M.EventNames.blur,this.inputField,Object(r.d)(this,this.onInputBoxBlur,"onInputBoxBlur")),F.KeyInputManager.instance.registerHandler(M.EventNames.keyDown,this.inputField,Object(r.d)(this,this.onKeyDown,"onKeyDown")),F.KeyInputManager.instance.registerHandler(M.EventNames.keyUp,this.inputField,Object(r.d)(this,this.onKeyUp,"onKeyUp")),D.a.instance.registerHandler(M.EventNames.pointerOver,this.topLevelElement,Object(r.d)(this,this.onSearchContainerMouseOver,"onSearchContainerMouseOver")),D.a.instance.registerHandler(M.EventNames.pointerOut,this.topLevelElement,Object(r.d)(this,this.onSearchContainerMouseOut,"onSearchContainerMouseOut")),k.a.instance.registerHandler(M.EventNames.click,this._searchButton,Object(r.d)(this,this.onButtonClick,"onButtonClick"))},c.raiseEvent=function(e,t){this._eventSource.raiseEvent(e,t)},c.addHandler=function(e,t){this._eventSource.addHandler(e,t)},c.removeHandler=function(e,t){this._eventSource.removeHandler(e,t)},c.add_onInputBlur=function(e){this.addHandler(J.a.blur,e)},c.remove_onInputBlur=function(e){this.removeHandler(J.a.blur,e)},c.add_onInputFocus=function(e){this.addHandler(J.a.focus,e)},c.remove_onInputFocus=function(e){this.removeHandler(J.a.focus,e)},c.add_onInputKeyUp=function(e){this.addHandler(J.a.keyUp,e)},c.remove_onInputKeyUp=function(e){this.removeHandler(J.a.keyUp,e)},c.add_onInputKeyDown=function(e){this.addHandler(J.a.keyDown,e)},c.remove_onInputKeyDown=function(e){this.removeHandler(J.a.keyDown,e)},c.add_onSearchButtonClick=function(e){this.addHandler(J.a.click,e)},c.remove_onSearchButtonClick=function(e){this.removeHandler(J.a.click,e)},c.add_onMenuChange=function(e){this.addHandler(J.a.menuChanged,e)},c.remove_onMenuChange=function(e){this.removeHandler(J.a.menuChanged,e)},c.add_onInteractionBegin=function(e){this.addHandler(J.a.interactionBegin,e)},c.remove_onInteractionBegin=function(e){this.removeHandler(J.a.interactionBegin,e)},c.add_onInteractionEnd=function(e){this.addHandler(J.a.interactionEnd,e)},c.remove_onInteractionEnd=function(e){this.removeHandler(J.a.interactionEnd,e)},c.onSearchContainerMouseOver=function(e){return this._mouseIsOver=!0,this.searchBoxBehavior&&this.searchBoxBehavior.onSearchContainerMouseOver(e),!1},c.onSearchContainerMouseOut=function(e){return this._mouseIsOver=!1,this.searchBoxBehavior&&this.searchBoxBehavior.onSearchContainerMouseOut(e),!1},c.onInputBoxBlur=function(e){return this._inputHasFocus=!1,this.searchBoxBehavior&&this.searchBoxBehavior.onInputBoxBlur(e),!1},c.onInputBoxFocus=function(e){return this._inputHasFocus=!0,this.escaping=!1,this._processingKeystroke=!1,this._ariaNotifier.sendNotification("",!1),this.searchBoxBehavior&&this.searchBoxBehavior.onInputBoxFocus(e),!1},c.onKeyUp=function(e){return this.searchBoxBehavior&&this.searchBoxBehavior.raiseInteractionBegin(),this._eventSource.raiseEvent(J.a.keyUp,e)},c.onKeyDown=function(e){return this.searchBoxBehavior&&this.searchBoxBehavior.raiseInteractionBegin(),this._eventSource.raiseEvent(J.a.keyDown,e)},c.onButtonClick=function(e){return this.searchBoxBehavior&&this.searchBoxBehavior.raiseInteractionBegin(),this._eventSource.raiseEvent(J.a.click,e)},c.onMenuChanged=function(){this._eventSource.raiseEvent(J.a.menuChanged,null)},c.launchMenu=function(t){e.prototype.launchMenu.call(this,t)},c.closeMenu=function(e){void 0===e&&(e=!0),this.searchBoxBehavior&&this.searchBoxBehavior.closeMenu()},c.closeMenuStack=function(){this.menuLaunched&&this.root.closeMenuStack(this),this.searchBoxBehavior&&this.searchBoxBehavior.raiseInteractionEnd()},c.onMenuChangedAriaNotification=function(e,t){return this._ariaNotifier.sendNotification(this.getAccessibiltyText(),!1),!1},c.pollForResults=function(e){this.sendNotifyAsyncMenuTrigger(),this.pollForDynamicMenu(e)},c.refreshMenu=function(){this.menuLaunched?e.prototype.refreshMenu.call(this):this.inputHasFocus&&this.launchMenu(0)},c.getCommandPopulateProperties=function(){var e={};return e.Value=this.inputField.value,e},c.getAccessibiltyText=function(){var e={};return this.root.executeCommand(this.sbProperties.AccessibilityTextCommand,e,this.displayedComponent,0,!1),e.Value},c.doDefaultAction=function(e,t,n){var i={};i.Value=this.inputField.value,this.root.executeCommand(this.sbProperties.Command,i,this.displayedComponent,t,!1)},c.notifyCommandExecuted=function(e,t){if(this.searchBoxBehavior){var n=this.sbProperties.MenuControlExecutedCommand;this.searchBoxBehavior.notifyCommandExecuted(e,t,this.topLevelElement,n)}},c.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},i.actionToEventDelegate=function(e){return function(t,n){return e(),!1}},o=i,(s=[{key:"topLevelElement",get:function(){return this._topLevelElement}},{key:"inputField",get:function(){return this._inputField}},{key:"inputHasFocus",get:function(){return this._inputHasFocus}},{key:"mouseIsOver",get:function(){return this._mouseIsOver}},{key:"searchBoxBehavior",get:function(){return this.behavior}},{key:"additionalMenuCssClass",get:function(){return"cui-sb-menu"}},{key:"controlType",get:function(){return b.Control.searchBoxControlType}},{key:"ariaRole",get:function(){return"SearchBox"}},{key:"inputText",get:function(){return this.inputField.value},set:function(e){this.inputField.value=e}},{key:"processingKeystroke",get:function(){return this._processingKeystroke}},{key:"sbProperties",get:function(){return this.controlProperties}},{key:"focusableElement",get:function(){return this.inputField}},{key:"isEditable",get:function(){return!0}}])&&Y(o.prototype,s),l&&Y(o,l),i}(w.MenuLauncher);function te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}ee.maxCharacterLimit=256,Object(i.a)(ee,"SearchBox",w.MenuLauncher,[]);var ne=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i)||this)._elmSmall=null,r.addDisplayMode("Small"),r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.createComponentDomForDisplayMode=function(e){return this._elmSmall=C.a.createElement("span"),this._elmSmall.className="cui-separator",new S.a(e,this._elmSmall)},s.pollForStateAndUpdate=function(){this.enabled=!0},s.dispose=function(){e.prototype.dispose.call(this),this._elmSmall=null},s.constructClonedControl=function(e,t){return new i(e,this.id,t)},r=i,(a=[{key:"controlType",get:function(){return b.Control.separatorControlType}},{key:"properties",get:function(){return this.controlProperties}}])&&te(r.prototype,a),o&&te(r,o),i}(b.Control);Object(i.a)(ne,"Separator",b.Control,[]);var ie=n(388);function re(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ae=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i)||this)._sliderDom=null,r.addDisplayMode("Large"),r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.createComponentDomForDisplayMode=function(e){return this._sliderDom=this.buildSliderDom(e),this.sliderDom},s.buildSliderDom=function(e){var t,n,i;(t=C.a.createElement("span")).className="cui-sldr",t.setAttribute("mscui:controltype",this.controlType),(n=C.a.createSelectableElement("input")).type="range",n.className="cui-sldr-input",n.id=this.controlProperties.Id,n.value=this.controlProperties.Value,(i=C.a.createElement("span")).className="cui-ctl-largelabel",C.a.setLargeControlText(i,this.controlProperties.LabelText,!1),i.id=this.controlProperties.LabelId,t.appendChild(n),t.appendChild(i);var r=new ie.a(e);return r.elmControl=t,r.elmInput=n,r.elmLabel=i,r},s.constructClonedControl=function(e,t){return new i(e,this.id,t)},r=i,(a=[{key:"sliderDom",get:function(){return this._sliderDom}},{key:"controlType",get:function(){return b.Control.sliderControlType}}])&&re(r.prototype,a),o&&re(r,o),i}(b.Control);Object(i.a)(ae,"Slider",b.Control,[]);var oe=n(389),se=n(5);function le(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ce=function(){function e(e,t,n,i){this._type=e,this._min=t,this._max=n,this._step=i}var t,n,i;return e.prototype.normalizeNumber=function(e){return e<this._min?this._min:e>this._max?this._max:e},t=e,(n=[{key:"type",get:function(){return this._type}},{key:"min",get:function(){return this._min}},{key:"max",get:function(){return this._max},set:function(e){this._max=e}},{key:"step",get:function(){return this._step}}])&&le(t.prototype,n),i&&le(t,i),e}();function ue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(ce,"Unit",null,[]);var de=function(e){var t,n;function i(t,n,i,r,a){var o;return(o=e.call(this,t,n,i)||this)._spinnerDom=null,o.addDisplayMode("Medium"),o._validUnits=r,o._validSpecialStrings=a,o.behavior&&o.behavior.initialize(),o}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.createComponentDomForDisplayMode=function(e){return this._spinnerDom=this.buildSpinnerDom(e),this.spinnerDom},s.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,this.spinnerDom.elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)},s.buildSpinnerDom=function(e){var t,n,i,r,a,o,s,l;(t=C.a.createElement("span")).className="cui-spn",t.setAttribute("mscui:controltype",this.controlType),t.setAttribute(O.a.ariaRoleAttribute,O.a.ariaPresentationRole),(n=C.a.createSelectableElement("input")).className="cui-spn-txtbx",n.id=this.id,n.setAttribute("role","spinbutton"),n.setAttribute("type","text"),n.setAttribute("autocomplete","off"),n.setAttribute("data-lpignore","true"),t.appendChild(n);var c=C.a.createElement("span");c.className="cui-spn-arwbx",t.appendChild(c),(i=C.a.createElement("span")).className="cui-spn-btnup",i.setAttribute(O.a.ariaHiddenAttribute,"true"),c.appendChild(i),(r=C.a.createElement("span")).className="cui-spn-btndown",r.setAttribute(O.a.ariaHiddenAttribute,"true"),c.appendChild(r),(a=C.a.createElement("img")).alt="",1===this.root.textDirection&&(n.style.direction="rtl"),s=this.isVisualRefreshEnabled?C.a.createClusteredImageContainerNew(2,this.root.properties.ImageUpArrow8by8,this.root.properties.ImageUpArrow8by8Class,a,!0,!1):C.a.createClusteredImageContainerNew(1,this.root.properties.ImageUpArrow,this.root.properties.ImageUpArrowClass,a,!0,!1),C.a.ensureCSSClassOnElement(s,"cui-spn-imgcnt"),i.appendChild(s),(o=C.a.createElement("img")).alt="",l=this.isVisualRefreshEnabled?C.a.createClusteredImageContainerNew(2,this.root.properties.ImageDownArrow8by8,this.root.properties.ImageDownArrow8by8Class,o,!0,!1):C.a.createClusteredImageContainerNew(1,this.root.properties.ImageDownArrow,this.root.properties.ImageDownArrowClass,o,!0,!1),C.a.ensureCSSClassOnElement(l,"cui-spn-imgcnt"),r.appendChild(l);var u=this.properties.Alt;se.c(u)||(n.title=u);var d=this.properties.Width;se.c(d)||(n.style.width=d);var p=new oe.a(e);p.elmControl=t,p.elmInput=n,p.elmUpArrow=i,p.elmDownArrow=r,p.elmUpArrowImage=a,p.elmDownArrowImage=o,p.elmUpArrowImageContainer=s,p.elmDownArrowImageContainer=l;var h=this.properties.LabelledBy;return se.c(h)||n.setAttribute("aria-labelledby",h),p},s.commitPendingChange=function(){this.behavior&&this.behavior.commitPendingChange()},s.constructClonedControl=function(e,t){return new i(e,this.id,t,this.validUnits,this.validSpecialStrings)},i.createUnit=function(e,t,n,i){return new ce(e,t,n,i)},r=i,(a=[{key:"spinnerDom",get:function(){return this._spinnerDom}},{key:"validUnits",get:function(){return this._validUnits}},{key:"validSpecialStrings",get:function(){return this._validSpecialStrings}},{key:"controlType",get:function(){return b.Control.spinnerControlType}},{key:"needsAKeytip",get:function(){return!0}},{key:"focusableElement",get:function(){return this.spinnerDom?this.spinnerDom.elmInput:null}},{key:"properties",get:function(){return this.controlProperties}},{key:"isEditable",get:function(){return!0}}])&&ue(r.prototype,a),o&&ue(r,o),i}(b.Control);Object(i.a)(de,"Spinner",b.Control,[]);var pe=n(11),he=n(250),me=function(){function e(){}var t=e.prototype;return t.buildControlDom=function(e,t){var n=new he.a(t);return this.populateControlDom(n,e,t),n},t.populateControlDom=function(t,n,i){var r,a,o,s=e.createTwoAnchorControlDOMElement(n,n.root,i,n.properties$2,!0,Object(pe.a)((function(){return r}),(function(e){return r=e})),Object(pe.a)((function(){return a}),(function(e){return a=e})),Object(pe.a)((function(){return o}),(function(e){return o=e})));$addHandler(o,"load",(function(){t.onImageLoad()})),t.elmControl=s,t.elmImage=o,t.elmButtonPart=r,t.elmMenuLauncherPart=a},e.createTwoAnchorControlDOMElement=function(e,t,n,i,r,a,o,s){var l=i.LabelText;se.c(l)&&(l="");var c=C.a.createElement("span");c.className="Large"===n?"cui-ctl-large":"Medium"===n?"cui-ctl cui-ctl-medium":"Medium20"===n?"cui-ctl cui-ctl-medium20 cui-ctl-medium":"cui-ctl cui-ctl-small",c.setAttribute("mscui:controltype",e.controlType),c.setAttribute("aria-expanded","false");var u=C.a.createNoOpLink(),d=C.a.createNoOpLink();u.className="cui-ctl-a1",d.className="cui-ctl-a2",c.setAttribute("role",e.ariaRole),O.a.setAriaAttribute(c,"aria-haspopup","true"),u.setAttribute("role","button"),d.setAttribute("role","button"),d.setAttribute("aria-expanded","false"),O.a.setAriaAttribute(d,"aria-haspopup","true");var p=C.a.createElement("span");p.className="cui-ctl-a1Internal",s.val=C.a.createElement("img");var h=null,m=null,g=0;s.val.alt="";var f=i.Alt;se.c(f)&&(f=l),c.title=f,("Medium"!==n&&"Medium20"!==n||f!==l)&&(u.title=f),"Large"===n&&f===l||(d.title=f),"Large"===n||"Menu32"===n?(h=i.Image32by32,m=i.Image32by32Class,g=5):"Medium20"===n?(h=i.Image20by20,m=i.Image20by20Class,g=13):(h=i.Image16by16,m=i.Image16by16Class,g=4);var v=C.a.createClusteredImageContainerNew(g,h,m,s.val,!0,!1),_=null;("Small"!==n&&"Small14"!==n||r)&&(_=C.a.createElement("span"),"Small"!==n&&"Small14"!==n&&("Large"===n?(C.a.ensureCSSClassOnElement(_,"cui-ctl-largelabel"),C.a.setLargeControlText(_,l,r)):"Medium"!==n&&"Medium20"!==n||(C.a.ensureCSSClassOnElement(_,"cui-ctl-mediumlabel"),_.innerText=l)));var y=null;if(r){var b=C.a.createElement("img");b.alt="",y=e.isVisualRefreshEnabled?C.a.createClusteredImageContainerNew(2,t.properties.ImageDownArrow8by8,t.properties.ImageDownArrow8by8Class,b,!0,!1):C.a.createClusteredImageContainerNew(1,t.properties.ImageDownArrow,t.properties.ImageDownArrowClass,b,!0,!1)}return c.appendChild(u),c.appendChild(d),u.appendChild(p),p.appendChild(v),se.c(_)||("Large"===n?d.appendChild(_):p.appendChild(_)),se.c(y)||("Large"===n?_.appendChild(y):d.appendChild(y)),c.tabIndex=0,u.tabIndex=-1,d.tabIndex=-1,a.val=u,o.val=d,c},e}();Object(i.a)(me,"SplitButtonDomStrategy",null,[]);var ge=n(181);function fe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ve=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).addDisplayMode("Large"),a.addDisplayMode("Medium"),a.addDisplayMode("Medium20"),a.addDisplayMode("Small"),a.addDisplayMode("Menu32"),a.addDisplayMode("Menu16"),a.addDisplayMode("Menu"),a.addDisplayMode("MenuTellMe"),a.on=!1,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.createComponentDomForDisplayMode=function(e){return(new me).buildControlDom(this,e)},s.forEachSplitButtonComponentDom=function(e){this.controlComponentDomCache.forEach((function(t){e(t)}))},s.onStateChanged=function(){this.setState(this.on&&this.enabled)},s.setState=function(e){var t=this;C.a.isTrue(this.properties$2.IsToggleSplit)&&this.forEachSplitButtonComponentDom((function(n){t.toggleCssClass(n,"cui-ctl-on",e)}))},s.toggleCssClass=function(e,t,n){C.a.toggleCSSClassOnElement(e.elmControl,t,n),C.a.toggleCSSClassOnElement(e.elmButtonPart,t,n),C.a.toggleCSSClassOnElement(e.elmMenuLauncherPart,t,n),this.updateAriaMenuLauncherPressedAttribute(e.elmControl,n),this.updateAriaMenuLauncherPressedAttribute(e.elmButtonPart,n)},s.updateAriaMenuLauncherPressedAttribute=function(e,t){O.a.setAriaAttribute(e,O.a.ariaPressedAttribute,t?O.a.ariaTrueValue:O.a.ariaFalseValue)},s.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},s.constructClonedMenuLauncherForMenu=function(e,t,n){return new f.FlyoutAnchor(e,this.id,t,n)},s.getDisplayedControlDom=function(){var e=this.displayedComponent;return e?this.controlComponentDomCache.get_item(e.displayMode):null},r=i,(a=[{key:"displayedButtonElement",get:function(){var e=this.getDisplayedControlDom();return e?e.elmButtonPart:null}},{key:"displayedButtonImageElement",get:function(){var e=this.getDisplayedControlDom();return e?e.elmImage:null}},{key:"controlType",get:function(){return b.Control.splitButtonControlType}},{key:"on",get:function(){return!!C.a.isTrue(this.properties$2.IsToggleSplit)&&this.stateProperties[ge.a.On]},set:function(e){C.a.isTrue(this.properties$2.IsToggleSplit)&&(this.stateProperties[ge.a.On]=e,this.setState(e&&this.enabled))}},{key:"properties$2",get:function(){return this.controlProperties}}])&&fe(r.prototype,a),o&&fe(r,o),i}(w.MenuLauncher);Object(i.a)(ve,"SplitButton",w.MenuLauncher,[]);var _e=n(19),ye=n(3);function be(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Se=function(){function e(){this.displayColor=null}var t,n,i,r=e.prototype;return r.iconColorChanged=function(e,t){return!(se.b(t)&&se.b(e)||t===e)},r.drawColorStrip=function(e,t){if(e){var n=e.getContext("2d");if(n)if(t)try{n.clearRect(this.colorStripLeft,this.colorStripTop,e.width,this.colorStripHeight),n.strokeStyle=this.noFillStrokeColor,n.strokeRect(this.colorStripLeft+this.colorStripAntiBlurStrokeOffset,this.colorStripTop+this.colorStripAntiBlurStrokeOffset,e.width-2*this.colorStripAntiBlurStrokeOffset,this.colorStripHeight-2*this.colorStripAntiBlurStrokeOffset)}catch(t){ye.ULS.sendTraceTag(40421404,207,15,String.format("IconColorManager.DrawColorStrip: a 2d context operation failed (clearRect or strokeRect) with element.Width='{0}'. Exception message: {1}",e.width,t.message))}else try{n.fillStyle=this.displayColor,n.fillRect(this.colorStripLeft,this.colorStripTop,e.width,this.colorStripHeight)}catch(t){ye.ULS.sendTraceTag(40421405,207,15,String.format("IconColorManager.DrawColorStrip: a 2d context fillRect operation failed with fillStyle='{0}' and element.Width='{1}'. Exception message: {2}",this.displayColor,e.width,t.message))}else ye.ULS.sendTraceTag(40421403,207,15,"IconColorManager.DrawColorStrip: element.GetContext did not return a 2d context. Bailing out...")}else ye.ULS.sendTraceTag(40421402,207,15,"IconColorManager.DrawColorStrip: CanvasElement is null. Bailing out...")},t=e,(n=[{key:"automaticDisplayColor",get:function(){return"Window"}},{key:"noFillStrokeColor",get:function(){return"WindowFrame"}},{key:"iconHeight",get:function(){return 16}},{key:"colorStripLeft",get:function(){return 0}},{key:"colorStripHeight",get:function(){return this.iconHeight/4}},{key:"colorStripTop",get:function(){return this.iconHeight-this.colorStripHeight}},{key:"colorStripAntiBlurStrokeOffset",get:function(){return.5}}])&&be(t.prototype,n),i&&be(t,i),e}();Object(i.a)(Se,"IconColorManager",null,[133]);var Ce=n(13);var Ae=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).elmCanvasPart=null,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(S.a);Object(i.a)(Ae,"StatefulColorFlyoutAnchorComponentDom",S.a,[]);var Ie=function(){function e(e){void 0===e&&(e=!0),this.hasArrow=e}var t=e.prototype;return t.buildControlDom=function(e,t){var n=new Ae(t);return n.elmControl=b.Control.createStandardControlDOMElement(e,e.root,t,e.controlProperties,this.hasArrow,Object(pe.a)((function(){return n.elmLabel}),(function(e){return n.elmLabel=e})),Object(pe.a)((function(){return n.elmImage}),(function(e){return n.elmImage=e})),Object(pe.a)((function(){return n.elmDescription}),(function(e){return n.elmDescription=e})),Object(pe.a)((function(){return n.elmIconContainer}),(function(e){return n.elmIconContainer=e}))),this.populateCanvasElement(n,t),n},t.populateCanvasElement=function(e,t){if(e.elmCanvasPart=null,6===b.Control.getControlSize(t))if(e.elmImage){var n=e.elmImage.parentNode,i=C.a.createElement("canvas");if(i){i.height=16,i.width=16;var r=i.getContext("2d");if(r)try{r.clearRect(0,0,i.width,i.height),n.appendChild(i),e.elmCanvasPart=i}catch(e){ye.ULS.sendTraceTag(40421410,207,15,String.format("StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: a 2d context operation of appending the canvas to StatefulColorFlyoutAnchorComponentDom.ElmImage failed. Exception message: {0}",e.message))}else ye.ULS.sendTraceTag(40421409,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: element.GetContext did not return a 2d context. Bailing out...")}else ye.ULS.sendTraceTag(40421408,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: Utility.CreateElement did not create a CanvasElement. Bailing out...")}else ye.ULS.sendTraceTag(40421407,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: StatefulColorFlyoutAnchorComponentDom.ElmImage is null. Bailing out...");else ye.ULS.sendTraceTag(40421406,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: Control.GetControlSize did not return ControlSize of Control16. Bailing out...")},e}();Object(i.a)(Ie,"StatefulColorFlyoutAnchorDomStrategy",null,[]);var we=function(){};function Te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}we.Color="Color",we.IntColor="IntColor",Object(i.a)(we,"IconColorCommandProperties",null,[]);var Ee=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).displayedButtonCanvasElement=null,a.iconColorManager=new Se,a.set_currentIconColor(a.properties$3.InitializationColor),a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.set_currentIconColor=function(e){this.stateProperties[we.Color]=e;var t=new RegExp("^-1$").test(e);return this.set_iconColorInt(t),this.iconColorManager.displayColor=t?this.iconColorManager.automaticDisplayColor:Ce.a.getRGBFromBGR(e),e},s.set_iconColorInt=function(e){return this.stateProperties[we.IntColor]=e,e},s.selectDropdownItem=function(e){var t=Object(_e.a)(b.Control,e);t&&this.iconColorManager.iconColorChanged(t.stateProperties.Color,this.currentIconColor)&&(se.b(t.stateProperties.Color)?this.set_currentIconColor(this.properties$3.DefaultColor):this.set_currentIconColor(t.stateProperties.Color),this.iconColorManager.drawColorStrip(this.displayedButtonCanvasElement,this.iconColorInt))},s.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},s.createComponentDomForDisplayMode=function(e){var t=(new Ie).buildControlDom(this,e);return this.populateControlDom(t,e),this.displayedButtonCanvasElement=t.elmCanvasPart,this.iconColorManager.drawColorStrip(this.displayedButtonCanvasElement,this.iconColorInt),t},r=i,(a=[{key:"properties$3",get:function(){return this.controlProperties}},{key:"currentIconColor",get:function(){return this.stateProperties[we.Color]}},{key:"iconColorInt",get:function(){return this.stateProperties[we.IntColor]}},{key:"controlType",get:function(){return b.Control.statefulColorFlyoutAnchorControlType}}])&&Te(r.prototype,a),o&&Te(r,o),i}(f.FlyoutAnchor);Object(i.a)(Ee,"StatefulColorFlyoutAnchor",f.FlyoutAnchor,[119]);var ke=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).elmCanvasPart=null,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.internalImageLoadHandler=function(){var e=this.elmCanvasPart.getContext("2d");if(e){try{e.drawImage(this.elmImage,-this.elmImage.offsetLeft,-this.elmImage.offsetTop,this.elmCanvasPart.width,12,0,0,this.elmCanvasPart.width,12)}catch(e){return ye.ULS.sendTraceTag(39986015,207,15,String.format("StatefulColorSplitButtonComponentDom.InternalImageLoadHandler: a 2d context drawImage operation failed. Exception message: {0}",e.message)),void this.setDefaultImageDisplay()}this.setDefaultImageDisplay("none")}else ye.ULS.sendTraceTag(39986014,207,15,"StatefulColorSplitButtonComponentDom.InternalImageLoadHandler: ElmCanvasPart.GetContext did not return a 2d context. Bailing out...")},r.setDefaultImageDisplay=function(e){void 0===e&&(e="");try{this.elmImage&&this.elmImage.style&&this.elmImage.style.display!==e&&(this.elmImage.style.display=e)}catch(t){ye.ULS.sendTraceTag(39986016,207,15,String.format("StatefulColorSplitButtonComponentDom.SetDefualtImangeDisplay: ElmImage.Style.Display = {0} failed. Exception message: {1}",e,t.message))}},i}(he.a);Object(i.a)(ke,"StatefulColorSplitButtonComponentDom",he.a,[]);var Me=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.buildControlDom=function(e,t){var n=new ke(t);return this.populateControlDom(n,e,t),this.populateCanvasElement(n,t),n},r.populateCanvasElement=function(e,t){e.elmCanvasPart=null;var n=b.Control.getControlSize(t);if(ye.ULS.shipAssertTag(22315809,207,6===n,"Stateful color split button is implemented for 16X16px icons"),6===n){var i=e.elmImage.parentNode,r=C.a.createElement("canvas");if(!r)return ye.ULS.sendTraceTag(39986017,207,15,"StatefulColorSplitButtonComponentDom.PopulateCanvasElement: failed to create a canvas element. Bailing out..."),void e.setDefaultImageDisplay();r.height=16,r.width=16;var a=r.getContext("2d");if(!a)return ye.ULS.sendTraceTag(39986018,207,15,"StatefulColorSplitButtonComponentDom.PopulateCanvasElement: element.GetContext did not return a 2d context. Bailing out..."),void e.setDefaultImageDisplay();try{a.clearRect(0,0,r.width,r.height),i.appendChild(r),e.elmCanvasPart=r}catch(t){ye.ULS.sendTraceTag(39986019,207,15,String.format("StatefulColorSplitButtonComponentDom.PopulateCanvasElement: a 2d context ClearRect operation failed with element.Width='{0}', element.Height='{1}'. Exception message: {2}",r.width,r.height,t.message)),e.setDefaultImageDisplay()}}},i}(me);function Pe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(Me,"StatefulColorSplitButtonDomStrategy",me,[]);var Fe=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).iconColorManager=new Se,a.set_currentIconColor(a.statefulColorSplitButtonProperties.InitializationColor),a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.set_currentIconColor=function(e){this.stateProperties[we.Color]=e;var t=new RegExp("^-1$").test(e);return this.set_iconColorInt(t),this.iconColorManager.displayColor=t?this.iconColorManager.automaticDisplayColor:Ce.a.getRGBFromBGR(e),e},s.set_iconColorInt=function(e){return this.stateProperties[we.IntColor]=e,e},s.selectDropdownItem=function(e){var t=Object(_e.a)(b.Control,e);t&&this.iconColorManager.iconColorChanged(t.stateProperties.Color,this.currentIconColor)&&(se.b(t.stateProperties.Color)?this.set_currentIconColor(this.statefulColorSplitButtonProperties.DefaultColor):this.set_currentIconColor(t.stateProperties.Color),this.iconColorManager.drawColorStrip(this.displayedButtonCanvasElement,this.iconColorInt))},s.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},s.constructClonedMenuLauncherForMenu=function(e,t,n){return new f.FlyoutAnchor(e,this.id,t,n)},s.createComponentDomForDisplayMode=function(e){var t=(new Me).buildControlDom(this,e);return this.iconColorManager.drawColorStrip(t.elmCanvasPart,this.iconColorInt),t},r=i,(a=[{key:"statefulColorSplitButtonProperties",get:function(){return this.controlProperties}},{key:"currentIconColor",get:function(){return this.stateProperties[we.Color]}},{key:"iconColorInt",get:function(){return this.stateProperties[we.IntColor]}},{key:"displayedButtonCanvasElement",get:function(){var e=this.getDisplayedControlDom();return e?e.elmCanvasPart:null}},{key:"controlType",get:function(){return b.Control.statefulColorSplitButtonControlType}}])&&Pe(r.prototype,a),o&&Pe(r,o),i}(ve);Object(i.a)(Fe,"StatefulColorSplitButton",ve,[119]);var De=function(){};function Oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}De.MenuItemIdKey="MenuItemId",De.ImageClassKey="ImageClass",Object(i.a)(De,"StatefulImageSplitButtonCommandProperties",null,[]);var Re=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).recentMenuItemId=a.statefulImageSplitButtonProperties.DefaultMenuItemId,a.recentImageClass=a.statefulImageSplitButtonProperties.DefaultImageClass,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.selectDropdownItem=function(e){this.recentMenuItemId=e.getMenuItemId(),this.setRecentRecentImageClass(i.getCssClassName(e))&&this.updateDOM()},s.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},s.constructClonedMenuLauncherForMenu=function(e,t,n){return new f.FlyoutAnchor(e,this.id,t,n)},s.setRecentRecentImageClass=function(e){var t=this.recentImageClass;return(!se.b(t)||!se.b(e))&&(t!==e&&(se.b(e)&&(e=this.statefulImageSplitButtonProperties.DefaultImageClass),this.recentImageClass=e,!0))},s.updateDOM=function(){var e=this.displayedButtonImageElement;e&&(e.className=this.recentImageClass)},i.getCssClassName=function(e){var t=Object(_e.a)(b.Control,e);if(!t)return"";var n=b.Control.getControlSize(t.displayMode);return ye.ULS.shipAssertTag(34961356,207,6===n,"Stateful button is implemented for 16X16px icons"),6!==n?"":t.controlProperties.Image16by16Class},r=i,(a=[{key:"statefulImageSplitButtonProperties",get:function(){return this.controlProperties}},{key:"recentMenuItemId",get:function(){return this.stateProperties[De.MenuItemIdKey]},set:function(e){this.stateProperties[De.MenuItemIdKey]=e}},{key:"recentImageClass",get:function(){return this.stateProperties[De.ImageClassKey]},set:function(e){this.stateProperties[De.ImageClassKey]=e}},{key:"controlType",get:function(){return b.Control.statefulImageSplitButtonControlType}}])&&Oe(r.prototype,a),o&&Oe(r,o),i}(ve);Object(i.a)(Re,"StatefulImageSplitButton",ve,[]);var xe=n(77),Ue=n(140),Be=n(277);function Le(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ne=function(e){var t,n,i,r,a;function o(){var t;return(t=e.call(this)||this)._focusableElement=null,t}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.prototype.buildControlDom=function(e,t){var n=e.controlProperties,i=C.a.createElement("span");Sys.UI.DomElement.addCssClass(i,"cui-btn-menu-description"),Sys.UI.DomElement.addCssClass(i,"cui-menusection-diagnostics-textbox"),Sys.UI.DomElement.addCssClass(i,"UIFont");var r=n.ControlCss;se.c(r)||(i.style.cssText=r);var a=C.a.createElement("label");Sys.UI.DomElement.addCssClass(a,"UIFontBold"),Sys.UI.DomElement.addCssClass(a,"cui-menusection-diagnostics-textboxlabel"),a.setAttribute("for",e.id),a.id=e.id+"-label",a.appendChild(document.createTextNode(n.LabelText||""));var s=a.id,l=n.AdditionalLabelBy;se.c(l)||(s+=" "+l);var c=o.createTextBox(e.id,s);return i.appendChild(a),i.appendChild(c),this._focusableElement=c,Object.assign(new Be.a(t,i,this),{elmInput:c,elmLabel:a,isEditable:!1})},o.createTextBox=function(e,t){var n=document.createElement("textarea");return n.id=e,n.rows=1,l.a.isIPad||(n.readOnly=!0),n.setAttribute(O.a.ariaLabelledByAttribute,t),n.setAttribute(O.a.ariaMultilineAttribute,O.a.ariaFalseValue),n.setAttribute(O.a.ariaReadOnlyAttribute,O.a.ariaTrueValue),n.setAttribute(O.a.ariaRoleAttribute,O.a.ariaTextboxAttribute),Sys.UI.DomElement.addCssClass(n,Ue.a.allowBrowserContextMenu),Sys.UI.DomElement.addCssClass(n,"UIFont"),n},i=o,(r=[{key:"focusableElement",get:function(){return this._focusableElement}}])&&Le(i.prototype,r),a&&Le(i,a),o}(xe.a);function He(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(Ne,"DiagnosticsItemTextBoxDomStrategy",xe.a,[]);var We=function(e){var t,n,i,r,a;function o(){var t;return(t=e.call(this)||this)._focusableElement=null,t}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.prototype.buildControlDom=function(e,t){var n=e.controlProperties,i=C.a.createElement("span");i.className="cui-tb",i.setAttribute("mscui:controltype",e.controlType),i.setAttribute(O.a.ariaRoleAttribute,O.a.ariaPresentationRole),C.a.isTrue(n.IsStretchedHorizontally)&&C.a.ensureCSSClassOnElement(i,"stretchedHorizontally");var r=o.createLabelElement(e,t);i.appendChild(r);var a=o.createInputElement(e,t);return i.appendChild(a),this._focusableElement=a,Object.assign(new Be.a(t,i),{elmInput:a,elmLabel:r,isEditable:!0,isMultiline:C.a.isTrue(n.IsMultiline)})},o.createLabelElement=function(e,t){var n=e.controlProperties,i=C.a.createElement("span"),r=n.LabelText||"";"Small"===t?C.a.ensureCSSClassOnElement(i,"cui-ctl-smalllabel"):"Large"===t?C.a.ensureCSSClassOnElement(i,"cui-ctl-largelabel"):C.a.ensureCSSClassOnElement(i,"cui-ctl-mediumlabel"),i.id="lbl"+e.id+"-"+t,i.innerText=r;var a=n.LabelCss;return se.b(a)||(i.style.cssText=a),i},o.createInputElement=function(e,t){var n,i=e.controlProperties;C.a.isTrue(i.IsMultiline)?((n=C.a.createSelectableElement("textarea")).setAttribute("aria-multiline","true"),n.className="cui-txtbx",C.a.ensureCSSClassOnElement(n,"cui-txtbx-multiline")):((n=C.a.createSelectableElement("input")).setAttribute("aria-multiline","false"),n.setAttribute("data-lpignore","true"),n.className="cui-txtbx"),n.id=e.id,n.setAttribute("type","text"),n.setAttribute("role","textbox"),n.setAttribute("autocomplete","off"),C.a.isTrue(i.IsStretchedHorizontally)&&C.a.ensureCSSClassOnElement(n,"stretchedHorizontally");var r=i.Height;se.c(r)||(n.style.height=r);var a=i.Width;se.c(a)||(n.style.width=a);var o="lbl"+e.id+"-"+t,s=i.AdditionalLabelBy;se.c(s)?n.setAttribute("aria-labelledby",o):n.setAttribute("aria-labelledby",s+" "+o);var l=i.MaxLength;se.c(l)||n.setAttribute("maxlength",l);var c=i.PlaceholderText;return se.c(c)||n.setAttribute("placeholder",c),n},i=o,(r=[{key:"focusableElement",get:function(){return this._focusableElement}}])&&He(i.prototype,r),a&&He(i,a),o}(xe.a);function je(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(We,"StandardTextBoxDomStrategy",xe.a,[]);var Ve=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i)||this)._textBoxDom=null,r._focusableElement=null,r.addDisplayMode("Medium"),r.addDisplayMode("MenuDiagnostics"),r.behavior&&r.behavior.initialize(),r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.createComponentDomForDisplayMode=function(e){var t=i.getDomElementCreationStrategy(e);return this._textBoxDom=t.buildControlDom(this,e),this._focusableElement=t.focusableElement,this.textBoxDom},s.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,this.textBoxDom.elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)},s.commitPendingChange=function(){this.behavior&&this.behavior.commitPendingChange()},s.constructClonedControl=function(e,t){return new i(e,this.id,t)},i.getDomElementCreationStrategy=function(e){switch(e){case"MenuDiagnostics":return new Ne;default:return new We}},r=i,(a=[{key:"textBoxDom",get:function(){return this._textBoxDom}},{key:"controlType",get:function(){return b.Control.textBoxControlType}},{key:"focusableElement",get:function(){return this._focusableElement}},{key:"isEditable",get:function(){return!!this.textBoxDom&&this.textBoxDom.isEditable}}])&&je(r.prototype,a),o&&je(r,o),i}(b.Control);Object(i.a)(Ve,"TextBox",b.Control,[88]);var Ke=n(341),ze=n(12),qe=n(180),Ge=n(342),Qe=n(141);function Ze(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"Builder",(function(){return $e}));var $e=function(){function e(e,t,n,i){this.root=null,this.inQuery=!1,this.dataSource=null,this._options=e,se.c(this.options.trimmedIds)&&(this.options.trimmedIds={}),this._elmPlaceholder=t,this._buildClientTask=n,this.__resizableContainer=i||new s.a,$addHandler(window,"unload",Object(r.d)(this,this.onUnload,"onUnload"))}var t,n,i,b=e.prototype;return b.onUnload=function(e){this.dispose()},b.onRootBuilt=function(e){},b.dispose=function(){this.root=null,this._options=null,this._elmPlaceholder=null,this._buildClientTask=null,this.dataSource=null,$removeHandler(window,"unload",Object(r.d)(this,this.onUnload,"onUnload"))},b.isIdTrimmed=function(e){return!!this.options&&this.options.trimmedIds[e]},b.isNodeTrimmed=function(e){var t=ze.a.getNodeAttribute(e,ze.a.id);return this.options.trimmedIds[t]},b.buildControl=function(t,n){var i=null,r=t[ze.a.NAME];switch(r){case ze.a.button:i=this.buildButton(t,n);break;case ze.a.colorPicker:i=this.buildColorPicker(t,n);break;case ze.a.comboBox:i=this.buildComboBox(t,n);break;case ze.a.dropDown:i=this.buildDropDown(t,n);break;case ze.a.flyoutAnchor:i=this.buildFlyoutAnchor(t,n);break;case ze.a.galleryButton:i=this.buildGalleryButton(t,n,null);break;case ze.a.insertTable:e._insertTableBuilder&&(i=e._insertTableBuilder(t,n,this.root));break;case ze.a.label:i=this.buildLabel(t,n);break;case ze.a.placeholder:i=this.buildPlaceholder(t,n);break;case ze.a.searchBox:i=this.buildSearchBox(t,n);break;case ze.a.separator:i=this.buildSeparator(t,n);break;case ze.a.slider:i=e.buildSlider(t,n,this.root);break;case ze.a.spinner:a.AFrameworkApplication.activeFrame&&a.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&(e._spinnerBuilder||e.enableSpinner()),e._spinnerBuilder&&(i=e._spinnerBuilder(t,n,this.root));break;case ze.a.splitButton:i=this.buildSplitButton(t,n);break;case ze.a.statefulColorFlyoutAnchor:i=this.buildStatefulColorFlyoutAnchor(t,n);break;case ze.a.statefulColorSplitButton:i=this.buildStatefulColorSplitButton(t,n);break;case ze.a.statefulImageSplitButton:i=this.buildStatefulImageSplitButton(t,n);break;case ze.a.textBox:i=e.buildTextBox(t,n,this.root);break;case ze.a.toggleButton:i=this.buildToggleButton(t,n);break;case ze.a.clonedControl:i=this.buildClonedControl(t,n);break;default:var o=t[ze.a.ATTRIBUTES][ze.a.CLASSNAME];if(se.c(o))throw Error.create("Unable to create Control with tagname: "+r)}return se.c(n.parentId)||(i.stateProperties.ParentMenuId=n.parentId),i},b.buildMenu=function(e,t,n){if(void 0===n&&(n=!1),this.isNodeTrimmed(e))return null;var i=e[ze.a.ATTRIBUTES],r=this.root.createMenu(i[ze.a.id],i[ze.a.TITLE],i[ze.a.DESCRIPTION],i[ze.a.MAXWIDTH],n,"2"===i[ze.a.HORIZONTALALIGNMENT]?2:1);return this.fillMenu(r,e,t),r},b.buildMenuForFlyoutAnchor=function(t,n){var i=ze.a.getNodeChildren(t),r=null,a=t[ze.a.ATTRIBUTES];return n.parentId=a.Id,e.shouldBuildMenu(a,i)&&(r=this.buildMenu(i[0],n)),n.parentId=null,r},b.fillMenu=function(e,t,n){for(var i=ze.a.getNodeChildren(t),r=i.length,a=null,o=0;o<r;o++){var s=(a=i[o])[ze.a.NAME];if(s===ze.a.MENUSECTION){if(!this.isNodeTrimmed(a)){var l=this.buildMenuSection(a,n,e);e.addChild(l)}}else ye.ULS.sendTraceTag(8402819,201,10,"Tags with the name: {0} cannot be children of Menu tags.",s)}},b.buildMenuSection=function(e,t,n){var i=e[ze.a.ATTRIBUTES],r={},a=i[ze.a.id],o=i[ze.a.TITLE],s=i[ze.a.DESCRIPTION];r.DisplayMode=i[ze.a.DISPLAYMODE],r.MaxHeight=i[ze.a.MAXHEIGHT],r.Image=i[ze.a.IMAGE],r.ImageClass=i[ze.a.IMAGECLASS],r.Theme=i[ze.a.THEME],r.TitleId=i[ze.a.TITLEID],r.Language=i[ze.a.LANGUAGE],r.ArialabelledbyId=i[ze.a.ARIALABELLEDBYID],se.c(r.DisplayMode)&&(r.DisplayMode="Menu"),r.ShowSeperator=(!C.a.isFalse(i[ze.a.SHOWMENUSECTIONSEPERATOR])).toString(),r.ShowTitleIcon=(!C.a.isFalse(i[ze.a.SHOWMENUSECTIONTITLEICON])).toString(),r.ShowTitleBackground=(!C.a.isFalse(i[ze.a.SHOWMENUSECTIONTITLEBACKGROUND])).toString(),r.TitleFocusable=(!C.a.isFalse(i[ze.a.MENUSECTIONTITLEFOCUSABLE])).toString(),r.Scrollable=C.a.isTrue(i[ze.a.SCROLLABLE]).toString(),r.Loading=C.a.isTrue(i[ze.a.LOADING]).toString();var l=this.root.createMenuSection(a,o,s,r,n),c=ze.a.getNodeName(ze.a.getNodeChildren(e)[0]);if(c===ze.a.CONTROLS){for(var u=ze.a.getNodeChildren(ze.a.getNodeChildren(e)[0]),d=u.length,p=null,h=0;h<d;h++)if(p=u[h],!this.isNodeTrimmed(p)){var m=this.buildControl(p,t);m&&l.addChild(m.createComponentForDisplayMode(r.DisplayMode))}}else if(c===ze.a.GALLERY){var g=this.buildGallery(ze.a.getNodeChildren(e)[0],t,!0);l.addChild(g)}return l},b.buildGallery=function(e,t,n){for(var i=e[ze.a.ATTRIBUTES],r=e[ze.a.ATTRIBUTES],a=this.root.createGallery(r.Id,i[ze.a.TITLE],i[ze.a.DESCRIPTION],r),o=n?"Menu":"Default",s=ze.a.getNodeChildren(e),l=s.length,c=null,u=0;u<l;u++)if(c=s[u],!this.isNodeTrimmed(c)){var d=void 0;switch(ze.a.getNodeName(c)){case ze.a.galleryButton:d=this.buildGalleryButton(c,t,r.ElementDimensions);break;default:d=this.buildControl(c,t)}d&&a.addChild(d.createComponentForDisplayMode(o))}return a},b.buildGalleryButton=function(e,t,n){var i;se.b(n)&&(n=e[ze.a.ATTRIBUTES][ze.a.ELEMENTDIMENSIONS]);i=se.b(n)?3:qe.a.convertStringToGalleryElementDimensions(n);var r=e[ze.a.ATTRIBUTES],a=new v.GalleryButton(this.root,r.Id,r,i);return se.c(t.parentId)||(a.stateProperties.ParentMenuId=t.parentId),a},b.buildToggleButton=function(e,t){var n=e[ze.a.ATTRIBUTES];return new Ke.a(this.root,n.Id,n)},b.buildColorPicker=function(e,t){for(var n=e[ze.a.ATTRIBUTES],i=ze.a.getNodeChildren(ze.a.getFirstChildNodeWithName(e,ze.a.colors)),r=new Array(i.length),a=i.length,o=0;o<a;o++){var s=new p,l=ze.a.getNodeAttributes(i[o]),c=l[ze.a.TITLE];s.Title=se.c(c)?l[ze.a.ALT]:c,s.Color=l[ze.a.COLOR],s.DisplayColor=l[ze.a.DISPLAYCOLOR],r[o]=s}return new h.ColorPicker(this.root,n.Id,n,r)},b.buildSearchBox=function(t,n){var i=t[ze.a.ATTRIBUTES],r=ze.a.getNodeChildren(t),a=null;return e.shouldBuildMenu(i,r)&&(a=this.buildMenu(r[0],n)),new ee(this.root,i.Id,i,a)},b.buildComboBox=function(t,n,i){var r=t[ze.a.ATTRIBUTES],a=ze.a.getNodeChildren(t),o=null,s=t[ze.a.ATTRIBUTES],l=null;if(e.shouldBuildMenu(s,a)){o=this.buildMenu(a[0],n,!0),l={};for(var c=ze.a.getNodeChildren(a[0]),u=c.length,d=0;d<u;d++)for(var p=ze.a.getNodeChildren(c[d]),h=ze.a.getNodeChildren(p[0]),g=h.length,f=0;f<g;f++){var v=h[f][ze.a.ATTRIBUTES],_=v[ze.a.LABELTEXT],y=v[ze.a.MENUITEMID];l[_]=y}}var b=i?i(this.root,r.Id,r,o):new m.a(this.root,r.Id,r,o);return b.menuItems=l,b},b.buildDropDown=function(t,n){var i=t[ze.a.ATTRIBUTES],r=ze.a.getNodeChildren(t),a=null,o=t[ze.a.ATTRIBUTES];return e.shouldBuildMenu(o,r)&&(a=this.buildMenu(r[0],n)),new g.a(this.root,i.Id,i,a)},b.buildButton=function(e,t){var n=e[ze.a.ATTRIBUTES];return new d.a(this.root,n.Id,n)},b.buildSplitButton=function(t,n){var i=t[ze.a.ATTRIBUTES],r=ze.a.getNodeChildren(t),a=null;return e.shouldBuildMenu(i,r)&&(a=this.buildMenu(r[0],n)),new ve(this.root,i.Id,i,a)},b.buildStatefulColorSplitButton=function(t,n){var i=t[ze.a.ATTRIBUTES],r=ze.a.getNodeChildren(t),a=null;return e.shouldBuildMenu(i,r)&&(a=this.buildMenu(r[0],n)),new Fe(this.root,i.Id,i,a)},b.buildStatefulImageSplitButton=function(t,n){var i=t[ze.a.ATTRIBUTES],r=ze.a.getNodeChildren(t),a=null;return e.shouldBuildMenu(i,r)&&(a=this.buildMenu(r[0],n)),new Re(this.root,i.Id,i,a)},b.buildFlyoutAnchor=function(e,t){var n=e[ze.a.ATTRIBUTES],i=this.buildMenuForFlyoutAnchor(e,t);return new f.FlyoutAnchor(this.root,n.Id,n,i)},b.buildStatefulColorFlyoutAnchor=function(e,t){var n=e[ze.a.ATTRIBUTES],i=this.buildMenuForFlyoutAnchor(e,t);return new Ee(this.root,n.Id,n,i)},b.buildLabel=function(e,t){var n=e[ze.a.ATTRIBUTES];return new y.a(this.root,n.Id,n)},b.buildPlaceholder=function(e,t){var n=e[ze.a.ATTRIBUTES];return new I(this.root,n.Id,n)},b.buildSeparator=function(e,t){var n=e[ze.a.ATTRIBUTES];return new ne(this.root,n.Id,n)},b.convertNodeValueToInt=function(e){return"string"==typeof e?parseInt(e):e},b.buildClonedControl=function(e,t){var n=e[ze.a.ATTRIBUTES],i=Object(r.c)(Ge.a,t)&&t.cloneControlsForMenu,a=Qe.a.instance.getFirstValidControl(n.Id);return a&&(a=i?a.cloneForMenu(this.root,n):a.clone(this.root,n)),a},e.enableSlider=function(){e._sliderBuilder=e.buildSlider},e.enableSpinner=function(){e._spinnerBuilder=e.buildSpinner},e.enableInsertTable=function(){e._insertTableBuilder=e.buildInsertTable},e.buildInsertTable=function(e,t,n){var i=e[ze.a.ATTRIBUTES];return new _.a(n,i.Id,i)},e.buildSlider=function(e,t,n){var i=e[ze.a.ATTRIBUTES];return new ae(n,i.Id,i)},e.buildSpinner=function(t,n,i){var r=t[ze.a.ATTRIBUTES],a=e.buildSpinnerChildren(t);return new de(i,r.Id,r,a.units,a.specialTextStrings)},e.convertNodeValueToFloat=function(e){return"string"==typeof e?parseFloat(e):e},e.buildSpinnerChildren=function(t){for(var n=ze.a.getNodeChildren(t),i=[],r=[],a=n.length,o=0;o<a;o++){var s=n[o],l=ze.a.getNodeName(s),d=ze.a.getNodeAttributes(s);if(l===ze.a.UNIT){var p=de.createUnit(c.a(d[ze.a.UNITTYPE]),e.convertNodeValueToFloat(d[ze.a.MINIMUMVALUE]),e.convertNodeValueToFloat(d[ze.a.MAXIMUMVALUE]),e.convertNodeValueToFloat(d[ze.a.STEP]));Array.add(i,p)}else l===ze.a.SPECIALTEXTSTRINGS&&Array.add(r,d[ze.a.VALUE])}return new u(i,r)},e.buildTextBox=function(e,t,n){var i=e[ze.a.ATTRIBUTES];return new Ve(n,i.Id,i)},e.convertXMLStringToJSON=function(t){var n=null;if(l.a.isInternetExplorer8){var i=null;(i=document.createElement("xml")).innerText=t,document.body.appendChild(i),n=i.XMLDocument,document.body.removeChild(i)}else n=Sys.Net.XMLDOM(t);return se.c(n)||se.c(n.documentElement)?(ye.ULS.sendTraceTag(4523028,201,50,"Failure in ConvertXMLStringToJSON"),null):e.convertXMLToJSON(n)},e.convertXMLToJSON=function(t){return Object(r.a)("("+e.convertNodeToJSON(t.documentElement)+")")},e.convertNodeToJSON=function(t){var n;n="{",n+='"name" : ',n+=o.c(t.nodeName),n+=",",n+='"attrs": {';var i=t.attributes;if(!se.c(t.attributes)){var r=i.length;if(r>0)for(var a=!0,s=0;s<r;s++){var l=i.item(s);a?a=!1:n+=",",n+=o.c(l.name),n+=":",C.a.isEncodedStringArray(l.value)?n+=o.c(C.a.decodeStringArrayXmlAttribute(l.value)):n+=o.c(l.value)}}n+="}";var c=t.childNodes;if(c){var u=c.length;if(u>0){n+=",",n+="children:[";for(var d=!0,p=0;p<u;p++){var h=c[p];"#text"!==h.nodeName&&(d?d=!1:n+=",",n+=e.convertNodeToJSON(h))}n+="]"}}return n+="}"},e.shouldBuildMenu=function(e,t){return!!t[0]&&(!C.a.isTrue(e.PopulateDynamically)||C.a.isTrue(e.AllowDefaultContent))},t=e,(n=[{key:"_resizableContainer",get:function(){return this.__resizableContainer}},{key:"buildClientTask",get:function(){return this._buildClientTask}},{key:"placeholder",get:function(){return this._elmPlaceholder}},{key:"options",get:function(){return this._options}}])&&Ze(t.prototype,n),i&&Ze(t,i),e}();$e._sliderBuilder=null,$e._spinnerBuilder=null,$e._insertTableBuilder=null,Object(i.a)($e,"Builder",null,[4])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a}));var i=function(e,t,n){return e.endsWith(t)},r=function(e,t,n){return e.startsWith(t)},a=function(e){return e.toUpperCase()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};Object(i.a)(r,"ADebugTab",null,[4])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(1),a=function(){function e(){}return e.setExecuteState=function(t){e._notifyStateElement||(e._notifyStateElement=document.createElement("div"),e._notifyStateElement.id="WacExecuteState",e._notifyStateElement.style.display="none",document.body.appendChild(e._notifyStateElement)),e._notifyStateElement.innerText=t},e.verifyExecuteState=function(){return r.AFrameworkApplication.theTaskManager.isYielding?(e.setExecuteState("Blocked"),!1):(e.setExecuteState("Allowed"),!0)},e.ignoreExecuteState=function(){e.setExecuteState("Ignore")},e.getExecuteState=function(){r.AFrameworkApplication.theTaskManager.isYielding?e.setExecuteState("InProgress"):e.setExecuteState("Complete")},e.calcActionId=function(e){for(var t=5381,n=t,i=e.length,r=0;r<i&&(t=4294967295&((t<<5)+t^e.charCodeAt(r)),r!==i-1);r+=2)n=4294967295&((n<<5)+n^e.charCodeAt(r+1));var a=t+35685*n+(23896*n<<16)&4294967295;return a<0&&(a+=4294967296),a},e}();a._notifyStateElement=null,Object(i.a)(a,"ObjectModelUtils",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(45),a=function(){};a.LabelText=r.a.labelText,a.Alt=r.a.alt,a.Image16by16Class=r.a.image16by16Class,a.Image32by32Class=r.a.image32by32Class,a.Image48by48Class=r.a.image48by48Class,a.Visible=r.a.visible,a.HasPopup="HasPopup",Object(i.a)(a,"ButtonCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.businessBarFocusID="businessBar",r.conflictBusinessBarID="bbCfl",r.versionsBusinessBarID="bbVer",r._businessBarLinkClass="WACBusinessBarLink",Object(i.a)(r,"BusinessBarConstants",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"QueryStringBuilder",(function(){return o}));var i=n(0),r=(n(9),n(27)),a=n(13),o=function(){function e(e){this._queryString=e,this._first=-1===e.indexOf("?")}var t=e.prototype;return t.getParam=function(e){return r.a.getParameterValueDecoded(this._queryString,e)},t.addParam=function(e,t){this.addFullParam(a.a.urlKeyValueEncode(e)+"="+a.a.urlKeyValueEncode(t))},t.addOrReplaceParam=function(e,t){this._queryString=r.a.addOrReplaceParameterValue(this._queryString,a.a.urlKeyValueEncode(e),t?a.a.urlKeyValueEncode(t):null)},t.addFullParam=function(e){this._queryString+=(this._first?"?":"&")+e,this._first=!1},t.addOrReplaceFullParam=function(e){var t=e.split("=");if(2===t.length){var n=t[0],i=t[1];this._queryString=r.a.addOrReplaceParameterValue(this._queryString,n,i)}},t.toString=function(){return this._queryString},e}();Object(i.a)(o,"QueryStringBuilder",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e,t){this.scrollTop=e,this.scrollLeft=t};Object(i.a)(r,"ScrollData",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(1),o=n(67),s=(n(9),n(55)),l=n(4),c=n(25),u=n(97),d=n(66),p=function(){this.message=null,this.messageTitle=null,this.firstActionButtonProps=null,this.secondActionButtonProps=null,this.isMultiline=!1,this.messageBarType=0,this.closeable=!1,this.onDismiss=null,this.dismissButtonAriaLabel=null,this.linkProps=null};Object(i.a)(p,"MessageBarProps",null,[]);var h=function(e,t){this.type=null,this.label=null,this.onExecute=null,this.label=e,this.type="AppButtonProps",this.onExecute=t};Object(i.a)(h,"AppButtonProps",null,[]);var m=n(86),g=n(157),f=n(7),v=n(122),_=n(8),y=n(3);function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return S}));var S=function(){function e(e,t,n){this._title=null,this._message=null,this._closeable=!1,this._imageAltText="",this._image=0,this._imageHolder=null,this._titleParagraph=null,this._bodyParagraph=null,this._titleAndBodyHolder=null,this._buttonOne=null,this._buttonOneHolder=null,this._buttonTwo=null,this._buttonTwoHolder=null,this._linkHolder=null,this._link=null,this._closeIconHolder=null,this._closeAnchor=null,this._closeIconElement=null,this._buttonOneUsed=!1,this._buttonTwoUsed=!1,this._buttonOneText="",this._buttonOneScreenReaderText="",this._buttonOneDismissesEntry=!1,this._buttonTwoText="",this._buttonTwoScreenReaderText="",this._buttonTwoDismissesEntry=!1,this._buttonOneHandler=null,this._buttonTwoHandler=null,this._linkUsed=!1,this._linkText="",this._linkHref="",this._linkHandler=null,this._invokeWithContextMenu=!1,this._isContextMenuHandlerSet=!1,this._reactMessageBarAPI=null,this.businessBar=null,this._htmlElement=null,this.imagePath=null,this.closeHandler=null,this.containerID=null,this.errorCode=0,this.visible=!1,this.title=e,this.message=t,this.invokeHandler=n,this.id=0,this.image=1}var t,n,i,S=e.prototype;return S.addButton=function(e,t,n,i){void 0===i&&(i=!1),this._buttonOneText=e,this._buttonOneHandler=t,this._buttonOneUsed=!0,this._buttonOneScreenReaderText=n,this._buttonOneDismissesEntry=i},S.addSecondButton=function(e,t,n,i){void 0===i&&(i=!1),this._buttonTwoText=e,this._buttonTwoHandler=t,this._buttonTwoUsed=!0,this._buttonTwoScreenReaderText=n,this._buttonTwoDismissesEntry=i},S.addLink=function(e,t){this._linkText=e,this._linkHref=t,this._linkUsed=!0},S.addLinkWithHandler=function(e,t){this._linkText=e,this._linkHandler=t,this._linkUsed=!0},S.createReactEntryElement=function(){var t=this;this._htmlElement=document.createElement("div"),this.htmlElement.className=String.format("{0} {1}",e._businessBarClass,e._reactBusinessBarClass),this.htmlElement.setAttribute("UNSELECTABLE","on"),void 0!==this.containerID&&null!==this.containerID&&(this.htmlElement.id=this.containerID);var n=this;return o.a.get_instance().executeWhen(7,(function(){m.UISurfaces.getMessageBarAPIAsync().then((function(e){t.businessBar.isReactBusinessBarStoreInitialized||(e.initializeMessageBarInStore(),t.businessBar.isReactBusinessBarStoreInitialized=!0);var i,a,o=Object.assign(new p,{message:t._message,messageTitle:t._title,isMultiline:!1,messageBarType:5});if((t._closeable&&(o.closeable=!0,o.dismissButtonAriaLabel=CommonUIStrings.l_DialogClose,o.onDismiss=function(){t.closeReactBusinessBar(n)}),t._linkUsed)&&(o.linkProps=((a={}).type="AppLinkProps",a.text=t._linkText,a.handler=((i={}).href=t._linkHref,i.target="_blank",i),a),t._linkHandler)){var s=Object(r.d)(t,t.onMessageBarLinkClicked,"onMessageBarLinkClicked");o.linkProps.handler=s}return t._buttonOneUsed&&(o.firstActionButtonProps=new h(t._buttonOneText,(function(){t.buttonOneReactClickHandler(n)}))),t._buttonTwoUsed&&(o.secondActionButtonProps=new h(t._buttonTwoText,(function(){t.buttonTwoReactClickHandler(n)}))),e.createNewMessageBar(t.htmlElement,o),t._reactMessageBarAPI=e,null})).catch((function(e){return y.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API"),null}))})),this.htmlElement},S.createElement=function(){if(a.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings"),this.reactBusinessBarIsEnabled)return this.createReactEntryElement();if(this._htmlElement=document.createElement("div"),this.htmlElement.className=e._businessBarClass,this.htmlElement.setAttribute("UNSELECTABLE","on"),void 0!==this.containerID&&null!==this.containerID&&(this.htmlElement.id=this.containerID),this._imageHolder=null,this._image){this._imageHolder=document.createElement("span"),this._imageHolder.className="WACBusinessBarIcon",this.htmlElement.appendChild(this._imageHolder);var t=null,n=null;switch(this._image){case 2:t=e._errorIconName,n=CommonUIStrings.l_DialogError;break;case 1:t=e._warningIconName,n=CommonUIStrings.l_DialogWarning;break;case 3:t=e._infoIconName,n=CommonUIStrings.l_DialogInfo;break;case 4:t=this.imagePath,n=this._imageAltText;break;default:0}this._imageHolder.title=n,this._imageHolder.setAttribute(f.a.ariaRoleAttribute,f.a.ariaImageRole),this._imageHolder.appendChild(s.createClusteredImage(24,24,t,e._imageClass,!0,""))}var i=v.a.create().toString();this._titleAndBodyHolder=document.createElement("div"),this._titleAndBodyHolder.id="BBTitleAndBody"+i,this._titleAndBodyHolder.className=e._businessBarTitleBodyHolderClass,this._titleAndBodyHolder.tabIndex=0,this._titleAndBodyHolder.setAttribute(f.a.ariaRoleAttribute,f.a.ariaGroupRole),this._title&&(this._titleParagraph=document.createElement("p"),this._titleParagraph.innerText=this._title,this._titleParagraph.className=e._businessBarTitleClass+" UIFontBold",this._titleParagraph.id="BBTitle"+i,this._titleParagraph.setAttribute("UNSELECTABLE","on"),this._titleAndBodyHolder.setAttribute(f.a.ariaLabelledByAttribute,this._titleParagraph.id),this._titleAndBodyHolder.appendChild(this._titleParagraph)),this._bodyParagraph=document.createElement("p"),this._bodyParagraph.className=e._businessBarBodyClass,this._bodyParagraph.innerText=this._message,this._bodyParagraph.id="BBBody"+i,this._bodyParagraph.setAttribute("UNSELECTABLE","on"),this._bodyParagraph.style.width="100%",this._titleAndBodyHolder.setAttribute(f.a.ariaDescribedByAttribute,this._bodyParagraph.id),this._buttonOneUsed&&this.addContentAvailableOnlyToScreenReader(this._bodyParagraph,this._buttonOneScreenReaderText),this._buttonTwoUsed&&this.addContentAvailableOnlyToScreenReader(this._bodyParagraph,this._buttonTwoScreenReaderText),this._titleAndBodyHolder.appendChild(this._bodyParagraph);var o=document.createElement("div");return o.setAttribute(f.a.ariaRoleAttribute,f.a.ariaAlertRole),o.appendChild(this._titleAndBodyHolder),this.htmlElement.appendChild(o),this._buttonOneUsed&&(this._buttonOneHolder=document.createElement("span"),this._buttonOne=document.createElement("button"),this.createButton(this._buttonOneHolder,this._buttonOne,this._buttonOneText,Object(r.d)(this,this.buttonOneClickHandler,"buttonOneClickHandler"))),this._buttonTwoUsed&&(this._buttonTwoHolder=document.createElement("span"),this._buttonTwo=document.createElement("button"),this.createButton(this._buttonTwoHolder,this._buttonTwo,this._buttonTwoText,Object(r.d)(this,this.buttonTwoClickHandler,"buttonTwoClickHandler"))),this._linkUsed&&(this._linkHolder=document.createElement("span"),this._linkHolder.className=e._businessBarLinkHolderClass,this._link=document.createElement("a"),this._link.className=g.a._businessBarLinkClass,this._link.innerText=this._linkText,this._linkHandler?(this._link.tabIndex=0,a.AFrameworkApplication.activeFrame.theClickInputManager.registerHandlerWithData(l.EventNames.click,this._link,Object(r.d)(this,this.linkClickHandler,"linkClickHandler"),this),a.AFrameworkApplication.activeFrame.theKeyInputManager.registerHandlerWithData(l.EventNames.keyUp,this._link,Object(r.d)(this,this.onLinkKeyUp,"onLinkKeyUp"),this)):(this._link.href=this._linkHref,this._link.target="_blank"),this._linkHolder.appendChild(this._link),this.htmlElement.appendChild(this._linkHolder)),a.AFrameworkApplication.activeFrame.theClickInputManager.registerHandler(l.EventNames.click,this.htmlElement,Object(r.d)(this,this.onClick,"onClick")),a.AFrameworkApplication.activeFrame.theKeyInputManager.registerHandlerWithData(l.EventNames.keyUp,this._titleAndBodyHolder,Object(r.d)(this,this.onBodyKeyUp,"onBodyKeyUp"),this),this._invokeWithContextMenu&&!this._isContextMenuHandlerSet&&(a.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,Object(r.d)(this,this.onClick,"onClick"),null),this._isContextMenuHandlerSet=!0),this._closeable&&(this._closeIconHolder=document.createElement("span"),this._closeIconHolder.className=e._closeHolderClass,this._closeAnchor=document.createElement("a"),this._closeAnchor.className=e._closeIconClass,this._closeAnchor.tabIndex=0,this._closeAnchor.title=CommonUIStrings.l_DialogClose,this._closeAnchor.setAttribute(f.a.ariaRoleAttribute,f.a.ariaButtonRole),this._closeIconElement=s.createClusteredImage(16,16,e._closeIconFileName,"",!0,""),this._closeAnchor.appendChild(this._closeIconElement),this._closeIconHolder.style.display="table-cell",this._closeIconHolder.appendChild(this._closeAnchor),this.htmlElement.appendChild(this._closeIconHolder),a.AFrameworkApplication.activeFrame.theClickInputManager.registerHandlerWithData(l.EventNames.click,this._closeAnchor,Object(r.d)(this,this.onCloseClick,"onCloseClick"),this),a.AFrameworkApplication.activeFrame.theKeyInputManager.registerHandlerWithData(l.EventNames.keyUp,this._closeAnchor,Object(r.d)(this,this.onCloseKeyUp,"onCloseKeyUp"),this)),this.htmlElement},S.showEntryForScreenReader=function(){this._titleAndBodyHolder&&this._titleAndBodyHolder.setAttribute(f.a.ariaHiddenAttribute,f.a.ariaFalseValue)},S.addContentAvailableOnlyToScreenReader=function(t,n){var i;n&&""!==n&&((i=document.createElement("span")).className=e._screenReaderOnlyClass,i.innerText=n,t.appendChild(i))},S.createButton=function(t,n,i,r){t.className=e._businessBarButtonHolderClass,n.setAttribute("type","button"),n.className=e._businessBarButtonClass,n.innerText=i,t.appendChild(n),this.htmlElement.appendChild(t),a.AFrameworkApplication.activeFrame.theClickInputManager.registerHandlerWithData(l.EventNames.click,n,r,this)},S.resizeToFit=function(){this.reactBusinessBarIsEnabled||(this._titleAndBodyHolder.style.whiteSpace="nowrap",this.closeable?this._closeIconHolder.style.width="auto":this._linkUsed?this._linkHolder.style.width="auto":this._buttonTwoUsed?this._buttonTwoHolder.style.width="auto":this._buttonOneUsed?this._buttonOneHolder.style.width="auto":this._titleAndBodyHolder.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this._titleAndBodyHolder.style.whiteSpace="normal":this.closeable?this._closeIconHolder.style.width="100%":this._linkUsed?this._linkHolder.style.width="100%":this._buttonTwoUsed?this._buttonTwoHolder.style.width="100%":this._buttonOneUsed?this._buttonOneHolder.style.width="100%":this._titleAndBodyHolder.style.width="100%")},S.ulsLogTelemetryInfo=function(e,t){if(d.a.oldActionsPipelineIsEnabled()){var n={};n.WacSessionId=a.AFrameworkApplication.userSessionId,n.ActionName="BusinessBar"+e,n.InputMethod=t,y.ULS.sendTraceTag(35489761,207,50,JSON.stringify(n))}},S.logTelemetryInfo=function(e,t,n,i){this.ulsLogTelemetryInfo(e,n),d.a.isUserActionLoggingToOtelEnabled()&&u.c(t,!0,u.e,i,10)},S.buttonOneClickHandler=function(e){return this._buttonOneHandler(e.userData),this.logTelemetryInfo("ButtonOne",_.a.businessBarButtonOne,"Mouse",2),this._buttonOneDismissesEntry&&(this.logTelemetryInfo("Close",_.a.businessBarClose,"Mouse_ButtonOne",2),this.close(e)),!0},S.buttonOneReactClickHandler=function(e){return this._buttonOneHandler(e),this.logTelemetryInfo("ButtonOne",_.a.businessBarButtonOne,"Mouse",2),this._buttonOneDismissesEntry&&(this.logTelemetryInfo("Close",_.a.businessBarClose,"Mouse_ButtonOne",2),this.closeReactBusinessBar(e)),!0},S.buttonTwoClickHandler=function(e){return this._buttonTwoHandler(e.userData),this.logTelemetryInfo("ButtonTwo",_.a.businessBarButtonTwo,"Mouse",2),this._buttonTwoDismissesEntry&&(this.logTelemetryInfo("Close",_.a.businessBarClose,"Mouse_ButtonTwo",2),this.close(e)),!0},S.buttonTwoReactClickHandler=function(e){return this._buttonTwoHandler(e),this.logTelemetryInfo("ButtonTwo",_.a.businessBarButtonTwo,"Mouse",2),this._buttonTwoDismissesEntry&&(this.logTelemetryInfo("Close",_.a.businessBarClose,"Mouse_ButtonTwo",2),this.closeReactBusinessBar(e)),!0},S.linkClickHandler=function(e){return this._linkHandler(e.userData),this.logTelemetryInfo("Link",_.a.businessBarLink,"Mouse",2),!0},S.onMessageBarLinkClicked=function(e){this._linkHandler(null)},S.onLinkKeyUp=function(e){return e.innerEvent.keyCode===c.a.vK_Enter&&!e.innerEvent.altKey&&(this._linkHandler(e.userData),this.logTelemetryInfo("Link",_.a.businessBarLink,"Keyboard",1),!0)},S.onBodyKeyUp=function(e){return!(e.innerEvent.keyCode!==c.a.vK_Enter||e.innerEvent.altKey||!this.invokeHandler)&&(this.invokeHandler(e.userData,e),this.logTelemetryInfo("Invoke",_.a.businessBarInvoke,"Keyboard",1),!0)},S.dispose=function(){this.htmlElement&&(a.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(l.EventNames.click,this.htmlElement,Object(r.d)(this,this.onClick,"onClick")),this._isContextMenuHandlerSet&&a.AFrameworkApplication.activeFrame.theContextMenuInputManager.unregisterHandler(this.htmlElement,Object(r.d)(this,this.onClick,"onClick"))),this._closeAnchor&&(a.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(l.EventNames.click,this._closeAnchor,Object(r.d)(this,this.onCloseClick,"onCloseClick")),a.AFrameworkApplication.activeFrame.theKeyInputManager.unregisterHandler(l.EventNames.keyUp,this._closeAnchor,Object(r.d)(this,this.onCloseKeyUp,"onCloseKeyUp"))),this._buttonOne&&a.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(l.EventNames.click,this._buttonOne,Object(r.d)(this,this.buttonOneClickHandler,"buttonOneClickHandler")),this._buttonTwo&&a.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(l.EventNames.click,this._buttonTwo,Object(r.d)(this,this.buttonTwoClickHandler,"buttonTwoClickHandler")),this._link&&this._linkHandler&&(a.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(l.EventNames.click,this._link,Object(r.d)(this,this.linkClickHandler,"linkClickHandler")),a.AFrameworkApplication.activeFrame.theKeyInputManager.unregisterHandler(l.EventNames.keyUp,this._link,Object(r.d)(this,this.onLinkKeyUp,"onLinkKeyUp"))),this._titleAndBodyHolder&&a.AFrameworkApplication.activeFrame.theKeyInputManager.unregisterHandler(l.EventNames.keyUp,this._titleAndBodyHolder,Object(r.d)(this,this.onBodyKeyUp,"onBodyKeyUp")),this._imageAltText=null,this._imageHolder=null,this._titleParagraph=null,this._htmlElement=null,this._bodyParagraph=null,this._titleAndBodyHolder=null,this._buttonOne=null,this._buttonOneHolder=null,this._buttonTwo=null,this._buttonTwoHolder=null,this._link=null,this._linkHolder=null,this._closeIconElement=null,this._closeIconHolder=null,this._closeAnchor=null,this.businessBar=null},S.onClick=function(e){return this.logTelemetryInfo("Invoke",_.a.businessBarInvoke,"Mouse",2),!!this.invokeHandler&&this.invokeHandler(this,e)},S.onCloseClick=function(e){return this.logTelemetryInfo("Close",_.a.businessBarClose,"Mouse",2),this.close(e),!0},S.onCloseKeyUp=function(e){return e.innerEvent.keyCode===c.a.vK_Enter&&!e.innerEvent.altKey&&(this.logTelemetryInfo("Close",_.a.businessBarClose,"Keyboard",1),this.close(e),!0)},S.close=function(e){var t=e.userData;this.businessBar.removeEntry(t),this.invokeCloseHandler(t,e.inputSource)},S.invokeCloseHandler=function(e,t){if(e.closeHandler){var n=a.AFrameworkApplication.theActionManager;n.commandLocation=10,n.invocationMethod=t,e.closeHandler(e),n.commandLocation=0,n.invocationMethod=0}},S.closeReactBusinessBar=function(e){e&&this.businessBar&&(this.businessBar.removeEntry(e),this.invokeCloseHandler(e,0))},t=e,(n=[{key:"htmlElement",get:function(){return this._htmlElement}},{key:"title",get:function(){return this._title},set:function(e){this._title!==e&&(this._title=e,this._titleParagraph&&(this._titleParagraph.innerText=this._title))}},{key:"message",get:function(){return this._message},set:function(e){this._message!==e&&(this._message=e,this._bodyParagraph&&(this._bodyParagraph.innerText=this._message))}},{key:"image",get:function(){return this._image},set:function(e){this._image=e,4!==this._image&&(this.imagePath="")}},{key:"imageAltText",get:function(){return this._imageAltText},set:function(e){this._imageAltText=e}},{key:"closeable",get:function(){return this._closeable},set:function(e){this._closeable!==e&&(this._closeable=e,this._closeIconHolder&&(this._closeIconHolder.style.display=this._closeable?"table-cell":"none"))}},{key:"reactBusinessBarIsEnabled",get:function(){return a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactBusinessBarIsEnabled")}},{key:"invokeActionIsContextMenu",get:function(){return this._invokeWithContextMenu},set:function(e){this._invokeWithContextMenu=e,this.htmlElement&&(this._invokeWithContextMenu&&!this._isContextMenuHandlerSet?(a.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,Object(r.d)(this,this.onClick,"onClick"),null),this._isContextMenuHandlerSet=!0):!this._invokeWithContextMenu&&this._isContextMenuHandlerSet&&(a.AFrameworkApplication.activeFrame.theContextMenuInputManager.unregisterHandler(this.htmlElement,Object(r.d)(this,this.onClick,"onClick")),this._isContextMenuHandlerSet=!1))}},{key:"getPointForContextMenu",get:function(){var e=Sys.UI.DomElement.getBounds(this.htmlElement);return new Sys.UI.Point(e.x,e.y)}}])&&b(t.prototype,n),i&&b(t,i),e}();S._businessBarClass="WACBusinessBarEntry",S._businessBarTitleClass="WACBusinessBarTitle",S._businessBarBodyClass="WACBusinessBarBody",S._businessBarTitleBodyHolderClass="WACBusinessBarTitleBodyHolder",S._businessBarButtonHolderClass="WACBusinessBarButtonHolder",S._businessBarButtonClass="WACBusinessBarButton",S._businessBarLinkHolderClass="WACBusinessBarLinkHolder",S._closeIconClass="WACBusinessBarClose",S._closeHolderClass="WACBusinessBarCloseHolder",S._closeIconFileName="BusinessBarClose_16x16x32",S._imageClass="WACBusinessBarImage",S._screenReaderOnlyClass="WACScreenReaderOnly",S._errorIconName="CancelRequest_24x24x32",S._warningIconName="Risks_24x24x32",S._infoIconName="Info_24x24x32",S._reactBusinessBarClass="ReactBusinessBarEntry",S._margin=30,S.linkMargin=20,Object(i.a)(S,"BusinessBarEntry",null,[5,4])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(65),o=n(278),s=n(12),l=n(64),c=n(5);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(e){var t,n;function i(t,n,i,r,a){var o;return void 0===r&&(r=""),void 0===a&&(a=!0),(o=e.call(this,t,n,"","",null,a)||this)._align=i,o._height=r,o}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,o,s,d=i.prototype;return d.refreshInternal=function(){this.ensureDOMElementAndEmpty(),c.c(this._height)||(this.elementInternal.style.height=this._height),this.appendChildrenToElement(this.elementInternal),e.prototype.refreshInternal.call(this)},d.ensureCorrectChildType=function(e){if(!Object(r.c)(l.a,e))throw Error.create("Only children of type ControlComponent can be added to Row Components.")},a=i,(o=[{key:"domElementTagName",get:function(){return"span"}},{key:"cssClass",get:function(){var e="";switch(this.parent.type){case 2:e+="cui-row-onerow";break;case 3:e+="cui-row-tworow";break;case 4:e+="cui-row-threerow";break;default:e+="cui-row"}return 2===this._align&&(e+=" textAlignRight"),e}}])&&u(a.prototype,o),s&&u(a,s),i}(a.a);Object(i.a)(d,"Row",a.a,[]);var p=n(6);function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return m}));var m=function(e){var t,n;function i(t,n,i,r,a,o,l,u,p,h,m){var g;void 0===o&&(o=!1),void 0===l&&(l=!1),void 0===u&&(u=null),void 0===p&&(p=""),void 0===h&&(h=1),void 0===m&&(m=!0),(g=e.call(this,t,n,p,"",null,m)||this)._type=i,g._verticalAlignment=r,g._horizontalAlignment=a,g._stretchedHorizontally=o,g._arrangement=h,g._showSectionSeparator=l;var f=0;switch(i){case 4:f=3;break;case 3:f=2;break;case 2:f=1;break;case 5:case 1:break;default:throw Error.create("Invalid SectionType")}for(var v=0;v<f;v++){var _=n+"-"+v,y=1,b="";if(u){var S=new s.a(u[v]);c.c(S.attributes[s.a.id])||(_=S.attributes[s.a.id]),S.attributes[s.a.TEXTALIGN]===s.a.RIGHTALIGN&&(y=2),c.c(S.attributes[s.a.HEIGHT])||(b=S.attributes[s.a.HEIGHT])}g.addChildInternal(new d(t,_,y,b,m),!1)}return g}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,l,u,m=i.prototype;return m.refreshInternal=function(){if(this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.elementInternal),this.ensureDOMElement(),1!==this.type&&5!==this.type){var e=this.children;this.appendRow(e,1),3!==this.type&&4!==this.type||this.appendRow(e,2),4===this.type&&this.appendRow(e,3)}this.dirty=!1},m.appendRow=function(e,t){var n=e.get_item(t-1);n.ensureDOMElement(),2===this.type&&n.children.count>0&&Object(r.c)(o.GalleryButton,n.children.get_item(0).control)&&p.a.ensureCSSClassOnElement(n.elementInternal,"cui-inRibbonGallery"),p.a.ensureCSSClassOnElement(n.elementInternal,"cui-row-"+t),this.root.supportsInvisibleControls&&!n.visible||this.elementInternal.appendChild(n.elementInternal),n.ensureRefreshed()},m.removeChild=function(e){throw Error.create("Cannot directly add and remove children from Section Components")},m.addChildAtIndex=function(e,t){throw Error.create("Cannot directly add and remove children from Section Components")},m.getRow=function(e){switch(this._type){case 4:if(e<1||e>3)throw Error.create("This Section type only has Row numbers 1, 2 and 3.");break;case 3:if(e<1||e>2)throw Error.create("This Section type only has Row numbers 1 and 2");break;case 2:if(1!==e)throw Error.create("This Section type only has Row number 1.");break;case 5:default:throw Error.create("This Section type does not have any rows")}return this.children.get_item(e-1)},m.ensureDOMElement=function(){if(c.c(this.elementInternal)){if(1===this.type){var t=p.a.createElement("span");return t.className="cui-section-divider",this._showSectionSeparator&&(t.className+=" cui-section-divider-separator"),void(this.elementInternal=t)}e.prototype.ensureDOMElement.call(this)}},m.ensureCorrectChildType=function(e){var t=this.children.count;if(2===this.type&&t>0||3===this.type&&t>1||4===this.type&&t>2)throw Error.create("No more children can be added to a Section of this type.");if(1===this.type)throw Error.create("Cannot add child components to Divider Section types.");if(!Object(r.c)(d,e))throw Error.create("Only children of type Row can be added to Section Components.")},a=i,(l=[{key:"verticalAlignment",get:function(){return this._verticalAlignment}},{key:"horizontalAlignment",get:function(){return this._horizontalAlignment}},{key:"stretchedHorizontally",get:function(){return this._stretchedHorizontally}},{key:"arrangement",get:function(){return this._arrangement}},{key:"cssClass",get:function(){var e=null;return e=2===this.verticalAlignment?"cui-section-alignmiddle":"cui-section",2===this.horizontalAlignment&&(e+=" alignRight"),this.stretchedHorizontally&&(e+=" stretchedHorizontally"),2===this.arrangement&&(e+=" verticalArrange"),e}},{key:"type",get:function(){return this._type}},{key:"domElementTagName",get:function(){return"span"}}])&&h(a.prototype,l),u&&h(a,u),i}(a.a);Object(i.a)(m,"Section",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n(0),r=n(2),a=n(19),o=n(11),s=n(65),l=n(1),c=(n(9),n(7)),u=n(180),d=n(82),p=n(5),h=n(6);function m(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v=function(e){var t,i;function s(t,n,i,r,a,o){var s;return(s=e.call(this,t,n,i,r)||this)._focusedIndex=-1,s._elmWrapper=null,s._elmTitle=null,s._elmItems=null,s._isInComboboxListbox=!1,s._separator=null,s._properties=a||{},s._menuContext=o,s}i=e,(t=s).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var g,v,_,y=s.prototype;return y.refreshInternal=function(){var e=this;this.ensureDOMElementAndEmpty();var t=h.a.isTrue(this._properties.Loading),i=!p.c(this.title),r=!h.a.isFalse(this._properties.ShowSeperator);if(!i&&r&&(this._separator=h.a.createElement("span"),this.separator.className="cui-menusection-separator",this.separator.setAttribute("role","separator"),this.elementInternal.appendChild(this.separator)),this._elmWrapper=h.a.createElement("div"),this._elmWrapper.className="cui-menusection",this._properties.Language&&this._elmWrapper.setAttribute("lang",this._properties.Language),this.elementInternal.appendChild(this._elmWrapper),i&&this.buildTitleForSection(this._elmWrapper,this.title,Object(o.a)((function(){return e._elmTitle}),(function(t){return e._elmTitle=t}))),l.AFrameworkApplication.isMobileMode&&(this._elmWrapper.style.fontSize="10pt"),t){var s=h.a.createElement("img");s.alt="",s.src=this.root.properties.ImageSpinner,s.className="cui-ctl-spinner ",this._elmWrapper.appendChild(s)}else{this._elmItems=h.a.createElement("ul"),this._elmItems.className="cui-menusection-items","Menu16DescriptionEnabled"===this._properties.DisplayMode?(this._elmItems.setAttribute(c.a.ariaLabelledByAttribute,this._properties.ArialabelledbyId),this._elmItems.setAttribute(c.a.ariaRoleAttribute,c.a.ariaGroupRole)):this._elmItems.setAttribute(c.a.ariaRoleAttribute,c.a.ariaMenuRole);var u=this.parent,d=Object(a.a)(n(87).Menu,u);"Menu32"!==this._properties.DisplayMode&&"Menu48"!==this._properties.DisplayMode||d&&h.a.ensureCSSClassOnElement(u.elementInternal,"cui-menu-large"),d&&(this._isInComboboxListbox=d.isComboboxListbox),h.a.isTrue(this._properties.Scrollable)&&(this._elmItems.style.overflowY="auto",this._elmItems.style.position="relative"),p.b(this._properties.MaxHeight)||(this._elmItems.style.maxHeight=this._properties.MaxHeight),this._elmWrapper.appendChild(this._elmItems),this.appendChildrenToElement(this._elmItems)}},y.buildTitleForSection=function(e,t,n){var i;i=this.inContextMenu?this.createTitleForContextMenuSection(t,n):n.val=this.createTextualTitleForSection("div",t),e.appendChild(i)},y.createTitleForContextMenuSection=function(e,t){var n=h.a.createElement("li");n.className="cui-menusection-items cui-menusection-contextmenu-title",!h.a.isFalse(this._properties.ShowTitleBackground)||(n.style.background="transparent");var i=!h.a.isFalse(this._properties.TitleFocusable),r=s.createOuterElement("cui-ctl-menu cui-ctl-menu16",i);if(!h.a.isFalse(this._properties.ShowTitleIcon)){var a=this.createIconBlock(this._properties.Image,this._properties.ImageClass);r.appendChild(a)}var o=t.val=this.createTextualTitleForSection("span",e);r.appendChild(o),n.appendChild(r);var l=h.a.createElement("ul");return l.className="cui-menusection-items",l.appendChild(n),l},y.createIconBlock=function(e,t){var n=h.a.createElement("span");if(n.className="cui-ctl-iconContainer",e&&t){var i=h.a.createElement("img");i.alt="";var r=h.a.createClusteredImageContainerNew(4,e,t,i,!0,!1);n.appendChild(r)}return n},y.createTextualTitleForSection=function(e,t){var i=n(123).Jewel,a=h.a.createElement(e);a.innerText=t;var o="cui-menusection-title-empty",s=c.a.ariaPresentationRole;return this._properties.TitleId&&a.setAttribute("id",this._properties.TitleId),p.b(t)||(o=(this.inContextMenu?"cui-ctl-mediumlabel":"cui-menusection-title")+("Light"===this._properties.Theme?" cui-menusection-title-lightBackground":Object(r.c)(i,this.root)?"":" UIFontBold"),s=c.a.ariaHeadingRole),a.className=o,a.setAttribute(c.a.ariaRoleAttribute,s),a},y.appendChildrenToElement=function(e){var t,i=n(116).FlyoutAnchor,o=!0,s=this.selectableItemsCount,l=0,u=0,p="",g=!1;this._menuContext&&(s=this._menuContext.selectableItemsCount,l=this._menuContext.getSectionSelectableStartIndex(this));for(var f,v=m(this.children);!(f=v()).done;){var _=f.value;(t=h.a.createElement("li")).className="cui-menusection-items",t.setAttribute(c.a.ariaRoleAttribute,c.a.ariaPresentationRole),o&&(h.a.ensureCSSClassOnElement(t,"cui-menusection-firstitem"),o=!1),_.ensureDOMElement();var y=Object(a.a)(d.a,_);(!y||y.control&&Object(r.c)(88,y.control))&&(_.elementInternal.setAttribute(c.a.ariaPosInSetAttribute,l+ ++u),_.elementInternal.setAttribute(c.a.ariaSetSizeAttribute,s),this._properties.TitleId&&_.elementInternal.setAttribute(c.a.ariaDescribedByAttribute,this._properties.TitleId)),this._isInComboboxListbox?_.elementInternal.setAttribute(c.a.ariaRoleAttribute,c.a.ariaOptionRole):(!y||y.control&&Object(r.c)(i,y.control)&&y.control.useCheckMark)&&t.setAttribute(c.a.ariaRoleAttribute,c.a.ariaGroupRole),t.appendChild(_.elementInternal),g||(g=!!(p=_.elementInternal.getAttribute(c.a.ariaRoleAttribute))&&p===c.a.ariaTabRole),e.appendChild(t),_.ensureRefreshed()}g&&e.setAttribute(c.a.ariaRoleAttribute,c.a.ariaTabListRole)},y.updateFocusedIndex=function(e){for(var t,n=0,i=m(this.children);!(t=i()).done;){if(t.value.updateFocusedIndex(e))return this._focusedIndex=n,!0;n++}return!1},y.resetFocusedIndex=function(){if(this.children.count){this._focusedIndex=-1;for(var e,t=m(this.children);!(e=t()).done;){e.value.resetFocusedIndex()}}},y.focusNext=function(e){var t=this.children.count;return!(t<=0)&&(!!this.moveFocusFromIndex(this._focusedIndex,e)||(this._focusedIndex>=0&&this._focusedIndex<t&&this.children.get_item(this._focusedIndex).resetFocusedIndex(),this._focusedIndex=-1,!1))},y.moveFocusFromIndex=function(e,t){var n=this.children.count,i=!t||4===t||6===t;-1===e&&(e=i?0:n-1);for(var r=e,a=this.children.getEnumeratorAtPos(r);i?a.moveNext():a.movePrevious();){if(a.get_current().focusNext(t))return this._focusedIndex>=0&&this._focusedIndex<n&&this._focusedIndex!==r&&this.children.get_item(this._focusedIndex).resetFocusedIndex(),this._focusedIndex=r,!0;r+=i?1:-1}return!1},y.ensureCorrectChildType=function(e){if(!Object(r.c)(d.a,e)&&!Object(r.c)(u.a,e))throw Error.create("MenuSections can only have children of type MenuItem or Gallery.")},y.setTitleImmediate=function(e){this.titleInternal=e,this._elmTitle.innerText=e},y.dispose=function(){e.prototype.dispose.call(this),this._separator=null,this._elmItems=null,this._elmTitle=null,this._elmWrapper=null},y.clone=function(e){for(var t,n=e.createMenuSection(this.id,this.title,this.description,this._properties,this._menuContext),i=m(this.children);!(t=i()).done;){var a=t.value;if(Object(r.c)(d.a,a)){var o=a.control.clone(e);n.addChild(o.createComponentForDisplayMode(this._properties.DisplayMode))}else Object(r.c)(u.a,a)&&n.addChild(a.clone(e))}return n},s.createOuterElement=function(e,t){void 0===t&&(t=!0);var n=h.a.createNoOpLink(t);return n.className=e,n},g=s,(v=[{key:"inContextMenu",get:function(){var e=n(393).ContextMenuRoot;return Object(r.c)(e,this.root)&&("Menu16"===this._properties.DisplayMode||"Menu16DescriptionEnabled"===this._properties.DisplayMode)}},{key:"domElementTagName",get:function(){return"div"}},{key:"selectableItemsCount",get:function(){for(var e,t=0,n=m(this.children);!(e=n()).done;){var i=e.value;if(Object(r.c)(d.a,i)){var o=Object(a.a)(d.a,i);o.control&&Object(r.c)(88,o.control)&&t++}else t++}return t}},{key:"separator",get:function(){return this._separator}},{key:"titleElement",get:function(){return this._elmTitle}}])&&f(g.prototype,v),_&&f(g,_),s}(s.a);Object(i.a)(v,"MenuSection",s.a,[])},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var i=function(e){return Error.invalidOperation(e)},r=function(e,t){return void 0===t&&(t=null),Error.argument(t,e)}},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(3);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){this._members=[]}var t,n,i,r=e.prototype;return r.shouldSuppressError=function(e,t,n,i,r,o,s){for(var l=0;l<this._members.length;l++){var c=this._members[l];if(c.shouldSuppressError(e,t,n,i,r,o,s))return a.ULS.sendTraceTag(39978438,306,50,"Error is suppressed by {0}",Object.getType(c).getName()),!0}return!1},r.register=function(e){a.ULS.sendTraceTag(39978439,306,50,"Register {0} as IAppStateConsistencyManager",Object.getType(e).getName()),Array.add(this._members,e)},r.dispose=function(){Array.clear(this._members)},t=e,i=[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}],(n=null)&&o(t.prototype,n),i&&o(t,i),e}();s._instance=null,Object(i.a)(s,"AppStateConsistencyHandler",null,[4]);var l=n(232),c=n(292),u=n(43),d=n(40),p=n(9),h=n(24),m=n(17),g=n(58);var f=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.prepareDialog=function(){this.overlayCss=this.overlayCss+" WACDialogOverlayUnhandledError",e.prototype.prepareDialog.call(this),Sys.UI.DomElement.addCssClass(this._divMessageBox,"WACDialogUnhandledError")},i}(g.StandardDialog);Object(i.a)(f,"CrashDialog",g.StandardDialog,[]);var v=n(102),_=n(27),y=n(16),b=n(13),S=n(21),C=n(8),A=n(63),I=n(49),w=n(196),T=n(186),E=n(282);function k(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function P(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return F}));var F=function(){function e(){this._suppressedErrorsReported=[],this.callStack=null,this._pageManager=null,this._seenHealthWorkerError=!1,this._seenOtelError=!1,this._seenSkypeError=!1,this._seenResizeObserverError=!1,this._knownHostnamesRegExp=null,this._additionalErrorsRegExp=null,this._ignoreInCallstackRegExp=null,this._otelErrorsSuppressionEnabled=!1,this._healthWorkerErrorsRegExp=null,this._otelErrorsRegExp=null,this._skypeErrorsRegExp=null,this._pagePath=null,this._onErrorDelegate=null,this._javascriptErrorReporter=null,this._javascriptErrorReporterFactory=null,this._seenError=!1,this._preventDuplicateBsqmErrors=!1}var t,i,o,g=e.prototype;return g.init=function(t,n,i,r){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=!1),this.initSuppressRegularExpressions(t,d.a.pagePath);var o=t.WebServiceBase,s=t.BrowserWatsonUrl;s&&(this._javascriptErrorReporter=this.initializeJavascriptErrorReporter(s,o,n,i,r)),a.ULS.sendTraceTag(38401684,306,50,"Suppress ResizeObserverError: {0}",e.suppressResizeObserverErrorIsEnabled)},g.initializeJavascriptErrorReporter=function(e,t,i,r,a){var o=n(1).AFrameworkApplication;return t&&-1===e.indexOf("/")&&(e=t+e),this.javascriptErrorReporterFactory.build(e,o.buildVersion,i,r,a)},g.initSuppressRegularExpressions=function(e,t){this._pagePath=t.toLowerCase(),this._ignoreInCallstackRegExp=e.BrowserWatsonCallstackErrorsToIgnoreRegExp,this.appendHostNameRuleToRegExp(_.a.getHostname(e.StaticContentHost)),this.appendHostNameRuleToRegExp(_.a.getHostname(e.SharedStaticContentHost)),this.appendHostNameRuleToRegExp(_.a.getHostname(e.OneNoteOreoCDNUrl)),this.appendHostNameRuleToRegExp(_.a.getHostname(t)),this._additionalErrorsRegExp=e.BrowserWatsonAdditionalErrorsToReportRegExp,this._healthWorkerErrorsRegExp=e.BrowserWatsonHealthWorkerErrorsToIgnoreRegExp,this._otelErrorsSuppressionEnabled=Boolean.parse(e.OtelLibraryCrashSupressionIsEnabled||"false"),this._otelErrorsRegExp=e.BrowserWatsonOtelErrorsToIgnoreRegExp,this._skypeErrorsRegExp=e.BrowserWatsonSkypeErrorsToIgnoreRegExp},g.appendHostNameRuleToRegExp=function(e){e&&(this._knownHostnamesRegExp=this._knownHostnamesRegExp?this._knownHostnamesRegExp+"|":"",this._knownHostnamesRegExp+="^https?://"+e+"[/:]")},g.setExceptionCallStack=function(e){this.callStack=e.stack},g.onError=function(t){var i=n(1).AFrameworkApplication;if(t){var r=t.eventObject;try{window.console.error(r.stack)}catch(e){}try{if(this.suppressError(r))return void this.processSuppressedError(r)}catch(e){a.ULS.sendTraceTag(38401685,306,15,"Error while trying to determine if we shuld suppress error or not. Exception: {0}",e)}this._seenError=!0;if(!i.suppressCrashReportingToWatson&&this._javascriptErrorReporter){var o="Unknown errorEvent",s="Unable to generate callstack.";try{o=r.message||"No error message",s=this.getCallStackToReport(r,!1)}catch(e){r.message=String.format("Unable to generate callstack. Original message: {0}. New message: {1}.",o,e.message),s=e.stack}a.ULS.sendTraceTag(38081179,306,15,"About to send error report to the server. Error: {0}",o),this._javascriptErrorReporter.sendReport(r,s)}if(i.tryReportErrorToTestHarness("null  (no crash messages available in ship)"))this.callStack=null;else{i.appSettingsManager.getBooleanAppSetting("DontStopTaskManagerOnCrashIsEnabled")||i.theTaskManager.stop(),i.activeFrame&&i.activeFrame.thePageManager&&(i.activeFrame.thePageManager.unregisterDomEvents(),h.FocusManager.usable()&&(h.FocusManager.instance().delegatesEnabled=!1)),i.isShuttingDown=!0,this.extraOnError(t),this.callStack=null,e._eventSource.raiseEvent("OnAfterError");var c=u.a.applicationCrashed;e.browserFeatureDetectionWarningIsEnabled&&!l.a.instance.areBrowserFeaturesSupported&&(c=u.a.unsupportedBrowserCrashed),i.suppressCrashReportingToBSqm||this.preventDuplicateBsqmErrors&&e._errorsReportedToBsqm.contains(c)||(e._errorsReportedToBsqm.add(c),i.reportError(c)),i.theWsaClient&&i.theWsaClient.uploadWsaData(),i.suppressCrashDialog||this.showCrashDialog()}}},g.disableApplication=function(){m.a.removeAllHandlers(window)},g.extraOnError=function(e){},g.suppressError=function(e){if(n(1).AFrameworkApplication.isShuttingDown)return a.ULS.sendTraceTag(39978440,306,15,"Error is suppressed due to the app is shutting down"),!0;if(!this._knownHostnamesRegExp&&!this._additionalErrorsRegExp)return!1;var t=e.source,i=this.callStack||e.stack,r=e.message||"",o=String.format("{0}",e.stackReference),l=this.infoMatchesOurServers(t),c=this.infoMatchesOurServers(i),u=this.infoMatchesHealthWorker(t),d=!1;this._otelErrorsSuppressionEnabled&&(d=this.infoMatchesOtel(t));var p=this.infoMatchesSkype(t),h=this.infoMatchesSkype(i),m=!l&&!c,g=p||h,f=this.shouldSuppressAdditionalErrors(r),v=this.shouldSuppressErrorFromCallstack(t,i)||this.shouldSuppressErrorFromCallstack(t,o),_=m||u||d||g||f||v,y=s.instance.shouldSuppressError(t,i,r,_,this._knownHostnamesRegExp,this._additionalErrorsRegExp,this._ignoreInCallstackRegExp);return a.ULS.sendTraceTag(579155912,306,50,"DefaultErrorHandler::ShouldSuppressError - sourceCouldBeOurs: {0}, callstackCouldBeOurs: {1}, errorIsHealthWorker: {2}, errorIsOtel: {3}, errorIsSkype: {4}, shouldSuppressAdditionalErrors: {5}, shouldSuppressErrorFromCallstack: {6}, shouldSuppressCustomErrors: {7}, returnVal: {8}",l,c,u,d,g,f,v,y,_||y),_||y},g.infoMatchesOurServers=function(e){return!e||this.stringMatchesRegExp(e,this._knownHostnamesRegExp)||this.stringMatchesRegExp(e,this._additionalErrorsRegExp)},g.infoMatchesOtel=function(e){var t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._otelErrorsRegExp);return t&&!this._seenOtelError&&(a.ULS.sendTraceTag(40150101,306,15,"Ignored script error for Otel"),this._seenOtelError=!0),t},g.infoMatchesHealthWorker=function(e){var t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._healthWorkerErrorsRegExp);return t&&!this._seenHealthWorkerError&&(a.ULS.sendTraceTag(579155913,306,15,"Ignored script error for the Health worker"),this._seenHealthWorkerError=!0),t},g.infoMatchesSkype=function(e){var t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._skypeErrorsRegExp);return t&&!this._seenSkypeError&&(a.ULS.sendTraceTag(17659039,306,15,"Ignored script error for Skype."),this._seenSkypeError=!0),t},g.shouldSuppressAdditionalErrors=function(t){for(var i,r=n(1).AFrameworkApplication,o=k(e.get_suppressCrashBasedOnMessageList());!(i=o()).done;){var s=i.value;if(t&&-1!==t.indexOf(s)&&(r.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordSuppressCrashBasedOnMessageSettings"),e.suppressCrashBasedOnMessageIsEnabled))return e._crashSuppressedBasedOnMessageList.contains(s)||(a.ULS.sendTraceTag(577611074,306,15,"Ignored error with {0}",s),e._crashSuppressedBasedOnMessageList.add(s)),!0}return!(!e.suppressResizeObserverErrorIsEnabled||!this.shouldSuppressFromErrorMessage(t,"ResizeObserver loop limit exceeded"))&&(this._seenResizeObserverError||(a.ULS.sendTraceTag(38290114,306,15,"Ignored script error of ResizeObserver."),this._seenResizeObserverError=!0),!0)},g.shouldSuppressFromErrorMessage=function(e,t){return!!e&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},g.shouldSuppressErrorFromCallstack=function(e,t){return(!e||e.toLowerCase().startsWith(this._pagePath))&&!!t&&this.stringMatchesRegExp(t,this._ignoreInCallstackRegExp)},g.stringMatchesRegExp=function(e,t){return!!t&&!!e.match(new RegExp(t,"i"))},g.processSuppressedError=function(t){try{if(t.message||"No error message",this._suppressedErrorsReported.length>=10)return;for(var n=0;n<this._suppressedErrorsReported.length;n++)if(t.isSameError(this._suppressedErrorsReported[n]))return;a.ULS.sendTraceTag(5904476,306,15,"Ignored script error. Browser session data: {0}",e.getTraceData(t)),Array.add(this._suppressedErrorsReported,t)}catch(e){a.ULS.sendTraceTag(38401689,306,15,"Exception in ProcessSuppressedError. Exception: {0}",e)}},g.register=function(e){var t=n(1).AFrameworkApplication;e&&(t.theDefaultErrorHandler=this,this._onErrorDelegate=Object(r.d)(this,this.onError,"onError"),e.registerHandler(3,this._onErrorDelegate,null),this._pageManager=e)},g.unregister=function(){this._pageManager&&(this._pageManager.unregisterHandler(3,this._onErrorDelegate),this._pageManager=null,this._onErrorDelegate=null)},g.getCallStackToReport=function(e,t){var n=this.callStack||e.stack;return n?t?n:b.a.xmlEncode(n):function(){return!this}()?(n=function(e,t){void 0===e&&(e=0),void 0===t&&(t=10);var n=Error.stackTraceLimit,i="";try{throw Error.stackTraceLimit=1+e+t,new Error}catch(e){i=e.stack}finally{Error.stackTraceLimit=n}for(var r=-2;""!==i&&r<e;r++)i=i.slice(i.indexOf("\n")+1);return i}(1),t?n:b.a.xmlEncode(n)):p.Debug.generateCallstack(e.stackReference,t,!0)},g.showCrashDialog=function(){var t=n(1).AFrameworkApplication;try{v.a.currentDialog&&(v.a.currentDialog.hide(),v.a.currentDialog.dispose())}catch(e){}var i=new f,o=u.a.applicationCrashed,s="Microsoft Office",c="Sorry, we ran into a problem.",d="Something went wrong",p="Sorry, we ran into a problem. Please try refreshing the page.",h="You can't use Office because your browser isn't supported. Please switch to a supported browser.",m="Exit",g="Restart",_="Refresh";try{s=CommonUIStrings.l_DefaultDialogTitle,d=CommonUIStrings.l_CrashDialogTitle,p=CommonUIStrings.l_CrashDialogMessage,c=CommonUIStrings.l_ErrorDialogMessage,m=CommonUIStrings.l_ErrorDialogExitName,g=CommonUIStrings.l_ErrorDialogRestartName,_=CommonUIStrings.l_ErrorDialogRefreshName,h=CommonUIStrings.l_UnsupportedBrowserCrashed}catch(e){a.ULS.sendTraceTag(39321885,306,15,"Failed to get CommonUIStrings. Exception: {0}",e)}t.theActionManager.getActionMetadata(C.a.close)?t.suppressRetryFromCrashDialog?(t.suppressRetryFromCrashDialogMessage&&t.suppressRetryFromCrashDialogMessage.length>0&&(c=t.suppressRetryFromCrashDialogMessage),i.buttonsOption=6,i.setButtonText(0,m)):t.isEmbedded?i.buttonsOption=0:(i.buttonsOption=1,i.setButtonText(0,m)):(a.ULS.sendTraceTag(39125970,306,50,"ShowCrashDialog: Crash shown before Close command loaded."),i.buttonsOption=5,i.hasCloseGlyph=!1),i.setButtonText(1,g),t.logFlightedSettingUsage("Microsoft.Office.Web.Common.Flighting.IPPTCrashDialogImprovementSettings"),t.appSettingsManager.getBooleanAppSetting("IsCrashDialogImprovementEnabled")&&(i.buttonsOption=0,i.setButtonText(1,_),i.hasCloseGlyph=!1,s=d,c=p);var y=Object(r.d)(this,this.crashDialogHandler,"crashDialogHandler");e.browserFeatureDetectionWarningIsEnabled&&!l.a.instance.areBrowserFeaturesSupported&&(o=u.a.unsupportedBrowserCrashed,c=h),i.showError(o,s,c,y,!1,!1,!1)},g.crashDialogHandler=function(t,i){var r=n(1).AFrameworkApplication;1===t?window.self.g_instantApp&&r.activeFrame?r.activeFrame.refreshDocument(null):y.a.openWindow(1,window.location.href):e.closeAppOnErrorWithFailoverToBlank(),this.disableApplication(),r.theUlsHost&&r.theUlsHost.dispose()},e.get_suppressCrashBasedOnMessageList=function(){var t=n(1).AFrameworkApplication;if(!e._suppressCrashBasedOnMessageList&&(e._suppressCrashBasedOnMessageList=new A.a,t.appSettingsManager&&t.appSettingsManager.containsAppSetting("SuppressCrashBasedOnMessageList")))for(var i=n(1).AFrameworkApplication.appSettingsManager.getListAppSetting("SuppressCrashBasedOnMessageList"),r=0;r<i.length;r++)e._suppressCrashBasedOnMessageList.add(i[r]);return e._suppressCrashBasedOnMessageList},e.add_onAfterError=function(t){e._eventSource.addHandler("OnAfterError",t)},e.remove_onAfterError=function(t){e._eventSource.removeHandler("OnAfterError",t)},e.getTraceData=function(e){var t={};return t.message=e.message,t.line=e.line,e.source&&(t.file=_.a.addOrReplaceParameterValue(e.source,"fileName","DWITHDRAWN")),e.stack&&(t.stack=e.stack),t},e.closeAppOnErrorWithFailoverToBlank=function(){32!==n(1).AFrameworkApplication.theActionManager.processActionWithData(C.a.close,2,c.c)&&(a.ULS.sendTraceTag(5878498,201,50,"Failed to execute Close action."),window.location="about:blank")},t=e,o=[{key:"suppressCrashBasedOnMessageIsEnabled",get:function(){var t=n(1).AFrameworkApplication;return null==e._suppressCrashBasedOnMessageIsEnabled&&(e._suppressCrashBasedOnMessageIsEnabled=!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("SuppressCrashBasedOnMessageIsEnabled")),e._suppressCrashBasedOnMessageIsEnabled}},{key:"suppressResizeObserverErrorIsEnabled",get:function(){var t=n(1).AFrameworkApplication;return null==e._suppressResizeObserverErrorIsEnabled&&(e._suppressResizeObserverErrorIsEnabled=!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("SuppressResizeObserverErrorIsEnabled")),e._suppressResizeObserverErrorIsEnabled}},{key:"browserFeatureDetectionWarningIsEnabled",get:function(){var t=n(1).AFrameworkApplication;return null==e._browserFeatureDetectionWarningIsEnabled&&(e._browserFeatureDetectionWarningIsEnabled=!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting("BrowserFeatureDetectionIsEnabled")&&t.appSettingsManager.getBooleanAppSetting("BrowserFeatureDetectionWarningIsEnabled")),e._browserFeatureDetectionWarningIsEnabled}}],(i=[{key:"seenError",get:function(){return this._seenError}},{key:"preventDuplicateBsqmErrors",get:function(){return this._preventDuplicateBsqmErrors}},{key:"javascriptErrorReporterFactory",get:function(){return this._javascriptErrorReporterFactory||(this._javascriptErrorReporterFactory=S.a.instance.resolve("Common.IJavascriptErrorReporterFactory"))}}])&&P(t.prototype,i),o&&P(t,o),e}();F._eventSource=new I.a,F._suppressCrashBasedOnMessageList=null,F._crashSuppressedBasedOnMessageList=new w.a(T.a.get_ordinal()),F._errorsReportedToBsqm=new w.a(E.a.get_default()),F._suppressCrashBasedOnMessageIsEnabled=null,F._suppressResizeObserverErrorIsEnabled=null,F._browserFeatureDetectionWarningIsEnabled=null,Object(i.a)(F,"DefaultErrorHandler",null,[53])},function(e,t,n){"use strict";var i=n(0),r=n(280),a=function(){function e(e,t,n){this._disposed=!1,this._action=e,this._actionWithData=t,this._data=n}var t=e.prototype;return t.get_disposed=function(){return this._disposed},t.set_disposed=function(e){return this._disposed=e,e},t.tryExecute=function(){this.get_disposed()||(this._action?this._action():this._actionWithData(this._data))},t.dispose=function(){this.set_disposed(!0)},e}();function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}Object(i.a)(a,"CancellationTokenRegistration",null,[4]),n.d(t,"a",(function(){return l}));var l=function(){function e(e){this._registrations=null,this._isCancellationRequested=!1,this._canBeCanceled=!1,this.set_canBeCanceled(e)}var t=e.prototype;return t.get_isCancellationRequested=function(){return this._isCancellationRequested},t.set_isCancellationRequested=function(e){return this._isCancellationRequested=e,e},t.get_canBeCanceled=function(){return this._canBeCanceled},t.set_canBeCanceled=function(e){return this._canBeCanceled=e,e},t.throwIfCancellationRequested=function(){this.get_isCancellationRequested()&&e.throwCancellation()},t.R=function(e){var t=new a(e,null,null);return this.register(t),t},t.RO=function(e,t){var n=new a(null,e,t);return this.register(n),n},t.register=function(e){this.get_isCancellationRequested()?e.tryExecute():this._registrations=r.a(this._registrations,e)},t.cancel=function(e){if(!this.get_canBeCanceled())throw Error.invalidOperation("CanBeCanceled is false");if(!this.get_isCancellationRequested()&&(this.set_isCancellationRequested(!0),e&&this._registrations))for(var t,n=o(this._registrations);!(t=n()).done;){t.value.tryExecute()}},e.throwCancellation=function(){throw e.createCancellationException()},e.createCancellationException=function(){var e;return Error.create("OperationCanceledException: Task canceled",((e={}).$$canceled=!0,e))},e.get_none=function(){return e._noneToken},e.isCancellationException=function(t){return t[e.exceptionData]},e}();l.exceptionData="$$canceled",l._noneToken=new l(!1),Object(i.a)(l,"CancellationToken",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var i=n(0),r=n(2),a=n(11),o=n(65),s=n(1),l=n(201),c=(n(187),n(9),n(71)),u=n(4),d=n(73),p=n(28),h=n(7),m=n(79),g=n(22),f=n(10),v=n(64),_=n(180),y=n(87),b=n(82),S=n(162),C=n(141),A=n(345),I=n(5),w=n(6),T=n(3),E=n(49);function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var P=function(e){var t,i;function o(t,n,i,a){var o;return(o=e.call(this,null,t,null,null)||this)._pendingCloseMenuStackTimeoutId=-1,o._pendingCloseMenuStackLauncherIndex=-1,o._textDirection=0,o._isStaticUiTouchMode=!1,o._isSingleRowLayoutRibbon=!1,o._launchMenusUp=!1,o.hiddenLabel=null,o._clientID=null,o._initializing=!0,o.supportsEmphasizedControls=!1,o.controlWithFocus=null,o.controlIdPrefix="",o.activeControl=null,o.shouldHandleElementResize=!1,o.menuPositioningInfo=null,o.needScaling=!1,o.needRefresh=!1,o._rootUser=null,o._builder=null,o._events=null,o._menuLauncherStack=null,o._closeInProgress=!1,o._elmModalDiv=null,o._modalControllerStack=null,o._modalWithCaptureControllerStack=null,o._currentModalController=null,o._currentModalWithCaptureController=null,o._inBlockingMode=!1,o._disposed$1=!1,o._cookieDataVersion="",o._useDataCookie=!1,o.initRootMember(M(o)),o._properties=n,o._controls={},o._unique=0,o._rootManager=i||C.a.instance,o._resizableContainer=a,o._resizableContainer&&o._resizableContainer.add_onResize(Object(r.d)(M(o),o.onResize,"onResize")),I.c(n.TextDirection)||(o._textDirection="rtl"===n.TextDirection.toLowerCase()?1:0),o._rootManager.addRoot(M(o)),o._rootPoller=new A.a,o}i=e,(t=o).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var E,P,F,D=o.prototype;return D.ensureBehaviorAttached=function(){e.prototype.ensureBehaviorAttached.call(this),this.pollForStateAndUpdate()},D.registerControl=function(e){this._controls[e.id]=e},D.getControlById=function(e){return this._controls[e]},D.getValidControl=function(e){var t=this.getControlById(e);return this._disposed$1||!t||t.disposed||this.builder.isIdTrimmed(e)?null:t},D.refreshInternal=function(){e.prototype.refreshInternal.call(this),this._initializing=!1},D.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this),1===this.textDirection&&w.a.ensureCSSClassOnElement(this.elementInternal,"cui-rtl"),this.ensureHiddenLabel(),this.shouldHandleElementResize=!0},D.ensureHiddenLabel=function(){this.properties.LabelText&&!this.hiddenLabel&&(this.hiddenLabel=h.a.appendHiddenLabel(this.element,this.id+"-label",this.properties.LabelText))},D.refresh=function(){this.refreshInternal()},D.refreshOpenMenu=function(e){for(var t=0;t<this.menuStackDepth;t++){var n=this.menuLauncherStack[t];if(n.id===e)return n.refreshMenu(),!0}return!1},D.updateControl=function(e){e in this._controls&&this._controls[e].pollForStateAndUpdate()},D.commitAnyPendingChange=function(){this.controlWithFocus&&this.controlWithFocus.commitPendingChange()},D.pollForCommandState=function(e,t,n,i){return this._rootPoller.pollForCommandState(this._rootUser,this.rootType,e,t,n,i)},D.pollForStateAndUpdate=function(){this.pollForStateAndUpdateInternal()},D.pollForStateAndUpdateInternal=function(){this.lastPollTime=new Date,e.prototype.pollForStateAndUpdateInternal.call(this),this.ensureGlobalDisablingRemoved()},D.ensureGlobalDisablingRemoved=function(){w.a.setEnabledOnElement(this.elementInternal,!0)},D.getUniqueNumber=function(){return this._unique++},D.createMenuSection=function(e,t,n,i,r){return new S.a(this,e,t,n,i,r)},D.createMenu=function(e,t,n,i,r,a){return void 0===r&&(r=!1),void 0===a&&(a=1),new y.Menu(this,e,t,n,i,this._rootManager,r,a)},D.createGallery=function(e,t,n,i){return new _.a(this,e,t,n,i)},D.createControlComponent=function(e,t,n){return new v.a(this,e,t,n)},D.createMenuItem=function(e,t,n){return new b.a(this,e,t,n)},D.executeCommand=function(e,t,i,a,o,s,c){void 0===s&&(s=null),void 0===c&&(c=null);n(195).Ribbon,n(217).Tab;if(this.notifyMenuLaunchersCommandExecuted(i,o),o&&this.closeAllMenus(),!I.c(this._rootUser)){var u=new l.a;if(u.CommandLocation=this.rootType,u.InvocationMethod=a,t&&Object(r.c)(v.a,i)){var d=i.control;d&&(!t.ParentMenuId&&d.stateProperties&&d.stateProperties.ParentMenuId&&(t.ParentMenuId=d.stateProperties.ParentMenuId),!t.SqmControlId&&!t.SourceControlId&&d.controlProperties&&d.controlProperties.Id&&(t.SqmControlId=d.controlProperties.Id))}0,this._rootUser.executeRootCommand(e,t,u,s,c)}},D.notifyMenuLaunchersCommandExecuted=function(e,t){if(this.menuLauncherStack&&this.menuLauncherStack.length&&Object(r.c)(v.a,e)&&e.isMenuItem())for(var n=0;n<this.menuLauncherStack.length;n++)this.menuLauncherStack[n].notifyCommandExecuted(e,t)},D.addMenuLauncherToStack=function(e){I.c(this.menuLauncherStack)&&(this.menuLauncherStack=[]),Array.add(this.menuLauncherStack,e)},D.closeAllMenus=function(){return this.closeMenuStackAtIndex(0,!0)},D.closeMenuStack=function(e){this.closeMenuStackAtIndex(Array.indexOf(this.menuLauncherStack,e),!0)},D.closeMenuStackAtIndex=function(e,t,n){void 0===n&&(n=!0);var i=!1;if(this.cancelPendingCloseMenuStack(),!I.c(this.menuLauncherStack))if(t){if(!this._closeInProgress){this._closeInProgress=!0;for(var a=this.menuLauncherStack.length-1;a>=e;a--)this.menuLauncherStack[a].closeMenu(n),Array.removeAt(this.menuLauncherStack,a),i=!0,a||this.onMenuStackCleared();this._closeInProgress=!1}}else this._pendingCloseMenuStackLauncherIndex=e,this._pendingCloseMenuStackTimeoutId=window.setTimeout(Object(r.d)(this,this.closePendingMenuStack,"closePendingMenuStack"),o.closeMenuStackDelay);return i},D.clearMenuStack=function(e){if(!I.c(this.menuLauncherStack)){for(;this.menuLauncherStack.length>0;){var t=this.menuLauncherStack.length-1,n=this.menuLauncherStack[t];if(Array.removeAt(this.menuLauncherStack,t),this.menuLauncherStack.length||this.endModal(e,!1),n===e)return;n.closeMenu()}0}},D.closePendingMenuStack=function(){this.closeMenuStackAtIndex(this._pendingCloseMenuStackLauncherIndex,!0)},D.cancelPendingCloseMenuStack=function(){var e=this;this&&w.a.cancelPendingTimeout(Object(a.a)((function(){return e._pendingCloseMenuStackTimeoutId}),(function(t){return e._pendingCloseMenuStackTimeoutId=t})))},D.onMenuStackCleared=function(){},D.beginModal=function(e,t,n){void 0===n&&(n=!1);var i=this.inModalMode,r=this.modalDiv;i&&this._inBlockingMode||(I.c(this._modalControllerStack)&&(this._modalControllerStack=[]),Array.add(this._modalControllerStack,e),this._currentModalController=e,n&&!this._inBlockingMode&&(this._inBlockingMode=!0),i||(r.style.visibility="hidden",r.style.display="block",r.style.visibility="visible"),s.AFrameworkApplication.activeFrame.beginModal(t),r.style.zIndex=String(s.AFrameworkApplication.activeFrame.activeModalDivZIndex))},D.beginModalWithCapture=function(e,t){T.ULS.sendTraceTag(20308505,207,50,"Begin Light Dismiss Modal using Capture");var n=this.inModalWithCaptureMode;I.c(this._modalWithCaptureControllerStack)&&(this._modalWithCaptureControllerStack=[]),Array.add(this._modalWithCaptureControllerStack,e),this._currentModalWithCaptureController=e,n||(p.a.instance.registerHandlerWithCaptureOption(u.EventNames.pointerDown,window.document.body,Object(r.d)(this,this.onModalWithCapturePointerDown,"onModalWithCapturePointerDown"),!0),p.a.instance.registerHandlerWithCaptureOption(u.EventNames.pointerUp,window.document.body,Object(r.d)(this,this.onModalWithCapturePointerUp,"onModalWithCapturePointerUp"),!0),p.a.instance.registerHandlerWithCaptureOption(u.EventNames.pointerMove,window.document.body,Object(r.d)(this,this.onModalWithCapturePointerMove,"onModalWithCapturePointerMove"),!0),p.a.instance.registerHandlerWithCaptureOption(u.EventNames.pointerOut,window.document.body,Object(r.d)(this,this.onModalWithCapturePointerOut,"onModalWithCapturePointerOut"),!0),c.a.instance.registerHandlerWithCaptureOption(u.EventNames.click,window.document.body,Object(r.d)(this,this.onModalWithCaptureClick,"onModalWithCaptureClick"),null,!1,!0),d.a.instance.registerHandlerWithCaptureOption(u.EventNames.mouseWheel,window.document.body,Object(r.d)(this,this.onModalWithCaptureMouseWheel,"onModalWithCaptureMouseWheel"),null,!0)),s.AFrameworkApplication.activeFrame.beginModal(t)},D.isCurrentModalController=function(e){return e===this._currentModalController},D.endModal=function(e,t,n){if(void 0===n&&(n=!1),this.isCurrentModalController(e)){if(!this.inModalMode)throw Error.create("Cannot end modal mode because the Ribbon is not in Modal Mode");this._inBlockingMode&&!n||(n&&(this._inBlockingMode=!1),Array.removeAt(this._modalControllerStack,this._modalControllerStack.length-1),this._currentModalController=null,this._modalControllerStack.length>0&&(this._currentModalController=this._modalControllerStack[this._modalControllerStack.length-1]),s.AFrameworkApplication.activeFrame.endModal(t),this.modalDiv.style.zIndex=String(s.AFrameworkApplication.activeFrame.activeModalDivZIndex),I.c(this._currentModalController)&&(this.modalDiv.style.display="none"))}},D.endModalWithCapture=function(e,t){if(T.ULS.sendTraceTag(20308506,207,50,"End Light Dismiss Modal using Capture"),e===this._currentModalWithCaptureController){if(!this.inModalWithCaptureMode)throw Error.create("Cannot end modal mode because the Control is not in Modal Mode");Array.removeAt(this._modalWithCaptureControllerStack,this._modalWithCaptureControllerStack.length-1),this._currentModalWithCaptureController=null,this._modalWithCaptureControllerStack.length>0&&(this._currentModalWithCaptureController=this._modalWithCaptureControllerStack[this._modalWithCaptureControllerStack.length-1]),I.c(this._currentModalWithCaptureController)&&(p.a.instance.unregisterHandlerWithCaptureOption(u.EventNames.pointerDown,window.document.body,Object(r.d)(this,this.onModalWithCapturePointerDown,"onModalWithCapturePointerDown"),!0),p.a.instance.unregisterHandlerWithCaptureOption(u.EventNames.pointerUp,window.document.body,Object(r.d)(this,this.onModalWithCapturePointerUp,"onModalWithCapturePointerUp"),!0),p.a.instance.unregisterHandlerWithCaptureOption(u.EventNames.pointerMove,window.document.body,Object(r.d)(this,this.onModalWithCapturePointerMove,"onModalWithCapturePointerMove"),!0),p.a.instance.unregisterHandlerWithCaptureOption(u.EventNames.pointerOut,window.document.body,Object(r.d)(this,this.onModalWithCapturePointerOut,"onModalWithCapturePointerOut"),!0),c.a.instance.unregisterHandlerWithCaptureOption(u.EventNames.click,window.document.body,Object(r.d)(this,this.onModalWithCaptureClick,"onModalWithCaptureClick"),!1,!0),d.a.instance.unregisterHandlerWithCaptureOption(u.EventNames.mouseWheel,window.document.body,Object(r.d)(this,this.onModalWithCaptureMouseWheel,"onModalWithCaptureMouseWheel"),!0)),s.AFrameworkApplication.activeFrame.endModal(t)}},D.endBlockingModeKeepModal=function(){this._inBlockingMode=!1},D.onModalPointerDown=function(e){return!I.c(this._currentModalController)&&this._currentModalController.onModalBodyPointerDown(e)},D.onModalPointerUp=function(e){return!I.c(this._currentModalController)&&this._currentModalController.onModalBodyPointerUp(e)},D.onModalPointerMove=function(e){return!I.c(this._currentModalController)&&this._currentModalController.onModalBodyPointerMove(e)},D.onModalPointerOut=function(e){return!I.c(this._currentModalController)&&this._currentModalController.onModalBodyPointerOut(e)},D.onModalClick=function(e){return!I.c(this._currentModalController)&&this._currentModalController.onModalBodyClick(e)},D.onModalMouseWheel=function(e){return!I.c(this._currentModalController)&&this._currentModalController.onModalBodyMouseWheel(e)},D.shouldHandleOnCapturePhase=function(e,t){return!(g.DomUtils.isDescendantOf(e,t)||I.c(this._currentModalWithCaptureController)||!I.c(this._currentModalController))},D.onModalWithCapturePointerDown=function(e){return!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyPointerDown(e)},D.onModalWithCapturePointerUp=function(e){return!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyPointerUp(e)},D.onModalWithCapturePointerMove=function(e){return!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyPointerMove(e)},D.onModalWithCapturePointerOut=function(e){return!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyPointerOut(e)},D.onModalWithCaptureClick=function(e){return!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyClick(e)},D.onModalWithCaptureMouseWheel=function(e){return!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyMouseWheel(e)},D.dismissAllTransientUI=function(){return this.closeAllMenus()},D.onResize=function(){this.shouldHandleElementResize&&(f.a.isAndroid||this.dismissAllTransientUI())},D.dispose=function(){if(!this._disposed$1){this._disposed$1=!0;var t=this.elementInternal;I.c(t)||w.a.unregisterAllHandlers(t),this.shouldHandleElementResize=!1,this._resizableContainer&&(this._resizableContainer.remove_onResize(Object(r.d)(this,this.onResize,"onResize")),this._resizableContainer=null),this.hiddenLabel=null,I.c(this._elmModalDiv)||w.a.unregisterAllHandlers(this._elmModalDiv),this._rootManager.removeRoot(this),this._elmModalDiv=null,this._rootUser=null,this._builder=null,e.prototype.dispose.call(this)}},D.storeDataCookie=function(e,t){e=this.cookieDataVersion+e,m.a.setWithExpiration(e,t,7)},D.getDataCookieValue=function(e){return e=this.cookieDataVersion+e,m.a.get(e)},D.setFlyoutCoordinates=function(e,t,n,i){return null},o.add_onSQMEventHandler=function(e){o._SQMEventSource.addHandler(o.sqmEventName,e)},o.remove_onSQMEventHandler=function(e){o._SQMEventSource.removeHandler(o.sqmEventName,e)},o.raiseSQMEvent=function(e){s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SqmCommandEventSourceEnabled")&&o._SQMEventSource.raiseEvent(o.sqmEventName,e)},E=o,(P=[{key:"rootManager",get:function(){return this._rootManager}},{key:"clientID",get:function(){return this._clientID},set:function(e){this._clientID=e}},{key:"initializing",get:function(){return this._initializing}},{key:"supportsInvisibleControls",get:function(){return!1}},{key:"supportsDynamicDisplayMode",get:function(){return!1}},{key:"isStaticUiTouchMode",get:function(){return this._isStaticUiTouchMode||this.touchModeForcedOn},set:function(e){this._isStaticUiTouchMode=e}},{key:"isSingleRowLayoutRibbon",get:function(){return this._isSingleRowLayoutRibbon},set:function(e){this._isSingleRowLayoutRibbon=e}},{key:"touchModeForcedOn",get:function(){return f.a.isIPad||s.AFrameworkApplication.forceTouchRibbon}},{key:"launchMenusUp",get:function(){return this._launchMenusUp}},{key:"controls",get:function(){return this._controls}},{key:"rootUser",get:function(){return this._rootUser},set:function(e){this._rootUser=e}},{key:"builder",get:function(){return this._builder},set:function(e){this._builder=e}},{key:"pollForState",get:function(){return!I.c(this._rootUser)}},{key:"element",get:function(){return this.elementInternal}},{key:"cssClass",get:function(){return"cui-disabled"}},{key:"textDirection",get:function(){return this._textDirection}},{key:"events",get:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events}},{key:"menuLauncherStack",get:function(){return this._menuLauncherStack},set:function(e){this._menuLauncherStack=e}},{key:"menuStackDepth",get:function(){var e=this.menuLauncherStack;return I.c(e)?0:e.length}},{key:"inModalMode",get:function(){return!I.c(this._modalControllerStack)&&this._modalControllerStack.length>0}},{key:"inModalWithCaptureMode",get:function(){return!I.c(this._modalWithCaptureControllerStack)&&this._modalWithCaptureControllerStack.length>0}},{key:"modalDiv",get:function(){return I.c(this._elmModalDiv)&&(this._elmModalDiv=w.a.createElement("div"),this._elmModalDiv.setAttribute("id",o.modalDivId),w.a.ensureCSSClassOnElement(this._elmModalDiv,"cui-modalDiv"),w.a.setUnselectable(this._elmModalDiv,!0,!1),document.body.appendChild(this._elmModalDiv),p.a.instance.registerHandler(u.EventNames.pointerDown,this._elmModalDiv,Object(r.d)(this,this.onModalPointerDown,"onModalPointerDown")),p.a.instance.registerHandler(u.EventNames.pointerUp,this._elmModalDiv,Object(r.d)(this,this.onModalPointerUp,"onModalPointerUp")),p.a.instance.registerHandler(u.EventNames.pointerMove,this._elmModalDiv,Object(r.d)(this,this.onModalPointerMove,"onModalPointerMove")),p.a.instance.registerHandler(u.EventNames.pointerOut,this._elmModalDiv,Object(r.d)(this,this.onModalPointerOut,"onModalPointerOut")),c.a.instance.registerHandler(u.EventNames.click,this._elmModalDiv,Object(r.d)(this,this.onModalClick,"onModalClick")),d.a.instance.registerHandler(u.EventNames.mouseWheel,this._elmModalDiv,Object(r.d)(this,this.onModalMouseWheel,"onModalMouseWheel"))),this._elmModalDiv}},{key:"disposed",get:function(){return this._disposed$1},set:function(e){this._disposed$1=e}},{key:"cookieDataVersion",get:function(){return this._cookieDataVersion},set:function(e){this._cookieDataVersion=e}},{key:"useDataCookie",get:function(){return this._useDataCookie},set:function(e){this._useDataCookie=e}},{key:"properties",get:function(){return this._properties}}])&&k(E.prototype,P),F&&k(E,F),o}(o.a);P.unifiedHeaderHeightPx=48,P.tabRowHeightPx=30,P.singleRowLayoutTabRowHeightPx=24,P.closeMenuStackDelay=300,P.completeConstructionInterval=200,P.sqmEventName="SQMEvent",P._SQMEventSource=new E.a,P.modalDivId="ModalDiv",Object(i.a)(P,"Root",o.a,[4,19,70])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.parentId=null};Object(i.a)(r,"BuildContext",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(38),o=n(1),s=n(61),l=n(67),c=(n(9),n(54),n(360)),u=n(349),d=n(21),p=n(350),h=n(351),m=n(355),g=n(138),f=n(137),v=n(133),_=function(){function e(){this.downloadEnabled=!1,this.feedbackEnabled=!1,this.hasPrivacyUrl=!1,this.hasTermsOfUseUrl=!1,this.isAccessiblePdfMode=!1,this.isEmbeddedViewer=!1,this.isBroadcastMode=!1,this.newEmbedModeIsEnabled=!1,this.printEnabled=!1,this.showEmbedCode=!1,this.userMayEnterAccessiblePdfMode=!1,this.zoomPopupDialogEnabled=!1}var t=e.prototype;return t.getTrimmedIds=function(){var e={};if(e[f.a.zoomFlyout]=this.isAccessiblePdfMode||this.isEmbeddedViewer&&!this.newEmbedModeIsEnabled||this.zoomPopupDialogEnabled,e[f.a.buttonShowZoomDialog]=this.isAccessiblePdfMode||this.isEmbeddedViewer&&!this.newEmbedModeIsEnabled||!this.zoomPopupDialogEnabled,e[f.a.pageInfoLabel]=this.isAccessiblePdfMode,e[f.a.presenterPageLabel]=!this.isBroadcastMode,this.isEmbeddedViewer){e[f.a.giveFeedbackButton]=!0;var t=this.getTrimmedIdsForMenuSectionOne(e),n=this.getTrimmedIdsForMenuSectionTwo(e),i=this.getTrimmedIdsForMenuSectionThree(e);e[v.a.controlMenu]=t&&n&&i}else e[f.a.giveFeedbackButton]=!this.feedbackEnabled,e[v.a.wordIcon]=!0,e[v.a.fullScreenButton]=!0,e[v.a.controlMenu]=!0;return e},t.getTrimmedIdsForMenuSectionOne=function(e){var t=!0;return t=(e[v.a.printButton]=!this.printEnabled)&&t,t=(e[v.a.downloadACopyButton]=!this.downloadEnabled)&&t,t=(e[v.a.accessibleModeButton]=!this.userMayEnterAccessiblePdfMode)&&t,e[v.a.controlMenuSectionOne]=t,t},t.getTrimmedIdsForMenuSectionTwo=function(e){var t=!0;return t=(e[v.a.documentInformationButton]=!this.showEmbedCode)&&t,e[v.a.controlMenuSectionTwo]=t,t},t.getTrimmedIdsForMenuSectionThree=function(e){var t=!0;return t=(e[v.a.privacyButton]=!this.hasPrivacyUrl)&&t,t=(e[v.a.termsOfUseButton]=!this.hasTermsOfUseUrl)&&t,t=(e[v.a.giveFeedbackButtonEmbed]=!this.feedbackEnabled)&&t,e[v.a.controlMenuSectionThree]=t,t},e}();Object(i.a)(_,"StatusBarIdTrimmer",null,[]);var y=n(18);function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return S}));var S=function(){function e(t,i,r){var s=this;this._theStatusBar=null,this._reactStatusBar=null,this._reactCommandDefinitionMapping=null;var c=o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ZoomPopupDialogIsEnabled");this._zoomControlId=c?f.a.buttonShowZoomDialog:f.a.zoomFlyout;var u=Object.assign(new _,{downloadEnabled:!o.AFrameworkApplication.trimDownloadACopy,feedbackEnabled:o.AFrameworkApplication.showFeedbackButton&&!(o.AFrameworkApplication.mightNeedPrivacyDialog&&r.isSmallView),hasPrivacyUrl:!!o.AFrameworkApplication.privacyUrl,hasTermsOfUseUrl:!!o.AFrameworkApplication.termsUrl,isAccessiblePdfMode:r.isAccessiblePdfMode,isBroadcastMode:r.isBroadcastMode,isEmbeddedViewer:r.isSmallView,newEmbedModeIsEnabled:o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),printEnabled:r.showPrint,showEmbedCode:r.showEmbed,userMayEnterAccessiblePdfMode:r.userMayEnterAccessiblePdfMode,zoomPopupDialogEnabled:c}),d=u.getTrimmedIds();if(e.isReactStatusBarEnabled)window.setTimeout((function(){l.a.get_instance().executeWhen(7,(function(){var e=n(14).App;s.initializeReactStatusBar(t,d,e.get_activeAppFrame().ribbonUser.reactRibbonRoot)}))}),0);else{var v=new a.CuiHelper(g.a.wordViewerImageBase,WordViewerIntl.WordViewerStrings,null,null,null),y=Object.assign(new h.a,{clientID:e.clientId,trimmedIds:u.getTrimmedIds()}),b=new m.a(y,t,this,i);b.dataSource=new p.a("WordViewerStatusBarData",v),b.buildToolbar(),this._theStatusBar=b.toolbar,this._theStatusBar.rootUser=this,this.setZoomVisibility(!1),this._theStatusBar.refresh()}}var t,i,v,S=e.prototype;return S.initializeReactStatusBar=function(e,t,n){this._reactCommandDefinitionMapping=d.a.instance.tryResolve("WordViewer.WordViewerReactCommandDefinitionMapping");var i={};for(var a in t){var o={key:a,value:t[a]};i[this.getReactStatusBarControlId(o.key)]=o.value}this._reactStatusBar=new c.a(e,Object.assign(new u.a,{trimmedIds:i,updateRibbonControls:Object(r.d)(n.reactRibbonRootPoller,n.reactRibbonRootPoller.pollForStateAndUpdateCommands,"pollForStateAndUpdateCommands"),isViewer:!0,statusBarId:"WordViewerStatusBar"}))},S.getReactStatusBarControlId=function(e){var t="";if(this._reactCommandDefinitionMapping){var n=this._reactCommandDefinitionMapping.getExternalUxIdsByLegacyControlId(e);n&&n.get_count()>0&&(t=n.get_item(0))}return t&&""!==t?t:e},S.dispose=function(){this._theStatusBar&&(this._theStatusBar.dispose(),this._theStatusBar=null)},S.poll=function(){this._reactStatusBar?this._reactStatusBar.poll():this._theStatusBar&&this._theStatusBar.pollForStateAndUpdate()},S.executeRootCommand=function(e,t,n,i,r){if(void 0===i&&(i=null),void 0===r&&(r=null),o.AFrameworkApplication.isShuttingDown)return!1;if(o.AFrameworkApplication.theTaskManager.isYielding)return!1;var a=parseInt(e),s=o.AFrameworkApplication.theActionManager;n&&(s.commandLocation=n.CommandLocation,s.invocationMethod=n.InvocationMethod);var l=t,c=a;switch(a){case y.a.onZoomChange:0,l=parseInt(t.MenuItemId)}return 32===s.processActionWithData(c,2,l,r)},S.isRootCommandEnabled=function(e,t){if(void 0===t&&(t=null),o.AFrameworkApplication.isShuttingDown)return!1;if(o.AFrameworkApplication.theTaskManager.isYielding)return!1;var n=parseInt(e);if(!e||n===s.ActionManager.emptyActionId)return!0;var i=n;return 32===o.AFrameworkApplication.theActionManager.processAction(i,1)},S.setControlVisibility=function(e,t){this._reactStatusBar?this._reactStatusBar.setControlVisibility(this.getReactStatusBarControlId(e),t):this._theStatusBar&&this._theStatusBar.setControlVisibility(e,t)},S.setZoomVisibility=function(e){this.setControlVisibility(this._zoomControlId,e)},S.pollControl=function(e){this._reactStatusBar?this._reactStatusBar.pollControl(this.getReactStatusBarControlId(e)):this._theStatusBar&&this._theStatusBar.pollForControlState(e)},S.pollZoomControl=function(){this.pollControl(this._zoomControlId)},S.onComponentBuilt=function(e,t){},t=e,v=[{key:"isReactStatusBarEnabled",get:function(){return!n(14).App.instance.isSmallView}}],(i=null)&&b(t.prototype,i),v&&b(t,v),e}();S.clientId="StatusBar",Object(i.a)(S,"StatusBarUser",null,[48,183])},function(e,t,n){"use strict";function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=function(e,t,n){void 0===n&&(n=0),n||(n=function(e){for(var t=2*e+1;;){for(var n=!1,i=Math.sqrt(t),r=t/2|0;r>=i;r--)if(!(t%r)){n=!0;break}if(!n)return t;t+=2}}(e.val.length));var r=e.val;e.val=new Array(n);for(var a=0;a<n;a++)e.val[a]=new Array(0);if(r)for(var o,l=i(r);!(o=l()).done;)for(var c,u=i(o.value);!(c=u()).done;){var d=c.value;Array.add(e.val[s(e.val,t.getHashCode(d))],d)}},o=function(e,t,n,i){var r=n.getHashCode(t),o=e.val[s(e.val,r)];return o.length>5&&i>3*e.val.length&&(a(e,n),o=e.val[s(e.val,r)]),o},s=function(e,t){var n=e.length,i=t%n;return i<0&&(i+=n),i}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(2),a=n(207),o=n(142),s=function(){function e(e){this._exception=null,this._task=o.a.CO(Object(r.d)(this,this.execute,"execute"),e)}var t=e.prototype;return t.execute=function(e){if(this._exception)throw this._exception;return this._result},t.get_task=function(){return this._task},t.SXs=function(e){this._exception=a.a(e),this._task.runSynchronously()},t.SX=function(e){this._exception=e,this._task.runSynchronously()},t.trySetException=function(e){return!this._task.get_isCompleted()&&(this.SX(e),!0)},t.setResult=function(e){this._result=e,this._task.runSynchronously()},t.trySetResult=function(e){return!this._task.get_isCompleted()&&(this.setResult(e),!0)},t.setCanceled=function(){this._task.setCanceled()},t.trySetCanceled=function(){return this._task.trySetCanceled(!1)},e}();Object(i.a)(s,"TaskCompletionSource",null,[])},function(e,t,n){var i=n(120),r=n(293).f,a=n(193),o=n(235),s=n(367),l=n(402),c=n(405);e.exports=function(e,t){var n,u,d,p,h,m=e.target,g=e.global,f=e.stat;if(n=g?i:f?i[m]||s(m,{}):(i[m]||{}).prototype)for(u in t){if(p=t[u],d=e.noTargetGet?(h=r(n,u))&&h.value:n[u],!c(g?u:m+(f?".":"#")+u,e.forced)&&void 0!==d){if(typeof p==typeof d)continue;l(p,d)}(e.sham||d&&d.sham)&&a(p,"sham",!0),o(n,u,p,e)}}},function(e,t,n){var i=n(120);e.exports=i},function(e,t,n){"use strict";n.r(t),n.d(t,"ContinuableTask",(function(){return a}));var i=n(0),r=n(109);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._action$1=null,t._actionWithData$1=null,t._parent=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.execute=function(){return this._action$1?this._action$1(this._parent):this._actionWithData$1(this._parent,this._data),!0},i.C=function(e,t){var n=new i;return n._action$1=e,n._parent=t,n},i.CO=function(e,t,n){var r=new i;return r._actionWithData$1=e,r._data=t,r._parent=n,r},i}(r.Task);Object(i.a)(a,"ContinuableTask",r.Task,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}return e.isClientError=function(e){return e>=400&&e<=499},e.isServerError=function(e){return e>=500&&e<=599},e}();r.accepted_202=202,r.ambiguous_300=300,r.badGateway_502=502,r.badRequest_400=400,r.conflict_409=409,r.continue_100=100,r.created_201=201,r.expectationFailed_417=417,r.forbidden_403=403,r.found_302=302,r.gatewayTimeout_504=504,r.gone_410=410,r.httpVersionNotSupported_505=505,r.internalServerError_500=500,r.lengthRequired_411=411,r.methodNotAllowed_405=405,r.moved_301=301,r.movedPermanently_301=301,r.multipleChoices_300=300,r.noContent_204=204,r.nonAuthoritativeInformation_203=203,r.notAcceptable_406=406,r.notFound_404=404,r.notImplemented_501=501,r.notModified_304=304,r.OK_200=200,r.partialContent_206=206,r.paymentRequired_402=402,r.preconditionFailed_412=412,r.proxyAuthenticationRequired_407=407,r.redirect_302=302,r.redirectKeepVerb_307=307,r.redirectMethod_303=303,r.requestedRangeNotSatisfiable_416=416,r.requestEntityTooLarge_413=413,r.requestTimeout_408=408,r.requestUriTooLong_414=414,r.resetContent_205=205,r.seeOther_303=303,r.serviceUnavailable_503=503,r.switchingProtocols_101=101,r.temporaryRedirect_307=307,r.tooManyRequest_429=429,r.unauthorized_401=401,r.unsupportedMediaType_415=415,r.unused_306=306,r.upgradeRequired_426=426,r.useProxy_305=305,r.insufficientStorage_507=507,Object(i.a)(r,"HttpStatusCode",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i,r=n(0);!function(e){e[e.notDefined=-1]="notDefined",e[e.unknown=0]="unknown",e[e.keyboard=1]="keyboard",e[e.mouse=2]="mouse",e[e.touch=3]="touch",e[e.pen=4]="pen",e[e.voice=5]="voice",e[e.crossSlide=9]="crossSlide"}(i||(i={})),Object(r.b)("InputMethod",i)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(33),a=n(3),o=function(){function e(){this.ApplicationVersion=null,this.IsCoauthSession=!1,this.IsRealCoauthSession=!1,this.IsRealEdit=!1,this.HasReceivedInboundReplications=!1,this.HostResponseStats=null,this.SessionMergeInfo=0,this.CookieComplianceBanner=0,this.PrivacyNotice=0,this.Feedback=0,this.FrameMode=null,this.RenavigationReason=null,this.HasDataLoss=!1,this.ClientThrottlingProtection=null,this.HostServiceLevel=null,this.RequestedCallThrottling=null,this.WacServiceLevel=null,this.MemoryUsageData=null,this.SharingStatus=null,this.HadSettingsRefresh=!1,this.IsMixedCoauthSession=!1,this.WacSessionDatacenter=null,this.ApplicationVersion="",this.IsCoauthSession=!1,this.IsRealCoauthSession=!1,this.IsRealEdit=!1,this.HasReceivedInboundReplications=!1,this.SessionMergeInfo=0,this.FrameMode="",this.CookieComplianceBanner=0,this.PrivacyNotice=0,this.HasDataLoss=!1,this.HostResponseStats=null,this.MemoryUsageData=null,this.IsMixedCoauthSession=!1}var t=e.prototype;return t.markAsCoauthSession=function(){this.IsCoauthSession=!0},t.markAsRealEditSession=function(){this.IsRealEdit=!0},t.markAsActiveCoauthSession=function(){this.HasReceivedInboundReplications=!0},t.markAsMixedCoauthSession=function(){this.IsMixedCoauthSession=!0},t.fillFromAppSettings=function(e){this.ApplicationVersion=e.getStringAppSetting("BuildVersion")||"0.0.0.0",this.HostResponseStats=this.parseHostResponseStats(e.getStringAppSetting("HostResponseStats")),this.ClientThrottlingProtection=e.getStringAppSetting("ClientThrottlingProtection")||"",this.HostServiceLevel=e.getStringAppSetting("HostServiceLevel")||"",this.RequestedCallThrottling=e.getStringAppSetting("RequestedCallThrottling")||"",this.WacServiceLevel=e.getStringAppSetting("WacServiceLevel")||"",this.SharingStatus=e.getStringAppSetting("SharingStatus")||""},t.parseHostResponseStats=function(e){try{if(e)return r.b(e)||{}}catch(t){a.ULS.sendTraceTag(589857932,201,10,"Exception thrown from JsonSerializer.SecureDeserialize for responseStats:{0}. Exception:{1}",e,t)}return{}},t.handleOnSettingsRefresh=function(e,t){this.fillFromAppSettings(t.newRefreshedSettingsGetter)},e}();Object(i.a)(o,"SessionFinishedDataPlumber",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(23),o=(n(9),n(7)),s=n(156),l=n(77),c=n(42),u=n(6);var d=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.buildControlDom=function(e,t){var n=e.controlProperties,i=a.Control.createOuterElement("cui-footerbutton",e),r=u.a.createElement("span");return r.appendChild(document.createTextNode(n.LabelText)),i.title=n.Description,i.appendChild(r),new c.a(t,i)},i}(l.a);Object(i.a)(d,"MenuFooterButtonDomStrategy",l.a,[]);var p=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.buildControlDom=function(e,t){var n=e.controlProperties,r=u.a.createElement("img"),o=u.a.createClusteredImageContainerNew(5,n.Image32by32,n.Image32by32Class,r,!0,!1);u.a.ensureCSSClassOnElement(o,"cui-img-32by32"),u.a.ensureCSSClassOnElement(o,"cui-headerbutton-img");var s=i.createLabelDomElement(n.LabelText),l=a.Control.createOuterElement("cui-ctl-medium cui-headerbutton",e);return l.title=n.Description,o.appendChild(r),l.appendChild(o),l.appendChild(s),new c.a(t,l)},i.createLabelDomElement=function(e){var t=u.a.createElement("span");return t.className="cui-ctl-mediumlabel",t.appendChild(document.createTextNode(e)),t},i}(l.a);Object(i.a)(p,"MenuHeaderButtonDomStrategy",l.a,[]);var h=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.buildControlDom=function(e,t){var n=e.controlProperties,r=u.a.createElement("img"),o=u.a.createClusteredImageContainerNew(5,n.Image32by32,n.Image32by32Class,r,!0,!1);u.a.ensureCSSClassOnElement(o,"cui-img-32by32");var s=null;(s=u.a.createElement("span")).className="cui-ctl-menulabel cui-mrubutton-textcontainer",s.appendChild(i.createLabelDomElement(n.LabelText)),s.appendChild(i.createDescriptionDomElement(n.Description));var l=a.Control.createOuterElement("cui-ctl-medium cui-mrubutton",e);return l.title=n.LabelText,l.appendChild(o),l.appendChild(s),new c.a(t,l)},i.createDescriptionDomElement=function(e){var t=u.a.createElement("span");return t.className="UIFont cui-mrubutton-description",t.appendChild(document.createTextNode(e)),t},i.createLabelDomElement=function(e){var t=u.a.createElement("span");return t.className="cui-mrubutton-title",t.appendChild(document.createTextNode(e)),t},i}(l.a);Object(i.a)(h,"MruButtonDomStrategy",l.a,[]);var m=n(202),g=n(3);var f=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.buildControlDom=function(e,t){var n=e.controlProperties,r="cui-ctl-medium",o=!1,s=!1,l=u.a.createElement("img");void 0!==n.Image95by123&&null!==n.Image95by123?(l.src=n.Image95by123,l.className="cui-img-95by123",r+=" cui-templatebutton-portrait",o=!0):void 0!==n.Image123by95&&null!==n.Image123by95?(l.src=n.Image123by95,l.className="cui-img-123by95",r+=" cui-templatebutton-landscape"):void 0!==n.Image123by69&&null!==n.Image123by69?(l.src=n.Image123by69,l.className="cui-img-123by69",r+=" cui-templatebutton-shortlandscape"):void 0!==n.Image100by100&&null!==n.Image100by100&&(l.src=n.Image100by100,l.className="cui-img-100by100",r+=" cui-templatebutton-square",s=!0),$addHandler(l,"load",(function(){i.logThumbnailPerfAndRetryIfNecessary(l,!0)})),$addHandler(l,"error",(function(){i.logThumbnailPerfAndRetryIfNecessary(l,!1)}));var d=u.a.createElement("div"),p=i.createLabelDomElement(n.LabelText,o,s),h=a.Control.createOuterElement(r,e);return h.title=n.LabelText,d.appendChild(l),h.appendChild(d),h.appendChild(p),new c.a(t,h)},i.createLabelDomElement=function(e,t,n){var i=u.a.createElement("span");return i.className="UIFont cui-templatebutton-label-"+(t?"portrait":n?"square":"landscape"),i.appendChild(document.createTextNode(e)),i},i.logThumbnailPerfAndRetryIfNecessary=function(e,t){var n,i=e.getAttribute("retry");if("l"!==i){var r="r"===i,a=e.src,o=((n={}).ThumbnailUrl=a,n.CompletedSuccessfully=t,n.IsRetry=r,n),s=window.performance;if(s&&"undefined"!=typeof s.getEntriesByName){var l=s.getEntriesByName(a);if(l&&l.length>0){var c=l[0];o.Duration=parseInt(String(c.duration)),o.FetchStart=parseInt(String(c.fetchStart)),o.ResponseEnd=parseInt(String(c.responseEnd))}}if(g.ULS.sendTraceTag(4515987,202,t?50:15,"Template thumbnail download finished {0}",o),!t)if(r)e.setAttribute("retry","l");else{var u=e.src;e.src=null,e.src=u,e.setAttribute("retry","r")}}},i}(l.a);Object(i.a)(f,"TemplateButtonDomStrategy",l.a,[]);var v=n(123),_=n(5);function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return b}));var b=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i)||this).addDisplayMode("Small"),r.addDisplayMode("Small14"),r.addDisplayMode("Small20"),r.addDisplayMode("Small24"),r.addDisplayMode("Medium"),r.addDisplayMode("Medium14"),r.addDisplayMode("Medium20"),r.addDisplayMode("MediumCompact"),r.addDisplayMode("Large"),r.addDisplayMode("Large16"),r.addDisplayMode("Large30"),r.addDisplayMode("LargeNoText"),r.addDisplayMode("Menu"),r.addDisplayMode("Menu16"),r.addDisplayMode("Menu16DescriptionEnabled"),r.addDisplayMode("MenuTellMe"),r.addDisplayMode("MenuTellMeExtended"),r.addDisplayMode("Menu20"),r.addDisplayMode("Menu32"),r.addDisplayMode("Menu48"),r.addDisplayMode("MenuFooter"),r.addDisplayMode("MenuHeader"),r.addDisplayMode("MenuMru"),r.addDisplayMode("MenuTemplate"),r.addDisplayMode("FloatieLarge"),r.addDisplayMode("Initials"),r.stateProperties[s.a.LabelText]=r.labelText=r.controlProperties.LabelText,r.stateProperties[s.a.Visible]=r.visible,r.stateProperties[s.a.HasPopup]=u.a.isTrue(i.HasPopup),r.stateProperties[s.a.Alt]=_.b(r.controlProperties.Alt)?r.controlProperties.LabelText:r.controlProperties.Alt,r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var l,c,g,b=i.prototype;return b.createComponentDomForDisplayMode=function(e){var t=null,n=this.getDomElementCreationStrategy(e);if(n){if(t=n.buildControlDom(this,e),this.hasPopup&&o.a.setAriaAttribute(t.elmControl,o.a.ariaHasPopupAttribute,o.a.ariaTrueValue),12===this.root.rootType){var i=!_.b(this.controlProperties.Image16by16);(!i&&"Medium"===e||i&&"Small"===e)&&(Sys.UI.DomElement.addCssClass(t.elmControl,"showBorder"),"Medium"===e&&Sys.UI.DomElement.addCssClass(t.elmLabel,"showBorder"))}if(19===this.root.rootType&&!_.b(this.controlProperties.ShortcutHint)){u.a.ensureCSSClassOnElement(t.elmControl,"cui-shortcut-container");var r=u.a.createElement("span");r.innerText=this.controlProperties.ShortcutHint,r.className=t.elmLabel.className,u.a.ensureCSSClassOnElement(r,"cui-shortcut-hint"),t.elmControl.appendChild(r)}var a="Initials"===t.displayMode?t.elmIconContainer:t.elmImage;this.setIconBackgroundColor(a)}else 0;return t},b.getDomElementCreationStrategy=function(e){switch(e){case"MenuMru":return new h;case"MenuTemplate":return new f;case"MenuHeader":return new p;case"MenuFooter":return new d;default:return new m.a}},b.getTextValue=function(){return this.labelText},b.setIconBackgroundColor=function(e){e&&""!==this.controlProperties.ImageBackColor&&(e.style.backgroundColor=this.controlProperties.ImageBackColor)},b.constructClonedControl=function(e,t){return new i(e,this.id,t)},l=i,(c=[{key:"controlType",get:function(){return Object(r.c)(v.Jewel,this.root)?a.Control.fileMenuButtonControlType:a.Control.buttonControlType}},{key:"needsAKeytip",get:function(){return!0}},{key:"focusableElement",get:function(){return this.getDisplayedComponentElement()}},{key:"activatesOnPress",get:function(){return!this.isStandardMenuItem()}},{key:"hasPopup",get:function(){return this.stateProperties[s.a.HasPopup]}}])&&y(l.prototype,c),g&&y(l,g),i}(a.Control);Object(i.a)(b,"Button",a.Control,[87,88])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=(n(2),n(258));n(9);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,i;function r(){var t;return(t=e.call(this)||this)._actionData=null,t._telemetryData=null,t._actionManager=null,t._actionId=0,t._behavior=0,t._beginMode=0,t._reportingData=null,t._response=0,t._invocationMethod=0,t._commandLocation=0,t._commandTabName=null,t}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var o,s,l,c=r.prototype;return c.initAction=function(e,t,i,r,a,o){void 0===o&&(o=null);var s=n(1).AFrameworkApplication;this._actionId=t,this._actionData=a,this._telemetryData=o,this._behavior=i,this._response=1,this._actionManager=e,this._reportingData=r,this._invocationMethod=e.invocationMethod,this._commandLocation=e.commandLocation,this._commandTabName=e.commandTabName,this._beginMode=s.activeFrame?s.activeFrame.mode:0},c.setCurrentOperationFromContext=function(e){var t=n(319).ProcessContextSetOperation,i=n(320).ProcessContextOperation;e.isContextSet?t.registerInstance(this._actionManager,this,e,this.actionId,this.behavior,!0,this.reportingData,this._actionData,this._telemetryData):i.registerInstance(this._actionManager,this,e,this.actionId,this.behavior,!0,this.reportingData,this._actionData,this._telemetryData)},c.processCurrentOperation=function(){var e=n(61).ActionManager,t=this.childOperation;if(t){if(t.inProgress){if(t.run(),t.hasYielded)return 1;0}0;var i=t.response;return this._response=e.mergeResponses(this.response,i),t.recycle(),this.clearChildOperation(),i}return 0},o=r,(s=[{key:"actionId",get:function(){return this._actionId}},{key:"behavior",get:function(){return this._behavior}},{key:"beginMode",get:function(){return this._beginMode}},{key:"reportingData",get:function(){return this._reportingData}},{key:"actionData",get:function(){return this._actionData}},{key:"telemetryData",get:function(){return this._telemetryData}},{key:"response",get:function(){return this._response}},{key:"invocationMethod",get:function(){return this._invocationMethod}},{key:"commandLocation",get:function(){return this._commandLocation}},{key:"commandTabName",get:function(){return this._commandTabName}}])&&a(o.prototype,s),l&&a(o,l),r}(r.a);Object(i.a)(o,"ActionOperation",r.a,[197,198])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){this._requestCompletedCallback=null}var t,i,a,o=e.prototype;return o.setRequestCompleted=function(e){this._requestCompletedCallback=e},o.onRequestCompleted=function(){this._requestCompletedCallback&&this._requestCompletedCallback()},e.create=function(){return e.browserSupportsCrossDomainRequests?e.requestGenerator():null},t=e,a=[{key:"browserSupportsCrossDomainRequests",get:function(){return!!e.requestGenerator}},{key:"requestGenerator",get:function(){if(!e._requestGenerator){var t=null;"undefined"!=typeof(new XMLHttpRequest).withCredentials?t=function(){return new(0,n(507).XMLHttpCrossDomainRequest)}:"undefined"!=typeof XDomainRequest&&(t=function(){return new(0,n(508).XDomainCrossDomainRequest)}),e._requestGenerator=t}return e._requestGenerator}}],(i=[{key:"statusText",get:function(){return""}}])&&r(t.prototype,i),a&&r(t,a),e}();a._requestGenerator=null,Object(i.a)(a,"CrossDomainRequestBase",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(0),r=n(2),a=n(65),o=(n(9),n(7)),s=n(64),l=n(6);function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(e){var t,i;function a(t,n,i,r,o){var s;return(s=e.call(this,t,n,i,r)||this)._width=0,s._focusedIndex=-1,s.properties=o,s.width=parseInt(s.properties.Width),s.elementDimensions=a.convertStringToGalleryElementDimensions(s.properties.ElementDimensions),s}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var u,p,h,m=a.prototype;return m.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.elementInternal.setAttribute(o.a.ariaRoleAttribute,o.a.ariaGridRole);var e=l.a.createElement("tbody");this.elementInternal.appendChild(e),this.appendChildrenToElement(e)},m.appendChildrenToElement=function(e){for(var t,n,i,r=Math.ceil(this.children.count/this.width),a=0,s=0;s<r;s++){(t=l.a.createElement("tr")).setAttribute(o.a.ariaRoleAttribute,o.a.ariaRowRole),t.setAttribute(o.a.ariaLabelAttribute,String.format(CommonUIStrings.l_GalleryRowAccessibleLabelFormat,s+1));for(var c=0;c<this.width;c++)(n=l.a.createElement("td")).setAttribute(o.a.ariaRoleAttribute,o.a.ariaPresentationRole),n.className="cui-gallery-td cui-gallery-element-"+l.a.galleryElementDimensionsToSizeString[this.elementDimensions],a<this.children.count&&((i=this.children.get_item(a++)).ensureDOMElement(),n.appendChild(i.elementInternal),i.ensureRefreshed()),t.appendChild(n);e.appendChild(t)}},m.updateFocusedIndex=function(e){for(var t,n=0,i=c(this.children);!(t=i()).done;){if(t.value.updateFocusedIndex(e))return this._focusedIndex=n,!0;n++}return!1},m.resetFocusedIndex=function(){if(this.children.count){this._focusedIndex=-1;for(var e,t=c(this.children);!(e=t()).done;){e.value.resetFocusedIndex()}}},m.focusNext=function(e){var t=this.children.count,i=n(23).Control.focusNextIndexInGrid(this._focusedIndex,this.width,t,e);if((this._focusedIndex>=0&&this._focusedIndex<t&&this.children.get_item(this._focusedIndex).resetFocusedIndex(),i!==this._focusedIndex)&&this.children.get_item(i).control.setFocusOnControl())return this._focusedIndex=i,!0;return this._focusedIndex=-1,!1},m.ensureCorrectChildType=function(e){var t=n(278).GalleryButton;if(!Object(r.c)(s.a,e))throw Error.create("Galleries can only have children controls of type GalleryButton");var i=e;if(!Object(r.c)(t,i.control))throw Error.create("Galleries can only have children of type GalleryButton")},m.clone=function(e){for(var t,n=e.createGallery(this.id,this.title,this.description,this.properties),i=c(this.children);!(t=i()).done;){var r=t.value,a=r.control.clone(e);n.addChild(a.createComponentForDisplayMode(r.displayMode))}return n},a.convertStringToGalleryElementDimensions=function(e){switch(e){case"Size16by16":return 1;case"Size40by40":return 2;case"Size48by48":return 3;case"Size61by75":return 4;case"Size64by48":return 5;case"Size85by48":return 6;case"Size110by75":return 7;case"Size85by16":return 8;case"Size32by32":return 9;case"Size120by20":return 10;case"Size20by20":return 11;case"Size24by24":return 12;case"Size84by21":return 13;case"Size90by21":return 14;case"Size200by200":return 15;case"Size70by48":return 16;default:throw Error.argument("s","The parameter s is not a valid GalleryElementDimension")}},u=a,(p=[{key:"domElementTagName",get:function(){return"table"}},{key:"cssClass",get:function(){return"cui-gallery"}},{key:"tableElementInternal",get:function(){return this.elementInternal},set:function(e){this.elementInternal=e}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}}])&&d(u.prototype,p),h&&d(u,h),a}(a.a);Object(i.a)(p,"Gallery",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.Image16by16Class="Image16by16Class",r.Image32by32Class="Image32by32Class",r.On="On",r.LabelText="LabelText",r.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly",r.EnsureControlRoleIsButton="EnsureControlRoleIsButton",r.Visible="Visible",Object(i.a)(r,"SplitButtonCommandProperties",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(11),o=n(240),s=n(63),l=n(17),c=(n(9),n(54),n(324)),u=function(){this.dragAdapters=new c.a};function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(u,"DragAdapterCache",null,[]);var p=function(e){var t,n,i,r,a;function o(t){var n;return(n=e.call(this)||this)._triggeredExternally=t,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=o,(r=[{key:"triggeredExternally",get:function(){return this._triggeredExternally}}])&&d(i.prototype,r),a&&d(i,a),o}(Sys.EventArgs);Object(i.a)(p,"DragCancelEventArgs",Sys.EventArgs,[]);var h=n(41);function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var g=function(e){var t,n,i,r,a;function o(t,n,i,r,a,o,s,l,c,u,d){var p;return(p=e.call(this,t,n,r,d)||this)._beginMouseCapture=!1,p.preventEventDefaultOnDragPossible=!0,p._caught=i,p._elementPoint=a,p._screen=o,p._client=s,p._button=l,p._shiftKey=c,p._ctrlKey=u,p}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.createFromMouseEvent=function(e,t,n,i){if(n.rawEvent){var r=n.rawEvent;return new o(e,h.EventHandlerArgs.getSourceElement(n),t,n,null,new Sys.UI.Point(r.screenX,r.screenY),new Sys.UI.Point(r.clientX,r.clientY),h.EventHandlerArgs.getMouseButton(r),r.shiftKey,r.ctrlKey,i)}return new o(e,n.target,t,n,null,new Sys.UI.Point(n.screenX,n.screenY),new Sys.UI.Point(n.clientX,n.clientY),n.button,n.shiftKey,n.ctrlKey,i)},o.createFromTouchArgs=function(e){var t=e.innerEvent.rawEvent,n=t.shiftKey,i=t.ctrlKey;return new o(e.eventName,e.sourceElement,e.caughtElement,e.innerEvent,e.elementPoint,e.screenPoint,e.clientPoint,Sys.UI.MouseButton.leftButton,n,i,3)},i=o,(r=[{key:"beginMouseCapture",get:function(){return this._beginMouseCapture},set:function(e){this._beginMouseCapture=e}},{key:"caughtElement",get:function(){return this._caught}},{key:"mouseButton",get:function(){return this._button}},{key:"shiftKey",get:function(){return this._shiftKey}},{key:"ctrlKey",get:function(){return this._ctrlKey}},{key:"elementPoint",get:function(){return this._elementPoint||(this._elementPoint=h.EventHandlerArgs.getElementPoint(this._client,this.sourceElement)),this._elementPoint}},{key:"screenPoint",get:function(){return this._screen}},{key:"clientPoint",get:function(){return this._client}}])&&m(i.prototype,r),a&&m(i,a),o}(h.EventHandlerArgs);Object(i.a)(g,"DragEventArgs",h.EventHandlerArgs,[]);var f=n(48),v=n(4),_=n(24),y=n(73),b=n(28),S=n(198),C=n(246),A=n(57),I=n(13),w=n(122);function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var E=function(){function e(e,t){this._stringRepresentation=null,this.guid=e,this.n=t}var t,n,i,r=e.prototype;return r.equals=function(e){return!!e&&this.n===e.n&&this.guid.equals(e.guid)},r.toString=function(){return this._stringRepresentation||(this._stringRepresentation="{"+this.guid+"}{"+this.n+"}")},e.create=function(){return!e._lastGuid||e._lastExtension>=255?(e._lastGuid=w.a.create(),e._lastExtension=1):e._lastExtension++,new e(e._lastGuid,e._lastExtension)},e.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].equals(t))return n;return-1},e.createFromString=function(t){return new e(w.a.createFromString(I.a.substring(t,1,37)),parseInt(I.a.substring(t,39,t.length-1)))},e.areEqual=function(e,t){return e?e.equals(t):!t},t=e,i=[{key:"nil",get:function(){return e._nil||(e._nil=new e(w.a.nil,0))}}],(n=null)&&T(t.prototype,n),i&&T(t,i),e}();E._nil=null,E._lastGuid=null,E._lastExtension=0,Object(i.a)(E,"ExtendedGuid",null,[]);var k=n(60),M=n(22),P=n(50),F=n(16),D=n(10),O=n(114),R=n(21),x=n(3);function U(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return L}));var L=function(e){var t,i;function c(){var t;(t=e.call(this)||this)._inputDataName=o.a._dragAdapterCache,t._dragRegions=[],t._dragAdapter=null,t._endingDrag=!1,t._callingDragAdapterDragEnd=!1,t._lastDownEvent=null,t._dragCandidates=[],t._downDetected=!1,t._lastDownX=0,t._lastDownY=0,t._taskManagerPauseCount=0,t._cursorPinningTool=[],t._capturedElement=null,t._isFromIE10Touch=!1,t._pointerEventsCached=new s.a,t._eventProcessorPriority=0,t._inTouchDrag=!1,t._gestureInputManagerFuture=null,t._taskManagerPauseGuid=null,t._taskManagerPauseStopwatch=null,t._useGestureInputManagerPointerCache=!1,t._cancelDragFromGestureInputManagerIsEnabled=!1,t.cancelDragForMultiTouchPointerGesture=!1;var i=n(1).AFrameworkApplication;t._eventHandlerManager=f.EventHandlerManager.instance,t._outOfWindowDraggableAdapters=[],f.EventHandlerManager.instance.registerOnBeforeEventProcessed(v.EventNames.msPointerDown,Object(r.d)(B(t),t.onMsPointerDownEventHeard,"onMsPointerDownEventHeard")),f.EventHandlerManager.instance.registerOnBeforeEventProcessed(v.EventNames.browserPointerDown,Object(r.d)(B(t),t.onMsPointerDownEventHeard,"onMsPointerDownEventHeard"));var a=n(1).AFrameworkApplication.appSettingsManager;return t._timeTaskManagerPauseInDragInputManagerIsEnabled=!!a&&a.getBooleanAppSetting("TimeTaskManagerPauseInDragInputManagerIsEnabled"),t._isMultiTouchGestureEnabled=i.isMultiTouchGestureEnabled(),t._isMultiTouchGestureEnabled&&(t._useGestureInputManagerPointerCache=a.getBooleanAppSetting("UseGestureInputManagerPointerCacheIsEnabled"),t._useGestureInputManagerPointerCache?t._cancelDragFromGestureInputManagerIsEnabled=a.getBooleanAppSetting("CancelDragFromGestureInputManagerIsEnabled")&&a.getBooleanAppSetting("UsePointerCaptureIsEnabled"):(t._eventProcessorPriority=1,f.EventHandlerManager.instance.registerOnBeforeEventProcessed(v.EventNames.msPointerUp,Object(r.d)(B(t),t.onMsPointerUpOrCancelEventHeard,"onMsPointerUpOrCancelEventHeard")),f.EventHandlerManager.instance.registerOnBeforeEventProcessed(v.EventNames.browserPointerUp,Object(r.d)(B(t),t.onMsPointerUpOrCancelEventHeard,"onMsPointerUpOrCancelEventHeard")),a.getBooleanAppSetting("MultiTouchRegisterForPointerCancelIsEnabled")&&(f.EventHandlerManager.instance.registerOnBeforeEventProcessed(v.EventNames.msPointerCancel,Object(r.d)(B(t),t.onMsPointerUpOrCancelEventHeard,"onMsPointerUpOrCancelEventHeard")),f.EventHandlerManager.instance.registerOnBeforeEventProcessed(v.EventNames.browserPointerCancel,Object(r.d)(B(t),t.onMsPointerUpOrCancelEventHeard,"onMsPointerUpOrCancelEventHeard"))))),t}i=e,(t=c).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var d,m,I,w=c.prototype;return w.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(v.EventNames.get_dragEvents(),t,this._eventProcessorPriority,Object(r.d)(this,this.onDragEvent,"onDragEvent"))},w.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t,v.EventNames.get_dragEvents())},w.suspend=function(){this.cancelDragInternal(),e.prototype.suspend.call(this)},w.registerCursorPinningTool=function(e){Array.add(this._cursorPinningTool,e)},w.registerDragAdapter=function(e,t,n){void 0===n&&(n=!1),this.registerDragAdapterWithPriority(e,t,1,n)},w.registerDragAdapterWithPriority=function(e,t,n,i){void 0===i&&(i=!1);var r=this.getAdapterCache(e);r||(r=new u,this.setAdapterCache(e,r)),r.dragAdapters.length||this.registerDragRegion(e),r.dragAdapters.add(n,t),i&&Array.add(this._outOfWindowDraggableAdapters,t)},w.unregisterDragAdapter=function(e,t){var n=this.getAdapterCache(e);n&&(n.dragAdapters.remove(t),Array.remove(this._outOfWindowDraggableAdapters,t),n.dragAdapters.length||this.unregisterDragRegion(e))},w.isFakeClick=function(e){if("undefined"==typeof e||!e)return!1;if(e.Visibility)return this._downDetected;if(this._downDetected){var t=e.screenX,n=e.screenY,i=this._lastDownX-t,r=this._lastDownY-n;if(i<-4||i>4||r<-4||r>4)return!0;0}return!1},w.startDrag=function(e,t){(k.a.instance.pause(),this._taskManagerPauseCount++,this._timeTaskManagerPauseInDragInputManagerIsEnabled&&this.stopWatchBuilder&&(this.mouseManager&&this.mouseManager.registerHandler(v.EventNames.mouseLeave,window.document.body,Object(r.d)(this,this.onMouseLeaveEvent,"onMouseLeaveEvent")),this._taskManagerPauseGuid=E.create(),this._taskManagerPauseStopwatch=this.stopWatchBuilder.makeAndStartStopwatch("Task","TaskManagerPause"),x.ULS.sendTraceTag(590194892,310,50,"Pausing TaskManager: _taskManagerPauseGuid: {0}",this._taskManagerPauseGuid.toString())),3===t.inputSource)&&(S.TouchAndHoldAdapter.getTouchAndHoldAdapter(t.sourceElement).cancelTouchAndHold(),this._inTouchDrag=!0);this._dragAdapter=e,this._lastDownEvent=null,this._eventHandlerManager._isDragging=!0,Array.clear(this._dragCandidates)},w.cancelDrag=function(e){void 0===e&&(e=!1),(this.isInDrag||e)&&this.cancelDragInternal(!0)},w.cancelDragInternal=function(e){void 0===e&&(e=!1),this._endingDrag||this._callingDragAdapterDragEnd||(this._dragAdapter&&this._dragAdapter.onDragCancel(new p(e)),this._downDetected=!1,this.endDrag())},w.endDrag=function(){var e=this;this._endingDrag||(this._endingDrag=!0,this._dragAdapter=null,Array.clear(this._dragCandidates),this._lastDownEvent=null,this._inTouchDrag&&(this._isFromIE10Touch||this._eventHandlerManager.temporarilyDisableBrowserClicks(),this._inTouchDrag=!1),this._isFromIE10Touch=!1,this.browserReleaseCapture(),this._taskManagerPauseCount>0&&(k.a.instance.resume(),this._taskManagerPauseCount--,this._taskManagerPauseStopwatch&&(this._taskManagerPauseStopwatch.stop(),x.ULS.sendTraceTag(590194893,310,50,"Resuming TaskManager: _taskManagerPauseGuid: {0}, AgeInMilliseconds: {1}",this._taskManagerPauseGuid.toString(),this._taskManagerPauseStopwatch.ageInMilliseconds),this._taskManagerPauseStopwatch=null,this.mouseManager&&this.mouseManager.unregisterHandler(v.EventNames.mouseLeave,window.document.body,Object(r.d)(this,this.onMouseLeaveEvent,"onMouseLeaveEvent")))),this._endingDrag=!1,this.resetCursor(),window.setTimeout((function(){e._eventHandlerManager._isDragging=!1}),0))},w.shouldCancelDrag=function(e,t){if(e===v.EventNames.mouseOut&&h.EventHandlerArgs.getSourceElement(t).ownerDocument===window.document){if(this._dragAdapter&&Array.contains(this._outOfWindowDraggableAdapters,this._dragAdapter))return!1;var n=new Sys.UI.Point(t.clientX,t.clientY);if(!F.a.isPointInElement(window.document.body,n))return!0}return!1},w.shouldEndDrag=function(e){return e===v.EventNames.mouseUp||e===v.EventNames.touchEnd},w.browserCapture=function(e){e.setCapture&&e.releaseCapture&&(this.isMouseCaptured&&this.browserReleaseCapture(),this._eventHandlerManager.initializeEventForElement(v.EventNames.loseCapture,e,this._eventProcessorPriority,Object(r.d)(this,this.onLoseCapture,"onLoseCapture")),e.setCapture(),this._capturedElement=e)},w.browserReleaseCapture=function(){this.isMouseCaptured&&(this._eventHandlerManager.deinitializeEventForElement(this._capturedElement,v.EventNames.loseCapture),this._capturedElement.releaseCapture(),this._capturedElement=null)},w.onLoseCapture=function(e,t,n){return this.cancelDragInternal(),!0},w.getAdapterCache=function(e){return O.a(e,this._inputDataName)},w.setAdapterCache=function(e,t){O.b(e,this._inputDataName,t)},w.isEventLandedBeyondSourceElement=function(e){return l.a.eventLandedBeyondSourceElement(e)},w.registerDragRegion=function(e){Array.add(this._dragRegions,e),9===e.nodeType?this._eventHandlerManager.initializeListForElement(v.EventNames.get_dragEvents(),e,this._eventProcessorPriority,Object(r.d)(this,this.onDocumentDragEvent,"onDocumentDragEvent")):this._eventHandlerManager.initializeListForElement(v.EventNames.get_dragEvents(),e,this._eventProcessorPriority,Object(r.d)(this,this.onDragEvent,"onDragEvent"))},w.unregisterDragRegion=function(e){Array.remove(this._dragRegions,e),e.nodeType,this._eventHandlerManager.deinitializeListForElement(e,v.EventNames.get_dragEvents())},w.onMouseLeaveEvent=function(e){return this._taskManagerPauseStopwatch&&x.ULS.sendTraceTag(589606977,310,50,"MouseLeave and not resuming TaskManager: _taskManagerPauseGuid: {0}, AgeInMilliseconds: {1}",this._taskManagerPauseGuid.toString(),this._taskManagerPauseStopwatch.ageInMilliseconds),!1},w.onDragEvent=function(e,t,n){return this.onDragEventInternal(e,t,n,!0)},w.onDocumentDragEvent=function(e,t,n){return this.onDragEventInternal(e,t,n,D.a.isFirefox),!1},w.onDragEventInternal=function(e,t,n,i){var r,o=Array.contains(v.EventNames.get_touchEvents(),e)||this._isFromIE10Touch;if(o&&A.a.isMultiTouch(n))return this.cancelDragInternal(),!1;if(this._isMultiTouchGestureEnabled&&(this._cancelDragFromGestureInputManagerIsEnabled?this.cancelDragForMultiTouchPointerGesture:this._useGestureInputManagerPointerCache?!!this.gestureInputManagerFuture&&!!this.gestureInputManagerFuture.instance&&this.gestureInputManagerFuture.instance.handlingMultiTouchPointerGesture():this._pointerEventsCached.get_count()>1))return this.cancelDragInternal(),!1;if(9!==t.nodeType&&!this.shouldProcessEvent(e,n,Object(a.a)((function(){return r}),(function(e){return r=e}))))return r;if(this._dragAdapter){var s=!1;if(this.shouldCancelDrag(e,n))this._dragAdapter.onDragCancel(new p(!1)),s=!0;else if(this.shouldEndDrag(e)){var c=this.createDragEventArgs(e,t,n,o);if(!c)return!1;0,this._callingDragAdapterDragEnd=!0,this._dragAdapter.onDragEnd(c),this._callingDragAdapterDragEnd=!1,s=!0}else if(e===v.EventNames.touchMove||e===v.EventNames.mouseMove){var u=this.createDragEventArgs(e,t,n,o);if(!u)return!1;0,this._dragAdapter.onDragMove(u)?u.beginMouseCapture&&!this.isMouseCaptured&&this.browserCapture(t):(this._dragAdapter.onDragCancel(new p(!1)),s=!0)}return s&&this.endDrag(),l.a.cancelEvent(n),!0}if(this._lastDownEvent&&(this.shouldCancelDrag(e,n)||this.shouldEndDrag(e))&&this.cancelDragInternal(),e===v.EventNames.mouseDown||e===v.EventNames.touchStart){Array.add(this._dragCandidates,t);for(var d=n.target;d;d=d.parentNode)if(Array.contains(this._dragRegions,d)){var h=this.createDragEventArgs(e,t,n,o);this._lastDownEvent=h;var m=this.getAdapterCache(t);if(m){for(var g=!1,f=!0,y=0;y<m.dragAdapters.length;++y){var b=m.dragAdapters.get_item(y);if(h.beginMouseCapture=!0,b.isDragPossible(h)){g=!0,f=h.beginMouseCapture;break}}return g&&(f&&this.browserCapture(t),o||this.pinCursor(n),h.preventEventDefaultOnDragPossible&&(i&&n.preventDefault(),D.a.isFirefox&&_.FocusManager.tryFocus(document.defaultView))),!1}}return!1}if((e===v.EventNames.mouseMove||e===v.EventNames.touchMove)&&this._lastDownEvent){var S=this.createDragEventArgs(e,t,n,o),C=S.screenPoint.x-this._lastDownEvent.screenPoint.x,I=S.screenPoint.y-this._lastDownEvent.screenPoint.y,w=this.getDragThreshHold(n,o);if(C<-w||C>w||I<-w||I>w){for(var T=0;T<this._dragCandidates.length;++T){var E=this._dragCandidates[T],k=this.getAdapterCache(E);if(k)for(var M=0;M<k.dragAdapters.length;++M){var P=k.dragAdapters.get_item(M);if(P.onDragStart(this._lastDownEvent))return P.onDragMove(S)?(this.startDrag(P,this._lastDownEvent),l.a.cancelEvent(n),!0):(P.onDragCancel(new p(!1)),this.cancelDragInternal(),!1)}}return this.cancelDragInternal(),!1}return!1}return!(!this.shouldEndDrag(e)&&!this.shouldCancelDrag(e,n))&&(this.cancelDragInternal(),!1)},w.shouldProcessEvent=function(e,t,n){if(!this._dragAdapter&&e===v.EventNames.mouseDown&&this.isEventLandedBeyondSourceElement(t))return n.val=!1,!1;if(!this.isEnabled)return n.val=!1,!1;if(!M.DomUtils.isValidElement(t.target)&&9!==t.target.nodeType)return n.val=!1,!1;if(k.a.instance.isYielding)return n.val=!1,!1;if(e===v.EventNames.mouseDown&&(this._downDetected=!0,this._lastDownX=t.screenX,this._lastDownY=t.screenY),e===v.EventNames.click&&this._downDetected){if(this.isFakeClick(t.rawEvent))return this._downDetected=!1,l.a.cancelEvent(t),n.val=!0,!1;this._downDetected=!1}else 0;return e!==v.EventNames.mouseMove&&e!==v.EventNames.touchMove||l.a.ensureAppAwakeIfAsleep(),this._supressEvents?(l.a.cancelEvent(t),n.val=!0,!1):(n.val=!0,!0)},w.createDragEventArgs=function(e,t,n,i){var r;if(i&&A.a.isWebkitStyleTouchEvent(n)){var a=C.a.create(e,t,null,n);r=g.createFromTouchArgs(a)}else{var o=i?3:2;r=g.createFromMouseEvent(e,t,n,o)}return r},w.cancelPendingPointerEvents=function(){this._pointerEventsCached.clear()},w.onMsPointerUpOrCancelEventHeard=function(e){var t=e.rawEvent;if(null!=t){var n=t.pointerId;null!=n&&(x.ULS.sendTraceTag(594055954,310,50,"OnMsPointerUpOrCancelEventHeard: PointerId: {0}",n),this._pointerEventsCached.remove(n))}},w.onMsPointerDownEventHeard=function(e){if(this._isFromIE10Touch=3===b.a.getIeInputMethod(e),!this._useGestureInputManagerPointerCache){0;var t=e.rawEvent;if(null!=t){var n=t.pointerId;null==n||this._pointerEventsCached.contains(n)||(x.ULS.sendTraceTag(594055953,310,50,"OnMsPointerDownEventHeard: PointerId: {0}",n),this._pointerEventsCached.add(n))}}},w.pinCursor=function(e){for(var t=0;t<this._cursorPinningTool.length;++t){this._cursorPinningTool[t].pinCursor(e.target)}},w.resetCursor=function(){for(var e=0;e<this._cursorPinningTool.length;++e){this._cursorPinningTool[e].resetCursor()}},w.getDragThreshHold=function(e,t){return Sys.UI.DomElement.containsCssClass(e.target,"ewawebex")||D.a.isIPad?0:t?10:4},c.createDragInputManager=function(){return new c},c.disposeInputManager=function(){P.a(c._instance)},d=c,I=[{key:"instance",get:function(){if(!c._instance){var e=c.dragInputManagerFactory||c.createDragInputManager;c._instance=e()}return c._instance}}],(m=[{key:"isMouseCaptured",get:function(){return!!this._capturedElement}},{key:"gestureInputManagerFuture",get:function(){return this._gestureInputManagerFuture||(this._gestureInputManagerFuture=R.a.instance.resolveFuture("Common.IGestureInputManager"))}},{key:"stopWatchBuilder",get:function(){return n(1).AFrameworkApplication.activeFrame.theStopwatchBuilder}},{key:"mouseManager",get:function(){return y.a.instance}},{key:"isInDrag",get:function(){return!!this._dragAdapter}}])&&U(d.prototype,m),I&&U(d,I),c}(l.a);L._instance=null,L.dragInputManagerFactory=null,Object(i.a)(L,"DragInputManager",l.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(40),a=(n(9),n(54),function(){function e(){}return e.isBrowserUnderWebToadRun=function(t,n){t=t.toLowerCase();var i=String.format("[?&]{0}=",e.runIdParam),r=String.format("[?&]{0}=",e.scenarioIdParam),a=String.format("[?&]{0}=",e.userSessionDataParam);return(t.search(new RegExp(i))>-1||!!n(e.runIdParam))&&(t.search(new RegExp(r))>-1||!!n(e.scenarioIdParam))||t.search(new RegExp(a))>-1},e.loadTestHarness=function(){var t=n(1).AFrameworkApplication,i=document.createElement("script");i.type="text/javascript",t.useCrossOriginStaticScripts&&i.setAttribute("crossorigin","anonymous"),i.src=e.webToadHostName+"/Scripts/TestHarness.js",document.body.appendChild(i)},e.getStaticScriptPath=function(){var e=n(1).AFrameworkApplication;return r.a.staticContentHost+e.scriptFolderPath},e.getStaticContentQueryParameter=function(){return r.a.staticContentQueryParameter},e.AssertStringTag=function(e,t,n){0},e.RegisterErrorHandler=function(e){n(1).AFrameworkApplication.registerTestHarnessErrorHandler(e)},e.LogThroughClient=function(e){0},e}());a.runIdParam="wdrunid",a.scenarioIdParam="wdscenarioid",a.webToadHostName=null,a.userSessionDataParam="wdusersessiondata",a.userSessionData=null,Object(i.a)(a,"TestHarnessInterface",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(e,t,n){void 0===n&&(n=0),this._endpoint=e,this._scenario=t,this._scenarioType=n}var t,i,a;return e.create=function(t,n,i){return new e(t,n,i)},e.createFromAppType=function(t,n,i){return void 0===i&&(i=0),new e(e.getOfficeEndpointFromAppType(t),n,i)},e.createForCurrentApp=function(t,i){void 0===i&&(i=0);var r=n(1).AFrameworkApplication,a=1;return r.activeFrame&&r.activeFrame.applicationInstance&&(a=e.getOfficeEndpointFromAppType(r.activeFrame.applicationInstance.officeAppType)),new e(a,t,i)},e.getOfficeEndpointFromAppType=function(e){switch(e){case 3:return 6;case 1:return 2;case 2:return 4;case 4:return 3;case 5:return 5;default:return 1}},t=e,(i=[{key:"endpoint",get:function(){return this._endpoint}},{key:"scenario",get:function(){return this._scenario}},{key:"scenarioType",get:function(){return this._scenarioType}}])&&r(t.prototype,i),a&&r(t,a),e}();a.endpointParamName="haep",a.scenarioParamName="hascn",a.scenarioTypeParamName="hascnt",Object(i.a)(a,"HostAttributionInfo",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"CommonDebugOptions",(function(){return a}));var i=n(0),r=n(129);var a=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.ADebugOptionsTab);a.disallowAssertDebugging=void 0,a.disableAssert=void 0,a.assertsOnCompositionEventsTag=void 0,a.enableMaxAssertCount=void 0,a.disableCrossDocumentMessengerFreeSendingAllowList=void 0,a.disableCrossDocumentMessengerRecevingAllowList=void 0,a.disableCrossDocumentMessengerOriginAllowList=void 0,a.logRegisterHandlerCallstacks=void 0,a.logCancelEvents=void 0,a.showTouchPoints=void 0,a.disallowRename=void 0,a.allowPasteWhenRenaming=void 0,a.forceSignoutResponseUI=void 0,a.showSwitcherDropdownInHeader=void 0,a.showSignOutLinkInHeader=void 0,a.showSignInLinkInHeader=void 0,a.appChromeLocalOverride=void 0,a.showGoPremiumButton=void 0,a.licensingFreemium=void 0,a.licensingPremium=void 0,a.licensingForceRefresh=void 0,Object(i.a)(a,"CommonDebugOptions",r.ADebugOptionsTab,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(e){this._ignoreCase=e}var t=e.prototype;return t.equals=function(e,t){return e&&t?(this._ignoreCase&&(e=e.toUpperCase(),t=t.toUpperCase()),e===t):e===t},t.getHashCode=function(e){if(!e)return 0;this._ignoreCase&&(e=e.toUpperCase());for(var t=352654597,n=0;n<e.length;n+=2)t=(t<<5)+t+(t>>27)^(e.charCodeAt(n)|e.charCodeAt(n+1)<<16|0);return t},e.get_ordinal=function(){return e._ordinal||(e._ordinal=new e(!1))},e.get_ordinalIgnoreCase=function(){return e._ordinalIgnoreCase||(e._ordinalIgnoreCase=new e(!0))},e}();r._ordinal=null,r._ordinalIgnoreCase=null,Object(i.a)(r,"StringComparer",null,[22])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i,r=n(0);!function(e){e[e.unknown=0]="unknown",e[e.upperRibbon=1]="upperRibbon",e[e.ribbon=2]="ribbon",e[e.QAT=3]="QAT",e[e.jewel=4]="jewel",e[e.navigationPane=5]="navigationPane",e[e.keyboardShortcut=6]="keyboardShortcut",e[e.statusBar=7]="statusBar",e[e.dialog=8]="dialog",e[e.floatie=9]="floatie",e[e.notificationBar=10]="notificationBar",e[e.standaloneCuiRoot=11]="standaloneCuiRoot",e[e.taskPane=12]="taskPane",e[e.heroDock=13]="heroDock",e[e.singleLineRibbon=14]="singleLineRibbon",e[e.multilineRibbon=15]="multilineRibbon",e[e.overflow=16]="overflow",e[e.tellMe=17]="tellMe",e[e.farPeripheralControls=18]="farPeripheralControls",e[e.contextMenu=19]="contextMenu",e[e.dialogMenu=20]="dialogMenu",e[e.header=21]="header",e[e.fileMenu=22]="fileMenu",e[e.toolbar=26]="toolbar",e[e.canvas=30]="canvas"}(i||(i={})),Object(r.b)("UILocation",i)},function(e,t,n){"use strict";n.r(t),n.d(t,"floatEpsilon",(function(){return i})),n.d(t,"floatEqualish",(function(){return r})),n.d(t,"pointInBounds",(function(){return a})),n.d(t,"snapPointToBounds",(function(){return o})),n.d(t,"distancePointToPoint",(function(){return s})),n.d(t,"distancePointToBounds",(function(){return l})),n.d(t,"distancePointToBoundsWithBias",(function(){return c})),n.d(t,"isBetween",(function(){return u})),n.d(t,"isEqualish",(function(){return d})),n.d(t,"isCloseEnough",(function(){return p})),n.d(t,"subtractPoint",(function(){return h})),n.d(t,"addPoint",(function(){return m})),n.d(t,"hasTimeElapsed",(function(){return g})),n.d(t,"randomBetween",(function(){return f})),n.d(t,"randomUInt31",(function(){return v})),n.d(t,"sign",(function(){return _})),n.d(t,"radianToDegree",(function(){return y})),n.d(t,"radianToSixtyThousandthDegree",(function(){return b})),n.d(t,"degreeToRadian",(function(){return S})),n.d(t,"sixtyThousandthDegreeToRadian",(function(){return C})),n.d(t,"roundNumber",(function(){return A})),n.d(t,"ceiling",(function(){return I})),n.d(t,"getUnionOfBounds",(function(){return w}));n(9);var i=1.192093e-7,r=1192093e-12,a=function(e,t){return!(e.x<t.x||e.y<t.y)&&(e.x<=t.x+t.width&&e.y<=t.y+t.height)},o=function(e,t){var n=new Sys.UI.Point(e.x,e.y);return n.x<t.x&&(n.x=t.x),n.x>t.x+t.width&&(n.x=t.x+t.width),n.y<t.y&&(n.y=t.y),n.y>t.y+t.height&&(n.y=t.y+t.height),n},s=function(e,t){return Math.round(Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)))},l=function(e,t){var n=o(e,t);return s(e,n)},c=function(e,t,n){void 0===n&&(n=50);var i=new Sys.UI.Point(e.x,e.y*n),r=new Sys.UI.Bounds(t.x,t.y*n,t.width,t.height*n);return l(i,r)},u=function(e,t,n){return t<=e&&e<=n},d=function(e,t){return Math.abs((e-t)/(t||1))<r},p=function(e,t,n){return Math.abs(e-t)<=n},h=function(e,t){return new Sys.UI.Point(e.x-t.x,e.y-t.y)},m=function(e,t){return new Sys.UI.Point(e.x+t.x,e.y+t.y)},g=function(e,t){return(new Date).getTime()-e.getTime()>t},f=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},v=function(){return 1+Math.floor(2147483647*Math.random())},_=function(e){return e>0?1:e?-1:0},y=function(e){return e*(180/Math.PI)},b=function(e){return 6e4*y(e)},S=function(e){return e*(Math.PI/180)},C=function(e){return S(e/6e4)},A=function(e,t){var n=Math.pow(10,t);return Math.floor(Math.round(e*n))/n},I=function(e){return Math.ceil(e)},w=function(e){if(!e||!e.length)return new Sys.UI.Bounds(0,0,0,0);for(var t=e[0].x,n=e[0].y,i=e[0].x+e[0].width,r=e[0].y+e[0].height,a=1;a<e.length;a++){t=e[a].x<t?e[a].x:t,n=e[a].y<n?e[a].y:n;var o=e[a].x+e[a].width,s=e[a].y+e[a].height;i=o>i?o:i,r=s>r?s:r}return new Sys.UI.Bounds(t,n,i-t,r-n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(0),r=n(2),a=n(11),o=n(260),s=n(49),l=(n(9),n(39)),c=n(60),u=n(33),d=n(27),p=n(10),h=n(13),m=n(3);function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(){function e(e,t){void 0===t&&(t=null),this._settingsGetter=new o.a({},null),this._eventSource=new s.a,this._logData={},this._flightingTreatmentVariables={},this._appSettingsRequestRetries=0,this.allowFullAppSettingsOverrides=!1,this._state=0,this._delayFullAppSettings=void 0,this._holdFullAppSettings=void 0,this._savedClientAppSettings=null,this.isFullChecked(e)?this.updateFullAppSettings(e):this._settingsGetter=new o.a(e,null),this.updateFlightingTreatmentVariables(e),this._taskManager=t||c.a.instance}var t,i,f,v=e.prototype;return v.updateFullAppSettings=function(e){if(!n(1).AFrameworkApplication.isShuttingDown){for(var t in e){var i={key:t,value:e[t]};!this.allowFullAppSettingsOverrides&&this._settingsGetter.containsAppSetting(i.key),this._settingsGetter.appSettings[i.key]=i.value}this.updateFlightingTreatmentVariables(e),this._settingsGetter.appSettings.MiniCheckAppSettings=!1,this._state=1,this.raiseFullAppSettingsReadyEvent()}},v.updateFlightingTreatmentVariables=function(e){var t,n=e.FlightingTreatmentVariables||"";if(u.d(n,Object(a.a)((function(){return t}),(function(e){return t=e}))))for(var i in t){var r={key:i,value:t[i]};r.key in this._flightingTreatmentVariables||(this._flightingTreatmentVariables[r.key]=r.value)}},v.isFullChecked=function(e){return Boolean.parse(e.IsFullAppSettings||"false")},v.invokeOrRegisterOnFullAppSettingsReady=function(e){this.isFullAppSettingsReady?e():this._eventSource&&this._eventSource.addHandler("FARE",e)},v.raiseFullAppSettingsReadyEvent=function(){this._eventSource&&(this._eventSource.raiseEvent("FARE"),this._eventSource.dispose(),this._eventSource=null)},v.invokeOrRegisterOnFullAppSettingsFailed=function(e){2!==this.state?this._eventSource&&this._eventSource.addHandler("FAFA",e):e()},v.raiseFullAppSettingsFailedEvent=function(){this._eventSource&&(this._eventSource.raiseEvent("FAFA"),this._eventSource.dispose(),this._eventSource=null)},v.requestPostBootAppSettings=function(e){void 0===e&&(e=null);var t=n(1).AFrameworkApplication,i=this.getAppSettingsUri();i?t.theClientRequestManager.addRequest(i,1,null,null,!1,2,Object(r.d)(this,this.onAppSettingsRequestSucceeded,"onAppSettingsRequestSucceeded"),Object(r.d)(this,this.onAppSettingsRequestFailed,"onAppSettingsRequestFailed"),null,void 0,void 0,void 0,void 0,"10"):m.ULS.sendTraceTag(5247296,208,15,"Failed to get full appsettings service url")},v.getBaseDocQuerySignature=function(){return this._settingsGetter.appSettings.BaseDocQuerySignatureWithoutVersion},v.getAppSettingsUri=function(){var e=this.getBaseDocQuerySignature();if(!e)return null;var t=this._settingsGetter.appSettings.WebServiceBase+"appsettings.ashx?"+e,n=d.a.getParameterValueDecoded(document.URL,"sc");return n&&(t=d.a.addParameterValue(t,"sc",n)),t},v.onAppSettingsRequestSucceeded=function(e){var t,n;this._logData=((t={}).Status=e.data.status,t.HttpStatus=e.data.httpStatus,t.ResponseLength=e.data.responseData?e.data.responseData.length:-1,t),m.ULS.sendTraceTag(4850132,208,50,"AppSettings request succeeded. {0}",this._logData);try{n=u.b(e.data.responseData)}catch(e){return m.ULS.sendTraceTag(5908570,208,10,"AppSettings JSON parse failed. {0}",e),this._state=2,void this.raiseFullAppSettingsFailedEvent()}this.updateFullAppSettings(n)},v.onAppSettingsRequestFailed=function(e){var t;this._logData=((t={}).Status=e.data.status,t.HttpStatus=e.data.httpStatus,t.ResponseData=h.a.trimToLength(e.data.responseData,100),t),this.logAndRetryFailedAppSettingsRequest(this._logData)},v.logAndRetryFailedAppSettingsRequest=function(e){var t=this._appSettingsRequestRetries<this.getIntAppSetting("AppSettingsRequestRetryCount",5);if(this._appSettingsRequestRetries++,e.ShouldRetry=t,e.RetryNumber=this._appSettingsRequestRetries,m.ULS.sendTraceTag(4850133,208,10,"AppSettings request failed. {0}",e),t){var n=new l.a(2,1,5e3,Object(r.d)(this,this.requestPostBootAppSettings,"requestPostBootAppSettings"),96);this._taskManager.addTask(n)}else this._state=2,this.raiseFullAppSettingsFailedEvent()},v.getBooleanAppSetting=function(e){return this._settingsGetter.getBooleanAppSetting(e)},v.getStringAppSetting=function(e){return this._settingsGetter.getStringAppSetting(e)},v.getIntAppSetting=function(e,t){return this._settingsGetter.getIntAppSetting(e,t)},v.getLongAppSetting=function(e,t){return this._settingsGetter.getLongAppSetting(e,t)},v.getDoubleAppSetting=function(e,t){return this._settingsGetter.getDoubleAppSetting(e,t)},v.getListAppSetting=function(e){return this._settingsGetter.getListAppSetting(e)},v.containsAppSetting=function(e){return this._settingsGetter.containsAppSetting(e)},v.getFlightingTreatmentVariables=function(e){var t={},n=this.getIntAppSetting("SdxAssetIdPositionInTreatmentVariablesNamespace",0),i=this._flightingTreatmentVariables;for(var r in i){var a={key:r,value:i[r]},o=a.key.split(".");o.length>n+1&&o[n]===e&&(t[a.key]=a.value)}return t},v.getBooleanFeatureGate=function(e,t){return(e=this.updateFeatureGateNameIfPrefixIsMissing(e))in this._flightingTreatmentVariables?Boolean.parse(this._flightingTreatmentVariables[e]):t},v.getIntFeatureGate=function(e,t){if((e=this.updateFeatureGateNameIfPrefixIsMissing(e))in this._flightingTreatmentVariables){var n=parseInt(this._flightingTreatmentVariables[e]);if(!isNaN(n))return n}return t},v.getStringFeatureGate=function(e,t){return(e=this.updateFeatureGateNameIfPrefixIsMissing(e))in this._flightingTreatmentVariables?this._flightingTreatmentVariables[e]:t},v.updateFullAppSettingsWithTreatmentVariables=function(e,t){for(var n in t){var i={key:n,value:t[n]};i.key in e||(e[i.key]=i.value)}},v.updateFeatureGateNameIfPrefixIsMissing=function(e){if(this._settingsGetter.getBooleanAppSetting("ShouldRemoveMicrosoftOfficeFeatureGatePrefix")){var t=e.length-17,n=e.toLowerCase();t>0&&!n.indexOf("microsoft.office.")&&(e=e.substring(17,t))}return e},v.addInfoForULS=function(e){var t=n(1).AFrameworkApplication;if(null!=e){var i;try{i=u.b(t.appSettingsManager.appSettings.SessionStartInfoJson.toString())}catch(e){i={}}var r="Unknown",a=e.App||this.appSettings.OfficeApplicationName||r;e.Application=i.Application||a||t.appSettingsManager.appSettings.OfficeApplicationName.toString().replace("Web","")||r,e.AppMode=e.AppMode||t.activeFrame.modeName||r,e.ApplicationMode=i.ApplicationModeExtended||e.AppMode||t.activeFrame.modeName||r,e.Host=i.Host||e.Host||t.feedbackDescription||r,e.Browser=i.Browser||e.Browser||r,e.BrowserMajorVersion=i.BrowserMajorVersion||null,e.BrowserMinorVersion=i.BrowserMinorVersion||null,e.Platform=i.Platform||e.Platform||r,e.PlatformMajorVersion=i.PlatformMajorVersion||null,e.PlatformMinorVersion=i.PlatformMinorVersion||null,e.DeviceName=i.DeviceName||e.DeviceName||r,e.SessionID=i.WACSessionID||(t.theClientRequestManager?t.theClientRequestManager.userSessionId:r),e.LanguageID=t.lcid,e.IsIPad=p.a.isIPad,e.IsMac=p.a.isMac,e.Ring=i.Ring||-1,e.IsProd=e.IsProd||t.isCustomerFeedbackExternal,e.Datacenter=i.WACDatacenter||(t.theClientRequestManager?t.theClientRequestManager.wacClusterId:r),e.Version=t.buildVersion,e.ApplicationVersion=i.ApplicationVersion||t.buildVersion,e.Error=e.Error||!1,e.ErrorCode=e.ErrorCode||null,e.Crash=e.Crash||!1,e.FlightIDs=e.FlightIDs||t.flightId||"",e.FlightIDs.toString().length>2e3&&(e.FlightIDs=String.format("{0}...[Flight IDs trimmed]",e.FlightIDs.toString().substr(0,1999))),e.ServerDocId=i.ServerDocId||r}},t=e,(i=[{key:"_clientAppSettings",get:function(){return this.appSettings}},{key:"appSettings",get:function(){return this._settingsGetter.appSettings}},{key:"logData",get:function(){return this._logData}},{key:"flightingTreatmentVariables",get:function(){return this._flightingTreatmentVariables}},{key:"isFullAppSettingsReady",get:function(){return 1===this.state}},{key:"state",get:function(){return this._state}}])&&g(t.prototype,i),f&&g(t,f),e}();Object(i.a)(f,"AppSettingsManager",null,[30,31])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=(n(9),n(7)),a=(n(5),n(6));function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(t,n){this._element=null,this._key=t,this._elementId=n+e.keytipId}var t,n,i,s=e.prototype;return s.createKeytipElement=function(){this._element=a.a.createElement("div"),this.element.className="cui-keytip";var e=a.a.createElement("span");return e.className="cui-keytip-span",e.innerText=this._key,e.id=this._elementId,this.element.appendChild(e),r.a.setAriaAttribute(this.element,r.a.ariaRoleAttribute,r.a.ariaPresentationRole),r.a.setAriaAttribute(this.element,r.a.ariaHiddenAttribute,r.a.ariaTrueValue),r.a.setAriaAttribute(e,r.a.ariaRoleAttribute,r.a.ariaPresentationRole),this.hide(),this.element},s.show=function(e){Sys.UI.DomElement.removeCssClass(this.element,"WACAltTextDescribedBy"),this.element.style.zIndex=String(e),this.setDisplay("block")},s.hide=function(){Sys.UI.DomElement.addCssClass(this.element,"WACAltTextDescribedBy"),this.setDisplay("none")},s.setDisplay=function(e){this.element&&(this.element.style.display=e)},t=e,(n=[{key:"key",get:function(){return this._key}},{key:"element",get:function(){return this._element}},{key:"elementId",get:function(){return this._elementId}}])&&o(t.prototype,n),i&&o(t,i),e}();s.ribbonShortcutId="RibbonShortcut",s.keytipId="-Keytip",Object(i.a)(s,"Keytip",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(0),r=n(23),a=n(7),o=n(387),s=n(6);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i)||this)._insertTableDom=null,r.addDisplayMode("Menu"),r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var c,u,d,p=i.prototype;return p.createComponentDomForDisplayMode=function(e){return this._insertTableDom=this.createInsertTableDom(e),this.insertTableDom},p.createInsertTableDom=function(e){var t=s.a.createElement("table");t.setAttribute(a.a.ariaRoleAttribute,a.a.ariaGridRole),t.setAttribute("mscui:controltype",this.controlType);var n,r,l,c,u,d=s.a.createElement("tbody");d.className="cui-it",t.setAttribute("cellspacing","0"),t.setAttribute("cellpadding","0"),d.setAttribute("cellspacing","0"),d.setAttribute("cellpadding","0");for(var p=new Array(i.numCells),h=new Array(i.numCells),m=new Array(i.numCells),g=new Array(i.numCells),f=0,v=0;v<i.numRows;v++){(n=s.a.createElement("tr")).setAttribute(a.a.ariaRoleAttribute,a.a.ariaRowRole),d.appendChild(n),v||s.a.ensureCSSClassOnElement(n,"cui-it-firstrow"),v>=i.numRowsInTouch&&s.a.ensureCSSClassOnElement(n,"cui-hideInTouch");for(var _=0;_<i.numCols;_++)r=s.a.createElement("td"),_||s.a.ensureCSSClassOnElement(r,"cui-it-firstcol"),_>=i.numColsInTouch&&v<=i.numRowsInTouch&&s.a.ensureCSSClassOnElement(r,"cui-hideInTouch"),r.setAttribute(a.a.ariaRoleAttribute,a.a.ariaPresentationRole),n.appendChild(r),(l=s.a.createElement("a")).setAttribute(a.a.ariaRoleAttribute,a.a.ariaGridCellRole),s.a.addToTabLoop(l),(c=s.a.createElement("div")).className="cui-it-inactiveCell",(u=s.a.createElement("div")).id=this.id+"-"+f,u.className="cui-it-inactiveCellOuter",r.appendChild(u),u.appendChild(c),c.appendChild(l),p[f]=r,g[f]=l,h[f]=c,m[f]=u,f++}t.appendChild(d);var y=new o.a(e);return y.elmControl=t,y.elmTBody=d,y.cells=p,y.cellATags=g,y.innerDivs=h,y.outerDivs=m,this._insertTableDom=y,y},p.constructClonedControl=function(e,t){return new i(e,this.id,t)},c=i,(u=[{key:"insertTableDom",get:function(){return this._insertTableDom}},{key:"controlType",get:function(){return r.Control.insertTableControlType}}])&&l(c.prototype,u),d&&l(c,d),i}(r.Control);c.numCols=10,c.numRows=8,c.numCells=80,c.maxIdx=79,c.numColsInTouch=8,c.numRowsInTouch=6,Object(i.a)(c,"InsertTable",r.Control,[101])},function(e,t,n){var i=n(364),r=n(366);e.exports=function(e){return i(r(e))}},function(e,t,n){var i=n(144),r=n(147),a=n(270);e.exports=i?function(e,t,n){return r.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(146);e.exports=function(e){if(!i(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(11),o=n(209),s=n(38),l=n(119),c=n(285),u=n(362),d=n(1),p=n(104),h=function(){};function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}h.unifiedHeaderHeightPx=48,h.tabRowHeightPx=30,h.singleRowLayoutTabRowHeightPx=24,Object(i.a)(h,"RootSize",null,[]);var g=function(){function e(){}var t,n,i;return e.lowerRibbonHeight=function(e,t){return void 0===t&&(t=!1),d.AFrameworkApplication.hideRibbonEmbedded?0:t?48:e?108:94},t=e,i=[{key:"upperRibbonHeight",get:function(){return d.AFrameworkApplication.hideRibbonEmbedded?0:h.tabRowHeightPx+(d.AFrameworkApplication.hasExternalHeader?0:h.unifiedHeaderHeightPx)}},{key:"singleRowLayoutUpperRibbonHeight",get:function(){return h.singleRowLayoutTabRowHeightPx}}],(n=null)&&m(t.prototype,n),i&&m(t,i),e}();Object(i.a)(g,"RibbonSize",null,[]);n(9);var f=n(4),v=n(20),_=n(69),y=n(7),b=n(52),S=n(22),C=n(16),A=n(10),I=n(177),w=n(156),T=n(210);var E=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).defaultSelectionOverride=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(T.a);Object(i.a)(E,"JewelBuildOptions",T.a,[]);var k=n(190),M=n(204);var P=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).OldContextId=null,t.OldContextCommand=null,t.NewContextId=null,t.NewContextCommand=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Sys.EventArgs);Object(i.a)(P,"CommandContextSwitchCommandProperties",Sys.EventArgs,[]);var F=n(263),D=n(279),O=n(338),R=n(151),x=n(107),U=n(136),B=n(29);function L(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var N=function(){function e(){}var t,i,r;return e.animateRibbonExpandCollapse=function(t,i,r){A.a.isInternetExplorer8&&B.WacAirSpace.temporarilyDisableAnimation(1e3);var a=t.element,o=S.DomUtils.getChildById(a,n(195).Ribbon.tabContainerOverflowId);if(o){var s=o.firstChild;if(s&&B.WacAirSpace.setAnimationClass(s,"Wac_RibbonClass"),i&&s){s.id.endsWith("_clone")&&(o.removeChild(s),(s=o.firstChild)&&B.WacAirSpace.setAnimationClass(s,"Wac_RibbonClass"));var l=new x.a(s);l.animateY(r?0:e.ribbonCollapsedTop,0);var c=new U.a(s);c.animateOpacity(r?1:0,1),B.WacAirSpace.animate(l,null,e.onAfterRibbonMoveDown),B.WacAirSpace.animate(c,null,e.onAfterShowRibbon)}else if(!i&&s){var u=B.WacAirSpace.cloneElement(s,!1,!0),d=new x.a(u);d.animateY(0,e.ribbonCollapsedTop);var p=new R.a(u);p.animateOpacity(r?0:1,0),e._animatingContextualGroupsAfterRibbonCollapse=Array.clone(e._animatingContextualGroups),B.WacAirSpace.animate(d,null,e.onAfterCloneAnimation),B.WacAirSpace.animate(p,null,e.onAfterHideRibbon)}}},e.animateContextualGroup=function(t){if(t){var n=$get(t);if(n){Array.contains(e._animatingContextualGroups,t)||Array.add(e._animatingContextualGroups,t);var i=n.children[0];B.WacAirSpace.setAnimationClass(i,"UEX_UpperContextualTabDramatic");var r=new U.a(i);r.animateOpacity(0,1),B.WacAirSpace.animate(r,null,null);var a=n.children[1];B.WacAirSpace.setAnimationClass(a,"UEX_ContextualTabMovement");var o=new x.a(a);o.animateY(24,0),B.WacAirSpace.animate(o,null,e.onAfterContextualGroupAnimation)}}},e.onAfterContextualGroupAnimation=function(t){e._animatingContextualGroups.length>=1&&Array.removeAt(e._animatingContextualGroups,0)},e.onAfterRibbonMoveDown=function(e){e.element.style.top="0px"},e.onAfterShowRibbon=function(e){var t=e.element;A.a.setOpacity(t,1)},e.onAfterHideRibbon=function(e){var t=e.element;A.a.setOpacity(t,0)},e.onAfterCloneAnimation=function(t){var n=t.element;n&&n.parentNode&&n.parentNode.removeChild(n);for(var i=0;i<e._animatingContextualGroupsAfterRibbonCollapse.length;i++){var r=e._animatingContextualGroupsAfterRibbonCollapse[i];e.animateContextualGroup(r)}e._animatingContextualGroups=[],e._animatingContextualGroupsAfterRibbonCollapse=[]},t=e,r=[{key:"ribbonCollapsedTop",get:function(){return-d.AFrameworkApplication.activeFrame.lowerRibbonHeight}}],(i=null)&&L(t.prototype,i),r&&L(t,r),e}();N._animatingContextualGroups=[],N._animatingContextualGroupsAfterRibbonCollapse=[],Object(i.a)(N,"RibbonAnimator",null,[]);var H=n(161),W=n(217),j=n(5),V=n(45),K=n(6),z=n(8),q=n(49),G=n(51);function Q(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function $(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"Ribbon",(function(){return X}));var X=function(e){var t,i;function o(t,n,i,r,a){var o;return void 0===a&&(a=!1),(o=e.call(this,t,n,r)||this)._selectedTab=null,o._previousTab=null,o._elmTopBar2=null,o._elmTabTitles=null,o._elmRibbonShortcut=null,o._elmTabContainer=null,o._elmTabContainerOverflowContainer=null,o._elmNavigationInstructions=null,o._elmTopRowLeft=null,o._elmTopRowCenter=null,o._elmTopRowRight=null,o._elmBottomRowLeft=null,o._elmBottomRowCenter=null,o._elmBottomRowRight=null,o._peripheralContentsLoaded=!1,o._headerContainer=null,o._ribbonStateChanged=!1,o._ribbonPinButton=null,o._pendingDismissRibbonTimeoutId=-1,o._isLowerRibbonTouchMode=!1,o.keytipManager=null,o._peripheralContentContainer=null,o._elmRibbonTopBars=null,o._theStandaloneRoot=null,o._eventsAttached=!1,o.jewel=null,o._currentCtxCss=null,o._lastScaleTime=new Date(0),o._minimized=!1,o._minimizedEverSet=!1,o.jewelElement=null,o.homeTab=null,o.lastSelectedTab=null,o._tabPoppedUp=!1,o._elmHadFocus=null,o._tabPopupInvocationMethod=0,o._dismissingTabPopup=!1,o._contextualGroups={},o.isStaticUiTouchMode=i,o.isLowerRibbonTouchMode=i,o.isSingleRowLayoutRibbon=a,d.AFrameworkApplication.reportInitialUi(o.isLowerRibbonTouchMode),o}i=e,(t=o).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var h,m,T,R=o.prototype;return R.attachStandaloneRoot=function(e){this._theStandaloneRoot=e},R.forEachTab=function(e){for(var t,n=Q(this.children);!(t=n()).done;){var i=t.value;Object(r.c)(W.Tab,i)&&e(i)}},R.refreshInternal=function(){e.prototype.refreshInternal.call(this);var t=this.root.controlWithFocus;this.ensureDOMElement(),this.reparentPeripheralsAndCreateTabTitlesContainer(),K.a.toggleCSSClassOnElement(this.elmRibbonTopBars,p.a.touchModeCssClass,this.isStaticUiTouchMode),this.elmRibbonTopBars!==this._headerContainer&&K.a.toggleCSSClassOnElement(this._headerContainer,p.a.touchModeCssClass,this.isStaticUiTouchMode),K.a.toggleCSSClassOnElement(this.elmRibbonTopBars,"cui-ribbon-visible",this.tabShowing),this.elmRibbonTopBars!==this._headerContainer&&K.a.toggleCSSClassOnElement(this._headerContainer,"cui-ribbon-visible",this.tabShowing);var n=null,i=null,r=null,a=null;K.a.removeChildNodesSlow(this._elmTabTitles);var o=this._contextualGroups;for(var s in o){({key:s,value:o[s]}).value.ensureTabTitlesCleared()}var l=0,c=new M.a;this.forEachTab((function(e){e.visible&&(c.add(e),l++)}));for(var u,d=0,h=c.count,m=!(j.b(this.ribbonProperties.ATTabPositionText)||j.b(this.ribbonProperties.ATContextualTabText)),g=Q(c);!(u=g()).done;){var f=u.value;f.ensureTitleRefreshed(),f.resetTitleCSSClasses(),f.contextual?(r&&f.contextualGroupId===r||(f.contextualGroupId!==r&&!j.c(i)&&i.contextual&&K.a.ensureCSSClassOnElement(i.titleDOMElement,"cui-ct-last"),r=f.contextualGroupId,a=this._contextualGroups[f.contextualGroupId],K.a.removeCSSClassFromElement(a.elementInternal,"cui-cg-s"),this.setContextualColor(0),this._elmTabTitles.appendChild(a.elementInternal),K.a.ensureCSSClassOnElement(f.titleDOMElement,"cui-ct-first")),a.addTabTitleDOMElement(f.titleDOMElement)):(r&&(K.a.ensureCSSClassOnElement(i.titleDOMElement,"cui-ct-last"),r=null,a=null),m&&(d++,f.setContextualText(this.ribbonProperties.ATTabPositionText,null,null,d,h)),this._elmTabTitles.appendChild(f.titleDOMElement)),f===this._selectedTab&&(n=f),i=f}r&&(K.a.ensureCSSClassOnElement(i.titleDOMElement,"cui-ct-last"),i=null,r=null,a=null);var v=1;if(m)for(var _=0;_<l;_++){var y=c.get_item(_);y.contextual&&(y.contextualGroupId!==r&&(r=y.contextualGroupId,a=this._contextualGroups[y.contextualGroupId],v=1),y.ensureHiddenATDOMElement(),y.setContextualText(this.ribbonProperties.ATTabPositionText,this.ribbonProperties.ATContextualTabText,a.title,v,a.count),v++)}if(this.tabShowing){if(j.c(n))if(this._minimized)this.tabPoppedUp&&this.delayDismissTabPopup(0);else{var b=this.lastSelectedTab,S=this.homeTab;!j.c(b)&&b.visible?n=b:!j.c(S)&&S.visible&&(n=S),this.makeTabSelectedInternal(n),this._elmTabContainer.tabIndex=-1}}else n=null;if(!j.c(n)&&n.contextual){var C=this.getContextualGroup(n.contextualGroupId);K.a.ensureCSSClassOnElement(C.elementInternal,"cui-cg-s"),this.setContextualColor(C.color)}if(this.updateDOMForSelectedTab(),!j.c(n)){n.rootPolledSinceLastPoll&&K.a.setEnabledOnElement(this._elmTabContainer,!1);var A=-1!==this._elmTabContainer.className.indexOf("cui-disabled"),I="";this.isSingleRowLayoutRibbon?I=" cui-singlerowlayout":this.isLowerRibbonTouchMode&&(I=" cui-touch"),this._elmTabContainer.className=n.getContainerCSSClassName()+I+(A?" cui-disabled":"")}t&&t.setFocusOnControl();var w=this._contextualGroups;for(var T in w){({key:T,value:w[T]}).value.ensureTabTitleWidths()}if(this.dirty=!1,this._ribbonStateChanged){var E=this.ribbonProperties.CommandStateChanged;j.c(E)||this.executeCommand(E,null,this,0,!1),this._ribbonStateChanged=!1}},R.attachEvents=function(){this._eventsAttached||(v.KeyInputManager.instance.registerHandler(f.EventNames.keyDown,this._elmTabContainer,Object(r.d)(this,this.onTabContainerKeyDown,"onTabContainerKeyDown")),v.KeyInputManager.instance.registerHandler(f.EventNames.keyUp,this._elmTabContainer,Object(r.d)(this,this.onTabContainerKeyUp,"onTabContainerKeyUp")),this._eventsAttached=!0)},R.onTabContainerKeyDown=function(e){var t=!1;if(!j.c(e.innerEvent)&&!j.c(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,r=n.shiftKey,a=!1,o=!1;if(i===Sys.UI.Key.tab)this.wrapKeyboardFocus(e.sourceElement,!r)&&(a=e.sourceElement===this._elmTabContainer,t=!0),o=!0;else if(!e.innerEvent.ctrlKey||i!==Sys.UI.Key.left&&i!==Sys.UI.Key.right)i===Sys.UI.Key.esc?this.tabPoppedUp&&(this.dismissTabPopup(),t=!0):(e.innerEvent.ctrlKey||i>=112&&i<=123)&&this.tabPoppedUp&&(e.innerEvent.ctrlKey&&117===i?this.dismissAllTransientUI():t=!0);else{var s=!this.root.textDirection,l=i===Sys.UI.Key.right;this._selectedTab.moveGroupFocus(e.sourceElement===this._elmTabContainer,s&&l||!s&&!l),a=!0,o=!0,t=!0}a&&(this._elmTabContainer.tabIndex=-1),o&&this.exitKeytipMode(void 0,!1)}return t},R.onTabContainerKeyUp=function(e){var t=!1;j.c(e.innerEvent)||j.c(e.innerEvent.rawEvent)||e.innerEvent.rawEvent.altKey&&this.tabPoppedUp&&(this.dismissTabPopup(),t=!0);return t},R.wrapKeyboardFocus=function(e,t){var n=!1,i=this._selectedTab.firstControl,r=this._selectedTab.lastControl;if(this.tabPoppedUp){var a=this.nextControlToFocusTabPoppedUp(e,t,i,r);j.c(a)||(this.clearSelectionOnElement(e),a.focusableElement&&(a.setFocusOnControl(),n=!0))}else if(t&&e===this._ribbonPinButton.focusableElement||!t&&e===i.focusableElement)this.clearSelectionOnElement(e),this.setFocusOnCurrentTabTitle(),n=!0;else if(t&&e===r.focusableElement||!t&&e===this._ribbonPinButton.focusableElement){var o=e===r.focusableElement?this._ribbonPinButton:r;this.clearSelectionOnElement(e),o.focusableElement&&(o.setFocusOnControl(),n=!0)}return n},R.nextControlToFocusTabPoppedUp=function(e,t,n,i){var r=e===this._elmTabContainer,a=null;return t?r||e===this._ribbonPinButton.focusableElement?a=n:e===i.focusableElement&&(a=this._ribbonPinButton):r||e===n.focusableElement?a=this._ribbonPinButton:e===this._ribbonPinButton.focusableElement&&(a=i),a},R.clearSelectionOnElement=function(e){3===S.DomUtils.getTag(e)&&C.a.clearSelectionInInput(e)},R.updateOpenMenu=function(e){return!(!this.root||!this.root.refreshOpenMenu(e))||!(!this.jewel||!this.jewel.refreshOpenMenu(e))},R.setFocusOnCurrentTabTitle=function(){var e=j.c(this._selectedTab)?this.homeTab:this._selectedTab;j.c(e)||e.setFocusOnTitle()},R.prepareToEnterKeytipMode=function(){this.beginModal(this,!1,!0),this.elmRibbonTopBars.style.zIndex=String(this.keytipModeRibbonHeadersZIndex),this.setTabContainerOverflow("visible")},R.enterKeytipMode=function(e){void 0===e&&(e=null),this.keytipManager&&(this.keytipManager.enterKeytipMode(),this.keytipManager.onExitCallback=e)},R.prepareToExitKeytipMode=function(e){this.closeAllMenus(),e&&this.tabPoppedUp&&this.dismissTabPopup(void 0,!1),this.tabPoppedUp||(this.elmRibbonTopBars.style.zIndex=String(1)),this.inModalMode&&!this.tabPoppedUp?this.endModal(this,!1,!0):this.endBlockingModeKeepModal(),this.setTabContainerOverflow("hidden")},R.exitKeytipMode=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.keytipManager&&this.keytipManager.exitKeytipMode(e,t)},R.setTabContainerOverflow=function(e){this._elmTabContainerOverflowContainer.style.overflow=e,this._elmTabContainer.style.overflow=e},R.setFocusOnTabContainer=function(){j.c(this._elmTabContainer)||(this._elmTabContainer.tabIndex=0,this._elmTabContainer.focus())},R.addContextualGroup=function(e,t,n,i){var r=this._contextualGroups[e];if(!j.c(r))throw Error.create("A contextual group with id: "+e+" has already been added to this ribbon.");r=new F.a(e,t,n,i),this._contextualGroups[e]=r},R.removeContextualGroup=function(e){var t=this._contextualGroups[e];j.c(t)||(this.forEachTab((function(t){if(t.contextual&&t.contextualGroupId===e)throw Error.create("You cannot remove a contextual group when there are Tabs that refer to it.")})),delete this._contextualGroups[e])},R.setVisibilityForContextualGroup=function(e,t,n){var i=this._contextualGroups[e];if(j.c(i))throw Error.create("This ribbon does not contain a contextual group with id: "+e);var r=!1;return this.forEachTab((function(n){n.contextualGroupId===e&&(n.visible!==t&&(r=!0),n.visibleInternal=t)})),r&&(this.onDirtyingChange(),this.refreshInternal(),n&&this.scaleHeader(),t&&N.animateContextualGroup(e)),r},R.getContextualGroup=function(e){return this._contextualGroups[e]},R.addChildAtIndex=function(t,n){if(!j.c(t)){if(this.ensureCorrectChildType(t),Object(r.c)(W.Tab,t)){var i=t;if(i.contextual){var a=this._contextualGroups[i.contextualGroupId];if(j.c(a))throw Error.create("A contextual tab with contextual group id: "+i.contextualGroupId+" cannot be added because  the ribbon does not have a contextual group with this id.")}}e.prototype.addChildAtIndex.call(this,t,n)}},R.ensureCorrectChildType=function(e){if(!Object(r.c)(W.Tab,e)&&!this.isPinButtonElement(e.elementInternal))throw Error.create("Only children of type Tab or Pin button can be added to a Ribbon")},R.ensureJewelPlaceholder=function(){j.c(this.jewelElement)&&(this.jewelElement=K.a.createElement("div"),this.jewelElement.id="jewelcontainer",this.jewelElement.className="cui-jewel-container",this.jewelElement.style.display="none",this._elmTopBar2.appendChild(this.jewelElement))},R.buildAndSetJewel=function(e,t){this.jewelElement.style.display="block";var i=this.ribbonBuilder.ribbonBuildOptions.jewelBuildOptions||Object.assign(new E,{trimmedIds:this.ribbonBuilder.options.trimmedIds}),r=new(n(525).JewelBuilder)(i,this.jewelElement,this.ribbonBuilder.buildClientTask);if(r.dataSource=t,!r.buildJewel(e,this))throw Error.create("Jewel could not be built");this.jewel=r.jewel},R.rebuildAndSetJewel=function(e,t){this.jewel&&this.jewel.dispose(),this.jewelElement.innerText="",this.buildAndSetJewel(e,t),this.jewel&&this.jewel.pollForStateAndUpdate()},R.createTab=function(e,t,n,i,r,a){return new W.Tab(this,e,t,n,i,!1,null,r,a)},R.createContextualTab=function(e,t,n,i,r,a,o){return new W.Tab(this,e,t,n,i,!0,r,a,o)},R.createGroup=function(e,t,n,i,r,a){return new D.Group(this,e,n,i,r,!0,!1,!1,t,a)},R.createLayout=function(e,t,n){return new O.a(this,e,t,n)},R.createSection=function(e,t,n,i,r,a){return new H.a(this,e,t,n,i,!1,r,void 0,void 0,void 0,a)},R.updateDOMForSelectedTab=function(){if(j.c(this._selectedTab)||(this._selectedTab.ensureDOMElement(),this.lastSelectedTab=this._selectedTab),j.c(this._selectedTab)||!this._selectedTab.children.count?j.c(this.elementInternal)||j.c(this._elmTabContainerOverflowContainer)||this.elementInternal.lastChild!==this._elmTabContainerOverflowContainer||this.elementInternal.removeChild(this._elmTabContainerOverflowContainer):j.c(this._elmTabContainerOverflowContainer)||this.elementInternal.appendChild(this._elmTabContainerOverflowContainer),!j.c(this._selectedTab)){this._selectedTab.dirty;if(this._selectedTab.ensureRefreshed(),this._selectedTab.children.count>0&&!j.c(this._elmTabContainer)){var e=this._elmTabContainer.firstChild;e?this.isPinButtonElement(e)?this._elmTabContainer.insertBefore(this._selectedTab.elementInternal,e):e!==this._selectedTab.elementInternal&&this._elmTabContainer.replaceChild(this._selectedTab.elementInternal,e):this._elmTabContainer.appendChild(this._selectedTab.elementInternal),this._selectedTab.onTabAttachedToRibbon()}if(this._previousTab!==this._selectedTab){var t=this.ribbonProperties.CommandTabSwitched,n=new P;j.c(this._previousTab)||(n.OldContextId=this._previousTab.id,n.OldContextCommand=this._previousTab.command),j.c(this._selectedTab)||(n.NewContextId=this._selectedTab.id,n.NewContextCommand=this._selectedTab.command),j.c(t)||this.executeCommand(t,n,this,0,!1),o._ribbonTabSwitchedEventSource.raiseEvent("RTSE",n),this.updatePreviousSelectedTab(this._selectedTab)}}},R.makeTabSelectedInternal=function(e){j.c(e)||(this.onDirtyingChange(),e.setSelectedInternal(!0,!1),e.contextual||this.setContextualColor(0),j.c(this._selectedTab)||this._selectedTab===e||this._selectedTab.setSelectedInternal(!1,!1),this._selectedTab=e,this.minimized&&this.displayTabPopup())},R.updatePreviousSelectedTab=function(e){this._previousTab=e},R.selectTabById=function(e,t){if(void 0===t&&(t=!1),_.a.mark(10332),!t&&!this.tabShowing)return _.a.mark(10333),!1;var n=this.getChild(e);if(!j.c(n)){if(n.selected&&n.visible)return _.a.mark(10333),!0;if(n.contextual&&!n.visible&&this.setVisibilityForContextualGroup(n.contextualGroupId,!0,!0),n.visible)return n.selected=!0,_.a.mark(10333),!0}return _.a.mark(10333),!1},R.getTabTitleDOMElementBounds=function(e){var t=this.getChild(e);return j.c(t)?null:C.a.getElementBounds(t.titleDOMElement)},R.getGroupTitleDOMElementBounds=function(e,t){var n=this.getChild(e);if(!j.c(n)&&!j.c(n.getChild(t))){var i=n.getChild(t);return C.a.getElementBounds(i.titleDOMElement)}return null},R.scaleRibbon=function(){this.scale()},R.isSelectedTab=function(e){return e===this.selectedTabId},R.launchJewel=function(e,t){this.jewel.jewelMenuLauncher.launchMenuWithSubmenu(e,t)},R.setContextualColor=function(e){var t=F.a.getColorNameForContextualTabColor(e);t===j.a?(K.a.removeCSSClassFromElement(this._elmTopBar2,this._currentCtxCss),this._currentCtxCss=null):(this._currentCtxCss||K.a.removeCSSClassFromElement(this._elmTopBar2,this._currentCtxCss),this._currentCtxCss="cui-ct-topBar-"+t,K.a.ensureCSSClassOnElement(this._elmTopBar2,this._currentCtxCss))},R.scaleInternal=function(){if(j.c(this.elementInternal)||j.c(this._selectedTab))return!1;var e=0;if(!this._selectedTab.scaledByCookie){var t=null;this.useDataCookie&&(t=this.getDataCookieValue(this._selectedTab.id));var n=this._lastResizeWidthHeight;if(!j.c(t)&&t.startsWith(n)){var i=t.split("|");if(!j.c(i)&&4===i.length){var r=parseInt(i[1]),a=parseInt(i[2]);if(e=a>e?a:e,!isNaN(r)&&r>=0&&r>=0&&r<this._selectedTab.scaling.stepsInternal.length)return this._selectedTab.scaleIndex(r),this._selectedTab.scaledByCookie=!0,this.refreshInternal(),this._selectedTab.lastScaleWidthHeight=this._lastResizeWidthHeight,!0}}}this._selectedTab.dirty&&this.refreshInternal();for(var o=0,s=this._selectedTab.width,l=this._selectedTab.contentsCurScaleWidth;l>s&&o<25;){if(!this._selectedTab.scaleDown()){if(this._selectedTab.minWidth=l,this._elmTabContainer&&this._ribbonPinButton&&this._ribbonPinButton.displayedComponent&&this._ribbonPinButton.displayedComponent.elementInternal){var c=l+this._ribbonPinButton.displayedComponent.elementInternal.offsetWidth;this._elmTabContainer.style.minWidth=c+"px"}else 0;break}this.refreshInternal(),l=this._selectedTab.contentsCurScaleWidth,o++}var u=0,d=0;if(o<=0&&s-l>e)for(;u<25&&this._selectedTab.scaleUp();)if(this.refreshInternal(),u++,this._selectedTab.contentsCurScaleWidth>s){this._selectedTab.scaleDown(),this.refreshInternal(),d++;break}return this.useDataCookie&&this._selectedTab.currentScalingIndex>=-1&&this.storeTabScaleCookie(),this._selectedTab.lastScaleWidthHeight=this._lastResizeWidthHeight,this.scaleHeader(),o>0||u-d>0},R.scaleHeader=function(){this.enhancedMobileViewIsEnabled()?(document.getElementById("application").style.minWidth="0px",j.c(this.peripheralContentContainer)||new u.a(this.peripheralContentContainer,this._elmTopBar2,1===this.root.textDirection).scaleHeader()):j.c(this.peripheralContentContainer)||c.a.scaleHeaderUsingContainers(this.peripheralContentContainer,this._elmTopBar2,1===this.root.textDirection);if(!j.c(this._elmTabTitles)){var e=this._elmTabTitles.className,t=0;-1!==e.indexOf("cui-tts-scale-1")?t=1:-1!==e.indexOf("cui-tts-scale-2")&&(t=2),this.forEachTab((function(e){e.onTitleScale(t)}))}},R.enhancedMobileViewIsEnabled=function(){return!!d.AFrameworkApplication.appSettingsManager&&d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")},R.scale=function(){if(e.prototype.scale.call(this),!this.tabShowing)return this.scaleHeader(),this.refreshInternal(),!1;var t=this.scaleInternal();return this._lastScaleTime=new Date,t},R.scaleIndex=function(e){j.c(this._selectedTab)||this._selectedTab.scaleIndexInternal(e)},R.storeTabScaleCookie=function(){var e=this._selectedTab.width-this._selectedTab.contentsCurScaleWidth;this.storeDataCookie(this._selectedTab.id,this.elementInternal.clientWidth.toString()+this.elementInternal.clientHeight.toString()+"|"+this._selectedTab.currentScalingIndex.toString()+"|"+e.toString())},R.toggleMinimizedState=function(e){_.a.mark(10330),d.AFrameworkApplication.theActionManager.processAction(z.a.oreoOnToggleRibbonState,2),3===e?this.isLowerRibbonTouchMode=!0:2===e&&(this.isLowerRibbonTouchMode=!1);var t=this.minimized,n=this.tabPoppedUp;this.dismissTabPopup(),this.minimized=!this.minimized,d.AFrameworkApplication.activeFrame&&d.AFrameworkApplication.activeFrame.applicationInstance.isRibbonFlexBoxLayoutEnabled&&t&&(this._elmTabContainerOverflowContainer.style.position="relative",this._elmTabContainerOverflowContainer.style.width="",b.CssUtils.removeStyle(this._elmTabContainerOverflowContainer,"zIndex")),t&&n?(N.animateRibbonExpandCollapse(this,!0,!0),d.AFrameworkApplication.activeFrame.animateDocumentPanel(!1,!0)):t?(N.animateRibbonExpandCollapse(this,!0,!1),d.AFrameworkApplication.activeFrame.animateDocumentPanel(!1,!1)):(N.animateRibbonExpandCollapse(this,!1,!1),d.AFrameworkApplication.activeFrame.animateDocumentPanel(!0,!1)),this.updatePinButtonProperties(),this.refresh(),_.a.mark(10331)},R.pollForStateAndUpdateInternal=function(){if(this.rootUser){this.lastPollTime=new Date,this.needScaling=!1;var e={},t=!1,n=this._contextualGroups;for(var i in n){var r={key:i,value:n[i]},a=r.value,o=!1;j.c(a.command)||(o=this.rootUser.isRootCommandEnabled(a.command)),o&&(e[r.key]=!0),this.setVisibilityForContextualGroup(r.key,o,!1)&&(t=!0)}t&&this.scaleHeader(),this.jewel&&this.jewel.pollForStateAndUpdate(),this.ensureRefreshed(),j.c(this._selectedTab)||this._selectedTab.pollForStateAndUpdateInternal(),this.needScaling?(this.scale(),this.needScaling=!1,this.needRefresh=!1):this.needRefresh&&(this.refreshInternal(),this.needRefresh=!1),this.ensureGlobalDisablingRemoved()}},R.ensureTabsInitialized=function(){this.forEachTab((function(e){e.ensureTabInitialized()}))},R.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this),y.a.setAriaAttribute(this.elementInternal,"aria-describedby","ribboninstructions"),this.elementInternal.setAttribute("role","toolbar"),Sys.UI.DomElement.addCssClass(this.elementInternal,this.cssClassMarker),this.ensureElementForRibbonShortcut(),this.ensureTopBars(),this.ensureTopBars1And2(),this.ensureJewelPlaceholder(),this.ensureTabContainer(),this.ensureJewelPlaceholder(),this.findPeripherals(),this.attachEvents()},R.ensureElementForRibbonShortcut=function(){j.c(this._elmRibbonShortcut)&&(this._elmRibbonShortcut=K.a.createElement("div"),this._elmRibbonShortcut.id=k.a.ribbonShortcutId,this._elmRibbonShortcut.innerText=A.a.isMac?"Alt Ctrl":"Alt Windows",Sys.UI.DomElement.addCssClass(this._elmRibbonShortcut,"WACAltTextDescribedBy"),y.a.setAriaAttribute(this._elmRibbonShortcut,y.a.ariaRoleAttribute,y.a.ariaPresentationRole),y.a.setAriaAttribute(this._elmRibbonShortcut,y.a.ariaHiddenAttribute,y.a.ariaTrueValue),this.elementInternal.appendChild(this._elmRibbonShortcut))},R.ensureTopBars1And2=function(){var e=d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UseExternalHeaderDiv")&&document.getElementsByClassName(p.a.topBarOneCssClass).length>0;j.c(this.peripheralContentContainer)&&!e&&(this._peripheralContentContainer=K.a.createElement("div"),this.peripheralContentContainer.className=p.a.topBarOneCssClass,this.peripheralContentContainer.style.display="none",this._headerContainer.appendChild(this.peripheralContentContainer)),j.c(this._elmTopBar2)&&(this._elmTopBar2=K.a.createElement("div"),this._elmTopBar2.className="cui-topBar2",this.elmRibbonTopBars.appendChild(this._elmTopBar2))},R.ensureTopBars=function(){this.properties.NavigationHelpText&&j.c(this._elmNavigationInstructions)&&(this._elmNavigationInstructions=K.a.createElement("span"),this._elmNavigationInstructions.className="cui-hidden",this._elmNavigationInstructions.id="ribboninstruction",this._elmNavigationInstructions.innerText=this.properties.NavigationHelpText,this.elementInternal.appendChild(this._elmNavigationInstructions)),j.c(this.elmRibbonTopBars)&&(this._elmRibbonTopBars=K.a.createElement("div"),this.elmRibbonTopBars.id=s.CuiHelper.headerTopBarsId,this.elmRibbonTopBars.className="cui-ribbonTopBars"+(this.isSingleRowLayoutRibbon?" cui-singlerowlayout":""),this.elmRibbonTopBars.style.zIndex=String(1),this.elementInternal.appendChild(this.elmRibbonTopBars)),this.ensureHeaderDom()},R.ensureHeaderDom=function(){var e;p.a.tryEnsuredHeaderPanelInitialized(Object(a.a)((function(){return e}),(function(t){return e=t})))?(j.c(this._headerContainer)&&(this._headerContainer=K.a.createElement("div"),this._headerContainer.className="cui-ribbonTopBars",this._headerContainer.id=s.CuiHelper.externalHeaderFullTopBarsId,e.appendChild(this._headerContainer)),this.ensureExternalHeaderCss(),Sys.UI.DomElement.addCssClass(this.elementInternal,"cui-exth"),d.AFrameworkApplication.activeFrame&&d.AFrameworkApplication.activeFrame.applicationInstance.isRibbonFlexBoxLayoutEnabled&&!d.AFrameworkApplication.hideHeaderEmbedded&&this.ensureFlexBoxPositioningCss()):this._headerContainer=this.elmRibbonTopBars},R.ensureExternalHeaderCss=function(){Sys.UI.DomElement.addCssClass(this._headerContainer,this.cssClass),1===this.textDirection&&K.a.ensureCSSClassOnElement(this._headerContainer,"cui-rtl")},R.ensureFlexBoxPositioningCss=function(){Sys.UI.DomElement.addCssClass(this._headerContainer,"FlexBoxLayout")},R.ensureTabContainer=function(){j.c(this._elmTabContainer)&&(this._elmTabContainerOverflowContainer=K.a.createElement("div"),this._elmTabContainerOverflowContainer.id=o.tabContainerOverflowId,this._elmTabContainerOverflowContainer.setAttribute("role","presentation"),this._elmTabContainerOverflowContainer.style.overflow="hidden",this._elmTabContainer=K.a.createElement("div"),this._elmTabContainer.setAttribute("role","presentation"),K.a.setEnabledOnElement(this._elmTabContainer,!1),this._elmTabContainerOverflowContainer.appendChild(this._elmTabContainer),this.ensurePinButton())},R.getPinButtonProperties=function(){var e={};return e.Command=this.ribbonProperties.CommandToggleRibbonState,this.minimized?(e.Image16by16=this.ribbonProperties.ImagePinButton,e.Image16by16Class=this.ribbonProperties.ImagePinButtonClass,e.Alt=this.ribbonProperties.PinButtonTooltip):(e.Image16by16=this.ribbonProperties.ImageUnpinButton,e.Image16by16Class=this.ribbonProperties.ImageUnpinButtonClass,e.Alt=this.ribbonProperties.UnpinButtonTooltip),e},R.updatePinButtonProperties=function(){var e=this._ribbonPinButton.behavior;if(e){var t=this.getPinButtonProperties();this._ribbonPinButton.stateProperties[w.a.Image16by16Class]=t.Image16by16Class,this._ribbonPinButton.stateProperties[V.a.alt]=t.Alt,e.updateImage(),e.updateTooltip()}},R.ensurePinButton=function(){if(this._ribbonPinButton=new I.a(this,"RibbonPinButton",this.getPinButtonProperties()),this._ribbonPinButton){var e=this._ribbonPinButton.createComponentForDisplayMode("Small");K.a.ensureCSSClassOnElement(e.elementInternal,"cui-pinButton"),e.enabled=!0,this.addChildAtIndex(e,this.children.count),this._elmTabContainer.appendChild(e.elementInternal)}},R.isPinButtonElement=function(e){return!!e&&!!e.id&&e.id.startsWith("RibbonPinButton")},R.isTabBodyElement=function(e){return!!e.className&&-1!==e.className.indexOf(W.Tab.tabBodyCssClassName)},R.findPeripherals=function(){j.c(this._elmTopRowCenter)&&(this._elmTopRowCenter=document.getElementById(this.clientID+"-"+l.a.topRowCenter)),j.c(this._elmTopRowRight)&&(this._elmTopRowRight=document.getElementById(this.clientID+"-"+l.a.topRowRight)),j.c(this._elmTopRowLeft)&&(this._elmTopRowLeft=document.getElementById(this.clientID+"-"+l.a.topRowLeft)),j.c(this._elmBottomRowLeft)&&(this._elmBottomRowLeft=document.getElementById(this.clientID+"-"+l.a.bottomRowLeft)),j.c(this._elmBottomRowCenter)&&(this._elmBottomRowCenter=document.getElementById(this.clientID+"-"+l.a.bottomRowCenter),d.AFrameworkApplication.activeFrame&&d.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||K.a.ensureCSSClassOnElement(this._elmBottomRowCenter,"UITextTranformUpperCase")),j.c(this._elmBottomRowRight)&&(this._elmBottomRowRight=document.getElementById(this.clientID+"-"+l.a.bottomRowRight))},R.reloadPeripherals=function(){this.findPeripherals(),this.reparentPeripheralsAndCreateTabTitlesContainer(!0),this.scale()},R.reparentPeripheralsAndCreateTabTitlesContainer=function(e){if(void 0===e&&(e=!1),!this._peripheralContentsLoaded||e){j.c(this.peripheralContentContainer)||(this.peripheralContentContainer.style.display="block");var t=this.peripheralContentContainer;this.reparentPeripheral(this._elmTopRowLeft,t,"inline-block"),this.reparentPeripheral(this._elmTopRowCenter,this.peripheralContentContainer,"inline-block"),this.reparentPeripheral(this._elmTopRowRight,this.peripheralContentContainer,"inline-block"),this.reparentPeripheral(this._elmBottomRowLeft,this._elmTopBar2,"block"),j.c(this._elmTabTitles)&&(this._elmTabTitles=K.a.createElement("ul"),this._elmTabTitles.setAttribute("role","tablist"),this._elmTabTitles.className="cui-tts",this._elmTopBar2.appendChild(this._elmTabTitles)),this.reparentPeripheral(this._elmBottomRowCenter,this._elmTopBar2,"inline-block"),this.reparentPeripheral(this._elmBottomRowRight,this._elmTopBar2,"flex"),this._peripheralContentsLoaded=!0}},R.reparentPeripheral=function(e,t,n){j.c(e)||j.c(t)||e.parentNode===t||(t.appendChild(e),e.style.display=n,K.a.setUnselectable(e,!0,!1))},R.ensureGlobalDisablingRemoved=function(){K.a.setEnabledOnElement(this._elmTabTitles,!0),this.ensureTabContainerGlobalDisablingRemoved()},R.ensureTabContainerGlobalDisablingRemoved=function(){K.a.setEnabledOnElement(this._elmTabContainer,!0)},R.dispose=function(){j.c(this._elmTabContainer)||K.a.unregisterAllHandlers(this._elmTabContainer),e.prototype.dispose.call(this),this.jewel&&this.jewel.dispose(),this._previousTab=null,this._selectedTab=null,this._elmRibbonTopBars=null,this._elmTabTitles=null,this.jewelElement=null,this._elmTabContainer=null,this._elmTabContainerOverflowContainer=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._elmBottomRowLeft=null,this._elmBottomRowCenter=null,this._elmBottomRowRight=null,this._peripheralContentContainer=null,this._elmTopBar2=null;var t=this._contextualGroups;for(var n in t){({key:n,value:t[n]}).value.dispose()}this._contextualGroups=null,this._ribbonPinButton&&(this._ribbonPinButton.dispose(),this._ribbonPinButton=null),this.disposed=!0},R.onModalBodyPointerDown=function(e){var t=!1;return this.inKeytipMode&&(this.exitKeytipMode(!1),t=!0),3!==e.inputSource&&(this.dismissTabPopup(),t=!0),t},R.onModalBodyPointerUp=function(e){var t=!1;return window.navigator.msPointerEnabled&&3===e.inputSource&&(this.dismissTabPopup(),t=!0),t},R.onModalBodyPointerMove=function(e){return!1},R.onModalBodyPointerOut=function(e){return!1},R.onModalBodyClick=function(e){var t=!1;return window.navigator.msPointerEnabled||3!==e.inputSource||(this.dismissTabPopup(),t=!0),t},R.onModalBodyMouseWheel=function(e){return!1},R.displayTabPopup=function(){if(!this.tabPoppedUp){_.a.mark(10328),this._elmHadFocus=C.a.getActiveElement(this.elementInternal.ownerDocument),this.beginModal(this,!0),this.elementInternal.parentNode.style.zIndex=String(this.activeModalUIZIndex);var e=this.activeModalUIZIndex+1;this.elmRibbonTopBars.style.zIndex=String(e),this._tabPoppedUp=!0,this._tabPopupInvocationMethod=this._selectedTab.popupInvocationMethod,d.AFrameworkApplication.activeFrame&&d.AFrameworkApplication.activeFrame.applicationInstance.isRibbonFlexBoxLayoutEnabled&&(this._elmTabContainerOverflowContainer.style.position="absolute",this._elmTabContainerOverflowContainer.style.width="100%",this._elmTabContainerOverflowContainer.style.zIndex=String(e)),this._ribbonStateChanged=!0,this.refresh(),N.animateRibbonExpandCollapse(this,!0,this.inKeytipMode),_.a.mark(10329)}},R.dismissTabPopup=function(e,t){if(void 0===e&&(e=!0),void 0===t&&(t=!0),this.cancelPendingDismissTabPopup(),this.tabPoppedUp&&!this._dismissingTabPopup&&this.isCurrentModalController(this)){N.animateRibbonExpandCollapse(this,!1,!1),this._dismissingTabPopup=!0,this.commitAnyPendingChange(),this.endModal(this,t,e),b.CssUtils.removeStyle(this.elementInternal.parentNode,"zIndex");var n=this.inKeytipMode?this.keytipModeRibbonHeadersZIndex:1;return this.elmRibbonTopBars.style.zIndex=String(n),d.AFrameworkApplication.activeFrame&&d.AFrameworkApplication.activeFrame.applicationInstance.isRibbonFlexBoxLayoutEnabled&&(this._elmTabContainerOverflowContainer.style.zIndex=String(n)),j.c(this._selectedTab)||(this._selectedTab.setSelectedInternal(!1,!1),this._selectedTab=null),this._previousTab=null,this._tabPoppedUp=!1,this._ribbonStateChanged=!0,this.refreshInternal(),d.AFrameworkApplication.activeFrame.restoreFocusAfterDismissingPopup(this._elmHadFocus,this._tabPopupInvocationMethod),this._elmHadFocus=null,this._dismissingTabPopup=!1,!0}return!1},R.delayDismissTabPopup=function(e){var t=this;-1!==this._pendingDismissRibbonTimeoutId||this._dismissingTabPopup||(this._pendingDismissRibbonTimeoutId=window.setTimeout((function(){t.dismissTabPopup()}),e))},R.cancelPendingDismissTabPopup=function(){var e=this;K.a.cancelPendingTimeout(Object(a.a)((function(){return e._pendingDismissRibbonTimeoutId}),(function(t){return e._pendingDismissRibbonTimeoutId=t})))},R.dismissAllTransientUI=function(){var t=e.prototype.dismissAllTransientUI.call(this);return this.dismissTabPopup()&&(t=!0),this.inKeytipMode&&(this.exitKeytipMode(),t=!0),t},R.getControlVisibility=function(e){var t=this.getControlById(e);return!!t&&t.visible},R.setControlVisibility=function(e,t){var n=this.getControlById(e);n&&(n.visible=t,this.dirty&&this.refreshInternal())},R.isControlEnabled=function(e){var t=this.getControlById(e);return!!t&&t.enabled},R.forceEnableControl=function(e,t){var n=this.getControlById(e);n&&(n.forceSetEnabledState(t),this.dirty&&this.refreshInternal())},o.add_onRibbonTabSwitchedEventHandler=function(e){o._ribbonTabSwitchedEventSource.addHandler("RTSE",e)},o.remove_onRibbonTabSwitchedEventHandler=function(e){o._ribbonTabSwitchedEventSource.removeHandler("RTSE",e)},h=o,(m=[{key:"activeModalUIZIndex",get:function(){return d.AFrameworkApplication.activeFrame.activeModalUIZIndex}},{key:"keytipModeRibbonHeadersZIndex",get:function(){return this.activeModalUIZIndex-3}},{key:"upperRibbonHeight",get:function(){return this.isSingleRowLayoutRibbon?g.singleRowLayoutUpperRibbonHeight:g.upperRibbonHeight}},{key:"lowerRibbonHeight",get:function(){return g.lowerRibbonHeight(this.isLowerRibbonTouchMode,this.isSingleRowLayoutRibbon)}},{key:"peripheralContentContainer",get:function(){return this._peripheralContentContainer}},{key:"elmRibbonTopBars",get:function(){return this._elmRibbonTopBars}},{key:"isLowerRibbonTouchMode",get:function(){return this._isLowerRibbonTouchMode||this.touchModeForcedOn},set:function(e){this._isLowerRibbonTouchMode=e}},{key:"theStandaloneRoot",get:function(){return this._theStandaloneRoot}},{key:"inKeytipMode",get:function(){return!!this.keytipManager&&this.keytipManager.inKeytipMode}},{key:"supportsInvisibleControls",get:function(){return d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RibbonSupportsInvisibleControlsIsEnabled")}},{key:"isRibbonCurrentModalController",get:function(){return this.inModalMode&&this.isCurrentModalController(this)}},{key:"contextualGroupIds",get:function(){var e=[],t=this._contextualGroups;for(var n in t){var i={key:n,value:t[n]};Array.add(e,i.key)}return e}},{key:"cssClass",get:function(){return"cui-ribbon"}},{key:"cssClassMarker",get:function(){return"cui-ribbon-marker"}},{key:"rootType",get:function(){return 2}},{key:"jewelDisplayedComponent",get:function(){return this.jewel&&this.jewel.jewelMenuLauncher?this.jewel.jewelMenuLauncher.displayedComponent:null}},{key:"selectedTabId",get:function(){return this._selectedTab?this._selectedTab.id:null}},{key:"lastScaleTime",get:function(){return this._lastScaleTime.getTime()}},{key:"minimized",get:function(){return this._minimized},set:function(e){this._minimized!==e&&(this.minimizedInternal=e,!e&&this.pollForState&&this.pollForStateAndUpdate())}},{key:"minimizedInternal",get:function(){return this._minimized},set:function(e){this._minimized===e&&this._minimizedEverSet||(this.onDirtyingChange(),this._minimized=e,this._minimizedEverSet=!0,e&&!j.c(this._selectedTab)&&(this._selectedTab.setSelectedInternal(!1,!1),this._selectedTab=null),this._ribbonStateChanged=!0)}},{key:"tabShowing",get:function(){return!this._minimized||this.tabPoppedUp}},{key:"ribbonProperties",get:function(){return this.properties}},{key:"ribbonBuilder",get:function(){return this.builder},set:function(e){this.builder=e}},{key:"domElementTagName",get:function(){return"div"}},{key:"rootUser",get:function(){return Object(G.a)(o.prototype,this,"rootUser")},set:function(e){Object(G.b)(o.prototype,this,"rootUser",e),j.c(this.jewel)||(this.jewel.rootUser=e)}},{key:"visibleInDOM",get:function(){return!0},set:function(e){Object(G.b)(o.prototype,this,"visibleInDOM",e)}},{key:"tabPoppedUp",get:function(){return this._tabPoppedUp}}])&&$(h.prototype,m),T&&$(h,T),o}(o.a);X.tabContainerOverflowId="TabContainerOverflow",X._ribbonTabSwitchedEventSource=new q.a,Object(i.a)(X,"Ribbon",o.a,[68,69,19,70,71])},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),r=n(11),a=n(2),o=n(169),s=n(93),l=function(){function e(e){this._buckets=null,this._count=0,this.$$ge=this.getEnumerator,this._comparer=e,this.clear()}var t=e.prototype;return t.getEnumerator=function(){return s.selectMany(s.asEnumerable(this._buckets),(function(e){return s.asEnumerable(e)})).$$ge()},t[Symbol.iterator]=function(){return Object(a.b)(this.getEnumerator())},t.get_count=function(){return this._count},t.set_count=function(e){return this._count=e,e},t.add=function(e){for(var t=this,n=o.b(Object(r.a)((function(){return t._buckets}),(function(e){return t._buckets=e})),e,this._comparer,this.get_count()),i=0;i<n.length;i++){var a=n[i];if(this._comparer.equals(a,e))return!1}return this.set_count(this.get_count()+1),Array.add(n,e),!0},t.clear=function(){var e=this;this._buckets=null,this.set_count(0),o.c(Object(r.a)((function(){return e._buckets}),(function(t){return e._buckets=t})),this._comparer,7)},t.contains=function(e){for(var t=this._buckets[o.a(this._buckets,this._comparer.getHashCode(e))],n=0;n<t.length;n++){var i=t[n];if(this._comparer.equals(i,e))return!0}return!1},t.remove=function(e){for(var t=this._buckets[o.a(this._buckets,this._comparer.getHashCode(e))],n=0;n<t.length;n++){var i=t[n];if(this._comparer.equals(i,e))return Array.removeAt(t,n),this.set_count(this.get_count()-1),!0}return!1},e}();Object(i.a)(l,"HashSet",null,[34,35])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=(n(9),n(13),n(101));function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(t,n,i){if(this._lcid=0,this._name=null,this._neutral=!1,this._displayName=null,1===arguments.length){var r=e.getCultureInfo(t);0,r?(this._name=r._name,this._lcid=r._lcid,this._displayName=r._displayName,this._neutral=r._neutral):(this._name="X-NONE",this._lcid=0,this._displayName="Unknown Culture",this._neutral=!0)}else this._name=t,this._lcid=n,this._neutral=i}var t,n,i;return e.get_languageIdMapping=function(){return e._languageIdMapping||(e._languageIdMapping=new r.a((function(){var e;return(e={})[1281]="qps-ploc",e[1534]="qps-ploca",e[2559]="qps-plocm",e[20490]="es-PR",e[8251]="sms-FI",e[17418]="es-SV",e[17417]="en-MY",e[8218]="bs-Cyrl-BA",e[8204]="fr-RE",e[8202]="es-VE",e[8201]="en-JM",e[8200]="el-GR",e[8193]="ar-OM",e[6154]="es-PA",e[7227]="sma-SE",e[19466]="es-NI",e[16394]="es-BO",e[16393]="en-IN",e[16385]="ar-QA",e[7194]="sr-Cyrl-BA",e[7180]="fr-WINDIES",e[7178]="es-DO",e[7177]="en-ZA",e[7169]="ar-TN",e[12289]="ar-LB",e[6203]="sma-NO",e[15372]="fr-HT",e[15370]="es-PY",e[15369]="en-HK",e[15361]="ar-BH",e[6170]="sr-Latn-BA",e[6156]="fr-MC",e[18442]="es-HN",e[6153]="en-IE",e[6145]="ar-MA",e[4155]="smj-NO",e[11274]="es-AR",e[5179]="smj-SE",e[14348]="fr-MA",e[14346]="es-UY",e[14345]="en-ID",e[14337]="ar-AE",e[5146]="bs-Latn-BA",e[5132]="fr-LU",e[5130]="es-CR",e[5129]="en-NZ",e[5127]="de-LI",e[5124]="zh-MO",e[5121]="ar-DZ",e[31770]="sr",e[31748]="zh-HanT",e[22538]="es-419",e[10266]="sr-Cyrl-RS",e[10252]="fr-SN",e[10250]="es-PE",e[10249]="en-BZ",e[13324]="fr-ML",e[13322]="es-CL",e[13321]="en-PH",e[10241]="ar-SY",e[13313]="ar-KW",e[4122]="hr-BA",e[4108]="fr-CH",e[4106]="es-GT",e[4105]="en-CA",e[4103]="de-LU",e[4100]="zh-SG",e[3179]="quz-PE",e[4097]="ar-LY",e[1085]="yi-Hebr",e[1144]="ii-CN",e[2163]="ti-ET",e[21514]="es-US",e[2145]="ne-IN",e[3131]="se-FI",e[2143]="tzm-Latn-DZ",e[12314]="sr-Cyrl-ME",e[1070]="hsb-DE",e[1130]="yo-NG",e[12300]="fr-CI",e[1091]="uz-Latn-UZ",e[12298]="es-EC",e[12297]="en-ZW",e[2055]="de-CH",e[2052]="zh-CN",e[2115]="uz-Cyrl-UZ",e[9242]="sr-Latn-RS",e[3098]="sr-Cyrl-CS",e[2107]="se-SE",e[9228]="fr-CD",e[3084]="fr-CA",e[9226]="es-CO",e[3082]="es-ES",e[3081]="en-AU",e[2094]="dsb-DE",e[3079]="de-AT",e[2092]="az-Cyrl-AZ",e[1064]="tg-Cyrl-TJ",e[3076]="zh-HK",e[2155]="quz-EC",e[3073]="ar-EG",e[3072]="[Custom Culture]",e[1153]="mi-NZ",e[1119]="tzm-Arab-MA",e[1086]="ms-MY",e[2144]="ks-Deva",e[2077]="sv-FI",e[1053]="sv-SE",e[2141]="iu-Latn-CA",e[2074]="sr-Latn-CS",e[2073]="ru-MO",e[2072]="ro-MO",e[2137]="sd-Arab-PK",e[2070]="pt-PT",e[2068]="nn-NO",e[2067]="nl-BE",e[1073]="ts-ZA",e[2064]="it-CH",e[2129]="bo-BT",e[2128]="mn-Mong-CN",e[2060]="fr-BE",e[1132]="nso-ZA",e[1097]="ta-IN",e[2057]="en-GB",e[1164]="prs-AF",e[106]="yo",e[2118]="pa-Arab-PK",e[2117]="bn-BD",e[2049]="ar-IQ",e[2048]="[Language Not Specified]",e[1156]="gsw-FR",e[2110]="ms-BN",e[1054]="th-TH",e[2108]="ga-IE",e[1083]="se-NO",e[136]="wo",e[1114]="syr-SY",e[1148]="moh-CA",e[1145]="pap-AN",e[11290]="sr-Latn-ME",e[1075]="ve-ZA",e[1106]="cy-GB",e[1140]="gn-PY",e[1139]="ti-ER",e[1138]="om-Ethi-ET",e[120]="ii",e[1136]="ig-NG",e[1066]="vi-VN",e[1098]="te-IN",e[1169]="gd-GB",e[2087]="lt-LT",e[11276]="fr-CM",e[61]="yi",e[1060]="sl-SI",e[11273]="en-TT",e[1058]="uk-UA",e[128]="ug",e[1160]="wo-SN",e[1159]="rw-RW",e[1158]="qut-GT",e[1157]="sah-RU",e[11265]="ar-JO",e[1155]="co-FR",e[1154]="oc-FR",e[1117]="iu-Cans-CA",e[1152]="ug-CN",e[1115]="si-LK",e[1150]="br-FR",e[1113]="sd-Deva-IN",e[1112]="mni-IN",e[51]="ve",e[1146]="arn-CL",e[1109]="my-MM",e[115]="ti",e[1143]="so-SO",e[1142]="la-Latn",e[1141]="haw-US",e[1104]="mn-MN",e[2058]="es-MX",e[1102]="mr-IN",e[1137]="kr-NG",e[1100]="ml-IN",e[1135]="kl-GL",e[1134]="lb-LU",e[1133]="ba-RU",e[1096]="or-IN",e[1131]="quz-BO",e[1094]="pa-IN",e[1129]="ibb-NG",e[1128]="ha-Latn-NG",e[1127]="ff-NG",e[1126]="bin-NG",e[1125]="dv-MV",e[1124]="fil-PH",e[1123]="ps-AF",e[1122]="fy-NL",e[1121]="ne-NP",e[1120]="ks-Arab",e[1084]="gd-GB",e[1118]="am-ET",e[1082]="mt-MT",e[1116]="chr-Cher-US",e[1080]="fo-FO",e[1079]="ka-GE",e[1078]="af-ZA",e[1077]="zu-ZA",e[1111]="kok-IN",e[1110]="gl-ES",e[1074]="tn-ZA",e[1108]="lo-LA",e[1107]="km-KH",e[1071]="mk-MK",e[1105]="bo-CN",e[1069]="eu-ES",e[1103]="sa-IN",e[1067]="hy-AM",e[1101]="as-IN",e[1065]="fa-IR",e[1099]="kn-IN",e[1063]="lt-LT",e[1062]="lv-LV",e[1061]="et-EE",e[1095]="gu-IN",e[1059]="be-BY",e[1093]="bn-IN",e[1092]="tt-RU",e[1056]="ur-PK",e[1090]="tk-TM",e[1089]="sw-KE",e[1088]="ky-KG",e[1087]="kk-KZ",e[1052]="sq-AL",e[1051]="sk-SK",e[1050]="hr-HR",e[1049]="ru-RU",e[1048]="ro-RO",e[1081]="hi-IN",e[1046]="pt-BR",e[1045]="pl-PL",e[1044]="nb-NO",e[1043]="nl-NL",e[1076]="xh-ZA",e[1041]="ja-JP",e[1040]="it-IT",e[119]="so",e[1072]="st-ZA",e[1037]="he-IL",e[1036]="fr-FR",e[1035]="fi-FI",e[1068]="az-Latn-AZ",e[1033]="en-US",e[1032]="el-GR",e[1031]="de-DE",e[1030]="da-DK",e[1029]="cs-CZ",e[1028]="zh-TW",e[1027]="ca-ES",e[1026]="bg-BG",e[140]="prs",e[1024]="[No Proofing]",e[1057]="id-ID",e[50]="tn",e[1055]="tr-TR",e[135]="rw",e[134]="qut",e[133]="sah",e[132]="gsw",e[131]="co",e[130]="oc",e[129]="mi",e[1047]="rm-CH",e[127]="[Invariant Language]",e[126]="br",e[89]="sd",e[124]="moh",e[1042]="ko-KR",e[122]="arn",e[121]="pap",e[1039]="is-IS",e[1038]="hu-HU",e[118]="la",e[117]="haw",e[116]="gn",e[1034]="es-ES_tradnl",e[114]="om",e[113]="kr",e[112]="ig",e[111]="kl",e[110]="lb",e[109]="ba",e[108]="nso",e[107]="quz",e[1025]="ar-SA",e[105]="ibb",e[104]="ha",e[103]="ff",e[102]="bin",e[101]="dv",e[100]="fil",e[99]="ps",e[98]="fy",e[97]="ne",e[96]="ks",e[95]="tzm",e[94]="am",e[93]="iu",e[92]="chr",e[91]="si",e[90]="syr",e[85]="my",e[88]="mni",e[87]="kok",e[86]="gl",e[9275]="smn-FI",e[84]="lo",e[83]="km",e[82]="cy",e[81]="bo",e[80]="mn",e[79]="sa",e[78]="mr",e[77]="as",e[76]="ml",e[75]="kn",e[74]="te",e[73]="ta",e[72]="or",e[71]="gu",e[70]="pa",e[69]="bn",e[68]="tt",e[67]="uz",e[66]="tk",e[65]="sw",e[64]="ky",e[63]="kk",e[62]="ms",e[18441]="en-SG",e[60]="gd",e[59]="se",e[58]="mt",e[57]="hi",e[56]="fo",e[55]="ka",e[54]="af",e[53]="zu",e[52]="xh",e[31]="tr",e[47]="mk",e[49]="ts",e[48]="st",e[44]="az",e[46]="hsb",e[45]="eu",e[41]="fa",e[43]="hy",e[42]="vi",e[38]="lv",e[40]="tg",e[39]="lt",e[35]="be",e[37]="et",e[36]="sl",e[9225]="en-029",e[34]="uk",e[33]="id",e[32]="ur",e[29]="sv",e[30]="th",e[27]="sk",e[28]="sq",e[9217]="ar-YE",e[26]="hr",e[25]="ru",e[24]="ro",e[23]="rm",e[22]="pt",e[21]="pl",e[20]="no",e[19]="nl",e[18]="ko",e[17]="ja",e[16]="it",e[15]="is",e[14]="hu",e[13]="he",e[12]="fr",e[11]="fi",e[10]="es",e[9]="en",e[8]="el",e[7]="de",e[6]="da",e[5]="cs",e[4]="zh-HanS",e[3]="ca",e[2]="bg",e[1]="ar",e[0]="x-none",e})))},e.initLanguages=function(){var t,n,i;e._allCultures=[],e._lcidMap=[],e._localnameMap={},e.initLanguagesFromDictionary(((t={})["QPS-PLOC"]=1281,t["QPS-PLOCA"]=1534,t["QPS-PLOCM"]=2559,t["AR-SA"]=1025,t["BG-BG"]=1026,t["CA-ES"]=1027,t["ZH-TW"]=1028,t["CS-CZ"]=1029,t["DA-DK"]=1030,t["DE-DE"]=1031,t["EL-GR"]=1032,t["EN-US"]=1033,t["ES-ES"]=1034,t["FI-FI"]=1035,t["FR-FR"]=1036,t["HE-IL"]=1037,t["HU-HU"]=1038,t["IS-IS"]=1039,t["IT-IT"]=1040,t["JA-JP"]=1041,t["KO-KR"]=1042,t["NL-NL"]=1043,t["NB-NO"]=1044,t["PL-PL"]=1045,t["PT-BR"]=1046,t["RM-CH"]=1047,t["RO-RO"]=1048,t["RU-RU"]=1049,t["HR-HR"]=1050,t["SK-SK"]=1051,t["SQ-AL"]=1052,t["SV-SE"]=1053,t["TH-TH"]=1054,t["TR-TR"]=1055,t["UR-PK"]=1056,t["ID-ID"]=1057,t["UK-UA"]=1058,t["BE-BY"]=1059,t["SL-SI"]=1060,t["ET-EE"]=1061,t["LV-LV"]=1062,t["LT-LT"]=1063,t["TG-CYRL-TJ"]=1064,t["FA-IR"]=1065,t["VI-VN"]=1066,t["HY-AM"]=1067,t["AZ-LATN-AZ"]=1068,t["EU-ES"]=1069,t["HSB-DE"]=1070,t["MK-MK"]=1071,t["ST-ZA"]=1072,t["TS-ZA"]=1073,t["TN-ZA"]=1074,t["VE-ZA"]=1075,t["XH-ZA"]=1076,t["ZU-ZA"]=1077,t["AF-ZA"]=1078,t["KA-GE"]=1079,t["FO-FO"]=1080,t["HI-IN"]=1081,t["MT-MT"]=1082,t["SE-NO"]=1083,t["YI-HEBR"]=1085,t["MS-MY"]=1086,t["KK-KZ"]=1087,t["KY-KG"]=1088,t["SW-KE"]=1089,t["TK-TM"]=1090,t["UZ-LATN-UZ"]=1091,t["TT-RU"]=1092,t["BN-IN"]=1093,t["PA-IN"]=1094,t["GU-IN"]=1095,t["OR-IN"]=1096,t["TA-IN"]=1097,t["TE-IN"]=1098,t["KN-IN"]=1099,t["ML-IN"]=1100,t["AS-IN"]=1101,t["MR-IN"]=1102,t["SA-IN"]=1103,t["MN-MN"]=1104,t["BO-CN"]=1105,t["CY-GB"]=1106,t["KM-KH"]=1107,t["LO-LA"]=1108,t["MY-MM"]=1109,t["GL-ES"]=1110,t["KOK-IN"]=1111,t["MNI-IN"]=1112,t["SD-DEVA-IN"]=1113,t["SYR-SY"]=1114,t["SI-LK"]=1115,t["CHR-CHER-US"]=1116,t["IU-CANS-CA"]=1117,t["AM-ET"]=1118,t["TZM-ARAB-MA"]=1119,t["KS-ARAB"]=1120,t["NE-NP"]=1121,t["FY-NL"]=1122,t["PS-AF"]=1123,t["FIL-PH"]=1124,t["DV-MV"]=1125,t["BIN-NG"]=1126,t["FF-NG"]=1127,t["HA-LATN-NG"]=1128,t["IBB-NG"]=1129,t["YO-NG"]=1130,t["QUZ-BO"]=1131,t["NSO-ZA"]=1132,t["BA-RU"]=1133,t["LB-LU"]=1134,t["KL-GL"]=1135,t["IG-NG"]=1136,t["KR-NG"]=1137,t["OM-ETHI-ET"]=1138,t["TI-ET"]=1139,t["GN-PY"]=1140,t["HAW-US"]=1141,t["LA-LATN"]=1142,t["SO-SO"]=1143,t["II-CN"]=1144,t["PAP-AN"]=1145,t["ARN-CL"]=1146,t["MOH-CA"]=1148,t["BR-FR"]=1150,t["UG-CN"]=1152,t["MI-NZ"]=1153,t["OC-FR"]=1154,t["CO-FR"]=1155,t["GSW-FR"]=1156,t["SAH-RU"]=1157,t["QUT-GT"]=1158,t["RW-RW"]=1159,t["WO-SN"]=1160,t["PRS-AF"]=1164,t["GD-GB"]=1169,t["KU-ARAB-IQ"]=1170,t["AR-IQ"]=2049,t["CA-ES-VALENCIA"]=2051,t["ZH-CN"]=2052,t["DE-CH"]=2055,t["EN-GB"]=2057,t["ES-MX"]=2058,t["FR-BE"]=2060,t["IT-CH"]=2064,t["NL-BE"]=2067,t["NN-NO"]=2068,t["PT-PT"]=2070,t["RO-MD"]=2072,t["RU-MD"]=2073,t["SR-LATN-CS"]=2074,t["SV-FI"]=2077,t["AZ-CYRL-AZ"]=2092,t["DSB-DE"]=2094,t["SE-SE"]=2107,t["GA-IE"]=2108,t["MS-BN"]=2110,t["UZ-CYRL-UZ"]=2115,t["BN-BD"]=2117,t["PA-ARAB-PK"]=2118,t["MN-MONG-CN"]=2128,t["SD-ARAB-PK"]=2137,t["IU-LATN-CA"]=2141,t["TZM-LATN-DZ"]=2143,t["KS-DEVA"]=2144,t["NE-IN"]=2145,t["QUZ-EC"]=2155,t["TI-ER"]=2163,t["AR-EG"]=3073,t["ZH-HK"]=3076,t["DE-AT"]=3079,t["EN-AU"]=3081,t["ES-419"]=22538,t),!1),e.initLanguagesFromDictionary(((n={})["ES-ES"]=3082,n["FR-CA"]=3084,n["SR-CYRL-CS"]=3098,n["SE-FI"]=3131,n["QUZ-PE"]=3179,n["AR-LY"]=4097,n["ZH-SG"]=4100,n["DE-LU"]=4103,n["EN-CA"]=4105,n["ES-GT"]=4106,n["FR-CH"]=4108,n["HR-BA"]=4122,n["SMJ-NO"]=4155,n["AR-DZ"]=5121,n["ZH-MO"]=5124,n["DE-LI"]=5127,n["EN-NZ"]=5129,n["ES-CR"]=5130,n["FR-LU"]=5132,n["BS-LATN-BA"]=5146,n["SMJ-SE"]=5179,n["AR-MA"]=6145,n["EN-IE"]=6153,n["ES-PA"]=6154,n["FR-MC"]=6156,n["SR-LATN-BA"]=6170,n["SMA-NO"]=6203,n["AR-TN"]=7169,n["EN-ZA"]=7177,n["ES-DO"]=7178,n["FR-WINDIES"]=7180,n["SR-CYRL-BA"]=7194,n["SMA-SE"]=7227,n["AR-OM"]=8193,n["EN-JM"]=8201,n["ES-VE"]=8202,n["FR-RE"]=8204,n["BS-CYRL-BA"]=8218,n["SMS-FI"]=8251,n["AR-YE"]=9217,n["EN-029"]=9225,n["ES-CO"]=9226,n["FR-CD"]=9228,n["SR-LATN-RS"]=9242,n["SMN-FI"]=9275,n["AR-SY"]=10241,n["EN-BZ"]=10249,n["ES-PE"]=10250,n["FR-SN"]=10252,n["SR-CYRL-RS"]=10266,n["AR-JO"]=11265,n["EN-TT"]=11273,n["ES-AR"]=11274,n["FR-CM"]=11276,n["SR-LATN-ME"]=11290,n["AR-LB"]=12289,n["EN-ZW"]=12297,n["ES-EC"]=12298,n["FR-CI"]=12300,n["SR-CYRL-ME"]=12314,n["AR-KW"]=13313,n["EN-PH"]=13321,n["ES-CL"]=13322,n["FR-ML"]=13324,n["AR-AE"]=14337,n["EN-ID"]=14345,n["ES-UY"]=14346,n["FR-MA"]=14348,n["AR-BH"]=15361,n["EN-HK"]=15369,n["ES-PY"]=15370,n["FR-HT"]=15372,n["AR-QA"]=16385,n["EN-IN"]=16393,n["ES-BO"]=16394,n["EN-MY"]=17417,n["ES-SV"]=17418,n["EN-SG"]=18441,n["ES-HN"]=18442,n["ES-NI"]=19466,n["ES-PR"]=20490,n["ES-US"]=21514,n),!1),e.initLanguagesFromDictionary(((i={}).AR=1,i.BG=2,i.CA=3,i["ZH-CHS"]=4,i.CS=5,i.DA=6,i.DE=7,i.EL=8,i.EN=9,i.ES=10,i.FI=11,i.FR=12,i.HE=13,i.HU=14,i.IS=15,i.IT=16,i.JA=17,i.KO=18,i.NL=19,i.NO=20,i.PL=21,i.PT=22,i.RO=24,i.RU=25,i.HR=26,i.SK=27,i.SQ=28,i.SV=29,i.TH=30,i.TR=31,i.UR=32,i.ID=33,i.UK=34,i.BE=35,i.SL=36,i.ET=37,i.LV=38,i.LT=39,i.FA=41,i.VI=42,i.HY=43,i.AZ=44,i.EU=45,i.MK=47,i.ST=48,i.TS=49,i.VE=51,i.AF=54,i.KA=55,i.FO=56,i.HI=57,i.GD=60,i.YI=61,i.MS=62,i.KK=63,i.KY=64,i.SW=65,i.UZ=67,i.TT=68,i.PA=70,i.GU=71,i.TA=73,i.TE=74,i.KN=75,i.MR=78,i.SA=79,i.MN=80,i.MY=85,i.GL=86,i.KOK=87,i.MNI=88,i.SD=89,i.SYR=90,i.CHR=92,i.TZM=95,i.KS=96,i.NE=97,i.DV=101,i.BIN=102,i.FF=103,i.IBB=105,i.KR=113,i.OM=114,i.TI=115,i.GN=116,i.HAW=117,i.LA=118,i.SO=119,i.PAP=121,i["X-NONE"]=127,i["ZH-CHT"]=31748,i.SR=31770,i),!0)},e.initLanguagesFromDictionary=function(t,n){for(var i in t){var r={key:i,value:t[i]},a=r.key,o=r.value,s=new e(a,o,n);Array.add(e._allCultures,s),e._lcidMap[o]=s,e._localnameMap[a.toUpperCase()]=s}},e.get_l_LanguageNames=function(){return e._languageNames||(e._languageNames=[],e._languageNames[1025]=CommonStrings.arabic_Saudi_Arabia,e._languageNames[1026]=CommonStrings.bulgarian,e._languageNames[1027]=CommonStrings.catalan,e._languageNames[1028]=CommonStrings.chinese_Taiwan,e._languageNames[1029]=CommonStrings.czech,e._languageNames[1030]=CommonStrings.danish,e._languageNames[1031]=CommonStrings.german_Germany,e._languageNames[1032]=CommonStrings.greek,e._languageNames[1033]=CommonStrings.english_US,e._languageNames[1034]=CommonStrings.spanish_Spain_Traditional_Sort,e._languageNames[1035]=CommonStrings.finnish,e._languageNames[1036]=CommonStrings.french_France,e._languageNames[1037]=CommonStrings.hebrew,e._languageNames[1038]=CommonStrings.hungarian,e._languageNames[1039]=CommonStrings.icelandic,e._languageNames[1040]=CommonStrings.italian_Italy,e._languageNames[1041]=CommonStrings.japanese,e._languageNames[1042]=CommonStrings.korean,e._languageNames[1043]=CommonStrings.dutch_Netherlands,e._languageNames[1044]=CommonStrings.norwegian_Bokmal,e._languageNames[1045]=CommonStrings.polish,e._languageNames[1046]=CommonStrings.portuguese_Brazil,e._languageNames[1047]=CommonStrings.romansh,e._languageNames[1048]=CommonStrings.romanian,e._languageNames[1049]=CommonStrings.russian,e._languageNames[1050]=CommonStrings.croatian_Croatia,e._languageNames[1051]=CommonStrings.slovak,e._languageNames[1052]=CommonStrings.albanian,e._languageNames[1053]=CommonStrings.swedish_Sweden,e._languageNames[1054]=CommonStrings.thai,e._languageNames[1055]=CommonStrings.turkish,e._languageNames[1056]=CommonStrings.urdu,e._languageNames[1057]=CommonStrings.indonesian,e._languageNames[1058]=CommonStrings.ukrainian,e._languageNames[1059]=CommonStrings.belarusian,e._languageNames[1060]=CommonStrings.slovenian,e._languageNames[1061]=CommonStrings.estonian,e._languageNames[1062]=CommonStrings.latvian,e._languageNames[1063]=CommonStrings.lithuanian,e._languageNames[1064]=CommonStrings.tajik,e._languageNames[1065]=CommonStrings.persian,e._languageNames[1066]=CommonStrings.vietnamese,e._languageNames[1067]=CommonStrings.armenian,e._languageNames[1068]=CommonStrings.azerbaijani_Latin,e._languageNames[1069]=CommonStrings.basque,e._languageNames[1070]=CommonStrings.upper_Sorbian,e._languageNames[1071]=CommonStrings.macedonian,e._languageNames[1072]=CommonStrings.sesotho_South_Africa,e._languageNames[1073]=CommonStrings.xitsonga,e._languageNames[1074]=CommonStrings.setswana,e._languageNames[1075]=CommonStrings.venda,e._languageNames[1076]=CommonStrings.isiXhosa,e._languageNames[1077]=CommonStrings.isiZulu,e._languageNames[1078]=CommonStrings.afrikaans,e._languageNames[1079]=CommonStrings.georgian,e._languageNames[1080]=CommonStrings.faroese,e._languageNames[1081]=CommonStrings.hindi,e._languageNames[1082]=CommonStrings.maltese,e._languageNames[1083]=CommonStrings.sami_Northern_Norway,e._languageNames[1085]=CommonStrings.yiddish,e._languageNames[1086]=CommonStrings.malay_Malaysia,e._languageNames[1087]=CommonStrings.kazakh,e._languageNames[1088]=CommonStrings.kyrgyz,e._languageNames[1089]=CommonStrings.swahili,e._languageNames[1090]=CommonStrings.turkmen,e._languageNames[1091]=CommonStrings.uzbek_Latin,e._languageNames[1092]=CommonStrings.tatar,e._languageNames[1093]=CommonStrings.bangla_India,e._languageNames[1094]=CommonStrings.punjabi,e._languageNames[1095]=CommonStrings.gujarati,e._languageNames[1096]=CommonStrings.odia,e._languageNames[1097]=CommonStrings.tamil,e._languageNames[1098]=CommonStrings.telugu,e._languageNames[1099]=CommonStrings.kannada,e._languageNames[1100]=CommonStrings.malayalam,e._languageNames[1101]=CommonStrings.assamese,e._languageNames[1102]=CommonStrings.marathi,e._languageNames[1103]=CommonStrings.sanskrit,e._languageNames[1104]=CommonStrings.mongolian_Cyrillic,e._languageNames[1105]=CommonStrings.tibetan_China,e._languageNames[1106]=CommonStrings.welsh,e._languageNames[1107]=CommonStrings.khmer,e._languageNames[1108]=CommonStrings.lao,e._languageNames[1109]=CommonStrings.burmese,e._languageNames[1110]=CommonStrings.galician,e._languageNames[1111]=CommonStrings.konkani,e._languageNames[1112]=CommonStrings.manipuri,e._languageNames[1113]=CommonStrings.sindhi_Devanagari,e._languageNames[1114]=CommonStrings.syriac,e._languageNames[1115]=CommonStrings.sinhala,e._languageNames[1116]=CommonStrings.cherokee,e._languageNames[1117]=CommonStrings.inuktitut_Syllabics,e._languageNames[1118]=CommonStrings.amharic,e._languageNames[1119]=CommonStrings.tamazight_Arabic_Morocco,e._languageNames[1120]=CommonStrings.kashmiri_Arabic,e._languageNames[1121]=CommonStrings.nepali,e._languageNames[1122]=CommonStrings.frisian,e._languageNames[1123]=CommonStrings.pashto,e._languageNames[1124]=CommonStrings.filipino,e._languageNames[1125]=CommonStrings.divehi,e._languageNames[1126]=CommonStrings.edo,e._languageNames[1127]=CommonStrings.fulfulde,e._languageNames[1128]=CommonStrings.hausa,e._languageNames[1129]=CommonStrings.ibibio_Nigeria,e._languageNames[1130]=CommonStrings.yoruba,e._languageNames[1131]=CommonStrings.quechua_Bolivia,e._languageNames[1132]=CommonStrings.sesotho_sa_Leboa,e._languageNames[1133]=CommonStrings.bashkir,e._languageNames[1134]=CommonStrings.luxembourgish,e._languageNames[1135]=CommonStrings.greenlandic,e._languageNames[1136]=CommonStrings.igbo,e._languageNames[1137]=CommonStrings.kanuri,e._languageNames[1138]=CommonStrings.oromo,e._languageNames[1139]=CommonStrings.tigrigna_Ethiopia,e._languageNames[1140]=CommonStrings.guarani,e._languageNames[1141]=CommonStrings.hawaiian,e._languageNames[1142]=CommonStrings.latin,e._languageNames[1143]=CommonStrings.somali,e._languageNames[1144]=CommonStrings.yi_China,e._languageNames[1145]=CommonStrings.papiamentu,e._languageNames[1146]=CommonStrings.mapudungun,e._languageNames[1148]=CommonStrings.mohawk,e._languageNames[1150]=CommonStrings.breton,e._languageNames[1152]=CommonStrings.uyghur_China,e._languageNames[1153]=CommonStrings.maori,e._languageNames[1154]=CommonStrings.occitan,e._languageNames[1155]=CommonStrings.corsican,e._languageNames[1156]=CommonStrings.alsatian,e._languageNames[1157]=CommonStrings.sakha,e._languageNames[1158]=CommonStrings.kiche,e._languageNames[1159]=CommonStrings.kinyarwanda,e._languageNames[1160]=CommonStrings.wolof,e._languageNames[1164]=CommonStrings.dari_Afghanistan,e._languageNames[1169]=CommonStrings.scottish_Gaelic_United_Kingdom,e._languageNames[1170]=CommonStrings.central_Kurdish_Iraq,e._languageNames[1281]=CommonStrings.qpsPloc_Name,e._languageNames[1534]=CommonStrings.qpsPloca_Name,e._languageNames[2049]=CommonStrings.arabic_Iraq,e._languageNames[2051]=CommonStrings.valencian,e._languageNames[2052]=CommonStrings.chinese_China,e._languageNames[2055]=CommonStrings.german_Switzerland,e._languageNames[2057]=CommonStrings.english_UK,e._languageNames[2058]=CommonStrings.spanish_Mexico,e._languageNames[2060]=CommonStrings.french_Belgium,e._languageNames[2064]=CommonStrings.italian_Switzerland,e._languageNames[2067]=CommonStrings.dutch_Belgium,e._languageNames[2068]=CommonStrings.norwegian_Nynorsk,e._languageNames[2070]=CommonStrings.portuguese_Portugal,e._languageNames[2072]=CommonStrings.romanian_Moldova,e._languageNames[2073]=CommonStrings.russian_Moldova,e._languageNames[2074]=CommonStrings.serbian_Latin_Serbia_and_Montenegro_Former,e._languageNames[2077]=CommonStrings.swedish_Finland,e._languageNames[2092]=CommonStrings.azerbaijani_Cyrillic,e._languageNames[2094]=CommonStrings.lower_Sorbian,e._languageNames[2107]=CommonStrings.sami_Northern_Sweden,e._languageNames[2108]=CommonStrings.irish_Ireland,e._languageNames[2110]=CommonStrings.malay_Brunei_Darussalam,e._languageNames[2115]=CommonStrings.uzbek_Cyrillic,e._languageNames[2117]=CommonStrings.bangla_Bangladesh,e._languageNames[2118]=CommonStrings.punjabi_Pakistan,e._languageNames[2128]=CommonStrings.mongolian_Traditional_Mongolian_China,e._languageNames[2137]=CommonStrings.sindhi_Arabic,e._languageNames[2141]=CommonStrings.inuktitut_Latin,e._languageNames[2143]=CommonStrings.tamazight_Latin_Algeria,e._languageNames[2144]=CommonStrings.kashmiri,e._languageNames[2145]=CommonStrings.nepali_India,e._languageNames[2155]=CommonStrings.quechua_Ecuador,e._languageNames[2163]=CommonStrings.tigrigna_Eritrea,e._languageNames[2559]=CommonStrings.qpsPlocm_Name,e._languageNames[3073]=CommonStrings.arabic_Egypt,e._languageNames[3076]=CommonStrings.chinese_Hong_Kong_SAR,e._languageNames[3079]=CommonStrings.german_Austria,e._languageNames[3081]=CommonStrings.english_Australia,e._languageNames[3082]=CommonStrings.spanish_International_Sort,e._languageNames[3084]=CommonStrings.french_Canada,e._languageNames[3098]=CommonStrings.serbian_Cyrillic_Serbia_and_Montenegro_Former,e._languageNames[3131]=CommonStrings.sami_Northern_Finland,e._languageNames[3179]=CommonStrings.quechua_Peru,e._languageNames[4097]=CommonStrings.arabic_Libya,e._languageNames[4100]=CommonStrings.chinese_Singapore,e._languageNames[4103]=CommonStrings.german_Luxembourg,e._languageNames[4105]=CommonStrings.english_Canada,e._languageNames[4106]=CommonStrings.spanish_Guatemala,e._languageNames[4108]=CommonStrings.french_Switzerland,e._languageNames[4122]=CommonStrings.croatian_Bosnia_and_Herzegovina,e._languageNames[4155]=CommonStrings.sami_Lule_Norway,e._languageNames[5121]=CommonStrings.arabic_Algeria,e._languageNames[5124]=CommonStrings.chinese_Macao_SAR,e._languageNames[5127]=CommonStrings.german_Liechtenstein,e._languageNames[5129]=CommonStrings.english_New_Zealand,e._languageNames[5130]=CommonStrings.spanish_Costa_Rica,e._languageNames[5132]=CommonStrings.french_Luxembourg,e._languageNames[5146]=CommonStrings.bosnian_Latin,e._languageNames[5179]=CommonStrings.sami_Lule_Sweden,e._languageNames[6145]=CommonStrings.arabic_Morocco,e._languageNames[6153]=CommonStrings.english_Ireland,e._languageNames[6154]=CommonStrings.spanish_Panama,e._languageNames[6156]=CommonStrings.french_Monaco,e._languageNames[6170]=CommonStrings.serbian_Latin_Bosnia_and_Herzegovina,e._languageNames[6203]=CommonStrings.sami_Southern_Norway,e._languageNames[7169]=CommonStrings.arabic_Tunisia,e._languageNames[7177]=CommonStrings.english_South_Africa,e._languageNames[7178]=CommonStrings.spanish_Dominican_Republic,e._languageNames[7180]=CommonStrings.french_West_Indies,e._languageNames[7194]=CommonStrings.serbian_Cyrillic_Bosnia_and_Herzegovina,e._languageNames[7227]=CommonStrings.sami_Southern_Sweden,e._languageNames[8193]=CommonStrings.arabic_Oman,e._languageNames[8201]=CommonStrings.english_Jamaica,e._languageNames[8202]=CommonStrings.spanish_Venezuela,e._languageNames[8204]=CommonStrings.french_Reunion,e._languageNames[8218]=CommonStrings.bosnian_Cyrillic,e._languageNames[8251]=CommonStrings.sami_Skolt_Finland,e._languageNames[9217]=CommonStrings.arabic_Yemen,e._languageNames[9225]=CommonStrings.english_Caribbean,e._languageNames[9226]=CommonStrings.spanish_Colombia,e._languageNames[9228]=CommonStrings.french_Congo_DRC,e._languageNames[9242]=CommonStrings.serbian_Latin_Serbia,e._languageNames[9275]=CommonStrings.sami_Inari_Finland,e._languageNames[10241]=CommonStrings.arabic_Syria,e._languageNames[10249]=CommonStrings.english_Belize,e._languageNames[10250]=CommonStrings.spanish_Peru,e._languageNames[10252]=CommonStrings.french_Senegal,e._languageNames[10266]=CommonStrings.serbian_Cyrillic_Serbia,e._languageNames[11265]=CommonStrings.arabic_Jordan,e._languageNames[11273]=CommonStrings.english_Trinidad_and_Tobago,e._languageNames[11274]=CommonStrings.spanish_Argentina,e._languageNames[11276]=CommonStrings.french_Cameroon,e._languageNames[11290]=CommonStrings.serbian_Latin_Montenegro,e._languageNames[12289]=CommonStrings.arabic_Lebanon,e._languageNames[12297]=CommonStrings.english_Zimbabwe,e._languageNames[12298]=CommonStrings.spanish_Ecuador,e._languageNames[12300]=CommonStrings.french_Cote_dIvoire,e._languageNames[12314]=CommonStrings.serbian_Cyrillic_Montenegro,e._languageNames[13313]=CommonStrings.arabic_Kuwait,e._languageNames[13321]=CommonStrings.english_Philippines,e._languageNames[13322]=CommonStrings.spanish_Chile,e._languageNames[13324]=CommonStrings.french_Mali,e._languageNames[14337]=CommonStrings.arabic_UAE,e._languageNames[14345]=CommonStrings.english_Indonesia,e._languageNames[14346]=CommonStrings.spanish_Uruguay,e._languageNames[14348]=CommonStrings.french_Morocco,e._languageNames[15361]=CommonStrings.arabic_Bahrain,e._languageNames[15369]=CommonStrings.english_Hong_Kong_SAR,e._languageNames[15370]=CommonStrings.spanish_Paraguay,e._languageNames[15372]=CommonStrings.french_Haiti,e._languageNames[16385]=CommonStrings.arabic_Qatar,e._languageNames[16393]=CommonStrings.english_India,e._languageNames[16394]=CommonStrings.spanish_Bolivia,e._languageNames[17417]=CommonStrings.english_Malaysia,e._languageNames[17418]=CommonStrings.spanish_El_Salvador,e._languageNames[18441]=CommonStrings.english_Singapore,e._languageNames[18442]=CommonStrings.spanish_Honduras,e._languageNames[19466]=CommonStrings.spanish_Nicaragua,e._languageNames[20490]=CommonStrings.spanish_Puerto_Rico,e._languageNames[21514]=CommonStrings.spanish_United_States,e._languageNames[22538]=CommonStrings.spanish_Latin_America,e._languageNames[31748]=CommonStrings.chinese_Traditional,e._languageNames[31770]=CommonStrings.serbian,e._languageNames[1]=CommonStrings.arabic,e._languageNames[2]=CommonStrings.bulgarian,e._languageNames[3]=CommonStrings.catalan,e._languageNames[4]=CommonStrings.chinese_Simplified,e._languageNames[5]=CommonStrings.czech,e._languageNames[6]=CommonStrings.danish,e._languageNames[7]=CommonStrings.german,e._languageNames[8]=CommonStrings.greek,e._languageNames[9]=CommonStrings.english,e._languageNames[10]=CommonStrings.spanish,e._languageNames[11]=CommonStrings.finnish,e._languageNames[12]=CommonStrings.french,e._languageNames[13]=CommonStrings.hebrew,e._languageNames[14]=CommonStrings.hungarian,e._languageNames[15]=CommonStrings.icelandic,e._languageNames[16]=CommonStrings.italian,e._languageNames[17]=CommonStrings.japanese,e._languageNames[18]=CommonStrings.korean,e._languageNames[19]=CommonStrings.dutch,e._languageNames[20]=CommonStrings.norwegian,e._languageNames[21]=CommonStrings.polish,e._languageNames[22]=CommonStrings.portuguese,e._languageNames[24]=CommonStrings.romanian,e._languageNames[25]=CommonStrings.russian,e._languageNames[26]=CommonStrings.croatian,e._languageNames[27]=CommonStrings.slovak,e._languageNames[28]=CommonStrings.albanian,e._languageNames[29]=CommonStrings.swedish,e._languageNames[30]=CommonStrings.thai,e._languageNames[31]=CommonStrings.turkish,e._languageNames[32]=CommonStrings.urdu,e._languageNames[33]=CommonStrings.indonesian,e._languageNames[34]=CommonStrings.ukrainian,e._languageNames[35]=CommonStrings.belarusian,e._languageNames[36]=CommonStrings.slovenian,e._languageNames[37]=CommonStrings.estonian,e._languageNames[38]=CommonStrings.latvian,e._languageNames[39]=CommonStrings.lithuanian,e._languageNames[41]=CommonStrings.persian,e._languageNames[42]=CommonStrings.vietnamese,e._languageNames[43]=CommonStrings.armenian,e._languageNames[44]=CommonStrings.azerbaijani,e._languageNames[45]=CommonStrings.basque,e._languageNames[47]=CommonStrings.macedonian,e._languageNames[48]=CommonStrings.sesotho_sa_Leboa,e._languageNames[49]=CommonStrings.xitsonga,e._languageNames[51]=CommonStrings.venda,e._languageNames[54]=CommonStrings.afrikaans,e._languageNames[55]=CommonStrings.georgian,e._languageNames[56]=CommonStrings.faroese,e._languageNames[57]=CommonStrings.hindi,e._languageNames[60]=CommonStrings.irish,e._languageNames[61]=CommonStrings.yiddish,e._languageNames[62]=CommonStrings.malay,e._languageNames[63]=CommonStrings.kazakh,e._languageNames[64]=CommonStrings.kyrgyz,e._languageNames[65]=CommonStrings.kiswahili,e._languageNames[67]=CommonStrings.uzbek,e._languageNames[68]=CommonStrings.tatar,e._languageNames[70]=CommonStrings.punjabi,e._languageNames[71]=CommonStrings.gujarati,e._languageNames[73]=CommonStrings.tamil,e._languageNames[74]=CommonStrings.telugu,e._languageNames[75]=CommonStrings.kannada,e._languageNames[78]=CommonStrings.marathi,e._languageNames[79]=CommonStrings.sanskrit,e._languageNames[80]=CommonStrings.mongolian,e._languageNames[85]=CommonStrings.burmese,e._languageNames[86]=CommonStrings.galician,e._languageNames[87]=CommonStrings.konkani,e._languageNames[88]=CommonStrings.manipuri,e._languageNames[89]=CommonStrings.sindhi,e._languageNames[90]=CommonStrings.syriac,e._languageNames[92]=CommonStrings.cherokee,e._languageNames[95]=CommonStrings.tamazight,e._languageNames[96]=CommonStrings.kashmiri,e._languageNames[97]=CommonStrings.nepali,e._languageNames[101]=CommonStrings.divehi,e._languageNames[102]=CommonStrings.edo,e._languageNames[103]=CommonStrings.fulfulde,e._languageNames[105]=CommonStrings.ibibio,e._languageNames[113]=CommonStrings.kanuri,e._languageNames[114]=CommonStrings.oromo,e._languageNames[115]=CommonStrings.tigrigna,e._languageNames[116]=CommonStrings.guarani,e._languageNames[117]=CommonStrings.hawaiian,e._languageNames[118]=CommonStrings.latin,e._languageNames[119]=CommonStrings.somali,e._languageNames[121]=CommonStrings.papiamentu,e._languageNames[127]=CommonStrings.invariant_Language),e._languageNames},e.getCultures=function(t){e._allCultures||e.initLanguages();for(var n=[],i=!t||2===t,r=!t||1===t,a=0;a<e._allCultures.length;a++){var o=e._allCultures[a];o.isNeutralCulture?i&&Array.add(n,o):r&&Array.add(n,o)}return n},e.getCultureInfo=function(t){if(e._allCultures||e.initLanguages(),"number"==typeof t){var n=t;return e._lcidMap[n]}return e._localnameMap[t.toUpperCase()]},t=e,i=[{key:"l_DevanagariScriptVowelUnicode",get:function(){return e._devanagariScriptVowelUnicode||(e._devanagariScriptVowelUnicode={},e._devanagariScriptVowelUnicode["%u094B"]=1,e._devanagariScriptVowelUnicode["%u0940"]=2,e._devanagariScriptVowelUnicode["%u0941"]=3,e._devanagariScriptVowelUnicode["%u0942"]=4,e._devanagariScriptVowelUnicode["%u0952"]=5,e._devanagariScriptVowelUnicode["%u0962"]=6,e._devanagariScriptVowelUnicode["%u0943"]=7,e._devanagariScriptVowelUnicode["%u0953"]=8,e._devanagariScriptVowelUnicode["%u0963"]=9,e._devanagariScriptVowelUnicode["%u0945"]=10,e._devanagariScriptVowelUnicode["%u0955"]=11,e._devanagariScriptVowelUnicode["%u0946"]=12,e._devanagariScriptVowelUnicode["%u0956"]=13,e._devanagariScriptVowelUnicode["%u0947"]=14,e._devanagariScriptVowelUnicode["%u0957"]=15,e._devanagariScriptVowelUnicode["%u0948"]=16,e._devanagariScriptVowelUnicode["%u0949"]=17,e._devanagariScriptVowelUnicode["%u093A"]=18,e._devanagariScriptVowelUnicode["%u094A"]=19,e._devanagariScriptVowelUnicode["%u093B"]=20,e._devanagariScriptVowelUnicode["%u094C"]=21,e._devanagariScriptVowelUnicode["%u093C"]=22,e._devanagariScriptVowelUnicode["%u094D"]=23,e._devanagariScriptVowelUnicode["%u093E"]=24,e._devanagariScriptVowelUnicode["%u094E"]=25,e._devanagariScriptVowelUnicode["%u093F"]=26,e._devanagariScriptVowelUnicode["%u094F"]=27,e._devanagariScriptVowelUnicode["%u0971"]=28,e._devanagariScriptVowelUnicode["%u0902"]=29,e._devanagariScriptVowelUnicode["%u0900"]=30,e._devanagariScriptVowelUnicode["%u0901"]=31,e._devanagariScriptVowelUnicode["%u0903"]=32),e._devanagariScriptVowelUnicode}},{key:"invariantCulture",get:function(){return e.getCultureInfo(127)}}],(n=[{key:"LCID",get:function(){return this._lcid}},{key:"languageId",get:function(){return 1023&this._lcid}},{key:"languageName",get:function(){return e.get_languageIdMapping().value[this.languageId.toString()]?e.get_languageIdMapping().value[this.languageId.toString()].toString():this.displayName}},{key:"name",get:function(){return this._name}},{key:"formattingName",get:function(){return e.get_languageIdMapping().value[this.LCID.toString()]?e.get_languageIdMapping().value[this.LCID.toString()].toString():this.displayName}},{key:"displayName",get:function(){return this._displayName||(this._displayName=e.get_l_LanguageNames()[this._lcid]),this._displayName}},{key:"isNeutralCulture",get:function(){return this._neutral}}])&&a(t.prototype,n),i&&a(t,i),e}();o._allCultures=null,o._lcidMap=null,o._localnameMap=null,o._languageNames=null,o._devanagariScriptVowelUnicode=null,o._languageIdMapping=null,Object(i.a)(o,"CultureInfo",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"TouchAndHoldAdapter",(function(){return p}));var i=n(0),r=n(2),a=(n(9),n(54),n(4)),o=n(57),s=n(39),l=n(60),c=n(114),u=n(240);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(){function e(){this._beginTouchAndHoldEvent=null,this._touchAndHoldTask=null,this._touchAndHoldReleasedAtPointerUp=!1,this._touchAndHoldBeforeTouchEndSatisfied=!1,Array.add(e._constructedAdapters,this)}var t,n,i,u=e.prototype;return u.beginTouchAndHold=function(e,t,n){void 0===n&&(n=!1),this._touchAndHoldTask?l.a.instance.resetInterval(this._touchAndHoldTask,o.a.touchAndHoldTimeThreshold):(this._touchAndHoldTask=new s.a(0,1,o.a.touchAndHoldTimeThreshold,Object(r.d)(this,this.onTouchAndHold,"onTouchAndHold"),14),this._touchAndHoldTask.customData=t,l.a.instance.addTask(this._touchAndHoldTask)),this._beginTouchAndHoldEvent=e,this._touchAndHoldReleasedAtPointerUp=n},u.cancelTouchAndHoldIfNecessary=function(e){if(e.eventName===a.EventNames.touchStart||e.eventName===a.EventNames.touchCancel)this.cancelTouchAndHold();else if(e.eventName===a.EventNames.touchEnd)this._touchAndHoldReleasedAtPointerUp&&this.touchAndHoldBeforeTouchEndSatisfied||this.cancelTouchAndHold();else if(e.eventName===a.EventNames.touchMove){if(this._beginTouchAndHoldEvent){var t=Math.abs(e.screenPoint.x-this._beginTouchAndHoldEvent.screenPoint.x),n=Math.abs(e.screenPoint.y-this._beginTouchAndHoldEvent.screenPoint.y),i=t>o.a.touchAndHoldDistanceThreshold,r=n>o.a.touchAndHoldDistanceThreshold;(i||r)&&this.cancelTouchAndHold()}}else 0},u.cancelTouchAndHold=function(){this._touchAndHoldTask&&(l.a.instance.deleteTask(this._touchAndHoldTask),this._touchAndHoldTask=null),this.touchAndHoldBeforeTouchEndSatisfied&&(this._touchAndHoldBeforeTouchEndSatisfied=!1),this.clearTouchAndHoldOnPointerUpState()},u.clearTouchAndHoldOnPointerUpState=function(){this._beginTouchAndHoldEvent=null,this._touchAndHoldReleasedAtPointerUp=!1},u.onTouchAndHold=function(e){if(!this._touchAndHoldReleasedAtPointerUp){var t=e.customData;t(this._beginTouchAndHoldEvent),this._beginTouchAndHoldEvent=null}this._touchAndHoldTask=null,this._touchAndHoldBeforeTouchEndSatisfied=!0},e.getTouchAndHoldAdapter=function(t){var n=c.a(t,e.touchAndHoldAdapterDataName);return n||(n=new e,c.b(t,e.touchAndHoldAdapterDataName,n)),n},e.cancelAnyPendingTouchAndHold=function(){for(var t=0;t<e._constructedAdapters.length;++t)e._constructedAdapters[t].cancelTouchAndHold()},t=e,(n=[{key:"touchAndHoldBeforeTouchEndSatisfied",get:function(){return this._touchAndHoldBeforeTouchEndSatisfied}}])&&d(t.prototype,n),i&&d(t,i),e}();p.touchAndHoldAdapterDataName=u.a._touchAndHoldAdapterCache,p._constructedAdapters=[],Object(i.a)(p,"TouchAndHoldAdapter",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){if(e<=65535)return e.toString();if(e>>>24>=36)return String.fromCharCode.call(null,e>>>24&255,e>>>16&255,e>>>8&255,255&e);var t="abcdefghijklmnopqrstuvwxyz0123456789";return""+t.charAt(e>>>24&63)+t.charAt(e>>>18&63)+t.charAt(e>>>12&63)+t.charAt(e>>>6&63)+t.charAt(63&e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=(n(9),function(e,t){this.handler=e,this.userData=t});Object(i.a)(r,"EventHandlerBinding",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.CommandLocation=0,this.CommandTabName=null,this.InvocationMethod=0};Object(i.a)(r,"CommandSqmInfo",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),r=n(11),a=n(77),o=n(23),s=n(42);var l=function(e){var t,n;function i(t){var n;return void 0===t&&(t=!1),(n=e.call(this)||this)._hasArrow=t,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.buildControlDom=function(e,t){var n=new s.a(t);return n.elmControl=o.Control.createStandardControlDOMElement(e,e.root,t,e.controlProperties,this._hasArrow,Object(r.a)((function(){return n.elmLabel}),(function(e){return n.elmLabel=e})),Object(r.a)((function(){return n.elmImage}),(function(e){return n.elmImage=e})),Object(r.a)((function(){return n.elmDescription}),(function(e){return n.elmDescription=e})),Object(r.a)((function(){return n.elmIconContainer}),(function(e){return n.elmIconContainer=e}))),n},i}(a.a);Object(i.a)(l,"StandardControlDomStrategy",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n(0),r=n(166),a=(n(9),n(167)),o=n(210),s=n(152),l=n(5),c=n(211),u=n(51);function d(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var m=function(e){var t,n;function i(t,n){var i;return(i=e.call(this,t,n)||this)._createdControls={},i.shouldHandleElementResize=!0,i}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,p,m,g=i.prototype;return g.dispose=function(){var t=this._createdControls;for(var n in t){({key:n,value:t[n]}).value.dispose()}this.shouldHandleElementResize=!1,e.prototype.dispose.call(this)},g.setBuilder=function(e){this.builder=e,e.root=this},g.addControl=function(e,t){if(l.c(t))return!1;var n=s.Builder.convertXMLStringToJSON(t);return this.addControlFromDeserializedData(e,n)},g.addControlFromDeserializedData=function(e,t){if(l.c(t))return!1;if(!l.c(this._createdControls[e]))throw Error.create(String.format("Control id {0} already exists in this root.",e));var n=this.builder.buildControl(t,new a.a);return n&&(n.setEnabledAndForceUpdate(!0),this._createdControls[e]=n),!0},g.removeControl=function(e){var t=this._createdControls[e];if(l.c(t))throw Error.create(String.format("Control with id '{0}' not found in root.",e));for(var n=this.getDockIdsForControlId(e),i=0;i<n.length;i++)this.removeChild(n[i]);delete this._createdControls[e],t.dispose()},g.getDOMElementForControlDisplayMode=function(e,t){var n=this._createdControls[e];if(l.c(n))throw Error.create(String.format("Control with id '{0}' not found in root.",e));var r=this.getDockId(e,t),a=this.getChild(r);l.c(a)&&(a=new c.a(this,r),this.addChild(a)),l.c(a.getChild(e))&&a.addChild(n.createComponentForDisplayMode(t));var o=n.getDOMElementForDisplayMode(t,n.displayedComponent);return i.updateControlVisibility(n),o},g.hostControl=function(e,t,n){return this.addControl(e,t)?this.getDOMElementForControlDisplayMode(e,n):null},g.pollForControlState=function(e){var t=this._createdControls[e];l.c(t)||(t.pollForStateAndUpdate(),i.updateControlVisibility(t))},g.getDockId=function(e,t){return String.format("dock_{0}-{1}",e,t)},g.getDockIdsForControlId=function(e){for(var t,n=[],i=d(this.children);!(t=i()).done;){var r=t.value;r.id.startsWith("dock_"+e)&&Array.add(n,r.id)}return n},i.createStandaloneRoot=function(e,t){return new i(e,t)},i.updateControlVisibility=function(e){for(var t,n=d(e.components);!(t=n()).done;){var i=t.value,r=e.visible&&i===e.activeComponentWhenVisible;i.elementInternal.style.display=r?"":"none",i.visibleInDOM=r}},r=i,(p=[{key:"createdControls",get:function(){return this._createdControls}},{key:"rootType",get:function(){return 11}},{key:"supportsInvisibleControls",get:function(){return!0}},{key:"supportsDynamicDisplayMode",get:function(){return!0}},{key:"builder",get:function(){if(!Object(u.a)(i.prototype,this,"builder")){var e=new o.a;Object(u.b)(i.prototype,this,"builder",new s.Builder(e,null,null,null)),Object(u.a)(i.prototype,this,"builder").root=this}return Object(u.a)(i.prototype,this,"builder")},set:function(e){Object(u.b)(i.prototype,this,"builder",e)}},{key:"standaloneRootProperties",get:function(){return this.properties}},{key:"trimmedIds",get:function(){return this.builder.options.trimmedIds}},{key:"cuiControlManager",get:function(){return this}}])&&h(r.prototype,p),m&&h(r,m),i}(r.a);Object(i.a)(m,"StandaloneRoot",r.a,[83,84,19,70])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=function(){function e(e){this._node=null,this._first=e}var t=e.prototype;return t.get_current=function(){if(!this._node)throw Error.argumentOutOfRange();return this._node.data},t.moveNext=function(){return this._node?!!this._node.next&&(this._node=this._node.next,!0):(this._node=this._first,!!this._first)},t.movePrevious=function(){return this._node?!!this._node.previous&&(this._node=this._node.previous,!0):(this._node=this._first,!!this._first)},t.reset=function(){this._node=this._first},e}();Object(i.a)(a,"ListEnumerator",null,[2]);var o=function(e,t,n){this.next=n,this.previous=t,this.data=e};function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(o,"ListNode",null,[]),n.d(t,"a",(function(){return u}));var u=function(){function e(){this._head=null,this._tail=null,this._count=0}var t,n,i,l=e.prototype;return l.add=function(e){this._head?this._tail=this._tail.next=new o(e,this._tail,null):this._head=this._tail=new o(e,null,null),this._count=this.count+1},l.insert=function(e,t){if(e>this.count||0>e)throw Error.argumentOutOfRange("pos");if(e!==this.count){for(var n=this._head;0!=e--;)n=n.next;var i=new o(t,n.previous,n);i.previous?i.previous.next=i:this._head=i,i.next?i.next.previous=i:this._tail=i,this._count=this.count+1}else this.add(t)},l.remove=function(e){for(var t=this._head;t&&t.data!==e;)t=t.next;return!!t&&(t.previous?t.previous.next=t.next:this._head=t.next,t.next?t.next.previous=t.previous:this._tail=t.previous,this._count=this.count-1,!0)},l.clear=function(){var e,t=this._head;for(this._head=null,this._tail=null;t;)e=t.next,t.previous=null,t.next=null,t=e;this._count=0},l.indexOf=function(e){for(var t=this._head,n=0;t&&t.data!==e;)t=t.next,n++;return t?n:-1},l.get_item=function(e){return this.at(e).data},l.getEnumerator=function(){return new a(this._head)},l[Symbol.iterator]=function(){return Object(r.b)(this.getEnumerator())},l.getEnumeratorAtPos=function(e){var t=this.at(e);return new a(t)},l.toArray=function(){for(var e,t=new Array(this.count),n=0,i=s(this);!(e=i()).done;){var r=e.value;t[n]=r,n++}return t},l.at=function(e){for(var t=this._head,n=0;n!==e;){if(!t)throw Error.argumentOutOfRange("pos");t=t.next,n++}return t},t=e,(n=[{key:"count",get:function(){return this._count}}])&&c(t.prototype,n),i&&c(t,i),e}();Object(i.a)(u,"List",null,[1])},function(e,t,n){"use strict";var i=n(0),r=n(11),a=n(2),o=n(169),s=function(){function e(e){this._keyComparer=e}var t=e.prototype;return t.equals=function(e,t){return this._keyComparer.equals(e.get_key(),t.get_key())},t.getHashCode=function(e){return this._keyComparer.getHashCode(e.get_key())},e}();Object(i.a)(s,"KeyValueComparer",null,[22]);var l=n(223),c=n(63);function u(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,"a",(function(){return p}));var p=function(){function e(e){var t=this;this._buckets=null,this._count=0,this.$$ge=this.getEnumerator,this._comparer=e,this._pairComparer=new s(e),o.c(Object(r.a)((function(){return t._buckets}),(function(e){return t._buckets=e})),this._pairComparer,7)}var t=e.prototype;return t.getEnumerator=function(){for(var e,t=new c.a,n=u(this._buckets);!(e=n()).done;)for(var i,r=u(e.value);!(i=r()).done;){var a=i.value;t.add(a)}return t.$$lge()},t[Symbol.iterator]=function(){return Object(a.b)(this.getEnumerator())},t.get_count=function(){return this._count},t.set_count=function(e){return this._count=e,e},t.get_keys=function(){return this.getKeyEnumerator()},t.get_values=function(){return this.getValueEnumerator()},t.getKeyEnumerator=function(){for(var e,t=new c.a,n=u(this._buckets);!(e=n()).done;)for(var i,r=u(e.value);!(i=r()).done;){var a=i.value;t.add(a.get_key())}return t},t.getValueEnumerator=function(){for(var e,t=new c.a,n=u(this._buckets);!(e=n()).done;)for(var i,r=u(e.value);!(i=r()).done;){var a=i.value;t.add(a.get_value())}return t},t.Akvp=function(e){this.insert(e,!0)},t.get_item=function(e){var t;if(!this.tryGetValue(e,Object(r.a)((function(){return t}),(function(e){return t=e})),null))throw Error.create("KeyNotFoundException");return t},t.set_item=function(e,t){return this.insert(new l.a(e,t),!1),t},t.insert=function(e,t){for(var n=this,i=o.b(Object(r.a)((function(){return n._buckets}),(function(e){return n._buckets=e})),e,this._pairComparer,this.get_count()),a=0;a<i.length;a++){var s=i[a];if(this._comparer.equals(s.get_key(),e.get_key())){if(t)throw Error.invalidOperation("DuplicateKeyException");return void(i[a]=e)}}this.set_count(this.get_count()+1),Array.add(i,e)},t.add=function(e,t){this.Akvp(new l.a(e,t))},t.containsKey=function(e){for(var t,n=this._comparer.getHashCode(e),i=u(this._buckets[o.a(this._buckets,n)]);!(t=i()).done;){var r=t.value;if(this._comparer.equals(r.get_key(),e))return!0}return!1},t.remove=function(e){for(var t=this._buckets[o.a(this._buckets,this._comparer.getHashCode(e))],n=0;n<t.length;n++){var i=t[n];if(this._comparer.equals(i.get_key(),e))return Array.removeAt(t,n),this.set_count(this.get_count()-1),!0}return!1},t.tryGetValue=function(e,t,n){void 0===n&&(n=null);for(var i,r=u(this._buckets[o.a(this._buckets,this._comparer.getHashCode(e))]);!(i=r()).done;){var a=i.value;if(this._comparer.equals(a.get_key(),e))return t.val=a.get_value(),!0}return t.val=n,!1},e}();Object(i.a)(p,"Dictionary",null,[55,35])},function(e,t,n){"use strict";var i=n(0),r=function(){this.DivSyndicated=null,this.ImageDownArrow=null,this.ImageDownArrowClass=null,this.ImageDownArrow8by8=null,this.ImageDownArrow8by8Class=null,this.ImageSideArrow=null,this.ImageSideArrowClass=null,this.ImageUpArrow=null,this.ImageUpArrowClass=null,this.ImageUpArrow8by8=null,this.ImageUpArrow8by8Class=null,this.ImageCheckMark=null,this.ImageCheckMarkClass=null,this.ImageUncheckMark=null,this.ImageUncheckMarkClass=null,this.ImageCollapsedArrow=null,this.ImageCollapsedArrowClass=null,this.ImageExpandedArrow=null,this.ImageExpandedArrowClass=null,this.ImageSpinner=null,this.TextDirection=null,this.LabelText=null};Object(i.a)(r,"RootProperties",null,[]),n.d(t,"a",(function(){return a}));var a=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r);Object(i.a)(a,"StandaloneRootProperties",r,[])},function(e,t,n){"use strict";function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var a=function(e){for(var t,n,r=new Array(0),a=i(e);!(n=a()).done;){var o=n.value;r.push(o)}return Error.create("AggregateException: Aggregate exceptions",((t={}).Exceptions=r,t))},o=function(e){for(var t,n,r=new Array(0),a=i(e);!(n=a()).done;){var o=n.value;r.push(o)}return Error.create("AggregateException: Aggregate exceptions",((t={}).Exceptions=r,t))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}var t=e.prototype;return t.handleTrace=function(e){},t.showAssertDialog=function(e){},t.handoffToNewHost=function(e){},t.flushAsynchronous=function(){},t.add_onUlsTrace=function(e){},t.remove_onUlsTrace=function(e){},t.dispose=function(){},e}();Object(i.a)(r,"UlsHostStub",null,[85,4])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(22),a=n(166);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(e){var t,n;function i(t,n,i){var a;return(a=e.call(this,t,n,null,i)||this)._handlingResize=!1,a._clientWidth=r.DomUtils.getViewPortWidth(),a._clientHeight=r.DomUtils.getViewPortHeight(),a.autoScale=!0,a._lastResizeWidthHeight=a.getClientWidthHeightString(),a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,s,l,c=i.prototype;return c.scale=function(){return this.resetCachedClientDimensions(),!0},c.refresh=function(){e.prototype.refresh.call(this),this.scale()},c.getClientWidthHeightString=function(){return this.elementInternal?this.elementInternal.clientWidth.toString()+this.elementInternal.clientHeight.toString():""},c.clientDimensionsChanged=function(){return this._clientWidth!==this.elementInternal.clientWidth||this._clientHeight!==this.elementInternal.clientHeight},c.resetCachedClientDimensions=function(){this._clientWidth=this.elementInternal.clientWidth,this._clientHeight=this.elementInternal.clientHeight},c.onResize=function(){if(this.shouldHandleElementResize){var t=this.getClientWidthHeightString();if(this._lastResizeWidthHeight!==t)if(this._lastResizeWidthHeight=t,!this._handlingResize&&this.autoScale&&this.clientDimensionsChanged())this.resetCachedClientDimensions(),this._handlingResize=!0,e.prototype.onResize.call(this),this.scale()&&this.pollForStateAndUpdate(),this._handlingResize=!1}},a=i,(s=[{key:"lastResizeWidthHeight",get:function(){return this._lastResizeWidthHeight}}])&&o(a.prototype,s),l&&o(a,l),i}(a.a);Object(i.a)(s,"ScalableRoot",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.trimmedIds=null,this.clientID=null};Object(i.a)(r,"BuildOptions",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(0),r=n(2),a=n(65),o=n(64),s=n(51);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(e){var t,n;function i(t,n){return e.call(this,t,n,"","")||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,c,u,d=i.prototype;return d.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.elementInternal),e.prototype.refreshInternal.call(this)},d.ensureCorrectChildType=function(e){if(!Object(r.c)(o.a,e))throw Error.create("Only children of type Control can be added to StandaloneDocks.")},a=i,(c=[{key:"visibleInDOM",get:function(){return!0},set:function(e){Object(s.b)(i.prototype,this,"visibleInDOM",e)}}])&&l(a.prototype,c),u&&l(a,u),i}(a.a);Object(i.a)(c,"StandaloneDock",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.Color="Color",r.IndexColorSelected="ColorSelected",Object(i.a)(r,"ColorPickerCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e,t,n){this.retryCount=0,this.messageId=e,this.payload=t,this.callback=n};Object(i.a)(r,"PostMessageRequest",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(1),o=n(27),s=n(10),l=n(122),c=function(e,t){this.message=e,this.eventArgs=t};Object(i.a)(c,"CrossDocumentEventArgs",null,[]);var u=n(382),d=n(53),p=n(231),h=n(47);function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return g}));var g=function(){function e(t,n,i,r){this._name="",this._ackedMessages={},this._messageListener=null,this._receivingAllowList=[],this._freeReceivingAllowList=[],this._freeSendingAllowList=[],this._originAllowList=[],this._targetWindow=t,this._targetOrigin=n,this._messageCallbacks={},this._eventCallbacks={},this._messageEventHandler=i,e._id++,r&&r(),this._enabled=this.enable()}var t,n,i,g=e.prototype;return g.enable=function(){return p.a()?(this.internalEnableReceiving(),this.createReceivingAllowList(),this.createFreeSendingAllowList(),h.a.sendTraceTag(5018252,2,"Enabled."),!0):(h.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1)},g.isEnabled=function(){return this._enabled},g.internalEnableReceiving=function(){h.a.debugAssertTag(5018253,!!this._messageEventHandler,null),this._messageListener=Object(r.d)(this,this.messageListener,"messageListener"),this._messageEventHandler.attachHandler(this._messageListener,null)},g.disable=function(){this._enabled=!1,this._receivingAllowList=[],this._freeReceivingAllowList=[],this._freeSendingAllowList=[],this._originAllowList=[],this._targetWindow=null,this._targetOrigin="",this._messageEventHandler.detachHandler(this._messageListener),this._messageCallbacks={},this._eventCallbacks={}},g.dispose=function(){this.disable()},g.createReceivingAllowList=function(){},g.createFreeSendingAllowList=function(){},g.isMessageReceivingAllowed=function(e){return!!this._receivingAllowList&&Array.contains(this._receivingAllowList,e)||this.isMessageFreeReceivingAllowed(e)},g.isMessageFreeReceivingAllowed=function(e){return!!this._freeReceivingAllowList&&Array.contains(this._freeReceivingAllowList,e)},g.addAllowedReceivingMessage=function(e){return h.a.debugAssertTag(5018259,!!this._receivingAllowList,null),Array.add(this._receivingAllowList,e),h.a.sendTraceTag(5018260,2,"Allow receiving : {0}",e),!0},g.addAllowedFreeReceivingMessage=function(e){return h.a.debugAssertTag(5018261,!!this._freeReceivingAllowList,null),Array.add(this._freeReceivingAllowList,e),h.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",e),!0},g.isMessageFreeSendingAllowed=function(e){return!!this._freeSendingAllowList&&Array.contains(this._freeSendingAllowList,e)},g.addAllowedFreeSendingMessage=function(e){return h.a.debugAssertTag(5018263,!!this._freeSendingAllowList,null),Array.add(this._freeSendingAllowList,e),h.a.sendTraceTag(5018264,2,"Allow free sending: {0}",e),!0},g.isOriginAllowed=function(e){var t=o.a.getOrigin(e);return!!t&&!!this._originAllowList&&Array.contains(this._originAllowList,t)},g.addAllowedOrigin=function(t){if(h.a.debugAssertTag(5018265,!!this._originAllowList,null),t===e.anyDomain)return h.a.debugAssertTag(5018266,!1,null),!1;var n=o.a.getOrigin(t);return n?(Array.add(this._originAllowList,n),h.a.sendTraceTag(5018268,2,"Add origin:{0}",n),!0):(h.a.sendTraceTag(5018267,4,"Get origin fail:{0}",t),!1)},g.send=function(e,t){void 0===t&&(t=null);var n=this.targetOrigin;if(t){var i=o.a.getOrigin(t);if(!i)return!1;n=i}return this.sendToWindow(e,this.targetWindow,n)},g.sendMessage=function(e,t,n){return void 0===n&&(n=""),n=n&&""!==n?n:l.a.create().toString(),this.send(this.packMessage(e,t,n,a.AFrameworkApplication.userSessionId))},g.postMessage=function(e){var t=l.a.create().toString();if(!a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RetryablePostMessagingIsEnabled")||!e.shouldRetry)return this.send(this.packMessage(e.messageId,e.values,t,e.userSessionId));if(!this._messageCallbacks[e.ackMessageId]){this.addAllowedReceivingMessage(e.ackMessageId);var n=Object(r.d)(this,this.ackMessageHandler,"ackMessageHandler");this.registerCallback(e.ackMessageId,n)}return this._ackedMessages[t]="",this.postMessageInternal(e,t,1)},g.postMessageInternal=function(e,t,n){var i=this;return""!==t&&t in this._ackedMessages&&"ACK_RECEIVED"===this._ackedMessages[t]?(delete this._ackedMessages[t],!0):n>e.maxAttempts?(h.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',e.ackMessageId,t),delete this._ackedMessages[t],!1):(h.a.sendTraceTag(40716251,n>1?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',e.maxAttempts-n,e.messageId,t),n++,window.setTimeout((function(){i.postMessageInternal(e,t,n)}),e.ackTimeoutMs),e.values[d.a.ackExpected]=!0,this.send(this.packMessage(e.messageId,e.values,t,e.userSessionId)))},g.ackMessageHandler=function(e){var t=e.CorrelationId;""!==t&&t in this._ackedMessages&&(h.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this._ackedMessages[t],t),this._ackedMessages[t]="ACK_RECEIVED")},g.packMessage=function(e,t,n,i){var r=new u.a(e);return r.CorrelationId=n,t&&(r.Values=t),r.Values.wdUserSession=i,r},g.sendToWindow=function(t,n,i){var r,a;if(h.a.debugAssertTag(5018269,!!t,null),!this._enabled)return!1;if(h.a.debugAssertTag(5018270,!!n,null),h.a.debugAssertTag(5018271,!!i,null),!n||!i)return h.a.debugAssertTag(5018272,!1,null),!1;if(i===e.anyDomain&&!this.isMessageFreeSendingAllowed(t.MessageId))return h.a.sendTraceTag(5018273,1,"Got unregistered message {0}",((a={}).id=t.MessageId,a)),!1;var o=new Date;t.SendTime=o.getTime();var s="";try{s=Sys.Serialization.JavaScriptSerializer.serialize(t)}catch(e){var l;return h.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",((l={}).Exception=e.message,l)),!1}var c=e.sendMessage(n,s,i),u=((r={}).id=t.MessageId,r.origin=i,r);return h.a.sendTraceTag(5018275,2,"Send {0}. {1}",c?"succeeded":"failed",u),c},g.registerCallback=function(e,t){return h.a.debugAssertTag(5018304,!!t,null),h.a.debugAssertTag(5018305,!!this._messageCallbacks&&!!this._eventCallbacks,null),!!this._enabled&&(this.isMessageReceivingAllowed(e)?(this._messageCallbacks[e]!==t&&(h.a.debugAssertTag(5018307,!this._messageCallbacks[e]&&!this._eventCallbacks[e],null),this._messageCallbacks[e]=t,delete this._eventCallbacks[e]),!0):(h.a.sendTraceTag(5018306,2,"Not allow receiving {0}",((n={}).id=e,n)),!1));var n},g.registerEventCallback=function(e,t){return h.a.debugAssertTag(40420062,!!t,null),h.a.debugAssertTag(40420063,!!this._eventCallbacks&&!!this._messageCallbacks,null),!!this._enabled&&(this.isMessageReceivingAllowed(e)?(this._eventCallbacks[e]!==t&&(h.a.debugAssertTag(40420065,!this._messageCallbacks[e]&&!this._eventCallbacks[e],null),this._eventCallbacks[e]=t,delete this._messageCallbacks[e]),!0):(h.a.sendTraceTag(40420064,2,"Not allow receiving {0}",((n={}).id=e,n)),!1));var n},g.unregisterCallback=function(e){return!!this._enabled&&(this._messageCallbacks[e]&&delete this._messageCallbacks[e],this._eventCallbacks[e]&&delete this._eventCallbacks[e],!0)},g.messageListener=function(e){var t=this.getMessageFromEvent(e);if(!t)return!1;if(this._messageCallbacks[t.MessageId]){var n=this._messageCallbacks[t.MessageId];return this._messageEventHandler.invokeCallback(n,t),!0}if(this._eventCallbacks[t.MessageId]){var i=this._eventCallbacks[t.MessageId],r=new c(t,e);return this._messageEventHandler.invokeEventCallback(i,r),!0}return!1},g.getMessageFromEvent=function(e){var t=new Date;if(this.logReceivedMessage(e),!e.origin||!e.source||void 0===e.data||null===e.data)return h.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;var n=this.jsonStringToMessage(e.data);if(!n)return null;if(!this.isOriginAllowed(e.origin)){var i;if(!this.isMessageFreeReceivingAllowed(n.MessageId))return h.a.sendTraceTag(5018309,1,"{0}",((i={}).id=n.MessageId,i)),null;if(!s.a.isInternetExplorer8&&e.source!==this.targetWindow)return h.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}return h.a.debugAssertTag(5018311,!!n.Values,null),n.Values.m_Source=e.source,n.Values.m_Origin=e.origin,n.Values.m_ReceivedTime=t.getTime(),n},g.jsonStringToMessage=function(t){if(!t)return null;var n=null;try{n=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0)}catch(t){return e._deserFailureLogCount<2&&(h.a.sendTraceTag(5018312,2,"Deser failed"),e._deserFailureLogCount++),null}if(!n)return h.a.debugAssertTag(5018313,!1,null),null;for(var i=0;i<e.crossDocumentMessageRequiredFields.length;i++)if(!n[e.crossDocumentMessageRequiredFields[i]])return"MessageId"!==e.crossDocumentMessageRequiredFields[i]&&h.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",e.crossDocumentMessageRequiredFields[i]),null;if(n.Values)try{n.Values}catch(e){return h.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",e.message),null}else h.a.sendTraceTag(41502556,2,"No values in message");var r,a=n.MessageId;if(!this.isMessageReceivingAllowed(a))return h.a.sendTraceTag(5018315,1,"Ignore recvd {0}",((r={}).id=a,r)),null;var o,s=n.SendTime,l=(new Date).getTime()-s;if(s<0||l<-100)return h.a.sendTraceTag(5018316,2,"{0}",((o={}).t=s,o.delta=l,o.id=a,o)),null;var c;if(l>6e4)return h.a.sendTraceTag(5018317,2,"{0}",((c={}).t=s,c)),null;var d=new u.a;return d.MessageId=n.MessageId,d.SendTime=n.SendTime,d.CorrelationId=n.CorrelationId,n.Values&&(d.Values=n.Values),h.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",d.MessageId,d.SendTime,d.CorrelationId),d},g.logReceivedMessage=function(e){var t;h.a.sendTraceTag(5018318,1,String.format("Received: {0}",((t={}).origin=e.origin,t.data=e.data,t.source=e.source,t)))},e.sendMessage=function(e,t,n){if(!p.a())return h.a.debugAssertTag(5018319,!1,null),!1;try{return e.postMessage(t,n),!0}catch(e){var i;h.a.sendTraceTag(5018320,4,"{0}",((i={}).exception=e.message,i))}return!1},t=e,(n=[{key:"targetOrigin",get:function(){return this._targetOrigin}},{key:"targetWindow",get:function(){return this._targetWindow}}])&&m(t.prototype,n),i&&m(t,i),e}();g.crossDocumentMessageRequiredFields=["MessageId","SendTime"],g.anyDomain="*",g._id=0,g._deserFailureLogCount=0,Object(i.a)(g,"CrossDocumentMessenger",null,[4,61])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.SelectedItemId="SelectedItemId",Object(i.a)(r,"DropDownCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.Text="Text",Object(i.a)(r,"TextBoxCommandProperties",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(11),o=n(264),s=n(1),l=n(339),c=(n(9),n(71)),u=n(4),d=n(20),p=n(28),h=n(69),m=n(7),g=n(22),f=n(16),v=n(21),_=n(190),y=n(263),b=n(279),S=n(5);function C(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var w=function(){function e(){this._steps=[],this._dirty=!0,this._maxGroupSizes={}}var t,n,i,r=e.prototype;return r.setGroupMaxSize=function(e,t){this._maxGroupSizes[e]=t,this._dirty=!0},r.removeGroupMaxSize=function(e){delete this._maxGroupSizes[e],this._dirty=!0},r.getGroupMaxSize=function(e){return this._maxGroupSizes[e]},r.addScalingStep=function(e,t){if(S.c(e))throw Error.create("step must be definined and not null");if(S.c(this._maxGroupSizes[e.groupId]))throw Error.create("You must set the GroupMaxSize of Group: "+e.groupId+" before you add ScalingSteps for it");this.addScalingStepAtIndex(e,t?0:this._steps.length)},r.addScalingStepAtIndex=function(e,t){if(Array.contains(this._steps,e))throw Error.create("This ScalingInfo already contains this ScaleStep");Array.insert(this._steps,t,e),e.setParent(this),this._dirty=!0},r.removeScalingStep=function(e){Array.remove(this._steps,e),e.setParent(null),this._dirty=!0},r.removeScalingStepWithGroupId=function(e){if(!S.c(e))for(var t,n=C(this._steps);!(t=n()).done;){var i=t.value;if(i.groupId===e){this.removeScalingStep(i);break}}},t=e,(n=[{key:"steps",get:function(){return Array.clone(this._steps)}},{key:"stepsInternal",get:function(){return this._steps}},{key:"dirty",get:function(){return this._dirty},set:function(e){this._dirty=e}}])&&I(t.prototype,n),i&&I(t,i),e}();Object(i.a)(w,"Scaling",null,[]);var T=n(6),E=n(8),k=n(3),M=n(51);function P(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function D(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"Tab",(function(){return O}));var O=function(e){var t,n;function i(t,n,i,r,a,o,s,l,c){var u;return(u=e.call(this,t,n,i,r,c)||this)._selected=!1,u._elmTitleA=null,u._elmTitleSpan=null,u._elmATText=null,u._pendingDisplayTabTimeoutId=-1,u._pendingDismissTabTimeoutId=-1,u._titleDOMElement=null,u.lastScaleWidthHeight=null,u.scaledByCookie=!1,u._tabBodyMinWidth=0,u._lastTabDisplayTime=null,u.popupInvocationMethod=0,u._firstControl=null,u._lastControl=null,u._currentScalingIndex=-1,u._scalingInfo=new w,u._contextual=o,u._contextualGroupId=s,u._command=a,u._cssClass=S.c(l)?"":l,o&&(u.visibleInternal=!1),u}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o,C,A,I=i.prototype;return I.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.ensureTitleRefreshed(),this.appendChildrenToElement(this.elementInternal),e.prototype.refreshInternal.call(this)},I.attachTitleEvents=function(){c.a.instance.registerHandler(u.EventNames.doubleClick,this._elmTitleA,Object(r.d)(this,this.onTitleDblClick,"onTitleDblClick")),p.a.instance.registerHandler(u.EventNames.pointerDown,this._elmTitleA,Object(r.d)(this,this.onTitlePointerDown,"onTitlePointerDown")),d.KeyInputManager.instance.registerHandler(u.EventNames.keyUp,this._elmTitleA,Object(r.d)(this,this.onTitleKeyUp,"onTitleKeyUp")),d.KeyInputManager.instance.registerHandler(u.EventNames.keyPress,this._elmTitleA,Object(r.d)(this,this.onTitleKeyPress,"onTitleKeyPress"))},I.ensureDOMElement=function(){S.c(this.elementInternal)&&(e.prototype.ensureDOMElement.call(this),this.elementInternal.setAttribute("role","tabpanel"),m.a.setAriaAttribute(this.elementInternal,"aria-labelledby",this.id+"-title"))},I.addChildAtIndexInternal=function(t,n,i){n||(this._firstControl=null),n!==this.children.count&&-1!==n||(this._lastControl=null),e.prototype.addChildAtIndexInternal.call(this,t,n,i)},I.removeChild=function(t){S.c(this.children.get_item(0))||this.children.get_item(0).id!==t||(this._firstControl=null),S.c(this.children.get_item(this.children.count-1))||this.children.get_item(this.children.count-1).id!==t||(this._lastControl=null),e.prototype.removeChild.call(this,t)},I.removeChildren=function(){this._firstControl=null,this._lastControl=null,e.prototype.removeChildren.call(this)},I.ensureTitleDOMElement=function(){S.c(this.titleDOMElement)&&(this._titleDOMElement=T.a.createElement("li"))},I.ensureHiddenATDOMElement=function(){S.c(this._elmATText)&&(this._elmATText=T.a.createElement("span"))},I.onTitleScale=function(e){S.c(this.titleDOMElement)||(this.titleDOMElement.title=e>=2?this.title:"")},I.onTabAttachedToRibbon=function(){for(var e,t=P(this.children);!(e=t()).done;){e.value.onGroupAttachedToRibbon()}},I.ensureTitleRefreshed=function(){var e=" ";S.c(this._elmTitleA)?(this.ensureTitleDOMElement(),this._elmTitleA=T.a.createElement("a"),T.a.addToTabLoop(this._elmTitleA),this._elmTitleA.className="cui-tt-a",this._elmTitleA.setAttribute("role","tab"),this.titleDOMElement.appendChild(this._elmTitleA),this._elmTitleSpan=T.a.createElement("span"),this._elmTitleSpan.className="cui-tt-span",this._elmTitleA.appendChild(this._elmTitleSpan),this.attachTitleEvents()):(e+=this.titleDOMElement.className.indexOf("cui-ct-first")>-1?"cui-ct-first ":"",e=(e+=this.titleDOMElement.className.indexOf("cui-ct-last")>-1?"cui-ct-last":"").trimEnd()),this.titleDOMElement.className=this.getTitleCSSClassName()+e,this.titleDOMElement.id=this.id+"-title",this.titleDOMElement.setAttribute("role","presentation"),m.a.setAriaAttribute(this._elmTitleA,m.a.ariaSelectedAttribute,this._selected?m.a.ariaTrueValue:m.a.ariaFalseValue),m.a.setAriaAttribute(this._elmTitleA,m.a.ariaExpandedAttribute,this._selected&&this.ribbon.tabShowing?m.a.ariaTrueValue:m.a.ariaFalseValue),this._elmTitleSpan.innerText=this.title,S.b(this.description)||this._elmTitleA.setAttribute("title",this.description),this.ensureKeytip(this.keytipDomContainer,this.keytipDomContainer,_.a.ribbonShortcutId,"")},I.setContextualText=function(e,t,n,i,r){S.c(this._elmATText)&&this.ensureHiddenATDOMElement(),t=this.contextual?String.format(t,n,i,r):String.format(e,i,r),this._elmATText.innerText=t,T.a.ensureCSSClassOnElement(this._elmATText,"cui-hidden"),this._elmTitleA.appendChild(this._elmATText)},I.resetTitleCSSClasses=function(){this.titleDOMElement.className=this.getTitleCSSClassName()},I.rememberActiveTabId=function(){if(!S.c(this.ribbon.ribbonBuilder)&&!S.c(this.ribbon.ribbonBuilder.ribbonBuildOptions)&&!S.b(this.ribbon.ribbonBuilder.ribbonBuildOptions.clientID)){var e=document.getElementById(this.ribbon.ribbonBuilder.ribbonBuildOptions.clientID+"_activeTabId");e&&(e.value=this.id)}},I.setSelectedInternal=function(e,t){e&&this.rememberActiveTabId(),this._selected=e,this.onDirtyingChange(),t&&this.ensureTitleRefreshed()},I.ensureTabInitialized=function(){this.needsDelayIniting&&this.doDelayedInit()},I.ensureCorrectChildType=function(e){if(!Object(r.c)(b.Group,e))throw Error.create("Only children of type Group can be added to Tab Components")},I.scaleMax=function(){this.scaleMaxInternal(),this.onDirtyingChange()},I.scaleMaxInternal=function(){for(var e,t=P(this.children);!(e=t()).done;){var n=e.value,i=this._scalingInfo.getGroupMaxSize(n.id);S.c(i)||n.selectLayout(i)}this._currentScalingIndex=-1},I.scaleIndex=function(e){this.scaleIndexInternal(e),this.onDirtyingChange()},I.scaleIndexInternal=function(e){for(0,this.scaleMaxInternal();e>this.currentScalingIndex&&this.scaleDownInternal(););},I.scaleUpInternal=function(){if(-2===this.currentScalingIndex)return this.scaleMaxInternal(),!0;if(-1===this.currentScalingIndex)return!1;var e=this._scalingInfo.stepsInternal[this.currentScalingIndex];return this.getChild(e.groupId).selectLayout(e.previousLayoutName),this._currentScalingIndex=this.currentScalingIndex-1,!0},I.scaleUp=function(){var e=this.scaleUpInternal();return e&&this.onDirtyingChange(),e},I.scaleDownInternal=function(){if(-2===this.currentScalingIndex)return this.scaleMax(),!0;var e=this._scalingInfo.stepsInternal;if(e.length<=this.currentScalingIndex+1)return!1;this._currentScalingIndex=this.currentScalingIndex+1;var t=e[this.currentScalingIndex],n=this.getChild(t.groupId);return n&&n.selectLayout(t.layoutName),!0},I.scaleDown=function(){var e=this.scaleDownInternal();return e&&this.onDirtyingChange(),e},I.onTitleKeyPress=function(e){return e.innerEvent&&e.innerEvent.preventDefault(),!1},I.onTitleKeyUp=function(e){var t=!1;if(!S.c(e.innerEvent)){var n=e.innerEvent.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||(this.doTitleDefaultAction(1),this.ribbon.minimized||this.setFocusOnFirstControl(),t=!0)}return t},I.onTitlePointerDown=function(e){var t=!1;return 2===e.inputSource&&e.mouseButton||(this.doTitleDefaultAction(e.inputSource),t=!0),t},I.doTitleDefaultAction=function(e){(this.popupInvocationMethod=e,this.cancelPendingDisplayTab(),this.selected)?this.ribbon.tabPoppedUp?(new Date).getTime()-this.lastTabDisplayTime.getTime()>500&&this.delayDismissRibbon(500):this.delayDisplayTab(500):(this.ribbon.minimized&&!this.ribbon.tabPoppedUp&&(2!==e&&3!==e||(this.ribbon.isLowerRibbonTouchMode=3===e)),this.displayTab())},I.onTitleDblClick=function(e){return this.selected&&(this.ribbon.minimized&&!this.ribbon.tabPoppedUp&&(this.ribbon.isLowerRibbonTouchMode=!1),this.cancelPendingDisplayTab(),this.cancelPendingDismissRibbonPopup(),this.ribbon.toggleMinimizedState(2)),!0},I.displayTab=function(){var e;h.a.mark(10334),f.a.measureTimeToNextFrame(this.id,"TabSwitch"),this.cancelPendingDisplayTab();var t=!this.ribbon.minimized&&f.a.isActiveElement(this._elmTitleA);if(this.selected=!0,t&&this.setFocusOnTitle(),this.lastTabDisplayTime=new Date,h.a.mark(10335),k.ULS.sendTraceTag(20459935,340,50,"DisplayTab: {0}",((e={}).Title=this.title,e)),v.a.instance.tryResolve("Common.IRibbonSQMInformation")){var n={};n[l.a.tabId]=this.id,s.AFrameworkApplication.theActionManager.processActionWithData(E.a.reportTabSwitch,2,n)}},I.dismissRibbonPopup=function(){this.cancelPendingDismissRibbonPopup(),this.ribbon.dismissTabPopup()},I.delayDisplayTab=function(e){-1===this._pendingDisplayTabTimeoutId&&(this._pendingDisplayTabTimeoutId=window.setTimeout(Object(r.d)(this,this.displayTab,"displayTab"),e))},I.cancelPendingDisplayTab=function(){var e=this;T.a.cancelPendingTimeout(Object(a.a)((function(){return e._pendingDisplayTabTimeoutId}),(function(t){return e._pendingDisplayTabTimeoutId=t})))},I.delayDismissRibbon=function(e){-1===this._pendingDismissTabTimeoutId&&(this._pendingDismissTabTimeoutId=window.setTimeout(Object(r.d)(this,this.dismissRibbonPopup,"dismissRibbonPopup"),e))},I.cancelPendingDismissRibbonPopup=function(){var e=this;T.a.cancelPendingTimeout(Object(a.a)((function(){return e._pendingDismissTabTimeoutId}),(function(t){return e._pendingDismissTabTimeoutId=t})))},I.moveGroupFocus=function(e,t){var n=f.a.getActiveElement(this.elementInternal.ownerDocument),i=this.children.count,r=0,a=0;if(e)r=-1,a=t?0:i-1;else{for(var o,s=this.findGroupId(n),l=P(this.children);!(o=l()).done;){if(o.value.id===s)break;r++}(a=t?(r+1)%i:r-1)<0&&(a=i+a)}for(a!==r&&3===g.DomUtils.getTag(n)&&f.a.clearSelectionInInput(n);a!==r;){if(this.children.get_item(a).setFocusOnFirstControl())return;t?a=(a+1)%i:a-=1,a<0&&(a=i+a)}},I.findGroupId=function(e){return"LI"===e.nodeName?e.id:this.findGroupId(e.parentNode)},I.setFocusOnFirstControl=function(){for(var e,t=P(this.children);!(e=t()).done;){if(e.value.setFocusOnFirstControl())return!0}return!1},I.setFocusOnTitle=function(){S.c(this._elmTitleA)||this._elmTitleA.focus()},I.getTitleCSSClassName=function(){var e="cui-tt "+this._cssClass;return s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||(e+=" UITextTranformUpperCase"),this._selected&&(e+=" cui-tt-s"),e},I.getBodyCSSClassName=function(){var e=i.tabBodyCssClassName;return this.contextual&&(e+=" cui-tabBody-"+y.a.getColorNameForContextualTabColor(this.ribbon.getContextualGroup(this.contextualGroupId).color)),e},I.getContainerCSSClassName=function(){var e="cui-tabContainer";return this.contextual&&(e+=" cui-tabContainer-"+y.a.getColorNameForContextualTabColor(this.ribbon.getContextualGroup(this.contextualGroupId).color)),e},I.pollForStateAndUpdateInternal=function(){if(S.c(this.command))this.enabled=!0;else{var t=this.ribbon.pollForCommandState(this.command,null,null);this.enabled=(1&t)>0}this.enabled&&(this.lastPollTime=new Date,e.prototype.pollForStateAndUpdateInternal.call(this)),this.ribbon.ensureTabContainerGlobalDisablingRemoved()},I.dispose=function(){S.c(this._elmTitleA)||T.a.unregisterAllHandlers(this._elmTitleA),e.prototype.dispose.call(this),T.a.releaseEventHandlersRecursively(this.titleDOMElement),this._elmATText=null,this._titleDOMElement=null,this._elmTitleA=null,this._elmTitleSpan=null},o=i,(C=[{key:"domElementTagName",get:function(){return"ul"}},{key:"titleDOMElement",get:function(){return this._titleDOMElement}},{key:"keytipDomContainer",get:function(){return this._elmTitleA}},{key:"cssClass",get:function(){return this.getBodyCSSClassName()}},{key:"selected",get:function(){return this._selected},set:function(e){if(!this.visible)throw Error.create(String.format("Tabs must be visible and enabled in order to be selected. Id:{0}. Contextual:{1}. ContextualGroupId:{2}",this.id,this.contextual,this.contextualGroupId));if(!e)throw Error.create("Selected cannot be set to false explicitly.\nSelecting another Tab will do this implicitly.");this.needsDelayIniting?k.ULS.sendTraceTag(5256331,207,50,"Tab not available"):(this.ribbon.makeTabSelectedInternal(this),this.ribbon.refreshInternal(),this.lastScaleWidthHeight!==this.ribbon.lastResizeWidthHeight&&this.ribbon.scale(),this.pollIfRootPolledSinceLastPoll(),this.ribbon.tabPoppedUp&&(1===this.popupInvocationMethod?this.setFocusOnFirstControl():this.ribbon.setFocusOnTabContainer()))}},{key:"scaling",get:function(){return S.c(this._scalingInfo)&&(this._scalingInfo=new w),this._scalingInfo}},{key:"currentScalingIndex",get:function(){return this._currentScalingIndex}},{key:"width",get:function(){var e=0,t=this.elementInternal;return S.c(t)||(e=t.offsetWidth),e}},{key:"contentsCurScaleWidth",get:function(){for(var e=0,t=this.elementInternal.childNodes,n=0;n<t.length;n++)e+=t[n].offsetWidth+.5;return Math.ceil(e)}},{key:"minWidth",get:function(){return this._tabBodyMinWidth},set:function(e){var t=this.elementInternal;S.c(t)||(t.style.minWidth=e+"px",this._tabBodyMinWidth=e)}},{key:"contextual",get:function(){return this._contextual}},{key:"contextualGroupId",get:function(){return this._contextualGroupId}},{key:"lastTabDisplayTime",get:function(){return S.c(this._lastTabDisplayTime)&&(this._lastTabDisplayTime=new Date,this._lastTabDisplayTime.setTime(0)),this._lastTabDisplayTime},set:function(e){this._lastTabDisplayTime=e}},{key:"firstControl",get:function(){if(S.c(this._firstControl))for(var e=this.children.get_item(0),t=e.selectedLayout.children.count,n=0;n<t&&S.c(this._firstControl);){var i=e.selectedLayout.children.get_item(n);if(i.children.count>0){var r=i.children.get_item(0);r.children.count>0&&(this._firstControl=r.children.get_item(0).control)}n++}return this._firstControl}},{key:"lastControl",get:function(){if(S.c(this._lastControl)){var e=this.children.count,t=this.children.get_item(e-1);t.hasElementDialogLauncherComponent&&(this._lastControl=t.elementDialogLauncherComponent.control);for(var n=t.selectedLayout.children,i=n.count-1;i>=0&&S.c(this._lastControl);){var r=n.get_item(i),a=r.children.count;if(a>0){var o=r.children.get_item(a-1),s=o.children.count;s>0&&(this._lastControl=o.children.get_item(s-1).control)}i--}}return this._lastControl}},{key:"visible",get:function(){return Object(M.a)(i.prototype,this,"visible")},set:function(e){if(this.contextual)throw Error.create("Visibility of Contextual Tabs cannot be set explicitly.");Object(M.b)(i.prototype,this,"visible",e)}},{key:"command",get:function(){return this._command}}])&&D(o.prototype,C),A&&D(o,A),i}(o.a);O.tabBodyCssClassName="cui-tabBody",Object(i.a)(O,"Tab",o.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"ContinuableTask$1",(function(){return a}));var i=n(0),r=n(142);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._action$2=null,t._actionWithData$2=null,t._parent=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.execute=function(){return this._action$2?this.set_result(this._action$2(this._parent)):this.set_result(this._actionWithData$2(this._parent,this._data)),!0},i.C=function(e,t){var n=new i;return n._action$2=e,n._parent=t,n},i.CO=function(e,t,n){var r=new i;return r._actionWithData$2=e,r._data=t,r._parent=n,r},i}(r.a);Object(i.a)(a,"ContinuableTask$1",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(0),r=n(49),a=n(1),o=(n(9),n(79)),s=n(158),l=n(16),c=n(3);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(){function e(){this._eventSource=new r.a,e._instance=this,this._hadCookie=this.hasCookie()}var t,n,i,d=e.prototype;return d.add_authenticationLost=function(e){this._eventSource.addHandler("L",e)},d.remove_authenticationLost=function(e){this._eventSource.removeHandler("L",e)},d.add_authenticationRestored=function(e){this._eventSource.addHandler("R",e)},d.remove_authenticationRestored=function(e){this._eventSource.removeHandler("R",e)},d.hasCookie=function(){return!!o.a.get("PPLState")},d.authenticationCheck=function(){var e,t=this.hasCookie();t!==this._hadCookie&&(this._hadCookie?(e="L",c.ULS.sendTraceTag(5822149,200,50,"Authentication: Lost")):(e="R",c.ULS.sendTraceTag(5822150,200,50,"Authentication: Restored")),this._eventSource.raiseEvent(e,Sys.EventArgs.Empty,this),this._hadCookie=t)},e.performSignIn=function(){var e=new s.QueryStringBuilder("Signin.aspx");e.addParam("prompt","1"),a.AFrameworkApplication.addCommonUrlParameters(e),l.a.safelyOpenWindow(e.toString(),"LoginWindow",void 0,void 0,"SignOutResponse.PerfromSignIn")},t=e,i=[{key:"instance",get:function(){return e._instance||(e._instance=new e)}}],(n=[{key:"hasSubscribers",get:function(){return this._eventSource.hasSubscribers}},{key:"isAuthenticated",get:function(){return this.hasCookie()}}])&&u(t.prototype,n),i&&u(t,i),e}();d._instance=null,Object(i.a)(d,"SignOutResponse",null,[36])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(45),a=function(){};a.Value="Value",a.Image16by16Class="Image16by16Class",a.Alt="Alt",a.Visible=r.a.visible,Object(i.a)(a,"LabelCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(92);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).ControlsId=null,t.Title=null,t.TitleId=null,t.Theme=null,t.DisplayMode=null,t.ShowMenuSectionSeparator=!0,t.ShowMenuSectionTitleIcon=!0,t.ShowMenuSectionTitleBackground=!0,t.MenuSectionTitleFocusable=!0,t.Lang=null,t.ControlList=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"MenuSectionProps",r.a,[])},function(e,t,n){"use strict";var i=n(0),r=n(1),a=(n(9),function(){});a.namedObjectNameAttr="n",Object(i.a)(a,"Bundle",null,[]);var o=function(){};o.variationAttr="v",Object(i.a)(o,"ResReader",null,[]);var s=n(158);n.d(t,"a",(function(){return l}));var l=function(){function e(){}return e.urlForNamedObject=function(t){if(!e._isInited)return null;var n=new s.QueryStringBuilder(e._serviceUrl);return n.addParam(a.namedObjectNameAttr,t),n.addParam(o.variationAttr,e._variation),n.addParam(r.AFrameworkApplication.userSessionIdQueryParam,r.AFrameworkApplication.userSessionId),r.AFrameworkApplication.buildVersion&&n.addFullParam(r.AFrameworkApplication.getBrowserBuildRequestQueryParam()),r.AFrameworkApplication.isLoggingHostRequests&&n.addParam(r.AFrameworkApplication.logHostRequestsQueryParam,r.AFrameworkApplication.logHostRequestsQueryValue),n.toString()+"&"+e._baseDocQueryParam+e._extraUrlParams},e.initWithExtraUrlParameters=function(t,n,i,r){e.init(t,n,i),e._extraUrlParams=r},e.init=function(t,n,i){e._isInited=!0,e._serviceUrl=t,e._variation=i,e._baseDocQueryParam=n},e}();l._serviceUrl=null,l._baseDocQueryParam=null,l._variation=null,l._extraUrlParams="",l._isInited=!1,Object(i.a)(l,"NamedObject",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(e,t){this._key=null,this._value=null,this.set_value(t),this.set_key(e)}var t=e.prototype;return t.get_key=function(){return this._key},t.set_key=function(e){return this._key=e,e},t.get_value=function(){return this._value},t.set_value=function(e){return this._value=e,e},e}();Object(i.a)(r,"KeyValuePair",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(21);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(e){this._realCpuMeter=null,this._realCpuMeterGetter=e}var t,n,i,o=e.prototype;return o.profileTopLevelTask=function(e,t,n,i){void 0===i&&(i=null),this.realCpuMeter?this.realCpuMeter.profileTopLevelTask(e,t,n,i):e()},o.profileFunction=function(e,t){this.realCpuMeter?this.realCpuMeter.profileFunction(e,t):e()},o.onTaskAdded=function(e){this.realCpuMeter&&this.realCpuMeter.onTaskAdded(e)},o.onBeforeProcess=function(){this.realCpuMeter&&this.realCpuMeter.onBeforeProcess()},o.onAfterProcess=function(){this.realCpuMeter&&this.realCpuMeter.onAfterProcess()},o.markInterestingEvent=function(e){this.realCpuMeter&&this.realCpuMeter.markInterestingEvent(e)},o.add_onCpuMeterFrameAvailable=function(e){},o.remove_onCpuMeterFrameAvailable=function(e){},o.run=function(){},o.markEventTraceFlag=function(e){this.realCpuMeter&&this.realCpuMeter.markEventTraceFlag(e)},o.clearEventTraceFlag=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=0),this.realCpuMeter&&this.realCpuMeter.clearEventTraceFlag(e,t)},o.addCpuMeterTaskEventWithFilter=function(e,t,n){this.realCpuMeter&&this.realCpuMeter.addCpuMeterTaskEventWithFilter(e,t,n)},e.getInstance=function(){return new e((function(){return r.a.instance.tryResolve("Common.ICpuMeterProvider")}))},t=e,i=[{key:"instance",get:function(){return e._instance||(e._instance=e.getInstance())}}],(n=[{key:"realCpuMeter",get:function(){return!this._realCpuMeter&&this._realCpuMeterGetter()&&(this._realCpuMeter=this._realCpuMeterGetter().tryGetCpuMeter()),this._realCpuMeter}}])&&a(t.prototype,n),i&&a(t,i),e}();o._instance=null,Object(i.a)(o,"CpuMeterProxy",null,[46])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(26);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){this._messageId=null,this._values=null,this._userSessionId=null,this._shouldRetry=!1,this._ackMessageId=null,this._maxAttempts=0,this._ackTimeoutMs=0}var t,n,i;return e.createMessage=function(t,n,i){var r=new e;return r._messageId=t,r._values=n,r._userSessionId=i,r._shouldRetry=!1,r},e.createRetriableMessage=function(t,n,i,a,o,s){void 0===o&&(o=r.a.defaultAckMessage),void 0===s&&(s=1e3);var l=new e;return l._messageId=t,l._values=n,l._userSessionId=i,l._shouldRetry=!0,l._ackMessageId=o,l._maxAttempts=a,l._ackTimeoutMs=s,l},t=e,(n=[{key:"messageId",get:function(){return this._messageId}},{key:"values",get:function(){return this._values}},{key:"userSessionId",get:function(){return this._userSessionId}},{key:"shouldRetry",get:function(){return this._shouldRetry}},{key:"ackMessageId",get:function(){return this._ackMessageId}},{key:"maxAttempts",get:function(){return this._maxAttempts}},{key:"ackTimeoutMs",get:function(){return this._ackTimeoutMs}}])&&a(t.prototype,n),i&&a(t,i),e}();Object(i.a)(o,"PostMessageData",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(0),r=n(262),a=n(334),o=n(1),s=n(7),l=n(27),c=n(3);function u(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(e){var t,n;function i(t,n,r,o){var c;if(void 0===r&&(r=null),void 0===o&&(o=!0),c=e.call(this,t,!0,!(i.useNativeBrowserPrintUx&&o),new a.a(t,n),r)||this,i.useNativeBrowserPrintUx=i.useNativeBrowserPrintUx&&o,i.useNativeBrowserPrintUx){var d=document.createElement("iframe"),p=null,h=c.dialogOuterContainer;if(d.name="pdfObjectFrame",r&&r.get_count()>0){var m=l.a.getParametersFromUrl(t,r),g=l.a.removeParameters(t,r);(p=document.createElement("form")).id="printPreviewPostForm",p.method="POST",p.target=d.name,p.action=g;for(var f,v=u(m);!(f=v()).done;){var _=f.value,y=document.createElement("input");y.type="hidden",y.name=_.get_key(),y.value=_.get_value(),p.appendChild(y)}}else d.src=t;h.appendChild(d),p&&(h.appendChild(p),p.submit()),Sys.UI.DomElement.addCssClass(d,"DirectPrintPdfObjectHidden"),s.a.setAriaAttribute(d,s.a.ariaHiddenAttribute,s.a.ariaTrueValue)}return c}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,d,h,m=i.prototype;return m.logDialogDisplayed=function(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")},m.logDownloadLinkClicked=function(){o.AFrameworkApplication.theWsaClient.incrementDw(9540,1),c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")},m.logDownloadButtonClicked=function(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")},r=i,h=[{key:"useNativeBrowserPrintUx",get:function(){return!!o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")},set:function(e){i._useNativeBrowserPrintUx=e}}],(d=[{key:"iconString",get:function(){return"Print_32x32x32"}},{key:"titleString",get:function(){return i.useNativeBrowserPrintUx?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},{key:"messageString",get:function(){return i.useNativeBrowserPrintUx?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},{key:"additionalTextBodyContent",get:function(){var e=[];return Array.add(e,CommonUIStrings.l_PrintDialogCanCloseDocument),Array.add(e,CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader),i.useNativeBrowserPrintUx?e:null}},{key:"linkString",get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},{key:"linkId",get:function(){return"PrintPDFLink"}},{key:"buttonText",get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},{key:"cssClassName",get:function(){return o.AFrameworkApplication.dialogClearerStringsIsEnabled?"UIFontDialogTextLarge":null}}])&&p(r.prototype,d),h&&p(r,h),i}(r.a);h._useNativeBrowserPrintUx=!1,Object(i.a)(h,"PrintDialogWithLinkToPdf",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(118);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,r,o;function s(){var t;return(t=e.call(this)||this).UpdateHtmlPostToggle=!1,t.AriaLabel=null,t}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,(r=[{key:"ControlType",get:function(){return 2}}])&&a(i.prototype,r),o&&a(i,o),s}(r.a);Object(i.a)(o,"ToggleButtonProps",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"ColorPicker",(function(){return c}));var i=n(0),r=n(23),a=n(7),o=n(384),s=n(6);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i)||this)._colorPickerDom=null,a.addDisplayMode("Menu"),a._colors=r,a._width=parseInt(i.Width),a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var c,u,d,p=i.prototype;return p.createComponentDomForDisplayMode=function(e){var t=s.a.createElement("table");1===this.root.textDirection?t.dir="rtl":t.dir="ltr",t.className="cui-smenu-inner cui-colorpicker-table",t.setAttribute("cellSpacing","0"),t.setAttribute("cellPadding","0"),t.setAttribute("mscui:controltype",this.controlType),t.setAttribute(a.a.ariaRoleAttribute,a.a.ariaGridRole);var n=new o.a(e,t),i=s.a.createElement("tbody");return this.addColorCells(n,i,this._colors),t.appendChild(i),this._colorPickerDom=n,n},p.addColorCells=function(e,t,n){for(var r=null,o=t.ownerDocument,l=n.length/this.width,c=0,u=0,d=s.a.isTrue(this.properties.McuLayout),p=0;p<n.length;p++){u++,p%this.width||(c++,u=1,(r=o.createElement("tr")).setAttribute(a.a.ariaRoleAttribute,a.a.ariaRowRole),r.setAttribute(a.a.ariaLabelAttribute,String.format(CommonUIStrings.l_GalleryRowAccessibleLabelFormat,c)),t.appendChild(r),i.setRowCssClass(r,c,l,d));var h=o.createElement("td");h.className="cui-colorpicker-cell",h.setAttribute("arrayPosition",String.format("{0}",p)),h.setAttribute(a.a.ariaRoleAttribute,a.a.ariaPresentationRole),!d&&this.width<6&&s.a.ensureCSSClassOnElement(h,"cui-colorpicker-cell-large"),1===u&&s.a.ensureCSSClassOnElement(h,"cui-colorpicker-firstcol"),r.appendChild(h);var m=s.a.createNoOpLink(),g=n[p].Title;m.title=g,m.setAttribute(a.a.ariaRoleAttribute,a.a.ariaGridCellRole),m.className="cui-colorpicker-cell-a";var f=o.createElement("canvas");f.className="cui-colorpicker-celldiv";var v=f.getContext("2d");v.fillStyle=n[p].DisplayColor,v.fillRect(0,0,f.width,f.height);var _=o.createElement("div");_.className="cui-colorpicker-cellinternaldiv",h.appendChild(m),m.appendChild(f),f.appendChild(_),h[i.colorInformation]=n[p].Color,Array.add(e.colorCells,h),Array.add(e.aTags,m)}},p.constructClonedControl=function(e,t){return new i(e,this.id,t,this._colors)},i.setRowCssClass=function(e,t,n,i){1===t&&s.a.ensureCSSClassOnElement(e,"cui-colorpicker-firstrow"),i?1===t?s.a.ensureCSSClassOnElement(e,"cui-colorpicker-mcurow"):(s.a.ensureCSSClassOnElement(e,"cui-colorpicker-compactrow"),2===t?s.a.ensureCSSClassOnElement(e,"cui-colorpicker-firstcompactrow"):t===n&&s.a.ensureCSSClassOnElement(e,"cui-colorpicker-lastcompactrow")):s.a.ensureCSSClassOnElement(e,"cui-colorpicker-spacedrow")},c=i,(u=[{key:"width",get:function(){return this._width}},{key:"colorPickerDom",get:function(){return this._colorPickerDom}},{key:"controlType",get:function(){return r.Control.colorPickerControlType}},{key:"properties",get:function(){return this.controlProperties}}])&&l(c.prototype,u),d&&l(c,d),i}(r.Control);c.colorInformation="ColorInformation",Object(i.a)(c,"ColorPicker",r.Control,[87,88])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(134),r=n(252),a=function(){i.a.enqueueResourceWithoutEnabling(r.a.create("dll1",null,(function(){return Promise.all([n.e(2),n.e(1)]).then(n.bind(null,526))})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.name=null,this.samplingPolicy=null,this.dataFields=null};Object(i.a)(r,"TelemetryEvent",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return!!window.self.postMessage}},function(e,t,n){"use strict";var i=n(0),r=n(2);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(e,t,n){this._name=e.toLowerCase(),this._test=t,this._shouldRedirect=n}var t,n,i;return e.prototype.isSupported=function(){return this._test()},t=e,(n=[{key:"name",get:function(){return this._name}},{key:"test",get:function(){return this._test}},{key:"shouldRedirect",get:function(){return this._shouldRedirect}}])&&a(t.prototype,n),i&&a(t,i),e}();Object(i.a)(o,"BrowserFeature",null,[105]);var s=n(43),l=n(58),c=n(3);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return d}));var d=function(){function e(){this._title="Microsoft Office",this._message="The browser you're using isn't supported, so some features may not work as expected. For best results, switch to a supported browser.",this._dialogOk="OK",this._linkText="Learn More",this._dialog=null,this._areBrowserFeaturesSupported=!0,this._browserFeatures=[],Array.add(this._browserFeatures,new o("window.Map",(function(){var e=!0;try{e=void 0!==window.Map;new Map}catch(t){e=!1}return e}),!0)),Array.add(this._browserFeatures,new o("window.Set",(function(){var e=!0;try{e=void 0!==window.Set;new Set}catch(t){e=!1}return e}),!0)),Array.add(this._browserFeatures,new o("window.requestanimationframe",(function(){var e=!0;try{e=void 0!==window.requestAnimationFrame}catch(t){e=!1}return e}),!0)),Array.add(this._browserFeatures,new o("window.Promise",(function(){var e=!0;try{e=void 0!==window.Promise}catch(t){e=!1}return e}),!1)),Array.add(this._browserFeatures,new o("window.performance",(function(){var e=!0;try{e=void 0!==window.performance}catch(t){e=!1}return e}),!1))}var t,n,i,a=e.prototype;return a.runFeatureChecks=function(e){try{if(e&&e.getBooleanAppSetting("BrowserFeatureDetectionIsEnabled")){for(var t=!1,n=0;n<this._browserFeatures.length;n++)this._browserFeatures[n].isSupported()||(t=this._browserFeatures[n].shouldRedirect||t,c.ULS.sendTraceTag(39321882,306,15,"{0} is not supported. Show warning dialog: {1}",this._browserFeatures[n].name,this._browserFeatures[n].shouldRedirect));if(this._areBrowserFeaturesSupported=!t,t&&e.getBooleanAppSetting("BrowserFeatureDetectionWarningIsEnabled")){var i=e.getStringAppSetting("BrowserFeatureDetectionRedirectURL")||"";""!==i&&this.showDialog(i)}}}catch(e){c.ULS.sendTraceTag(39321883,306,15,"RunFeatureChecks caught exception: {0}",e)}},a.showDialog=function(e){this._dialog=new l.StandardDialog;try{this._title=CommonUIStrings.l_DefaultDialogTitle,this._message=CommonUIStrings.l_UnsupportedBrowser,this._dialogOk=CommonUIStrings.l_DialogOk,this._linkText=CommonUIStrings.l_LearnMore}catch(e){c.ULS.sendTraceTag(39321884,306,15,"Failed to get CommonUIStrings. Exception: {0}",e)}this._dialog.buttonsOption=6,this._dialog.setButtonText(0,this._dialogOk),this._dialog.addExtraLink(this._linkText,e),this._dialog.showError(s.a.unsupportedBrowserWarning,this._title,this._message,Object(r.d)(this,this.dialogHandler,"dialogHandler"),!1,!0),c.ULS.sendTraceTag(39683483,306,15,"Show dialog and report UnsupportedBrowserWarning error")},a.dialogHandler=function(e,t){e||this._dialog.dispose()},t=e,i=[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}],(n=[{key:"areBrowserFeaturesSupported",get:function(){return this._areBrowserFeaturesSupported}}])&&u(t.prototype,n),i&&u(t,i),e}();d._instance=null,Object(i.a)(d,"BrowserFeatureManager",null,[90])},function(e,t,n){"use strict";n(9);var i=n(0),r=function(){};r.first=0,r.last=1023,r.max=1024,Object(i.a)(r,"PropertyIndex",null,[]),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var a=function(e,t,n){return t|e<<10|n<<26},o=function(e){return e>>>26&31},s=function(e){return e>>>10&65535}},,function(e,t,n){var i=n(120),r=n(193),a=n(139),o=n(367),s=n(400),l=n(271),c=l.get,u=l.enforce,d=String(String).split("String");(e.exports=function(e,t,n,s){var l=!!s&&!!s.unsafe,c=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||a(n,"name")||r(n,"name",t),u(n).source=d.join("string"==typeof t?t:"")),e!==i?(l?!p&&e[t]&&(c=!0):delete e[t],c?e[t]=n:r(e,t,n)):c?e[t]=n:o(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},function(e,t,n){var i=n(147).f,r=n(139),a=n(121)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,a)&&i(e,a,{configurable:!0,value:t})}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(49),o=n(1),s=n(189);var l=function(e){var t,n;function i(t,n){var i;return(i=e.call(this)||this).oldNetworkState=t,i.newNetworkState=n,i}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Sys.EventArgs);Object(i.a)(l,"AppNetworkConnectivityChangedEventArgs",Sys.EventArgs,[]);var c=n(108),u=n(21),d=n(3);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"SessionStatusManager",(function(){return h}));var h=function(){function e(e,t,n,i){var o=this;this._eventSource=new a.a,this._isLost=!1,this._isKickedOut=!1,this._getAccessToken=e,this._getAccessTokenExpiry=t,this._getAccessTokenExpirationPromptSeconds=n,this.networkState=0;var s=i.getBooleanAppSetting("ListenToBrowserNetworkEventsIsEnabled");this._isNetworkListenerEnabled=i.getBooleanAppSetting("NetworkListenerForTokenRefreshIsEnabled")&&i.getBooleanAppSetting("WOPITokenRefreshIsEnabled"),this._isNetworkListenerEnabled&&s&&u.a.instance.resolveFuture("Common.App.NetworkConnectivity.INetworkConnectivityProvider").execute((function(e){e.add_networkConnectivityChanged(Object(r.d)(o,o.onNetworkConnectionChanged,"onNetworkConnectionChanged"))})),u.a.instance.resolveFuture("Common.App.VisibilityManagement.IVisibilityManager").execute((function(e){e.add_onVisibilityStateChange(Object(r.d)(o,o.handleVisibilityChange,"handleVisibilityChange"))})),this._shouldAttempTokenRefreshOnActiveVisibility=i.getBooleanAppSetting("RaiseTokenRefreshOnActiveIsEnabled"),this._isEmergencyViewModeEnabled=i.getBooleanAppSetting("WordEmergencyViewIsEnabled"),this._isInEmergencyViewMode=!1}var t,n,i,h=e.prototype;return h.handleVisibilityChange=function(e,t){t.report("SessionStatusManager.IsViable",this.isViable),t.report("SessionStatusManager.IsNetworkConnected",this.isNetworkConnected),t.report("SessionStatusManager.IsExpired",this.isExpired),!t.newState&&this.isNetworkConnected&&this._shouldAttempTokenRefreshOnActiveVisibility&&(this.isExpired&&o.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRaiseTokenRefreshOnActiveSettings"),this.raiseTokenRefreshIfNecessary()),this.isViable||o.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordWordEmergencyViewSettings")},h.kickOut=function(){this.isKickedOut||(this._isKickedOut=!0,this._eventSource.raiseEvent(e.kickOutEventKey))},h.add_onKickedOut=function(t){this._eventSource.addHandler(e.kickOutEventKey,t)},h.remove_onKickedOut=function(t){this._eventSource.removeHandler(e.kickOutEventKey,t)},h.add_onSessionExpiringNetworkResumed=function(t){this._eventSource.addHandler(e.sessionExpiringNetworkResumedEventKey,t)},h.remove_onSessionExpiringNetworkResumed=function(t){this._eventSource.removeHandler(e.sessionExpiringNetworkResumedEventKey,t)},h.isTokenRefreshRequired=function(){var e=c.a.instance.isSessionExpired(o.AFrameworkApplication.accessTokenTtl)||c.a.instance.isSessionAboutToExpire(o.AFrameworkApplication.accessTokenTtl,o.AFrameworkApplication.accessTokenExpirationPromptSeconds);return e&&!this.isKickedOut&&!this.isLost},h.raiseTokenRefreshIfNecessary=function(){this.isTokenRefreshRequired()&&this._eventSource.raiseEvent(e.sessionExpiringNetworkResumedEventKey)},h.networkDisconnected=function(){d.ULS.sendTraceTag(592974474,217,15,"Network is currently disconnected. Session Access Token Expired : {0}",c.a.instance.isSessionExpired(o.AFrameworkApplication.accessTokenTtl)),this.changeAppNetworkStatus(3)},h.networkResumed=function(){d.ULS.sendTraceTag(592974473,217,50,"Network is currently reconnected. Session Access Token Expired : {0}",c.a.instance.isSessionExpired(o.AFrameworkApplication.accessTokenTtl)),this.changeAppNetworkStatus(0)},h.add_onAppNetworkChanged=function(t){this._eventSource.addHandler(e.appNetworkChangedEventKey,t)},h.remove_onAppNetworkChanged=function(t){this._eventSource.removeHandler(e.appNetworkChangedEventKey,t)},h.onNetworkConnectionChanged=function(e,t){t.isConnected?t.isConnected&&this.changeAppNetworkStatus(2):this.changeAppNetworkStatus(1)},h.changeAppNetworkStatus=function(t){if(t!==this.networkState){var n=this.networkState;this.networkState=t,o.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordWordEmergencyViewSettings"),2!==t&&t||!this._shouldAttempTokenRefreshOnActiveVisibility||this.raiseTokenRefreshIfNecessary(),this.isViable&&this._eventSource.raiseEvent(e.appNetworkChangedEventKey,new l(n,t))}},t=e,i=[{key:"instance",get:function(){return e._singletonInstance||(e._singletonInstance=new e((function(){return o.AFrameworkApplication.accessToken}),(function(){return o.AFrameworkApplication.accessTokenTtl}),(function(){return o.AFrameworkApplication.accessTokenExpirationPromptSeconds}),o.AFrameworkApplication.appSettingsManager||new s.a({})))}}],(n=[{key:"isExpired",get:function(){return!!c.a.instance.isSessionExpiredDueToScheduledShutdown||this._getAccessTokenExpiry()>0&&(new Date).getTime()>=this._getAccessTokenExpiry()}},{key:"isKickedOut",get:function(){return this._isKickedOut}},{key:"isLost",get:function(){return this._isLost},set:function(e){this._isLost=e}},{key:"isViable",get:function(){return!(this.isLost||this.isKickedOut||this.isExpired)}},{key:"isNetworkConnected",get:function(){return!this._isEmergencyViewModeEnabled||!this.networkState}},{key:"hasEmergencyViewModeBeenDeployed",get:function(){return!!this._isEmergencyViewModeEnabled&&this._isInEmergencyViewMode},set:function(e){this._isInEmergencyViewMode=e}}])&&p(t.prototype,n),i&&p(t,i),e}();h._singletonInstance=null,h.kickOutEventKey="kickedOut",h.sessionExpiringNetworkResumedEventKey="SEP",h.appNetworkChangedEventKey="ANCEK",Object(i.a)(h,"SessionStatusManager",null,[93,94])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(19),o=n(11),s=n(31),l=n(1),c=(n(9),n(54),n(140)),u=n(131),d=n(24),p=n(356),h=n(62),m=n(50),g=n(35),f=n(8),v=n(3);function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var y=function(e){var t,n;function i(t,n){var a;(a=e.call(this,t,n)||this)._businessBar=null,a.theContextMenuInputManager=c.a.instance,l.AFrameworkApplication.nativeSelectionAndContextMenu||a.theContextMenuInputManager.initializeForElement(a.get_element()),a.thePageManager=new p.a,a.thePageManager.registerHandler(1,i.onBeforeAppClose,null),a.thePageManager.registerHandler(0,(function(e){a.notifyResize()}),null),a.theF6Manager=u.F6Manager.instance,h.PageStats.start(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(a));var o=l.AFrameworkApplication.theActionManager;return o.addAction(f.a.F6,g.a.frame,Object(r.d)(a.theF6Manager,a.theF6Manager.handleF6,"handleF6")),o.addAction(f.a.f6shift,g.a.frame,Object(r.d)(a.theF6Manager,a.theF6Manager.handleF6Shift,"handleF6Shift")),o.addAction(f.a.resumeFocusWithDirection,g.a.frame,Object(r.d)(a.theF6Manager,a.theF6Manager.resumeFocusWithDirection,"resumeFocusWithDirection")),a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,o,y,b=i.prototype;return b.set_businessBar=function(e){return this._businessBar=e,e},b.dispose=function(){h.PageStats.stop(),m.a(this._businessBar),this._businessBar=null,m.a(this.thePageManager),this.thePageManager=null,e.prototype.dispose.call(this)},b.signInInternal=function(e){32!==l.AFrameworkApplication.theActionManager.processActionWithData(f.a.signIn,2,e)&&v.ULS.sendTraceTag(4776159,207,15,"SignIn failed")},b.beginModal=function(t){e.prototype.beginModal.call(this,t),t&&d.FocusManager.instance().pushScope(s.AFrame.modalCommandUIFocusId,!1)},b.endModal=function(t){e.prototype.endModal.call(this,t),t&&(l.AFrameworkApplication.isShuttingDown||d.FocusManager.instance().popScope(s.AFrame.modalCommandUIFocusId))},i.onBeforeAppClose=function(e){var t=null;try{t=WacAnimation.Telemetry.GetAnimationSqmStats()}catch(e){0}t&&(l.AFrameworkApplication.theWsaClient.setDw(10486,parseInt(String(Math.round(t[0])))),l.AFrameworkApplication.theWsaClient.setDw(10487,parseInt(String(Math.round(t[1])))),l.AFrameworkApplication.theWsaClient.setDw(10485,parseInt(String(Math.round(t[2])))))},i.includeCloseButton=function(){return!l.AFrameworkApplication.isEmbedded&&(!!l.AFrameworkApplication.closeWindowOnAppClose||!!l.AFrameworkApplication.closeUrl)},a=i,(o=[{key:"businessBar",get:function(){return this._businessBar}},{key:"canUseAppAfterAuthLost",get:function(){return!1}},{key:"uiFontFamily",get:function(){return CommonUIStrings.l_UserInterfaceFontName}},{key:"uiFontFamilySemiLight",get:function(){return CommonUIStrings.l_UserInterfaceSemiLightFontName}},{key:"uiFontFamilyLight",get:function(){return CommonUIStrings.l_UserInterfaceLightFontName}},{key:"uiFontSize",get:function(){return CommonUIStrings.l_UserInterfaceFontSize}},{key:"uiSmallFontSize",get:function(){return CommonUIStrings.l_UserInterfaceSmallFontSize}},{key:"uiFontSizeReactSmall",get:function(){return CommonUIStrings.L_FontSize14}},{key:"uiFontSizeReactLarge",get:function(){return CommonUIStrings.L_FontSize26}},{key:"headerLargeFontSize",get:function(){return CommonUIStrings.l_HeaderLargeFontSize}},{key:"jewelMenuFontSize",get:function(){return CommonUIStrings.l_JewelMenuFontSize}},{key:"jewelSubmenuFontSize",get:function(){return CommonUIStrings.l_JewelSubMenuFontSize}},{key:"jewelSubmenuFileNameFontSize",get:function(){return CommonUIStrings.l_JewelSubmenuFileNameFontSize}},{key:"jewelSubmenuMainTitleFontSize",get:function(){return CommonUIStrings.l_JewelSubMenuMainTitleFontSize}},{key:"dialogTitleFontSize",get:function(){return CommonUIStrings.l_UserInterfaceDialogTitleFontSize}},{key:"dialogButtonFontSize",get:function(){return CommonUIStrings.l_UserInterfaceDialogButtonFontSize}},{key:"dialogTextFontSize",get:function(){return CommonUIStrings.l_UserInterfaceDialogTextFontSize}},{key:"dialogTextLargeFontSize",get:function(){return CommonUIStrings.l_UserInterfaceDialogTextLargeFontSize}},{key:"jewelSubmenuMruButtonTitleFontSize",get:function(){return CommonUIStrings.l_JewelSubmenuMruButtonTitleFontSize}},{key:"jewelSubmenuFooterButtonFontSize",get:function(){return CommonUIStrings.l_JewelSubmenuFooterButtonFontSize}},{key:"uiFontWeightBold",get:function(){return CommonUIStrings.l_UserInterfaceFontWeightBold}},{key:"uiTextTranformUpperCase",get:function(){return CommonUIStrings.l_UserInterfaceUpperCaseTextTransform}},{key:"taskPaneTitleFontSize",get:function(){return CommonUIStrings.l_UserInterfaceTaskPaneTitleFontSize}}])&&_(a.prototype,o),y&&_(a,y),i}(s.AFrame);Object(i.a)(y,"WebAppFrame",s.AFrame,[]);var b=n(358),S=n(151),C=n(107),A=n(136),I=n(29),w=n(22),T=function(e){e.element.style.top=""},E=n(78),k=n(4),M=n(17),P=n(157),F=n(10);function D(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var O,R=function(){function e(e,t,n){this._visible=!1,this._currentHeight=0,this._originalTargetTop=null,this._contextMenuHandler=null,this._target=e,this._targetOffset=t,this._businessBar=n;var i=e.ownerDocument;this._htmlElement=i.createElement("div"),this.htmlElement.className="WACBusinessBar",this._isRegionComposerEnabled=!!l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.isRegionComposerEnabled,this._isRegionComposerEnabled&&!this._businessBar.displayOverTarget&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer"),this.htmlElement.id="WACBusinessBar",F.a.isFirefox&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}var t,n,i,a=e.prototype;return a.set_visible=function(e){if(this._visible!==e)return this._visible=e,e?this.attachToTarget():this.detachFromTarget(),e},a.dispose=function(){this.visible&&this.detachFromTarget(),w.DomUtils.clearElementHtml(this.htmlElement),this._htmlElement=null,this._target=null},a.showEntry=function(e,t){var n=e.htmlElement||e.createElement();t===this.htmlElement.childNodes.length?this.htmlElement.appendChild(n):this.htmlElement.insertBefore(n,this.htmlElement.childNodes[t]),e.resizeToFit(),this._currentHeight+=e.htmlElement.clientHeight,function(e,t,n,i){I.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var r=new A.a(e);r.animateOpacity(0,1),I.WacAirSpace.animate(r,null,null);var a=new C.a(e);a.animateY(e.clientTop-30,e.clientTop),I.WacAirSpace.animate(a,null,i);for(var o=n+1;o<t.length;o++){var s=t[o];I.WacAirSpace.setAnimationClass(s,"Shared_BasicClass");var l=new C.a(s);l.animateY(s.clientTop-e.clientHeight,s.clientTop),I.WacAirSpace.animate(l,null,null)}}(n,this.htmlElement.childNodes,t,Object(r.d)(this,this.onAfterShowEntry,"onAfterShowEntry")),e.showEntryForScreenReader(),this.set_visible(!0)},a.hideEntry=function(e){var t=e.htmlElement;w.DomUtils.isInDocument(t)&&(this._currentHeight-=e.htmlElement.clientHeight,function(e,t,n,i){I.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var r=new S.a(e);r.animateOpacity(1,0),I.WacAirSpace.animate(r,n,i);for(var a=!1,o=0;o<t.length;o++){if(a){var s=t[o];I.WacAirSpace.setAnimationClass(s,"Shared_BasicClass");var l=new C.a(s);l.animateY(s.clientTop,-e.clientHeight),I.WacAirSpace.animate(l,null,T)}a||t[o]!==e||(a=!0)}}(t,t.parentNode.children,null,Object(r.d)(this,this.onAfterHideEntry,"onAfterHideEntry")))},a.onAfterShowEntry=function(e){e.element.style.top="",l.AFrameworkApplication.activeFrame.notifyResize()},a.onAfterHideEntry=function(e){e.element.parentNode.removeChild(e.element),this.htmlElement.hasChildNodes()||this.set_visible(!1),l.AFrameworkApplication.activeFrame.notifyResize()},a.attachToTarget=function(){var e=this;""===this._target.style.top.trim()&&(this._target.style.top=this._target.offsetTop+"px"),this.htmlElement.style.left=this._target.style.left,this.htmlElement.style.top=this._target.style.top,this.htmlElement.style.height="auto",this.htmlElement.style.visibility="visible";var t=Sys.UI.DomElement.getBounds(this.htmlElement);if(this._originalTargetTop=this._target.style.top,this._currentHeight=t.height,this.updateTarget(),l.AFrameworkApplication.activeFrame.add_onResize(Object(r.d)(this,this.onResize,"onResize")),M.a.addHandler(this.htmlElement,k.EventNames.selectStart,M.a.cancelEventHandler),this._contextMenuHandler=Object(r.d)(this,this.contextMenuHandler,"contextMenuHandler"),l.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,this._contextMenuHandler,null),d.FocusManager.usable()){var n=d.FocusManager.instance(),i=n.getScope(P.a.businessBarFocusID);i.parent=s.AFrame.mainAppFocusId;var a=new E.DOMFocusListing((function(){return e.htmlElement}));a.addValidTag(1),a.addValidTag(2),a.addValidTag(8),n.buildRegionWithDelegate((function(){return e.htmlElement}),i,a);var o=n.getRegion(P.a.businessBarFocusID);o.rememberFocusStealers(),o.looped=!0,o.contained=!0;var c=l.AFrameworkApplication.activeFrame.theF6Manager;i.addDispose((function(){c.deactivateFocus(P.a.businessBarFocusID)})),c.addF6KeyBindings(P.a.businessBarFocusID),(a.firstElement||l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactBusinessBarIsEnabled"))&&c.activateFocus(P.a.businessBarFocusID)}},a.detachFromTarget=function(){if(this.shouldUpdateTargetTop()&&(this._target.style.top=this._originalTargetTop),this.htmlElement.style.visibility="hidden",l.AFrameworkApplication.activeFrame){if(d.FocusManager.usable())d.FocusManager.instance().removeScope(P.a.businessBarFocusID);this._contextMenuHandler&&(l.AFrameworkApplication.activeFrame.theContextMenuInputManager.unregisterHandler(this.htmlElement,this._contextMenuHandler),this._contextMenuHandler=null)}M.a.removeHandler(this.htmlElement,k.EventNames.selectStart,M.a.cancelEventHandler)},a.updateTarget=function(){this.shouldUpdateTargetTop()&&this.visible&&function(e,t,n,i){var r=w.DomUtils.parseCssSize(e.style.top);I.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var a=new C.a(e);a.animateY(r,t),I.WacAirSpace.animate(a,n,i)}(this._target,this._currentHeight+this._targetOffset,null,null)},a.shouldUpdateTargetTop=function(){return!this._isRegionComposerEnabled&&!this._businessBar.displayOverTarget},a.onResize=function(){for(var e,t=this._businessBar.entries.length,n=Sys.UI.DomElement.getBounds(this.htmlElement).height,i=0;i<t;++i)(e=this._businessBar.entries[i]).htmlElement&&e.resizeToFit();this._currentHeight=Sys.UI.DomElement.getBounds(this.htmlElement).height,n!==this._currentHeight&&this.updateTarget()},a.contextMenuHandler=function(e){return!0},t=e,(n=[{key:"htmlElement",get:function(){return this._htmlElement}},{key:"visible",get:function(){return this._visible}}])&&D(t.prototype,n),i&&D(t,i),e}();function x(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(R,"BusinessBarDom",null,[212,4]),function(e){e[e.none=0]="none",e[e.corruptPage=1]="corruptPage",e[e.currentPageStatus=2]="currentPageStatus",e[e.documentMarkedAsFinal=3]="documentMarkedAsFinal",e[e.documentSigned=4]="documentSigned",e[e.fileAccess=5]="fileAccess",e[e.kickoutWithDataLoss=6]="kickoutWithDataLoss",e[e.lostSession=7]="lostSession",e[e.malformedHyperlinkUris=8]="malformedHyperlinkUris",e[e.odt=9]="odt",e[e.readonlyRecommended=10]="readonlyRecommended",e[e.saveReplaySuccess=11]="saveReplaySuccess",e[e.saveReplayFailed=12]="saveReplayFailed",e[e.unsupportedObjects=13]="unsupportedObjects",e[e.word11Compat=14]="word11Compat",e[e.unsupportedBrowser=15]="unsupportedBrowser",e[e.applicationNotification=16]="applicationNotification",e[e.skypeDocChatFailed=17]="skypeDocChatFailed",e[e.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo",e[e.sessionExpired=19]="sessionExpired",e[e.irmPolicyDescription=20]="irmPolicyDescription",e[e.policyWarningMessage=21]="policyWarningMessage",e[e.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled",e[e.gdprPrivacyNotice=23]="gdprPrivacyNotice",e[e.datacenterDecommissionWarning=24]="datacenterDecommissionWarning",e[e.graphMergePrompt=25]="graphMergePrompt",e[e.readOnlyDocument=26]="readOnlyDocument",e[e.dictationSilence=27]="dictationSilence",e[e.autoSensitivityLabel=28]="autoSensitivityLabel",e[e.recommendedSensitivityLabel=29]="recommendedSensitivityLabel",e[e.dictationDebugInfo=30]="dictationDebugInfo",e[e.oneNoteCovid19Message=31]="oneNoteCovid19Message",e[e.citationStylePrompt=32]="citationStylePrompt",e[e.oneNoteViewModeMessage=33]="oneNoteViewModeMessage",e[e.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading",e[e.oneNotePagePrintReady=35]="oneNotePagePrintReady",e[e.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled",e[e.testEntry1=37]="testEntry1",e[e.testEntry2=38]="testEntry2",e[e.testEntry3=39]="testEntry3",e[e.testEntry4=40]="testEntry4",e[e.testEntry5=41]="testEntry5",e[e.testEntry6=42]="testEntry6",e[e.testEntry7=43]="testEntry7"}(O||(O={})),Object(i.b)("BusinessBarId",O);var U=function(){function e(e,t,n,i){void 0===t&&(t=0),void 0===n&&(n=null),void 0===i&&(i=null),this._displayOverTarget=!1,this._isReactBusinessBarStoreInitialized=!1,this._priorityMap=null,this._entries=[],this._businessBarDom=i||new R(e,t,this),this.initializePriorityMap(n)}var t,n,i,r=e.prototype;return r.initializePriorityMap=function(e){if(e){this._priorityMap={};for(var t=e.ranking,n=0;n<t.length;n++)this._priorityMap[O[t[n]]]=n}},r.dispose=function(){this._businessBarDom.dispose(),m.b(this._entries),this._entries=null},r.isEntryExistent=function(e){for(var t=0;t<this._entries.length;t++)if(this._entries[t].id===e)return!0;return!1},r.addEntry=function(t,n,i,r,a){void 0===n&&(n=!1),void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=null),t.businessBar=this;var o=this.getIndexForNewEntry(t.id);n&&!this._priorityMap&&(o=0),o<e.maxBarsVisible&&(this._businessBarDom.showEntry(t,o),this._entries.length>=e.maxBarsVisible&&this._businessBarDom.hideEntry(this._entries[e.maxBarsVisible-1]),this._businessBarDom.updateTarget()),Array.insert(this._entries,o,t),v.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",O[t.id],void 0===t.containerID||null===t.containerID?"":t.containerID),t.errorCode&&l.AFrameworkApplication.reportError(t.errorCode,i,r,a)},r.removeEntry=function(t){var n=Array.indexOf(this._entries,t);-1!==n&&n<e.maxBarsVisible&&(this._entries.length>e.maxBarsVisible&&this._businessBarDom.showEntry(this._entries[e.maxBarsVisible],e.maxBarsVisible),this._businessBarDom.hideEntry(t),this._businessBarDom.updateTarget()),Array.remove(this._entries,t),t.businessBar=null,t.dispose()},r.getIndexForNewEntry=function(e){if(!this._priorityMap)return this._entries.length;if(!e)return this._entries.length;var t=this._priorityMap[O[e]];if(null==t)return this._entries.length;for(var n=0;n<this._entries.length;n++)if(t<this._priorityMap[O[this._entries[n].id]])return n;return this._entries.length},t=e,(n=[{key:"htmlElement",get:function(){return this._businessBarDom.htmlElement}},{key:"visible",get:function(){return this._businessBarDom.visible}},{key:"displayOverTarget",get:function(){return this._displayOverTarget},set:function(e){this._displayOverTarget=e}},{key:"isReactBusinessBarStoreInitialized",get:function(){return this._isReactBusinessBarStoreInitialized},set:function(e){this._isReactBusinessBarStoreInitialized=e}},{key:"entries",get:function(){return this._entries},set:function(e){this._entries=e}}])&&x(t.prototype,n),i&&x(t,i),e}();U.maxBarsVisible=2,Object(i.a)(U,"BusinessBar",null,[188,4,189]);var B=n(160),L=n(38),N=n(149),H=n(276),W=n(26),j=function(e,t){var n={};return n[H.a.previousSessionParamName]=l.AFrameworkApplication.userSessionId,n[l.AFrameworkApplication.modeSwitchTimeParamName]=t.toString(),e.sendMessage(W.a.editMode,n)?32:(v.ULS.sendTraceTag(5023452,204,10,"SendForEditModeAction failed"),8)},V=n(61),K=n(256),z=n(104),q=n(390),G=n(25),Q=n(20),Z=n(97),$=n(70),X=n(127),J=n(94),Y=n(32),ee=n(39),te=n(183),ne=n(125),ie=n(55);function re(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ae=function(){function e(e,t){this._imagePath=null,this._imageAltText="",this._toolTip="",this._displayTimeoutSeconds=5,this._image=0,this._imageElement=null,this._messageElement=null,this._htmlElement=null,this._isSticky=t,this._message=e,this.image=1}var t,n,i,r=e.prototype;return r.createElement=function(e){void 0===e&&(e=!0),this._htmlElement=document.createElement("span"),this.htmlElement.className="WACNotificationEntry",this.htmlElement.setAttribute("UNSELECTABLE","on"),this.htmlElement.title=this._toolTip;var t=document.createElement("div");if(t.setAttribute("UNSELECTABLE","on"),t.className="WACNotificationBottomBar",this.htmlElement.appendChild(t),this._image){var n=document.createElement("a");t.appendChild(n);var i=null,r=null;switch(this._image){case 2:i="CancelRequest_16x16x32",r=CommonUIStrings.l_DialogError;break;case 1:i="Risks_16x16x32",r=CommonUIStrings.l_DialogWarning;break;case 3:i="Info_16x16x32",r=CommonUIStrings.l_DialogInfo;break;case 5:i=this._imagePath,r=this._imageAltText;break;default:0}n.appendChild(ie.createClusteredImage(16,16,i,"WACNotificationImage",!0,r))}return this._messageElement=document.createElement("span"),this._messageElement.className="WACNotificationMessage",this._messageElement.setAttribute("UNSELECTABLE","on"),e&&(this._messageElement.innerText=this._message),t.appendChild(this._messageElement),this.htmlElement},r.updateInnerText=function(e){this._messageElement&&e&&this._messageElement.innerText!==e&&(this._messageElement.innerText=e,this._message=e)},r.dispose=function(){this._imagePath=null,this._imageAltText=null,this._message=null,this._imageElement=null,this._messageElement=null,this._htmlElement=null},t=e,(n=[{key:"image",get:function(){return this._image},set:function(e){this._image=e,5!==this._image&&(this.imagePath="")}},{key:"imagePath",get:function(){return this._imagePath},set:function(e){this._imagePath!==e&&(this._imagePath=e,this._imageElement&&(this._imageElement.src=this._imagePath))}},{key:"imageAltText",get:function(){return this._imageAltText},set:function(e){this._imageAltText!==e&&(this._imageAltText=e,this._imageElement&&(this._imageElement.alt=this._imageAltText))}},{key:"toolTip",get:function(){return this._toolTip},set:function(e){this._toolTip!==e&&(this._toolTip=e,this.htmlElement&&(this.htmlElement.title=this._toolTip))}},{key:"displayTimeoutSeconds",get:function(){return this._displayTimeoutSeconds},set:function(e){this._displayTimeoutSeconds=e,this._displayTimeoutSeconds>0&&(this._isSticky=!1)}},{key:"isSticky",get:function(){return this._isSticky}},{key:"message",get:function(){return this._message},set:function(e){this._message!==e&&(this._message=e,this._message&&(this._messageElement.innerText=this._message))}},{key:"htmlElement",get:function(){return this._htmlElement}},{key:"isShowing",get:function(){return!!this.htmlElement&&w.DomUtils.isInDocument(this.htmlElement)}}])&&re(t.prototype,n),i&&re(t,i),e}();Object(i.a)(ae,"NotificationBarEntry",null,[229,4]);var oe=n(7),se=n(114),le=n(21);function ce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ue=function(){function e(e,t){this._visible=!1,this._isRetireTaskRunning=!1,this._updateTargetTaskPending=!1,this._updateTopTask=null,this._resizeHandlerAttached=!1,this._contextMenuHandler=null,this._calloutManager=null,this._enteredCalloutManagerQueue=!1,this._target=t,this._htmlElement=document.createElement("div"),this.htmlElement.className="WACNotificationBar",this._retireNotificationTask=new ee.a(4,2,2500,Object(r.d)(this,this.retireNotification,"retireNotification"),16),this._entriesToAdd=[],e.insertBefore(this.htmlElement,t)}var t,n,i,a=e.prototype;return a.set_isVisible=function(e){if(this._visible!==e)return e?this.attachToTarget():this.detachFromTarget(),this._visible=e,e},a.addEntry=function(e){if(!this.calloutManager)return v.ULS.sendTraceTag(37552159,207,100,"The Notification Bar is displaying entries without using the Callout Manager."),void this.addEntryApproved(e);this.htmlElement.childNodes.length>0?this.addEntryApproved(e):(Array.add(this._entriesToAdd,e),this._enteredCalloutManagerQueue||(this._enteredCalloutManagerQueue=!0,v.ULS.sendTraceTag(37552160,207,50,"The Notification Bar enters the Callout Manager queue."),this.calloutManager.enterCalloutManagerQueue(this,Object(r.d)(this,this.onShowApproved,"onShowApproved"))))},a.onShowApproved=function(){for(var e=0;e<this._entriesToAdd.length;e++)this.addEntryApproved(this._entriesToAdd[e]);Array.clear(this._entriesToAdd)},a.createEntry=function(e,t){return new ae(e,t)},a.addEntryApproved=function(e){var t=e.createElement(!1);t.setAttribute(oe.a.ariaRoleAttribute,oe.a.ariaAlertRole),this.htmlElement.appendChild(t),ne.a(t),this.set_isVisible(!0),e.isSticky||(se.b(t,"expires",(new Date).getTime()+1e3*e.displayTimeoutSeconds),this._isRetireTaskRunning||(l.AFrameworkApplication.theTaskManager.addTask(this._retireNotificationTask),this._isRetireTaskRunning=!0)),e.updateInnerText(e.message)},a.removeEntry=function(e){var t=e.htmlElement;w.DomUtils.isInDocument(t)&&ne.d(t,null,Object(r.d)(this,this.afterRemoveEntry,"afterRemoveEntry"))},a.afterRemoveEntry=function(e){e.element&&e.element.parentNode&&e.element.parentNode.removeChild(e.element),this.onFinishedShowingEntries()},a.retireNotification=function(e){for(var t=this.htmlElement.childNodes,n=!0,i=[],r=(new Date).getTime(),a=0;a<t.length;++a){var o=t[a],s=se.a(o,"expires");s&&(r>s?Array.add(i,o):n=!1)}for(var c=0;c<i.length;++c)this.htmlElement.removeChild(i[c]);n&&(l.AFrameworkApplication.theTaskManager.deleteTask(this._retireNotificationTask),this._isRetireTaskRunning=!1),this.onFinishedShowingEntries()},a.onFinishedShowingEntries=function(){this.calloutManager&&this._enteredCalloutManagerQueue&&!this.htmlElement.childNodes.length&&(v.ULS.sendTraceTag(37552161,207,50,"The Notification Bar exits the Callout Manager queue."),this.calloutManager.exitCalloutManagerQueue(this),this._enteredCalloutManagerQueue=!1)},a.attachToTarget=function(){this.htmlElement.style.visibility="visible",M.a.addHandler(this.htmlElement,k.EventNames.selectStart,M.a.cancelEventHandler),l.AFrameworkApplication.activeFrame.add_onResize(Object(r.d)(this,this.onResize,"onResize")),this._resizeHandlerAttached=!0,this._contextMenuHandler=Object(r.d)(this,this.contextMenuHandler,"contextMenuHandler"),l.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,this._contextMenuHandler,null),this.updateTop(null)},a.detachFromTarget=function(){this.htmlElement.style.visibility="hidden",M.a.removeHandler(this.htmlElement,k.EventNames.selectStart,M.a.cancelEventHandler),this._resizeHandlerAttached&&(l.AFrameworkApplication.activeFrame.remove_onResize(Object(r.d)(this,this.onResize,"onResize")),this._resizeHandlerAttached=!1),this._contextMenuHandler&&(l.AFrameworkApplication.activeFrame.theContextMenuInputManager.unregisterHandler(this.htmlElement,this._contextMenuHandler),this._contextMenuHandler=null)},a.onResize=function(){this._updateTopTask||(this._updateTopTask=new ee.a(4,1,500,Object(r.d)(this,this.updateTop,"updateTop"),17)),this._updateTargetTaskPending&&l.AFrameworkApplication.theTaskManager.deleteTask(this._updateTopTask),l.AFrameworkApplication.theTaskManager.addTask(this._updateTopTask),this._updateTargetTaskPending=!0},a.updateTop=function(e){this.htmlElement.style.top=(this._target?w.DomUtils.parseCssSize(this._target.style.top):0)+2+"px",this._updateTargetTaskPending=!1},a.dispose=function(){this._visible&&this.detachFromTarget(),this._htmlElement=null,this._target=null},a.contextMenuHandler=function(e){return!0},t=e,(n=[{key:"calloutManager",get:function(){return this._calloutManager||(this._calloutManager=le.a.instance.tryResolve("CommonUI.ICalloutManager"))}},{key:"htmlElement",get:function(){return this._htmlElement}},{key:"isVisible",get:function(){return this._visible}}])&&ce(t.prototype,n),i&&ce(t,i),e}();Object(i.a)(ue,"NotificationBar",null,[209,4]);var de=n(86),pe=n(308),he=n(243),me=function(){this.icon=0,this.customIconName=null};Object(i.a)(me,"ToastIconOptions",null,[]);var ge=function(){this.message=null,this.icon=null};function fe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(ge,"ToastParameters",null,[]);var ve=function(){function e(e,t,n,i){this.id=null,this._message=null,this._image=0,this._imagePath=null,this._displayTimeoutSeconds=5,this.isRegistered=!1,this._isShowing=!1,this._htmlElement=null,this.message=e,this._isSticky=t,this.registerEntry=n,this.unregisterEntry=i}var t,n,i,r=e.prototype;return r.createElement=function(e){var t=this;if(void 0===e&&(e=!0),!this.isRegistered){var n=Object.assign(new he.a,{onShow:function(){t._isShowing=!0}});this.isSticky||(n.expirationOptions=Object.assign(new pe.a,{displayTimeoutSeconds:this.displayTimeoutSeconds,onExpire:function(){t._isShowing=!1,t.dispose()}})),de.UISurfaces.getNotificationsAPIAsync().then((function(e){var i=e.toast(Object.assign(new ge,{message:t._message,icon:t.getIconOptions()}));return t.id=e.addNotification(i,n),t.registerEntry(t.id,t),t.isRegistered=!0,null}),(function(e){return v.ULS.sendTraceTag(51451665,383,15,"Attempt to add toast notification failed: {0}",e),null}))}return null},r.updateInnerText=function(e){e!==this._message&&(this._message=e,this.updateEntry())},r.dispose=function(){var e=this;this.isRegistered&&de.UISurfaces.getNotificationsAPIAsync().then((function(t){return e.id&&t.removeNotification(e.id),e.unregisterEntry(e.id),null}))},r.updateEntry=function(){var e=this;de.UISurfaces.getNotificationsAPIAsync().then((function(t){return t.updateNotification(e.id,t.toast(Object.assign(new ge,{message:e._message,icon:e.getIconOptions()}))),null}))},r.getIconOptions=function(){var e;switch(this.image){case 3:e=1;break;case 5:e=5;break;case 2:e=3;break;case 1:e=2;break;case 0:default:return null}var t=Object.assign(new me,{icon:e});if(5===e){if(!this.imagePath)return null;t.customIconName=this.imagePath}return t},t=e,(n=[{key:"message",get:function(){return this._message},set:function(e){this.updateInnerText(e)}},{key:"image",get:function(){return this._image},set:function(e){this._image!==e&&(this._image=e,this.updateEntry())}},{key:"imagePath",get:function(){return this._imagePath},set:function(e){this._imagePath!==e&&(this._imagePath=e,5===this._image&&this.updateEntry())}},{key:"displayTimeoutSeconds",get:function(){return this._displayTimeoutSeconds},set:function(e){this.isRegistered||(this._displayTimeoutSeconds=e,e<=0&&(this._isSticky=!0))}},{key:"isShowing",get:function(){return this._isShowing}},{key:"isSticky",get:function(){return this._isSticky}},{key:"htmlElement",get:function(){return this._htmlElement}}])&&fe(t.prototype,n),i&&fe(t,i),e}();Object(i.a)(ve,"ReactNotificationBarEntry",null,[229,4]);var _e=n(76),ye=n(101);function be(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Se=function(){function e(e,t){this.entryById={};var n=document.createElement("div");n.className="WACNotificationBar",e.insertBefore(n,t),this.initializedNotificationsApi=new ye.a((function(){return de.UISurfaces.getNotificationsAPIAsync().then((function(e){return e.initializeToastNotifications(n),e}),(function(e){return v.ULS.sendTraceTag(51451664,383,15,"Notifications API not available. Cannot initialize toast notifications: {0}",e),null}))}))}var t,n,i,r=e.prototype;return r.addEntry=function(e){this.initializedNotificationsApi.value.then((function(){e.createElement()}))},r.removeEntry=function(e){e.dispose()},r.createEntry=function(e,t){var n=this;return new ve(e,t,(function(e,t){n.entryById[e]=t}),(function(e){delete n.entryById[e]}))},r.dispose=function(){},t=e,(n=[{key:"isVisible",get:function(){return _e.a(this.entryById,(function(e,t){return t.isShowing}))}}])&&be(t.prototype,n),i&&be(t,i),e}();Object(i.a)(Se,"ReactNotificationBar",null,[209,4]);var Ce=function(){function e(){}return e.createInstance=function(t,n,i){return void 0===i&&(i=!1),e._instance=i?new Se(t,n):new ue(t,n),e._instance},e}();Ce._instance=null,Object(i.a)(Ce,"NotificationBarFactory",null,[]);var Ae=n(312),Ie=n(27),we=n(16),Te=n(13),Ee=n(332),ke=n(316),Me=function(){function e(){}var t=e.prototype;return t.makeStopwatch=function(e,t){return new ke.a(e,t)},t.makeAndStartStopwatch=function(e,t){var n=this.makeStopwatch(e,t);return n.start(),n},t.bindStopwatchBuilderFactory=function(e){},e}();Object(i.a)(Me,"DefaultStopwatchBuilder",null,[195]);var Pe=function(){function e(){this._factory=new Me}var t=e.prototype;return t.makeStopwatch=function(e,t){return this._factory.makeStopwatch(e,t)},t.makeAndStartStopwatch=function(e,t){return this._factory.makeAndStartStopwatch(e,t)},t.bindStopwatchBuilderFactory=function(e){this._factory=e()},e}();Object(i.a)(Pe,"StopwatchBuilder",null,[195]);var Fe=n(105);function De(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Oe=function(){function e(t,n,i,r){void 0===r&&(r=!1),this.theAppSettingsManager=t,this._isFullAppSettingsReady=this.theAppSettingsManager.isFullAppSettingsReady,this.officeTrialExperience=le.a.instance.tryResolve("Common.IOfficeTrialExperience"),this.macOfficeOffer=le.a.instance.tryResolve("Common.IMacOfficeOffer"),e._callbackExecuted=!1,this.isPasteOptionsEnable=r,this._actionManager=n,this._focusManager=i}var t,n,i,r=e.prototype;return r.areReady=function(){return this._isFullAppSettingsReady&&!!this.officeTrialExperience&&!!this.macOfficeOffer},r.waitForReady=function(e,t,n){var i=this;void 0===n&&(n=null),this.theAppSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){v.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready"),i._isFullAppSettingsReady=!0,i.executeCallbackWhenReady(e,t)})),le.a.instance.resolveFuture("Common.IOfficeTrialExperience").execute((function(n){v.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready"),i.officeTrialExperience=n,i.executeCallbackWhenReady(e,t)})),le.a.instance.resolveFuture("Common.IMacOfficeOffer").execute((function(n){v.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready"),i.macOfficeOffer=n,i.executeCallbackWhenReady(e,t)}))},r.executeCallbackWhenReady=function(t,n){e._callbackExecuted||(this.areReady()?(v.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),t(this,n),e._callbackExecuted=!0):v.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))},t=e,(n=[{key:"actionManager",get:function(){return this._actionManager}},{key:"focusManager",get:function(){return this._focusManager}}])&&De(t.prototype,n),i&&De(t,i),e}();Oe._callbackExecuted=!1,Object(i.a)(Oe,"RibbonDependencies",null,[54]);var Re=n(112),xe=n(43),Ue=n(239),Be=n(58),Le=function(){function e(){this._progressDialog=null}var t=e.prototype;return t.showInitialScreen=function(e,t){var n=new Be.StandardDialog;n.buttonsOption=3,n.setButtonText(1,CommonUIStrings.l_ConversionButton),n.setButtonText(2,t);var i=String.format("{0} {1}",CommonUIStrings.l_ConversionDialogLine1,CommonUIStrings.l_ConversionDialogLine2);n.messageBox(CommonUIStrings.l_ConversionDialogTitle,i,3,e)},t.showInitialScreenPdf=function(e){var t=new Be.StandardDialog;t.buttonsOption=1,t.setButtonText(1,CommonUIStrings.l_ConversionButton),t.messageBox(CommonUIStrings.l_ConversionDialogTitle,CommonUIStrings.l_ConversionDialogPdf,3,e)},t.showProgressDialog=function(){var e=new Ue.a;this._progressDialog=e.create(),this._progressDialog.buttonsOption=5,this._progressDialog.message=CommonUIStrings.l_ConversionProgressString,this._progressDialog.showProgressDialog(CommonUIStrings.l_ConversionDialogTitle,null,null)},t.dismissWaitUI=function(){this._progressDialog.close(),this._progressDialog=null},t.showErrorUI=function(e,t,n,i,r){if(void 0===r&&(r=!1),1!==l.AFrameworkApplication.activeFrame.state){var a=new Be.StandardDialog,o="";i?(a.buttonsOption=6,a.setButtonText(0,CommonUIStrings.l_DialogClose),o=r?n:CommonUIStrings.l_ErrorDialogMessage):(a.buttonsOption=1,a.setButtonText(1,t),a.setButtonText(0,CommonUIStrings.l_DialogClose),o=String.format("{0} {1}",r?n:CommonUIStrings.l_ConversionErrorMessage1,CommonUIStrings.l_ConversionErrorMessage2)),l.AFrameworkApplication.reportError(xe.a.conversionFailed),a.messageBox(CommonUIStrings.l_ConversionDialogTitle,o,2,i?null:e)}},e}();Object(i.a)(Le,"BinaryConversionUI",null,[]);var Ne=n(124),He=n(53),We=n(428),je=n(36),Ve=n(18),Ke=function(){function e(){this._editUrl=null,this._viewUrl=null;var e=n(14).App;this._binaryConversionUi=new Le,e.instance.isPdfMode?this._binaryConversionUi.showInitialScreenPdf(Object(r.d)(this,this.initialDialogHandler,"initialDialogHandler")):this._binaryConversionUi.showInitialScreen(Object(r.d)(this,this.initialDialogHandler,"initialDialogHandler"),WordViewerIntl.WordViewerStrings.L_OpenInWord)}var t=e.prototype;return t.initialDialogHandler=function(t,i){var a=n(14).App;if(1===t){this._binaryConversionUi.showProgressDialog();var o=n(14).App.webServiceBase+"docdatahandler.ashx?"+n(14).App.instance.theDocument.baseDocQuerySignature+"&type=docx&o15=1";a.instance.isPdfMode?(o+="&PdfMode=1",v.ULS.sendTraceTag(18411874,301,50,"PDF conversion start.")):v.ULS.sendTraceTag(18411875,301,50,"Binary conversion start."),Ne.a.doRequest(o,Object(r.d)(this,this.onRequestComplete,"onRequestComplete"),a.get_activeAppFrame().notificationBar)}else 2===t&&e.openInRichClient()},t.onRequestComplete=function(t,n,i){if(this._binaryConversionUi.dismissWaitUI(),t&&"Success"===n||"ConvertedFileExists"===n){0;var r=i.responseXml.selectSingleNode("/docdata/editUrl"),a=i.responseXml.selectSingleNode("/docdata/viewUrl");if(!r||!a){return this._binaryConversionUi.showErrorUI(e.errorDialogHandler,WordViewerIntl.WordViewerStrings.L_OpenInWord,i.responseData,this.hideOpenButton()),void je.a.propagateError(!1,"BinaryConversionFailed",xe.a.conversionFailed,"Unexpected null edit or view url in response!")}this._editUrl=r.text,this._viewUrl=a.text,"Success"===n?(v.ULS.sendTraceTag(18411904,301,50,"Binary conversion success."),this.showSuccessUI()):(v.ULS.sendTraceTag(18411905,301,50,"Converted file already exists."),this.showConvertedFileExistsUI(),je.a.propagateError(!1,"ConvertedFileExists",xe.a.conversionFileExists,CommonUIStrings.l_ConversionFileExists))}else{var o=String.format("Binary Conversion failed: {0}",n||"No status");v.ULS.sendTraceTag(18990600,301,10,o),this._binaryConversionUi.showErrorUI(e.errorDialogHandler,WordViewerIntl.WordViewerStrings.L_OpenInWord,i.responseData,this.hideOpenButton()),je.a.propagateError(!1,"BinaryConversionFailed",xe.a.conversionFailed,o)}},t.hideOpenButton=function(){return 32!==l.AFrameworkApplication.theActionManager.processAction(Ve.a.openInClient,1)},t.showSuccessUI=function(){if(1!==l.AFrameworkApplication.activeFrame.state){var e=new Be.StandardDialog;e.buttonsOption=4,e.setButtonText(2,WordViewerIntl.WordViewerStrings.L_Edit),e.setButtonText(1,WordViewerIntl.WordViewerStrings.l_View);var t=String.format("{0} {1}",CommonUIStrings.l_ConversionSucceded1,CommonUIStrings.l_ConversionSucceded2);e.messageBox(CommonUIStrings.l_ConversionDialogTitle,t,0,Object(r.d)(this,this.onNavigate,"onNavigate"))}},t.showConvertedFileExistsUI=function(){if(1!==l.AFrameworkApplication.activeFrame.state){var e=new Be.StandardDialog;e.buttonsOption=3,e.setButtonText(1,WordViewerIntl.WordViewerStrings.l_View),e.setButtonText(2,WordViewerIntl.WordViewerStrings.L_Edit),e.setButtonText(0,WordViewerIntl.WordViewerStrings.L_Close),e.showError(xe.a.conversionFileExists,CommonUIStrings.l_ConversionDialogTitle,CommonUIStrings.l_ConversionFileExists,Object(r.d)(this,this.onStandardDialog,"onStandardDialog"))}},t.onStandardDialog=function(e,t){this.onNavigate(e,t)},t.onNavigate=function(e,t){var n=2===e,i=1===e;if(n||i){var r=!1,a=!1,o=!1;l.AFrameworkApplication.appSettingsManager&&(r=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsUIEmbedMode"),a=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"),o=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UiHostSupportsConvertScenarios"));var s=String.format("BinaryConversion. Open converted document in editMode {0} Url {1} IsEnabledForUiHost {2} uiHostSupportsDocRebootFeature {3}\r\n\t\t\t UiHostSupportsConvertScenarios {4}",n,n?this._editUrl:this._viewUrl,r,a,o);if(v.ULS.sendTraceTag(591541397,301,50,s),r&&a&&o){v.ULS.sendTraceTag(591541398,301,50,"BinaryConversion: Sending DocumentRefresh post message.");var c={};c[He.a.rebootMode]="1",c[He.a.documentUrl]=n?this._editUrl:this._viewUrl,c[He.a.mode]=n?"edit":"view",c[He.a.reason]=We.a.convert,l.AFrameworkApplication.get_hostPostmessengerFuture().execute((function(e){e.sendMessage(W.a.documentRefresh,c)}))}else{var u=window.top;n?u.location.href=this._editUrl:i&&(u.location.href=this._viewUrl)}}},e.launch=function(){new e},e.openInRichClient=function(){l.AFrameworkApplication.theActionManager.processAction(Ve.a.openInClient,2)},e.errorDialogHandler=function(t,n){1===t&&e.openInRichClient()},e}();Object(i.a)(Ke,"BinaryConversionManager",null,[]);var ze=n(34),qe=n(396),Ge=n(289),Qe=n(360),Ze=n(349);function $e(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Je(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ye=function(){function e(e,t,n){this._reactCommandDefinitionMapping=le.a.instance.tryResolve("WordViewer.WordViewerReactCommandDefinitionMapping");var i={};for(var a in t){var o={key:a,value:t[a]};this.setReactToolbarControlIds(i,o.key,o.value)}this._reactToolbar=new Qe.a(e,Object.assign(new Ze.a,{trimmedIds:null,whitelistedControlIds:i,updateRibbonControls:Object(r.d)(n.reactRibbonRootPoller,n.reactRibbonRootPoller.pollForStateAndUpdateCommands,"pollForStateAndUpdateCommands"),isViewer:!0,statusBarId:"WordViewerToolbar"}))}var t,n,i,a=e.prototype;return a.setReactToolbarControlIds=function(e,t,n){if(this._reactCommandDefinitionMapping){var i=this._reactCommandDefinitionMapping.getExternalUxIdsByLegacyControlId(t);if(i&&i.get_count()>0)for(var r,a=$e(i);!(r=a()).done;){e[r.value]=n}else e[t]=n}},a.poll=function(){this._reactToolbar&&this._reactToolbar.poll()},t=e,i=[{key:"isReactToolbarEnabled",get:function(){return l.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled}}],(n=null)&&Je(t.prototype,n),i&&Je(t,i),e}();Object(i.a)(Ye,"ReactToolbar",null,[]);var et=function(e){var t=n(14).App.get_activeAppFrame();if(t.businessBar){var i=WordViewerIntl.WordViewerStrings.l_DefaultToViewerDueToCogsTitle,a=WordViewerIntl.WordViewerStrings.l_DefaultToViewerDueToCogsMessage,o=new B.a(i,a,null);o.closeable=!0,o.image=3,o.addButton(WordViewerIntl.WordViewerStrings.l_DefaultToViewerButtonText,Object(r.d)(t,t.navigateToEditor,"navigateToEditor"),WordViewerIntl.WordViewerStrings.l_DefaultToViewerButtonText),t.businessBar.addEntry(o,!0)}};Object(i.a)(et,"ReadOnlyBusinessBar",null,[]);var tt=n(100),nt=function(){function e(){this._accountSwitchingManager=null}var t=e.prototype;return t.tryResolveAccountSwitchingManager=function(){try{this._accountSwitchingManager||(this._accountSwitchingManager=le.a.instance.resolve("Common.App.AccountSwitching.IAccountSwitching"))}catch(e){v.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching: "+e)}},t.getAccountSwitchingConfig=function(){return this.tryResolveAccountSwitchingManager(),this._accountSwitchingManager?this._accountSwitchingManager.getCustomAuthConfig():null},e.isCustomAccountSwitchingConfigEnabled=function(){return l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UiHostSupportsCustomAuthConfig")},e}();Object(i.a)(nt,"ReactSharedHeaderAccountSwitchingUtils",null,[]);var it=function(){this.cultureName=null,this.languageName=null};Object(i.a)(it,"HeaderCultureInfo",null,[]);var rt=n(197),at=n(88),ot=n(150),st=n(46),lt=function(){function e(){this._searchOauthManager=null}var t=e.prototype;return t.tryResolveSearchOAuthManager=function(){try{this._searchOauthManager||(this._searchOauthManager=le.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(e){v.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+e)}},t.getLokiTokenPromise=function(){var e=this;return this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.isConnectedServiceEnabled().then((function(t){return t?e._searchOauthManager.getToken("Search",l.AFrameworkApplication.lokiEndpointForSearch):null})):null},t.getSubstrateTokenPromise=function(){var e=this;return this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.isConnectedServiceEnabled().then((function(t){return t?e._searchOauthManager.getToken("Search",l.AFrameworkApplication.substrateEndpointForSearch):null})):null},t.getLokiTokenPromiseFunc=function(){return Object(r.d)(this,this.getLokiTokenPromise,"getLokiTokenPromise")},t.getSubstrateTokenPromiseFunc=function(){return Object(r.d)(this,this.getSubstrateTokenPromise,"getSubstrateTokenPromise")},t.shouldFetchTokensForSearch=function(){return!!l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.shouldFetchTokensForSearch},t.getTokenRequestDict=function(){var e={};return this.shouldFetchTokensForSearch()&&(e.Loki=this.getLokiTokenPromiseFunc(),e.Substrate=this.getSubstrateTokenPromiseFunc()),e},t.logTellMeResourceLoadEvent=function(e){at.a.sendTellMeActivityEvent(Object.assign(new ot.a,{name:"Events",dataFields:[Object.assign(new st.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new st.a,{name:"Status",bool:e})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")},t.loadTellMeStrings=function(){var e=this;return new Promise((function(t,n){var i=le.a.instance.resolve("Common.IDynamicScriptLoaderProvider").getScriptLoader();i?i.loadScript("tellme-strings").then((function(){e.logTellMeResourceLoadEvent(!0),t(!0)})).catch((function(t){e.logTellMeResourceLoadEvent(!1),n(!1)})):(e.logTellMeResourceLoadEvent(!1),n(!1))}))},e.isSearchEnabled=function(){return!!l.AFrameworkApplication.activeFrame&&(l.AFrameworkApplication.activeFrame.applicationInstance.isTellMeInSharedHeaderEnabled||l.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderSearchUxEnabled)},e.isSearchUxEnabled=function(){return!!l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderSearchUxEnabled},e}();Object(i.a)(lt,"ReactSharedHeaderSearchUtils",null,[]);var ct=function(){this.loadTellMeResources=null,this.userRing=null,this.getTokenRequestDictionary=null};Object(i.a)(ct,"SearchInitializationSettings",null,[]);var ut=n(67),dt=n(40),pt=n(143),ht=function(){this.documentTitle=null,this.saveStatus=null,this.isVersionHistoryEnabled=!1,this.breadcrumbBrandName=null,this.breadcrumbBrandUrl=null,this.breadcrumbFolderName=null,this.breadcrumbFolderUrl=null,this.hideDocumentTitleInput=!1,this.documentExtension=null,this.onGetSuggestedTitle=null,this.onFirstRender=null,this.getCalloutAppProps=null,this.isShared=!1};Object(i.a)(ht,"DocumentTitleAppProps",null,[]);var mt=function(){this.breadcrumbBrandName=null,this.breadcrumbBrandUrl=null,this.breadcrumbFolderName=null,this.breadcrumbFolderUrl=null,this.documentExtension=null,this.hideDocumentTitleInput=!1,this.isVersionHistoryEnabled=!1,this.isMoveEnabled=!1,this.onMove=null};Object(i.a)(mt,"DocumentTitleCalloutAppProps",null,[]);var gt=function(){this.appName=null,this.userDisplayName=null,this.emailAddress=null,this.userID=null,this.culture=null,this.language=null,this.isConsumer=!1,this.showAppLauncher=!1,this.showMeControl=!1,this.assetsContainerOverride=null,this.controls=null,this.documentTitleAppProps=null,this.showChatControl=!1,this.showSearchControl=!1,this.enableSearchControl=!1,this.showGoPremiumControl=!1,this.signInLink=null,this.getTokenRequestDictionary=null,this.onFlexPaneOpen=null,this.onFlexPaneClose=null,this.enableTheming=!1,this.userRing=null,this.testTraffic=!1,this.loadTellMeResources=null,this.onFirstRender=null,this.onFullyLoaded=null,this.onLoadFailed=null,this.enableVanillaSearchBox=!1,this.showWorkflowButton=!1,this.showRibbonToggle=!1,this.showDocumentTitleControl=!1,this.shellAuthProviderConfigPromise=null};Object(i.a)(gt,"HeaderAppProps",null,[]);var ft=function(){this.ribbonToggleId=null,this.workflowButton=null,this.ribbonToggle=null};Object(i.a)(ft,"HeaderControls",null,[]);var vt=function(){this.toggled=!1};Object(i.a)(vt,"RibbonToggleAppProps",null,[]);var _t=function(){this.label=null,this.command=null};Object(i.a)(_t,"WorkflowButtonAppProps",null,[]);var yt=n(79),bt=function(){function e(e){void 0===e&&(e=""),this.workflowButtonAppProps=null,this.documentTitleAppProps=null,this.searchInitializationSettings=null,this._staticContentHostPath=""!==e?e:dt.a.staticContentHost}var t=e.prototype;return t.shouldShowRibbonToggleButtonInHeader=function(){return!0},t.getReactCommand=function(e){var t=le.a.instance.tryResolve("Common.IExternalUICommandDefinitionMapping").getCommandById(e);return t&&t.length>0?t[0].externalUxCommand:(v.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",e)),null)},t.getWorkflowButtonAppProps=function(){if(!this.workflowButtonAppProps){var e=tt.a();if(e){var t=this.getReactCommand(e.command);t&&(this.workflowButtonAppProps=Object.assign(new _t,{command:t,label:e.label}))}}return this.workflowButtonAppProps},t.getControls=function(){var e=tt.f(this.shouldShowRibbonToggleButtonInHeader()),t=null;return e&&(t=Object.assign(new vt,{toggled:tt.c()})),Object.assign(new ft,{ribbonToggleId:e?"ToggleRibbonUXDialog":null,workflowButton:this.getWorkflowButtonAppProps(),ribbonToggle:t})},t.onDocumentTitleFirstRender=function(){ut.a.get_instance().setAppInitializationStatus(17)},t.onMove=function(){var e={};e.MoveButtonClickedTime=new Date,l.AFrameworkApplication.theActionManager.processActionWithData(f.a.moveToFolder,2,e)},t.getDocumentFlyoutProperties=function(){return Object.assign(new mt,{breadcrumbBrandName:l.AFrameworkApplication.docPropertiesProvider.breadcrumbBrandName,breadcrumbBrandUrl:l.AFrameworkApplication.docPropertiesProvider.breadcrumbBrandUrl,breadcrumbFolderName:l.AFrameworkApplication.docPropertiesProvider.breadcrumbFolderName,breadcrumbFolderUrl:l.AFrameworkApplication.docPropertiesProvider.breadcrumbFolderUrl,hideDocumentTitleInput:!l.AFrameworkApplication.isRenameSupported(),isVersionHistoryEnabled:this.shouldShowVersionHistory(),documentExtension:Te.a.getFileExtension(l.AFrameworkApplication.fileName),isMoveEnabled:32===l.AFrameworkApplication.theActionManager.processAction(f.a.moveToFolder,1),onMove:Object(r.d)(this,this.onMove,"onMove")})},t.getDocumentTitleAppProps=function(){if(!this.documentTitleAppProps){var e=l.AFrameworkApplication.docPropertiesProvider.breadcrumbDocName;this.documentTitleAppProps=Object.assign(new ht,{documentTitle:l.AFrameworkApplication.documentIsFolder?e:Te.a.getFileNameWithoutExtension(e),onFirstRender:Object(r.d)(this,this.onDocumentTitleFirstRender,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(r.d)(this,this.getDocumentFlyoutProperties,"getDocumentFlyoutProperties"),isShared:2===l.AFrameworkApplication.docPropertiesProvider.sharingStatus})}return this.documentTitleAppProps},t.shouldShowVersionHistory=function(){return!!l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderVersionHistoryEnabled},t.shouldEnableTheming=function(){return!!l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderThemingEnabled},t.shouldShowChatControl=function(){var e=!tt.b()&&!l.AFrameworkApplication.hideHeader&&(l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SkypeWebControlIsEnabled")||l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TeamsChatIsEnabled"));return v.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",e),e},t.continueShellServiceDataAsync=function(e){appChrome.getHeaderApi().then((function(t){return t.setNavBarData(e.get_result()),null})),v.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")},t.registerCommandHandlers=function(e){var t=this;void 0===e&&(e=!1),appChrome.getHeaderApi().then((function(n){var i=le.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");n.setHeaderCommandHandler("OnFirstRender",(function(e){t.onFirstRender()})),n.setHeaderCommandHandler("OnFullyLoaded",(function(e){t.onFullyLoaded()})),n.setHeaderCommandHandler("OnFlexPaneOpen",(function(e){i.onFlexPaneOpen(e)})),n.setHeaderCommandHandler("OnFlexPaneClose",(function(e){i.onFlexPaneClose(e)})),n.setHeaderCommandHandler("SetCookie",(function(e){var t=e;return yt.a.set(t.cookieName,t.value)})),n.setHeaderCommandHandler("GetCookie",(function(e){return t.getCookie(e)})),n.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(r.d)(t,t.getWorkflowButtonAppProps,"getWorkflowButtonAppProps")),n.setHeaderCommandHandler("QueryRibbonToggleState",(function(){return tt.c()})),e||(n.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(r.d)(t,t.getDocumentTitleAppProps,"getDocumentTitleAppProps")),n.setHeaderCommandHandler("OnDocumentTitleReducerReady",(function(){return t.onDocumentTitleReducersReady(),null}))),lt.isSearchUxEnabled()&&n.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(r.d)(t,t.getSearchInitializationSettings,"getSearchInitializationSettings"))}))},t.onDocumentTitleReducersReady=function(){le.a.instance.resolveFuture("Common.App.SaveStatus.ISaveStatusUIHandler").execute((function(e){e.updateSaveStatusDisplay(!1,l.AFrameworkApplication.theActionManager.mode)}))},t.getCookie=function(e){var t=yt.a.get(e);return null!=t&&t.length>0&&(t=decodeURIComponent(t)),t},t.getSuiteUxShellPath=function(){return pt.a.isEnabled?pt.a.getPath("suiteux-shell",!1):this._staticContentHostPath+l.AFrameworkApplication.scriptFolderPath+"suiteux-shell"},t.onFirstRender=function(){var e=this;le.a.instance.resolveFuture("Common.App.O365Shell.IO365ShellActor").execute((function(t){t.shellServiceDataAsync.CWo(Object(r.d)(e,e.continueShellServiceDataAsync,"continueShellServiceDataAsync"),3)})),ut.a.get_instance().setAppInitializationStatus(15)},t.onFullyLoaded=function(){ut.a.get_instance().setAppInitializationStatus(16)},t.getProps=function(e){void 0===e&&(e=!1);var t=function(e){try{var t=rt.a.getCultureInfo(l.AFrameworkApplication.lcid);if(t)return Object.assign(new it,{cultureName:t.name,languageName:t.languageName})}catch(e){v.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+l.AFrameworkApplication.lcid.toString())}return Object.assign(new it,{cultureName:"en-us",languageName:"en"})}(l.AFrameworkApplication.appSettingsManager),n=le.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager"),i=Object.assign(new gt,{appName:CommonUIStrings.l_AppNameShort,culture:t.cultureName,language:t.languageName,isConsumer:!l.AFrameworkApplication.useO365ShellService,showAppLauncher:tt.g(),showMeControl:tt.e(),assetsContainerOverride:this.getSuiteUxShellPath(),controls:this.getControls(),documentTitleAppProps:e?null:this.getDocumentTitleAppProps(),showDocumentTitleControl:!e,showRibbonToggle:tt.f(this.shouldShowRibbonToggleButtonInHeader()),showWorkflowButton:!!this.getWorkflowButtonAppProps(),showChatControl:this.shouldShowChatControl(),showGoPremiumControl:tt.h(),enableSearchControl:lt.isSearchEnabled(),onFlexPaneOpen:Object(r.d)(n,n.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(r.d)(n,n.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.shouldEnableTheming(),testTraffic:l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(r.d)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(r.d)(this,this.onFullyLoaded,"onFullyLoaded")});if(!l.AFrameworkApplication.userNameUnknown||l.AFrameworkApplication.signoutUrl?(i.userDisplayName=l.AFrameworkApplication.userName,i.emailAddress=l.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName"),i.userID=l.AFrameworkApplication.appSettingsManager.getStringAppSetting("Puid")||""):i.signInLink=l.AFrameworkApplication.signInUrl,lt.isSearchUxEnabled()){var a=this.getSearchInitializationSettings();i.loadTellMeResources=a.loadTellMeResources,i.getTokenRequestDictionary=a.getTokenRequestDictionary,i.enableVanillaSearchBox=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("VanillaSearchUxInHeaderIsEnabled"),i.userRing=a.userRing}if(nt.isCustomAccountSwitchingConfigEnabled()){var o=new nt;i.shellAuthProviderConfigPromise=Object(r.d)(o,o.getAccountSwitchingConfig,"getAccountSwitchingConfig")}return this.registerCommandHandlers(e),i},t.getSearchInitializationSettings=function(){if(!this.searchInitializationSettings){var e=new lt,t=l.AFrameworkApplication.appSettingsManager.getStringAppSetting("Microsoft365Ring");t&&t.length||(t="generalAudience"),this.searchInitializationSettings=Object.assign(new ct,{loadTellMeResources:e.loadTellMeStrings(),getTokenRequestDictionary:Object(r.d)(e,e.getTokenRequestDict,"getTokenRequestDict"),userRing:t})}return this.searchInitializationSettings},t.onBeforeContinue=function(e){void 0===e&&(e=!1),this.onFirstRender(),this.registerCommandHandlers(e)},e}();Object(i.a)(bt,"ReactSharedHeaderPropsHelper",null,[211]);var St,Ct=n(304),At=n(292),It=n(44),wt=n(60),Tt=n(63);function Et(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Mt=function(){function e(){}return e.trimPeripheralControls=function(t){if(t.DocChat=!0,l.AFrameworkApplication.activeFrame.applicationInstance.isCommentsButtonInCollabCornerEnabled||(t.ShowCommentsTopBar=!0),e.hasBeenInitialized){var n=l.AFrameworkApplication.activeFrame.applicationInstance.catchUpFlyoutEnabled;t.CatchUpWithChanges=!n}else l.AFrameworkApplication.activeFrame.applicationInstance.isChangesButtonEnabled&&!l.AFrameworkApplication.activeFrame.applicationInstance.shouldHideChangesButtonInitially||(t.CatchUpWithChanges=!0,e.hasBeenInitialized=!0)},e.trimAllHostControls=function(t){for(var n,i=Et(e._hostControlIdsToTrimByDefault);!(n=i()).done;){t[n.value]=!0}},e.updateTrimmingOfHostProvidedUIControls=function(t,n){var i=l.AFrameworkApplication.hostUIControlSettingName;if(l.AFrameworkApplication.appSettingsManager.containsAppSetting(i)&&l.AFrameworkApplication.appSettingsManager.getStringAppSetting(i)){e.trimAllHostControls(n);for(var r=l.AFrameworkApplication.appSettingsManager.getListAppSetting("HostDefinedUIControls"),a=0;a<r.length;a++)e.updateTrimmingOfHostUIControl(t,n,r[a]);e.trimControlsImplicitlyBasedOnInitialTrimming(n)}},e.updateTrimmingOfHostUIControl=function(e,t,n){if(n.id in e)for(var i,r=Et(e[n.id]);!(i=r()).done;){var a=i.value;1===n.visibility?t[a]=!1:n.visibility||(t[a]=!0)}},e.trimControlsImplicitlyBasedOnInitialTrimming=function(e){e.HostOpenInBrowser&&e.HostOpenInClient&&e.HostDownload?e.HostMoreOptions=!0:e.HostMoreOptions=!1},e}();Mt._hostControlIdsToTrimByDefault=((St=new Tt.a).add("HostOpenInClient"),St.add("HostConversation"),St.add("HostClose"),St.add("HostDownload"),St.add("HostOpenInBrowser"),St.add("HostMoreOptions"),St),Mt.hasBeenInitialized=!1,Object(i.a)(Mt,"CommandTrimmer",null,[]);var Pt=n(350),Ft=n(347),Dt=n(339),Ot=n(28),Rt=function(){function e(e,t){this._elmModalDiv=null,this._registeredHandlers=!1,this._menuStack=0,this._modalContainer=e,this._focusManager=t,this._onMouseWheel=Object(r.d)(this,this.onModalMouseWheel,"onModalMouseWheel")}var t=e.prototype;return t.onMenuOpen=function(){var e=this;this._menuStack>0?this._menuStack++:(this._menuStack++,l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DelayMenuFocusActionsUntilNextFrameIsEnabled")?window.requestAnimationFrame((function(t){window.setTimeout(Object(r.d)(e,e.pushTransientFocusScope,"pushTransientFocusScope"),0)})):this.pushTransientFocusScope(),this.showModal())},t.pushTransientFocusScope=function(){this._focusManager&&this._focusManager.pushScope(s.AFrame.reactTransientUIFocusId,!0)},t.showModal=function(){this._elmModalDiv||(this._elmModalDiv=this.createElement("div"),this._elmModalDiv.setAttribute("id","ReactModalDiv"),this._elmModalDiv.style.position="absolute",this._elmModalDiv.style.top="0px",this._elmModalDiv.style.bottom="0px",this._elmModalDiv.style.left="0px",this._elmModalDiv.style.right="0px",this._elmModalDiv.style.backgroundColor="white",this._elmModalDiv.style.opacity="0.0",this._modalContainer.appendChild(this._elmModalDiv)),this._elmModalDiv.style.display="block",this._elmModalDiv.style.visibility="visible",this._elmModalDiv.style.zIndex=String(1e3),this._registeredHandlers||(window.addEventListener("wheel",this._onMouseWheel,!0),this.isMenuDismissPerfImprovementsEnabled()?Ot.a.instance.registerHandler(k.EventNames.pointerUp,this._elmModalDiv,Object(r.d)(this,this.onModalPointerUp,"onModalPointerUp")):Ot.a.instance.registerHandler(k.EventNames.pointerDown,this._elmModalDiv,Object(r.d)(this,this.onModalPointerDown,"onModalPointerDown")),this._registeredHandlers=!0)},t.onMenuClose=function(){this._menuStack--,this._menuStack>0||(this._menuStack<0?this._menuStack=0:this.hideModalAndPopScopeWrapper())},t.onCloseAllMenus=function(){this._menuStack=0,this.dismissContextMenu(),this.hideModalAndPopScopeWrapper()},t.createElement=function(e){var t=document.createElement(e);return t.setAttribute("unselectable","on"),t},t.hideModalAndPopScope=function(){this._focusManager&&this._focusManager.currentScope&&this._focusManager.currentScope.name===s.AFrame.reactTransientUIFocusId&&!l.AFrameworkApplication.theTaskManager.isYielding&&this._focusManager.popScope(s.AFrame.reactTransientUIFocusId,!1),this._elmModalDiv&&(this._elmModalDiv.style.zIndex=String(-1),this._elmModalDiv.style.visibility="hidden",this._elmModalDiv.style.display="none"),this._registeredHandlers&&(window.removeEventListener("wheel",this._onMouseWheel,!0),this.isMenuDismissPerfImprovementsEnabled()?Ot.a.instance.unregisterHandler(k.EventNames.pointerUp,this._elmModalDiv,Object(r.d)(this,this.onModalPointerUp,"onModalPointerUp")):Ot.a.instance.unregisterHandler(k.EventNames.pointerDown,this._elmModalDiv,Object(r.d)(this,this.onModalPointerDown,"onModalPointerDown")),this._registeredHandlers=!1)},t.hideModalAndPopScopeWrapper=function(){var e=this;this.isMenuDismissPerfImprovementsEnabled()?window.requestAnimationFrame((function(t){window.setTimeout((function(){e.hideModalAndPopScope()}),0)})):this.hideModalAndPopScope()},t.onModalPointerDown=function(e){return this.dismissContextualUI(),this.dismissFileMenu(),this.onCloseAllMenus(),this._focusManager.setScope(s.AFrame.documentFocusID),!0},t.onModalPointerUp=function(e){var t=this;return this.dismissContextualUI(),this.dismissFileMenu(),this.onCloseAllMenus(),window.requestAnimationFrame((function(e){window.setTimeout((function(){t._focusManager.setScope(s.AFrame.documentFocusID)}),0)})),!0},t.onModalMouseWheel=function(e){e.stopPropagation()},t.dismissContextualUI=function(){var e=le.a.instance.tryResolve("Common.IReactContextualUILauncher");e&&e.dismissContextualUI()},t.dismissContextMenu=function(){var e=le.a.instance.tryResolve("Common.IReactContextualUILauncher");e&&e.dismissContextMenu()},t.dismissFileMenu=function(){l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.isReactFileMenuUxEnabled&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))},t.isMenuDismissPerfImprovementsEnabled=function(){return l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactMenuDismissalPerfImprovementIsEnabled")},e}();Object(i.a)(Rt,"ReactModalDiv",null,[]);var xt=function(){};xt.inputMethod="InputMethod",xt.shouldCanvasTakeFocus="ShouldCanvasTakeFocus",xt.uiLocation="UILocation",Object(i.a)(xt,"ReactRibbonConstants",null,[]);var Ut=function(){};Object(i.a)(Ut,"ShyComponentState",null,[]);var Bt=n(249),Lt=n(212),Nt=n(95),Ht=function(){};Ht.SelectedFont="SelectedFont",Ht.RequestUpdateMru="RequestUpdateMru",Ht.IsPinned="IsPinned",Ht.Trigger="Trigger",Object(i.a)(Ht,"FontPickerCommandProperties",null,[]);var Wt=n(265),jt=n(128),Vt=n(81),Kt=n(72),zt=n(5);function qt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Gt=function(){function e(e,t,n,i,r,o,s,l,c,u,d){void 0===u&&(u=null),void 0===d&&(d=null),this._modalDiv=null,this._ribbonRoot=e,this._reactRibbonRootPoller=t,this._rootCommandHandler=Object(a.a)(214,e),this._externalUICommandDefinitionMapping=n,this._focusManager=i,r&&(this._modalDiv=new Rt(r,i)),this._ribbonSQMInformation=o,this._fileMenuSQMInformation=s,this._systemInitiatedFeedback=u,this._actionManager=l,this._lastPollTimes={},this._appSettingsManager=c,this._PRICommandHandler=d}var t,n,i,o=e.prototype;return o.executeCommand=function(e,t){if((!wt.a.instance.isYielding||(v.ULS.sendTraceTag(38293640,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",e,t.modelType,_e.i(t.payload)),!this._appSettingsManager.getBooleanAppSetting("WordEditorReactExecuteYieldReturnIsEnabled")))&&t){var n=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e),i=t.modelType;this._PRICommandHandler&&this._PRICommandHandler.logCommandExecuted(e,t),n?this.executeCommandWithCommandMetadata(e,n,i,t):this.executeCommandWithNoCommandMetadata(e,i,t),this.manageAppFocus(e,t)}},o.executeCommandWithNoCommandMetadata=function(e,t,n){switch(t){case"GalleryModel":case"PreviewGalleryModel":this.executeGalleryButtonCommand(n,e);break;default:return void 0}},o.updateParametersForButton=function(e,t,n,i,r){var a=r;if(n.payload)switch(n.payload.type){case"CoauthorMenuPayload":e.MenuItemId=n.payload.coauthorId;break;case"ButtonPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,this.closeAllMenus();break;case"ButtonPreviewPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,a=t.commandPreviewId;break;case"ButtonRevertPreviewPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,a=t.commandRevertId;break;default:e.MenuItemId=t.menuItemId}else e.MenuItemId=t.menuItemId;return e.SourceControlId=i,a},o.updateParametersForTellMe=function(e,t,n){if(t.payload)switch(t.payload.type){case"MenuOpenPayload":e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case"MenuClosePayload":e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case"TellMeMenuItemExecuted":n.CommandId=t.payload.executedControl,n.ControlId=t.payload.executedControl,n.CloseAllMenus=!0,this.closeAllMenus();break;case"TellMeSearchResultChangePayload":n.Value=t.payload.searchText;break;case"SmartLookupPayload":n.CommandValueId=t.payload.selectionContextJson,n.EntryInfo=t.payload.subType}return e},o.executeCommandWithCommandMetadata=function(e,t,n,i){var a=this,o=this.populateControlMenuOnExecute(i,n),s=t.commandId,l={};switch(n){case"SplitButtonModel":if(this.handleMenuOpenClosePayload(i.payload,Object(r.d)(this,this.updateSplitButtonMenuState,"updateSplitButtonMenuState"),o))return;l.MenuItemId=t.menuItemId,this.setToggledParameter(i,l);break;case"StatefulSplitButtonModel":if(this.handleMenuOpenClosePayload(i.payload,Object(r.d)(this,this.updateStatefulSplitButtonMenuState,"updateStatefulSplitButtonMenuState"),o))return;var c=i.payload.statefulData,u=i.payload.statefulMode;if("color"===u)l.Color=c;else if("icon"===u){var d=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(c);d&&(l.MenuItemId=d.menuItemId)}else 0;break;case"FileMenu":l.MenuItemId=t.menuItemId,l.SourceControlId=e,i.payload&&"FileMenuPageSwitchPayload"===i.payload.type&&this.handleFileMenuPageSwitch(s,i.payload,e);break;case"TellMe":s=this.updateParametersForTellMe(s,i,l),l.SourceControlId=e,l.Location=i.payload.location;break;case"ButtonModel":i.payload&&"TabSwitchPayload"===i.payload.type?this.handleTabSwitch(l,i):s=this.updateParametersForButton(l,t,i,e,s);break;case"CompoundButtonModel":l.MenuItemId=t.menuItemId,l.CommandValueId=i.payload.commandValueId,l.SourceControlId=e,this.setToggledParameter(i,l),this.closeAllMenus();break;case"ToggleButtonModel":case"InkButtonModel":l.MenuItemId=t.menuItemId,l.SourceControlId=e,this.setToggledParameter(i,l),this.closeAllMenus();break;case"FontPickerModel":switch(i.payload.type){case"MenuOpenPayload":case"MenuClosePayload":return;case"FontPickerFontSelectedPayload":var p=i.payload.font;l.CommandValueId="string"==typeof p?p:p.name,l.SourceControlId=e,l[Ht.RequestUpdateMru]=p,this.logFontPickerExperience();break;case"FontPickerFontInfoRequestedPayload":var h=i.payload.font;l.CommandValueId=h.name,l[Ht.Trigger]=i.payload.trigger,this.logFontPickerExperience();break;case"FontPickerFontPinningPayload":var m=i.payload.fontKey,g=i.payload.isPinned;l.CommandValueId=m,l[Ht.IsPinned]=g,this.logFontPickerExperience();break;default:return void 0}break;case"ComboBoxModel":var f=i.payload.type;switch(f){case"MenuOpenPayload":case"MenuPopulatePayload":if(this.shouldPoll(i.payload.launcherId,o)){var v={};v[i.payload.launcherId]=n,this._reactRibbonRootPoller.pollForStateAndUpdateCommands(v,It.getUILocationFromPayload(i.payload)),this._lastPollTimes[e]=new Date}return;case"MenuClosePayload":return;case"ComboBoxPayload":case"ComboBoxPreviewPayload":var _=i.payload.newValue;if(!_)return;_.value?(l[Nt.a.Value]=_.value,l[Nt.a.IsFreeForm]=!0):(l[Nt.a.Value]=_.text,l.MenuItemId=_.key,l.CommandValueId=_.commandValueId),"ComboBoxPreviewPayload"===f&&(s=t.commandPreviewId);break;case"ComboBoxRevertPreviewPayload":s=t.commandRevertId;break;default:return void 0}break;case"FlyoutAnchorModel":this.handleMenuOpenClosePayload(i.payload,Object(r.d)(this,this.updateFlyoutAnchorMenuState,"updateFlyoutAnchorMenuState"),o),l.launcherId=i.payload.launcherId;break;case"InkFlyoutAnchorModel":this.handleMenuOpenClosePayload(i.payload,Object(r.d)(this,this.updateInkFlyoutAnchorMenuState,"updateInkFlyoutAnchorMenuState"),o),l.launcherId=i.payload.launcherId;break;case"ColorPickerModel":switch(i.payload.type){case"ColorPickerPayload":l[Lt.a.Color]=i.payload.selectedColorId;break;case"ColorPickerPreviewPayload":s=t.commandPreviewId,l[Lt.a.Color]=i.payload.selectedColorId;break;case"ColorPickerRevertPreviewPayload":s=t.commandRevertId;break;default:return void 0}break;case"SpinButtonModel":l[Vt.a.Number]=i.payload.value,l[Vt.a.UnitType]=Bt.a(i.payload.unitType.toLowerCase()),l[Vt.a.Text]=i.payload.reservedValue;break;case"SliderModel":l[jt.a.Value]=i.payload.value;break;case"InsertTableModel":l[Wt.a.Rows]=i.payload.rows,l[Wt.a.Columns]=i.payload.columns;break;case"CheckboxModel":l[Kt.a.On]=i.payload.checked,l.MenuItemId=t.menuItemId;break;case"PreviewGalleryModel":if(this.handleMenuOpenClosePayload(i.payload,Object(r.d)(this,this.updatePreviewGalleryMenuState,"updatePreviewGalleryMenuState"),o)){l.launcherId=i.payload.launcherId;break}return void this.executeGalleryButtonCommand(i,e);case"DocumentTitleModel":switch(i.payload.type){case"DocumentTitleRenamePayload":l.getNewDocumentTitle=i.payload.getNewDocumentTitle;break;case"MenuOpenPayload":var y={};return y[i.payload.launcherId]=n,this._reactRibbonRootPoller.pollForStateAndUpdateCommands(y,It.getUILocationFromPayload(i.payload)),void(this._lastPollTimes[e]=new Date);case"MenuClosePayload":return;default:return void 0}break;case"MRUCompoundButtonModel":l.MenuItemId=i.payload.url,this.logFileMenuMRUExecution(i.payload.pageId);break;case"NewBlankDocumentModel":case"CustomTemplateModel":l.MenuItemId=i.payload.assetId,l.SourceControlId=e,this.logFileMenuTemplateExecution(i.payload.pageId);break;case"CoauthorGallery":case"PeopleWell":l.RenderTime=i.triggerTime;break;case"SyncStatus":l.SourceControlId=e;break;case"InputBoxModel":l.Text=i.payload.newValue;break;case"PersonaButtonModel":this.handlePersonaCardOpenClose(i.payload);break;default:return void 0}if(s&&!this.isShadowMenuOpen(i.payload)){l.CommandValueId||(l.CommandValueId=l.MenuItemId),t.legacyControlId&&(l.LegacyId=t.legacyControlId),l.SourceControlId||(l.SqmControlId=e),i.payload&&!zt.c(i.payload.shouldTakeFocus)&&(l[xt.shouldCanvasTakeFocus]=i.payload.shouldTakeFocus);var b=this.addInputMethodToParameters(i,l);this._rootCommandHandler.executeCommand(s,l,this.getSelectedTabId(),b,!0,(function(t){a.moveFocusAfterCommandExecution(l,e)}),this.getTelemetryData(i),It.getUILocationFromPayload(i.payload))}},o.logFontPickerExperience=function(){this._systemInitiatedFeedback&&this._systemInitiatedFeedback.execute((function(e){e.logActivityDeferred("ModernFontPickerExperience",null)}))},o.addInputMethodToParameters=function(e,t){var n=2;return e.payload&&"inputMethod"in e.payload&&e.payload.inputMethod&&(n=e.payload.inputMethod,t[xt.inputMethod]=n),n},o.moveFocusAfterCommandExecution=function(e,t){var n=Object(a.a)(s.AFrame,l.AFrameworkApplication.activeFrame);if(this._focusManager&&this.shouldMoveFocus(e)){if(!this._focusManager.currentScope&&n){var i="null";if(e){var r=e.Value;delete e.Value,i=_e.i(e),zt.c(r)||(e.Value=r)}v.ULS.sendTraceTag(39359317,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",t,i,n.ribbonFocusScopeName)}this._focusManager.focusLastEditableSurface()}(!!this._focusManager&&!!this._focusManager.currentScope&&this._focusManager.currentScope.name!==s.AFrame.reactTransientUIFocusId&&!!n&&this._focusManager.currentScope.name!==n.ribbonFocusScopeName||this.shouldMoveFocus(e))&&this.collapseShyRibbonOnKeyboard(e)},o.shouldMoveFocus=function(e){return!!e&&!zt.c(e[xt.shouldCanvasTakeFocus])&&e[xt.shouldCanvasTakeFocus]},o.collapseShyRibbonOnKeyboard=function(e){xt.inputMethod in e&&1===e[xt.inputMethod]&&function(e,t){if(l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&It.selectorExists("getShyState")){var n=appChrome.selectors.getShyState();n.isActive&&n.state===e&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Ut,{state:t})))}}(1,0)},o.handleTabSwitch=function(e,t){if(this._ribbonRoot.pollForStateAndUpdate(),this._ribbonSQMInformation&&this._actionManager){var n={};n[Dt.a.tabId]=t.payload.tabId,this._actionManager.processActionWithData(f.a.reportTabSwitch,2,n,this.getTelemetryData(t))}var i=t.payload.tabId;if(e.NewContextId=i,e.NewContextCommand=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(i),v.ULS.sendTraceTag(39879004,340,50,"HandleTabSwitch tabId: "+i),this._systemInitiatedFeedback&&i){var r=i+"TabSwitchActivity";this._systemInitiatedFeedback.execute((function(e){e.logActivityDeferred(r,null)}))}},o.handleMenuOpenClosePayload=function(e,t,n){var i=e.type;return"MenuClosePayload"===i||"MenuOpenPayload"===i&&(t(e,n),!0)},o.handlePersonaCardOpenClose=function(e){var t=e.type;"MenuOpenPayload"===t?l.AFrameworkApplication.suppressAppCloseOnNavigate=!0:"MenuClosePayload"===t&&(l.AFrameworkApplication.suppressAppCloseOnNavigate=!1)},o.populateControlMenuOnExecute=function(e,t){if(!e.payload||!e.payload.launcherId||"MenuOpenPayload"!==e.payload.type&&"MenuPopulatePayload"!==e.payload.type)return!1;var n=e.payload.launcherId,i=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(n);if(i&&i.populationProps){var r=this._reactRibbonRootPoller.populateControlMenu(i,t,e.payload);return r&&n in this._lastPollTimes&&delete this._lastPollTimes[n],r}return!1},o.updateFlyoutAnchorMenuState=function(e,t){var n=e.launcherId;if(this.shouldPoll(n,t)){var i=appChrome.selectors.getFlyoutAnchorMenuItems(n);this.updateMenuItems(i,n,It.getUILocationFromPayload(e))}},o.updateInkFlyoutAnchorMenuState=function(e,t){var n=e.launcherId;if(this.shouldPoll(n,t)){var i=It.selectorExists("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(n):appChrome.selectors.getFlyoutAnchorMenuItems(n);this.updateMenuItems(i,n,It.getUILocationFromPayload(e))}},o.updatePreviewGalleryMenuState=function(e,t){var n=e.launcherId;if(this.shouldPoll(n,t)){var i=appChrome.selectors.getPreviewGalleryMenuItems(n);this.updateMenuItems(i,n,It.getUILocationFromPayload(e))}},o.updateSplitButtonMenuState=function(e,t){var n=e.launcherId;if(this.shouldPoll(n,t)){var i=appChrome.selectors.getSplitButtonMenuItems(n);this.updateMenuItems(i,n,It.getUILocationFromPayload(e))}},o.updateStatefulSplitButtonMenuState=function(e,t){var n=e.launcherId;if(this.shouldPoll(n,t)){var i=appChrome.selectors.getStatefulSplitButtonMenuItems(n);this.updateMenuItems(i,n,It.getUILocationFromPayload(e))}},o.getSelectedTabId=function(){return this.selectorsAreReady?appChrome.selectors.getSelectedTabId():null},o.updateMenuItems=function(e,t,n){this._reactRibbonRootPoller.pollForStateAndUpdateCommands(e,n),this._lastPollTimes[t]=new Date},o.shouldPoll=function(e,t){var n=!0;e in this._lastPollTimes&&(n=this._lastPollTimes[e].getTime()<this._ribbonRoot.lastPollTime.getTime());return n=n&&!t,n&&this.selectorsAreReady},o.executeGalleryButtonCommand=function(e,t){var n=this,i={},r=e.payload.selectedGalleryId,a=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(r);if(a){i.SourceControlId=r,i.MenuItemId=a.menuItemId,i.SqmControlId=t,a.legacyControlId&&(i.LegacyId=a.legacyControlId),e.payload&&!zt.c(e.payload.shouldTakeFocus)&&(i[xt.shouldCanvasTakeFocus]=e.payload.shouldTakeFocus),this.getParametersByGalleryPayloadType(e.payload,i);var o=this.addInputMethodToParameters(e,i);this._rootCommandHandler.executeCommand(a.commandId,i,this.getSelectedTabId(),o,!0,(function(e){n.moveFocusAfterCommandExecution(i,t)}),this.getTelemetryData(e),It.getUILocationFromPayload(e.payload))}},o.getParametersByGalleryPayloadType=function(e,t){"CharacterGalleryPayload"===e.type&&(t.MenuItemId=e.character)},o.setToggledParameter=function(e,t){e.payload&&"toggled"in e.payload&&(t[Kt.a.On]=e.payload.toggled)},o.manageAppFocus=function(e,t){"MenuOpen"===e?!this._modalDiv||"isShadowRendering"in t.payload&&t.payload.isShadowRendering||this._modalDiv.onMenuOpen():"MenuClose"===e&&this._modalDiv&&this._modalDiv.onMenuClose()},o.closeAllMenus=function(){this._modalDiv&&this._modalDiv.onCloseAllMenus()},o.getTelemetryData=function(e){var t=null;return zt.c(e.triggerTime)||((t={}).TriggerTime=e.triggerTime),t},o.handleFileMenuPageSwitch=function(e,t,n){if(this._fileMenuSQMInformation&&this._actionManager){var i={};i[Ft.a.pageId]=n,this._actionManager.processActionWithData(f.a.reportFileMenuPageSwitch,2,i)}this.updateMenuItems(t.pageControlIdMap,e,It.getUILocationFromPayload(t))},o.logFileMenuTemplateExecution=function(e){if(this._actionManager)switch(e){case"FileHomePage":this._actionManager.processAction(f.a.reportTemplateFromHomePage,2);break;case"FileNewPage":this._actionManager.processAction(f.a.reportTemplateFromNewPage,2)}},o.logFileMenuMRUExecution=function(e){if(this._actionManager)switch(e){case"FileHomePage":this._actionManager.processAction(f.a.reportMRUFromHomePage,2);break;case"FileOpenPage":this._actionManager.processAction(f.a.reportMRUFromOpenPage,2)}},o.isShadowMenuOpen=function(e){return!!e&&"MenuOpenPayload"===e.type&&e.isShadowRendering},t=e,(n=[{key:"selectorsAreReady",get:function(){return!!window.appChrome&&!!appChrome.selectors}}])&&qt(t.prototype,n),i&&qt(t,i),e}();Object(i.a)(Gt,"ReactExecuteCommandHandler",null,[]);var Qt=n(201),Zt=n(15),$t=n(92);function Xt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Jt,Yt=function(e){var t,n,i,r,a;function o(){var t;return(t=e.call(this)||this).Command=null,t.QueryCommand=null,t.Alt=null,t.LabelText=null,t.MenuItemId=null,t.InnerHTML=null,t.ShouldSetTitle=null,t.VerticalCenterAlign=null,t.Image=null,t.ImageClass=null,t.IsDisabled=null,t}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=o,(r=[{key:"ControlType",get:function(){return 11}},{key:"Type",get:function(){return 0}}])&&Xt(i.prototype,r),a&&Xt(i,a),o}($t.a);Object(i.a)(Yt,"GalleryButtonProps",$t.a,[]),function(e){e[e.UnspecifiedGallery=0]="UnspecifiedGallery",e[e.CharacterCodeGallery=1]="CharacterCodeGallery",e[e.FontStyleGallery=2]="FontStyleGallery",e[e.InkThicknessGallery=3]="InkThicknessGallery",e[e.IconGallery=4]="IconGallery",e[e.ListGallery=5]="ListGallery",e[e.TableStyleGallery=6]="TableStyleGallery",e[e.PageNumberGallery=7]="PageNumberGallery",e[e.ChangeColorsGallery=8]="ChangeColorsGallery"}(Jt||(Jt={})),Object(i.b)("GalleryType",Jt);var en=function(){this.disabled=null,this.hidden=null,this.style=null,this.title=null};Object(i.a)(en,"CommonGalleryButtonProps",null,[]);var tn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).tableCellStyles=null,t.tableStyles=null,t.columns=0,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(en);Object(i.a)(tn,"AdditionalTableStyleGalleryButtonProps",en,[]);var nn=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(tn);Object(i.a)(nn,"AdditionalChangeColorsGalleryButtonProps",tn,[]);var rn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).character=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(en);Object(i.a)(rn,"AdditionalCharacterCodeGalleryButtonProps",en,[]);var an=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).styleDisplayName=null,t.previewStyleLabel=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(en);Object(i.a)(an,"AdditionalFontStyleGalleryButtonProps",en,[]);var on=function(){this.disabled=null,this.hidden=null,this.sections=null,this.selectedId=null,this.columns=0,this.level=0,this.styles=null,this.galleryType="TableStyleGallery"};Object(i.a)(on,"AdditionalGalleryProperties",null,[]);var sn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).icon=null,t.label=null,t.fullIconStyle=null,t.previewIconStyle=null,t.keytip=null,t.largeFullIconStyle=null,t.largePreviewIconStyle=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(en);Object(i.a)(sn,"AdditionalIconButtonProperties",en,[]);var ln=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).styleDisplayName=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(en);Object(i.a)(ln,"AdditionalInkThicknessGalleryButtonProps",en,[]);var cn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).infoAtLevel=null,t.ariaLabel=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(en);Object(i.a)(cn,"AdditionalListGallerButtonProps",en,[]);var un=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).text=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(en);Object(i.a)(un,"AdditionalPageNumberGalleryButtonProps",en,[]);var dn=n(90),pn=n(98),hn=n(181),mn=n(216),gn=n(45),fn=function(e,t,n,i){if(En(i)){var r=new Array(0);switch(t){case"ToggleButtonModel":case"InkButtonModel":r.push(_n(e,n[Kt.a.On]));break;case"CheckboxModel":r.push(yn(e,n[Kt.a.On]));break;case"ComboBoxModel":if(l.AFrameworkApplication.appSettingsManager&&l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactRibbonDispatchActionFilter")&&!function(e,t){var n=appChrome.selectors.getActiveControlStates(),i=Object(a.a)(Object,n[e]);if(i){var r=Object(a.a)(String,i.value);if(r&&r===t)return!1;var o=Object(a.a)(String,i.selectedKey);if(!t&&!o)return!1;if(o){for(var s=Array.isArray(i.options)?i.options:null,l=null,c=0;c<s.length;c++){var u=Object(a.a)(Object,s[c]);if(Object(a.a)(String,u.key)===o){l=u;break}}if(l&&Object(a.a)(String,l.text)===t)return!1}}return!0}(e,n[Nt.a.Value]))break;var o=n[Nt.a.Key];o?r.push(appChrome.actions.updateComboBoxKey(e,o,n[Nt.a.Value])):r.push(appChrome.actions.updateComboBoxValue(e,n[Nt.a.Value]));break;case"FontPickerModel":var s=n[Ht.SelectedFont];r.push(appChrome.actions.updateFontPickerSelectedFont(e,s));break;case"SplitButtonModel":r.push(_n(e,n[hn.a.On]));break;case"SpinButtonModel":r.push(appChrome.actions.updateSpinButton(e,n[Vt.a.Number],Bt.b(n[Vt.a.UnitType]),n[Vt.a.Text],n[Vt.a.MaxValue],n[Vt.a.Alt]));break;case"ColorPickerModel":r.push(appChrome.actions.updateColorPickerSelectedColor(e,n[Lt.a.IndexColorSelected]));break;case"PageNumberGalleryButtonModel":r.push(appChrome.actions.updatePageNumberGalleryButtonText(e,n[dn.a.Text]));break;case"CompoundButtonModel":n[Kt.a.Description]&&r.push(appChrome.actions.updateCompoundButtonDescription(e,n[Kt.a.Description])),Kt.a.On in n&&r.push(_n(e,n[Kt.a.On]));break;case"SliderModel":n.snapToStep?r.push(appChrome.actions.updateSliderSelectedValue(e,n[jt.a.Value])):r.push(appChrome.actions.updateSliderValue(e,n[jt.a.Value],0,n[jt.a.MaxValue],n[jt.a.Text]));break;case"FlyoutAnchorModel":pn.a.ImageIsVisible in n&&r.push(appChrome.actions.hideFlyoutAnchorIcon(e,!n[pn.a.ImageIsVisible])),Kt.a.On in n&&r.push(_n(e,n[Kt.a.On]));break;case"InputBoxModel":r.push(appChrome.actions.updateInputBoxValue(e,n[mn.a.Text]))}return In(e,n,r),Cn(e,n,r),An(e,n,r),Sn(e,n,r),wn(n,r),r}return null},vn=function(e,t){return appChrome.actions.updateControlEnabledDisabledState(e,t)},_n=function(e,t){return appChrome.actions.toggleButton(e,t)},yn=function(e,t){return appChrome.actions.toggleCheckbox(e,t)},bn=function(e,t){return appChrome.actions.setControlLabel(e,t)},Sn=function(e,t,n){var i=Object(a.a)(String,t[gn.a.customTooltip]);i&&It.appChromeContainsAction("setControlCustomTooltip")&&n.push(function(e,t){return appChrome.actions.setControlCustomTooltip(e,t)}(e,i))},Cn=function(e,t,n){var i=Object(a.a)(String,t[gn.a.Icon]);i&&n.push(function(e,t){return appChrome.actions.setControlIcon(e,t)}(e,i))},An=function(e,t,n){var i=Object(a.a)(Object,t[gn.a.IconSet]);i&&n.push(function(e,t){return appChrome.actions.setControlIconSet(e,t)}(e,i))},In=function(e,t,n){var i=Object(a.a)(String,t[gn.a.iconColor]);i&&n.push(appChrome.actions.updateIconColor(e,i))},wn=function(e,t){var n=Array.isArray(e[gn.a.reduxActions])?e[gn.a.reduxActions]:null;n&&t.push.apply(t,n)},Tn=function(e){return(1&e)<1},En=function(e){return(2&e)>0};function kn(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Mn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Mn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Pn=function(){function e(e,t,n,i){this._externalUICommandDefinitionMapping=i,this._rootPoller=e,this._rootUser=t,this._rootType=n,this._justPopulatedFullGalleriesMap={}}var t=e.prototype;return t.populateGallery=function(e,t,n,i,r){void 0===r&&(r=null);var a=e.ExternalGalleryId||e.ExternalId,o=e.ExternalId;if(i.push(a),!appChrome.selectors.isControlDefined(a)){if(4!==e.Type)return void 0;It.apiExists("createGalleryModel")?n.push(appChrome.api.createGalleryModel(a,Object.assign(new on,{columns:e.Width,sections:[appChrome.api.gallerySection(new Array(0),o)],styles:e.GalleryStyle,galleryType:"IconGallery"}))):n.push(appChrome.api.iconGalleryControl(a,e.Width,[appChrome.api.gallerySection(new Array(0),o)],e.GalleryStyle))}t.push.apply(t,this.getPopulateActionsFromGalleryButtonPropsArray(e.GalleryItems,a,o,!1,r))},t.getPreviewGalleryQueryCommandActions=function(e,t){var n=new Array(0),i=null,r=!1;if(!e)return null;var o=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,e.commandId,t);if(n.push(vn(e.externalUxCommand,!o)),e.previewControlIds){for(var s=new Array(0),l=0;l<e.previewControlIds.length;l++){var c={},u=e.previewControlIds[l];c.SourceControlId=u;var d=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(u);this.getPollResult(d||e,c),c[dn.a.On]&&(i=c.SourceControlId,c[dn.a.HighlightOn]&&(r=!0)),Cn(u,c,n);var p=Object(a.a)(Yt,c[dn.a.GalleryButtonProps]);if(p){if(s.push(p),o){var h=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,p.Command,t);p.IsDisabled=!h}}else;}s.length>0&&n.push.apply(n,this.getPopulateActionsFromGalleryButtonPropsArray(s,e.externalUxCommand,e.externalUxCommand,!0)),n.push(appChrome.actions.updateGallerySelectedId(e.externalUxCommand,i)),r&&(v.ULS.sendTraceTag(51517593,340,50,"HighlightSelectedFontStyle fired for {0} button",i),n.push(appChrome.actions.highlightSelectedFontStyle(i)))}return n},t.getPopulateActionsFromGalleryButtonPropsArray=function(e,t,n,i,r){void 0===r&&(r=null);for(var a=new Array(0),o=new Array(0),s=new Array(0),c=0;c<e.length;c++){var u=e[c],d=zt.b(u.ExternalId)?u.Id:u.ExternalId;switch(o.push(d),u.Type){case 1:var p=u;It.apiExists("createCharacterCodeGalleryButtonModel")?s.push(appChrome.api.createCharacterCodeGalleryButtonModel(d,Object.assign(new rn,{disabled:p.IsDisabled,character:p.Character,style:p.Style,title:p.Alt}))):s.push(appChrome.api.characterCodeGalleryButton(d,p.Character,p.Style?p.Style:null,p.Alt,p.IsDisabled));break;case 2:var h=u;It.apiExists("createFontStylesGalleryButtonModel")?s.push(appChrome.api.createFontStylesGalleryButtonModel(d,Object.assign(new an,{disabled:h.IsDisabled,styleDisplayName:h.LabelText,style:h.Style,title:h.Alt,previewStyleLabel:h.PreviewStyleLabel}))):s.push(appChrome.api.fontStyleGalleryButton(d,h.LabelText,h.Style,h.Alt,h.IsDisabled,h.PreviewStyleLabel));break;case 3:var m=u;s.push(appChrome.api.createInkThicknessGalleryButtonModel(d,Object.assign(new ln,{disabled:m.IsDisabled,styleDisplayName:m.LabelText,style:m.Style,title:m.Alt})));break;case 4:var g=u;It.apiExists("createIconGalleryButtonModel")?s.push(appChrome.api.createIconGalleryButtonModel(d,Object.assign(new sn,{disabled:g.IsDisabled,icon:[g.Icon],fullIconStyle:g.FullIconStyle,previewIconStyle:g.PreviewIconStyle,label:g.LabelText,title:g.Alt}))):null!=g.IsDisabled?s.push(appChrome.api.iconGalleryButton(d,g.Icon,g.LabelText,g.Alt,g.FullIconStyle,g.PreviewIconStyle,g.IsDisabled)):s.push(appChrome.api.iconGalleryButton(d,g.Icon,g.LabelText,g.Alt,g.FullIconStyle,g.PreviewIconStyle));break;case 5:var f=u;It.apiExists("createListGalleryButtonModel")?s.push(appChrome.api.createListGalleryButtonModel(d,Object.assign(new cn,{disabled:f.IsDisabled,infoAtLevel:f.LevelInfo,ariaLabel:f.Alt}))):s.push(appChrome.api.listGalleryButton(d,f.LevelInfo,f.Alt,f.IsDisabled));break;case 6:var v=u;It.apiExists("createTableStyleGalleryButtonModel")?s.push(appChrome.api.createTableStyleGalleryButtonModel(d,Object.assign(new tn,{disabled:v.IsDisabled,tableCellStyles:v.TableCellStyles,tableStyles:v.TableStyles,title:v.Alt,columns:v.columns}))):s.push(appChrome.api.tableStyleGalleryButton(d,v.TableCellStyles,v.TableStyles,v.Alt,v.IsDisabled));break;case 8:var _=u;It.apiExists("createChangeColorsGalleryButtonModel")?s.push(appChrome.api.createChangeColorsGalleryButtonModel(d,Object.assign(new nn,{disabled:_.IsDisabled,tableCellStyles:_.TableCellStyles,tableStyles:_.TableStyles,title:_.Alt}))):s.push(appChrome.api.changeColorsGalleryButton(d,_.TableCellStyles,_.TableStyles,_.Alt,_.IsDisabled));break;case 7:var y=u;It.apiExists("createPageNumberGalleryButtonModel")?s.push(appChrome.api.createPageNumberGalleryButtonModel(d,Object.assign(new un,{disabled:y.IsDisabled,text:y.Text,title:y.Alt}))):s.push(appChrome.api.pageNumberGalleryButton(d,y.Text,y.Alt,y.IsDisabled))}this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new Zt.a(d,u.Command),{queryCommandId:u.QueryCommand,menuItemId:u.MenuItemId}))}if(a.push(appChrome.actions.addControls(s)),i)a.push(appChrome.actions.populateGalleryItems(t,o));else{if(l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptimizeGalleryPopulationIsEnabled")){var b=e.length>0?e[0].Type:0;this._justPopulatedFullGalleriesMap[t]=!1;var S=!0;if(l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactGalleriesAlwaysEnabledButtonsIsEnabled"))S=appChrome.selectors.getGalleryState(t).disableIndividualButtons;a.push.apply(a,this.getGalleryQueryCommandActionsInternal(t,Jt[b],o,null,5===b,S,r))}a.push(appChrome.actions.updateGallerySectionItems(t,n,o))}return a},t.getGalleryQueryCommandActions=function(e){var t=e.items,n=e.sections,i=!0;return l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactGalleriesAlwaysEnabledButtonsIsEnabled")&&(i=e.disableIndividualButtons),this.getGalleryQueryCommandActionsInternal(e.ExternalUxId,e.galleryType,t,n,e.isListGallery,i)},t.getGalleryQueryCommandActionsInternal=function(e,t,n,i,r,a,s){void 0===a&&(a=!0),void 0===s&&(s=null);var c=new Array(0);if(l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptimizeGalleryPopulationIsEnabled")&&e in this._justPopulatedFullGalleriesMap){if(this._justPopulatedFullGalleriesMap[e])return delete this._justPopulatedFullGalleriesMap[e],c;this._justPopulatedFullGalleriesMap[e]=!0}var u=null,d=-1;if(n)u=this.addGalleryButtonQueryActions(t,n,c,a,Object(o.a)((function(){return d}),(function(e){return d=e})),s);else if(i)for(var p,h=kn(i);!(p=h()).done;){var m=p.value,g=this.addGalleryButtonQueryActions(t,m.galleryButtons,c,a,Object(o.a)((function(){return d}),(function(e){return d=e})));g&&(u=g)}return c.push(appChrome.actions.updateGallerySelectedId(e,u)),a&&c.push(vn(e,!1)),r&&d>0&&c.push(appChrome.actions.updateListGalleryTextDirection(e,2===d)),c},t.addGalleryButtonQueryActions=function(e,t,n,i,r,a){void 0===a&&(a=null);var o=null;r.val=-1;for(var s,c=!1,u=kn(t);!(s=u()).done;){var d=s.value,p=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptimizeGalleryPopulationIsEnabled")?this.getGalleryButtonModelTypeFromFullGalleryType(e):appChrome.selectors.getModelType(d),h={};h.SourceControlId=d,h.Location=a;var m=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(d);if(m){var g=this.getPollResult(m,h);i&&n.push(vn(d,Tn(g)));var f=fn(d,p,h,g);f&&n.push.apply(n,f),h[dn.a.On]&&(o=d,h[dn.a.HighlightOn]&&h[dn.a.HighlightOn]&&(c=!0)),void 0!==h[gn.a.labelText]&&null!==h[gn.a.labelText]&&n.push(bn(m.externalUxCommand,h[gn.a.labelText])),h[dn.a.IsRtl]&&r.val<0&&(r.val=h[dn.a.IsRtl])}}return c&&(v.ULS.sendTraceTag(51517594,340,50,"HighlightSelectedFontStyle fired for {0} button",o),n.push(appChrome.actions.highlightSelectedFontStyle(o))),o},t.getGalleryButtonModelTypeFromFullGalleryType=function(e){switch(e){case"CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case"FontStyleGallery":return"FontStyleGalleryButtonModel";case"InkThicknessGallery":return"InkThicknessGalleryButtonModel";case"IconGallery":return"IconGalleryButtonModel";case"ListGallery":return"ListGalleryButtonModel";case"TableStyleGallery":return"TableStyleGalleryButtonModel";case"ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case"PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"},t.getPollResult=function(e,t){return t.MenuItemId=e.menuItemId,this._rootPoller.pollForCommandState(this._rootUser,this._rootType,e.commandId,e.queryCommandId,t)},e}();Object(i.a)(Pn,"ReactGalleryPoller",null,[]);var Fn=n(287),Dn=n(310),On=n(336),Rn=n(118);var xn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).Styles=null,t.AriaLabel=null,t.Data=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Rn.a);function Un(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(xn,"ComboBoxItemButtonProps",Rn.a,[]);var Bn=function(e){var t,n,i,r,a;function o(){return e.call(this)||this}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=o,(r=[{key:"ControlType",get:function(){return 3}}])&&Un(i.prototype,r),a&&Un(i,a),o}(Rn.a);Object(i.a)(Bn,"CompoundButtonProps",Rn.a,[]);var Ln=n(241),Nn=n(337),Hn=n(221),Wn=n(333),jn=function(){this.commandId=null,this.fonts=null,this.mruList=null,this.isSubscriber=!1,this.previewFontFamily=null};Object(i.a)(jn,"PopulateFontPickerDataProps",null,[]);var Vn=function(){};Vn.licenseFeatureId="ModernFontPicker",Object(i.a)(Vn,"FontPickerConstants",null,[]);var Kn=function(e,t,n,i){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),this.iconSet={},this.iconSet.default=e,this.iconSet.icon16=t,this.iconSet.icon24=n,this.iconSet.icon32=i};Object(i.a)(Kn,"IconSetContainer",null,[]);var zn=function(){this.iconSet=null,this.disabled=!1,this.hidden=!1,this.iconColor=null,this.fullDescriptionLabel=null,this.keytip=null,this.customTooltip=null};Object(i.a)(zn,"CommonOptionalButtonProperties",null,[]);var qn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).commandValueId=null,t.role=null,t.hideLabel=!1,t.supportsPreview=!1,t.lang=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(zn);Object(i.a)(qn,"OptionalButtonProperties",zn,[]);var Gn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).commandValueId=null,t.styles=null,t.roleInMenu=null,t.lang=null,t.ariaDescription=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(zn);Object(i.a)(Gn,"OptionalCompoundButtonProperties",zn,[]);var Qn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).menuModel=null,t.hideLabel=!1,t.downChevronIcon=null,t.hideChevron=!1,t.hideIcon=!1,t.lang=null,t.labelInMenu=null,t.toggled=!1,t.roleInMenu=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(zn);Object(i.a)(Qn,"OptionalFlyoutAnchorProperties",zn,[]);var Zn=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).secondaryText=null,t.styles=null,t.flipIconInRtl=!1,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(qn);Object(i.a)(Zn,"OptionalPersonaButtonProperties",qn,[]);var $n=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).toggled=!1,t.roleInMenu=null,t.toggleUsingIcon=!1,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(zn);Object(i.a)($n,"OptionalToggleButtonProperties",zn,[]);var Xn=function(){};Object(i.a)(Xn,"PersonaIdentifiers",null,[]);var Jn=function(){};Object(i.a)(Jn,"PersonaInfo",null,[]);var Yn=n(227),ei=function(){this.actions=null,this.commandsToPoll=null,this.wasShadowMenuOpen=!1};Object(i.a)(ei,"PopulateActions",null,[]);var ti=function(){function e(){}var t=e.prototype;return t.getStateProps=function(e,t){switch(t){case"ColorPickerModel":return appChrome.selectors.getColorPickerState(e);case"ToggleButtonModel":return this.getPropsForToggleButtonModel(e);case"InkButtonModel":return this.getPropsForInkButtonModel(e);case"GalleryModel":return appChrome.selectors.getGalleryState(e);case"SplitButtonModel":return appChrome.selectors.getSplitButtonState(e);case"SliderModel":return appChrome.selectors.getSliderState(e)}return{}},t.getPropsForToggleButtonModel=function(e){var t={};return t[Kt.a.On]=appChrome.selectors.getButtonToggleState(e),t},t.getPropsForInkButtonModel=function(e){var t={};return t[Kt.a.On]=It.selectorExists("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(e):appChrome.selectors.getButtonToggleState(e),t},e}();Object(i.a)(ti,"ReactStatePropsSelector",null,[]);var ni=function(){function e(e,t,n,i,r){this._rootPoller=e,this._rootUser=t,this._rootType=n,this._externalUICommandDefinitionMapping=i,this._successfullyPolledPopulateCommands={},this._reactStatePropsSelector=new ti,this._reactGalleryPoller=r}var t=e.prototype;return t.skipPopulation=function(e){var t=e.populationProps.populateQueryCommandId;return e.populationProps.populateOnlyOnce&&t in this._successfullyPolledPopulateCommands},t.getReduxActionsAndCommandsToPoll=function(t,n,i){void 0===i&&(i=null);var r=new Array(0),a={};if(!this.skipPopulation(t)){var o=t.populationProps.populateQueryCommandId,s={};if(s.MenuId=t.externalUxCommand,s.IsShadowMenuOpen=this.isShadowMenuOpen(i),(1&this._rootPoller.pollForCommandState(this._rootUser,this._rootType,o,o,s,this.getInputMethod(i)))>0)if("FontPickerModel"===n){this._successfullyPolledPopulateCommands[o]=!0;var l=s;r.push(e.getPopulateFontPickerAction(t,l)),a[t.externalUxCommand]="FontPickerModel"}else{var c=s;if(c.MenuItems)switch(this._successfullyPolledPopulateCommands[o]=!0,n){case"ComboBoxModel":r.push(e.getPopulateComboBoxAction(t,c)),a[t.externalUxCommand]="ComboBoxModel";break;case"FlyoutAnchorModel":case"InkFlyoutAnchorModel":case"PreviewGalleryModel":case"SplitButtonModel":case"StatefulSplitButtonModel":r.push.apply(r,this.getUpdateActionsForMenuControls(t.externalUxCommand,n,c.MenuItems,a,i&&"location"in i?i.location:null))}}}return Object.assign(new ei,{actions:r,commandsToPoll:a,wasShadowMenuOpen:this.isShadowMenuOpen(i)})},t.getUpdateActionsForMenuControls=function(e,t,n,i,r){void 0===r&&(r=null);for(var o=new Array(0),s=new Array(0),l=new Array(0),c=new Array(0),u=0;u<n.MenuSectionList.length;u++){var d=Object(a.a)(Hn.a,n.MenuSectionList[u]);if(d){var p=null,h=new Array(0);zt.c(d.Title)||(p=d.Title);for(var m=0;m<d.ControlList.length;m++){var g=Object(a.a)($t.a,d.ControlList[m]);g&&!g.ExternalId||(i&&this.getCommandsToPoll(g,i),o.push.apply(o,this.getPopulateControlReduxActions(g,s,h,c,e,t,r)))}n.UpdateDynamically&&l.push(appChrome.api.menuSection(h,p,d.Lang))}}return n.UpdateDynamically&&o.push(appChrome.actions.updateMenu(e,l,n.Title,n.AriaLabel,n.ShouldAutoOpen,n.AriaRoleDescription,n.MenuTargetDescriptor)),s.length>0&&o.splice(0,0,appChrome.actions.addControls(s)),c.length>0&&It.appChromeContainsAction("setStatefulSplitButtonMruBypassControls")&&o.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(e,c)),o},t.getCommandsToPoll=function(e,t){switch(e.ControlType){case 1:case 3:return void(t[e.ExternalId]=1===e.ControlType?"ButtonModel":"CompoundButtonModel");case 2:return void(t[e.ExternalId]="ToggleButtonModel");case 6:return void(t[e.ExternalId]="CheckboxModel");case 7:return void(t[e.ExternalId]="ColorPickerModel");case 9:return void(t[e.ExternalId]="FlyoutAnchorModel")}},t.getPopulateControlReduxActions=function(e,t,n,i,r,o,s){void 0===s&&(s=null);var l=new Array(0);switch(e.ControlType){case 1:case 3:var c=Object(a.a)(Rn.a,e);return this.populateButton(c,l,t,n),c.MenuItemsStatefulData&&It.appChromeContainsAction("setStatefulSplitButtonMenuItemsStatefulData")&&l.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(r,c.MenuItemsStatefulData)),l;case 2:return this.populateToggleButton(Object(a.a)(Yn.a,e),l,t,n),l;case 6:return this.populateCheckMarkToggleButton(Object(a.a)(Dn.a,e),l,t,n),l;case 4:return this.populatePersonaButton(Object(a.a)(Wn.a,e),l,t,n),l;case 7:return this.populateColorPicker(Object(a.a)(On.a,e),l,t,n),l;case 9:var u=Object(a.a)(Ln.a,e);return this.populateFlyoutAnchor(u,l,t,n),"StatefulSplitButtonModel"===o&&i.push(u.ExternalId),l;case 8:return this._reactGalleryPoller.populateGallery(Object(a.a)(Nn.a,e),l,t,n,s),l}return l},t.populateButton=function(e,t,n,i){i.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?(e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)),e.Description&&t.push(appChrome.actions.updateCompoundButtonDescription(e.ExternalId,e.Description)),e.CommandValueId&&t.push(appChrome.actions.setButtonCommandValueId(e.ExternalId,e.CommandValueId))):(e.Description||Object(r.c)(Bn,e)?n.push(appChrome.api.createCompoundButtonModel(e.ExternalId,e.LabelText,e.Description,Object.assign(new Gn,{iconSet:new Kn(this.getIconName(e)).iconSet,keytip:e.KeyTip,roleInMenu:e.RoleInMenu,ariaDescription:e.AriaDescription}))):n.push(appChrome.api.createButtonModel(e.ExternalId,e.LabelText,Object.assign(new qn,{iconSet:new Kn(this.getIconName(e)).iconSet,keytip:e.KeyTip,supportsPreview:!!e.CommandPreviewId&&!!e.CommandRevertId,customTooltip:e.LabelText!==e.Alt?e.Alt:null,commandValueId:e.CommandValueId}))),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new Zt.a(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand,commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId}))),e.Lang&&It.appChromeContainsAction("setControlLanguage")&&t.push(appChrome.actions.setControlLanguage(e.ExternalId,e.Lang))},t.populateCheckMarkToggleButton=function(e,t,n,i){i.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)):(n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,Object.assign(new $n,{iconSet:new Kn(this.getIconName(e)).iconSet,keytip:e.KeyTip,toggled:e.IsChecked,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel,customTooltip:e.LabelText!==e.Alt?e.Alt:null,toggleUsingIcon:!!e.CheckedImageClass}))),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new Zt.a(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand})))},t.populateToggleButton=function(e,t,n,i){i.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)):(n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,Object.assign(new $n,{iconSet:new Kn(this.getIconName(e)).iconSet,keytip:e.KeyTip,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel}))),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new Zt.a(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand})))},t.populatePersonaButton=function(e,t,n,i){i.push(e.ExternalId);var r=this.getPersonaInfoFromProps(e);if(appChrome.selectors.isControlDefined(e.ExternalId))e.LabelText&&t.push(appChrome.actions.setPersonaButtonCoauthor(e.ExternalId,r,e.LabelText));else if(It.apiExists("createPersonaButtonModel")){var a;n.push(appChrome.api.createPersonaButtonModel(e.ExternalId,r,e.LabelText,Object.assign(new Zn,{role:e.RoleInMenu,fullDescriptionLabel:e.AriaDescription,iconSet:(a={},a.default="doughboywhiteglyph_20",a)})))}},t.populateFlyoutAnchor=function(e,t,n,i){if(i.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId))e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText));else{var r=!(void 0===e.ImageIsVisible||null===e.ImageIsVisible||e.ImageIsVisible),a=!(void 0===e.Toggled||null===e.Toggled)&&e.Toggled;n.push(appChrome.api.createFlyoutAnchorModel(e.ExternalId,e.LabelText,Object.assign(new Qn,{iconSet:new Kn(this.getIconName(e)).iconSet,keytip:e.KeyTip,hideIcon:r,toggled:a,roleInMenu:e.AriaLabel}))),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new Zt.a(e.ExternalId,e.Command),{queryCommandId:e.QueryCommand,populationProps:new Fn.a(e.PopulateQueryCommand,e.PopulateOnlyOnce)}))}e.Menu&&t.push.apply(t,this.getUpdateActionsForMenuControls(e.ExternalId,"FlyoutAnchorModel",e.Menu,null)),e.Lang&&t.push(appChrome.actions.setControlLanguage(e.ExternalId,e.Lang))},t.populateColorPicker=function(e,t,n,i){e.McuLayout&&i.push(e.McuExternalId),i.push(e.ExternalId);var r=0;appChrome.selectors.isControlDefined(e.ExternalId)?e.McuLayout&&(r=this._reactStatePropsSelector.getStateProps(e.ExternalId,"ColorPickerModel").columnCount):(e.McuLayout&&(n.push(appChrome.api.createColorPickerModel(e.McuExternalId,e.Width)),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new Zt.a(e.McuExternalId,e.Command),{commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId})),r=e.Width),n.push(appChrome.api.createColorPickerModel(e.ExternalId,e.Width)),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new Zt.a(e.ExternalId,e.Command),{commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId})));for(var a=new Array(0),o=new Array(0),s=0;s<e.Colors.length;s++){var l=e.Colors[s];s<r?a.push(appChrome.api.colorPickerCell(l.Color,l.DisplayColor,l.Alt)):o.push(appChrome.api.colorPickerCell(l.Color,l.DisplayColor,l.Alt))}a.length>0&&t.push(appChrome.actions.populateColorPickerCells(e.McuExternalId,a)),t.push(appChrome.actions.populateColorPickerCells(e.ExternalId,o)),e.SelectedColorId&&(a.length>0&&t.push(appChrome.actions.updateColorPickerSelectedColor(e.McuExternalId,e.SelectedColorId)),t.push(appChrome.actions.updateColorPickerSelectedColor(e.ExternalId,e.SelectedColorId)))},t.getIconName=function(e){return e.Image32by32Class?this._externalUICommandDefinitionMapping.getExternalIconIdByLegacyIconId(e.Image32by32Class):e.Image16by16Class?this._externalUICommandDefinitionMapping.getExternalIconIdByLegacyIconId(e.Image16by16Class):e.ExternalImageId},t.getPersonaInfoFromProps=function(e){return e?Object.assign(new Jn,{displayName:e.DisplayName,personaCoinColor:e.ImageBackColor,isUnauthenticatedSender:e.IsAnonymous,identifiers:Object.assign(new Xn,{PersonaType:"User",Smtp:e.PersonaId})}):null},t.getInputMethod=function(e){var t=2;return e&&"inputMethod"in e&&e.inputMethod&&(t=e.inputMethod),t},t.isShadowMenuOpen=function(e){return!!e&&e.isShadowRendering},e.getPopulateFontPickerAction=function(e,t){return appChrome.actions.populateFontPickerDataAsync(le.a.instance.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").isFeatureEnabled(Vn.licenseFeatureId,!1).then((function(n){return Object.assign(new jn,{commandId:e.externalUxCommand,fonts:t.fonts,isSubscriber:n,mruList:t.mruList,previewFontFamily:"'msofp',msofp_MSFontService,'Segoe UI',Tahoma,Sans-Serif;"})})))},e.getPopulateComboBoxAction=function(e,t){for(var n=new Array(0),i=0;i<t.MenuItems.MenuSectionList.length;i++){var r=t.MenuItems.MenuSectionList[i];r.Title&&n.push(appChrome.api.comboBoxHeader("Header-"+i.toString(),r.Title));for(var o=0;o<r.ControlList.length;o++){var s=Object(a.a)(xn,r.ControlList[o]);s&&n.push(appChrome.api.comboBoxItem(s.MenuItemId,s.LabelText,s.Styles,s.CommandValueId,s.AriaLabel,s.Data))}i<t.MenuItems.MenuSectionList.length-1&&n.push(appChrome.api.comboBoxDivider("Divider-"+i.toString()))}return appChrome.actions.populateComboBoxOptions(e.externalUxCommand,n)},e}();Object(i.a)(ni,"ReactPopulateQueryCommandPoller",null,[]);var ii=function(){function e(e,t,n,i,r){this._externalUICommandDefinitionMapping=n,this._rootPoller=e,this._rootUser=t,this._rootType=i,this._reactGalleryPoller=r}var t=e.prototype;return t.getReduxActions=function(e,t,n){var i=new Array(0);if(this.isContainerModelType(t)){var r=this.getStateActionsForContainerModelType(e,t,n);null!=r&&i.push.apply(i,r)}else if(e){var a=this.getPollResult(e,n);if(gn.a.visible in n&&i.push(function(e,t){return appChrome.actions.updateControlHiddenState(e,t)}(e.externalUxCommand,!n[gn.a.visible])),i.push(vn(e.externalUxCommand,Tn(a))),void 0!==n[gn.a.labelText]&&null!==n[gn.a.labelText]&&i.push(bn(e.externalUxCommand,n[gn.a.labelText])),null!=t){var o=fn(e.externalUxCommand,t,n,a);null!=o&&i.push.apply(i,o),"PeopleWell"===t&&this.addPeopleWellStateActions(e.externalUxCommand,n,i)}}return i},t.getEnabledDisabledActionBasedOnChildrenCommands=function(e,t,n){var i=new Array(0),r={};switch(t){case"FlyoutAnchorModel":r=appChrome.selectors.getFlyoutAnchorMenuItems(e);break;case"SplitButtonModel":var a=appChrome.selectors.getSplitButtonState(e),o=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(a.command);if(o){var s=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,o.commandId,n);i.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(e,!s)),i.push(vn(e,!1))}return i;default:return null}var l=!1;for(var c in r){var u={key:c,value:r[c]},d=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(u.key);if(zt.c(d))l=!0;else if(n.SourceControlId=d.externalUxCommand,this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,d.commandId,n))return i.push(vn(e,!1)),i}return i.push(vn(e,!l)),i},t.getStateActionsForContainerModelType=function(e,t,n){switch(t){case"PreviewGalleryModel":return this._reactGalleryPoller.getPreviewGalleryQueryCommandActions(e,n);case"GalleryModel":return this._reactGalleryPoller.getGalleryQueryCommandActions(n)}return null},t.isContainerModelType=function(e){return"GalleryModel"===e||"PreviewGalleryModel"===e},t.getPollResult=function(e,t){return t.MenuItemId=e.menuItemId,this._rootPoller.pollForCommandState(this._rootUser,this._rootType,e.commandId,e.queryCommandId,t)},t.addPeopleWellStateActions=function(e,t,n){var i=t[pn.a.LabelText],r=t[pn.a.LabelTextUserGeneratedPlaceholderReplacements],a=i;return r&&r.length>0&&(a=String.format.apply(null,[a].concat(r))),n.push(this.getUpdatePeopleWellAction(e,a)),n},t.getUpdatePeopleWellAction=function(e,t){return appChrome.actions.updatePeopleWell(this.getCoauthorsInfo(e),t)},t.getCoauthorsInfo=function(e){var t=new Array(0),n={},i=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e).populationProps.populateQueryCommandId;this._rootPoller.pollForCommandState(this._rootUser,this._rootType,"1285265560",i,n);var r=n.MenuItems;if(!r)return t;for(var a=r.MenuSectionList[0],o=0;o<a.ControlList.length;o++){var s=a.ControlList[o],l={};l.name=s.Alt,l.id=s.MenuItemId,l.description=s.Description,l.color=s.ImageBackColor,l.joinTime=s.JoinTimeInMS,l.imageUrl=s.ImageUrl,l.activeStatus=s.ActiveStatus,l.isAnonymous=s.IsAnonymous,l.canJump=s.CanJump,l.chatCapable=s.ChatCapable,l.upn=s.Upn,t.push(l)}return t},e}();Object(i.a)(ii,"ReactQueryCommandPoller",null,[]);var ri=n(345);function ai(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return oi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function oi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var si=function(){function e(e,t,n){this._externalUICommandDefinitionMapping=e,this._rootUser=t;var i=new ri.a;this._statePropsSelector=new ti,this._reactGalleryPoller=new Pn(i,this._rootUser,n,this._externalUICommandDefinitionMapping),this._reactPopulateQueryCommandPoller=new ni(i,this._rootUser,n,this._externalUICommandDefinitionMapping,this._reactGalleryPoller),this._queryCommandPoller=new ii(i,this._rootUser,this._externalUICommandDefinitionMapping,n,this._reactGalleryPoller)}var t=e.prototype;return t.getPollForStateAndUpdateActions=function(){var e=new Array(0);if(!It.appChromeAlreadyLoaded())return e;e.push.apply(e,this.getUpdateContextualTabsActions());var t=this.getDisableControlsInTabsActions(appChrome.selectors.getSelectedTabId());if(t.length>0)e.push.apply(e,t);else{var n=appChrome.selectors.getActiveControlIds();if(Object.keys(n).length){for(var i,r=ai(this.getDisabledControlsInGroups(appChrome.selectors.getActiveGroupIds()));!(i=r()).done;){var a=i.value;e.push(appChrome.actions.updateControlEnabledDisabledState(a,!0)),delete n[a]}e.push.apply(e,this.getUpdateActionsForCommands(n))}}return e},t.getGroupedPollForStateAndUpdateActions=function(){var e=new Array(0);if(!It.appChromeAlreadyLoaded())return e;e[e.length]=this.getUpdateContextualTabsActions();var t=this.getGroupedDisableControlsInTabActions(appChrome.selectors.getSelectedTabId());if(!(t.length>0)){for(var n,i=appChrome.selectors.getActiveControlIds(),r=appChrome.selectors.getActiveGroupIds(),a=this.getRibbonControlsToDisableMap(r),o=ai(r);!(n=o()).done;){for(var s,l=n.value,c=new Array(0),u=ai(appChrome.selectors.getVisibleControlsInGroup(l));!(s=u()).done;){var d=s.value,p=i[d];a[d]?c.push(appChrome.actions.updateControlEnabledDisabledState(d,!0)):c.push.apply(c,this.getUpdateActionsForCommand(d,p)),delete i[d]}e[e.length]=c}return e[e.length]=this.getUpdateActionsForCommands(i),e}return e.push.apply(e,t),e},t.pollForStateAndUpdateCommands=function(e,t){if(It.appChromeAlreadyLoaded()){var n=this.getUpdateActionsForCommands(e,t);appChrome.api.dispatch(n)}},t.populateControlMenu=function(e,t,n){if(void 0===n&&(n=null),!zt.c(e)&&e.populationProps&&!this._reactPopulateQueryCommandPoller.skipPopulation(e)){var i,r=this._reactPopulateQueryCommandPoller.getReduxActionsAndCommandsToPoll(e,t,n);if(!r.wasShadowMenuOpen)(i=r.actions).push.apply(i,this.getUpdateActionsForCommands(r.commandsToPoll,It.getUILocationFromPayload(n)));if(r.actions.length>0)return appChrome.api.dispatch(r.actions),!0}return!1},t.getUpdateActionsForCommands=function(e,t){void 0===t&&(t=0);var n=new Array(0);for(var i in e){var r={key:i,value:e[i]};n.push.apply(n,this.getUpdateActionsForCommand(r.key,r.value,t))}return n},t.getUpdateActionsForCommand=function(e,t,n){void 0===n&&(n=0);var i=new Array(0),r=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e),a={};if(appChrome.selectors.isControlDefined(e)&&(a=this._statePropsSelector.getStateProps(e,t)),a[xt.uiLocation]=n,zt.c(r)){a.ExternalUxId=e;var o=this._queryCommandPoller.getEnabledDisabledActionBasedOnChildrenCommands(e,t,a);o&&o.length>0&&i.push.apply(i,o)}else a.MenuItemId=r.menuItemId,a.SourceControlId=e;return i.push.apply(i,this._queryCommandPoller.getReduxActions(r,t,a)),i},t.getUpdateContextualTabsActions=function(){var e=new Array(0),t=!!l.AFrameworkApplication.appSettingsManager&&l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactRibbonDispatchActionFilter"),n=appChrome.selectors.getContextualTabIds(),i=[];t&&(i=appChrome.selectors.getActiveContextualTabIds());for(var r=0;r<n.length;r++){var a=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(n[r]);if(a){var o=this._rootUser.isRootCommandEnabled(a),s=!0;t&&(s=Array.indexOf(i,n[r])>=0),t&&s===o||e.push(appChrome.actions.activateDeactivateContextualTab(n[r],o))}}return e},t.getDisableControlsInTabsActions=function(e){var t=new Array(0),n=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(e);n&&(this._rootUser.isRootCommandEnabled(n)||t.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(e,!0)));return t},t.getGroupedDisableControlsInTabActions=function(e){var t=new Array(0),n=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(e);if(n&&!this._rootUser.isRootCommandEnabled(n))for(var i,r=ai(appChrome.selectors.getActiveGroupIds());!(i=r()).done;){for(var a,o=i.value,s=new Array(0),l=ai(appChrome.selectors.getVisibleControlsInGroup(o));!(a=l()).done;){var c=a.value;s.push(appChrome.actions.updateControlEnabledDisabledState(c,!0))}t[t.length]=s}return t},t.getRibbonControlsToDisableMap=function(e){for(var t,n={},i=ai(this.getDisabledControlsInGroups(e));!(t=i()).done;){n[t.value]=!0}return n},t.getDisabledControlsInGroups=function(e){for(var t,n=new Array(0),i=ai(e);!(t=i()).done;){var r=t.value,a=this._externalUICommandDefinitionMapping.getGroupsMetadataByExternalUxId(r);if(a)for(var o,s=ai(a);!(o=s()).done;){var l=o.value;if(!this._rootUser.isRootCommandEnabled(l.commandId)){var c=l.externalUxCommandIds;c||(c=appChrome.selectors.getVisibleControlsInGroup(l.externalUxGroupId)),n.push.apply(n,c)}}}return n},t.getDisableControlsInGroupsActions=function(e){for(var t,n=new Array(0),i=ai(e);!(t=i()).done;){var r=t.value,a=this._externalUICommandDefinitionMapping.getGroupsMetadataByExternalUxId(r);if(a)for(var o,s=ai(a);!(o=s()).done;){var l=o.value;if(!this._rootUser.isRootCommandEnabled(l.commandId))if(l.externalUxCommandIds)for(var c,u=ai(l.externalUxCommandIds);!(c=u()).done;){var d=c.value;n.push(appChrome.actions.updateControlEnabledDisabledState(d,!0))}else n.push(appChrome.actions.updateDisabledEnabledStateForControlsInGroup(l.externalUxGroupId,!0))}}return n},e}();function li(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(si,"ReactRibbonRootPoller",null,[233]);var ci=function(){function e(e,t,n){void 0===n&&(n=null),this._reactRibbonRootPoller=null,this._lastPollTime=null,this._rootUser=null,this._reactCommandDefinitionMapping=t,e.addRoot(this),this.rootUser=n}var t,n,i,r=e.prototype;return r.commitAnyPendingChange=function(){var e=document.activeElement;w.DomUtils.isEditable(e)&&e.blur()},r.executeCommand=function(e,t,n,i,r,a,o,s){if(void 0===s&&(s=2),!zt.c(this.rootUser)){var l=new Qt.a;l.CommandLocation=s,l.InvocationMethod=i,l.CommandTabName=n,this.checkFloodgateSurveyInfo(),t[xt.uiLocation]=s,this.rootUser.executeRootCommand(e,t,l,a,o)}},r.getPollForStateAndUpdateActions=function(){return zt.c(this.rootUser)?new Array(0):this.reactRibbonRootPoller.getPollForStateAndUpdateActions()},r.getGroupedPollForStateAndUpdateActions=function(){return zt.c(this.rootUser)?new Array(0):this.reactRibbonRootPoller.getGroupedPollForStateAndUpdateActions()},r.pollForStateAndUpdate=function(){var e=this.getPollForStateAndUpdateActions();e.length>0&&(this.lastPollTime=new Date,appChrome.api.dispatch(e))},r.updatePeopleWellControl=function(){if(It.appChromeAlreadyLoaded()){var e={PeopleWell:"PeopleWell"};this.reactRibbonRootPoller.pollForStateAndUpdateCommands(e,18)}},r.updateDocChatControl=function(){if(It.appChromeAlreadyLoaded()){var e={DocChat:"ButtonModel"};this.reactRibbonRootPoller.pollForStateAndUpdateCommands(e,18)}},r.updateControl=function(e){},r.checkFloodgateSurveyInfo=function(){var e=le.a.instance.tryResolve("Common.ISystemInitiatedFeedback");e?e.logActivity("SLRCommandUsed","FGSLRUsageEnabled"):v.ULS.sendTraceTag(36741406,340,50,"ISystemInitiatedFeedback was null")},t=e,(n=[{key:"lastPollTime",get:function(){return this._lastPollTime||(this._lastPollTime=new Date,this._lastPollTime.setTime(0)),this._lastPollTime},set:function(e){this._lastPollTime=e}},{key:"rootType",get:function(){return 2}},{key:"rootUser",get:function(){return this._rootUser},set:function(e){this._rootUser=e}},{key:"reactRibbonRootPoller",get:function(){return this._reactRibbonRootPoller||(this._reactRibbonRootPoller=new si(this._reactCommandDefinitionMapping,this.rootUser,this.rootType)),this._reactRibbonRootPoller}}])&&li(t.prototype,n),i&&li(t,i),e}();Object(i.a)(ci,"ReactRibbonRoot",null,[70,214]);var ui=n(141),di=n(203),pi=n(206),hi=n(351),mi=n(355),gi=function(){this.scriptBaseUrl=null,this.isMLRRibbonMode=!1};Object(i.a)(gi,"IntlBootResourcesOptions",null,[]);var fi=function(){function e(){}return e.getAppChrome=function(t){void 0===t&&(t=!0);var n,i=le.a.instance.resolve("Common.IDynamicScriptLoaderProvider").getScriptLoader();return n=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")?e.getRibbonLoaderPromise(i).then((function(e){return null})):e.getLoadAppResourceLoaderPromise(i).then((function(t){return e.getRibbonLoaderPromise(i)})),!e.isAppChromeInitialized&&t&&(n=n.then((function(){It.initializeAppChrome(i),e.isAppChromeInitialized=!0}))),n},e.getLoadAppResourceLoaderPromise=function(e){return e.loadScript("appResourceLoader").catch((function(e){return v.ULS.sendTraceTag(50456130,340,10,"Failed to load the resources for AppResourceLoader")}))},e.getRibbonLoaderPromise=function(e){var t=new Tt.a,n=l.AFrameworkApplication.staticContentScriptNameBase+l.AFrameworkApplication.lcid+"/";pt.a.isEnabled&&(n=pt.a.getLocalizationPath(l.AFrameworkApplication.lcid));var i=Object.assign(new gi,{scriptBaseUrl:n,isMLRRibbonMode:l.AFrameworkApplication.activeFrame.applicationInstance.shouldRenderReactMultilineRibbon});return t.add(appResourceLoader.loadIntlBootResources(i).catch((function(e){return v.ULS.sendTraceTag(50456131,340,10,"Failed to load the resources for IntlBoot")}))),t.add(e.loadScript("appChrome").catch((function(e){return v.ULS.sendTraceTag(50456132,340,10,"Failed to load the resources for AppChrome")}))),Promise.all(t.toArray())},e.preloadUIResourceScripts=function(){le.a.instance.resolve("Common.IDynamicScriptLoaderProvider").getScriptLoader().preloadScript("appResourceLoader")},e}();fi.isAppChromeInitialized=!1,Object(i.a)(fi,"AppChromeProvider",null,[]);var vi=n(138),_i=n(168),yi=function(){};yi.getAccessibilityHelpButtonId="jbtnAccessibilityHelp",yi.getAccessiblePdfLinkButtonId="jbtnAccessibility",yi.toggleCommentPaneButtonId="btnOpenCommentPane",yi.toggleSearchPaneButtonId="btnOpenSearchPane",yi.toggleWordViewerModeButtonId="jbtnToggleViewMode",Object(i.a)(yi,"AccessibilityModeIds",null,[]);var bi=function(){};bi.toolbarDownloadWithWordButtonId="btnDownloadWithWord",bi.toolbarOverflowDownloadWithWordButtonId="overflowbtnDownloadWithWord",bi.toolbarDownloadPdfButtonId="btnDownloadPdf",bi.toolbarDownloadWordDocAsPdfButtonId="jbtnDownloadAsPdf",bi.toolbarDownloadATranslatedCopy="jbtnDownloadATranslatedCopy",Object(i.a)(bi,"DownloadButtonIds",null,[]);var Si=function(){};Si.yammerButtonId="btnToggleYammerPanel",Si.fileVersionButtonId="jbtnFileVersion",Si.jewelFileSharingButtonId="jbtnFileSharing",Si.toolbarFileSharingButtonId="btnFileSharing",Si.privacyButtonId="jbtnPrivacy",Si.reportAbuseButtonId="jbtnReportAbuse",Si.termsOfUseButtonId="jbtnTermsOfUse",Si.giveFeedbackButtonId="jbtnGiveFeedback",Si.closeButtonId="btnjClose",Si.translateButtonId="jbtnTranslateDocument",Si.trustCenterButtonId="jbtnTrustCenter",Object(i.a)(Si,"FeatureButtonIds",null,[]);var Ci=function(){};Ci.toolbarConvertToPdfPrintButtonId="btnPrintToPdf",Ci.toolbarDirectPrintButtonId="btnDirectPrint",Ci.toolbarPrintPdfButtonId="btnPrintPdfFile",Ci.toolbarDirectPrintPdfButtonId="btnDirectPrintPdfMode",Ci.jewelPrintSubMenuId="faPrint",Object(i.a)(Ci,"PrintButtonIds",null,[]);var Ai=function(e,t){if(l.AFrameworkApplication.trimOICButtons||l.AFrameworkApplication.limitedEdit)e.flyoutWordViewerEdit=!0,e.flyoutWordViewerOpen=!0,e.btnOpenInClient=!0,!l.AFrameworkApplication.limitedEdit&&t&&n(14).App.interactiveViewIsEnabled||(e.btnInteractiveViewOnWeb=!0);else if(t){if(n(14).App.canEdit||n(14).App.isReviewer){var i=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsOwaUnifiedFlightEnabled"),r=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsUIEmbedMode");l.AFrameworkApplication.disableEditIfAndroid||i&&r?e.flyoutWordViewerEdit=!0:e.btnOpenInClient=!0,e.flyoutWordViewerOpen=!0}else n(14).App.interactiveViewIsEnabled?(e.flyoutWordViewerEdit=!0,e.btnOpenInClient=!0):(e.flyoutWordViewerEdit=!0,e.flyoutWordViewerOpen=!0);e.btnInteractiveViewOnWeb=!0,e.btnConvertToEditOnWeb=!0,e.btnCopyAndEdit=!0,e.btnEditOnWeb=!0}else e.flyoutWordViewerEdit=!0,e.flyoutWordViewerOpen=!0,e.btnInteractiveViewOnWeb=!0},Ii=function(e,t,i,r){!l.AFrameworkApplication.copyAndEditUrl||l.AFrameworkApplication.protectFile||r?t&&(n(14).App.canEdit||n(14).App.isReviewer)?i?(e.btnEditOnWeb=!0,e.btnCopyAndEdit=!0,e.btnPdfCopyAndEdit=!0,e.btnFlyoutEditOnWeb=!0,e.btnFlyoutCopyAndEdit=!0,e.btnSaveToCloudStorage=!0):(e.btnConvertToEditOnWeb=!0,e.btnPdfConvertAndEdit=!0,e.btnCopyAndEdit=!0,e.btnPdfCopyAndEdit=!0,e.btnFlyoutConvertToEditOnWeb=!0,e.btnFlyoutCopyAndEdit=!0,e.btnSaveToCloudStorage=!0):(e.btnConvertToEditOnWeb=!0,e.btnPdfConvertAndEdit=!0,e.btnCopyAndEdit=!0,e.btnPdfCopyAndEdit=!0,e.btnEditOnWeb=!0,e.sep1=!0):(e.btnConvertToEditOnWeb=!0,e.btnPdfConvertAndEdit=!0,e.btnFlyoutConvertToEditOnWeb=!0,e.btnEditOnWeb=!0,e.btnFlyoutEditOnWeb=!0,l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")&&"HMWeb"===l.AFrameworkApplication.appSettingsManager.appSettings.FileSource||(e.btnSaveToCloudStorage=!0))},wi=n(253),Ti=n(134),Ei=n(252),ki=n(91);function Mi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pi,Fi,Di,Oi,Ri=function(){function e(){}var t,i,r;return e.registerActions=function(){var e=[new wi.a(f.a.showCommentPane,ze.a.application,0),new wi.a(Ve.a.toggleCommentPane,ze.a.application,0)];Ti.a.enqueueActions(e,Ei.a.create("dll1",null,(function(){return Promise.all([n.e(2),n.e(1)]).then(n.bind(null,526))})))},t=e,r=[{key:"hideCommentsButtonFromRibbon",get:function(){var e=n(14).App.instance;if(e){var t=!e.fileTypeSupportsCommenting||!e.userCanComment&&!l.AFrameworkApplication.useRedeemForCommentingPostMessage,i=!ki.a.instance.hasComments&&n(14).App.instance.accessibleModeEnabled;return t||i}return!1}}],(i=null)&&Mi(t.prototype,i),r&&Mi(t,r),e}();function xi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(Ri,"CommentManagerStub",null,[]);var Ui=function(){function e(e,t,i,r){var a=this;this._theToolbar=null,this._theStandaloneRoot=null,this._topRowControls=null,this._appChromePromise=null,this._reactRoot=null,this._unregisterBindCommandHandlerAction=null,this._reactToolbar=null;var o=n(238).AppFrame,s=n(238).AppFrame;if(null==e)throw Error.argumentNull("hostingAppFrame");this._hostingAppFrame=e,(l.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled||_i.a.isReactStatusBarEnabled||Ye.isReactToolbarEnabled)&&this.initReactCommandingEnvironment();var c=new L.CuiHelper(vi.a.wordViewerImageBase,WordViewerIntl.WordViewerStrings);l.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled||(this.createStandaloneRoot(),this._topRowControls=c.createTopRowControls("toolbar",t,null,this._theStandaloneRoot,!0)),this._theViewerChrome=new N.a(t,"toolbar",r,l.AFrameworkApplication.hideHeader,l.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled,Ye.isReactToolbarEnabled),l.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled&&this._appChromePromise.then((function(){var e=new bt,t=appChrome.renderSharedHeader(a._theViewerChrome.peripheralContentContainer,e.getProps());l.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderPlaceholderEnabled&&t.then((function(){appChrome.getHeaderApi().then((function(e){return e.dismissPlaceholder()}))}))})),this.initializeRibbonToolbar(r,i,c),z.a.initializeCuiScope(o.ribbonFocusId,null,this._theViewerChrome.toolbarContentContainer,!1,!0,!this._hostingAppFrame.wordViewerApp.isAccessiblePdfMode,!this._hostingAppFrame.wordViewerApp.isAccessiblePdfMode),z.a.initializeCuiScope(s.headerUiFocusId,null,this._theViewerChrome.peripheralContentContainer,!1,!0,!this._hostingAppFrame.wordViewerApp.isAccessiblePdfMode,!this._hostingAppFrame.wordViewerApp.isAccessiblePdfMode)}var t,i,a,o=e.prototype;return o.initReactCommandingEnvironment=function(e){var t=this;void 0===e&&(e=null),this._appChromePromise=fi.getAppChrome(!1),this._appChromePromise.then((function(){appChrome.setAppSettings(l.AFrameworkApplication.appSettingsManager.appSettings),It.setFeatureGateManager(),appChrome.api.setWebpackPublicPath(l.AFrameworkApplication.staticContentScriptNameBase),ut.a.get_instance().setAppInitializationStatus(7),appChrome.setScriptLoader(Object(r.d)(le.a.instance.resolve("Common.IDynamicScriptLoaderProvider").getScriptLoader(),le.a.instance.resolve("Common.IDynamicScriptLoaderProvider").getScriptLoader().loadScript,"loadScript")),appChrome.registerInitialAppSprites(),t._reactRoot=new ci(ui.a.instance,le.a.instance.resolve("Common.IExternalUICommandDefinitionMapping"),t);var e=document.createElement("div");document.body.appendChild(e);var n=new Gt(t._reactRoot,t._reactRoot.reactRibbonRootPoller,le.a.instance.resolve("WordViewer.WordViewerReactCommandDefinitionMapping"),l.AFrameworkApplication.activeFrame.theFocusManager,e,null,null,l.AFrameworkApplication.theActionManager,null);t._unregisterBindCommandHandlerAction=appChrome.api.bindCommandHandler((function(e,t){n.executeCommand(e,t)}));var i=new ee.a(3,1,0,(function(e){t.initializeLazyAppSprite()}));wt.a.instance.addTask(i)})),(_i.a.isReactStatusBarEnabled||Ye.isReactToolbarEnabled)&&de.UISurfaces.setAppChromeProviderDelegate((function(){return t._appChromePromise}))},o.initializeLazyAppSprite=function(){appChrome.getLazyAppSpriteInitActions().then((function(e){return appChrome.api.dispatch(e),null}))},o.initializeRibbonToolbar=function(e,t,n){var i=this;if(Ye.isReactToolbarEnabled)window.setTimeout((function(){ut.a.get_instance().executeWhen(7,(function(){i._reactToolbar=new Ye(i._theViewerChrome.toolbarContainer,i.getToolbarEnabledIds(t),i._reactRoot),i._reactToolbar.poll()}))}),0);else{var r=new hi.a;r.clientID="toolbar",r.staticUiTouchMode=this._hostingAppFrame.isStaticUiTouchMode,r.supportsEmphasizedControls=!0,r.trimmedIds=this.getLegacyToolbarTrimmedIds(t);var a=new mi.a(r,this._theViewerChrome.toolbarContainer,this,e);a.dataSource=new Pt.a("WordViewerToolbarData",n),a.buildToolbar(),this._theToolbar=a.toolbar,this._theToolbar.rootUser=this,this._theToolbar.refresh(),this._theViewerChrome.scale(),this.poll()}},o.getToolbarEnabledIds=function(t){var i,r=l.AFrameworkApplication.protectFile||l.AFrameworkApplication.isEmbedded||!l.AFrameworkApplication.hostEmbeddedViewUrl&&!l.AFrameworkApplication.fileEmbedCommandUrl&&!l.AFrameworkApplication.useFileEmbedCommandPostMessage,a=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerLearningToolsIsEnabled"),o=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEduUser"),s=this._hostingAppFrame.wordViewerApp.isPdfMode,c=l.AFrameworkApplication.protectFile,u=!!this._hostingAppFrame.wordViewerApp.translationLanguage,d=l.AFrameworkApplication.disableEditIfAndroid,p=this._hostingAppFrame.wordViewerApp.supportsEditing,h=(l.AFrameworkApplication.limitedEdit,l.AFrameworkApplication.trimOICButtons,l.AFrameworkApplication.trimDownloadACopy),m=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordDownloadAsPdfIsEnabled"),g=l.AFrameworkApplication.downloadCopyOnOpenInClient,f=this._hostingAppFrame.wordViewerApp.userMayEnterAccessiblePdfMode,v=this._hostingAppFrame.wordViewerApp.isAccessiblePdfMode,_=((i={}).jbtnToggleViewMode=f,i.btnLaunchImmersiveViewEdu=a&&o,i.flyoutWordViewerEdit=!s&&!d,i.btnPdfConvertAndEdit=s&&this._hostingAppFrame.wordViewerApp.userCanWriteRelative&&!d,i.btnPdfCopyAndEdit=s&&this._hostingAppFrame.wordViewerApp.userCanWriteRelative&&!d,i.btnOpenInClient=!s&&!u,i.btnInteractiveViewOnWeb=!s&&!d,i.btnEditOnWeb=!s&&!d,i.btnConvertToEditOnWeb=!s&&!d,i.btnCopyAndEdit=!s,i.btnSaveAndEdit=this._hostingAppFrame.wordViewerApp.userCanSaveAndEditTranslatedDocument,i.jbtnTranslateDocumentBack=u,i.btnDownloadWithWord=!h&&!s&&!u&&g,i.btnSaveToCloudStorage=!u&&!F.a.isMobile&&l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled"),i.PrintUnified=this._hostingAppFrame.wordViewerApp.showPrint&&!c,i.btnjClose=!0,i.HostConversation=!0,i.HostOpenInBrowser=!0,i.btnFileSharing=!u&&l.AFrameworkApplication.fileShareEnabled,i.btnFlyoutEditOnWeb=!0,i.btnFlyoutConvertToEditOnWeb=!0,i.btnFlyoutCopyAndEdit=!0,i.btnEditInClient=!0,i.MoreViewerOptionsFlyoutAnchor=!0,i.btnOpenCommentPane=!(s||Ri.hideCommentsButtonFromRibbon||f&&v),i.btnOpenSearchPane=!f||!v,i.btnLaunchImmersiveViewNonEdu=a&&!o,i.jbtnTranslateDocument=!(c||u||s||!n(14).App.instance.translationLanguages||!n(14).App.instance.translationLanguages.length),i.jbtnFileVersion=!u&&(!!l.AFrameworkApplication.fileVersionUrl||l.AFrameworkApplication.useFileVersionPostMessage),i.overflowbtnDownloadWithWord=!(h||s||u||g),i.jbtnDownloadATranslatedCopy=!h&&u,i.btnDownloadPdf=!h&&s&&!u,i.jbtnDownloadAsPdf=!h&&!s&&m,i.jbtnFileEmbed=!u&&!r,i.jbtnHelp=!0,i.jbtnAccessibilityHelp=f&&l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled"),i.jbtnGiveFeedback=l.AFrameworkApplication.showFeedbackButton,i.btnjTryOffice=!!t.officeTrialExperience&&t.officeTrialExperience.offerOfficeTrialInFileMenu,i.btnjTryMacOffice=!!t.macOfficeOffer&&t.macOfficeOffer.shouldOfferMacOfficeTrialInFileMenu,i.jbtnTermsOfUse=!!l.AFrameworkApplication.termsUrl,i.jbtnPrivacy=!!l.AFrameworkApplication.privacyUrl,i.jbtnAccessibility=!s&&!c&&!f,i.jbtnAccessibilityPdf=s&&!c,i.btnSyncToPresenter=this._hostingAppFrame.wordViewerApp.isBroadcastMode,i.btnOpenSharedNotes=this._hostingAppFrame.wordViewerApp.isBroadcastMode,i.jbtnTrustCenter=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled"),i.jbtnSwitchToUnifiedReadMode=Fe.a(),i),b={};Ii(b,p,this._hostingAppFrame.editNeedsConversion,u),Ai(b,p),Mt.trimAllHostControls(b),b.btnjClose=!y.includeCloseButton(),Mt.updateTrimmingOfHostProvidedUIControls(e.hostControlsToLegacyControlsMap,b);for(var S=0,C=Object.keys(_);S<C.length;S++){var A=C[S];(!_[A]||b[A]&&_[A])&&delete _[A]}return _},o.getLegacyToolbarTrimmedIds=function(t){var i={};return Mt.trimAllHostControls(i),function(e,t,n,i,r,a){e[bi.toolbarDownloadWithWordButtonId]=t||n||a||!r,e[bi.toolbarDownloadPdfButtonId]=t||!n||a,e[bi.toolbarOverflowDownloadWithWordButtonId]=t||n||a||r,e[bi.toolbarDownloadWordDocAsPdfButtonId]=t||n||!i,e[bi.toolbarDownloadATranslatedCopy]=t||!a}(i,l.AFrameworkApplication.trimDownloadACopy,this._hostingAppFrame.wordViewerApp.isPdfMode,l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordDownloadAsPdfIsEnabled"),l.AFrameworkApplication.downloadCopyOnOpenInClient,!!this._hostingAppFrame.wordViewerApp.translationLanguage),this._hostingAppFrame.wordViewerApp.isPdfMode?(i.jbtnAccessibility=!0,i.flyoutWordViewerEdit=!0,i.flyoutWordViewerOpen=!0,i.btnInteractiveViewOnWeb=!0,i.btnOpenInClient=!0,i.btnOpenCommentPane=!0,i.btnEditOnWeb=!0,i.btnConvertToEditOnWeb=!0,i.btnCopyAndEdit=!0,i.sep1=!0):(i.btnPdfConvertAndEdit=!0,i.btnPdfCopyAndEdit=!0,i.jbtnAccessibilityPdf=!0),function(e,t,n,i){t?(e[yi.getAccessiblePdfLinkButtonId]=!0,n&&(e[yi.toggleCommentPaneButtonId]=!0,e[yi.toggleSearchPaneButtonId]=!0)):e[yi.toggleWordViewerModeButtonId]=!0,i&&t||(e[yi.getAccessibilityHelpButtonId]=!0)}(i,this._hostingAppFrame.wordViewerApp.userMayEnterAccessiblePdfMode,this._hostingAppFrame.wordViewerApp.isAccessiblePdfMode,l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled")),function(e,t,n,i){e[Ci.toolbarConvertToPdfPrintButtonId]=!i||n||t,e[Ci.toolbarDirectPrintButtonId]=!i||n||!t,e[Ci.toolbarPrintPdfButtonId]=!i||!n||t,e[Ci.toolbarDirectPrintPdfButtonId]=!i||!n||!t}(i,l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DirectPrintIsEnabled"),this._hostingAppFrame.wordViewerApp.isPdfMode,this._hostingAppFrame.wordViewerApp.showPrint),this._hostingAppFrame.wordViewerApp.showPrint||(i.PrintUnified=!0),function(e){e[Si.yammerButtonId]=!l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("YammerIsEnabled"),e[Si.fileVersionButtonId]=!l.AFrameworkApplication.fileVersionUrl&&!l.AFrameworkApplication.useFileVersionPostMessage,e[Si.jewelFileSharingButtonId]=!l.AFrameworkApplication.fileShareEnabled,e[Si.toolbarFileSharingButtonId]=!l.AFrameworkApplication.fileShareEnabled,e[Si.privacyButtonId]=!l.AFrameworkApplication.privacyUrl,e[Si.reportAbuseButtonId]=!l.AFrameworkApplication.reportAbuseUrl,e[Si.termsOfUseButtonId]=!l.AFrameworkApplication.termsUrl,e[Si.giveFeedbackButtonId]=!l.AFrameworkApplication.showFeedbackButton,e[Si.closeButtonId]=!y.includeCloseButton(),e[Si.trustCenterButtonId]=!l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled"),e[Si.translateButtonId]=n(14).App.instance.isPdfMode||!n(14).App.instance.translationLanguages||!n(14).App.instance.translationLanguages.length}(i),Ii(i,this._hostingAppFrame.wordViewerApp.supportsEditing,this._hostingAppFrame.editNeedsConversion,!!this._hostingAppFrame.wordViewerApp.translationLanguage),Ai(i,this._hostingAppFrame.wordViewerApp.supportsEditing),F.a.isMobile&&(i.btnSaveToCloudStorage=!0),l.AFrameworkApplication.protectFile&&(i.PrintUnified=!0,i.btnPrintToPdf=!0,i.jbtnPrintPdfFile=!0,i.btnPrintPdfFile=!0,i.jbtnAccessibility=!0,i.jbtnAccessibilityPdf=!0,i.jbtnTranslateDocument=!0),(l.AFrameworkApplication.protectFile||l.AFrameworkApplication.isEmbedded||!l.AFrameworkApplication.hostEmbeddedViewUrl&&!l.AFrameworkApplication.fileEmbedCommandUrl&&!l.AFrameworkApplication.useFileEmbedCommandPostMessage)&&(i.jbtnFileEmbed=!0),t.officeTrialExperience&&t.officeTrialExperience.offerOfficeTrialInFileMenu||(i.msJewelTryOffice=!0,i.btnjTryOffice=!0,v.ULS.shipAssertTag(5838167,301,!!t.officeTrialExperience)),t.macOfficeOffer&&t.macOfficeOffer.shouldOfferMacOfficeTrialInFileMenu||(i.msJewelTryMacOffice=!0,i.btnjTryMacOffice=!0,v.ULS.shipAssertTag(5838168,301,!!t.macOfficeOffer)),this._hostingAppFrame.wordViewerApp.translationLanguage?(i.jbtnFileProperties=!0,i.jbtnFileVersion=!0,i.btnOpenInClient=!0,i.btnFileSharing=!0,i.jbtnBroadcast=!0,i.jbtnFileEmbed=!0,i.jbtnTranslateDocument=!0,i.btnSaveToCloudStorage=!0):i.jbtnTranslateDocumentBack=!0,this._hostingAppFrame.wordViewerApp.userCanWriteRelative||(i.btnPdfConvertAndEdit=!0,i.btnPdfCopyAndEdit=!0),Ri.hideCommentsButtonFromRibbon&&(i.btnOpenCommentPane=!0),l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")||(i.btnSaveToCloudStorage=!0),this._hostingAppFrame.wordViewerApp.isBroadcastMode?(i.jbtnTranslateDocument=!0,i.jbtnTranslateDocumentBack=!0,i.jbtnBroadcast=!0,i.btnFileSharing=!0,i.btnOpenInClient=!0,i.btnDownloadWithWord=!0,i.btnDownloadPdf=!0,i.sep1=!0,i.msJewelTryMacOffice=!0,i.btnjTryMacOffice=!0,i.msJewelTryOffice=!0,i.btnjTryOffice=!0,i.btnjTryO14=!0,i.msJewelProperties=!0,i.jbtnFileEmbed=!0,i.btnCopyAndEdit=!0,i.btnConvertToEditOnWeb=!0,i.btnPdfConvertAndEdit=!0,i.btnPdfCopyAndEdit=!0,i.btnEditOnWeb=!0,i.btnOpenSearchPane=!0,i.jbtnFileVersion=!0,i.btnjClose=!0,i.jbtnAccessibility=!0,i.jbtnAccessibilityPdf=!0,i.jbtnReportAbuse=!0,i.btnSaveToCloudStorage=!0):(i.btnSyncToPresenter=!0,i.btnOpenSharedNotes=!0),l.AFrameworkApplication.disableEditIfAndroid&&(this._hostingAppFrame.wordViewerApp.isPdfMode?(i.btnPdfConvertAndEdit=!0,i.btnPdfCopyAndEdit=!0):(i.btnEditOnWeb=!0,i.flyoutWordViewerEdit=!0,i.flyoutWordViewerOpen=!0,i.btnInteractiveViewOnWeb=!0,i.btnFlyoutEditOnWeb=!0,i.btnFlyoutConvertToEditOnWeb=!0,i.btnFlyoutCopyAndEdit=!0,i.btnConvertToEditOnWeb=!0)),l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerLearningToolsIsEnabled")?l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEduUser")?i.btnLaunchImmersiveViewNonEdu=!0:i.btnLaunchImmersiveViewEdu=!0:(i.btnLaunchImmersiveViewEdu=!0,i.btnLaunchImmersiveViewNonEdu=!0),l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled")||(i.jbtnTrustCenter=!0),i.btnSaveAndEdit=!this._hostingAppFrame.wordViewerApp.userCanSaveAndEditTranslatedDocument,Mt.updateTrimmingOfHostProvidedUIControls(e.hostControlsToLegacyControlsMap,i),i},o.createStandaloneRoot=function(){var e=new pi.a;e.ImageUpArrow=e.ImageDownArrow=e.ImageSideArrow=l.AFrameworkApplication.imageClusterPath,e.ImageUpArrowClass=ie.getImageClass("RibbonUpArrow_5x3x32"),e.ImageDownArrowClass=ie.getImageClass("SplitButtonArrow_5x3x32"),e.ImageSideArrowClass=ie.getImageClass("SubmenuFlyoutArrow_13x13x32"),e.TextDirection=l.AFrameworkApplication.isRtl?"rtl":"ltr",this._theStandaloneRoot=new di.a("TheStandaloneRoot",e),this._theStandaloneRoot.rootUser=this,this._theStandaloneRoot.refresh()},o.dispose=function(){this._theToolbar&&(this._theToolbar.dispose(),this._theToolbar=null),this._theViewerChrome&&(this._theViewerChrome.dispose(),this._theViewerChrome=null),this._theStandaloneRoot&&(this._theStandaloneRoot.dispose(),this._theStandaloneRoot=null),this._topRowControls&&(L.CuiHelper.disposeTopRowControls(this._topRowControls),this._topRowControls=null)},o.poll=function(){this._theToolbar&&this._theToolbar.pollForStateAndUpdate(),this._theStandaloneRoot&&this._theStandaloneRoot.pollForStateAndUpdate(),this._reactToolbar&&this._reactToolbar.poll()},o.executeRootCommand=function(e,t,n,i,r){if(void 0===i&&(i=null),void 0===r&&(r=null),l.AFrameworkApplication.isShuttingDown)return!1;var a=parseInt(e);var o=null;switch(a){case f.a.close:o=At.b;break;case Ve.a.toggleSearchPane:case Ve.a.toggleCommentPane:o=new Ct.a(o,n.InvocationMethod);break;default:o=t}var s=l.AFrameworkApplication.theActionManager;return n&&(s.commandLocation=n.CommandLocation,s.invocationMethod=n.InvocationMethod),32===s.processActionWithData(a,2,o,r)},o.isRootCommandEnabled=function(e,t){if(void 0===t&&(t=null),l.AFrameworkApplication.isShuttingDown)return!1;if(!e)return!0;var n=parseInt(e);return 32===l.AFrameworkApplication.theActionManager.processAction(n,1)},o.onComponentBuilt=function(e,t){e.rootUser=this},e.ribbonScopeSetFocus=function(e,t){var i=n(14).App.get_activeAppFrame();i&&i.ribbonUser&&i.ribbonUser.theToolbar&&i.ribbonUser.theToolbar.pollForStateAndUpdate()},t=e,(i=[{key:"reactRibbonRoot",get:function(){return this._reactRoot}},{key:"theToolbar",get:function(){return this._theToolbar}},{key:"theViewerChrome",get:function(){return this._theViewerChrome}}])&&xi(t.prototype,i),a&&xi(t,a),e}();Ui.hostControlsToLegacyControlsMap=((Pi={}).close=((Oi=new Tt.a).add("btnjClose"),Oi),Pi.conversation=((Di=new Tt.a).add("HostConversation"),Di),Pi.ellipsisOpenInBrowser=((Fi=new Tt.a).add("HostOpenInBrowser"),Fi),Pi),Object(i.a)(Ui,"RibbonUser",null,[48,183,4]);var Bi=n(395),Li=n(353),Ni=n(111),Hi=function(){function e(){var e=n(14).App;if(e.get_activeAppFrame().businessBar){var t=new B.a(WordViewerIntl.WordViewerStrings.l_TranslatedDocumentBusinessBarTitle,n(14).App.get_activeAppFrame().wordViewerApp.userCanSaveAndEditTranslatedDocument?WordViewerIntl.WordViewerStrings.l_TranslatedDocumentBusinessBarDescription:"",null);t.closeable=!0,t.image=3,e.get_activeAppFrame().businessBar.addEntry(t,!0)}}return e.prototype.navigateToOriginalDocument=function(e){Ni.a.navigateToOriginalDocument()},e}();Object(i.a)(Hi,"TranslatedDocumentBusinessBar",null,[]);var Wi=n(148),ji=n(37),Vi=n(352),Ki=n(254);function zi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"AppFrame",(function(){return Gi}));var Gi=function(e){var t,i;function c(t,i,o){var d;(d=e.call(this,t,i)||this)._isDisposed$4=!1,d._theRibbonUser=null,d._clientEditDocumentUrl=null,d._wordEditorUrl=null,d._hostViewUrl=null,d._hostEditUrl=null,d._editNeedsConversion=!1,d._isTranslatorRedirect=!1,d._ribbonPanel=null,d._theStatusBarUser=null,d._notificationBar=null,d._translatedDocumentBusinessBar=null,d._readonlyBusinessBar=null,d._updateCommandUITask=null,d._isSearchPaneVisible=!1,d._isCommentPaneVisible=!1,d._isSearchPaneTouchMode=!1,d._isCommentPaneTouchMode=!1,d._shouldLoadViewerWarningBusinessBar=!0,d._onEditCommand=0,d._wordViewerApp=null,d._workspace=null,d._postMessenger=null,d._theContextMenu=null,d.thePageInfoCache=null;var p=n(14).App,h=n(14).App,m=n(14).App,v=Object(a.a)(n(14).App,t);if(d.set_wordViewerApp(v||m.instance),!Ae.a.isInitialized){var _=document.createElement("div");h.InitializeHtmlScratchPadProvider(_),i.appendChild(_)}d.wordViewerApp.isScreenReaderPresent=d.highContrastDetector.isScreenReaderPresent,document.body.setAttribute(oe.a.ariaRoleAttribute,oe.a.ariaApplicationRole),u.F6Manager.enabled=!0,d.wordViewerApp.isAccessiblePdfMode||(d.theF6Manager.f6KeyInput=Q.KeyInputManager.hashKey(G.a.VK_F6,Q.KeyInputManager.commandKeyModifier),d.theF6Manager.f6ShiftKeyInput=Q.KeyInputManager.hashKey(G.a.VK_F6,4|Q.KeyInputManager.commandKeyModifier)),d.theF6Manager.bindFocusToBrowser(s.AFrame.appFocusId);var y=[c.headerUiFocusId,X.a.meControlFlexPaneFocusId,c.ribbonFocusId,P.a.businessBarFocusID,Bi.a.searchFocusID,s.AFrame.documentFocusID,s.AFrame.commentPaneFocusId,s.AFrame.flexPaneFocusId,q.a.debugFocusId,X.a.chatFocusId,c.statusBarFocusId];d.theF6Manager.initializeOrder(y),l.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady&&d.updateFullSettings(o),d.wordEditorUrl=o.WordEditorUrl,d.webServiceBase=o.WebServiceBase;var S=!1,C=document.getElementById("FirstPageImage");if(C&&C.firstPageDisplayed&&(S=!0),d.wordViewerApp.isSmallView?Sys.UI.DomElement.addCssClass(d.get_element(),"Embed"):l.AFrameworkApplication.isNoChrome||(d._ribbonPanel=document.createElement("div"),d._ribbonPanel.id=c.ribbonPanelId,d._ribbonPanel.className="WACRibbonPanel",S&&(d._ribbonPanel.style.top=-d.upperRibbonHeight+"px"),d.get_element().appendChild(d._ribbonPanel),d.tryInitializeToolbar(),d._isSearchPaneTouchMode=d.isStaticUiTouchMode,d._isCommentPaneTouchMode=d.isStaticUiTouchMode),d.theKeyInputManager.registerHandler(k.EventNames.keyPress,document.body,Object(r.d)(qi(d),d.showViewerWarningBusinessBar,"showViewerWarningBusinessBar")),d.theCompositionEventManager.registerHandler(k.EventNames.compositionStart,document.body,Object(r.d)(qi(d),d.showViewerWarningBusinessBar,"showViewerWarningBusinessBar"),null),!d.wordViewerApp.isCoreMode){var A=d.statusBarPanel;S&&(A.style.height="0",F.a.setOpacity(A,0)),d._theStatusBarUser=new _i.a(A,qi(d),p.instance),_i.a.isReactStatusBarEnabled&&(A.style.height="inherit",Sys.UI.DomElement.addCssClass(A,"reactStatusBar")),z.a.initializeCuiScope(c.statusBarFocusId,Object(r.d)(qi(d),d.statusBarScopeSetFocus,"statusBarScopeSetFocus"),A,!1,!0,!d.wordViewerApp.isAccessiblePdfMode,!d.wordViewerApp.isAccessiblePdfMode)}if(d.switchToMode(1),d.theActionManager.addActionWithFlags(Ve.a.binaryConvert,ze.a.application,Object(r.d)(qi(d),d.onBinaryConvert,"onBinaryConvert"),96),d.theActionManager.addAction(Ve.a.openInWordViewer,ze.a.application,Object(r.d)(qi(d),d.onOpenInWordViewer,"onOpenInWordViewer")),d.theActionManager.addActionWithFlags(f.a.alwaysEnabled,ze.a.application,V.ActionManager.doNothingHandler,96),d.theActionManager.addAction(Ve.a.translateDocument,ze.a.application,Object(r.d)(qi(d),d.onTranslateDocument,"onTranslateDocument")),d.theActionManager.addAction(Ve.a.translateBackToOriginal,ze.a.application,Object(r.d)(qi(d),d.onTranslateBack,"onTranslateBack")),d.theActionManager.addAction(Ve.a.downloadATranslatedCopy,ze.a.application,Object(r.d)(qi(d),d.onDownloadATranslatedCopy,"onDownloadATranslatedCopy")),d.theActionManager.addAction(Ve.a.saveAndEditATranslatedCopy,ze.a.application,Object(r.d)(qi(d),d.onSaveAndEditATranslatedCopy,"onSaveAndEditATranslatedCopy")),d.theActionManager.addAction(Ve.a.hideAllPanes,g.a.frame,Object(r.d)(qi(d),d.hideAllPanes,"hideAllPanes")),d.theActionManager.addAction(Ve.a.handleEscKeyDown,g.a.frame,Object(r.d)(qi(d),d.handleEscKeyDown,"handleEscKeyDown")),d.theActionManager.addAction(Ve.a.showPdfConvertAndEditDialog,ze.a.application,Object(r.d)(qi(d),d.onShowPdfConvertAndEditDialog,"onShowPdfConvertAndEditDialog")),function(e){if(!n(14).App.instance.isAccessiblePdfMode){var t=e.getScope(s.AFrame.appFocusId);t.bindAction(Q.KeyInputManager.hashKeyString(WordViewerIntl.WordViewerStrings.l_HK_Find),Ve.a.showSearchPane),t.bindAction(Q.KeyInputManager.hashKey(G.a.VK_F3,0),Ve.a.showSearchPane),F.a.isFirefox&&(t.bindAction(Q.KeyInputManager.hashKey(G.a.vK_SingleQuote,0),Ve.a.showSearchPane),t.bindAction(Q.KeyInputManager.hashKey(G.a.vK_Slash,0),Ve.a.showSearchPane),t.bindAction(Q.KeyInputManager.hashKey(G.a.VK_F3,4),Ve.a.showSearchPane),t.bindAction(Q.KeyInputManager.hashKey(G.a.VK_G,4|Q.KeyInputManager.commandKeyModifier),Ve.a.showSearchPane))}}(d.theFocusManager),J.Redirect.application=2,J.Redirect.registerActions(ze.a.application),d._disableFocus=Boolean.parse(o.WordViewerFocusDisabled||"false"),d._disableFocusOnBoot=Boolean.parse(o.DisableFocusOnBoot||"false"),d._showCommentPaneOnBoot=Boolean.parse(o.ShowCommentsOnBoot||"false"),d.theErrorHandler=new Vi.a,d.theErrorHandler.register(d.thePageManager),oe.a.registerHelpActionAndShortcut(ze.a.application,i),S){var I=new ee.a(2,1,100,(function(){Wi.a.animateChromeInWordViewer(d.upperRibbonHeight,_i.a.isReactStatusBarEnabled?Li.a.reactStatusBarHeight:s.AFrame.statusBarHeight)}));0,l.AFrameworkApplication.theTaskManager.addTask(I)}return b.a.initSignOutResponseUI(qi(d),Object(r.d)(d.applicationInstance,d.applicationInstance.onAuthenticationLost,"onAuthenticationLost"),Object(r.d)(d.applicationInstance,d.applicationInstance.onAuthenticationRestored,"onAuthenticationRestored"),d.canUseAppAfterAuthLost),d}i=e,(t=c).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var p,h,m,_=c.prototype;return _.set_workspace=function(e){return this._workspace=e,e},_.set_wordViewerApp=function(e){return this._wordViewerApp=e,e},_.updateFullSettings=function(e){var t=n(14).App;if(this.wordViewerApp.printingEnabled){var i=document.createElement("a");i.innerText=WordViewerIntl.WordViewerStrings.l_AccessibilityLink,i.href="javascript:;",i.id=Ge.a.accessibilityLinkId,i.className=Ge.a.accessibilityLinkHiddenClass,this.get_element().insertBefore(i,this.get_element().firstChild)}this.clientEditDocumentUrl=e.EditDocInClientUrl,this.clientEditDocumentUrl||(l.AFrameworkApplication.isOpenInClientEnabled=!1),this.hostViewUrl=e.HostViewUrl,this.hostEditUrl=e.HostEditUrl,this.editNeedsConversion="true"===e.ConvertToEdit,t.interactiveViewIsEnabled="true"===e.InteractiveViewIsEnabled},_.tryInitializeToolbar=function(){var e=new Oe(l.AFrameworkApplication.appSettingsManager,this.theActionManager,this.theFocusManager);if(e.areReady())this.initializeToolbarInternal(e,null);else{var t=L.CuiHelper.createEmptyHeaderAndToolbar(l.AFrameworkApplication.hideHeader);this._ribbonPanel.appendChild(t),this._ribbonPanel.style.height=N.a.calculateToolbarWithTopBarHeight(l.AFrameworkApplication.hideHeader,l.AFrameworkApplication.hasExternalHeader)+"px",e.waitForReady(Object(r.d)(this,this.initializeToolbarInternal,"initializeToolbarInternal"),t)}},_.initializeToolbarInternal=function(e,t){t&&L.CuiHelper.disposeEmptyHeaderAndToolbar(t),this._theRibbonUser=new Ui(this,this._ribbonPanel,e,this),this._ribbonPanel.style.height=this._theRibbonUser.theViewerChrome.toolbarWithTopbarHeight+"px"},_.updateCommandUI=function(e){var t=this;void 0===e&&(e=!1),this._updateCommandUITask||(this._updateCommandUITask=new ee.a(2,1,25,(function(e){t.onUpdateCommandUI()}),45),l.AFrameworkApplication.theTaskManager.addTask(this._updateCommandUITask))},_.onUpdateCommandUI=function(){var e=K.a.instance.startActivity(f.a.updateCommandUI);this._updateCommandUITask=null,this.statusBarUser&&this.statusBarUser.poll(),e.end()},_.showViewerWarningBusinessBar=function(e){var t=n(14).App,i=n(14).App;if(void 0!==this.theFocusManager.currentScope&&null!==this.theFocusManager.currentScope&&void 0!==this.theFocusManager.currentScope.name&&null!==this.theFocusManager.currentScope.name&&s.AFrame.documentFocusID===this.theFocusManager.currentScope.name&&"input"!==e.sourceElement.tagName.toLowerCase()){if(!t.get_activeAppFrame().businessBar||this.wordViewerApp.translationLanguage||!this._shouldLoadViewerWarningBusinessBar||e.innerEvent.ctrlKey||e.innerEvent.rawEvent.metaKey||e.innerEvent.altKey||e.innerEvent.charCode===G.a.vK_Enter)return!1;var a,o=this.wordViewerApp.supportsEditing&&(n(14).App.canEdit||n(14).App.isReviewer);a=o?this.wordViewerApp.isPdfMode?WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarMessagePdf:WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarMessage:this.wordViewerApp.isPdfMode?WordViewerIntl.WordViewerStrings.L_ViewerWarningDisabledEditBusinessBarMessagePdf:WordViewerIntl.WordViewerStrings.L_ViewerWarningDisabledEditBusinessBarMessage;var l=new B.a(WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarTitle,a,null);o&&(this.wordViewerApp.isPdfMode?l.addButton(WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarButtonPdf,Object(r.d)(this,this.navigateToEditor,"navigateToEditor"),""):l.addButton(WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarButton,Object(r.d)(this,this.navigateToEditor,"navigateToEditor"),"")),l.closeable=!0,l.image=3,i.get_activeAppFrame().businessBar.addEntry(l,!0);var c=d.FocusManager.instance().getRegion(P.a.businessBarFocusID);return c&&(c.contained=!this.wordViewerApp.isAccessiblePdfMode,c.looped=!this.wordViewerApp.isAccessiblePdfMode),this._shouldLoadViewerWarningBusinessBar=!1,!0}return!1},_.navigateToEditor=function(e){var t=null;if(this.setOnEditCommand(),this._onEditCommand===f.a.copyAndEdit){var n;(n={}).targetWacAction="Edit",t=n;var i=this.getTopParagraphId();i&&(t.wdparams="wd=pid("+i+")")}l.AFrameworkApplication.theActionManager.processActionWithData(this._onEditCommand,2,t)},_.restoreFocusAfterDismissingPopup=function(t,n){1!==n?this.setFocusOnDocument():e.prototype.restoreFocusAfterDismissingPopup.call(this,t,n)},_.setFocusOnDocument=function(){this.theFocusManager.setScope(s.AFrame.documentFocusID)},_.updateOpenMenu=function(e){return!!this.ribbonUser&&!!this.ribbonUser.theToolbar&&this.ribbonUser.theToolbar.updateOpenMenu(e)},_.checkUnsupportedBrowserBusinessBarEntry=function(){if(this.businessBar&&this.shouldDisplayUnsupportedBrowserBusinessBar){var e=new B.a("",CommonUIStrings.l_UnsupportedBrowser,null);e.id=15,e.closeable=!0,J.Redirect.isHelpAvailable()&&e.addButton(WordViewerIntl.WordViewerStrings.l_LearnMore,Object(r.d)(this,this.unsupportedBrowserHandler,"unsupportedBrowserHandler"),""),this.businessBar.addEntry(e,!1)}},_.unsupportedBrowserHandler=function(e){if(l.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWoncaIE11SoftBlockCommercialSettings"),Z.c(f.a.newBrowserSuggestionClicked),l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IE11SoftBlockCommercialIsEnabled")){var t=l.AFrameworkApplication.appSettingsManager.getStringAppSetting("IE11SoftBlockCommercialUrlWord");we.a.safelyOpenWindow(t,"_blank",void 0,void 0,"AppFrame.UnsupportedBrowserLink")}else{var n=l.AFrameworkApplication.appSettingsManager.getStringAppSetting("IE11SoftBlockCommercialUrlDefault");we.a.safelyOpenWindow(n,"_blank",void 0,void 0,"AppFrame.UnsupportedBrowserLink")}},_.initializeAll=function(e){var t,i=this,r=n(14).App,a=n(14).App,o=n(14).App,c=n(14).App,u=n(14).App,p=n(14).App,h=n(14).App;if(this.shouldViewIrmProtectedDocuments&&l.AFrameworkApplication.protectFile)return je.a.showErrorDialogEx(ji.a.documentIsIRMProtected,CommonUIStrings.l_DefaultDialogTitle,WordViewerIntl.WordViewerStrings.l_DocumentProtectionSettingsEmbed),void je.a.propagateError(!0,"DocumentIsIRMProtected",ji.a.documentIsIRMProtected,WordViewerIntl.WordViewerStrings.l_DocumentProtectionSettingsEmbed);if(this.workspace.init(e),this.wordViewerApp.isSmallView||this.wordViewerApp.isAccessiblePdfMode||l.AFrameworkApplication.isNoChrome||(Ri.registerActions(),t=[new wi.a(Ve.a.showSearchPane,ze.a.application,0),new wi.a(Ve.a.toggleSearchPane,ze.a.application,0)],Ti.a.enqueueActions(t,Ei.a.create("dll1",null,(function(){return Promise.all([n.e(2),n.e(1)]).then(n.bind(null,526))})))),r.get_activeAppFrame().ribbonUser&&a.get_activeAppFrame().ribbonUser.poll(),o.get_activeAppFrame().statusBarUser&&c.get_activeAppFrame().statusBarUser.poll(),this._theContextMenu=new qe.a(this),!this.wordViewerApp.isSmallView&&!l.AFrameworkApplication.isNoChrome||this.wordViewerApp.showReadOnlyBusinessBar){if(this.set_businessBar(new U(this.workspace.appBaseDom,this.workspace.heightAboveAppBase)),e.insertBefore(this.businessBar.htmlElement,this.workspace.appBaseDom),!l.AFrameworkApplication.protectFile||""===this.wordViewerApp.irmPolicyTitle&&""===this.wordViewerApp.irmPolicyDescription){if(!this.wordViewerApp.showPrint&&""!==this.wordViewerApp.irmPolicyDescription){var m=new B.a("",this.wordViewerApp.irmPolicyDescription,null);m.closeable=!0,this.businessBar.addEntry(m,!0)}}else{var g=new B.a(this.wordViewerApp.irmPolicyTitle,this.wordViewerApp.irmPolicyDescription,null);g.closeable=!0,this.businessBar.addEntry(g,!0)}this.checkUnsupportedBrowserBusinessBarEntry()}this._notificationBar=Ce.createInstance(e,this.workspace.appBaseDom),this.wordViewerApp.showReadOnlyBusinessBar&&(this._readonlyBusinessBar=new et(this.wordViewerApp.kindOfReadOnlyBusinessBar)),this.wordViewerApp.translationLanguage&&(this._translatedDocumentBusinessBar=new Hi,l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WACTranslatorFloodgateCampaignEnabled")&&Ni.a.triggerFloodgateSurveyForTranslator()),u.get_activeAppFrame().notifyResize();var _=d.FocusManager.instance().getScope(s.AFrame.documentFocusID);_.parent=s.AFrame.mainAppFocusId,this._disableFocus||_.addSetFocus((function(e,t){try{if(i.wordViewerApp.isAccessiblePdfMode){var n=document.getElementById(i.workspace.theDisplayManager.outerElementID);n&&(document.body.blur(),window.self.blur(),Ye.isReactToolbarEnabled&&i._theRibbonUser&&i._theRibbonUser.theViewerChrome.toolbarContainer.click(),n.focus())}else document.body.focus(),window.self.focus()}catch(e){v.ULS.shipAssertTag(4318919,321,!1)}})),p.get_activeAppFrame().theF6Manager.addF6(s.AFrame.documentFocusID),h.instance.isSmallView||this._disableFocusOnBoot||d.FocusManager.instance().setScope(s.AFrame.documentFocusID),d.FocusManager.instance().defaultScopeName=s.AFrame.documentFocusID,d.FocusManager.instance().getScope(s.AFrame.appFocusId).bindAction(Q.KeyInputManager.hashKey(G.a.vK_Esc,0),Ve.a.handleEscKeyDown),this.setOnEditCommand(),this._showCommentPaneOnBoot&&l.AFrameworkApplication.theActionManager.processAction(f.a.showCommentPane,2),this.checkDynamicWebCampaignActivities()},_.checkDynamicWebCampaignActivities=function(){try{var e=l.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId");if(!e||-1===e.toLowerCase().indexOf("floodgateflight"))return;var t=le.a.instance.resolveFuture("Common.ISystemInitiatedFeedback");if(!t)return void v.ULS.sendTraceTag(592537824,301,10,"ISystemInitiatedFeedback was null");t.execute((function(e){e&&e.logActivity("DynamicWebCampaignFloodgateFlightActivity",null)}))}catch(e){v.ULS.sendTraceTag(592537823,301,10,"Error checking web campaign activity",e?e.toString():null)}},_.setOnEditCommand=function(){var e=n(14).App,t=n(14).App,i=n(14).App;l.AFrameworkApplication.copyAndEditUrl?this._onEditCommand=f.a.copyAndEdit:e.instance.supportsEditing?i.get_activeAppFrame().editNeedsConversion?this._onEditCommand=Ve.a.binaryConvert:this._onEditCommand=Ve.a.switchToEditMode:t.interactiveViewIsEnabled?this._onEditCommand=Ve.a.switchToEditMode:this._onEditCommand=0},_.dispose=function(){this._isDisposed$4||(this._notificationBar&&(this._notificationBar.dispose(),this._notificationBar=null),this._theContextMenu&&(this._theContextMenu.dispose(),this._theContextMenu=null),this.workspace&&(this.workspace.dispose(),this.set_workspace(null)),this._theRibbonUser&&(this._theRibbonUser.dispose(),this._theRibbonUser=null),this._theStatusBarUser&&(this._theStatusBarUser.dispose(),this._theStatusBarUser=null),this._translatedDocumentBusinessBar=null,this.theKeyInputManager.unregisterHandler(k.EventNames.keyPress,document.body,Object(r.d)(this,this.showViewerWarningBusinessBar,"showViewerWarningBusinessBar")),this.theCompositionEventManager.unregisterHandler(k.EventNames.compositionStart,document.body,Object(r.d)(this,this.showViewerWarningBusinessBar,"showViewerWarningBusinessBar")),e.prototype.dispose.call(this),this._isDisposed$4=!0)},_.statusBarScopeSetFocus=function(e,t){var n=this.theFocusManager.getRegion(c.statusBarFocusId);n&&n.moveIntoFromTop()},_.refreshDocument=function(e){var t=n(14).App;if(l.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady)if(32!==l.AFrameworkApplication.theActionManager.processActionWithData(f.a.raiseActionToHost,2,Ee.a.refresh)){var i="";l.AFrameworkApplication.isEmbedded?(i=l.AFrameworkApplication.hostEmbeddedViewUrl,this.wordViewerApp.showPrint||(i=Ie.a.addOrReplaceParameterValue(i,"wdPrint","0")),this.wordViewerApp.showEmbed||(i=Ie.a.addOrReplaceParameterValue(i,"wdEmbedCode","0"))):i=this.hostViewUrl,this.wordViewerApp.userMayEnterAccessiblePdfMode&&(i=t.updateUrlForAccessiblePdfMode(i,this.wordViewerApp.isAccessiblePdfMode));var r=this.getTopParagraphId();r&&(i=Ie.a.addOrReplaceParameterValue(i,"wdparaid",r)),this.isCommentPaneVisible&&(i=Ie.a.addOrReplaceParameterValue(i,"wdcomments","1")),l.AFrameworkApplication.isControllerServicesQueryParamNeeded&&(i=Ie.a.addOrReplaceParameterValue(i,l.AFrameworkApplication.controllerServicesParamName,"1")),we.a.safelyOpenWindow(i,"_parent",void 0,void 0,"WordViewer.AppFrame.RefreshDocument")}else v.ULS.sendTraceTag(41972614,301,50,"WordViewer.AppFrame.RefreshDocument - sending refresh request to the host instead.");else v.ULS.sendTraceTag(5560476,301,15,"WordViewer.AppFrame.RefreshDocument tried to refresh page before full app settings ready.")},_.makeStopwatchBuilder=function(){return new Pe},_.showSearchPane=function(e){var t=n(14).App;3===e?this._isSearchPaneTouchMode=!0:2===e&&(this._isSearchPaneTouchMode=!1),this._isSearchPaneVisible=!0,t.get_activeAppFrame().notifyResize()},_.hideSearchPane=function(){var e=n(14).App;this._isSearchPaneVisible=!1,e.get_activeAppFrame().notifyResize()},_.showCommentPane=function(e){var t=n(14).App;3===e?this._isCommentPaneTouchMode=!0:2===e&&(this._isCommentPaneTouchMode=!1),this._isCommentPaneVisible=!0,t.get_activeAppFrame().notifyResize()},_.hideCommentPane=function(){var e=n(14).App;this._isCommentPaneVisible=!1,e.get_activeAppFrame().notifyResize()},_.hideAllPanes=function(e,t,n,i,r){return 1===n||(l.AFrameworkApplication.theActionManager.processAction(Ve.a.hideSearchPane,2),l.AFrameworkApplication.theActionManager.processActionWithData(f.a.hideCommentPane,2,!0),d.FocusManager.instance().setScope(s.AFrame.documentFocusID)),32},_.propagateEscKeyEventToHost=function(){var e;this.postMessenger.sendMessage(W.a.browserEvent,((e={}).type="keydown",e.keyCode=G.a.vK_Esc,e.altKey=!1,e.ctrlKey=!1,e.metaKey=!1,e.shiftKey=!1,e))},_.getTopParagraphId=function(){if(!this.wordViewerApp.theDocument.pageCount)return null;var e=this.wordViewerApp.zoomControl.currentZoom,t=this.wordViewerApp.scrollControl.getScrollTop(),i=ki.a.instance.getPageFromScrollTop(t,e),r=ki.a.instance.getPageTopAtZoom(i,e),a=n(14).App.get_activeAppFrame().thePageInfoCache.getPage(i),o=(t-r)/e,s=ki.a.instance.getPageWidthAtZoom(i,1),l=ki.a.instance.getPageHeightAtZoom(i,1);var c=Ki.b(0,s,o,l,i,a),u=c&&c.length>0?c[0]:null;u||(u=(c=Ki.b(0,s,0,o,i,a))&&c.length>0?c[c.length-1]:null);var d=null;if(u){0;var p=u.parentNode;p&&"P"===p.nodeName&&p.attributes.getNamedItem("id")&&(d=p.attributes.getNamedItem("id").nodeValue)}return d},_.onBinaryConvert=function(e,t,n,i,r){if(t.contextId!==ze.a.application)return 2;if(!this.editNeedsConversion)return 8;if(1===n)return 32;var a=(new Date).getTime();return $.a.instance.recordEditClickedInWebApp(a),l.AFrameworkApplication.useEditModePostMessage?j(l.AFrameworkApplication.hostPostmessenger,a):(Ke.launch(),32)},_.onOpenInWordViewer=function(e,t,i,r,a){var o=n(14).App;if(t.contextId!==ze.a.application)return 2;if(!this._hostViewUrl)return 8;if(2===i){var s=this._hostViewUrl;this.wordViewerApp.userMayEnterAccessiblePdfMode&&(s=o.updateUrlForAccessiblePdfMode(s,this.wordViewerApp.isAccessiblePdfMode)),we.a.safelyOpenWindow(s,void 0,void 0,void 0,"OpenInWordViewer")}return 32},_.onTranslateDocument=function(e,t,n,i,r){return t.contextId!==ze.a.application?2:(1===n||Ni.a.launchDialog(),32)},_.onTranslateBack=function(e,t,n,i,r){return this._isTranslatorRedirect=!0,1===n?32:this.wordViewerApp.translationFromEditor?this.switchIntoEditMode(n,null,!1):(Ni.a.navigateToOriginalDocument(),32)},_.switchIntoEditMode=function(e,t,i,r){void 0===r&&(r=!1);var a=n(14).App;if(t&&!this.wordEditorUrl&&!l.AFrameworkApplication.useEditModePostMessage)return 8;if(t&&!a.instance.supportsEditing)return 8;if(1===e)return 32;if(2!==e)return v.ULS.sendTraceTag(41170244,301,15,"Unexpected ActionBehavior {0} for switching to edit mode",e),2;var s=(new Date).getTime();if($.a.instance.recordEditClickedInWebApp(s),t&&l.AFrameworkApplication.useEditModePostMessage)return j(t,s);if(l.AFrameworkApplication.isEmbedded){var c=new Re.a,u=this.hostEditUrl;this._isTranslatorRedirect&&c.add("translatorRedirect","1"),l.AFrameworkApplication.isControllerServicesQueryParamNeeded&&c.add(l.AFrameworkApplication.controllerServicesParamName,"1"),Fe.b(l.AFrameworkApplication.appSettingsManager)?Fe.f("edit",c,Fe.d):(u=Ie.a.addOrReplaceParametersValue(u,c),we.a.safelyOpenWindow(u,void 0,void 0,void 0,"SwitchToEditMode.IsEmbed"))}else try{var d,p,h;this.generateEditUrlAndTarget(s,i,!0,r,Object(o.a)((function(){return p}),(function(e){return p=e})),Object(o.a)((function(){return h}),(function(e){return h=e})),Object(o.a)((function(){return d}),(function(e){return d=e}))),Fe.b(l.AFrameworkApplication.appSettingsManager)?Fe.f("edit",d,Fe.d):(p=Ie.a.addOrReplaceParametersValue(p,d),l.AFrameworkApplication.wasAuthenticationLostDuringSession?we.a.safelyOpenWindow(p,we.a.windowTargetToString(h),void 0,void 0,"SwitchToEditMode"):we.a.openWindow(h,p,void 0,void 0,Y.a.renavigate_AppModeSwitch)),l.AFrameworkApplication.isShuttingDown=!0}catch(e){}return 32},_.openNewWindowInEditMode=function(){try{var e,t,n,i=(new Date).getTime();this.generateEditUrlAndTarget(i,!1,!1,!1,Object(o.a)((function(){return e}),(function(t){return e=t})),Object(o.a)((function(){return t}),(function(e){return t=e})),Object(o.a)((function(){return n}),(function(e){return n=e}))),e=Ie.a.addOrReplaceParametersValue(e,n),we.a.safelyOpenWindow(e,we.a.windowTargetToString(4),void 0,void 0,"OpenNewWindowInEditMode")}catch(e){}},_.generateEditUrlAndTarget=function(e,t,i,r,a,o,s){var c=n(14).App,u=n(14).App,d=n(14).App;l.AFrameworkApplication.wasAuthenticationLostDuringSession||t?(a.val=this.hostEditUrl,o.val=3):(a.val=this.wordEditorUrl,o.val=1),s.val=new Re.a;var p=this.getTopParagraphId();if(p&&s.val.add("wdPid",p),s.val.add(l.AFrameworkApplication.modeSwitchTimeParamName,e.toString()),s.val.add(l.AFrameworkApplication.previousSessionParamName,l.AFrameworkApplication.userSessionId),s.val.add(te.a.userSessionDataParam,te.a.userSessionData),l.AFrameworkApplication.canSupportConsumption&&s.val.add(l.AFrameworkApplication.consumptionSupportedParamName,"1"),i){var h=l.AFrameworkApplication.appSettingsManager.getStringAppSetting(l.AFrameworkApplication.uiHostSettingName);h&&s.val.add(l.AFrameworkApplication.uiHostParamName,h)}else s.val.add(l.AFrameworkApplication.uiHostParamName,null);c.canEdit||u.isReviewer||!d.interactiveViewIsEnabled||(s.val.add("readOnly","1"),s.val.add("wdDoNotAutoNavigateToReadingView","1")),this._isTranslatorRedirect&&s.val.add("translatorRedirect","1"),l.AFrameworkApplication.isControllerServicesQueryParamNeeded&&s.val.add(l.AFrameworkApplication.controllerServicesParamName,"1"),l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UxBugFixesForCMFScenarioIsEnabled")&&(l.AFrameworkApplication.sessionContext&&s.val.add("sc",Te.a.urlKeyValueEncode(l.AFrameworkApplication.sessionContext)),l.AFrameworkApplication.hideHeader&&s.val.add("hh","1"),l.AFrameworkApplication.hideHeaderEmbedded&&s.val.add("hhdr","1"),l.AFrameworkApplication.isUIEmbedMode&&s.val.add("uiembed","1")),r&&s.val.add("readOnly","1")},_.onDownloadATranslatedCopy=function(e,t,n,i,r){return t.contextId!==ze.a.application?2:(1===n||Ni.a.downloadATranslatedCopy(),32)},_.onSaveAndEditATranslatedCopy=function(e,t,n,i,r){return t.contextId!==ze.a.application?2:(1===n||Ni.a.saveAndEditDialog(),32)},_.onShowPdfConvertAndEditDialog=function(e,t,n,i,r){return t.contextId!==ze.a.application?2:this.editNeedsConversion?1===n&&this.wordViewerApp.isProtectedPdf?8:(1===n||l.AFrameworkApplication.theActionManager.processAction(Ve.a.binaryConvert,2),32):8},_.handleEscKeyDown=function(e,t,n,i,r){return 1===n||(this.isSearchPaneVisible||this.isCommentPaneVisible?l.AFrameworkApplication.theActionManager.processAction(Ve.a.hideAllPanes,2):this.propagateEscKeyEventToHost()),32},p=c,(h=[{key:"workspace",get:function(){return this._workspace||(this._workspace=le.a.instance.resolve("WordViewer.Workspace"))}},{key:"postMessenger",get:function(){return this._postMessenger||(this._postMessenger=le.a.instance.resolve("WordViewer.IWordViewerPostMessenger"))}},{key:"modeName",get:function(){return this.wordViewerApp.isBroadcastMode?"Attendee":"View"}},{key:"state",get:function(){return this._frameState},set:function(e){var t;this._frameState=e;var n=((t={}).isDisabled=!!this._frameState,t);l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this.postMessenger.sendMessageWithRetry(W.a.frameStateChangeEvent,n):this.postMessenger.sendMessage(W.a.frameStateChangeEvent,n)}},{key:"ribbonPanel",get:function(){return this._ribbonPanel}},{key:"ribbonUser",get:function(){return this._theRibbonUser}},{key:"statusBarUser",get:function(){return this._theStatusBarUser}},{key:"contextMenuControl",get:function(){return this._theContextMenu}},{key:"notificationBar",get:function(){return this._notificationBar?this._notificationBar:null}},{key:"clientEditDocumentUrl",get:function(){return this._clientEditDocumentUrl},set:function(e){this._clientEditDocumentUrl=F.a.supportsOpenInClientForAllApps?e:null}},{key:"wordEditorUrl",get:function(){return this._wordEditorUrl},set:function(e){this._wordEditorUrl=e}},{key:"hostViewUrl",get:function(){return this._hostViewUrl},set:function(e){this._hostViewUrl=e}},{key:"hostEditUrl",get:function(){return this._hostEditUrl},set:function(e){this._hostEditUrl=e}},{key:"editNeedsConversion",get:function(){return this._editNeedsConversion},set:function(e){this._editNeedsConversion=e}},{key:"hasStatusBar",get:function(){return!this.wordViewerApp.isCoreMode}},{key:"wordViewerApp",get:function(){return this._wordViewerApp}},{key:"ribbonFocusScopeName",get:function(){return"NoOpWordViewerAppFrame"}},{key:"iE11SoftBlockIsEnabled",get:function(){return l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IE11SoftBlockIsEnabled")}},{key:"shouldDisplayUnsupportedBrowserBusinessBar",get:function(){return F.a.isInternetExplorer11Up&&l.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWoncaIE11SoftBlockSettings"),this.iE11SoftBlockIsEnabled?F.a.isInternetExplorerNonEdge:F.a.isInternetExplorerNonEdge&&!F.a.isInternetExplorer11Up}},{key:"shouldViewIrmProtectedDocuments",get:function(){return l.AFrameworkApplication.isEmbedded&&!l.AFrameworkApplication.isUIEmbedMode}},{key:"isSearchPaneVisible",get:function(){return this._isSearchPaneVisible}},{key:"isSearchPaneTouchMode",get:function(){return this._isSearchPaneTouchMode}},{key:"isCommentPaneVisible",get:function(){return this._isCommentPaneVisible}},{key:"isCommentPaneTouchMode",get:function(){return this._isCommentPaneTouchMode}}])&&zi(p.prototype,h),m&&zi(p,m),c}(y);Gi.ribbonPanelId="WACRibbonPanel",Gi.ribbonFocusId="ribbon",Gi.statusBarFocusId="statusbar",Gi.headerUiFocusId="headerui",Object(i.a)(Gi,"AppFrame",y,[])},function(e,t,n){"use strict";var i=n(0),r=n(1),a=n(2),o=n(75),s=n(40),l=n(7),c=function(){};function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}c.html="<div class='WACProgressRow' id='block1'> <img id='WACProgressImg' class='WACProgressIcon' role='presentation' /> <label id='WACProgressText' class='WACProgressTextPanel' >Loading</label> </div>",Object(i.a)(c,"ProgressDialogHtml",null,[]);var d=function(e){var t,n;function i(t){var n;return void 0===t&&(t=!1),(n=e.call(this)||this)._progressMessage=CommonUIStrings.l_DialogLoading,n._progressDialogHandler=null,n._progressDialogHandlerData=null,n.dialogId="ProgressDialog",n.buttonsOption=6,n.setButtonText(0,CommonUIStrings.l_DialogCancel),n._progressStatusAriaUpdateEnabled=t,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,o,d,p=i.prototype;return p.prepareDialog=function(){e.prototype.prepareDialog.call(this),this._progressStatusAriaUpdateEnabled&&(this._divMessageBox.setAttribute(l.a.ariaRoleAttribute,"progressbar"),this._divMessageBox.setAttribute(l.a.ariaValueMinAttribute,"0"),this._divMessageBox.setAttribute(l.a.ariaValueMaxAttribute,"100"),this._divMessageBox.setAttribute(l.a.ariaValueNowAttribute,"0")),this.dialogHtml=c.html,this._divMessageBox.style.minWidth="120px",this._divMessageBox.style.maxWidth="400px",this._buttonPanel.className="WACProgressButtonSection",this.setDescribedByForDialog("WACProgressText"),this.hasCloseGlyph||this.hasButtons?this._divMessageBox.style.minWidth="300px":(this._divMessageBoxTitle.style.display="none",this._buttonPanel.style.display="none"),this.hasButtons||(this._divMessageBox.tabIndex=0)},p.showProgressDialog=function(e,t,n){var i;this._progressDialogHandler=t,this._progressDialogHandlerData=n,this.initializeAndShow(e,Object(a.d)(this,this.baseDialogHandler$4,"baseDialogHandler$4"),((i={}).WACProgressText=this.message,i.WACProgressImg=s.a.commonImage("progress.gif"),i)),this._divMessageBox.style.width="auto",this.hasButtons||this._divMessageBox.focus()},p.showCustomizedProgressDialog=function(e,t,n){this.initializeAndShow(e,t,n)},p.updateAriaNowValue=function(e){this.isShowing&&this._divMessageBox&&this._divMessageBox.setAttribute(l.a.ariaValueNowAttribute,String.format("{0}",e))},p.close=function(){this.hide()},p.baseDialogHandler$4=function(e,t){this._progressDialogHandler&&this._progressDialogHandler(this._progressDialogHandlerData)},r=i,(o=[{key:"message",get:function(){return this._progressMessage},set:function(e){this._progressMessage=e}}])&&u(r.prototype,o),d&&u(r,d),i}(o.a);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(d,"ProgressDialog",o.a,[146]);var h=function(e){var t,n;function i(t){var n;return void 0===t&&(t=!1),(n=e.call(this,!1,!1,!0)||this)._progressMessage=CommonUIStrings.l_DialogLoading,n._progressDialogHandler=null,n._progressDialogHandlerData=null,n._title=null,n._valueNow=0,n.dialogId="ProgressDialog",n.buttonsOption=6,n._progressStatusAriaUpdateEnabled=t,n._progressStatusAriaUpdateEnabled&&(n._valueNow=0),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,o,s,l=i.prototype;return l.showProgressDialog=function(e,t,n){var i;this._title=e,this._progressDialogHandler=t,this._progressDialogHandlerData=n;var r=((i={}).id=this.dialogId,i.bodyControls=this.getProgressDialogProps(),i);this.initializeAndShow(this._title,Object(a.d)(this,this.baseDialogHandler$4,"baseDialogHandler$4"),r)},l.close=function(){this.hide()},l.showCustomizedProgressDialog=function(e,t,n){},l.updateAriaNowValue=function(e){var t;this._valueNow=e;var n=((t={}).id=this.dialogId,t.bodyControls=this.getProgressDialogProps(),t);this.updateDialog(this._title,Object(a.d)(this,this.baseDialogHandler$4,"baseDialogHandler$4"),n)},l.getProgressDialogProps=function(){var e,t={};if(t.spinnerProps=((e={}).type="AppSpinnerProps",e.label=this.message,e),this._progressStatusAriaUpdateEnabled){var n=t.spinnerProps;n.minValue=0,n.maxValue=100,n.valueNow=this._valueNow}return t},l.baseDialogHandler$4=function(e,t){this._progressDialogHandler&&this._progressDialogHandler(this._progressDialogHandlerData)},r=i,(o=[{key:"message",get:function(){return this._progressMessage},set:function(e){this._progressMessage=e}}])&&p(r.prototype,o),s&&p(r,s),i}(o.a);Object(i.a)(h,"ReactProgressDialog",o.a,[146]),n.d(t,"a",(function(){return m}));var m=function(){function e(){}return e.prototype.create=function(e){return void 0===e&&(e=!1),r.AFrameworkApplication.activeFrame&&r.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactProgressDialogIsEnabled")?new h(e):new d(e)},e}();Object(i.a)(m,"ProgressDialogFactory",null,[123])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r._touchClickAdapterCache="#t",r._touchAndHoldAdapterCache="#th",r._gestureAdapterCache="#g",r._dragAdapterCache="#d",Object(i.a)(r,"InputDataNameConstants",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(261);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,r,o;function s(){var t;return(t=e.call(this)||this).QueryCommand=null,t.Menu=null,t.PopulateOnlyOnce=!1,t.PopulateQueryCommand=null,t.MenuOpenCommand=null,t.MenuCloseCommand=null,t.ImageIsVisible=!1,t.Toggled=!1,t.ImageUsesSpaceWhileInvisible=!1,t.AriaLabel=null,t}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,(r=[{key:"ControlType",get:function(){return 9}}])&&a(i.prototype,r),o&&a(i,o),s}(r.a);Object(i.a)(o,"FlyoutAnchorProps",r.a,[])},function(e,t,n){"use strict";function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var a=function(e,t){return Array.contains(e,t)},o=function(e,t){for(var n,r=i(e);!(n=r()).done;){if(t(n.value))return!0}return!1},s=function(e,t){if(null==t)return[e];var n=1+t.length,i=new Array(n);i[0]=e;for(var r=1;r<n;r++)i[r]=t[r-1];return i}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.expirationOptions=null,this.onShow=null,this.telemetryId=null};Object(i.a)(r,"NotificationOptions",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(e){this._index=-1,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._array=e}var t=e.prototype;return t.get_current=function(){if(-1===this._index||this._index>=this._array.length)throw Error.invalidOperation();return this._array[this._index]},t.moveNext=function(){return this._index++,this._index<this._array.length},t.reset=function(){this._index=-1},t.next=function(){return this._index++,this._index<this._array.length?{done:!1,value:this._array[this._index]}:{done:!0,value:void 0}},e}();Object(i.a)(r,"ArrayEnumerator$1",null,[65])},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),r=n(11),a=n(2),o=n(223),s=n(93),l=function(){function e(){this._map=new Map,this.getEnumerator=this.getEnumerator$p}var t=e.prototype;return t.$$ge=function(){return s.select(s.fromIterator(Object(a.d)(this._map,this._map.entries,"entries")),(function(e){return new o.a(e[0],e[1])})).$$ge()},t.getEnumerator$p=function(){return this.$$ge()},t.get_count=function(){return this._map.size},t.get_keys=function(){return s.fromIterator(Object(a.d)(this._map,this._map.keys,"keys"))},t.get_values=function(){return s.fromIterator(Object(a.d)(this._map,this._map.values,"values"))},t.add=function(e,t){if(this._map.has(e))throw Error.create("DuplicateKeyException");this._map.set(e,t)},t.containsKey=function(e){return this._map.has(e)},t.remove=function(e){return!!this._map.has(e)&&(this._map.delete(e),!0)},t.tryGetValue=function(e,t,n){return void 0===n&&(n=null),this._map.has(e)?(t.val=this._map.get(e),!0):(t.val=n,!1)},t.get_item=function(e){var t;if(!this.tryGetValue(e,Object(r.a)((function(){return t}),(function(e){return t=e})),null))throw Error.create("KeyNotFoundException");return t},t.set_item=function(e,t){return this._map.set(e,t),t},t[Symbol.iterator]=function(){return Object(a.b)(this.getEnumerator())},e}();Object(i.a)(l,"IntegralDictionary",null,[55,35,1])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(41);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,o,s;function l(t,n,i,r,a,o,s,l){var c;return(c=e.call(this,t,a,l,3)||this)._timestamp=new Date,c._client=n,c._element=i,c._screen=r,c._caught=o,c.userData=s,c}return n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,l.create=function(e,t,n,i){var a=r.EventHandlerArgs.getSourceElement(i);return new l(e,r.EventHandlerArgs.getClientPointFromTouchEvent(i),null,r.EventHandlerArgs.getScreenPointFromTouchEvent(i),a,t,n,i)},i=l,(o=[{key:"action",get:function(){return this.eventName}},{key:"clientPoint",get:function(){return this._client}},{key:"screenPoint",get:function(){return this._screen}},{key:"elementPoint",get:function(){return this._element||(this._element=r.EventHandlerArgs.getElementPoint(this._client,this.sourceElement)),this._element}},{key:"caughtElement",get:function(){return this._caught}},{key:"timestamp",get:function(){return this._timestamp}}])&&a(i.prototype,o),s&&a(i,s),l}(r.EventHandlerArgs);Object(i.a)(o,"TouchEventArgs",r.EventHandlerArgs,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(9);var i=function(e){if(null!=e)switch(e.toString().toLowerCase()){case"4":case"mouse":return 4;case"3":case"pen":return 3;case"2":case"touch":return 2}return 0},r=function(e){var t=0;return e?t=e.rawEvent?i(e.rawEvent.pointerType):i(e.pointerType):t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h}));var i=n(100),r=n(1),a=n(55),o=n(71),s=n(4),l=n(25),c=n(20),u=n(7),d=n(8),p="btnToggleRibbon_Header",h=function(e){if(e){var t=document.createElement("div");t.id=p,t.className="cui-ctl-medium",t.title=CommonUIStrings.l_ToggleRibbonText;var n=a.createClusteredImage(40,20,i.c()?"Pill_Toggle_On_40x20x32":"Pill_Toggle_Off_40x20x32","",!0,null),r=document.createElement("span");r.id="btnToggleRibbonButton_Header",r.tabIndex=0,r.className="toggleButton-iconContainer",r.appendChild(n),r.setAttribute(u.a.ariaRoleAttribute,u.a.ariaButtonRole),r.setAttribute(u.a.ariaPressedAttribute,i.c()?u.a.ariaTrueValue:u.a.ariaFalseValue),r.setAttribute(u.a.ariaLabelledByAttribute,"btnToggleRibbonLabel_Header");var l=document.createElement("label");l.id="btnToggleRibbonLabel_Header",l.className="toggleButton-label",l.setAttribute("for","btnToggleRibbonButton_Header"),l.innerText=CommonUIStrings.l_ToggleRibbonText,t.appendChild(r),t.appendChild(l),e.appendChild(t),o.a.instance.registerHandler(s.EventNames.click,r,g),c.KeyInputManager.instance.registerHandler(s.EventNames.keyDown,r,m)}},m=function(e){return(e.innerEvent.keyCode===l.a.vK_Enter||e.innerEvent.keyCode===l.a.vK_Space)&&(r.AFrameworkApplication.theActionManager.processAction(d.a.toggleRibbonUXDialog,2),!0)},g=function(e){return r.AFrameworkApplication.theActionManager.processAction(d.a.toggleRibbonUXDialog,2),!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));n(9);var i=function(e){var t=0;switch(e){case"none":t=0;break;case"centimeter":t=1;break;case"character":t=2;break;case"inch":t=3;break;case"line":t=4;break;case"point":t=5;break;case"percent":t=6;break;case"pixels":t=7;break;case"timespan":t=8;break;case"degree":t=9;break;default:0,t=0}return t},r=function(e){switch(e){case 0:return"None";case 1:return"Centimeter";case 2:return"Character";case 3:return"Inch";case 4:return"Line";case 5:return"Point";case 6:return"Percent";case 7:return"Pixels";case 8:return"Timespan";case 9:return"Degree";default:return"None"}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(42);var a=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).elmButtonPart=null,n.elmMenuLauncherPart=null,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.onImageLoad=function(){this.internalImageLoadHandler()},r.internalImageLoadHandler=function(){},i}(r.a);Object(i.a)(a,"SplitButtonComponentDom",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(0),r=n(2),a=n(11),o=n(65),s=n(1),l=(n(9),n(116)),c=n(87),u=n(162),d=(n(5),n(6)),p=n(51);function h(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(e){var t,n;function i(t,n,r){var a;return(a=e.call(this,t,n,"","")||this)._overflowFlyoutAnchor=null,a.heroControlCount=i.defaultHeroControlCount,a.heroDockControls=new Array(0),a._heroDockProperties=r,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o,m,f,v=i.prototype;return v.refreshInternal=function(){this.refreshHeroDockVisuals(),e.prototype.refreshInternal.call(this)},v.ensureBehaviorAttached=function(){for(var t,n=h(this.heroDockControls);!(t=n()).done;){t.value.ensureBehaviorAttachedIfAvailable()}e.prototype.ensureBehaviorAttached.call(this)},v.splitHeroDockControls=function(e,t,n){e.val=new Array(0),t.val=new Array(0),n.val=new Array(0);for(var i=0;i<this.heroDockControls.length;i++){var a=this.heroDockControls[i];a.visible?e.val.length<this.heroControlCount?e.val.push(a):Object(r.c)(l.FlyoutAnchor,a)?Array.addRange(t.val,a.getControlsInFlyoutAnchorMenu()):t.val.push(a):n.val.push(a)}},v.createOverflowMenu=function(e){if(!e||!e.length)return null;for(var t,n={DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},i=new c.Menu(this.root,this.id+"OverflowMenu",null,null,null),r=new u.a(this.root,this.id+"OverflowMenuSection",null,null,n,i),a=h(e);!(t=a()).done;){var o=t.value;r.addChild(o.createComponentForDisplayMode("Menu20"))}return i.addChild(r),i},v.refreshHeroDockVisuals=function(){var e,t,n;this.removeChildren(),this.elementInternal=d.a.removeChildNodes(this.elementInternal),this.ensureDOMElement(),this.splitHeroDockControls(Object(a.a)((function(){return e}),(function(t){return e=t})),Object(a.a)((function(){return t}),(function(e){return t=e})),Object(a.a)((function(){return n}),(function(e){return n=e})));for(var i,r=h(e);!(i=r()).done;){var o=i.value.createComponentForDisplayMode("Medium20");o.enabled=!0,this.addChildAtIndex(o,this.children.count),this.elementInternal.appendChild(o.elementInternal),o.ensureRefreshed()}var c=this.createOverflowMenu(t);if(c){if(this._overflowFlyoutAnchor)this._overflowFlyoutAnchor.menu=c;else{0;var u=this.id+"OverflowMenuLauncher",p={};p.Image20by20=this._heroDockProperties.OverflowMenuImage20by20,p.Image20by20Class=this._heroDockProperties.OverflowMenuImage20by20Class,p.PopulateDynamically="false",p.HideDefaultArrow="true",p.Alt=this._heroDockProperties.OverflowMenuTooltip,p.Command="798637440",p.Id=u,this._overflowFlyoutAnchor=new l.FlyoutAnchor(this.root,u,p,c)}var m=this._overflowFlyoutAnchor.createComponentForDisplayMode("Small20");m.enabled=!0,this.addChildAtIndex(m,this.children.count),this.elementInternal.appendChild(m.elementInternal),m.ensureRefreshed()}if(s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(var g,f=h(n);!(g=f()).done;){var v=g.value.createComponentForDisplayMode("Medium20");this.addChild(v),v.ensureRefreshed()}},v.dispose=function(){this._overflowFlyoutAnchor&&(this._overflowFlyoutAnchor.dispose(),this._overflowFlyoutAnchor=null);for(var t,n=h(this.heroDockControls);!(t=n()).done;){t.value.dispose()}this.removeChildren(),e.prototype.dispose.call(this)},o=i,(m=[{key:"visibleInDOM",get:function(){return!0},set:function(e){Object(p.b)(i.prototype,this,"visibleInDOM",e)}},{key:"cssClass",get:function(){return"cui-herodock"}}])&&g(o.prototype,m),f&&g(o,f),i}(o.a);f.defaultHeroControlCount=4,Object(i.a)(f,"HeroDock",o.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(130);var a=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,null,null,0,null,1,null,null,null,!1,!1,null,!1,!1)||this)._dynamicImport=i,r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.addReference=function(){this.load()},r.reloadReference=function(){this.load()},r.load=function(){var e=this;this._dynamicImport().then((function(){e.scriptOnLoad(null)})).catch((function(t){return e.scriptOnError(null)}))},i.create=function(e,t,n){return new i(e,t,n)},i}(r.a);Object(i.a)(a,"WebpackScriptResourceWithAction",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(e,t,n){this._actionId=e,this._contextId=t,this._flags=n}var t,n,i;return t=e,(n=[{key:"actionId",get:function(){return this._actionId}},{key:"contextId",get:function(){return this._contextId}},{key:"flags",get:function(){return this._flags}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"CommandInfo",null,[])},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s}));n(9);var i=n(36),r=function(e){return String.format("/Pages/Page[@id='{0}']/descendant::P[@id='{1}']/T[1]",e,n(14).App.initialParagraphId.toString(16).toUpperCase())},a=function(e){for(var t=new Sys.UI.Point(0,0);e;)t.x+=e.offsetLeft,t.y+=e.offsetTop,isNaN(e.clientLeft)||(t.x+=e.clientLeft),isNaN(e.clientTop)||(t.y+=e.clientTop),e=e.offsetParent;return t},o=function(e,t,n,i,r,a){if(!a)return null;var o=String.format("/Pages/Page[@id='{0}']/*{1}/descendant-or-self::P/T[@l<={2} and (@l + @w)>={3} and @t<={4} and (@t + @h)>={5}]",r,"[not(self::Header)][not(self::Footer)][not(self::Footnote)][not(self::EndNote)]",t,e,i,n);return a.selectNodes(o)},s=function(e,t){return t.val=parseFloat(i.a.parseXmlAttribute(e,"t")),!isNaN(t.val)}},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(49);n(9),n(54);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(e){this._failures=0,this._maxAttempts=0,this._resourceUrl=e}var t,n,i,r=e.prototype;return r.onFinishedLoadingResource=function(e){},r.onError=function(){this._failures=this.failures+1},r.dispose=function(){},t=e,(n=[{key:"resourceUrl",get:function(){return this._resourceUrl}},{key:"failures",get:function(){return this._failures}},{key:"maxAttempts",get:function(){return this._maxAttempts}}])&&o(t.prototype,n),i&&o(t,i),e}();Object(i.a)(s,"ResourceRetryBehavior",null,[4]);var l=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this)._maxAttempts=3,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.shouldRetry=function(){return this.failures<this.maxAttempts},r.scheduleNextAttempt=function(e){e()},i}(s);Object(i.a)(l,"DefaultRetryBehavior",s,[]);var c=n(50);var u=function(e){var t,n;function i(t,n){var i;return(i=e.call(this)||this).succeeded=t,i.resourceUrl=n,i}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Sys.EventArgs);Object(i.a)(u,"LoadFinishedEventArgs",Sys.EventArgs,[]);var d=n(3),p=n(170);function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return m}));var m=function(){function e(e,t,n,i,r){var o=this;void 0===i&&(i=null),void 0===r&&(r=!1),this.excludedScriptsForCheck=["common50.js","common.js"],this._eventSource=new a.a,this._numberOfDependenciesLoaded=0,this._handlersAdded=!1,this._downloadResult=!1,this.element=null,this._resourceUrl=e,this._cdn=n,this._dependencies=t,this._retryBehavior=i||new l(e),this._shouldDownloadWithHighPriority=r,this._status=0,this._tcs=new p.a,this.add_loadFinished((function(e,t){t.succeeded?o._tcs.setResult(!0):o._tcs.SX(Error.create("Load resource failed. Resource URL: "+t.resourceUrl))}))}var t,i,o,s=e.prototype;return s.add_loadFinished=function(e){this._eventSource.addHandler("LoadingFinished",e)},s.remove_loadFinished=function(e){this._eventSource.removeHandler("LoadingFinished",e)},s.add_loadStart=function(e){this._eventSource.addHandler("LoadingStart",e)},s.remove_loadStart=function(e){this._eventSource.removeHandler("LoadingStart",e)},s.loadResource=function(){switch(this.status){case 2:this._eventSource.raiseEvent("LoadingFinished",new u(this._downloadResult,this.resourceUrl),this);break;case 0:if(this._eventSource.raiseEvent("LoadingStart",Sys.EventArgs.Empty,this),this._status=1,this.dependencies){0;for(var e=0;2!==this.status&&e<this.dependencies.length;e++)this.dependencies[e].add_loadFinished(Object(r.d)(this,this.onDependencyLoaded,"onDependencyLoaded")),this.dependencies[e].loadResource()}else this.loadResourceInternal()}},s.loadResourceInternal=function(){this.cdn?(this.cdn.add_loadFinished(Object(r.d)(this,this.onCdnDownloadFinished,"onCdnDownloadFinished")),this.cdn.addReference()):this.addReference()},s.onCdnDownloadFinished=function(e,t){t.succeeded?this.finishedLoadingResource(!0):this.addReference()},s.onDependencyLoaded=function(e,t){e.remove_loadFinished(Object(r.d)(this,this.onDependencyLoaded,"onDependencyLoaded")),2!==this.status&&(t.succeeded?++this._numberOfDependenciesLoaded>=this.dependencies.length&&this.loadResourceInternal():this.finishedLoadingResource(!1))},s.addEventHandlers=function(){$addHandler(this.element,"load",Object(r.d)(this,this.scriptOnLoad,"scriptOnLoad")),$addHandler(this.element,"error",Object(r.d)(this,this.scriptOnError,"scriptOnError")),$addHandler(this.element,"readystatechange",Object(r.d)(this,this.onReadyStateChange,"onReadyStateChange")),this._handlersAdded=!0},s.finishedLoadingResource=function(e){var t,i=n(1).AFrameworkApplication;if(-1!==this.resourceUrl.indexOf("cdn.office.net"))if(e&&i.appSettingsManager&&i.appSettingsManager.getBooleanAppSetting("LogResourceDownloadSuccess"))d.ULS.sendTraceTag(594073428,206,15,"{0}",((t={}).ResourceUrL=this.resourceUrl,t.Successful=e,t));else if(!e&&this.retryBehavior.failures===this.retryBehavior.maxAttempts){var r;d.ULS.sendTraceTag(4563787,206,10,"{0}",((r={}).ResourceUrL=this.resourceUrl,r.Successful=e,r.Failures=this.retryBehavior.failures,r.MaxAttempts=this.retryBehavior.maxAttempts,r))}this.retryBehavior.onFinishedLoadingResource(e),this._downloadResult=e,this._status=2,this._eventSource.raiseEvent("LoadingFinished",new u(e,this.resourceUrl),this),this.dispose()},s.scriptOnLoad=function(e){this.finishedLoadingResource(!0)},s.scriptOnError=function(e){this.retryBehavior.onError(),this.retryBehavior.shouldRetry()?this.retryBehavior.scheduleNextAttempt(Object(r.d)(this,this.reloadReference,"reloadReference")):this.finishedLoadingResource(!1),e&&(e.preventDefault(),e.stopPropagation())},s.onReadyStateChange=function(e){var t=e.target.readyState;!t||"loaded"!==t&&"complete"!==t||this.finishedLoadingResource(!0)},s.dispose=function(){if(this.dependencies){for(var e=0;e<this.dependencies.length;e++)this.dependencies[e].remove_loadFinished(Object(r.d)(this,this.onDependencyLoaded,"onDependencyLoaded"));this._dependencies=null}this.cdn&&(this.cdn.remove_loadFinished(Object(r.d)(this,this.onCdnDownloadFinished,"onCdnDownloadFinished")),this._cdn=null),this.removeEventHandlers(),c.a(this.retryBehavior),this._retryBehavior=null,this._numberOfDependenciesLoaded=0},s.removeEventHandlers=function(){this._handlersAdded&&($removeHandler(this.element,"load",Object(r.d)(this,this.scriptOnLoad,"scriptOnLoad")),$removeHandler(this.element,"readystatechange",Object(r.d)(this,this.onReadyStateChange,"onReadyStateChange")),$removeHandler(this.element,"error",Object(r.d)(this,this.scriptOnError,"scriptOnError")),this._handlersAdded=!1)},s.addReference=function(){this.parentElement?(this.element=this.createElement(),this.ensureHidden(this.element),this.addEventHandlers(),this._shouldDownloadWithHighPriority&&this.parentElement.appendChild(this.createHighPriorityResourceElement()),this.parentElement.appendChild(this.element)):this.finishedLoadingResource(!1)},s.ensureHidden=function(e){this.couldGenerateLayout&&(e.style.visibility="hidden",e.style.position="fixed",e.style.top="-1000px")},t=e,(i=[{key:"TCS",get:function(){return this._tcs}},{key:"isDownloading",get:function(){return 1===this.status}},{key:"isDownloaded",get:function(){return 2===this.status}},{key:"resourceUrl",get:function(){return this._resourceUrl}},{key:"dependencies",get:function(){return this._dependencies}},{key:"cdn",get:function(){return this._cdn}},{key:"status",get:function(){return this._status}},{key:"retryBehavior",get:function(){return this._retryBehavior}},{key:"parentElement",get:function(){return this.couldGenerateLayout?document.body:document.getElementsByTagName("head")[0]}},{key:"loadFinishedTask",get:function(){return this._tcs.get_task()}}])&&h(t.prototype,i),o&&h(t,o),e}();Object(i.a)(m,"DelayLoadedResource",null,[4])},function(e,t,n){"use strict";var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){this._activityName=0,this._startTime=0,this._endTime=0,this._properties=null,this._maxAllowedDuration=0,this.ended=!1}var t,n,i,a=e.prototype;return a.end=function(){},a.cancel=function(){},t=e,(n=[{key:"activityName",get:function(){return this._activityName},set:function(e){this._activityName=e}},{key:"startTime",get:function(){return this._startTime},set:function(e){this._startTime=e}},{key:"endTime",get:function(){return this._endTime},set:function(e){this._endTime=e}},{key:"properties",get:function(){return this._properties},set:function(e){this._properties=e}},{key:"maxAllowedDuration",get:function(){return this._maxAllowedDuration}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"ActivityStub",null,[134]);var o=n(112);var s=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).properties=new o.a,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(a);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(s,"FakeActivity",a,[]),n.d(t,"a",(function(){return c}));var c=function(){function e(){}var t,n,i,r=e.prototype;return r.startActivity=function(t,n){return void 0===n&&(n=-1),this.isProxy?e._instance.startActivity(t,n):new s},r.recordEvent=function(t,n){void 0===n&&(n=null),this.isProxy&&e._instance.recordEvent(t,n)},r.recordError=function(t,n){void 0===n&&(n=null),this.isProxy&&e._instance.recordError(t,n)},r.add_activityRecorded=function(t){this.isProxy&&e._instance.add_activityRecorded(t)},r.remove_activityRecorded=function(t){this.isProxy&&e._instance.remove_activityRecorded(t)},e.getAnInstanceWithResolvedDependencies=function(){return new e},t=e,i=[{key:"instance",get:function(){return e._instance||(e._instance=e.getAnInstanceWithResolvedDependencies())},set:function(t){e._instance=t}}],(n=[{key:"isProxy",get:function(){return e._instance!==this}},{key:"enabled",get:function(){return!!this.isProxy&&e._instance.enabled},set:function(t){this.isProxy&&(e._instance.enabled=t)}}])&&l(t.prototype,n),i&&l(t,i),e}();c._instance=null,Object(i.a)(c,"ActivityManager",null,[103])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(2),a=n(3);var o=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._responseAvailable=!1,t._timer=0,t._timedOut=!1,t._aborted=!1,t._started=!1,t._xmlHttpRequest=null,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=i.prototype;return o.clearTimer=function(){this._timer&&(window.clearTimeout(this._timer),this._timer=0)},o.onTimeout=function(){this.get_responseAvailable()||(this.clearTimer(),this._timedOut=!0,this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest.abort(),this.get_webRequest().completed(Sys.EventArgs.Empty),this._xmlHttpRequest=null)},o.onReadyStateChange=function(){if(4===this._xmlHttpRequest.readyState){try{if(void 0===this._xmlHttpRequest.status)return void 0}catch(e){return void 0}this.clearTimer(),this._responseAvailable=!0,this.get_webRequest().completed(Sys.EventArgs.Empty),this._xmlHttpRequest&&(this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest=null)}},o.verifyRequestValidity=function(e){if(this._started)throw Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted,"executeRequest"));if(!e)throw Error.argumentNull("webRequest",Sys.Res.nullWebRequest)},o.setResponseType=function(e){(e&&window.navigator.userAgent.indexOf("IEMobile/11")>=0||Sys.Browser.agent===Sys.Browser.InternetExplorer&&"undefined"!=typeof window.document.documentMode&&window.document.documentMode>=10)&&(this._xmlHttpRequest.responseType="msxml-document",this._xmlHttpRequest.responseType||a.ULS.sendTraceTag(50406866,200,10,"BaseXMLHttpExecutor.SetResponseType: Failed to set to msxml-document."))},o.processXMLHttpRequest=function(e){var t=e.get_body(),n=e.get_headers();if(n)for(var i in n){var a={key:i,value:n[i]};"function"!=typeof a.value&&this._xmlHttpRequest.setRequestHeader(a.key,a.value)}"post"===e.get_httpVerb().toLowerCase()&&(n&&n["Content-Type"]||this._xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t=t||"");var o=e.get_timeout();o>0&&(this._timer=window.setTimeout(Object(r.d)(this,this.onTimeout,"onTimeout"),o)),this._xmlHttpRequest.send(t),this._started=!0},o.get_aborted=function(){return this._aborted},o.get_responseAvailable=function(){return this._responseAvailable},o.get_started=function(){return this._started},o.get_timedOut=function(){return this._timedOut},o.getResponseHeader=function(e){var t=null;try{t=this._xmlHttpRequest.getResponseHeader(e)}catch(e){}return t=t||""},o.getAllResponseHeaders=function(){return this._xmlHttpRequest.getAllResponseHeaders()},o.get_responseData=function(){return this._xmlHttpRequest.responseText},o.get_statusCode=function(){try{return this._xmlHttpRequest.status}catch(e){return 0}},o.get_statusText=function(){return this._xmlHttpRequest.statusText},o.get_xml=function(){var e=this._xmlHttpRequest.responseXML;if(e&&e.documentElement)-1!==window.navigator.userAgent.indexOf("MSIE")&&"undefined"!=typeof e.setProperty&&e.setProperty("SelectionLanguage","XPath");else if(!(e=Sys.Net.XMLDOM(this._xmlHttpRequest.responseText))||!e.documentElement)return null;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===e.documentElement.namespaceURI&&"parsererror"===e.documentElement.tagName||e.documentElement.firstChild&&"parsererror"===e.documentElement.firstChild.tagName?null:e},o.abort=function(){this._aborted||this._responseAvailable||this._timedOut||(this._aborted=!0,this.clearTimer(),this._xmlHttpRequest&&!this._responseAvailable&&(this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest.abort(),this._xmlHttpRequest=null,this.get_webRequest().completed(Sys.EventArgs.Empty)))},i}(Sys.Net.WebRequestExecutor);Object(i.a)(o,"BaseXMLHttpExecutor",Sys.Net.WebRequestExecutor,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);n(9);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){this.timeSliceLengthMs=e.defaultTimeSliceLengthMs,this._parentOperation=null,this._isCompleted=!1,this._isSynchronous=!1,this._operationName=null,this._isCanceled=!1,this._startTime=null,this._endTime=null,this._childOperation=null}var t,i,a,o=e.prototype;return o.init=function(e){this._parentOperation=e,this._parentOperation?(this._startTime=this._parentOperation.startTime,e.setChildOperation(this),this._isSynchronous=this._parentOperation.isSynchronous):(this._startTime=new Date,this._isSynchronous=!1),this._isCompleted=!1,this._isCanceled=!1},o.setIsCanceled=function(){this._isCanceled=!0,this._endTime=new Date},o.setIsCompleted=function(){this._isCompleted=!0,this._endTime=new Date},o.setDebugName=function(e){this._operationName=e},o.setChildOperation=function(e){this._childOperation=e},o.clearChildOperation=function(){this._childOperation=null},o.yield=function(){var e=n(1).AFrameworkApplication;this._parentOperation?(this._parentOperation.yield(),this._startTime=this._parentOperation.startTime):(this._startTime=new Date,e.theTaskManager.yield(this))},o.updateStartTime=function(){this._startTime=new Date},o.recycle=function(){this._childOperation=null},t=e,(i=[{key:"inProgress",get:function(){return!(this._isCompleted||this.isCanceled)}},{key:"isCanceled",get:function(){return this._isCanceled}},{key:"isCompleted",get:function(){return this._isCompleted}},{key:"isSynchronous",get:function(){return this._isSynchronous},set:function(e){this._isSynchronous=e}},{key:"startTime",get:function(){return this._startTime}},{key:"endTime",get:function(){return this._endTime}},{key:"childOperation",get:function(){return this._childOperation}},{key:"operationName",get:function(){return this._operationName}},{key:"activeChildOperation",get:function(){return this.childOperation&&this.childOperation.inProgress?this.childOperation:null}},{key:"timeoutExceeded",get:function(){var e=n(1).AFrameworkApplication;return!this.isSynchronous&&!e.isShuttingDown&&(this._parentOperation?this._parentOperation.timeoutExceeded:(new Date).getTime()-this.startTime.getTime()>this.timeSliceLengthMs)}},{key:"hasYielded",get:function(){var e=n(1).AFrameworkApplication;return!this._isSynchronous&&e.theTaskManager.isYielding}}])&&r(t.prototype,i),a&&r(t,a),e}();a.defaultTimeSliceLengthMs=200,Object(i.a)(a,"AOperation",null,[198])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(e,t){this._priority=e,this._data=t}var t,n,i;return t=e,(n=[{key:"priority",get:function(){return this._priority}},{key:"data",get:function(){return this._data}}])&&r(t.prototype,n),i&&r(t,i),e}();Object(i.a)(a,"PriorityQueueEntry",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(33),a=n(3);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(e,t){this._appSettings=e,this._fallbackAppSettingsGetter=t}var t,n,i,s=e.prototype;return s.getBooleanAppSetting=function(e){return Boolean.parse(this.appSettings.ReportMissingAppSetting||"false")&&!this.containsAppSettingNoFallback(e)&&a.ULS.sendTraceTag(590189376,331,50,"AppSettingsGetter.GetBooleanAppSetting: Missing value for app setting: [{0}]",e),this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e)?this.fallbackAppSettingsGetter.getBooleanAppSetting(e):Boolean.parse(this.appSettings[e]||"false")},s.getStringAppSetting=function(e){return this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e)?this.fallbackAppSettingsGetter.getStringAppSetting(e):this.appSettings[e]},s.getIntAppSetting=function(e,t){if(this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e))return this.fallbackAppSettingsGetter.getIntAppSetting(e,t);var n=parseInt(this.appSettings[e]);return isNaN(n)&&(n=t),n},s.getLongAppSetting=function(e,t){if(this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e))return this.fallbackAppSettingsGetter.getLongAppSetting(e,t);var n=this.appSettings[e];if(n){var i=Number.parseInvariant(n);if(!isNaN(i))return i}return t},s.getDoubleAppSetting=function(e,t){if(this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e))return this.fallbackAppSettingsGetter.getDoubleAppSetting(e,t);var n=parseFloat(this.appSettings[e]);return isNaN(n)&&(n=t),n},s.getListAppSetting=function(e){return this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e)?this.fallbackAppSettingsGetter.getListAppSetting(e):r.b(this.appSettings[e])},s.containsAppSetting=function(e){return e in this.appSettings||!!this.fallbackAppSettingsGetter&&this.fallbackAppSettingsGetter.containsAppSetting(e)},s.containsAppSettingNoFallback=function(e){return e in this.appSettings},t=e,(n=[{key:"fallbackAppSettingsGetter",get:function(){return this._fallbackAppSettingsGetter}},{key:"appSettings",get:function(){return this._appSettings}}])&&o(t.prototype,n),i&&o(t,i),e}();Object(i.a)(s,"AppSettingsGetter",null,[31])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(92);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).KeyTip=null,t.Alt=null,t.Command=null,t.LabelText=null,t.LabelCss=null,t.Image16by16=null,t.Image16by16Class=null,t.Image32by32=null,t.Image32by32Class=null,t.Lang=null,t.ExternalImageId=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"CommonControlWithIconAndTextProps",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(0),r=n(2),a=n(58),o=n(334),s=n(31),l=n(1),c=(n(9),n(4)),u=n(27),d=n(10);function p(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var f=function(e){var t,n;function i(t,n,a,h,m,f){var v;void 0===n&&(n=!0),void 0===a&&(a=!1),void 0===h&&(h=null),void 0===m&&(m=null),void 0===f&&(f=!1),(v=e.call(this)||this)._learnMoreLink=null,v._printPreviewPostForm=null,v._formSubmitClickHandler=null,v._formSubmitKeyHandler=null;var _=v.titleString?v.titleString:CommonUIStrings.l_DefaultDialogTitle;v._downloadBehavior=h||new o.a(t,!0),v._downloadBehavior.attachDialog(g(v));var y=[],b=[];i.useReactDialog&&(v.additionalTextBodyContent&&v.additionalTextBodyContent.forEach((function(e){Array.add(y,e)})),v.additionalLinksBodyContent&&v.additionalLinksBodyContent.forEach((function(e){Array.add(b,e)}))),n?a?(v.buttonsOption=4,v.setButtonText(1,v.buttonText),v.setButtonText(2,CommonUIStrings.l_DialogClose)):(v.buttonsOption=6,v.setButtonText(0,CommonUIStrings.l_DialogClose)):v.buttonsOption=5;var S=document.createElement("span");v.cssClassName&&(S.className=v.cssClassName);var C=document.createElement("a");C.innerText=v.linkString,C.href=t,C.target="_blank",C.id=v.linkId,C.className=s.AFrame.allowBrowserClickClassname;var A=!d.a.isElectron&&!!m&&m.get_count()>0;if(A){var I=u.a.getParametersFromUrl(t,m),w=u.a.removeParameters(t,m);C.href="#",C.target="_self",v._printPreviewPostForm=document.createElement("form"),v._printPreviewPostForm.id="printPreviewPostForm1",v._printPreviewPostForm.method="post",v._printPreviewPostForm.target="_blank",v._printPreviewPostForm.action=w;for(var T,E=p(I);!(T=E()).done;){var k=T.value,M=document.createElement("input");M.type="hidden",M.name=k.get_key(),M.value=k.get_value(),v._printPreviewPostForm.appendChild(M)}}else v._printPreviewPostForm=null;if(v._printPreviewPostForm){var P;Array.add(b,((P={}).type="AppLinkProps",P.id=v.linkId,P.text=v.linkString,P.handler=function(e){v.reactDialogSubmitForm()},P))}else{var F,D;Array.add(b,((D={}).type="AppLinkProps",D.id=v.linkId,D.text=v.linkString,D.handler=((F={}).href=A?"#":t,F.target=A?"_self":"_blank",F),D))}if(v.messageString&&Array.add(y,v.messageString),a){0;var O=document.createElement("span");O.innerText=v.messageString.replace("{0}",""),S.appendChild(O)}else if(v.messageAndLinkOnOneLine){var R=document.createElement("span");R.id=v.myId("message");var x=document.createElement("span"),U=document.createElement("span"),B=v.messageString.split("{0}");x.innerText=B[0],U.innerText=B[1],R.appendChild(x),R.appendChild(C),R.appendChild(U),S.appendChild(R)}else{var L=document.createElement("span");L.innerText=v.messageString,S.appendChild(L),S.appendChild(document.createElement("br")),S.appendChild(document.createElement("br")),S.appendChild(C),Array.add(y,"{0}")}if(v._printPreviewPostForm&&S.appendChild(v._printPreviewPostForm),i.useReactDialog&&(v.learnMoreLinkUrl&&v.learnMoreLinkText&&v.addExtraLink(v.learnMoreLinkText,v.learnMoreLinkUrl),v.addAdditionalTextBodyContent(y,b)),v.messageBoxImpl(_,null,v.iconString,null,Object(r.d)(g(v),v.dialogHandler,"dialogHandler"),i.useReactDialog?null:S),v.setDescribedByForDialog(v.myId("message")),!i.useReactDialog&&v.learnMoreLinkUrl&&v.learnMoreLinkText){var N=document.createElement("div");N.className="WACDialogLearnMoreLinkContainer",v._learnMoreLink=document.createElement("a"),v._learnMoreLink.innerText=v.learnMoreLinkText,v._learnMoreLink.href=v.learnMoreLinkUrl,v._learnMoreLink.target="_blank",v._learnMoreLink.id=v.myId("LearnMoreLinkId"),v._learnMoreLink.className=s.AFrame.allowBrowserClickClassname,N.appendChild(v._learnMoreLink),n?v._divMessageBox.insertBefore(N,v._divMessageBox.lastChild):v._divMessageBox.appendChild(N),v.setDescribedByForDialog(String.format("{0} {1}",v.myId("message"),v.myId("LearnMoreLinkId")))}return v._downloadLink$4=C,a?v.setFocusOnElement(v._btnAction):v.setFocusOnElement(v._downloadLink$4),v.logDialogDisplayed(),l.AFrameworkApplication.activeFrame.theMouseInputManager.registerHandler(c.EventNames.click,v._downloadLink$4,Object(r.d)(g(v),v.downloadLinkClicked,"downloadLinkClicked"),null),v._learnMoreLink&&l.AFrameworkApplication.activeFrame.theMouseInputManager.registerHandler(c.EventNames.click,v._learnMoreLink,Object(r.d)(g(v),v.learnMoreLinkClicked,"learnMoreLinkClicked"),null),v._disposeOnHide=!1,v}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,h,f,v=i.prototype;return v.launchOIC=function(){},v.attachDialogEvents=function(){this._printPreviewPostForm&&(this._formSubmitClickHandler||(this._formSubmitClickHandler=Object(r.d)(this,this.onActionButtonClicked,"onActionButtonClicked"),this._clickManager.registerHandler(c.EventNames.click,this._btnAction,this._formSubmitClickHandler)),this._formSubmitKeyHandler||(this._formSubmitKeyHandler=Object(r.d)(this,this.onActionButtonKeyUp,"onActionButtonKeyUp"),this._keyInputManager.registerHandler(c.EventNames.keyUp,this._btnAction,this._formSubmitKeyHandler))),e.prototype.attachDialogEvents.call(this)},v.onActionButtonClicked=function(e){return this.executeDismissActionButtonFromArgs(e),!0},v.onActionButtonKeyUp=function(e){return this.keyHandlerWithAction(e,Object(r.d)(this,this.executeDismissActionButtonFromArgs,"executeDismissActionButtonFromArgs"))},v.executeDismissActionButtonFromArgs=function(e){this._printPreviewPostForm&&this._printPreviewPostForm.submit(),this.executeDismissButton(e.sourceElement)},v.logDownloadButtonClicked=function(){},v.downloadLinkClicked=function(e){return this.logDownloadLinkClicked(),this._printPreviewPostForm?this._printPreviewPostForm.submit():this._downloadBehavior.doDownload(),!0},v.learnMoreLinkClicked=function(e){return!1},v.dispose=function(){this._downloadBehavior.dispose(),this._downloadLink$4&&(l.AFrameworkApplication.activeFrame.theMouseInputManager.unregisterHandler(c.EventNames.click,this._downloadLink$4,Object(r.d)(this,this.downloadLinkClicked,"downloadLinkClicked")),this._downloadLink$4=null),this._learnMoreLink&&(l.AFrameworkApplication.activeFrame.theMouseInputManager.unregisterHandler(c.EventNames.click,this._learnMoreLink,Object(r.d)(this,this.learnMoreLinkClicked,"learnMoreLinkClicked")),this._learnMoreLink=null),this._clickManager&&this._formSubmitClickHandler&&(this._clickManager.unregisterHandler(c.EventNames.click,this._btnAction,this._formSubmitClickHandler),this._formSubmitClickHandler=null),this._keyInputManager&&this._formSubmitKeyHandler&&(this._keyInputManager.unregisterHandler(c.EventNames.keyUp,this._btnAction,this._formSubmitKeyHandler),this._formSubmitKeyHandler=null),e.prototype.dispose.call(this)},v.reactDialogSubmitForm=function(){this._printPreviewPostForm&&(document.body.appendChild(this._printPreviewPostForm),this._printPreviewPostForm.submit(),document.body.removeChild(this._printPreviewPostForm))},v.dialogHandler=function(e,t){1===e&&(this.logDownloadButtonClicked(),this._printPreviewPostForm?i.useReactDialog&&this.reactDialogSubmitForm():this._downloadBehavior.doDownload()),this.dispose()},a=i,f=[{key:"useReactDialog",get:function(){return l.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled&&l.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogWithLinkToResourceEnabled}}],(h=[{key:"iconString",get:function(){return null}},{key:"titleString",get:function(){return null}},{key:"messageString",get:function(){return null}},{key:"learnMoreLinkUrl",get:function(){return null}},{key:"learnMoreLinkText",get:function(){return null}},{key:"messageAndLinkOnOneLine",get:function(){return!1}},{key:"buttonText",get:function(){return CommonUIStrings.l_Open}},{key:"cssClassName",get:function(){return null}},{key:"additionalTextBodyContent",get:function(){return null}},{key:"additionalLinksBodyContent",get:function(){return null}}])&&m(a.prototype,h),f&&m(a,f),i}(a.StandardDialog);Object(i.a)(f,"ADialogWithLinkToResource",a.StandardDialog,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(0),r=n(1),a=n(7),o=n(52),s=n(5),l=n(6);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(e,t,n,i){this._tabCount=0,this._elmMain=null,this._elmTitle=null,this._elmTabTitleContainer=null,this._id=e,this._title=t,this._color=n,this._command=i}var t,n,i,u=e.prototype;return u.addTabTitleDOMElement=function(e){this._elmTabTitleContainer.appendChild(e),this._tabCount++,1===this._tabCount?l.a.ensureCSSClassOnElement(this._elmTabTitleContainer,"cui-oneCtxTab"):2===this._tabCount&&l.a.removeCSSClassFromElement(this._elmTabTitleContainer,"cui-oneCtxTab")},u.ensureTabTitlesCleared=function(){s.c(this._elmTabTitleContainer)||l.a.removeChildNodesSlow(this._elmTabTitleContainer),this._tabCount=0},u.ensureTabTitleWidths=function(){if(!s.c(this._elmTabTitleContainer)&&this._tabCount>0)if(1!==this._tabCount){var e=Math.round(this._elmTabTitleContainer.offsetWidth),t=Math.round(this.getTotalTabTitleWidth());if(!(e<=t)){var n=Math.floor((e-t)/this._elmTabTitleContainer.childNodes.length);n>0&&this.adjustAllTabTitleWidths(n)}}else{this._elmTabTitleContainer.childNodes[0].style.width="100%"}},u.getTotalTabTitleWidth=function(){for(var e=0,t=0;t<this._elmTabTitleContainer.childNodes.length;t++){var n=this._elmTabTitleContainer.childNodes[t],i=0,r=0,a=o.CssUtils.getCurrentStyle(n);a&&(i=parseInt(a.marginLeft),i=isNaN(i)?0:i,r=parseInt(a.marginRight),r=isNaN(r)?0:r),e+=n.offsetWidth+i+r}return e},u.adjustAllTabTitleWidths=function(e){for(var t=0;t<this._elmTabTitleContainer.childNodes.length;t++){var n=this._elmTabTitleContainer.childNodes[t];n.style.width=n.offsetWidth+e+"px"}},u.dispose=function(){this._elmMain=null,this._elmTitle=null,this._elmTabTitleContainer=null,this._tabCount=0},e.getColorNameForContextualTabColor=function(e){switch(e){case 1:return"or";case 2:return"gr";case 3:return"mg";case 4:return"yl";case 5:return"pp";default:return s.a}},t=e,(n=[{key:"id",get:function(){return this._id}},{key:"count",get:function(){return this._tabCount}},{key:"title",get:function(){return this._title}},{key:"color",get:function(){return this._color}},{key:"command",get:function(){return this._command}},{key:"elementInternal",get:function(){if(s.c(this._elmMain)){this._elmMain=l.a.createElement("li"),s.c(this.id)||(this._elmMain.id=this.id,a.a.setAriaAttribute(this._elmMain,"aria-labelledby",this.id+"_upper")),this._elmMain.setAttribute("role","group"),this._elmMain.className="cui-cg",r.AFrameworkApplication.activeFrame&&r.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||(this._elmMain.className+=" UITextTranformUpperCase");var t=e.getColorNameForContextualTabColor(this._color);t!==s.a&&l.a.ensureCSSClassOnElement(this._elmMain,"cui-cg-"+t);var n=l.a.createElement("div");n.className="cui-cg-i",s.c(this.id)||(n.id=this.id+"_upper"),this._elmMain.appendChild(n),this._elmTitle=l.a.createElement("div"),this._elmTitle.className="cui-cg-t",n.appendChild(this._elmTitle);var i=l.a.createElement("span");i.className="cui-cg-t-i UISmallFont",r.AFrameworkApplication.activeFrame&&r.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled&&(i.className="cui-cg-t-i"),i.innerText=this._title,this._elmTitle.appendChild(i),this._elmTabTitleContainer=l.a.createElement("ul"),this._elmTabTitleContainer.className="cui-ct-ul",s.c(this.id)||(this._elmTabTitleContainer.id=this.id+"_lower"),this._elmMain.appendChild(this._elmTabTitleContainer),this._tabCount=0}return this._elmMain}}])&&c(t.prototype,n),i&&c(t,i),e}();Object(i.a)(u,"ContextualGroup",null,[4])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(65);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,r,o;function s(t,n,i,r,a,o){return void 0===a&&(a=null),void 0===o&&(o=!0),e.call(this,t,n,i,r,a,o)||this}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,(r=[{key:"ribbon",get:function(){return this.root}}])&&a(i.prototype,r),o&&a(i,o),s}(r.a);Object(i.a)(o,"RibbonComponent",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.Rows="Rows",r.Columns="Columns",Object(i.a)(r,"InsertTableCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),r=n(359),a=n(1),o=n(33),s=n(27),l=function(){function e(){this.BaseDocQuerySignature=null,this.RoamingApp=0}var t=e.prototype;return t.serialization=function(){return o.c([this.getClassId(),this])},t.execute=function(e,t,n){var i={"Content-Type":"application/json; charset=utf-8"},o="RoamingAppsHandler.ashx";r.a.instance.roamingAppsAreEnabled&&document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")>0&&(o=s.a.addOrReplaceParameterValue(o,"wdEnableRoaming","1")),a.AFrameworkApplication.theClientRequestManager.addRequest(o,2,this.serialization(),i,!1,this.getPriority(),e,t,n,void 0,void 0,void 0,void 0,"6")},e}();Object(i.a)(l,"ARoamingAppsRequest",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(268);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._elementToTruncate=null,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.hide=function(){this.elmContainer&&(this._isVisible=!1,this.elmContainer.style.display="none")},r.undoScaling=function(){this._elementToTruncate&&(this._elementToTruncate.style.width="auto",this._elementToTruncate.style.maxWidth="none"),this.elmContainer&&(this._isVisible=!0,this.elmContainer.style.display="inline-block")},r.truncateWidth=function(e){this._elementToTruncate&&(this._elementToTruncate.style.maxWidth=e+"px")},i}(r.a);Object(i.a)(a,"ScalableViewerChromeItemContainer",r.a,[232,231])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(16);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){this._elmContainer=null,this._isVisible=!0}var t,n,i;return e.prototype.dispose=function(){},t=e,(n=[{key:"elmContainer",get:function(){return this._elmContainer}},{key:"containerBounds",get:function(){return r.a.getElementBounds(this.elmContainer)}},{key:"isVisible",get:function(){return this._isVisible}}])&&a(t.prototype,n),i&&a(t,i),e}();Object(i.a)(o,"ViewerChromeItemContainer",null,[231])},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(0),r=n(2),a=n(1),o=n(43),s=(n(9),n(239)),l=n(58),c=n(124),u=n(3),d=function(){function e(){this._cancelled=!1}var t=e.prototype;return t.start=function(t){e.showWaitUI(this.waitMessage,Object(r.d)(this,this.onCancel,"onCancel")),c.a.doRequest(this.requestUri,Object(r.d)(this,this.onComplete,"onComplete"),t)},t.onCancel=function(t){this._cancelled=!0,e.dismissWaitUI()},t.onComplete=function(t,n,i){if(!this._cancelled)if(n||(n=t?"Success":"UnknownError"),"Success"===n)this.dismissWaitUIOnSuccess&&e.dismissWaitUI(),this.onSuccess(i);else{this.isDocumentIssue(n)?u.ULS.sendTraceTag(51708544,301,15,"Translation failed due to an issue in the document: "+n):u.ULS.sendTraceTag(39387393,301,10,"WordViewer translation failed: "+n),e.dismissWaitUI();var r=this.getErrorMessage(n);if(1!==a.AFrameworkApplication.activeFrame.state){var s=new l.StandardDialog;s.buttonsOption=0,s.setButtonText(1,CommonUIStrings.l_DialogClose),s.showError(o.a.conversionFailed,CommonUIStrings.l_DefaultDialogTitle,r,null)}this.propagateError(r)}},e.showWaitUI=function(t,n){var i=new s.a;e._progressDialog=i.create(),e._progressDialog.message=t,e._progressDialog.showProgressDialog(CommonUIStrings.l_DefaultDialogTitle,n,null)},e.dismissWaitUI=function(){e._progressDialog&&(e._progressDialog.close(),e._progressDialog=null)},e}();d._progressDialog=null,Object(i.a)(d,"TranslationRequest",null,[])},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i,r,a,o=n(436),s=n(120),l=n(146),c=n(193),u=n(139),d=n(296),p=n(272),h=s.WeakMap;if(o){var m=new h,g=m.get,f=m.has,v=m.set;i=function(e,t){return v.call(m,e,t),t},r=function(e){return g.call(m,e)||{}},a=function(e){return f.call(m,e)}}else{var _=d("state");p[_]=!0,i=function(e,t){return c(e,_,t),t},r=function(e){return u(e,_)?e[_]:{}},a=function(e){return u(e,_)}}e.exports={set:i,get:r,has:a,enforce:function(e){return a(e)?r(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=r(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t){e.exports={}},function(e,t,n){var i=n(172),r=n(120),a=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?a(i[e])||a(r[e]):i[e]&&i[e][t]||r[e]&&r[e][t]}},function(e,t){e.exports={}},function(e,t,n){var i=n(366);e.exports=function(e){return Object(i(e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),r=n(214),a=n(315),o=n(47),s=n(3);var l=function(e){var t,n;function i(t,n,r){return void 0===r&&(r=null),e.call(this,t,n,r||a.a.instance,i.initializeBrowserUlsImpl)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.initializeBrowserUlsImpl=function(){o.a.sendTraceTag=i.sendTraceTagImpl,o.a.debugAssertTag=i.debugAssertTagImpl},i.sendTraceTagImpl=function(e,t,n){for(var r=arguments.length,a=new Array(r>3?r-3:0),o=3;o<r;o++)a[o-3]=arguments[o];s.ULS.sendTraceTag.apply(null,[e,204,i.crmToUlsLevel(t),n].concat(a))},i.debugAssertTagImpl=function(e,t,n){void 0===n&&(n=null)},i.crmToUlsLevel=function(e){switch(e){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}},i}(r.a);l.previousSessionParamName="wdPreviousSession",l.currentSessionParamName="wdUserSession",Object(i.a)(l,"CommonCrossDocumentMessenger",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(42);var a=function(e){var t,n;function i(t,n,i){var r;return void 0===n&&(n=null),void 0===i&&(i=null),(r=e.call(this,t,n,i)||this).elmInput=null,r.isEditable=!0,r.isMultiline=!1,r}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"TextBoxComponentDom",r.a,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(23),a=n(7),o=n(64),s=n(177),l=n(11),c=(n(9),n(10)),u=n(383),d=n(5),p=n(6),h=function(){function e(){}var t=e.prototype;return t.buildControlDom=function(e,t){var n=new u.a(t);return this.buildGalleryButtonElements(e,t,Object(l.a)((function(){return n.elmControl}),(function(e){return n.elmControl=e})),Object(l.a)((function(){return n.elmA}),(function(e){return n.elmA=e})),Object(l.a)((function(){return n.elmImage}),(function(e){return n.elmImage=e})),Object(l.a)((function(){return n.elmIconContainer}),(function(e){return n.elmIconContainer=e}))),n},t.buildGalleryButtonElements=function(e,t,n,i,r,o){var s=e.properties,l=d.c(s.Alt)?"":s.Alt,c=!d.c(s.InnerHTML);if(n.val=p.a.createElement(c?"div":"span"),n.val.setAttribute("mscui:controltype",e.controlType),n.val.className="cui-gallerybutton cui-gallerybutton-"+p.a.galleryElementDimensionsToSizeString[e.elementDimensions],n.val.setAttribute("role","presentation"),i.val=p.a.createElement(c?"div":"a"),e.shouldIgnoreTitle||(i.val.title=l),i.val.className="cui-gallerybutton-a",i.val.setAttribute(a.a.ariaRoleAttribute,e.ariaRole),r.val=null,o.val=null,d.c(s.Alt)||e.shouldIgnoreTitle||(i.val.title=s.Alt),c?i.val.tabIndex=0:p.a.addToTabLoop(i.val),n.val.appendChild(i.val),s.VerticalCenterAlign&&this.setAttributeToCenterAlignVertically(i.val),c)i.val.innerHTML=s.InnerHTML,p.a.setUnselectable(i.val,!0,!0);else{if(d.c(s.Image))throw Error.create("InnerHTML or Image must be defined for this GalleryButton");var u=7;switch(e.elementDimensions){case 1:u=4;break;case 2:u=6;break;case 3:u=7;break;case 5:u=8;break;case 6:u=9;break;case 9:u=5;break;case 10:u=15;break;case 11:u=13;break;case 12:u=12;break;case 13:u=16;break;case 14:u=17;break;case 16:u=19;break;default:0}r.val=p.a.createElement("img"),o.val=p.a.createClusteredImageContainerNew(u,s.Image,s.ImageClass,r.val,!0,!1),r.val.alt=l,i.val.appendChild(o.val)}},t.setAttributeToCenterAlignVertically=function(e){e.style.display="table",c.a.isSafari4Up&&(e.style.width="100%",e.style.height="100%")},e}();Object(i.a)(h,"GalleryButtonDomStrategy",null,[]);var m=n(90),g=n(51);function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"GalleryButton",(function(){return v}));var v=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i)||this).componentDom=null,a._displayMode=null,a.addDisplayMode("Large"),a.addDisplayMode("Menu"),a.addDisplayMode("MenuTellMe"),a.elementDimensions=r,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var l,c,u,d=i.prototype;return d.createComponentDomForDisplayMode=function(e){this.inMenu=o.a.isDisplayModeMenu(e);var t=new h;return this.componentDom=t.buildControlDom(this,e),this._displayMode=e,this.componentDom},d.getTextValue=function(){return this.properties.Alt},d.onStateChanged=function(){var e=this.stateProperties[m.a.On],t=this.stateProperties[m.a.IsRtl];p.a.toggleCSSClassOnElement(this.componentDom.elmControl,"cui-gallerybutton-highlighted",e),p.a.toggleCSSClassOnElement(this.componentDom.elmA,"cui-gallerybutton-a-ltr",1===t),p.a.toggleCSSClassOnElement(this.componentDom.elmA,"cui-gallerybutton-a-rtl",2===t);var n=this.inMenu?a.a.ariaSelectedAttribute:a.a.ariaPressedAttribute;a.a.setAriaAttribute(this.componentDom.elmA,n,e?a.a.ariaTrueValue:a.a.ariaFalseValue)},d.constructClonedControl=function(e,t){return new i(e,this.id,t,this.elementDimensions)},d.constructClonedControlForMenu=function(e,t){return new s.a(e,this.id,t)},l=i,(c=[{key:"ariaRole",get:function(){return this.inMenu?a.a.ariaGridCellRole:Object(g.a)(i.prototype,this,"ariaRole")}},{key:"controlType",get:function(){return r.Control.galleryButtonControlType}},{key:"focusableElement",get:function(){return this.componentDom?this.componentDom.elmA:null}},{key:"activatesOnPress",get:function(){return!0}},{key:"properties",get:function(){return this.controlProperties}}])&&f(l.prototype,c),u&&f(l,u),i}(r.Control);Object(i.a)(v,"GalleryButton",r.Control,[88])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(65),o=n(1),s=n(7),l=n(16),c=n(177),u=n(71),d=n(4),p=n(20),h=n(23),m=n(161),g=n(5),f=n(6);function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i,"")||this)._elmTitleA=null,r._elmTitleSpan=null,r._elmIconContainer=null,r._elmImage=null,r._elmBody=null,r._arrowCollapsedImage=t.properties.ImageCollapsedArrow,r._arrowCollapsedImageClass=t.properties.ImageCollapsedArrowClass,r._arrowExpandedImage=t.properties.ImageExpandedArrow,r._arrowExpandedImageClass=t.properties.ImageExpandedArrowClass,r._isCollapsed=!0,r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,o,l,c=i.prototype;return c.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.ensureTitleRefreshed(),this._elmBody=f.a.createElement("div"),this._elmBody.id=this.id+"-Body",this._elmBody.className="cui-cs-body",this._elmBody.style.display=this.isCollapsed?"none":"block",this.elementInternal.appendChild(this._elmBody),this.appendChildrenToElement(this._elmBody),this.ensureDOMElement(),this.dirty=!1},c.attachTitleEvents=function(){p.KeyInputManager.instance.registerHandler(d.EventNames.keyUp,this._elmTitleA,Object(r.d)(this,this.onTitleKeyUp,"onTitleKeyUp")),u.a.instance.registerHandler(d.EventNames.click,this._elmTitleA,Object(r.d)(this,this.onTitleClick,"onTitleClick"))},c.ensureTitleRefreshed=function(){if(g.c(this._elmTitleA)){this._elmTitleA=f.a.createElement("a"),this._elmTitleA.id=this.id+"-Title",this._elmTitleA.className="cui-cs-title cui-ctl-medium UIFontBold stretchedHorizontally",this._elmTitleA.setAttribute(s.a.ariaRoleAttribute,s.a.ariaButtonRole),this._elmTitleA.setAttribute(s.a.ariaDisabledAttribute,s.a.ariaFalseValue),this._elmTitleA.setAttribute("mscui:controltype",h.Control.buttonControlType),this._elmTitleA.tabIndex=0,this._elmImage=f.a.createElement("img"),this._elmImage.alt="";var e=this.isCollapsed?this.arrowCollapsedImage:this.arrowExpandedImage,t=this.isCollapsed?this.arrowCollapsedImageClass:this.arrowExpandedImageClass,n=f.a.createClusteredImageContainerNew(4,e,t,this._elmImage,!0,!1);this._elmIconContainer=f.a.createElement("span"),this._elmIconContainer.className="cui-ctl-iconContainer",this._elmIconContainer.appendChild(n),this._elmTitleA.appendChild(this._elmIconContainer),this._elmTitleSpan=f.a.createElement("span"),this._elmTitleSpan.className="cui-ctl-mediumlabel",this._elmTitleSpan.innerText=this.title,this._elmTitleA.appendChild(this._elmTitleSpan),this.elementInternal.appendChild(this._elmTitleA),this.attachTitleEvents()}},c.ensureCorrectChildType=function(e){if(!Object(r.c)(m.a,e))throw Error.create("Only children of type section can be added this Group")},c.onTitleKeyUp=function(e){var t=!1;if(!g.c(e.innerEvent)){var n=e.innerEvent.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||(this.doTitleDefaultAction(1),t=!0)}return t},c.onTitleClick=function(e){return this.doTitleDefaultAction(e.inputSource),!0},c.doTitleDefaultAction=function(e){this._isCollapsed=!this.isCollapsed,this._elmBody.style.display=this.isCollapsed?"none":"block",this._elmImage.src=this.isCollapsed?this.arrowCollapsedImage:this.arrowExpandedImage,this._elmImage.className=this.isCollapsed?this.arrowCollapsedImageClass:this.arrowExpandedImageClass,this.root.pollForStateAndUpdate()},a=i,(o=[{key:"arrowCollapsedImage",get:function(){return this._arrowCollapsedImage}},{key:"arrowCollapsedImageClass",get:function(){return this._arrowCollapsedImageClass}},{key:"arrowExpandedImage",get:function(){return this._arrowExpandedImage}},{key:"arrowExpandedImageClass",get:function(){return this._arrowExpandedImageClass}},{key:"isCollapsed",get:function(){return this._isCollapsed}},{key:"cssClass",get:function(){return"cui-cs"}},{key:"domElementTagName",get:function(){return"div"}}])&&v(a.prototype,o),l&&v(a,l),i}(a.a);Object(i.a)(_,"CollapsibleSection",a.a,[]);var y=n(338);function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"Group",(function(){return S}));var S=function(e){var t,n;function i(t,n,i,r,a,o,s,l,c,u,d){var p;return void 0===u&&(u=!1),void 0===d&&(d=null),(p=e.call(this,t,n,i,r,null,!c||!c.Visible||Boolean.parse(c.Visible))||this)._elmBody=null,p._elmGroupContainer=null,p._elmTitle=null,p._elmSeparator=null,p._elmDialogLauncher=null,p._dialogLauncherComponent=null,p._showseparator=!0,p._selectedLayout=null,p._isTouchGroup=s,p._command=a,p._usesLayouts=o,p._isStretched=l,p._minHeight=d,p._properties=c,p._hideLauncherButton=u,p}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,u,d,p=i.prototype;return p.createDialogLauncherComponent=function(){var e={};e.Command=this._properties.DialogLauncherButtonCommand,e.Image16by16=this._properties.ImageDialogLauncherButton,e.Image16by16Class=this._properties.ImageDialogLauncherButtonClass,e.Alt=this._properties.DialogLauncherButtonTooltip,e.Keytip=this._properties.Keytip;var t=new c.a(this.root,i.getLauncherButtonId(this.id),e).createComponentForDisplayMode("Small");return f.a.ensureCSSClassOnElement(t.elementInternal,"cui-dialogLauncherButton"),t},p.tryInsertDialogLauncherButton=function(e,t){e.appendChild(t),l.a.leftBoundsOverlapsRightBounds(l.a.getElementBounds(this._elmTitle),l.a.getElementBounds(t),o.AFrameworkApplication.isRtl)&&e.removeChild(t)},p.refreshInternal=function(){if(this.ensureDOMElementAndEmpty(),this._usesLayouts){g.c(this._elmTitle)?(this._elmTitle=f.a.createElement("span"),this._elmTitle.className="cui-groupTitle UISmallFont",this._elmTitle.id=this.id+"-title",s.a.setAriaAttribute(this._elmTitle,"aria-hidden","true")):this._elmTitle=f.a.removeChildNodes(this._elmTitle);var t=this.title;g.c(t)||(this._elmTitle.innerText=t),this._elmDialogLauncher||!this._properties.DialogLauncherButtonCommand||this._hideLauncherButton||(this._dialogLauncherComponent=this.createDialogLauncherComponent(),this._elmDialogLauncher=this._dialogLauncherComponent.elementInternal,this.addChild(this._dialogLauncherComponent))}g.c(this._elmBody)?(this._elmBody=f.a.createElement("span"),this._elmBody.className="cui-groupBody"):this._elmBody=f.a.removeChildNodes(this._elmBody),g.c(this._elmSeparator)&&this.displaySeparator&&(this._elmSeparator=f.a.createElement("span"),this._elmSeparator.className="cui-groupSeparator"),this._elmGroupContainer=f.a.createElement("span"),this._elmGroupContainer.className="cui-groupContainer",this._elmGroupContainer.appendChild(this._elmBody),this._usesLayouts&&this._elmGroupContainer.appendChild(this._elmTitle),this.elementInternal.appendChild(this._elmGroupContainer),this.displaySeparator&&this.elementInternal.appendChild(this._elmSeparator),!g.c(this._selectedLayout)&&this._usesLayouts?(this._selectedLayout.ensureDOMElement(),this._elmBody.appendChild(this._selectedLayout.elementInternal),this._selectedLayout.ensureRefreshed(),this._selectedLayout.ensureBehaviorAttached()):this.appendChildrenToElement(this._elmBody),g.c(this._minHeight)||(this.elementInternal.style.minHeight=this._minHeight+"px"),e.prototype.refreshInternal.call(this)},p.onGroupAttachedToRibbon=function(){this._usesLayouts&&this._elmDialogLauncher&&this.tryInsertDialogLauncherButton(this._elmGroupContainer,this._elmDialogLauncher)},p.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this);var t=s.a.ariaPresentationRole;this._usesLayouts&&(s.a.setAriaAttribute(this.elementInternal,s.a.ariaLabelledByAttribute,this.id+"-title"),t=s.a.ariaGroupRole),this.elementInternal.setAttribute(s.a.ariaRoleAttribute,t)},p.unselectLayout=function(){this.selectLayout(null)},p.selectLayout=function(e){var t=g.c(e)?null:this.getChildByTitle(e);t===this._selectedLayout||g.c(t)&&g.c(this._selectedLayout)||(this._selectedLayout=g.c(t)?null:t,g.c(t)||t.setDirtyRecursively(!0),this.onDirtyingChange())},p.isGroupDialogLauncherButton=function(e){return!!e&&!!e.className&&e.className.indexOf("cui-dialogLauncherButton")>0},p.ensureCorrectChildType=function(e){if(this._usesLayouts){if(this.isGroupDialogLauncherButton(e.elementInternal))return;if(!Object(r.c)(y.a,e))throw Error.create("Only children of type Layout or the dialog launcher button can be added this Group");if(!g.c(this.getChildByTitle(e.title)))throw Error.create("A Layout with title "+e.title+" already exists in this Group.")}else if(!Object(r.c)(m.a,e)&&!Object(r.c)(_,e))throw Error.create("Only children of type Section or CollapsibleSection can be added this Group")},p.pollForStateAndUpdateInternal=function(){if(g.c(this.command))this.enabled=!0;else{var t=this.root.pollForCommandState(this.command,null,null);this.enabled=(1&t)>0}if(this._usesLayouts){if(this.enabled&&!g.c(this._selectedLayout)&&(this._selectedLayout.pollForStateAndUpdateInternal(),this._dialogLauncherComponent)){var n=this.root.pollForCommandState(this._properties.DialogLauncherButtonCommand,null,null);this._dialogLauncherComponent.enabled=(1&n)>0}}else e.prototype.pollForStateAndUpdateInternal.call(this)},p.onChildrenVisibleChanged=function(){this._usesLayouts?this.selectedLayout&&(this.visible=this.selectedLayout.visible):e.prototype.onChildrenVisibleChanged.call(this)},i.getLauncherButtonId=function(e){return e+"DialogLauncherButton"},a=i,(u=[{key:"properties",get:function(){return this._properties}},{key:"displaySeparator",get:function(){return this._showseparator},set:function(e){this._showseparator=e,g.c(this._elmSeparator)||(this._elmSeparator.style.display=this._showseparator?"":"none")}},{key:"hasElementDialogLauncherComponent",get:function(){return!!this._dialogLauncherComponent}},{key:"elementDialogLauncherComponent",get:function(){return this._dialogLauncherComponent}},{key:"isTouchGroup",get:function(){return this._isTouchGroup},set:function(e){this._isTouchGroup=e}},{key:"bodyElement",get:function(){return this._elmBody}},{key:"titleDOMElement",get:function(){return this._elmTitle}},{key:"cssClass",get:function(){var e="cui-group";return this._isStretched&&(e+=" stretched"),e}},{key:"domElementTagName",get:function(){return"li"}},{key:"selectedLayout",get:function(){return this._selectedLayout}},{key:"command",get:function(){return this._command}}])&&b(a.prototype,u),d&&b(a,d),i}(a.a);Object(i.a)(S,"Group",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e,t){return e?(e.push(t),e):[t]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(2),a=n(257);var o=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.executeRequest=function(){var e=this.get_webRequest();this.verifyRequestValidity(e),this._xmlHttpRequest=new XMLHttpRequest,this._xmlHttpRequest.onreadystatechange=Object(r.d)(this,this.onReadyStateChange,"onReadyStateChange"),this._xmlHttpRequest.open(e.get_httpVerb(),e.getResolvedUrl(),!0),this.setResponseType(!0),this._xmlHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.processXMLHttpRequest(e)},i}(a.a);Object(i.a)(o,"Common.AsynchronousXMLHttpExecutor",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){function e(){}var t=e.prototype;return t.equals=function(e,t){return e===t},t.getHashCode=function(e){return 0|e},e.get_default=function(){return e._default||(e._default=new e)},e}();r._default=null,Object(i.a)(r,"NumberComparer",null,[22])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i,r=n(0);!function(e){e[e.notSpecified=0]="notSpecified",e[e.appCtorStarting=1]="appCtorStarting",e[e.appCtorInitialized=2]="appCtorInitialized",e[e.contentDisplayed=3]="contentDisplayed",e[e.interactivityReady=4]="interactivityReady",e[e.ribbonInitialized=5]="ribbonInitialized",e[e.ribbonBehaviorAttached=6]="ribbonBehaviorAttached",e[e.chromeReady=7]="chromeReady",e[e.appLoadedSuccessfully=8]="appLoadedSuccessfully",e[e.appLoadedFailure=9]="appLoadedFailure",e[e.ribbonDisplayed=10]="ribbonDisplayed",e[e.ribbonAutomationReady=11]="ribbonAutomationReady",e[e.commentRendered=12]="commentRendered",e[e.appEncounteredFirstError=13]="appEncounteredFirstError",e[e.documentReady=14]="documentReady",e[e.suiteHeaderRendered=15]="suiteHeaderRendered",e[e.suiteHeaderInteractive=16]="suiteHeaderInteractive",e[e.documentTitleRendered=17]="documentTitleRendered"}(i||(i={})),Object(r.b)("AppInitializationStatus",i)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i,r=n(0),a=n(2),o=n(179);var s=function(e){var t,i;function r(){var t;return(t=e.call(this)||this)._request=null,t._state=0,t._parsedXml=null,t}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var s=r.prototype;return s.get_started=function(){return this._state>0},s.get_aborted=function(){return 2===this._state},s.get_responseAvailable=function(){return 5===this._state},s.get_timedOut=function(){return 3===this._state},s.get_statusCode=function(){return this._request.statusCode},s.get_statusText=function(){return this._request.statusText},s.get_responseData=function(){return this._request.responseText},s.get_xml=function(){return this._parsedXml||(this._parsedXml=this.parseXmlResponse()),this._parsedXml},s.abort=function(){this.finishWebRequest(2,!0)},s.getAllResponseHeaders=function(){var e=this._request.contentType;return e&&e.length>0?String.format("Content-Type:{0}",e):""},s.getResponseHeader=function(e){return r.corsSimpleResponseHeadersOnlyIsEnabled&&!r.isSimpleHeader(e)?null:this._request.getResponseHeader(e)},s.executeRequest=function(){this._state=1;var e=this.get_webRequest(),t=e.get_httpVerb();if(this._request=o.a.create(),this._request){this._request.setRequestCompleted(Object(a.d)(this,this.onRequestCompleted,"onRequestCompleted")),this._request.open(t,e.getResolvedUrl());var n=e.get_timeout();n>0&&window.setTimeout(Object(a.d)(this,this.onTimeout,"onTimeout"),n),this._request.send("POST"===t.toUpperCase()?e.get_body():"")}else this.finishWebRequest(4,!1)},s.finishWebRequest=function(e,t){1===this._state&&(this._state=e,t&&this._request.abort(),this.get_webRequest().completed(Sys.EventArgs.Empty))},s.onRequestCompleted=function(){this.finishWebRequest(5,!1)},s.onTimeout=function(){this.finishWebRequest(3,!0)},s.parseXmlResponse=function(){var e=Sys.Net.XMLDOM(this.get_responseData());if(!e||!e.documentElement)return null;var t=e.documentElement;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===t.namespaceUri&&"parsererror"===t.tagName||t.firstChild&&"parsererror"===t.firstChild.tagName?null:e},r.isSimpleHeader=function(e){var t=n(1).AFrameworkApplication;return e.toLowerCase()in r.simpleResponseHeaders||t.appSettingsManager.getBooleanAppSetting("CorsLogResponseHeadersIsEnabled")&&Array.contains(t.appSettingsManager.getStringAppSetting("CorsGeneralResponseHeaders").split(","),e)},r}(Sys.Net.WebRequestExecutor);s.simpleResponseHeaders=((i={})["cache-control"]=1,i["content-language"]=1,i["content-type"]=1,i.expires=1,i["last-modified"]=1,i.pragma=1,i),s.corsSimpleResponseHeadersOnlyIsEnabled=!1,Object(r.a)(s,"Common.CrossDomainRequestExecutor",Sys.Net.WebRequestExecutor,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(0),r=n(11),a=n(38),o=n(248),s=n(363),l=n(1),c=n(104),u=n(52),d=n(22),p=n(16),h=function(){function e(){}return e.scaleHeader=function(t){var n,i;e.findDefaultRibbonTopBars(Object(r.a)((function(){return n}),(function(e){return n=e})),Object(r.a)((function(){return i}),(function(e){return i=e}))),e.scaleHeaderUsingContainers(n,i,t)},e.findDefaultRibbonTopBars=function(e,t){var n;c.a.tryEnsuredHeaderPanelInitialized(Object(r.a)((function(){return n}),(function(e){return n=e})),!l.AFrameworkApplication.hideHeaderEmbedded);var i=$get(a.CuiHelper.headerTopBarsId);n?(e.val=document.getElementById(a.CuiHelper.externalHeaderFullTopBarsId),t.val=i):(e.val=i.childNodes[0],t.val=i.childNodes[1])},e.scaleHeaderUsingContainers=function(t,n,i){if(t&&n&&n.clientHeight>0){var r=-1!==n.parentNode.parentNode.className.indexOf("cui-ribbon");e.scaleHeaderCore(t,n,i,r)}},e.scaleHeaderCore=function(t,n,i,a){var o=null,s=null,l=null,c=null,u=null,d=null,p=null,h=null,m=null,g=null,f=null,v=null,_=null,y=null,b=null,S=null,C=null,A=null,I=null,w=null;e.findHeaderItems(t,Object(r.a)((function(){return o}),(function(e){return o=e})),Object(r.a)((function(){return s}),(function(e){return s=e})),Object(r.a)((function(){return l}),(function(e){return l=e})),Object(r.a)((function(){return c}),(function(e){return c=e})),Object(r.a)((function(){return u}),(function(e){return u=e})),Object(r.a)((function(){return d}),(function(e){return d=e})),Object(r.a)((function(){return p}),(function(e){return p=e})),Object(r.a)((function(){return h}),(function(e){return h=e})),Object(r.a)((function(){return m}),(function(e){return m=e})),Object(r.a)((function(){return g}),(function(e){return g=e})),Object(r.a)((function(){return f}),(function(e){return f=e})),Object(r.a)((function(){return w}),(function(e){return w=e}))),e.findTopBar2Items(n,Object(r.a)((function(){return v}),(function(e){return v=e})),Object(r.a)((function(){return _}),(function(e){return _=e})),Object(r.a)((function(){return y}),(function(e){return y=e})),Object(r.a)((function(){return b}),(function(e){return b=e})),Object(r.a)((function(){return S}),(function(e){return S=e})),Object(r.a)((function(){return C}),(function(e){return C=e})),Object(r.a)((function(){return A}),(function(e){return A=e})),Object(r.a)((function(){return I}),(function(e){return I=e})));for(var T=0,E=[o,s,l,c,u,d,p,h,m,g,f,y,b,S,C,A,I,w];T<E.length;T++){var k=E[T];e.showElement(k)}for(var M=0,P=[o,s,l,u,p,h,g,f,b,C,A,I];M<P.length;M++){var F=P[M];e.untruncateElement(F)}e.resetPosition(s),e.setHeaderScaleIndex(_,0),e.ensureNoHeaderItemsOverlap(o,s,l,c,u,d,p,h,m,g,f,v,_,y,b,S,C,A,I,w,a,i),e.adjustBreadcrumbDisplay(d,p)},e.scaleNonCuiHeaders=function(t,n){e.scaleHeaderCore(t,null,n,!1)},e.adjustBreadcrumbDisplay=function(e,t){e&&t&&(e.style.marginTop=(t.offsetHeight-e.offsetHeight)/2+"px")},e.findHeaderItems=function(t,n,i,r,o,s,l,c,u,p,h,m,g){for(var f=0;t&&f<t.childNodes.length;f++){var v=t.childNodes[f],_=d.DomUtils.getDOMElementClassName(v),y=!!v.id;-1!==_.indexOf("cui-QATRowLeft")?n.val=v:-1!==_.indexOf("cui-QATRowCenter")?i.val=v:-1!==_.indexOf("cui-QATRowRight")?r.val=v:-1!==_.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?o.val=v:v.id===a.CuiHelper.breadcrumbBrandId?s.val=v:v.id===a.CuiHelper.folderSeparatorId?l.val=v:v.id===a.CuiHelper.breadcrumbFolderId?c.val=v:v.id===a.CuiHelper.breadcrumbTitleId?u.val=v:y&&e.isElementTopRightActionButton(v)?p.val=v:-1!==_.indexOf("UsernameNameContainer")?h.val=v:-1!==_.indexOf("UsernameNameItem")?m.val=v:-1!==_.indexOf("FreemiumUpsellButton")&&(g.val=v),e.findHeaderItems(v,n,i,r,o,s,l,c,u,p,h,m,g)}},e.findTopBar2Items=function(t,n,i,r,o,s,l,c,u){for(var p=0;t&&p<t.childNodes.length;p++){var h=t.childNodes[p],m=d.DomUtils.getDOMElementClassName(h),g=!!h.id;-1!==m.indexOf("cui-jewel-container")?n.val=h:-1!==m.indexOf("cui-tts")?i.val=h:-1!==m.indexOf("cui-TabRowInline")?o.val=h:-1!==m.indexOf("cui-TabRowRight")?u.val=h:-1!==m.indexOf("cui-separator")?r.val=h:g&&h.id.startsWith(a.CuiHelper.openInClientButtonId)&&!s.val?s.val=h:g&&h.id.startsWith(a.CuiHelper.feedbackButtonId)?l.val=h:g&&h.id.startsWith(a.CuiHelper.peoplesWellControlId)&&(c.val=h),e.findTopBar2Items(h,n,i,r,o,s,l,c,u)}},e.scaleBottomRowItems=function(t,n,i,r,a,o,s,l,c){e.relativeLayoutAwry(t,n,c)&&(e.headerScaleDown(n),e.relativeLayoutAwry(t,n,c)&&e.headerScaleDown(n)),e.relativeLayoutAwry(n,r,c)&&(e.hideElement(i),e.hideElement(a),e.relativeLayoutAwry(n,r,c)&&(e.headerScaleDown(n),e.relativeLayoutAwry(n,r,c)&&(e.headerScaleDown(n),e.relativeLayoutAwry(n,r,c)&&e.hideElement(r)))),e.relativeLayoutAwry(r,l,c)&&(e.hideElement(i),e.hideElement(a));var u=[o,s,l];e.hideElementsIfContainerControlsOverlap(r,l,u,c),e.hideElementsIfContainerControlsOverlap(n,l,u,c)},e.hideElementsIfContainerControlsOverlap=function(t,n,i,r){for(var a=0;a<i.length&&e.relativeLayoutAwry(t,n,r);)e.hideElement(i[a]),a++},e.getScaleStep=function(e){if(!e)return 0;if(void 0===e._scaleStep||null===e._scaleStep){var t=0;-1!==e.className.indexOf("cui-tts-scale1")?t=1:-1!==e.className.indexOf("cui-tts-scale2")&&(t=2),e._scaleStep=t}return parseInt(e._scaleStep)},e.headerScaleDown=function(t){var n=e.getScaleStep(t);n<2&&e.setHeaderScaleIndex(t,++n)},e.headerScaleUp=function(t){var n=e.getScaleStep(t);n>0&&e.setHeaderScaleIndex(t,--n)},e.setHeaderScaleIndex=function(t,n){t&&(t.className=e.ribbonHeaderScaleClasses[n],t._scaleStep=n)},e.relativeLayoutAwry=function(e,t,n){return!(!e||!t)&&p.a.leftBoundsOverlapsRightBounds(p.a.getElementBounds(e),p.a.getElementBounds(t),n)},e.overlapAmount=function(e,t,n){var i=0;return e&&t&&(i=p.a.leftBoundsOverlapsRightBoundsByAmount(p.a.getElementBounds(e),p.a.getElementBounds(t),n)),i},e.contextualTabsVisible=function(e){for(var t=0;e&&t<e.childNodes.length;t++){if(-1!==e.childNodes[t].className.indexOf("cui-cg"))return!0}return!1},e.getFirstContextualTabSet=function(e){for(var t=null,n=e.childNodes.length-1;e&&n>=0;n--){var i=e.childNodes[n];if(-1===i.className.indexOf("cui-cg"))break;t=i}return t},e.truncateElement=function(t,n,i){if(t&&!e.isHidden(t)){for(var r=u.CssUtils.getCurrentStyle(t),a=d.DomUtils.parseCssSize(r.paddingLeft)+d.DomUtils.parseCssSize(r.paddingRight),o=t.offsetWidth-i-a,s=n,l=0;s&&s!==t;)(r=u.CssUtils.getCurrentStyle(s))&&(l+=d.DomUtils.parseCssSize(r.paddingLeft)+d.DomUtils.parseCssSize(r.paddingRight)),s=s.parentNode;o=Math.max(o,75+l),t.style.width=o+"px"}},e.repositionElement=function(t,n,i){if(t&&n){var a=0,o=0;p.a.getElementAbsolutePosition(n,Object(r.a)((function(){return a}),(function(e){return a=e})),Object(r.a)((function(){return o}),(function(e){return o=e})));var s=i?a-t.offsetWidth:a+n.offsetWidth;e.moveElement(t,s)}},e.ensureNoHeaderItemsOverlap=function(t,n,i,r,a,o,s,l,c,u,d,p,h,m,g,f,v,_,y,b,S,C){S&&e.scaleBottomRowItems(p,h,m,g,f,v,_,y,C),e.contextualTabsVisible(h)?e.scaleTopRowItemsAroundContextualTabs(h,t,n,i,r,a,o,s,l,c,u,d,b,C):e.scaleTopRowItems(t,n,i,r,a,o,s,l,c,u,d,b,C)},e.scaleTopRowItems=function(t,n,i,r,a,o,s,l,c,u,d,p,h){var m=!!a,g=!!s,f=!!l,v=0;if((g||f)&&(v=e.overlapAmount(t,n,h))>0){var _=g;f&&(!g||l.offsetWidth>s.offsetWidth)&&(_=!1),e.truncateElement(_?s:l,_?s:l,_?v:2*v),g&&f&&(v=e.overlapAmount(t,n,h))>0&&e.truncateElement(_?s:l,_?s:l,_?v:2*v)}(g&&e.relativeLayoutAwry(s,n,h)||m&&e.relativeLayoutAwry(a,n,h))&&(e.hideElement(r),e.hideElement(a),e.hideElement(o),e.hideElement(s),f&&(e.untruncateElement(n),e.untruncateElement(l))),e.remedyCenterAndRightOverlap(n,i,l,c,u,d,p,h),f&&e.capElementWidth(l,t,i,h)},e.scaleTopRowItemsAroundContextualTabs=function(t,n,i,r,a,o,s,l,c,u,d,p,h,m){var g=!!l,f=!!c,v=!!u,_=!!h,y=e.getFirstContextualTabSet(t),b=0;(b=e.overlapAmount(n,y,m))>0&&(g&&e.truncateElement(l,l,b),g&&!e.relativeLayoutAwry(l,y,m)||(e.hideElement(a),e.hideElement(o),e.hideElement(s),e.hideElement(l))),e.relativeLayoutAwry(t,i,m)&&e.repositionElement(i,t,m),e.remedyCenterAndRightOverlap(i,r,c,u,d,p,h,m),(b=e.overlapAmount(t,r,m))>0&&(e.truncateElement(d,p,b),_&&e.relativeLayoutAwry(t,r,m)&&e.hideElement(h),v&&e.relativeLayoutAwry(t,r,m)&&e.hideElement(u)),f&&!e.isHidden(i)&&e.capElementWidth(c,t,r,m)},e.remedyCenterAndRightOverlap=function(t,n,i,r,a,o,s,l){var c=!!i,u=!!r,d=!!a,p=!!s,h=0;if((c||d)&&(h=e.overlapAmount(t,n,l))>0){var m=!!t&&"absolute"!==t.style.position,g=c;d&&(!c||a.offsetWidth>i.offsetWidth)&&(g=!1),e.truncateElement(g?i:a,g?i:o,g&&m?2*h:h),c&&d?((h=e.overlapAmount(t,a,l))>0&&(g=!g,e.truncateElement(g?i:a,g?i:o,g&&m?2*h:h)),e.relativeLayoutAwry(t,a,l)&&e.hideElement(t)):c&&e.relativeLayoutAwry(t,n,l)&&e.hideElement(t)}p&&e.relativeLayoutAwry(t,n,l)&&e.hideElement(s),u&&e.relativeLayoutAwry(t,n,l)&&e.hideElement(r)},e.isHidden=function(e){if(!e)return!0;var t=e._isHidden;return!(null==t||"0"===t)},e.hideElement=function(t){t&&!e.isHidden(t)&&(t.style.display="none",t._isHidden="1")},e.showElement=function(t){t&&e.isHidden(t)&&(t.style.display="",t._isHidden="0")},e.untruncateElement=function(e){e&&(e.style.width="auto",e.style.maxWidth="none")},e.moveElement=function(e,t){e&&(e.style.position="absolute",e.style.left=t+"px")},e.resetPosition=function(e){e&&(e.style.position="static",e.style.left="auto")},e.capElementWidth=function(t,n,i,r){if(t&&t.parentNode&&t.parentNode.parentNode){var a=e.peripheralOffsetWithElement(t);if("auto"!==t.parentNode.style.width){var o=t.parentNode.offsetWidth-a;t.style.width=o+"px"}var s=r?i:n,l=r?n:i,c=p.a.getElementBounds(t.parentNode.parentNode),u=s?p.a.getElementBounds(s):new Sys.UI.Bounds(c.x,0,0,0),d=l?p.a.getElementLocation(l):new Sys.UI.Point(c.x+c.width,0),h=0;if("absolute"===t.parentNode.style.position)h=d.x-(u.x+u.width)-a-1;else{var m=p.a.getElementBounds(t.nextSibling?t.parentNode:t),g=m.x+m.width/2;h=2*Math.min(g-(u.x+u.width),d.x-g)-a-1}t.style.maxWidth=h+"px"}},e.peripheralOffsetWithElement=function(e){for(var t=u.CssUtils.getCurrentStyle(e),n=t?d.DomUtils.parseCssSize(t.paddingLeft)+d.DomUtils.parseCssSize(t.paddingRight):0,i=u.CssUtils.getCurrentStyle(e.parentNode),r=i?d.DomUtils.parseCssSize(i.paddingLeft)+d.DomUtils.parseCssSize(i.paddingRight):0,a=0,o=e;o.nextSibling;)a+=(o=o.nextSibling).offsetWidth;return n+r+a},e.isElementTopRightActionButton=function(e){return!!e.id&&(e.id.startsWith(a.CuiHelper.shareButtonId)||e.id.startsWith(o.b)||e.id.startsWith(a.CuiHelper.replyWithChangesButtonId)||e.id.startsWith(s.a.workflowButtonId))},e}();h.ribbonHeaderScaleClasses=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"],Object(i.a)(h,"RibbonTabScalingActor",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(0),r=n(87),a=n(1),o=n(125),s=n(51);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(e){var t,n;function i(t,n,i,r,a,o){return e.call(this,t,n,i,r,a,o)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,c,u,d=i.prototype;return d.onPointerOut=function(e){return!1},d.onMenuClosed=function(){o.c(this.elementInternal,a.AFrameworkApplication.activeFrame.activeModalUIZIndex),e.prototype.onMenuClosed.call(this)},r=i,(c=[{key:"cssClass",get:function(){var e=Object(s.a)(i.prototype,this,"cssClass")+" "+i.jewelMenuClass;return a.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled&&(e+=" "+i.jewelMenuBackArrowRefreshClass),a.AFrameworkApplication.appSettingsManager&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(e+=" "+i.jewelMenuColorUpdateClass),e}}])&&l(r.prototype,c),u&&l(r,u),i}(r.Menu);c.jewelMenuClass="cui-jewelmenu",c.jewelMenuBackArrowRefreshClass="cui-jewelmenu-backarrowrefresh",c.jewelMenuColorUpdateClass="cui-color-update",Object(i.a)(c,"JewelMenu",r.Menu,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e,t){this.populateQueryCommandId=e,this.populateOnlyOnce=t};Object(i.a)(r,"MenuPopulationProperties",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"DownloadATranslatedCopyRequest",(function(){return p}));var i=n(0),r=n(269),a=n(1),o=n(13),s=n(14),l=n(111),c=n(37),u=n(36);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(e){var t,n;function i(){var t;t=e.call(this)||this;for(var n=l.a.translationLanguages.getLanguages(),r="",c=0;c<n.length;c++)if(n[c].name===s.App.instance.translationLanguage){r=n[c].displayName;break}return t._downloadUri=s.App.webServiceBase+"docdatahandler.ashx?"+s.App.instance.theDocument.baseDocQuerySignature+"&language="+o.a.urlKeyValueEncode(s.App.instance.translationLanguage)+"&languagename="+o.a.urlKeyValueEncode(r)+"&type=docx&o15=1",a.AFrameworkApplication.theWsaClient.incrementDw(i.DATAID_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS,1),t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,p,h,m=i.prototype;return m.onSuccess=function(e){window.self.location.href=this._downloadUri},m.propagateError=function(e){u.a.propagateError(!1,"TranslationFailed",c.a.itemNotGenerated,e)},m.getErrorMessage=function(e){return WordViewerIntl.WordViewerStrings.l_DownloadTranslatedDocumentError},m.isDocumentIssue=function(e){return!1},r=i,(p=[{key:"requestUri",get:function(){return this._downloadUri}},{key:"waitMessage",get:function(){return WordViewerIntl.WordViewerStrings.l_PrepareTranslationDownload}},{key:"dismissWaitUIOnSuccess",get:function(){return!0}}])&&d(r.prototype,p),h&&d(r,h),i}(r.a);p.DATAID_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS=9988,Object(i.a)(p,"DownloadATranslatedCopyRequest",r.a,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(226),o=n(1);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(e){var t,n,i,r,a;function l(t){return e.call(this,t,!0,null,!1)||this}return n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=l,(r=[{key:"iconString",get:function(){return null}},{key:"messageString",get:function(){return o.AFrameworkApplication.dialogClearerStringsIsEnabled?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}},{key:"linkString",get:function(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}},{key:"buttonText",get:function(){return CommonUIStrings.l_Download}},{key:"additionalTextBodyContent",get:function(){return null}}])&&s(i.prototype,r),a&&s(i,a),l}(a.a);Object(i.a)(l,"DownloadAsPdfDialog",a.a,[]);var c=n(31),u=n(61),d=(n(9),n(24)),p=n(17),h=n(25),m=n(20),g=n(39),f=n(239),v=n(58),_=n(124),y=n(22),b=n(158),S=n(21),C=n(5),A=n(8),I=n(3),w=n(63),T=n(34);var E=function(e){var t,n;function i(t){var n;n=e.call(this)||this;var i=document.createElement("span");i.id=n.myId("accessibleViewText");var r=document.createElement("span");r.innerText=WordViewerIntl.WordViewerStrings.l_MoreAccessibleViewDialogDescription,i.appendChild(r),i.appendChild(document.createElement("br")),i.appendChild(document.createElement("br"));var a=document.createElement("a");return a.href=t,a.target="_blank",a.innerText=WordViewerIntl.WordViewerStrings.l_MoreAccessibleViewDialogLink,i.appendChild(a),n.buttonsOption=0,n.setButtonText(1,CommonUIStrings.l_DialogClose),n.messageBoxImpl(CommonUIStrings.l_DefaultDialogTitle,null,null,null,null,i),n.setDescribedByForDialog(n.myId("accessibleViewText")),a.focus(),n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(v.StandardDialog);Object(i.a)(E,"MoreAccessibleViewDialog",v.StandardDialog,[]);var k=n(37),M=n(36),P=n(18);n.d(t,"a",(function(){return F}));var F=function(){function e(e,t,i,r,a,o,s,l){this._isAccessibleLinkHidden=!1,this._waitDlg=null,this._printWaitTask=null,this._accessibleLink=null,this._RequestAccessibilePDFFromMouseUp=null,this._RequestAccessibilePDFFromEnter=null,this._ShowAccessibleLink=null,this._HideAccessibleLink=null;var c=n(14).App;this._actionManager=e,this._directPrintManager=a,this._focusManager=o,this._userMayEnterAccessiblePdfMode=s,this._isAccessiblePdfMode=l,this.registerPrintActions(c.instance.showPrint),c.instance.printingEnabled&&(this._isCancelled=!1,this._legacyDialogDownloadACopyUrlFactory=t,this._showPrintDialogInPdfMode=r,this._isPdfMode=i,this.registerPrintDependentActions(),this.createAccessibleLink())}var t=e.prototype;return t.directPrintForPdfMode=function(e,t,i,r,a){var s=n(14).App;if(2===i){if(!this._directPrintManager.shouldUseDirectPrint()&&!C.b(o.AFrameworkApplication.downloadACopyUrl))return s.get_activeAppFrame().navigateToHostUrl(2===i,o.AFrameworkApplication.downloadACopyUrl,!0);this._directPrintManager.shouldUseDirectPrint()&&I.ULS.sendTraceTag(7135491,301,50,"Plugin in installed,Request printable pdf from server."),this.requestPDF(2,!0)}return 32},t.registerPrintActions=function(e){this._actionManager.addAction(P.a.printDocument,T.a.application,e?Object(r.d)(this,this.handlePrintCommand,"handlePrintCommand"):u.ActionManager.doNothingHandler),d.FocusManager.instance().getScope(c.AFrame.appFocusId).bindAction(m.KeyInputManager.hashKey(h.a.VK_P,m.KeyInputManager.commandKeyModifier),e?P.a.printDocument:A.a.doNothing)},t.registerPrintDependentActions=function(){this._actionManager.addAction(P.a.downloadAsPdf,T.a.application,Object(r.d)(this,this.handleDownloadAsPdf,"handleDownloadAsPdf")),this._actionManager.addAction(P.a.printAccessibilityDocument,T.a.application,Object(r.d)(this,this.requestAccessiblePDF,"requestAccessiblePDF"))},t.getRequestTypeParameter=function(e){switch(e){case 0:return"accesspdf";case 1:return"downloadpdf";case 2:return"printpdf";default:return I.ULS.sendTraceTag(5301274,324,10,"Unknown request PDF type {0}",e),"printpdf"}},t.handlePrintCommand=function(e,t,n,i,r){return 1===n?32:this._isPdfMode?(I.ULS.sendTraceTag(7135492,301,50,"Handle PDF print command, actionId: {0}",e),this.handlePrintInPdfMode(e,t,n,i,r)):this.handlePrintInDocxMode(e,t,n,i,r)},t.handleDownloadAsPdf=function(e,t,n,i,r){return 1===n?32:this._isPdfMode?16:(this._isCancelled=!1,this.requestPDF(1),32)},t.handlePrintInPdfMode=function(e,t,n,i,r){if(I.ULS.sendTraceTag(7135493,301,50,"Handle print command in PDF mode."),C.b(o.AFrameworkApplication.downloadACopyUrl)&&I.ULS.sendTraceTag(4855504,301,50,"PdfModePrint called with no DownloadACopyUrl URL."),this._directPrintManager.directPrintSettings.isEnabled)return this.directPrintForPdfMode(e,t,n,i,r);if(this._showPrintDialogInPdfMode){if(!C.b(o.AFrameworkApplication.downloadACopyUrl))return this._legacyDialogDownloadACopyUrlFactory(),32;I.ULS.sendTraceTag(8709637,301,10,"DirectPrint is disabled and have no DownloadACopyUrl,we show error dialog."),this.showErrorUI(k.a.printPdfNotGenerated),M.a.propagateError(!1,"PrintFailed",k.a.printPdfNotGenerated,this._isPdfMode?WordViewerIntl.WordViewerStrings.l_PrintPdfError:WordViewerIntl.WordViewerStrings.l_PrintError)}return this._actionManager.processAction(A.a.downloadACopy,n)},t.handlePrintInDocxMode=function(e,t,n,i,r){return this.requestPrintPDF(e,t,n,i,r)},t.requestPrintPDF=function(e,t,n,i,r){return this._isCancelled=!1,this.requestPDF(2),32},t.requestAccessiblePDF=function(e,t,n,i,r){return 1===n||this.accessiblePdfRequested(),32},t.requestAccessibilePDFFromEnter=function(e){var t=e.keyCode;t===h.a.vK_Enter?this.accessiblePdfRequested():t===h.a.vK_Tab&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),this.hideAccessibleLink(e))},t.requestAccessibilePDFFromMouseUp=function(e){this.accessiblePdfRequested()},t.showWaitUI=function(e){if(1!==n(14).App.get_activeAppFrame().state&&!this._waitDlg){var t=new f.a;this._waitDlg=t.create();var i,a=e.customData;switch(a){case 2:i=this._directPrintManager.shouldUseDirectPrint()?o.AFrameworkApplication.dialogClearerStringsIsEnabled?CommonUIStrings.l_DirectPrintPreparingPDF:WordViewerIntl.WordViewerStrings.L_DirectPrintWait:WordViewerIntl.WordViewerStrings.l_PrintPDFWait;break;case 1:i=WordViewerIntl.WordViewerStrings.l_PrintPDFWait;break;case 0:i=WordViewerIntl.WordViewerStrings.l_AccessibilityPDFWait;break;default:I.ULS.sendTraceTag(5301275,324,10,"Unknown PdfRequestType{0}",a),i=WordViewerIntl.WordViewerStrings.l_PrintPDFWait}this._waitDlg.message=i,this._waitDlg.showProgressDialog(CommonUIStrings.l_DefaultDialogTitle,Object(r.d)(this,this.cancelButton,"cancelButton"),null)}},t.cancelButton=function(e){this._isCancelled=!0},t.dismissWaitUI=function(){this._waitDlg&&(this._waitDlg.close(),this._waitDlg=null)},t.showErrorUI=function(e){if(1!==n(14).App.get_activeAppFrame().state){var t=new v.StandardDialog;t.buttonsOption=0,t.setButtonText(1,CommonUIStrings.l_DialogClose),t.showError(e,CommonUIStrings.l_DefaultDialogTitle,this._isPdfMode?WordViewerIntl.WordViewerStrings.l_PrintPdfError:WordViewerIntl.WordViewerStrings.l_PrintError,null)}},t.requestPDF=function(e,t){void 0===t&&(t=!1);var i=n(14).App,a="WordViewer/request.pdf?"+n(14).App.instance.theDocument.baseDocQuerySignature+"&type="+this.getRequestTypeParameter(e);switch(t&&(a+="&pdfMode=1"),i.instance.translationLanguage&&(a+="&language="+i.instance.translationLanguage,o.AFrameworkApplication.theWsaClient.incrementDw(9987,1)),2===e&&this._directPrintManager.shouldUseNamedAction()&&(a+="&useNamedAction=1"),e){case 0:I.ULS.sendTraceTag(20820061,301,50,"Sending Accessible PDF conversion request.");break;case 1:I.ULS.sendTraceTag(20820062,301,50,"Sending Download PDF conversion request.");break;case 2:I.ULS.sendTraceTag(20820063,301,50,"Sending Print PDF conversion request.")}_.a.doRequest(a,Object(r.d)(this,this.onRequestComplete,"onRequestComplete"),i.get_activeAppFrame().notificationBar)&&(this._printWaitTask||(this._printWaitTask=new g.a(2,1,500,Object(r.d)(this,this.showWaitUI,"showWaitUI")),this._printWaitTask.customData=e,o.AFrameworkApplication.theTaskManager.addTask(this._printWaitTask)))},t.requestTypeFromUri=function(e){return e.indexOf("&type=downloadpdf")>0?1:e.indexOf("&type=printpdf")>0?2:e.indexOf("&type=accesspdf")>0?0:(I.ULS.sendTraceTag(5301276,324,10,"Could not get requestType from uri:{0}",e),2)},t.isRequestUriPdfMode=function(e){return e.indexOf("&pdfMode=1")>-1},t.onRequestComplete=function(e,t,n){if(this.dismissWaitUI(),this._directPrintManager.probeDirectPrintExperience(),!e||t)return this.logConversionRequestFailure(n,t),void(this.isRequestUriPdfMode(n.request.get_url())?C.b(o.AFrameworkApplication.downloadACopyUrl)?(I.ULS.sendTraceTag(8709638,301,10,"have no DownloadACopyUrl and fail to request printable pdf url from server."),this.showErrorUI(k.a.printPdfNotGenerated),M.a.propagateError(!1,"PrintFailed",k.a.printPdfNotGenerated,this._isPdfMode?WordViewerIntl.WordViewerStrings.l_PrintPdfError:WordViewerIntl.WordViewerStrings.l_PrintError)):this._legacyDialogDownloadACopyUrlFactory():(this.showErrorUI(k.a.printPdfNotGenerated),M.a.propagateError(!1,"PrintFailed",k.a.printPdfNotGenerated,this._isPdfMode?WordViewerIntl.WordViewerStrings.l_PrintPdfError:WordViewerIntl.WordViewerStrings.l_PrintError)));if(this._isCancelled)return this._isCancelled=!1,void(this._printWaitTask=null);this._printWaitTask&&o.AFrameworkApplication.theTaskManager.deleteTask(this._printWaitTask),this._printWaitTask=null;var i=new b.QueryStringBuilder(n.request.get_url());o.AFrameworkApplication.addCommonUrlParameters(i);var r=i.toString();this.displayPDF(r,this.requestTypeFromUri(r))},t.logConversionRequestFailure=function(e,t){var n=e.request.get_url(),i=e.httpStatus,r=e.status,a=String.format("HTTP Status: {0}, RequestItem Status: {1}",i,r);switch(t&&(a=String.format("{0}, Response Status: {1}",a,t)),this.requestTypeFromUri(n)){case 0:I.ULS.sendTraceTag(20820064,301,10,"Accessible PDF conversion failed. {0}",a);break;case 1:I.ULS.sendTraceTag(20820065,301,10,"Download PDF conversion failed. {0}",a);break;case 2:I.ULS.sendTraceTag(20820066,301,10,"Print PDF conversion failed. {0}",a)}if(this.isRequestUriPdfMode(n))switch(t||""){case"InvalidParameter":I.ULS.sendTraceTag(7170206,301,10,"PdfModePrint, auto print PDF conversion failed. Status: InvalidParameter");break;case"CantOpenDocument":I.ULS.sendTraceTag(7170207,301,10,"PdfModePrint, auto print PDF conversion failed. Status: CantOpenDocument");break;case"DocumentAlreadyOpen":I.ULS.sendTraceTag(7170208,301,10,"PdfModePrint, auto print PDF conversion failed. Status: DocumentAlreadyOpen");break;case"ApplicationServerError":I.ULS.sendTraceTag(7170209,301,10,"PdfModePrint, auto print PDF conversion failed. Status: ApplicationServerError");break;case"DocumentIsEncrypted":I.ULS.sendTraceTag(7170210,301,10,"PdfModePrint, auto print PDF conversion failed. Status: DocumentIsEncrypted");break;case"InvalidCurrentDocument":I.ULS.sendTraceTag(7170211,301,10,"PdfModePrint, auto print PDF conversion failed. Status: InvalidCurrentDocument");break;default:I.ULS.sendTraceTag(7135494,301,10,"PdfModePrint, auto print PDF conversion failed. Status: "+(t||"null"))}},t.accessiblePdfRequested=function(){o.AFrameworkApplication.theWsaClient.incrementDw(9542,1),this._isCancelled=!1,this._isPdfMode?(I.ULS.sendTraceTag(5849884,301,50,"Accessible PDF requested while in PDF mode"),this._actionManager.processAction(A.a.downloadACopy,2)):this._userMayEnterAccessiblePdfMode?this._actionManager.processAction(P.a.toggleViewMode,2):this.requestPDF(0),this.hideAccessibleLink(null)},t.createAccessibleLink=function(){if(this._isAccessiblePdfMode){var t=document.getElementById(e.accessibilityLinkId);t&&y.DomUtils.removeElement(t)}else this._accessibleLink||(this._accessibleLink=document.getElementById(e.accessibilityLinkId)),this._accessibleLink&&(this.hideAccessibleLink(null),this._RequestAccessibilePDFFromMouseUp=Object(r.d)(this,this.requestAccessibilePDFFromMouseUp,"requestAccessibilePDFFromMouseUp"),this._RequestAccessibilePDFFromEnter=Object(r.d)(this,this.requestAccessibilePDFFromEnter,"requestAccessibilePDFFromEnter"),this._ShowAccessibleLink=Object(r.d)(this,this.showAccessibleLink,"showAccessibleLink"),this._HideAccessibleLink=Object(r.d)(this,this.hideAccessibleLink,"hideAccessibleLink"),p.a.addHandler(this._accessibleLink,"mouseup",this._RequestAccessibilePDFFromMouseUp),p.a.addHandler(this._accessibleLink,"keydown",this._RequestAccessibilePDFFromEnter),p.a.addHandler(this._accessibleLink,"focus",this._ShowAccessibleLink),p.a.addHandler(this._accessibleLink,"blur",this._HideAccessibleLink))},t.showAccessibleLink=function(t){this._accessibleLink&&(this._accessibleLink.className=e.accessibilityLinkShownClass,this._isAccessibleLinkHidden=!1)},t.hideAccessibleLink=function(t){var i=n(238).AppFrame;this._accessibleLink&&!this._isAccessibleLinkHidden&&(this._accessibleLink.className=e.accessibilityLinkHiddenClass,this._isAccessibleLinkHidden=!0,t&&this._focusManager.setScopeFromTop(i.ribbonFocusId))},t.displayPDF=function(e,t){var i=n(14).App,r=new w.a;if(r.add("access_token"),r.add("access_token_ttl"),1!==i.get_activeAppFrame().state)switch(t){case 0:new E(e);break;case 1:new l(e);break;case 2:this._directPrintManager.showPrintDialog(e,!1,r);break;default:I.ULS.sendTraceTag(5301277,324,10,"Unknown PdfRequestType:{0}",t)}},t.dispose=function(){this._accessibleLink&&this._RequestAccessibilePDFFromMouseUp&&p.a.removeHandler(this._accessibleLink,"mouseup",this._RequestAccessibilePDFFromMouseUp),this._accessibleLink&&this._RequestAccessibilePDFFromEnter&&p.a.removeHandler(this._accessibleLink,"keydown",this._RequestAccessibilePDFFromEnter),this._accessibleLink&&this._ShowAccessibleLink&&p.a.removeHandler(this._accessibleLink,"focus",this._ShowAccessibleLink),this._accessibleLink&&this._HideAccessibleLink&&p.a.removeHandler(this._accessibleLink,"blur",this._HideAccessibleLink),this._accessibleLink=null},e.getPrintManagerInstance=function(){var t=n(14).App;return new e(o.AFrameworkApplication.theActionManager,(function(){return new a.a(o.AFrameworkApplication.downloadACopyUrl,!1)}),t.instance.isPdfMode,t.instance.showLegacyPrintDialogPdfMode,S.a.instance.resolve("Common.App.DirectPrint.IDirectPrintManager"),d.FocusManager.instance(),t.instance.userMayEnterAccessiblePdfMode,t.instance.isAccessiblePdfMode)},e}();F.accessibilityLinkId="WACAccessibilityLink",F.accessibilityLinkShownClass="WACAccessibilityLinkShown",F.accessibilityLinkHiddenClass="WACAccessibilityLinkHidden",Object(i.a)(F,"PrintManager",null,[4])},function(e,t,n){"use strict";var i=n(0),r=(n(9),n(163));function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(e){this._properties=e}var t,n,i;return e.prototype.dispose=function(){},t=e,(n=[{key:"properties",get:function(){return this._properties}}])&&a(t.prototype,n),i&&a(t,i),e}();Object(i.a)(o,"RegisteredObjectProperties",null,[4]);var s=n(331),l=n(233),c=n(59);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return d}));var d=function(){function e(){this._refCount=0,this._properties={},this._unregisteredProperties={},this._registeredObjectProperties=[],this._additionalRegisteredObjectProperties=[]}var t,i,a,d=e.prototype;return d.start=function(){++this._refCount},d.stop=function(){--this._refCount||(this._properties={},this._unregisteredProperties={})},d.registerProperty=function(e){this._properties[e.id]=e,this.addRegisteredObjectProperty(e)},d.unregisteredPropertiesRead=function(e){return this._unregisteredProperties[e]},d.unregisteredPropertiesAdd=function(e,t){this._unregisteredProperties[e]=t},d.addRegisteredObjectProperty=function(e){e.type!==c.a.objectId&&e.type!==c.a.arrayOfObjectIds||Array.add(this._registeredObjectProperties,e),e.type!==c.a.objectId&&e.type!==c.a.arrayOfObjectIds&&e.type!==c.a.arrayOfPropertyValues&&e.type!==c.a.propertySet||Array.add(this._additionalRegisteredObjectProperties,e)},d.readRegisteredObjectProperties=function(){return new o(this._registeredObjectProperties)},d.readAdditionalRegisteredObjectProperties=function(){return new o(this._additionalRegisteredObjectProperties)},d.findPropertyByStringId=function(e){var t;return(t=this._properties[e])||(t=this.unregisteredPropertiesRead(e)),t},d.lookupProperty=function(e){var t,i=n(524).CommonProperties,a=e.toString();if((t=this._properties[a])||(t=this.unregisteredPropertiesRead(a)),!t){var o=l.c(e);if(!i.nil)throw r.b("Cannot find the common property definitions");var c=l.a(2,o,l.c(e));0;var u=this._properties[c];0;var d=new s.a(e,u.type,0);this.unregisteredPropertiesAdd(a,d),this.addRegisteredObjectProperty(d),t=d}return t},d.isPersistedProperty=function(e){switch(l.b(e)){case 14:case 8:case 0:case 6:case 16:case 17:case 26:return!1;default:return!0}},t=e,a=[{key:"instance",get:function(){return e._instance||(e._instance=new e)}}],(i=null)&&u(t.prototype,i),a&&u(t,a),e}();d._instance=null,Object(i.a)(d,"PropertiesManager",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(74),o=(n(9),n(7)),s=n(23),l=n(64),c=n(215),u=n(42);var d=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n)||this).elmSelectedItem=i,r}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(u.a);Object(i.a)(d,"DropDownComponentDom",u.a,[]);var p=n(116),h=n(5),m=n(6);function g(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return _}));var _=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this)._dropDownDom=null,a._selectedControl=null,a.addDisplayMode("Medium"),a.addDisplayMode("MenuTellMe"),a.addDisplayMode("Small"),a.stateProperties[c.a.SelectedItemId]=null,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,u,f,_=i.prototype;return _.createComponentDomForDisplayMode=function(e){var t,n,i,r,a;(t=m.a.createElement("span")).className="cui-dd",t.setAttribute("mscui:controltype",this.controlType),m.a.addToTabLoop(t),(n=m.a.createElement("span")).className="cui-dd-text",n.style.width=this.isSmallWidth(e)?this.properties$2.SmallWidth:this.properties$2.Width,n.setAttribute(o.a.ariaHiddenAttribute,o.a.ariaTrueValue);var s=this.stateProperties[c.a.SelectedItemId];if(!h.c(s)){this.selectDropdownItemById(s);0}return(i=m.a.createElement("a")).setAttribute(o.a.ariaHiddenAttribute,o.a.ariaTrueValue),m.a.ensureCSSClassOnElement(i,"cui-dd-arrow-button"),i.id=this.id,r=m.a.createElement("img"),a=this.isVisualRefreshEnabled?m.a.createClusteredImageContainerNew(2,this.root.properties.ImageDownArrow8by8,this.root.properties.ImageDownArrow8by8Class,r,!0,!1):m.a.createClusteredImageContainerNew(1,this.root.properties.ImageDownArrow,this.root.properties.ImageDownArrowClass,r,!0,!1),i.setAttribute("title",this.propertiesAlt),n.title=this.propertiesAlt,r.alt=this.propertiesAlt,t.appendChild(n),t.appendChild(i),i.appendChild(a),this._dropDownDom=new d(e,t,n),this.dropDownDom},_.setInitialAriaMenuLauncherAttributes=function(t){o.a.setAriaAttribute(t,o.a.ariaRoleAttribute,this.ariaRole),e.prototype.setInitialAriaMenuLauncherAttributes.call(this,t)},_.selectDropdownItem=function(e){if(this.selectedControl!==e){this._selectedControl=e,this.stateProperties[c.a.SelectedItemId]=e.getMenuItemId();var t=e.getTextValue(),n=m.a.createElement("a");if(n.innerText=t,this.dropDownDom&&this.dropDownDom.elmSelectedItem){var i=this.dropDownDom.elmSelectedItem;if(i.hasChildNodes()){var r=i.firstChild;i.replaceChild(n,r)}else i.appendChild(n);o.a.setAriaAttribute(this.dropDownDom.elmControl,o.a.ariaLabelAttribute,this.propertiesAlt+" "+t)}}},_.getItemById=function(e,t){var n;if(Object(r.c)(l.a,e)){var i=e;if(Object(r.c)(88,i.control)){var a=i.control;if(a.getMenuItemId()===t)return a}}var o=e.children;if(!h.c(o))for(var s,c=g(o);!(s=c()).done;){var u=s.value;if(n=this.getItemById(u,t))return n}return null},_.executeDropdownItem=function(e,t,n,i,r){return!1},_.selectDropdownItemById=function(e){var t=!1;if(!h.c(e)&&!h.c(this.menu)){var n=this.getItemById(this.menu,e);h.c(n)||(this.selectDropdownItem(n),t=!0)}return t},_.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},_.constructClonedMenuLauncherForMenu=function(e,t,n){return new p.FlyoutAnchor(e,this.id,t,n)},_.isSmallWidth=function(e){return!h.c(this.properties$2.SmallWidth)&&e.startsWith("Small")},a=i,(u=[{key:"dropDownDom",get:function(){return this._dropDownDom}},{key:"additionalMenuCssClass",get:function(){return"cui-dd-menu"}},{key:"propertiesAlt",get:function(){return h.c(this.properties$2.Alt)?h.a:this.properties$2.Alt}},{key:"controlType",get:function(){return s.Control.dropDownControlType}},{key:"selectedControl",get:function(){return this._selectedControl}},{key:"properties$2",get:function(){return this.controlProperties}}])&&v(a.prototype,u),f&&v(a,f),i}(a.MenuLauncher);Object(i.a)(_,"DropDown",a.MenuLauncher,[])},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u}));n(9);var i="event_source",r="CloseButton",a="OIC",o="FileMenu",s="",l="Error",c="ReportAbuse",u="SessionExpiration"},function(e,t,n){var i=n(144),r=n(294),a=n(270),o=n(192),s=n(295),l=n(139),c=n(398),u=Object.getOwnPropertyDescriptor;t.f=i?u:function(e,t){if(e=o(e),t=s(t,!0),c)try{return u(e,t)}catch(e){}if(l(e,t))return a(!r.f.call(e,t),e[t])}},function(e,t,n){"use strict";var i={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,a=r&&!i.call({1:2},1);t.f=a?function(e){var t=r(this,e);return!!t&&t.enumerable}:i},function(e,t,n){var i=n(146);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var i=n(368),r=n(298),a=i("keys");e.exports=function(e){return a[e]||(a[e]=r(e))}},function(e,t){e.exports=!1},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+i).toString(36)}},function(e,t,n){var i=n(370),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t,n){var i,r=n(194),a=n(447),o=n(371),s=n(272),l=n(448),c=n(399),u=n(296),d=u("IE_PROTO"),p=function(){},h=function(e){return"<script>"+e+"<\/script>"},m=function(){try{i=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;m=i?function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t}(i):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F);for(var n=o.length;n--;)delete m.prototype[o[n]];return m()};s[d]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(p.prototype=r(e),n=new p,p.prototype=null,n[d]=e):n=m(),void 0===t?n:a(n,t)}},function(e,t,n){var i=n(404),r=n(371);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var i=n(1),r=n(424),a=function(){var e=i.AFrameworkApplication.activeFrame.applicationInstance.officeAppType;return(3===e||1===e||2===e||4===e)&&i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PremiumUpsellIsEnabled")},o=function(e,t,n,a){void 0===a&&(a=!1);var o=1===t;return 1===e&&(o=2===i.AFrameworkApplication.activeFrame.mode),String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",r.a[e],o?"Editor":"Viewer",a?"Dime":"Unknown",n||"dimedefault")},s=function(e){switch(e){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";case 5:default:return null}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e,t,n){this.page=e,this.data=t,this.source=n};Object(i.a)(r,"BroadcastActionArgs",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e,t){this.actionData=e,this.inputMethod=t};Object(i.a)(r,"ActionDataWithInputMethod",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"setExceptionCallStack",(function(){return r}));var i=n(1),r=function(e){i.AFrameworkApplication.theDefaultErrorHandler&&i.AFrameworkApplication.theDefaultErrorHandler.setExceptionCallStack(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(92);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).UpdateDynamically=!1,t.Title=null,t.MaxWidth=null,t.MenuSectionList=null,t.AriaLabel=null,t.ShouldAutoOpen=!1,t.AriaRoleDescription=null,t.MenuTargetDescriptor=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"MenuProps",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.target=null,this.content=null,this.title=null,this.primaryButtonProps=null,this.secondaryButtonProps=null,this.showCloseIcon=null,this.calloutProps=null,this.hasFocusableControls=null,this.useTeachingStyles=null,this.preventLightDismiss=null,this.hasDynamicSizing=null,this.jumpToCalloutTargetButtonEnabled=null,this.useCoachmark=null};Object(i.a)(r,"CalloutParameters",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.displayTimeoutSeconds=null,this.onExpire=null};Object(i.a)(r,"ExpirationOptions",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};Object(i.a)(r,"ICalloutProps",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(227);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,r,o;function s(){var t;return(t=e.call(this)||this).UseUncheckedImage=!1,t.CloseMenuWhenExecuted=!0,t.IsChecked=!1,t.CheckedImageClass=null,t.CheckedImage=null,t}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,(r=[{key:"ControlType",get:function(){return 6}}])&&a(i.prototype,r),o&&a(i,o),s}(r.a);Object(i.a)(o,"CheckMarkToggleButtonProps",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"JewelMenuLauncher",(function(){return b}));var i=n(0),r=n(2),a=n(11),o=n(74),s=n(1),l=(n(9),n(4)),c=n(20),u=n(28),d=n(29),p=n(10),h=n(35),m=n(23),g=n(42),f=(n(195),n(5)),v=n(6),_=n(8);function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var b=function(e){var t,n;function i(t,n,i,a,o){var l;return(l=e.call(this,t,n,i,a)||this)._elmJewel=null,l._parentRoot=o,l.addDisplayMode("Default"),s.AFrameworkApplication.theActionManager.addAction(_.a.launchFileMenu,h.a.frame,Object(r.d)(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(l),l.launchFileMenu,"launchFileMenu")),l}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o,b,S,C=i.prototype;return C.createComponentDomForDisplayMode=function(e){var t,n,i,r;return this._elmJewel=m.Control.createStandardControlDOMElement(this,this.root,e,this.properties$2,!1,Object(a.a)((function(){return t}),(function(e){return t=e})),Object(a.a)((function(){return n}),(function(e){return n=e})),Object(a.a)((function(){return i}),(function(e){return i=e})),Object(a.a)((function(){return r}),(function(e){return r=e}))),this._elmJewel.className="cui-jewel-jewelMenuLauncher",s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||(this._elmJewel.className+=" UITextTranformUpperCase"),this._elmJewel.id=this.properties$2.Id+"-Default",t.className="cui-jewel-label",t.innerText=this.properties$2.LabelText,this.setInitialAriaMenuLauncherAttributes(this._elmJewel),this.attachEvents(),new g.a(e,this._elmJewel)},C.attachEvents=function(){u.a.instance.registerHandler(l.EventNames.pointerDown,this._elmJewel,Object(r.d)(this,this.onPointerDown,"onPointerDown")),c.KeyInputManager.instance.registerHandler(l.EventNames.keyDown,this._elmJewel,Object(r.d)(this,this.onKeyDown,"onKeyDown")),c.KeyInputManager.instance.registerHandler(l.EventNames.keyUp,this._elmJewel,Object(r.d)(this,this.onKeyUp,"onKeyUp"))},C.launchFileMenu=function(e,t,n,i,r){if(1===n)return 32;var a=0;return a=s.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&r.hasOwnProperty("InputMethod")?r.InputMethod:r,s.AFrameworkApplication.activeFrame.applicationInstance.isReactFileMenuUxEnabled||this.launchMenu(a),s.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings"),s.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWordReadOnlyRecommendedSettings"),32},C.launchMenu=function(e){this.launchMenuWithSubmenu(e)},C.launchMenuWithSubmenu=function(t,n){void 0===n&&(n=null),this.enabled&&!this.menuLaunched&&(p.a.isInternetExplorer8&&d.WacAirSpace.temporarilyDisableAnimation(1e3),s.AFrameworkApplication.dismissSplashScreenImmediately(),s.AFrameworkApplication.activeFrame.applicationInstance.isReactFileMenuUxEnabled?appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0)):(e.prototype.launchMenu.call(this,t),this.menu.elementInternal&&(this.menu.elementInternal.style.position="fixed"),(1!==t||n)&&this.root.launchSubMenu(t,n)))},C.updateAriaMenuLauncherAttributes=function(t,n){s.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled?appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(n)):e.prototype.updateAriaMenuLauncherAttributes.call(this,t,n)},C.doDefaultAction=function(t,n,i){e.prototype.doDefaultAction.call(this,t,n,i)},C.onKeyDown=function(t){var n=!1;return f.c(t.innerEvent)||f.c(t.innerEvent.rawEvent)||(t.innerEvent.keyCode===Sys.UI.Key.down&&(this.doDefaultAction(t.sourceElement,1,t.innerEvent),n=!0),n||(n=e.prototype.onKeyDown.call(this,t))),n},C.dispose=function(){f.c(this._elmJewel)||v.a.unregisterAllHandlers(this._elmJewel),s.AFrameworkApplication.theActionManager.removeAction(_.a.launchFileMenu,h.a.frame,Object(r.d)(this,this.launchFileMenu,"launchFileMenu")),e.prototype.dispose.call(this),this._elmJewel=null},C.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n,e)},o=i,(b=[{key:"parentRoot",get:function(){return this._parentRoot}},{key:"controlType",get:function(){return m.Control.jewelMenuLauncherControlType}},{key:"properties$2",get:function(){return this.controlProperties}}])&&y(o.prototype,b),S&&y(o,S),i}(o.MenuLauncher);Object(i.a)(b,"JewelMenuLauncher",o.MenuLauncher,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);n(9);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){}var t,n,i;return e.initialize=function(t){e._rootElement=t,Sys.UI.DomElement.addCssClass(e._rootElement,"HtmlScratchPad"),e.setHasLayout(!1)},e.reset=function(){e._rootElement=null},e.getScratchPad=function(t){var n=e.utilElements[t];return n||(n=e._rootElement.ownerDocument.createElement("div"),e._rootElement.appendChild(n),e.utilElements[t]=n),n},e.releaseScratchPad=function(t){var n=e.utilElements[t];e._rootElement.removeChild(n),e.utilElements[t]=null},e.beginScratchPadUse=function(){e._beginCount++,1===e._beginCount&&e.setHasLayout(!0)},e.endScratchPadUse=function(){e._beginCount--,e._beginCount||e.setHasLayout(!1)},e.setHasLayout=function(t){t?Sys.UI.DomElement.removeCssClass(e._rootElement,"Hidden"):Sys.UI.DomElement.addCssClass(e._rootElement,"Hidden")},t=e,i=[{key:"isInitialized",get:function(){return!!e._rootElement}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();a._rootElement=null,a.utilElements={},a._beginCount=0,Object(i.a)(a,"HtmlScratchPadProvider",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(0),r=n(2),a=n(1),o=n(43),s=n(39),l=n(96),c=n(124),u=n(36);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(){function e(e,t){this._failureCallback=null,this._successfulRequestHandler=e,this._url=t}var t,i,p,h=e.prototype;return h.send=function(){var e=n(14).App;c.a.doRequestWithNetworkFailureNotification(this._url+"&r=1",Object(r.d)(this,this.onRequestComplete,"onRequestComplete"),e.get_activeAppFrame().notificationBar)},h.onRequestComplete=function(e,t,n){if(e&&"Success"===t){var i=new s.a(2,1,0,this._successfulRequestHandler);i.name=this._url,a.AFrameworkApplication.theTaskManager.addTask(i)}else if(this._failureCallback)this._failureCallback();else if(e){var r=n.responseXml,c=r.selectSingleNode("/docdata/status"),d=c?c.text:"UnexpectedDocDataResponse",p=u.a.getErrorCodeFromStatus(d),h=r.selectSingleNode("/docdata/dialog/description"),m=l.a.formatSingleString(h?h.text:CommonUIStrings.l_CannotOpenFile);u.a.showErrorDialog(r),u.a.propagateError(!1,"StatusRequestFailed",p,m)}else u.a.showErrorDialogEx(o.a.networkProblem,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemDialogDescription),u.a.propagateError(!1,"StatusRequestFailed",o.a.networkProblem,CommonUIStrings.l_NetworkProblemDialogDescription)},t=e,(i=[{key:"failureCallback",set:function(e){this._failureCallback=e}}])&&d(t.prototype,i),p&&d(t,p),e}();Object(i.a)(p,"StatusRequest",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(40);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){this._text="",this._progressSpan=null,this._textSpan=null,this._imageElement=null}var t,n,i,o=e.prototype;return o.createAndAttach=function(e,t){this._progressSpan=document.createElement("span"),this._progressSpan.setAttribute("Unselectable","on"),this._imageElement=this.createImageElement(t,e),this._imageElement.setAttribute("Unselectable","on"),this._textSpan=this.createTextElement(),this._textSpan.setAttribute("Unselectable","on"),this.setCssClasses(),this._progressSpan.appendChild(this._textSpan),this._progressSpan.appendChild(this._imageElement),this.text=e},o.setCssClasses=function(){},o.createTextElement=function(){return document.createElement("span")},o.createImageElement=function(e,t){var n=document.createElement("img");return n.src=r.a.commonImage(e),n},o.setImageAltText=function(e){this._imageElement.alt=e},o.setTitle=function(e){this._imageElement.title=e},o.setVisibility=function(e,t){this._imageElement.style.display=e?"inline":"none",this._textSpan.style.display=t?"inline":"none"},o.dispose=function(){this._progressSpan=null,this._textSpan=null,this._imageElement=null},t=e,(n=[{key:"text",get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this._textSpan&&(this._textSpan.innerText=this._text,this.setImageAltText(this._text)))}},{key:"element",get:function(){return this._progressSpan}}])&&a(t.prototype,n),i&&a(t,i),e}();function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(o,"ImageAndTextControl",null,[4]),n.d(t,"a",(function(){return l}));var l=function(e){var t,n;function i(t){var n;return(n=e.call(this)||this)._isSmall=!1,n.createAndAttach(t,"progress.gif"),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,o,l,c=i.prototype;return c.setCssClasses=function(){this._progressSpan.className="WACProgress",this._imageElement.className="WACProgressImage",this._textSpan.className="WACProgressText"},c.setImageCss=function(e){e?(this._imageElement.className="WACProgressSmallImage",this._imageElement.src=r.a.commonImage("progress16.gif"),this._textSpan.className="WACProgressSmallText"):(this._imageElement.className="WACProgressImage",this._imageElement.src=r.a.commonImage("progress.gif"),this._textSpan.className="WACProgressText")},a=i,(o=[{key:"isSmall",get:function(){return this._isSmall},set:function(e){this._isSmall!==e&&(this._isSmall=e,this.setImageCss(this._isSmall))}}])&&s(a.prototype,o),l&&s(a,l),i}(o);Object(i.a)(l,"Progress",o,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(1),o=n(4),s=n(39),l=function(e,t,n,i){void 0===i&&(i=null),this.origin=e,this.data=t,this.source=n,this.innerEvent=i};Object(i.a)(l,"MessageEventArgs",null,[]);n(3);var c=n(101);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return d}));var d=function(){function e(e,t){this._windowEventHandler=null,this._windowEventManager=e,this._taskManager=t,this._messageHandler=null}var t,n,i,d=e.prototype;return d.attachHandler=function(e,t){this._messageHandler=e,this._windowEventHandler=Object(r.d)(this,this.postMessageEventHandler,"postMessageEventHandler"),this.theWindowEventManager.addHandler(o.EventNames.message,this._windowEventHandler,t)},d.detachHandler=function(e){this._messageHandler=null,this.theWindowEventManager.removeHandler(o.EventNames.message,this._windowEventHandler)},d.invokeCallback=function(e,t){var n=new s.a(0,1,1,(function(n){e(t)}),7);this.taskManager.addTask(n)},d.invokeEventCallback=function(e,t){var n=new s.a(0,1,1,(function(n){e(t)}),7);this.taskManager.addTask(n)},d.postMessageEventHandler=function(e){return!!this._messageHandler&&this._messageHandler(new l(e.origin,e.data,e.source,e.innerEvent))},e.getAnInstanceWithResolvedDependecies=function(){return new e(new c.a((function(){return a.AFrameworkApplication.theWindowEventManager})),new c.a((function(){return a.AFrameworkApplication.theTaskManager})))},t=e,i=[{key:"instance",get:function(){return e.getAnInstanceWithResolvedDependecies()}}],(n=[{key:"theWindowEventManager",get:function(){return this._windowEventManager.value}},{key:"taskManager",get:function(){return this._taskManager.value}}])&&u(t.prototype,n),i&&u(t,i),e}();Object(i.a)(d,"MessageEventHandler",null,[63])},function(e,t,n){"use strict";var i=n(0),r=n(426),a=function(){};Object(i.a)(a,"PerfOperation",null,[]);var o=n(3);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return l}));var l=function(){function e(e,t){this._startTime=null,this._endTime=null,this._operation=e,this._target=t}var t,n,i,l=e.prototype;return l.start=function(){return this._startTime=new Date,this._endTime=null,null},l.stop=function(){var e;this._startTime&&o.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",((e={}).Operation=this._operation,e.Target=this._target,e.StartTime=this._startTime.toUTCString(),e.DurationInMilliseconds=this.ageInMilliseconds,e))},l.reset=function(){this.stop(),this._startTime=null,this._endTime=null},l.isNullOrEmpty=function(e){return!e||""===e},l.logPerfOperation=function(e){var t=Sys.Serialization.JavaScriptSerializer.serialize(e);o.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",t)},l.stopEx=function(e,t){if(void 0===t&&(t=!1),this._endTime||(this._endTime=new Date),this._startTime){var n=this._endTime.getTime()-this._startTime.getTime();if(!e)return void this.logPerfOperation(this.createPivotedPerfOperation(this._target,n,null));var i=this.createPivotedExtraInfo("All","All",e),r=this.createPivotedExtraInfo(e.PivotName,"All",e);t||this.logPerfOperation(this.createPivotedPerfOperation(this._target,n,i)),this.isNullOrEmpty(e.PivotName)||this.isNullOrEmpty(e.PivotValue)||(this.logPerfOperation(this.createPivotedPerfOperation(this._target+"_"+e.PivotName+e.PivotValue,n,e)),this.logPerfOperation(this.createPivotedPerfOperation(this._target+"_"+e.PivotName+r.PivotValue,n,r))),this.isNullOrEmpty(e.CompositeName)||(t||this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName,n+e.CompositeDurationInMilliseconds,i)),this.isNullOrEmpty(e.PivotName)||this.isNullOrEmpty(e.PivotValue)||(this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName+"_"+e.PivotName+e.PivotValue,n+e.CompositeDurationInMilliseconds,e)),this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName+"_"+e.PivotName+"All",n+e.CompositeDurationInMilliseconds,r))))}},l.createPivotedExtraInfo=function(e,t,n){return Object.assign(new r.a,{PivotName:e,PivotValue:t,CompositeDurationInMilliseconds:n.CompositeDurationInMilliseconds,CompositeName:n.CompositeName,ExtraInfoContext:n.ExtraInfoContext})},l.createPivotedPerfOperation=function(e,t,n){return Object.assign(new a,{Operation:this._operation,Target:e,StartTime:this._startTime.toUTCString(),DurationInMilliseconds:t,ExtraInfo:n})},t=e,(n=[{key:"isRunning",get:function(){return!!this._startTime}},{key:"ageInMilliseconds",get:function(){return this._startTime?(new Date).getTime()-this._startTime.getTime():0}},{key:"id",get:function(){throw Error.notImplemented()}}])&&s(t.prototype,n),i&&s(t,i),e}();Object(i.a)(l,"Stopwatch",null,[96,97])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(2),a=n(257);var o=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.executeRequest=function(){var e=this.get_webRequest();this.verifyRequestValidity(e),this._xmlHttpRequest=new XMLHttpRequest,Sys.Browser.agent!==Sys.Browser.Firefox&&(this._xmlHttpRequest.onreadystatechange=Object(r.d)(this,this.onReadyStateChange,"onReadyStateChange")),this._xmlHttpRequest.open(e.get_httpVerb(),e.getResolvedUrl(),!1),this.setResponseType(!1),this.processXMLHttpRequest(e),this._xmlHttpRequest&&Sys.Browser.agent===Sys.Browser.Firefox&&this.onReadyStateChange()},i}(a.a);Object(i.a)(o,"Common.SynchronousXMLHttpExecutor",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0);var r=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._responseAvailable=!1,t._started=!1,t._response=null,t._data=null,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.verifyRequestValidity=function(e){if(this._started)throw Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted,"executeRequest"));if(!e)throw Error.argumentNull("webRequest",Sys.Res.nullWebRequest)},r.get_aborted=function(){return!1},r.get_responseAvailable=function(){return this._responseAvailable},r.get_started=function(){return this._started},r.get_timedOut=function(){return!1},r.executeRequest=function(){var e=this,t=this.get_webRequest();this.verifyRequestValidity(t);var n=t.get_body(),i={};if(t.get_headers()){var r=t.get_headers();for(var a in r){var o={key:a,value:r[a]};"function"!=typeof o.value&&(i[o.key]=o.value)}}"post"===t.get_httpVerb().toLowerCase()&&(i["Content-Type"]||(i["Content-Type"]="application/x-www-form-urlencoded"),n=n||""),i["X-Requested-With"]="Fetch";var s={};s.body=n,s.headers=i,s.keepalive=!0,s.method=t.get_httpVerb(),s.mode="same-origin",window.fetch(t.getResolvedUrl(),s).then((function(t){return e._response=t,t.text()}),(function(e){return null})).then((function(t){return e._responseAvailable=!0,e.get_webRequest().completed(Sys.EventArgs.Empty),e._data=t,null}),(function(e){return null})),this._started=!0},r.getResponseHeader=function(e){var t="";return this._response.headers.has(e)&&(t=this._response.headers.get(e)),t},r.getAllResponseHeaders=function(){var e={};return this._response.headers.forEach((function(t,n,i){e[t]=n})),this._response.headers.toString(),JSON.stringify(e)},r.get_responseData=function(){return this._data},r.get_statusCode=function(){return this._response.status},r.get_statusText=function(){return this._response.statusText},r.get_xml=function(){return null},r.abort=function(){0},i}(Sys.Net.WebRequestExecutor);Object(i.a)(r,"FetchKeepAliveExecutor",Sys.Net.WebRequestExecutor,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"ProcessContextSetOperation",(function(){return a}));var i=n(0),r=n(178);n(9);var a=function(e){var t,i;function r(){var t;return(t=e.call(this)||this)._contextSet=null,t._nextContextIndex=0,t._stopOnFirstResponse=!1,t}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var a=r.prototype;return a.recycle=function(){e.prototype.recycle.call(this),Array.add(r._instances,this)},a.run=function(){n(61).ActionManager;var e=n(61).ActionManager;if(1!==this.processCurrentOperation()){for(var t=this._contextSet.length,i=this._nextContextIndex;i<t&&(this.response<=2||!this._stopOnFirstResponse);i++){0,this._nextContextIndex=i+1;var r=this._contextSet.getContext(i);if(this.setCurrentOperationFromContext(r),1===this.processCurrentOperation())return;if(this.timeoutExceeded&&i!==t-1)return void this.yield()}this._response=e.mergeResponses(this.response,2),this.setIsCompleted()}},r.registerInstance=function(e,t,n,i,a,o,s,l,c){var u;var d=r._instances.length;return d?(u=r._instances[d-1],Array.removeAt(r._instances,d-1)):u=new r,u.init(t),u.setDebugName("Context Set Operation"),u.initAction(e,i,a,s,l,c),u._contextSet=n,u._nextContextIndex=0,u._response=1,u._stopOnFirstResponse=1===a,u},r}(r.a);a._instances=[],Object(i.a)(a,"ProcessContextSetOperation",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"ProcessContextOperation",(function(){return o}));var i=n(0),r=n(178),a=(n(9),n(117));var o=function(e){var t,i;function r(){var t;return(t=e.call(this)||this)._context=null,t._shouldSpecialize=!1,t._stage=0,t}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var o=r.prototype;return o.recycle=function(){e.prototype.recycle.call(this),Array.add(r._instances,this)},o.run=function(){n(61).ActionManager,n(61).ActionManager;if(!this._stage){var e=this.processCurrentOperation();if(1===e)return;if(!e){0;var t=this._actionManager.getActionMetadata(this.actionId),i=this._context.contextId,r=null,o=null;if(t&&(r=t.asyncHandlers[i],o=t.handlers[i]),o||r){0;var s=t.flags[1024],l=t.flags[4],c=t.flags[2048];if(this._actionManager.isOffline?c:!s&&!l||s&&2===this._actionManager.mode||l&&3===this._actionManager.mode){if(t.flags[1]&&(void 0===this._actionData||null===this._actionData))return this._response=16,void this.setIsCanceled();if(t.flags[8]&&!this.reportingData)return this._response=16,void this.setIsCanceled();if(t.flags[512]&&a.a.instance.isConsentNeeded)return this._response=16,void this.setIsCanceled();if(r){if(r(this,this.actionId,this._context,this.behavior,this.reportingData,this._actionData),1===this.processCurrentOperation())return}else this._response=o(this.actionId,this._context,this.behavior,this.reportingData,this._actionData)}else this._response=4}}this._stage=this.response>2?2:1}if(1===this._stage&&this._shouldSpecialize){if(!this.childOperation){var u=this._context.nextContext;u?this.setCurrentOperationFromContext(u):this._response=2}if(1===this.processCurrentOperation())return}this._stage=2,2===this._stage&&this.setIsCompleted()},r.registerInstance=function(e,t,i,a,o,s,l,c,u){var d;n(61).ActionManager,n(61).ActionManager;var p=r._instances.length;return p?(d=r._instances[p-1],Array.removeAt(r._instances,p-1)):d=new r,d.init(t),d.setDebugName("ProcessContextOperation"),d.initAction(e,a,o,l,c,u),d._context=i,d._shouldSpecialize=s,d._stage=0,d},r}(r.a);o._instances=[],Object(i.a)(o,"ProcessContextOperation",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"registerActions",(function(){return c})),n.d(t,"registerShortcuts",(function(){return u})),n.d(t,"generateAnimationStatsDiv",(function(){return h}));var i=n(25),r=n(20),a=n(29),o=n(22),s=n(35),l=n(8),c=function(e){e.addAction(l.a.toggleAnimations,s.a.frame,d),e.addAction(l.a.getAnimationStats,s.a.frame,p)},u=function(e){e.getScope(n(31).AFrame.appFocusId).bindAction(r.KeyInputManager.hashKey(i.a.VK_O,5),l.a.toggleAnimations)},d=function(e,t,n,i,r){return a.WacAirSpace.toggleAnimation(),32},p=function(e,t,n,i,r){return h(),32},h=function(){var e=a.WacAirSpace.getAnimationStats(),t=document.getElementById("WacAirSpaceStats");t||((t=document.createElement("div")).style.display="none",t.id="WacAirSpaceStats",document.body.appendChild(t)),o.DomUtils.clearElement(t);var n=document.createElement("div");n.id="WacAirSpaceNumElements",n.innerText=e.length.toString(),t.appendChild(n);for(var i=0;i<e.length;i++){var r=document.createElement("div");r.id="WacAirSpaceStat"+i;var s=e[i],l=document.createElement("div");l.id="WacAirSpaceElementsAnimated"+i,l.innerText=s.elementIds,r.appendChild(l);var c=document.createElement("div");c.id="WacAirSpaceAnimationFps"+i,c.innerText=s.fps.toString(),r.appendChild(c);var u=document.createElement("div");u.id="WacAirSpaceMin"+i,u.innerText=s.min.toString(),r.appendChild(u);var d=document.createElement("div");d.id="WacAirSpaceMax"+i,d.innerText=s.max.toString(),r.appendChild(d);var p=document.createElement("div");p.id="WacAirSpaceStdDev"+i,p.innerText=s.stdDev.toString(),r.appendChild(p);var h=document.createElement("div");h.id="WacAirSpaceStartTime"+i,h.innerText=s.startTime.toString(),r.appendChild(h);var m=document.createElement("div");m.id="WacAirSpaceEndTime"+i,m.innerText=s.endTime.toString(),r.appendChild(m),t.appendChild(r)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i=function(e){return 3===e.nodeType?e.nodeValue:e.textContent||e.innerText},r=function(e){if(!e||1!==e.nodeType)return null;if(e.outerHTML)return e.outerHTML;var t,n=document.createElement("div"),i=e.cloneNode(!0);return n.appendChild(i),t=n.innerHTML,n.removeChild(i),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(245);var a=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"IntDictionary",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(63),a=(n(9),n(259));function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){this._list=new r.a}var t,n,i,s=e.prototype;return s.add=function(e,t){var n;for(n=0;n<this._list.get_count();++n){if(this._list.get_item(n).priority>e)break}this._list.insert(n,new a.a(e,t))},s.remove=function(e){for(var t=0;t<this._list.get_count();++t){if(this._list.get_item(t).data===e)return void this._list.removeAt(t)}},s.get_item=function(e){return this._list.get_item(e).data},t=e,(n=[{key:"length",get:function(){return this._list.get_count()}}])&&o(t.prototype,n),i&&o(t,i),e}();Object(i.a)(s,"PriorityList",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(2),a=(n(9),n(259));function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){this._queue=[]}var t,n,i,s=e.prototype;return s.peekAt=function(e){var t=this._queue[e];return t?t.data:null},s.removeAt=function(e){Array.removeAt(this._queue,e)},s.enqueue=function(e,t){var n=0;if(!this.isEmpty){var i,r,o=0,s=this._queue.length-1;do{if(i=Math.ceil((o+s)/2),(r=this._queue[i]).priority<e)o=i+1;else{if(!(r.priority>e))break;s=i-1}}while(o<=s);for(n=i;n<=s&&this._queue[n].priority<=e;)n++}Array.insert(this._queue,n,new a.a(e,t))},s.dequeue=function(){var e=this.peekAt(0);return e?(this.removeAt(0),e):null},e.compare=function(e,t){if(Object(r.c)(a.a,e)&&Object(r.c)(a.a,t)){var n=e,i=t;return n.priority<i.priority?-1:n.priority===i.priority?0:1}throw Error.create("Invalid parameter passed to Sort.Compare")},t=e,(n=[{key:"isEmpty",get:function(){return!this._queue.length}},{key:"length",get:function(){return this._queue.length}}])&&o(t.prototype,n),i&&o(t,i),e}();Object(i.a)(s,"PriorityQueue",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(41),a=(n(9),n(10));function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(e){var t,n,i,s,l;function c(t,n,i,r,a,o,s,l,c,u,d,p,h,m){var g;return(g=e.call(this,t,o,h,m)||this)._client=i,g._element=r,g._screen=a,g._caught=s,g._button=n,g._shiftKey=l,g._altKey=c,g._ctrlKey=u,g._metaKey=d,g.userData=p,g}return n=e,(t=c).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,c.createFromMouseEvent=function(e,t,n,i,a){if(i.rawEvent){var o=i.rawEvent,s=r.EventHandlerArgs.getSourceElement(i),l=new Sys.UI.Point(o.clientX,o.clientY),u=new Sys.UI.Point(o.screenX,o.screenY);return new c(e,r.EventHandlerArgs.getMouseButton(o),l,null,u,s,t,o.shiftKey,o.altKey,o.ctrlKey,o.metaKey,n,i,a)}var d=i.target,p=new Sys.UI.Point(i.clientX,i.clientY),h=new Sys.UI.Point(i.screenX,i.screenY);return new c(e,i.button,p,null,h,d,t,i.shiftKey,i.altKey,i.ctrlKey,!1,n,i,a)},c.createFromTouchArgs=function(e){var t=e.innerEvent.rawEvent,n=!1,i=!1,r=!1,a=!1;return t?(n=t.shiftKey,i=t.altKey,r=t.ctrlKey,a=t.metaKey):(n=e.innerEvent.shiftKey,i=e.innerEvent.altKey,r=e.innerEvent.ctrlKey),new c(e.eventName,Sys.UI.MouseButton.leftButton,e.clientPoint,e.elementPoint,e.screenPoint,e.sourceElement,e.caughtElement,n,i,r,a,e.userData,e.innerEvent,3)},c.changeUserData=function(e,t){e.userData=t},i=c,(s=[{key:"action",get:function(){return this.eventName}},{key:"mouseButton",get:function(){return this._button}},{key:"clientPoint",get:function(){return this._client}},{key:"screenPoint",get:function(){return this._screen}},{key:"elementPoint",get:function(){return this._element||(this._element=r.EventHandlerArgs.getElementPoint(this._client,this.sourceElement)),this._element}},{key:"caughtElement",get:function(){return this._caught}},{key:"shiftKey",get:function(){return this._shiftKey}},{key:"altKey",get:function(){return this._altKey}},{key:"ctrlKey",get:function(){return this._ctrlKey}},{key:"metaKey",get:function(){return this._metaKey}},{key:"commandKey",get:function(){return a.a.isMac?this._metaKey:this._ctrlKey}}])&&o(i.prototype,s),l&&o(i,l),c}(r.EventHandlerArgs);Object(i.a)(s,"ClickEventArgs",r.EventHandlerArgs,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(0),r=(n(9),n(54),n(326)),a=n(17),o=n(328),s=n(114),l=n(3),c=n(240),u=function(){function e(){this._lastClickEvent=null,this._clickPendingPoint=null}var t=e.prototype;return t.onTouchStart=function(t,n){e._sClickPossible=!0,this._clickPendingPoint=new Sys.UI.Point(t.elementPoint.x,t.elementPoint.y),this.isDoubleClick(t,n)&&a.a.cancelEventInternal(t.innerEvent,!0)},t.onTouchMove=function(t){this._clickPendingPoint&&(this._clickPendingPoint=Math.pow(this._clickPendingPoint.x-t.elementPoint.x,2)+Math.pow(this._clickPendingPoint.y-t.elementPoint.y,2)<=e.clickDistanceThreshold?this._clickPendingPoint:null)},t.onTouchEnd=function(t,n){var i=new o.a;if(this._clickPendingPoint&&e._sClickPossible){0,i.isTouchClick=!0,i.clickArgs=r.a.createFromTouchArgs(t);var a=t;this.isDoubleClick(t,n)&&(i.isTouchDoubleClick=!0,a=null),this._lastClickEvent=a}return this._clickPendingPoint=null,i},t.onTouchCancel=function(e){this._clickPendingPoint=null},t.cancelPendingClick=function(){this._clickPendingPoint=null},t.isDoubleClick=function(t,i){var r=!!this._lastClickEvent&&t.timestamp.getTime()-this._lastClickEvent.timestamp.getTime()<=e.doubleTapTimeThreshold&&Math.abs(t.screenPoint.x-this._lastClickEvent.screenPoint.x)<=40&&Math.abs(t.screenPoint.y-this._lastClickEvent.screenPoint.y)<=40;if(n(1).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SelectWordOnDoubleTapIsEnabled")&&!r&&i){if(t.caughtElement.nodeName!==i.caughtElement.nodeName&&(Sys.UI.DomElement.containsCssClass(t.caughtElement,e.attachedToBeginningClassName)||Sys.UI.DomElement.containsCssClass(i.caughtElement,e.attachedToBeginningClassName)))return l.ULS.sendTraceTag(594043422,324,50,"Potential false double-tap on floating element avoided"),!1;r=t.timestamp.getTime()-i.timestamp.getTime()<=e.doubleTapTimeThreshold&&Math.abs(t.screenPoint.x-i.screenPoint.x)<=40&&Math.abs(t.screenPoint.y-i.screenPoint.y)<=40}return r},e.getTouchClickAdapter=function(t){var n=s.a(t,e.touchClickAdapterDataName);return n||(n=new e,s.b(t,e.touchClickAdapterDataName,n)),n},e.cancelAllPendingClicks=function(){e._sClickPossible=!1},e}();u.touchClickAdapterDataName=c.a._touchClickAdapterCache,u.doubleTapTimeThreshold=1e3,u.clickDistanceThreshold=100,u._sClickPossible=!0,u.attachedToBeginningClassName="AttachedToBeginning",Object(i.a)(u,"TouchClickAdapter",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.isTouchClick=!1,this.isTouchDoubleClick=!1,this.clickArgs=null};Object(i.a)(r,"TouchClickResult",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=(n(9),n(3)),a=function(){function e(){}var t=e.prototype;return t.sendTraceTag=function(e,t,n,i){r.ULS.sendTraceTag(e,t,n,i)},t.shipAssertTag=function(e,t,n,i){r.ULS.shipAssertTag(e,t,n,i)},t.debugAssertTag=function(e,t,n,i){0},t.debugTraceTag=function(e,t,n,i){},e}();Object(i.a)(a,"UlsExternalLogger",null,[80])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){var t;t=window.g_badCastCallback,window.g_badCastCallback=null;try{e()}finally{window.g_badCastCallback=t}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e,t,n){this.id=e,this.type=t,this.flags=n};Object(i.a)(r,"PropertyDefinition",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.refresh="refresh",Object(i.a)(r,"HostExecutableActions",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(118);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,r,o;function s(){var t;return(t=e.call(this)||this).DisplayName=null,t.PersonaId=null,t.IsAnonymous=!1,t}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,(r=[{key:"ControlType",get:function(){return 4}}])&&a(i.prototype,r),o&&a(i,o),s}(r.a);Object(i.a)(o,"PersonaButtonProps",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(16),a=function(){function e(e,t){this._url=e,this._openInCurrentTab=t}var t=e.prototype;return t.attachDialog=function(e){},t.doDownload=function(){this._openInCurrentTab?r.a.downloadFile(this._url):r.a.safelyOpenWindow(this._url,"_blank",void 0,void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")},t.dispose=function(){},e}();Object(i.a)(a,"OpenUrlInTabDialogDownloadBehavior",null,[75,4])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);n(9);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){}var t,n,i;return t=e,i=[{key:"controlBehaviorFactory",get:function(){return e._instance},set:function(t){e._instance=t}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();a._instance=null,Object(i.a)(a,"ControlBehaviorFactoryProvider",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(92);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,r,o;function s(){var t;return(t=e.call(this)||this).McuLayout=!1,t.McuExternalId=null,t.Command=null,t.QueryCommand=null,t.CommandPreviewId=null,t.CommandRevertId=null,t.Width=0,t.Colors=null,t.Stateful=!1,t.SelectedColorId=null,t}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,(r=[{key:"ControlType",get:function(){return 7}}])&&a(i.prototype,r),o&&a(i,o),s}(r.a);Object(i.a)(o,"ColorPickerControlProps",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(92);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(e){var t,n,i,r,o;function s(){var t;return(t=e.call(this)||this).Type=0,t.Width=0,t.ElementDimensions=null,t.ExternalGalleryId=null,t.Title=null,t.GalleryItems=null,t.GalleryStyle=null,t}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,(r=[{key:"ControlType",get:function(){return 8}}])&&a(i.prototype,r),o&&a(i,o),s}(r.a);Object(i.a)(o,"GalleryProps",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(0),r=n(2),a=n(264),o=(n(9),n(161)),s=(n(5),n(51));function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(e){var t,i;function a(t,n,i,r){return e.call(this,t,n,i,"",null,r)||this}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var c,u,d,p=a.prototype;return p.refreshInternal=function(){this.needsDelayIniting&&this.doDelayedInit(),this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.elementInternal),e.prototype.refreshInternal.call(this)},p.ensureCorrectChildType=function(e){if(!Object(r.c)(o.a,e))throw Error.create("Only children of Section can be added to a Layout")},c=a,(u=[{key:"cssClass",get:function(){return"cui-layout"}},{key:"visibleInDOM",get:function(){var e=n(279).Group;return!!Object(r.c)(e,this.parent)&&this.parent.selectedLayout===this},set:function(e){Object(s.b)(a.prototype,this,"visibleInDOM",e)}}])&&l(c.prototype,u),d&&l(c,d),a}(a.a);Object(i.a)(c,"Layout",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.tabId="TabId",Object(i.a)(r,"RibbonSQMProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(2),a=n(49),o=function(){function e(){this._eventSource=new a.a,$addHandler(window,"resize",Object(r.d)(this,this.resizeHandler,"resizeHandler"))}var t=e.prototype;return t.add_onResize=function(e){this._eventSource.addHandler("Resize",e)},t.remove_onResize=function(e){this._eventSource.removeHandler("Resize",e)},t.notifyResize=function(){this._eventSource.raiseEvent("Resize")},t.dispose=function(){$removeHandler(window,"resize",Object(r.d)(this,this.resizeHandler,"resizeHandler")),this._eventSource.dispose(),this._eventSource=null},t.resizeHandler=function(e){this._eventSource.raiseEvent("Resize")},e}();Object(i.a)(o,"WindowResizeEventSource",null,[7,4])},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(0),r=n(23),a=(n(9),n(7)),o=n(64),s=n(202),l=n(72),c=n(5),u=n(6),d=n(51);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,i)||this)._displayMode=null,r._useCheckMark=!1,r._usePseudoCheckMark=!1,r._useUncheckedImage=!1,r._checkMarkImage=null,r._uncheckMarkImage=null,r._checkMarkImageClass=null,r._uncheckMarkImageClass=null,r._id$1=n,r.initializeCheckMarkProperties(t,i),r.addDisplayModes(),r.stateProperties[l.a.On]=u.a.isTrue(i.IsChecked),r.stateProperties[l.a.Visible]=r.visible,r.stateProperties[l.a.SourceControlId]=n,r.stateProperties[l.a.LabelText]=r.labelText=r.properties.LabelText,r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var h,m,g,f=i.prototype;return f.createComponentDomForDisplayMode=function(e){return this._displayMode=e,(new s.a).buildControlDom(this,e)},f.onStateChanged=function(){this.setState(this.stateProperties[l.a.On])},f.getTextValue=function(){return this.labelText},f.setState=function(e){var t=this;this.useCheckMark&&this.useUncheckedImage&&this.setCheckUncheckImageProperties(e),this.controlComponentDomCache.forEach((function(n){t.setStateOnElement(n.elmControl,e)}))},f.initializeCheckMarkProperties=function(e,t){this._useCheckMark=u.a.isTrue(t.UseCheckMark),this._usePseudoCheckMark=u.a.isTrue(t.UsePseudoCheckMark),this._useUncheckedImage=u.a.isTrue(t.UseUncheckedImage),this.useUncheckedImage&&(this._uncheckMarkImage=c.c(t.UncheckedImage)?e.properties.ImageUncheckMark:t.UncheckedImage,this._uncheckMarkImageClass=c.c(t.UncheckedImageClass)?e.properties.ImageUncheckMarkClass:t.UncheckedImageClass),this.useCheckMark&&(this._checkMarkImage=c.c(t.CheckedImage)?e.properties.ImageCheckMark:t.CheckedImage,this._checkMarkImageClass=c.c(t.CheckedImageClass)?e.properties.ImageCheckMarkClass:t.CheckedImageClass,t.Image16by16=this.checkMarkImage,t.Image16by16Class=this.checkMarkImageClass),c.c(t.IsChecked)||this.setCheckUncheckImageProperties(u.a.isTrue(t.IsChecked))},f.setCheckUncheckImageProperties=function(e){this.properties.Image16by16=e?this.checkMarkImage:this.uncheckMarkImage,this.properties.Image16by16Class=e?this.checkMarkImageClass:this.uncheckMarkImageClass},f.setStateOnElement=function(e,t){var n;c.c(e)||(this.useCheckMark?(this.useUncheckedImage||u.a.toggleCSSClassOnElement(e,"cui-ctl-unchkd",!t),n=a.a.ariaCheckedAttribute):(u.a.toggleCSSClassOnElement(e,"cui-ctl-on",t),n=this._displayMode&&o.a.isDisplayModeMenu(this._displayMode)?a.a.ariaCheckedAttribute:a.a.ariaPressedAttribute),a.a.setAriaAttribute(e,n,t?a.a.ariaTrueValue:a.a.ariaFalseValue))},f.addDisplayModes=function(){this.addDisplayMode("Small"),this.addDisplayMode("Small14"),this.addDisplayMode("Small24"),this.addDisplayMode("Medium"),this.addDisplayMode("Medium14"),this.addDisplayMode("Medium20"),this.addDisplayMode("Large"),this.addDisplayMode("Large16"),this.addDisplayMode("Large30"),this.addDisplayMode("LargeNoText"),this.addDisplayMode("Menu"),this.addDisplayMode("Menu16"),this.addDisplayMode("Menu20"),this.addDisplayMode("Menu32"),this.addDisplayMode("Menu48"),this.addDisplayMode("MenuTellMe")},f.constructClonedControl=function(e,t){return new i(e,this.id,t)},h=i,(m=[{key:"useCheckMark",get:function(){return this._useCheckMark}},{key:"usePseudoCheckMark",get:function(){return this._usePseudoCheckMark}},{key:"useUncheckedImage",get:function(){return this._useUncheckedImage}},{key:"checkMarkImage",get:function(){return this._checkMarkImage}},{key:"uncheckMarkImage",get:function(){return this._uncheckMarkImage}},{key:"checkMarkImageClass",get:function(){return this._checkMarkImageClass}},{key:"uncheckMarkImageClass",get:function(){return this._uncheckMarkImageClass}},{key:"controlType",get:function(){return r.Control.toggleButtonControlType}},{key:"needsAKeytip",get:function(){return!0}},{key:"ariaRole",get:function(){return this.inMenu?this.useCheckMark||this.usePseudoCheckMark?a.a.ariaMenuItemCheckBoxRole:a.a.ariaMenuItemRadioRole:this.useCheckMark?a.a.ariaCheckBoxRole:Object(d.a)(i.prototype,this,"ariaRole")}},{key:"focusableElement",get:function(){return this.getDisplayedComponentElement()}},{key:"activatesOnPress",get:function(){return!this.isStandardMenuItem()}},{key:"properties",get:function(){return this.controlProperties}}])&&p(h.prototype,m),g&&p(h,g),i}(r.Control);Object(i.a)(h,"ToggleButton",r.Control,[88])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(167);var a=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).cloneControlsForMenu=!1,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"MenuBuildContext",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.id=null,this.queryType=0,this.handler=null,this.data=null};Object(i.a)(r,"DataQuery",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.success=!1,this.id=null,this.queryData=null,this.contextData=null};Object(i.a)(r,"DataQueryResult",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=n(201),a=n(5),o=function(){function e(){}var t=e.prototype;return t.pollForCommandState=function(e,t,n,i,o,s){var l=0;if(e){this.pollForEnabledDisabledControlState(e,n,o)&&(l|=1);var c=new r.a;c.CommandLocation=t,null!=s&&(c.InvocationMethod=s),!a.c(i)&&e.executeRootCommand(i,o,c)&&(l|=2)}return l},t.pollForEnabledDisabledControlState=function(e,t,n){return void 0===n&&(n=null),!!e&&e.isRootCommandEnabled(t,n)},e}();Object(i.a)(o,"RootPoller",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(0),r=n(87),a=n(1),o=n(347),s=n(125),l=n(25),c=n(21),u=n(8),d=n(51);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(e){var t,n;function i(t,n,i,r,a,o){return e.call(this,t,n,i,r,a,o)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,h,m,g=i.prototype;return g.onPointerOut=function(e){return!1},g.onMenuClosed=function(){s.c(this.elementInternal,a.AFrameworkApplication.activeFrame.activeModalUIZIndex+1),e.prototype.onMenuClosed.call(this)},g.setFocus=function(t){if(c.a.instance.tryResolve("Common.IFileMenuSQMInformation")){var n={};n[o.a.pageId]=this.id,a.AFrameworkApplication.theActionManager.processActionWithData(u.a.reportFileMenuPageSwitch,2,n)}e.prototype.setFocus.call(this,1)},g.onKeyPress=function(t){var n=t.innerEvent.rawEvent;return!(n&&n.keyCode===l.a.vK_Enter&&n.target&&"a"===n.target.tagName.toLowerCase()&&n.target.href&&"#"!==n.target.href)&&e.prototype.onKeyPress.call(this,t)},r=i,(h=[{key:"cssClass",get:function(){var e=Object(d.a)(i.prototype,this,"cssClass")+" "+i.jewelSubmenuClass;return a.AFrameworkApplication.appSettingsManager&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(e+=" "+i.jewelSubmenuColorUpdateClass),e}}])&&p(r.prototype,h),m&&p(r,m),i}(r.Menu);h.jewelSubmenuClass="cui-jewelsubmenu",h.jewelSubmenuColorUpdateClass="cui-color-update",Object(i.a)(h,"JewelSubMenu",r.Menu,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.pageId="PageId",Object(i.a)(r,"FileMenuSQMProperties",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.launchedLeft=!1,this.launchedUp=!1,this.viewPortHeight=0,this.viewPortWidth=0,this.flyoutTop=0,this.flyoutLeft=0,this.flyoutWidth=0,this.flyoutHeight=0};Object(i.a)(r,"MenuPositioningInfo",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.updateRibbonControls=null,this.trimmedIds=null,this.whitelistedControlIds=null,this.isViewer=!1,this.statusBarId=null};Object(i.a)(r,"ReactStatusBarInitOptions",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0),r=(n(9),n(344)),a=n(3),o=function(){function e(e,t){this._ribbonData=null,this._tabData={},this._rootDataVarName=e,this._cuiHelper=t}var t=e.prototype;return t.getData=function(e){var t=this.lookupData(e);return void 0!==this._cuiHelper&&null!==this._cuiHelper&&this._cuiHelper.updateData(t),t},t.lookupData=function(e){return window[e]},t.runQuery=function(e){if(null!=e){var t=null,n=!1;switch(e.queryType){case 1:case 4:case 2:t=this.getRootData(),n=!0;break;case 3:var i;if(!(n=!!(t=this._tabData[e.id])))a.ULS.sendTraceTag(5247233,207,50,"{0}",((i={}).Msg="Tab not available",i.Id=e.id,i));break;default:0}var o=new r.a;o.success=n,o.id=e.id,o.contextData=e.data,o.queryData=t,e.handler(o)}},t.getRootData=function(){return this._ribbonData||(this._ribbonData=this.getData(this._rootDataVarName))},t.addTabData=function(e,t){this._tabData[e]=this.getData(t)},e}();Object(i.a)(o,"JsonDataSource",null,[210])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=n(1),a=n(251),o=n(210);var s=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).staticUiTouchMode=!1,t.isOneRowToolbar=!1,t.supportsEmphasizedControls=!1,t.maxElementsBeforeOverflow=r.AFrameworkApplication.isMobileMode?1:a.a.defaultHeroControlCount,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(o.a);Object(i.a)(s,"ToolbarBuildOptions",o.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(164);var a=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.suppressError=function(t){return!t.source||e.prototype.suppressError.call(this,t)},i}(r.a);Object(i.a)(a,"WordViewerErrorHandler",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.reactStatusBarHeight=25,Object(i.a)(r,"StatusBarConstants",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e,t){this.firstPage=e,this.lastPage=t};Object(i.a)(r,"PageData",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(152),o=n(1),s=(n(9),n(12)),l=n(343),c=n(251),u=n(5),d=n(209),p=n(166),h=n(65),m=n(64),g=n(204),f=n(6),v=n(51);function _(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var S=function(e){var t,n;function i(t,n,i){var r;return(r=e.call(this,t,n,"","")||this)._alignment=i.Alignment,r._dropFromStart=i.ScalingDirection===s.a.FIRSTTOLAST,r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,o,l,c=i.prototype;return c.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.elementInternal),e.prototype.refreshInternal.call(this)},c.appendChildrenToElement=function(e){for(var t,n=_(this.children);!(t=n()).done;){var i=t.value;switch(i.ensureDOMElement(),this._alignment){case s.a.LEFTALIGN:f.a.ensureCSSClassOnElement(i.elementInternal,"cui-toolbar-button-left");break;case s.a.CENTERALIGN:f.a.ensureCSSClassOnElement(i.elementInternal,"cui-toolbar-button-center");break;case s.a.RIGHTALIGN:f.a.ensureCSSClassOnElement(i.elementInternal,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this._alignment)}i.visible&&e.appendChild(i.elementInternal),i.ensureRefreshed()}},c.ensureCorrectChildType=function(e){if(!Object(r.c)(m.a,e))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.")},c.getWidthPx=function(){var e=0;if(this.alignment===s.a.CENTERALIGN)for(var t,n=_(this.children);!(t=n()).done;){var i=t.value;i.visible&&(e+=i.elementInternal.offsetWidth)}else e=this.elementInternal.offsetWidth;return e},c.getStartPoint=function(){var e=null;if(this.alignment===s.a.CENTERALIGN)for(var t,n=_(this.children);!(t=n()).done;){var i=t.value;if(i.visible){e=Sys.UI.DomElement.getBounds(i.elementInternal);break}}else e=Sys.UI.DomElement.getBounds(this.elementInternal);return e?this.root.textDirection?e.x+e.width:e.x:0},c.getEndPoint=function(){var e=null;if(this.alignment===s.a.CENTERALIGN){if(this.children.count>0)for(var t=this.children.getEnumeratorAtPos(this.children.count-1);t.movePrevious();){var n=t.get_current();if(n.visible){e=Sys.UI.DomElement.getBounds(n.elementInternal);break}}}else e=Sys.UI.DomElement.getBounds(this.elementInternal);return e?this.root.textDirection?e.x:e.x+e.width:0},c.ensureNoChildrenScaledAway=function(){for(var e,t=_(this.children);!(e=t()).done;){var n=e.value;Object(r.c)(m.a,n)&&!n.control.visible||(n.visible=!0)}},c.scaleDownToFitSize=function(e){for(var t=this.children.toArray(),n=new g.a,i=this._dropFromStart?0:t.length-1,a=this.children.count,o=this.root.supportsInvisibleControls;this.getWidthPx()>=e&&!(i>=a||i<0);){var s=t[i];o&&Object(r.c)(m.a,s)&&s.control.visible&&(n.add(s),s.applyHideElementOverride()),i+=this._dropFromStart?1:-1}for(var l,c=_(n);!(l=c()).done;){var u=l.value;u.removeHideElementOverride(),u.visible=!1}},a=i,(o=[{key:"cssClass",get:function(){switch(this._alignment){case s.a.LEFTALIGN:return"cui-toolbar-buttondock alignleft";case s.a.CENTERALIGN:return"cui-toolbar-buttondock aligncenter";case s.a.RIGHTALIGN:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this._alignment)}}},{key:"visibleInDOM",get:function(){return!0},set:function(e){Object(v.b)(i.prototype,this,"visibleInDOM",e)}},{key:"alignment",get:function(){return this._alignment}}])&&b(a.prototype,o),l&&b(a,l),i}(h.a);function C(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(S,"ButtonDock",h.a,[]);var w=function(e){var t,n;function i(t,n,i,r,a,o,l){var c;return void 0===l&&(l=!1),(c=e.call(this,t,n,o)||this)._startDock=null,c._centerDock=null,c._endDock=null,c._multipleDocksOfSameType=!1,c._builder$3=i,c.isStaticUiTouchMode=r,c.supportsEmphasizedControls=a,c._toolbarSize=0,u.c(n.Size)||(n.Size===s.a.ONEROW||i.options.isOneRowToolbar?c._toolbarSize=0:n.Size===s.a.SINGLEDOCK&&(c._toolbarSize=1)),c._toolbarScalingOptimizationsEnabled=l,c}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,l,d,h=i.prototype;return h.addChild=function(t){if(e.prototype.addChild.call(this,t),Object(r.c)(S,t)&&!this._multipleDocksOfSameType){var n=t;n.alignment===s.a.LEFTALIGN?(this._startDock&&this.setMultipleDocksOfSameType(),this._startDock=n):n.alignment===s.a.CENTERALIGN?(this._centerDock&&this.setMultipleDocksOfSameType(),this._centerDock=n):n.alignment===s.a.RIGHTALIGN&&(this._endDock&&this.setMultipleDocksOfSameType(),this._endDock=n)}},h.setMultipleDocksOfSameType=function(){this._multipleDocksOfSameType=!0,this._startDock=null,this._centerDock=null,this._endDock=null},h.setControlVisibility=function(e,t,n){void 0===n&&(n=!0);var i=this.getControlById(e);u.c(i)||i.visible===t||(i.visible=t,n&&this.refresh())},h.refreshInternal=function(){e.prototype.refreshInternal.call(this),this.refreshInternalCore(!0)},h.refreshInternalCore=function(e){var t=this.root.controlWithFocus;u.c(this.elementInternal)&&this.createToolbarStructure(),this.elementInternal=f.a.removeChildNodes(this.elementInternal),this.hiddenLabel&&this.elementInternal.appendChild(this.hiddenLabel);for(var n,i=C(this.children);!(n=i()).done;){var r=n.value;r.visible&&(r.ensureDOMElement(),this.elementInternal.appendChild(r.elementInternal),r.ensureRefreshed())}this._centerDock&&e&&this.ensureCenterDockLayout(),t&&t.setFocusOnControl(),this.dirty=!1},h.ensureCenterDockLayout=function(){if(this._centerDock.visible&&this._centerDock.children.count&&(this.applyMarginsToCenterDock(0,0),this.doesCenterDockCollide(this._startDock,this._centerDock,this._endDock))){var e=0,t=0,n=this._startDock?this._startDock.getWidthPx():0,i=this._endDock?this._endDock.getWidthPx():0;(i>0||n>0)&&(i>n?(e=0,t=i-n):(e=n-i,t=0)),this.applyMarginsToCenterDock(e,t)}},h.doesCenterDockCollide=function(e,t,n){var i=!1;return this.root.textDirection?(e&&(i=e.getEndPoint()<t.getStartPoint()),!i&&n&&(i=t.getEndPoint()<n.getStartPoint())):(e&&(i=e.getEndPoint()>t.getStartPoint()),!i&&n&&(i=t.getEndPoint()>n.getStartPoint())),i},h.applyMarginsToCenterDock=function(e,t){this.textDirection?(this._centerDock.elementInternal.style.marginRight=e+"px",this._centerDock.elementInternal.style.marginLeft=t+"px"):(this._centerDock.elementInternal.style.marginLeft=e+"px",this._centerDock.elementInternal.style.marginRight=t+"px")},h.createToolbarStructure=function(){this.ensureDOMElement()},h.pollForStateAndUpdateInternal=function(){var e=this;this.doPoll((function(){p.a.prototype.pollForStateAndUpdateInternal.call(e)}))},h.pollForControlState=function(e){var t=this.getControlById(e);u.c(t)||this.doPoll(Object(r.d)(t,t.pollForStateAndUpdate,"pollForStateAndUpdate"))},h.doPoll=function(e){this.needScaling=!1,this.needRefresh=!1,e(),(this.needScaling||this.needRefresh)&&(this._toolbarScalingOptimizationsEnabled||this.refresh(),this.scale())},h.ensureCorrectChildType=function(e){if(!Object(r.c)(c.a,e)&&!Object(r.c)(S,e))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(r.c)(S,e)&&e.alignment===s.a.CENTERALIGN)for(var t,n=C(this.children);!(t=n()).done;){if(t.value.alignment===s.a.CENTERALIGN)throw Error.create("Can't add a centered buttondock because one is already present.")}},h.createButtonDock=function(e,t){var n=e[s.a.ATTRIBUTES];return new S(this.root,n.Id,n)},h.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this),this.elementInternal.setAttribute("role","toolbar"),this.properties.Title&&this.elementInternal.setAttribute("title",this.properties.Title)},h.updateOpenMenu=function(e){return!(!this.root||!this.root.refreshOpenMenu(e))},h.setFocusOnToolbar=function(){return this.setFocusOnFirstControl()},h.scale=function(){if(e.prototype.scale.call(this),!f.a.isTrue(this.properties.Scale))return!1;if(this._multipleDocksOfSameType)return!1;u.c(this._startDock)||(this._startDock.visible=!0,this._startDock.ensureNoChildrenScaledAway()),u.c(this._centerDock)||(this._centerDock.visible=!0,this._centerDock.ensureNoChildrenScaledAway()),u.c(this._endDock)||(this._endDock.visible=!0,this._endDock.ensureNoChildrenScaledAway()),this.refreshInternalCore(!1);var t=this.elementInternal.offsetWidth,n=u.c(this._startDock)?0:this._startDock.getWidthPx(),i=u.c(this._centerDock)?0:this._centerDock.getWidthPx(),r=u.c(this._endDock)?0:this._endDock.getWidthPx();return r+i+n>=t&&(r+n>=t?(this.hideDockIfPresent(this._centerDock),r>=t?(this.hideDockIfPresent(this._startDock),this.scaleDockIfPresent(this._endDock,t)):this.scaleDockIfPresent(this._startDock,t-r)):this.scaleDockIfPresent(this._centerDock,t-r-n)),this.needScaling=!1,this.refreshInternal(),!1},h.hideDockIfPresent=function(e){e&&(e.visible=!1)},h.scaleDockIfPresent=function(e,t){e&&e.scaleDownToFitSize(t)},a=i,(l=[{key:"supportsInvisibleControls",get:function(){return!0}},{key:"cssClass",get:function(){var e="cui-toolbar-toolbar ";return this._toolbarSize?1===this._toolbarSize&&(e+="cui-toolbar-singledock "):(e+="cui-toolbar-onerow ",o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||(e+="UITextTranformUpperCase ")),e+Object(v.a)(i.prototype,this,"cssClass")}},{key:"domElementTagName",get:function(){return"div"}},{key:"rootType",get:function(){return 26}},{key:"toolbarBuilder",get:function(){return this.builder},set:function(e){this.builder=e}}])&&I(a.prototype,l),d&&I(a,d),i}(d.a);function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}w.oneRowToolbarHeightPx=26,Object(i.a)(w,"Toolbar",d.a,[230]);var E=function(e){var t,n,i,r,a;function s(t,n,i,r,a){var o;return void 0===a&&(a=!1),(o=e.call(this,t,n,i,!1,!1,r,a)||this)._launchMenusUp=!0,o}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=s,a=[{key:"statusBarClassName",get:function(){var e="cui-statusbar";return o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||(e+=" UISmallFont UITextTranformUpperCase"),e}}],(r=[{key:"rootType",get:function(){return 7}},{key:"cssClass",get:function(){return s.statusBarClassName+" "+Object(v.a)(s.prototype,this,"cssClass")}}])&&T(i.prototype,r),a&&T(i,a),s}(w);Object(i.a)(E,"StatusBar",w,[]);var k=n(167);var M=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).toolbar=null,t.isStatusBar=!1,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(k.a);Object(i.a)(M,"ToolbarBuildContext",k.a,[]);var P=n(109);function F(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return R}));var R=function(e){var t,n;function i(t,n,i,r){var a;if(a=e.call(this,t,n,P.Task.fromResult(i),r)||this,u.c(n))throw Error.create("Toolbar placeholder DOM element is null or undefined.");return a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,d,p,h=i.prototype;return h.set_toolbar=function(e){return this.root=e,e},h.buildToolbar=function(){var e=new M,t=new l.a;t.id="toolbar",t.queryType=1,t.handler=Object(r.d)(this,this.onReturnToolbarData,"onReturnToolbarData"),t.data=e,this.dataSource.runQuery(t)},h.onReturnToolbarData=function(e){var t=this,n=e.contextData;this.set_toolbar(this.buildToolbarFromData(e.queryData,n)),this.toolbar.toolbarBuilder=this,this.toolbar.refreshInternal(),this.placeholder.appendChild(this.toolbar.elementInternal),f.a.ensureCSSClassOnElement(this.placeholder,"loaded"),this.buildClientTask.CWo((function(e){t.buildClientTask.get_result().onComponentBuilt(t.toolbar,t.toolbar.id)}),11)},h.buildToolbarFromData=function(e,t){var n=s.a.getFirstChildNodeWithName(e,s.a.TOOLBAR);if(u.c(n)&&(n=s.a.getFirstChildNodeWithName(e,s.a.STATUSBAR),t.isStatusBar=!0),u.c(n))throw Error.create("No toolbar element was present in the data");var i=new s.a(n),r=o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ToolbarScalingRedundancyEliminationIsEnabled");t.isStatusBar?this.set_toolbar(new E(i.attributes[s.a.id],i.attributes,this,this._resizableContainer,r)):this.set_toolbar(new w(i.attributes[s.a.id],i.attributes,this,this.toolbarBuildOptions.staticUiTouchMode,this.toolbarBuildOptions.supportsEmphasizedControls,this._resizableContainer,r)),this.toolbar.clientID=this.options.clientID,this.toolbar.useDataCookie=!0,this.toolbar.refreshInternal();for(var a,l=s.a.getNodeChildren(s.a.getFirstChildNodeWithName(i.node,s.a.DOCKS)),c=F(this.buildAllDocksFromData(l,t));!(a=c()).done;){var d=a.value;this.toolbar.addChild(d)}return this.toolbar},h.buildAllDocksFromData=function(e,t){for(var n=new Array(0),i=0;i<e.length;i++)this.isNodeTrimmed(e[i])||Array.add(n,this.buildDockFromData(e[i],t));return n},h.buildDockFromData=function(e,t){var n=s.a.getNodeName(e),i=null;return n===s.a.BUTTONDOCK?i=this.buildButtonDockFromData(e,t):n===s.a.HERODOCK&&(i=this.buildHeroDockFromData(e,t)),i},h.buildHeroDockFromData=function(e,t){var n=new s.a(e),i=e[s.a.ATTRIBUTES],r=new c.a(this.root,n.attributes[s.a.id],i);r.heroControlCount=this.toolbarBuildOptions.maxElementsBeforeOverflow;for(var a=s.a.getFirstChildNodeWithName(e,s.a.CONTROLS),o=s.a.getNodeChildren(a),l=new Array(0),u=0;u<o.length;u++){var d=o[u];if(!this.isNodeTrimmed(d)){var p=this.buildControl(d,t);Array.add(l,p)}}return r.heroDockControls=l,r},h.buildButtonDockFromData=function(e,t){new s.a(e);for(var n=this.toolbar.createButtonDock(e,t),i=s.a.getFirstChildNodeWithName(e,s.a.CONTROLS),r=s.a.getNodeChildren(i),a=0;a<r.length;a++)if(!this.isNodeTrimmed(r[a])){var o=this.buildToolbarControlComponent(r[a],t);n.addChild(o)}return n},h.buildToolbarControlComponent=function(e,t){var n,i=new s.a(e),r=i.name,a=i.attributes[s.a.DISPLAYMODE];switch(n=t.isStatusBar?"Small14":"Small",r){case s.a.button:return this.buildControl(e,t).createComponentForDisplayMode(u.b(a)?n:a);case s.a.flyoutAnchor:return n=t.isStatusBar?"Medium14":"Medium",this.buildControl(e,t).createComponentForDisplayMode(u.b(a)?n:a);case s.a.label:return this.buildControl(e,t).createComponentForDisplayMode(u.b(a)?n:a);case s.a.separator:return this.buildControl(e,t).createComponentForDisplayMode("Small");case s.a.toggleButton:return this.buildControl(e,t).createComponentForDisplayMode(u.b(a)?n:a);default:throw Error.create("Invalid control type.")}},a=i,(d=[{key:"toolbar",get:function(){return this.root}},{key:"toolbarBuildOptions",get:function(){return this.options}}])&&O(a.prototype,d),p&&O(a,p),i}(a.Builder);Object(i.a)(R,"ToolbarBuilder",a.Builder,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(17),o=n(1),s=(n(9),n(54),function(){function e(e,t,n,i,r,a){this.message=e,this.source=t,this.line=n,this.column=i,this.stackReference=r,this.stack=a}var t=e.prototype;return t.isSameError=function(e){return!!e&&this.message===e.message&&this.source===e.source&&this.line===e.line&&this.column===e.column&&this.stackReference===e.stackReference&&this.stack===e.stack},t.toString=function(){return String.format("Message: {0}",this.message)},e}());Object(i.a)(s,"PageErrorEvent",null,[]);var l=function(e,t,n){this.eventCode=e,this.userData=t,this.eventObject=n};Object(i.a)(l,"PageEventArgs",null,[]);var c=function(e,t){this.handler=e,this.userData=t};Object(i.a)(c,"PageEventHandlerRecord",null,[]);var u=n(33),d=n(153),p=n(10),h=n(3),m=n(63);n.d(t,"a",(function(){return g}));var g=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._handlers=[[],[],[],[]],t._iFrameRecs=[],t._oldOnError=null,t._registered=!1,t.getOnBeforeNavigateWebkitString=null,t.registerDomEvents(),t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=i.prototype;return a.dispose=function(){this.getOnBeforeNavigateWebkitString=null,this.unregisterDomEvents(),e.prototype.dispose.call(this)},a.registerDomEvents=function(){this._registered||(this._oldOnError=window.onerror,window.onerror=Object(r.d)(this,this.onError,"onError"),Sys.Application.add_unload(Object(r.d)(this,this.onNavigate,"onNavigate")),$addHandler(window,"beforeunload",this.getOnBeforeNavigateCallback()),$addHandler(window,"resize",Object(r.d)(this,this.onResize,"onResize")),p.a.isIPad&&$addHandler(window,"pagehide",Object(r.d)(this,this.onPagehide,"onPagehide")),this._registered=!0)},a.registerIFrame=function(e){Array.add(this._iFrameRecs,e)},a.unregisterDomEvents=function(){if(this._registered){window.onerror=this._oldOnError;for(var e=0;e<this._iFrameRecs.length;e++){var t=this._iFrameRecs[e],n=this.getIFrameContentWindow(t.iFrame);n&&(n.onerror=t.oldOnError)}Array.clear(this._iFrameRecs),$removeHandler(window,"resize",Object(r.d)(this,this.onResize,"onResize")),$removeHandler(window,"beforeunload",this.getOnBeforeNavigateCallback()),Sys.Application.remove_unload(Object(r.d)(this,this.onNavigate,"onNavigate")),p.a.isIPad&&$addHandler(window,"pagehide",Object(r.d)(this,this.onPagehide,"onPagehide")),this._registered=!1}},a.getIFrameContentWindow=function(e){var t=null;try{t=e.contentWindow}catch(e){}return t},a.getOnBeforeNavigateCallback=function(){var e;p.a.isWebKit||p.a.isInternetExplorerEdge?e=Object(r.d)(this,this.onBeforeNavigateWebkit,"onBeforeNavigateWebkit"):e=Object(r.d)(this,this.onBeforeNavigate,"onBeforeNavigate");return e},a.unregisterAllHandlers=function(e){for(var t=0;t<4;t++)Array.clear(this._handlers[t])},a.registerHandler=function(e,t,n){this._handlers[e]&&Array.add(this._handlers[e],new c(t,n))},a.unregisterHandler=function(e,t){var n=this._handlers[e];if(n)for(var i=0;i<n.length;++i){if(n[i].handler===t)return void Array.removeAt(n,i)}},a.onError=function(e,t,n,r,a){try{0;var o=null,l=null;if(a)o=a.stack;else try{var c=window.event.error;c&&(o=c.stack)}catch(e){h.ULS.sendTraceTag(21561472,201,15,"Unable to grab the global error.stack property from Window.Event. Exception Message = {0}.",e.message)}if(!o){i.logCrossDomainScripErrorIfNeeded(e,t,n,r);try{l=arguments.callee.caller.caller}catch(e){h.ULS.sendTraceTag(17662367,201,15,String.format("Exception thrown in PageManager.OnError. Message:{0}. callStack:{1}.",e.message,e.stack))}h.ULS.sendTraceTag(18104455,201,15,String.format("Stack from exception object is null. Exception object = {0}. StackReference = {1}",a,l))}l||o||h.ULS.sendTraceTag(18104456,201,15,"Stack and stackReference objects are null.");var u=new s(e,t,n,null!=r?r:0,l,o);if(this._handlers[3].length>0)return this.invokeHandlers(3,u),!0}catch(e){h.ULS.sendTraceTag(21283668,201,10,"There was an unhandled exception while handling the error. Exception Message = {0}.",e.message)}return!1},a.onBeforeNavigate=function(e){h.ULS.sendTraceTag(7161411,306,50,"OnBeforeNavigate fired"),this.invokeHandlers(1,e)},a.onBeforeNavigateWebkit=function(e){return this.onBeforeNavigate(e),this.getOnBeforeNavigateWebkitString?this.getOnBeforeNavigateWebkitString():null},a.onNavigate=function(e,t){h.ULS.sendTraceTag(7161412,306,50,"OnNavigate fired"),this.invokeHandlers(2,t)},a.onResize=function(e){window.setTimeout(Object(r.d)(this,this.runResizeHandlers,"runResizeHandlers"),0)},a.runResizeHandlers=function(){this.invokeHandlers(0,null)},a.onPagehide=function(e){h.ULS.sendTraceTag(7161413,306,50,"OnPagehide fired"),this.invokeHandlers(2,e)},a.invokeHandlers=function(e,t){for(var n=this._handlers[e],i=0,r=n.length;i<r;i++){var a=n[i];a.handler(new l(e,a.userData,t))}},i.logCrossDomainScripErrorIfNeeded=function(e,t,n,i){if(!n&&!i&&!t&&e.startsWith("Script error")){var r=document.getElementsByTagName("Script");if(r){for(var a=new m.a,s=new m.a,l=0;l<r.length;l++){var c=r[l],p=c.getAttribute("src")?c.getAttribute("src").toString():"";s.add(p);var g=c.getAttribute("crossorigin");d.b(p,"http",0)&&!g&&a.add(p)}a.get_count()>0?h.ULS.sendTraceTag(21283667,201,10,String.format("The following javascript files do not have CORS set up correctly = {0}",u.c(a))):o.AFrameworkApplication.activeFrame.applicationInstance.isTelemetryForScriptsLoadedInSessionsWithSciptErrorEnabled&&h.ULS.sendTraceTag(589866587,306,50,String.format("The following javascript files were loaded in the session = {0} ",u.c(s)))}}},i}(a.a);Object(i.a)(g,"PageManager",a.a,[])},function(e,t,n){"use strict";var i=n(0),r=function(){this.ScreenWidth=0,this.ScreenHeight=0,this.WinInnerWidth=0,this.WinInnerHeight=0,this.WinOuterHeight=0,this.WinOuterWidth=0,this.WinDevicePixelRatio=0,this.CalculatedDevicePixelRatio=0,this.ScreenDeviceXdpi=0,this.ScreenDeviceYdpi=0,this.ScreenLogicalXdpi=0,this.ScreenLogicalYdpi=0,this.ScreenAvailHeight=0,this.ScreenAvailWidth=0,this.DocElemOffsetWidth=0,this.DocElemOffsetHeight=0,this.DocElemClientWidth=0,this.DocElemClientHeight=0,this.WinOrientation=0,this.SupportsTouch=!1,this.NavPlugins=null,this.NavUserAgent=null,this.NavPlatform=null,this.NavAppName=null,this.NavAppVersion=null,this.NavLanguage=null,this.Error=null};Object(i.a)(r,"BrowserInfo",null,[]);var a=function(){this.Name=null,this.Version=null};Object(i.a)(a,"PluginInfo",null,[]);var o=n(1),s=n(10),l=n(3);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return u}));var u=function(){function e(){}var t,n,i;return e.logInfo=function(){if(o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogBrowserInfoIsEnabled")){var t=e.gatherAllInfo();try{var n=JSON.stringify(t);l.ULS.sendTraceTag(6903563,102,50,n)}catch(e){l.ULS.sendTraceTag(6903564,102,15,e.message)}}else l.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")},e.getPlugins=function(){var e=window.navigator.plugins;if(!e||!e.length)return null;for(var t=new Array(0),n=0;n<e.length;n++){var i=e[n].name,r=e[n].version;Array.add(t,Object.assign(new a,{Name:i,Version:r}))}return t},e.gatherAllInfo=function(){var t=new r,n=new Sys.StringBuilder;return e.getInfoOrLogError((function(e){t.DocElemClientHeight=e}),(function(){return document.documentElement.clientHeight}),n),e.getInfoOrLogError((function(e){t.DocElemClientWidth=e}),(function(){return document.documentElement.clientWidth}),n),e.getInfoOrLogError((function(e){t.DocElemOffsetHeight=e}),(function(){return document.documentElement.offsetHeight}),n),e.getInfoOrLogError((function(e){t.DocElemOffsetWidth=e}),(function(){return document.documentElement.offsetWidth}),n),e.getInfoOrLogError((function(e){t.ScreenAvailHeight=e}),(function(){return window.screen.availHeight}),n),e.getInfoOrLogError((function(e){t.ScreenAvailWidth=e}),(function(){return window.screen.availWidth}),n),e.getInfoOrLogError((function(e){t.ScreenWidth=e}),(function(){return window.screen.width}),n),e.getInfoOrLogError((function(e){t.ScreenHeight=e}),(function(){return window.screen.height}),n),e.getInfoOrLogError((function(e){t.ScreenLogicalXdpi=e}),(function(){return window.screen.logicalXDPI}),n),e.getInfoOrLogError((function(e){t.ScreenLogicalYdpi=e}),(function(){return window.screen.logicalYDPI}),n),e.getInfoOrLogError((function(e){t.ScreenDeviceXdpi=e}),(function(){return window.screen.deviceXDPI}),n),e.getInfoOrLogError((function(e){t.ScreenDeviceYdpi=e}),(function(){return window.screen.deviceYDPI}),n),e.getInfoOrLogError((function(e){t.WinInnerHeight=e}),(function(){return window.self.innerHeight}),n),e.getInfoOrLogError((function(e){t.WinInnerWidth=e}),(function(){return window.self.innerWidth}),n),e.getInfoOrLogError((function(e){t.WinOuterHeight=e}),(function(){return window.self.outerHeight}),n),e.getInfoOrLogError((function(e){t.WinOuterWidth=e}),(function(){return window.self.outerWidth}),n),e.getInfoOrLogError((function(e){t.WinOrientation=e}),(function(){return window.self.orientation}),n),e.getInfoOrLogError((function(e){t.WinDevicePixelRatio=e}),(function(){return window.self.devicePixelRatio}),n),e.getInfoOrLogError((function(e){t.SupportsTouch=e}),(function(){return s.a.supportsTouch}),n),e.getInfoOrLogError((function(e){t.NavAppName=e}),(function(){return window.navigator.appName}),n),e.getInfoOrLogError((function(e){t.NavAppVersion=e}),(function(){return window.navigator.appVersion}),n),e.getInfoOrLogError((function(e){t.NavLanguage=e}),(function(){return window.navigator.browserLanguage||window.navigator.language}),n),e.getInfoOrLogError((function(e){t.NavUserAgent=e}),(function(){return window.navigator.userAgent}),n),e.getInfoOrLogError((function(e){t.NavPlatform=e}),(function(){return window.navigator.platform}),n),e.getInfoOrLogError((function(e){t.NavPlugins=e}),e.getPlugins,n),e.getInfoOrLogError((function(e){t.CalculatedDevicePixelRatio=e}),(function(){return e.devicePixelRatio}),n),t.Error=n.toString(),t},e.getInfoOrLogError=function(e,t,n){try{e(t())}catch(e){n.isEmpty()||n.append(" | "),n.append(e.message||"null")}},t=e,i=[{key:"devicePixelRatio",get:function(){var e=window.devicePixelRatio;return isNaN(e)?window.screen.deviceXDPI/window.screen.logicalXDPI:e}}],(n=null)&&c(t.prototype,n),i&&c(t,i),e}();Object(i.a)(u,"BrowserInfoLogger",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(241),a=n(306),o=n(221),s=n(333),l=function(){function e(){}var t=e.prototype;return t.createProps=function(e,t){if(e&&!(e.length<1)&&t){var n=Object.assign(new o.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.createFlyoutAnchorProps(e,n.ControlList),t.push(n)}},t.createFlyoutAnchorProps=function(e,t){var n=Object.assign(new r.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new a.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(t,n);var i=Object.assign(new o.a,{Title:"",ControlList:[]});Array.add(n.Menu.MenuSectionList,i),this.createPersonaButtonProps(e,i.ControlList)},t.createPersonaButtonProps=function(e,t){for(var n=0;n<e.length;n++){var i=Object.assign(new s.a,{ExternalId:String.format("CoauthorPersona_{0}",n),Command:"336231556",DisplayName:e[n].userName,LabelText:e[n].userName,ImageBackColor:e[n].color,PersonaId:e[n].email,IsAnonymous:e[n].isAnonymous});Array.add(t,i)}},e}();Object(i.a)(l,"PresenceContextMenuSectionBuilder",null,[192]);var c=n(2),u=n(1),d=n(61),p=(n(9),n(219)),h=n(39),m=n(58),g=n(50),f=n(21),v=n(35),_=n(8);function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var b=function(){function e(e,t,n,i){var r=this;this._businessBarEntry=null,this._dialog=null,this._task=null,this._businessBar=null,this._businessBarEntryFactory=null,this._signoutResponse=e,this._showCloseButton=i,this._signoutResponse.isAuthenticated&&(this._task=new h.a(3,2,5e3,Object(c.d)(this,this.authenticationCheckTask,"authenticationCheckTask"),2),u.AFrameworkApplication.theTaskManager.addTask(this._task),this.registerActions(t,n)),this._signoutResponse.add_authenticationLost((function(e,t){r.onAuthenticationLost()})),this._signoutResponse.add_authenticationRestored((function(e,t){r.onAuthenticationRestored()}))}var t,n,i,r=e.prototype;return r.verifyAuthentication=function(){this._signoutResponse.isAuthenticated||this.onAuthenticationLost()},r.registerActions=function(e,t){var n=u.AFrameworkApplication.theActionManager;n.addActionWithFlags(_.a.authenticationLost,v.a.frame,e,96),n.addActionWithFlags(_.a.authenticationRestored,v.a.frame,t,96),n.addAction(_.a.cancelSigninBusinessBar,v.a.frame,d.ActionManager.doNothingHandler),n.addAction(_.a.cancelSigninDialog,v.a.frame,d.ActionManager.doNothingHandler),n.addAction(_.a.launchSigninWindow,v.a.frame,d.ActionManager.doNothingHandler)},r.onAuthenticationLost=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage),u.AFrameworkApplication.theActionManager.processAction(_.a.authenticationLost,2)},r.onAuthenticationRestored=function(){this.teardownUI(),u.AFrameworkApplication.theActionManager.processAction(_.a.authenticationRestored,2)},r.authenticationCheckTask=function(e){this._signoutResponse.authenticationCheck()},r.teardownUI=function(){this._dialog&&(this._dialog.hide(),this._dialog.dispose(),this._dialog=null),this._businessBarEntry&&this.businessBar&&(u.AFrameworkApplication.isShuttingDown||this.businessBar.removeEntry(this._businessBarEntry),this._businessBarEntry.dispose(),this._businessBarEntry=null)},r.showDialog=function(e){g.a(this._dialog),this._dialog=new m.StandardDialog,this._showCloseButton||(this._dialog.hasCloseGlyph=!1,this._dialog.buttonsOption=0),this._dialog.setButtonText(1,CommonUIStrings.l_SignIn),this._dialog.showWarning(CommonUIStrings.l_DefaultDialogTitle,e,Object(c.d)(this,this.dialogHandler,"dialogHandler"))},r.dialogHandler=function(e,t){1===e?(p.a.performSignIn(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),u.AFrameworkApplication.theActionManager.processAction(_.a.launchSigninWindow,2)):(this.showBusinessBar(),u.AFrameworkApplication.theActionManager.processAction(_.a.cancelSigninDialog,2))},r.showBusinessBar=function(){this.businessBar&&this.businessBarEntryFactory&&(this._businessBarEntry=this.businessBarEntryFactory.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this._businessBarEntry.closeable=!0,this._businessBarEntry.addButton(CommonUIStrings.l_SignIn,e.businessBarButtonHandler,""),this._businessBarEntry.closeHandler=Object(c.d)(this,this.businessBarEntryCloseHandler,"businessBarEntryCloseHandler"),this.businessBar.addEntry(this._businessBarEntry,!1))},r.businessBarEntryCloseHandler=function(e){this.disableTask(),u.AFrameworkApplication.theActionManager.processAction(_.a.cancelSigninBusinessBar,2)},r.disableTask=function(){this._task&&(u.AFrameworkApplication.theTaskManager.deleteTask(this._task),this._task=null)},r.dispose=function(){this._businessBarEntry=null,this._dialog=null,this._task=null},e.businessBarButtonHandler=function(e){p.a.performSignIn(),u.AFrameworkApplication.theActionManager.processAction(_.a.launchSigninWindow,2)},t=e,(n=[{key:"businessBar",get:function(){return this._businessBar||(this._businessBar=f.a.instance.tryResolve("CommonUI.IBusinessBar"))}},{key:"businessBarEntryFactory",get:function(){return this._businessBarEntryFactory||(this._businessBarEntryFactory=f.a.instance.tryResolve("CommonUI.IBusinessBarEntryFactory"))}}])&&y(t.prototype,n),i&&y(t,i),e}();Object(i.a)(b,"SignOutResponseUI",null,[4]);n(129),n(185);var S=n(68);function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return A}));var A=function(){function e(){}var t,n,i,r=e.prototype;return r.configure=function(e){e.register(l,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()},r.init=function(){},r.dispose=function(){g.a(e._signOutResponse),e._signOutResponse=null},e.main=function(){S.a.instance.registerPackage(new e)},e.initSignOutResponseUI=function(t,n,i,r){e.shouldUseSignoutResponseUI(t)&&(e._signOutResponse=new b(p.a.instance,n,i,r))},e.shouldUseSignoutResponseUI=function(e){return u.AFrameworkApplication.needsSignOutChecking&&!u.AFrameworkApplication.isEmbedded},t=e,(n=[{key:"name",get:function(){return"Common.App.UI"}}])&&C(t.prototype,n),i&&C(t,i),e}();A._signOutResponse=null,Object(i.a)(A,"CommonAppUIPackage",null,[14,15])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(33),o=function(){function e(){this.classId=0}return e.deserializeResponse=function(e){try{return a.a(e)}catch(e){}return null},e}();Object(i.a)(o,"ARoamingAppsResponse",null,[]);var s=function(){this.callback=null,this.state=null,this.isFirstTry=!1};Object(i.a)(s,"GetRoamingAppsLauncherContext",null,[]);var l=n(1),c=(n(9),n(39));function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return d}));var d=function(){function e(t){this._checkingRoamingRights=!1,this._retryInterval=e.initialRetryInterval,this._numberOfRetries=0,this._roamingApp=0,this._roamingAppsLauncher=null,this._lastTimeLauncherGet=null,this.platform=null,this.applicationExe=null,this.officeVersion=null,this._roamingAppsAreEnabled=t,this._roamingRightsAreChecked=!1,this._userHasRoamingRights=!1}var t,i,a,d=e.prototype;return d.checkUserRoamingRights=function(e){l.AFrameworkApplication.isOpenInClientEnabled&&this.roamingAppsAreEnabled&&!this._roamingRightsAreChecked&&!this._checkingRoamingRights&&(this._roamingApp=e,this._checkingRoamingRights=!0,this.resetRetryNumbers(),this.executeCheckUserRoamingRights())},d.resetRetryNumbers=function(){this._retryInterval=e.initialRetryInterval,this._numberOfRetries=0},d.getRoamingAppsLauncher=function(e,t,n){if(this.userHasRoamingRights){var i=new s;i.callback=t,i.state=n,i.isFirstTry=!0,this.executeGetRoamingAppsLauncher(i)}else t(!1,"",n)},d.executeCheckUserRoamingRights=function(){var e=new(n(510).CheckRoamingRightsRequest);e.RoamingApp=this._roamingApp,e.BaseDocQuerySignature=l.AFrameworkApplication.baseDocQuerySignatureWithoutVersion,e.execute(Object(r.d)(this,this.checkUserRoamingRightsSucceeded,"checkUserRoamingRightsSucceeded"),Object(r.d)(this,this.checkUserRoamingRightsFailed,"checkUserRoamingRightsFailed"),null)},d.checkUserRoamingRightsSucceeded=function(e){if(!l.AFrameworkApplication.isShuttingDown){var t=e.data.responseData,n=o.deserializeResponse(t);n?this.setUserHasRoamingRights(n.HasRights):this.setUserHasRoamingRights(!1)}},d.checkUserRoamingRightsFailed=function(t){if(!l.AFrameworkApplication.isShuttingDown)if(this._numberOfRetries>=e.maxNumberOfRetries)this.setUserHasRoamingRights(!1);else{var n=new c.a(2,1,this._retryInterval,Object(r.d)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);0,l.AFrameworkApplication.theTaskManager.addTask(n),this._numberOfRetries++,this._retryInterval*=e.retryBackoffFactor,this._retryInterval>e.maxRetryInterval&&(this._retryInterval=e.maxRetryInterval)}},d.setUserHasRoamingRights=function(e){this._userHasRoamingRights=e,this._roamingRightsAreChecked=!0,this._checkingRoamingRights=!1},d.retryCheckUserRoamingRights=function(e){this.executeCheckUserRoamingRights()},d.executeGetRoamingAppsLauncher=function(e){var t=new(n(511).GetRoamingLauncherRequest);t.RoamingApp=this._roamingApp,t.BaseDocQuerySignature=l.AFrameworkApplication.baseDocQuerySignatureWithoutVersion,t.execute(Object(r.d)(this,this.getRoamingAppsLauncherSucceeded,"getRoamingAppsLauncherSucceeded"),Object(r.d)(this,this.getRoamingAppsLauncherFailed,"getRoamingAppsLauncherFailed"),e)},d.getRoamingAppsLauncherSucceeded=function(e){if(!l.AFrameworkApplication.isShuttingDown){var t=e.data.responseData,n=o.deserializeResponse(t),i=e.data.state;n?(this._roamingAppsLauncher=n.Launcher,this.platform=n.Platform,this.officeVersion=n.OfficeVersion,this.applicationExe=n.Application,this._lastTimeLauncherGet=new Date,i.callback(!0,n.Launcher,i.state)):i.callback(!1,"",i.state)}},d.getRoamingAppsLauncherFailed=function(e){if(!l.AFrameworkApplication.isShuttingDown){var t=e.data.state;if(5===e.data.status&&t.isFirstTry)return t.isFirstTry=!1,void this.executeGetRoamingAppsLauncher(t);t.callback(!1,"",t.state)}},t=e,a=[{key:"instance",get:function(){return e._singletonInstance||(e._singletonInstance=new e(l.AFrameworkApplication.areRoamingAppsEnabled))}}],(i=[{key:"roamingAppsLauncher",get:function(){var t=new Date;return this._lastTimeLauncherGet&&t.getTime()-this._lastTimeLauncherGet.getTime()<e.roamingAppsLauncherExpirationTime?this._roamingAppsLauncher:null}},{key:"roamingAppsAreEnabled",get:function(){return this._roamingAppsAreEnabled}},{key:"userHasRoamingRights",get:function(){return!(!this.roamingAppsAreEnabled||!this._roamingRightsAreChecked)&&this._userHasRoamingRights}}])&&u(t.prototype,i),a&&u(t,a),e}();d.initialRetryInterval=1e3,d.retryBackoffFactor=5,d.maxRetryInterval=12e5,d.maxNumberOfRetries=5,d.roamingAppsLauncherExpirationTime=3e5,d._singletonInstance=null,Object(i.a)(d,"RoamingAppsManager",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(67),a=n(224),o=function(){this.whitelistedControlIds=null};Object(i.a)(o,"StatusBarProps",null,[]);var s=n(86),l=n(3);n.d(t,"a",(function(){return c}));var c=function(){function e(e,t){var n=this;this._reactStatusBarInitialized=!1,this._reactStatusBarAPI=null,this._updateRibbonControls=t.updateRibbonControls,this._statusBarId=t.statusBarId,r.a.get_instance().executeWhen(7,(function(){window.setTimeout((function(){a.a.instance.profileFunction((function(){s.UISurfaces.getStatusBarAPIAsync().then((function(i){var r=Object.assign(new o,{whitelistedControlIds:t.whitelistedControlIds});return i.initializeNewStatusBar(e,r,n._statusBarId),n._reactStatusBarAPI=i,n._reactStatusBarInitialized=!0,window.setTimeout((function(){a.a.instance.profileFunction((function(){var e=new Array(0);if(t.trimmedIds){var i=t.trimmedIds;for(var r in i){var a={key:r,value:i[r]};e.push(appChrome.actions.updateControlHiddenState(a.key,a.value))}appChrome.api.dispatch(e)}n.poll()}),"RSB:I2")}),0),null})).catch((function(e){return l.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API"),null}))}),"RSB:I1")}),0)}))}var t=e.prototype;return t.poll=function(){var e=this;this._reactStatusBarInitialized&&this._updateRibbonControls&&window.setTimeout((function(){e._updateRibbonControls(e._reactStatusBarAPI.selectors.getStatusBarControlsMap(e._statusBarId),7)}),0)},t.setControlVisibility=function(e,t){this._reactStatusBarInitialized&&window.setTimeout((function(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(e,t))}),0)},t.pollControl=function(e){var t=this;this._reactStatusBarInitialized&&this._updateRibbonControls&&window.setTimeout((function(){var n=t._reactStatusBarAPI.selectors.getStatusBarControlsMap(t._statusBarId);if(n[e]){var i={};i[e]=n[e],t._updateRibbonControls(i,7)}}),0)},e}();Object(i.a)(c,"ReactStatusBar",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(75),o=(n(9),n(4)),s=n(24),l=n(17),c=n(13),u=n(8);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p=function(){function e(){}var t,n,i;return t=e,i=[{key:"zoomDialogOneRowHtmlTemplate",get:function(){return e.zoomDialogOneRowHtmlTemplateFormat}}],(n=null)&&d(t.prototype,n),i&&d(t,i),e}();function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}p.zoomDialogOneRowHtmlTemplateFormat="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>",Object(i.a)(p,"ZoomDialogHtml",null,[]),n.d(t,"a",(function(){return m}));var m=function(e){var t,n;function i(t,n,r,a){var o;return(o=e.call(this)||this)._activeSelection=null,o._container=null,o._zoomDialogClickHandler=null,o._zoomDialogKeyHandler=null,o._zoomLists=t,o._zoomValues=n,o._zoomDialogCallback=r,o._focusManager=a,o.dialogHtml=o.buildDialogHTML(),o.buttonsOption=1,o.dialogId=i.id,o}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var d,p,m,g=i.prototype;return g.showZoomDialog=function(e,t){for(var n={},i=0;i<this._zoomLists.length;i++)this._zoomValues[i]===t?n[this.radioboxPrefix+i]=!0:n[this.radioboxPrefix+i]=!1;this.initializeAndShow(e,Object(r.d)(this,this.zoomDialogHandler,"zoomDialogHandler"),n),this.rebindTabNavigationHandlers(),this.registerFocusForRadioButtons()},g.selectFirstZoomOption=function(){this._activeSelection=document.getElementsByName(this.radioboxName)[0],this.focusRadioButton(this.activeSelection)},g.attachDialogEvents=function(){this._container||(this._container=document.getElementById("WACDialogText")),this._container&&(this._zoomDialogClickHandler||(this._zoomDialogClickHandler=Object(r.d)(this,this.zoomDialogClickHandler,"zoomDialogClickHandler"),this._clickManager.registerHandler(o.EventNames.click,this._container,this._zoomDialogClickHandler)),this._zoomDialogKeyHandler||(this._zoomDialogKeyHandler=Object(r.d)(this,this.zoomDialogKeyDownHandler,"zoomDialogKeyDownHandler"),this._keyInputManager.registerHandler(o.EventNames.keyDown,this._container,this._zoomDialogKeyHandler))),e.prototype.attachDialogEvents.call(this),this._divMessageBox&&this._keyInputManager.registerHandler(o.EventNames.keyUp,this._divMessageBox,Object(r.d)(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler"))},g.rebindTabNavigationHandlers=function(){this.focusManager.getCurrentRegion().scope.unBindAction(s.FocusManager.instance()._tabInput),this.focusManager.getCurrentRegion().scope.unBindAction(s.FocusManager.instance()._tabShiftInput),this.focusManager.getCurrentRegion().scope.bindAction(s.FocusManager.instance()._tabInput,u.a.zoomDialogFocusForward),this.focusManager.getCurrentRegion().scope.bindAction(s.FocusManager.instance()._tabShiftInput,u.a.zoomDialogFocusBackward)},g.registerFocusForRadioButtons=function(){for(var e=document.getElementsByName(this.radioboxName),t=0;t<e.length;t++){var n=e[t];l.a.addHandler(n,o.EventNames.focus,Object(r.d)(this,this.radioButtonFocusHandler,"radioButtonFocusHandler")),n.checked&&(this._activeSelection=n)}},g.zoomDialogHandler=function(e,t){if(1===e)for(var n=0;n<this._zoomLists.length;n++)if(t[this.radioboxPrefix+n]){this._zoomDialogCallback(this._zoomValues[n]);break}},g.radioButtonFocusHandler=function(e){this.focusRadioButton(e.target)},g.zoomDialogClickHandler=function(e){var t=e.sourceElement;if(!t||!t.parentNode||"label"!==t.tagName.toLowerCase()&&!t.className.startsWith(this.radioRowClassName))return!1;var n=this.getIndexOfElement(t),i=document.getElementById(this.radioboxPrefix+n);return this.focusRadioButton(i),!0},g.zoomDialogKeyDownHandler=function(e){var t=e.innerEvent.keyCode;if(t!==Sys.UI.Key.down&&t!==Sys.UI.Key.right&&t!==Sys.UI.Key.up&&t!==Sys.UI.Key.left)return!1;var n=this.getIndexOfElement(this.activeSelection),i=this._zoomLists.length-1;t===Sys.UI.Key.down||t===Sys.UI.Key.right?n=n<i?n+1:0:t!==Sys.UI.Key.up&&t!==Sys.UI.Key.left||(n=n>0?n-1:i);var r=document.getElementById(this.radioboxPrefix+n);return this.focusRadioButton(r),!0},g.dialogDefaultEnterKeyHandler=function(t){return t.eventName===o.EventNames.keyUp&&t.innerEvent.keyCode===Sys.UI.Key.enter&&(e.prototype.dialogDefaultEnterKeyHandler.call(this,t),!0)},g.focusRadioButton=function(e){e&&(e.checked=!0,this.focusManager.currentScope&&this.focusManager.currentScope.name===this.fullDialogFocusId||this.focusManager.setScope(this.fullDialogFocusId),this.focusManager.getCurrentRegion().listing.trySetCurrentElement(e),e.focus(),this.activeSelection&&Sys.UI.DomElement.removeCssClass(this.activeSelection.parentNode,this.radioRowHighlightClassName),Sys.UI.DomElement.addCssClass(e.parentNode,this.radioRowHighlightClassName),this._activeSelection=e)},g.getIndexOfElement=function(e){return Number.parseInvariant(c.a.substr(e.id,e.id.length-1,1))},g.sizeAndPositionDialog=function(){e.prototype.sizeAndPositionDialog.call(this);var t=document.getElementById(this.myId("WACDialogPanel"));t.style.minWidth=String.format("{0}px",200),t.style.width=String.format("{0}px",200)},g.buildDialogHTML=function(){for(var e="",t=0;t<this._zoomLists.length;t++)e+=a.a.formatHtml(i.zoomDialogOneRowHTMLTemplate,t.toString(),this._zoomLists[t],this.radioboxName);return e},g.dispose=function(){this._container&&(this._clickManager&&this._zoomDialogClickHandler&&this._clickManager.unregisterHandler(o.EventNames.click,this._container,this._zoomDialogClickHandler),this._keyInputManager&&this._zoomDialogKeyHandler&&this._keyInputManager.unregisterHandler(o.EventNames.keyDown,this._container,this._zoomDialogKeyHandler)),this._clickManager&&this._divMessageBox&&this._keyInputManager.unregisterHandler(o.EventNames.keyUp,this._divMessageBox,Object(r.d)(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")),e.prototype.dispose.call(this)},d=i,(p=[{key:"radioboxName",get:function(){return"ListRadioBox"}},{key:"radioboxPrefix",get:function(){return"radiobox"}},{key:"radioRowClassName",get:function(){return"WACZoomDialogRadioRow"}},{key:"radioRowHighlightClassName",get:function(){return"WACZoomDialogRadioRow-highlight"}},{key:"focusManager",get:function(){return this._focusManager}},{key:"activeSelection",get:function(){return this._activeSelection}}])&&h(d.prototype,p),m&&h(d,m),i}(a.a);m.id="ZoomDialog",m.zoomDialogOneRowHTMLTemplate=p.zoomDialogOneRowHtmlTemplate,Object(i.a)(m,"ZoomDialog",a.a,[58])},function(e,t,n){"use strict";var i=n(0),r=n(11),a=n(38),o=n(248),s=n(363),l=n(52),c=n(22),u=n(16);function d(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var h=function(e,t){for(var n=0;t()&&n<e.length;)e[n](),n++},m=function(e,t,n,i){if(e&&e.parentNode&&e.parentNode.parentNode){var r=I(e);if("auto"!==e.parentNode.style.width){var a=e.parentNode.offsetWidth-r;e.style.width=a+"px"}var o=i?n:t,s=i?t:n,l=u.a.getElementBounds(e.parentNode.parentNode),c=o?u.a.getElementBounds(o):new Sys.UI.Bounds(l.x,0,0,0),d=s?u.a.getElementLocation(s):new Sys.UI.Point(l.x+l.width,0),p=0;if("absolute"===e.parentNode.style.position)p=d.x-(c.x+c.width)-r-1;else{var h=u.a.getElementBounds(e.nextSibling?e.parentNode:e),m=h.x+h.width/2;p=2*Math.min(m-(c.x+c.width),d.x-m)-r-1}e.style.maxWidth=p+"px"}},g=function(e){for(var t,n=d(e);!(t=n()).done;){var i=t.value;f(i)}},f=function(e){e&&_(e)&&(e.style.display="",e._isHidden="0")},v=function(e){e&&!_(e)&&(e.style.display="none",e._isHidden="1")},_=function(e){if(!e)return!0;var t=e._isHidden;return!(null==t||"0"===t)},y=function(e,t,n){if(e&&!_(e)){for(var i=l.CssUtils.getCurrentStyle(e),r=c.DomUtils.parseCssSize(i.paddingLeft)+c.DomUtils.parseCssSize(i.paddingRight),a=e.offsetWidth-n-r,o=t,s=0;o&&o!==e;)(i=l.CssUtils.getCurrentStyle(o))&&(s+=c.DomUtils.parseCssSize(i.paddingLeft)+c.DomUtils.parseCssSize(i.paddingRight)),o=o.parentNode;a=Math.max(a,75+s),e.style.width=a+"px"}},b=function(e){e&&(e.style.width="auto",e.style.maxWidth="none")},S=function(e,t){e&&(e.style.position="absolute",e.style.left=t+"px")},C=function(e,t,n){return!(!e||!t)&&(!_(e)&&!_(t)&&u.a.leftBoundsOverlapsRightBounds(u.a.getElementBounds(e),u.a.getElementBounds(t),n))},A=function(e,t,n){var i=0;return e&&t&&(i=u.a.leftBoundsOverlapsRightBoundsByAmount(u.a.getElementBounds(e),u.a.getElementBounds(t),n)),i},I=function(e){for(var t=l.CssUtils.getCurrentStyle(e),n=t?c.DomUtils.parseCssSize(t.paddingLeft)+c.DomUtils.parseCssSize(t.paddingRight):0,i=l.CssUtils.getCurrentStyle(e.parentNode),r=i?c.DomUtils.parseCssSize(i.paddingLeft)+c.DomUtils.parseCssSize(i.paddingRight):0,a=0,o=e;o.nextSibling;)a+=(o=o.nextSibling).offsetWidth;return n+r+a},w=function(e){return!!e.id&&(e.id.startsWith(a.CuiHelper.shareButtonId)||e.id.startsWith(o.b)||e.id.startsWith(a.CuiHelper.replyWithChangesButtonId)||e.id.startsWith(s.a.workflowButtonId))},T=n(104);n.d(t,"a",(function(){return E}));var E=function(){function e(e,t,n){this.elmTopBar1Left=null,this.elmBreadcrumbSeparator=null,this.elmHostBrand=null,this.elmFolderSeparator=null,this.elmFolder=null,this.elmTopBar1Center=null,this.elmTitle=null,this.elmTopBar1Right=null,this.elmTopRightActionButton=null,this.elmSkypeButton=null,this.elmUserNameNameContainer=null,this.elmUserNameNameItem=null,this.elmFileButton=null,this.elmTabHeaders=null,this.elmTopBar2Center=null,this.elmOICSeparator=null,this.elmOpenInClientButton=null,this.elmFeedbackButton=null,this.elmTopBar2Right=null,this.elmPeopleWellControl=null,this._elmTopBar1=e,this._elmTopBar2=t,this._isRtl=n}var t=e.prototype;return t.findAndScaleDefaultRibbonTopBars=function(){var e;T.a.tryEnsuredHeaderPanelInitialized(Object(r.a)((function(){return e}),(function(t){return e=t})));var t=$get(a.CuiHelper.headerTopBarsId);e?(this._elmTopBar1=document.getElementById(a.CuiHelper.externalHeaderFullTopBarsId),this._elmTopBar2=t):(this._elmTopBar1=t.childNodes[0],this._elmTopBar2=t.childNodes[1]),this.scaleHeader()},t.scaleNonCuiHeader=function(e){this._elmTopBar1=e,this._elmTopBar2=null,this.findTopBar1Elements(this._elmTopBar1),this.undoScaleTopBar1(),this.scaleTopBar1()},t.scaleHeader=function(){this._elmTopBar1&&this._elmTopBar2&&this._elmTopBar2.clientHeight&&(this.findTopBar1Elements(this._elmTopBar1),this.undoScaleTopBar1(),this.scaleTopBar1(),-1!==this._elmTopBar2.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.findTopBar2Elements(this._elmTopBar2),this.undoScaleTopBar2(),this.scaleTopBar2()))},t.findTopBar1Elements=function(e){if(e)for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t],i=c.DomUtils.getDOMElementClassName(n),r=!!n.id;-1!==i.indexOf("cui-QATRowLeft")?this.elmTopBar1Left=n:-1!==i.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?this.elmBreadcrumbSeparator=n:n.id===a.CuiHelper.breadcrumbBrandId?this.elmHostBrand=n:n.id===a.CuiHelper.folderSeparatorId?this.elmFolderSeparator=n:n.id===a.CuiHelper.breadcrumbFolderId?this.elmFolder=n:-1!==i.indexOf("cui-QATRowCenter")?this.elmTopBar1Center=n:n.id===a.CuiHelper.breadcrumbTitleId?this.elmTitle=n:-1!==i.indexOf("cui-QATRowRight")?this.elmTopBar1Right=n:r&&w(n)?this.elmTopRightActionButton=n:r&&n.id.startsWith(a.CuiHelper.skypeButtonPrefixId)?this.elmSkypeButton=n:-1!==i.indexOf("UsernameNameContainer")?this.elmUserNameNameContainer=n:-1!==i.indexOf("UsernameNameItem")&&(this.elmUserNameNameItem=n),this.findTopBar1Elements(n)}},t.undoScaleTopBar1=function(){var e,t=[this.elmBreadcrumbSeparator,this.elmHostBrand,this.elmFolderSeparator,this.elmFolder,this.elmTopBar1Center,this.elmTitle,this.elmTopBar1Right,this.elmTopRightActionButton,this.elmSkypeButton,this.elmUserNameNameContainer],n=[this.elmTopBar1Center,this.elmTitle,this.elmUserNameNameContainer];g(t),function(e){for(var t,n=d(e);!(t=n()).done;){var i=t.value;b(i)}}(n),(e=this.elmTopBar1Center)&&(e.style.position="static",e.style.left="auto")},t.scaleTopBar1=function(){var e,t;this.contextualTabsVisible()?this.scaleTopBar1WithContextual():this.scaleTopBar1WithoutContextual(),e=this.elmFolderSeparator,t=this.elmFolder,e&&t&&(e.style.marginTop=(t.offsetHeight-e.offsetHeight)/2+"px")},t.scaleTopBar1WithContextual=function(){var e=this,t=this.getFirstContextualTabSet();h([function(){y(e.elmFolder,e.elmFolder,A(e.elmTopBar1Left,t,e._isRtl))},function(){v(e.elmBreadcrumbSeparator),v(e.elmHostBrand),v(e.elmFolderSeparator),v(e.elmFolder)}],(function(){return C(e.elmFolder,t,e._isRtl)})),C(this.elmTabHeaders,this.elmTopBar1Center,this._isRtl)&&function(e,t,n){if(e&&t){var i=0,a=0;u.a.getElementAbsolutePosition(t,Object(r.a)((function(){return i}),(function(e){return i=e})),Object(r.a)((function(){return a}),(function(e){return a=e})));var o=n?i-e.offsetWidth:i+t.offsetWidth;S(e,o)}}(this.elmTopBar1Center,this.elmTabHeaders,this._isRtl),this.resolveTopBar1CenterAndRightOverlap(),this.resolveTopBar1LeftAndRightOverlap(),_(this.elmTopBar1Center)||_(this.elmTitle)||m(this.elmTitle,this.elmTabHeaders,this.elmTopBar1Right,this._isRtl)},t.scaleTopBar1WithoutContextual=function(){var e=this,t=!!this.elmFolder,n=!!this.elmTitle,i=0;if((t||n)&&(i=A(this.elmTopBar1Left,this.elmTopBar1Center,this._isRtl))>0){var r=t;n&&(!t||this.elmTitle.offsetWidth>this.elmFolder.offsetWidth)&&(r=!1),y(r?this.elmFolder:this.elmTitle,r?this.elmFolder:this.elmTitle,r?i:2*i),t&&n&&(i=A(this.elmTopBar1Left,this.elmTopBar1Center,this._isRtl))>0&&y((r=!r)?this.elmFolder:this.elmTitle,r?this.elmFolder:this.elmTitle,r?i:2*i)}h([function(){v(e.elmBreadcrumbSeparator),v(e.elmHostBrand),v(e.elmFolderSeparator),v(e.elmFolder),b(e.elmTitle)},function(){y(e.elmTitle,e.elmTitle,2*A(e.elmTopBar1Left,e.elmTopBar1Center,e._isRtl))},function(){v(e.elmTitle)}],(function(){return C(e.elmTopBar1Left,e.elmTopBar1Center,e._isRtl)})),this.resolveTopBar1CenterAndRightOverlap(),this.resolveTopBar1LeftAndRightOverlap(),_(this.elmTopBar1Center)||_(this.elmTitle)||m(this.elmTitle,this.elmTopBar1Left,this.elmTopBar1Right,this._isRtl)},t.resolveTopBar1CenterAndRightOverlap=function(){var e=this,t=_(this.elmTitle);h([function(){e.resolveTopBar1TitleandRightOverlap()},function(){v(e.elmTopRightActionButton),b(e.elmTitle),b(e.elmUserNameNameContainer),t||f(e.elmTitle)},function(){e.resolveTopBar1TitleandRightOverlap()},function(){v(e.elmSkypeButton),b(e.elmTitle),b(e.elmUserNameNameContainer),t||f(e.elmTitle)},function(){e.resolveTopBar1TitleandRightOverlap()}],(function(){return C(e.elmTopBar1Center,e.elmTopBar1Right,e._isRtl)}))},t.resolveTopBar1TitleandRightOverlap=function(){var e=!!this.elmTitle,t=!!this.elmUserNameNameContainer,n=0;if((e||t)&&(n=A(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl))>0){var i=!!this.elmTopBar1Center&&"absolute"!==this.elmTopBar1Center.style.position,r=e;t&&(!e||this.elmUserNameNameContainer.offsetWidth>this.elmTitle.offsetWidth)&&(r=!1),y(r?this.elmTitle:this.elmUserNameNameContainer,r?this.elmTitle:this.elmUserNameNameItem,r&&i?2*n:n),e&&t?((n=A(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl))>0&&y((r=!r)?this.elmTitle:this.elmUserNameNameContainer,r?this.elmTitle:this.elmUserNameNameItem,r&&i?2*n:n),C(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl)&&(v(this.elmTopBar1Center),b(this.elmUserNameNameContainer))):e&&C(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl)&&v(this.elmTitle)}},t.resolveTopBar1LeftAndRightOverlap=function(){var e=this,t=function(){y(e.elmUserNameNameContainer,e.elmUserNameNameItem,A(e.elmTopBar1Left,e.elmTopBar1Right,e._isRtl))};h([t,function(){v(e.elmTopRightActionButton),b(e.elmUserNameNameContainer)},t,function(){v(e.elmSkypeButton),b(e.elmUserNameNameContainer)},t,function(){v(e.elmUserNameNameContainer)}],(function(){return C(e.elmTopBar1Left,e.elmTopBar1Right,e._isRtl)}))},t.contextualTabsVisible=function(){if(!this.elmTabHeaders)return!1;for(var e=0;e<this.elmTabHeaders.childNodes.length;e++){var t=this.elmTabHeaders.childNodes[e];if(-1!==c.DomUtils.getDOMElementClassName(t).indexOf("cui-cg"))return!0}return!1},t.getFirstContextualTabSet=function(){if(!this.elmTabHeaders)return null;for(var e=null,t=this.elmTabHeaders.childNodes.length-1;t>=0;t--){var n=this.elmTabHeaders.childNodes[t];if(-1===c.DomUtils.getDOMElementClassName(n).indexOf("cui-cg"))break;e=n}return e},t.findTopBar2Elements=function(e){if(e)for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t],i=c.DomUtils.getDOMElementClassName(n),r=!!n.id;-1!==i.indexOf("cui-jewel-container")?this.elmFileButton=n:-1!==i.indexOf("cui-tts")?this.elmTabHeaders=n:-1!==i.indexOf("cui-TabRowInline")?this.elmTopBar2Center=n:-1!==i.indexOf("cui-separator")?this.elmOICSeparator=n:r&&n.id.startsWith(a.CuiHelper.openInClientButtonId)?this.elmOpenInClientButton=n:r&&n.id.startsWith(a.CuiHelper.feedbackButtonId)?this.elmFeedbackButton=n:-1!==i.indexOf("cui-TabRowRight")?this.elmTopBar2Right=n:r&&n.id.startsWith(a.CuiHelper.peoplesWellControlId)&&(this.elmPeopleWellControl=n),this.findTopBar2Elements(n)}},t.undoScaleTopBar2=function(){var e=[this.elmTabHeaders,this.elmTopBar2Center,this.elmOICSeparator,this.elmOpenInClientButton,this.elmFeedbackButton,this.elmTopBar2Right,this.elmPeopleWellControl];g(e),this.setTabHeaderScaleIndex(0)},t.scaleTopBar2=function(){var e=this;h([function(){v(e.elmOICSeparator),v(e.elmOpenInClientButton)},function(){e.setTabHeaderScaleIndex(1)},function(){e.setTabHeaderScaleIndex(2)},function(){v(e.elmTopBar2Center),e.setTabHeaderScaleIndex(0)}],(function(){return C(e.elmTabHeaders,e.elmTopBar2Center,e._isRtl)})),h([function(){v(e.elmOICSeparator),v(e.elmOpenInClientButton)},function(){v(e.elmFeedbackButton)},function(){v(e.elmPeopleWellControl)},function(){v(e.elmTopBar2Right)}],(function(){return C(e.elmTopBar2Center,e.elmTopBar2Right,e._isRtl)||C(e.elmTabHeaders,e.elmTopBar2Right,e._isRtl)})),h([function(){e.setTabHeaderScaleIndex(1)},function(){e.setTabHeaderScaleIndex(2)},function(){v(e.elmTabHeaders)}],(function(){return C(e.elmFileButton,e.elmTabHeaders,e._isRtl)}))},t.setTabHeaderScaleIndex=function(t){this.elmTabHeaders&&(this.elmTabHeaders.className=e.tabHeaderScaleClasses[t],this.elmTabHeaders._scaleStep=t)},e}();E.tabHeaderScaleClasses=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"],Object(i.a)(E,"TopBarScalingManager",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(38),a=n(100),o=n(1),s=function(){this.command=null,this.queryCommand=null,this.label=null,this.image=null,this.id=null,this.keytip=null};Object(i.a)(s,"HeaderToggleButtonInfo",null,[]),n.d(t,"a",(function(){return l}));var l=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._topRowControls=null,this._standaloneRoot=e,this.shareButtonCommand=n||"981334692",this.shareIconWhenShownInRibbon=t}var t=e.prototype;return t.getTopRightActionButtonInfo=function(){return null},t.getTopRightCopyLinkButtonInfo=function(){return null},t.getTopRightCommentsButtonInfo=function(){return e.getDefaultCommentsButtonInfo()},t.getTopRightChangesButtonInfo=function(){return e.getDefaultChangesButtonInfo()},t.getPeopleWellControlSettings=function(){return null},t.createTopRowControls=function(e,t,n){this._topRowControls=t.createTopRowControls(n,e,this.shouldShowActionButtonInRibbon()?null:this.getActionButtonInfo(),this._standaloneRoot.cuiControlManager,!1,!1,this.shouldShowRibbonToggleButtonInHeader())},t.createRibbonPeripheralControls=function(e,t,n){var i=null;this.shouldShowActionButtonInRibbon()&&(i=this.getActionButtonInfo()).command===this.shareButtonCommand&&(i.image=this.shareIconWhenShownInRibbon);var r=this.shouldShowCopyLinkButtonInRibbon()?this.getTopRightCopyLinkButtonInfo():null,a=o.AFrameworkApplication.activeFrame.applicationInstance.isCommentsButtonInCollabCornerEnabled?this.getTopRightCommentsButtonInfo():null,s=o.AFrameworkApplication.activeFrame.applicationInstance.isChangesButtonEnabled?this.getTopRightChangesButtonInfo():null;t.createBottomRowRightControls(n,e,this.getPeopleWellControlSettings(),this._standaloneRoot.cuiControlManager,i,a,s,r)},t.getActionButtonInfo=function(){var e=a.a();return e||this.getTopRightActionButtonInfo()},t.disposeTopRowControls=function(){this._topRowControls&&(r.CuiHelper.disposeTopRowControls(this._topRowControls),this._topRowControls=null)},t.shouldShowActionButtonInRibbon=function(){return!1},t.shouldShowRibbonToggleButtonInHeader=function(){return!1},t.shouldShowCopyLinkButtonInRibbon=function(){return!1},e.getDefaultCommentsButtonInfo=function(){return Object.assign(new s,{command:"2281051331",queryCommand:"847427893",id:e.commentsButtonId,image:null,label:CommonUIStrings.L_OpenCommentPane})},e.getDefaultChangesButtonInfo=function(){return Object.assign(new s,{command:o.AFrameworkApplication.activeFrame.applicationInstance.catchUpFlyoutEnabled?"3418267371":"1956545633",queryCommand:o.AFrameworkApplication.activeFrame.applicationInstance.catchUpFlyoutEnabled?"1059068017":"1715205439",id:e.changesButtonId,image:null,label:CommonUIStrings.L_ActivityPaneTitle})},e}();l.workflowButtonId="btnWorkflow",l.commentsButtonId="ShowCommentsTopBar",l.changesButtonId="CatchUpWithChanges",Object(i.a)(l,"TopRowPeripheralControlCreator",null,[100])},function(e,t,n){var i=n(145),r=n(365),a="".split;e.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==r(e)?a.call(e,""):Object(e)}:Object},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){var i=n(120),r=n(193);e.exports=function(e,t){try{r(i,e,t)}catch(n){i[e]=t}return t}},function(e,t,n){var i=n(297),r=n(401);(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.4",mode:i?"pure":"global",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var i=n(404),r=n(371).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var i=n(194),r=n(440),a=n(299),o=n(375),s=n(442),l=n(443),c=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,n,u,d){var p,h,m,g,f,v,_,y=o(t,n,u?2:1);if(d)p=e;else{if("function"!=typeof(h=s(e)))throw TypeError("Target is not iterable");if(r(h)){for(m=0,g=a(e.length);g>m;m++)if((f=u?y(i(_=e[m])[0],_[1]):y(e[m]))&&f instanceof c)return f;return new c(!1)}p=h.call(e)}for(v=p.next;!(_=v.call(p)).done;)if("object"==typeof(f=l(p,y,_.value,u))&&f&&f instanceof c)return f;return new c(!1)}).stop=function(e){return new c(!0,e)}},function(e,t,n){var i=n(145);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},function(e,t,n){var i=n(441);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var i={};i[n(121)("toStringTag")]="z",e.exports="[object z]"===String(i)},function(e,t,n){"use strict";var i=n(171),r=n(450),a=n(413),o=n(410),s=n(236),l=n(193),c=n(235),u=n(121),d=n(297),p=n(274),h=n(412),m=h.IteratorPrototype,g=h.BUGGY_SAFARI_ITERATORS,f=u("iterator"),v=function(){return this};e.exports=function(e,t,n,u,h,_,y){r(n,t,u);var b,S,C,A=function(e){if(e===h&&k)return k;if(!g&&e in T)return T[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},I=t+" Iterator",w=!1,T=e.prototype,E=T[f]||T["@@iterator"]||h&&T[h],k=!g&&E||A(h),M="Array"==t&&T.entries||E;if(M&&(b=a(M.call(new e)),m!==Object.prototype&&b.next&&(d||a(b)===m||(o?o(b,m):"function"!=typeof b[f]&&l(b,f,v)),s(b,I,!0,!0),d&&(p[I]=v))),"values"==h&&E&&"values"!==E.name&&(w=!0,k=function(){return E.call(this)}),d&&!y||T[f]===k||l(T,f,k),p[t]=k,h)if(S={values:A("values"),keys:_?k:A("keys"),entries:A("entries")},y)for(C in S)(g||w||!(C in T))&&c(T,C,S[C]);else i({target:t,proto:!0,forced:g||w},S);return S}},function(e,t,n){var i=n(376),r=n(235),a=n(453);i||r(Object.prototype,"toString",a,{unsafe:!0})},function(e,t,n){"use strict";var i=n(295),r=n(147),a=n(270);e.exports=function(e,t,n){var o=i(t);o in e?r.f(e,o,a(0,n)):e[o]=n}},function(e,t,n){var i=n(365);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"CompletableTask$1",(function(){return o}));var i=n(0),r=n(142),a=n(207);var o=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.SEsE=function(e){this.set_exception(a.a(e))},r.SEsA=function(e){this.set_exception(a.b(e))},r.SE=function(e){this.set_exception(e)},r.setResult=function(e){this.set_result(e),this.setCompleted(!0)},i}(r.a);Object(i.a)(o,"CompletableTask$1",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(e){this.MessageId=e,this.SendTime=0,this.CorrelationId="",this.Values={}};Object(i.a)(r,"CrossDocumentMessage",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(42);var a=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).elmA=null,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"GalleryButtonComponentDom",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(42);var a=function(e){var t,n;function i(t,n){var i;return(i=e.call(this,t,n)||this).aTags=[],i.colorCells=[],i}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"ColorPickerComponentDom",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(0),r=n(291),a=n(7),o=n(23),s=n(64),l=n(95),c=n(386),u=n(5),d=n(6);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(e){var t,n;function i(t,n,i,r){var a;if((a=e.call(this,t,n,i,r)||this)._comboBoxDom=null,a._allowFreeForm=!1,a._autoCompleteDelay=0,a._menuItems=null,u.c(a.cbProperties.AllowFreeForm)?a._allowFreeForm=!1:a._allowFreeForm="true"===a.cbProperties.AllowFreeForm.toLowerCase(),u.b(a.cbProperties.AutoComplete)&&(a.cbProperties.AutoComplete="true"),!u.b(a.cbProperties.AutoCompleteDelay))try{a._autoCompleteDelay=parseInt(a.cbProperties.AutoCompleteDelay)}catch(e){a._autoCompleteDelay=100}return a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,h,m,g=i.prototype;return g.createComponentDomForDisplayMode=function(e){var t,n,i,r=u.c(this.cbProperties.Alt)?"":this.cbProperties.Alt,a=null,o=null,l=null;(t=d.a.createElement("span")).className="cui-cb",t.setAttribute("mscui:controltype",this.controlType),(n=d.a.createSelectableElement("input")).type="text",n.style.width=this.isSmallWidth(e)?this.cbProperties.SmallWidth:this.cbProperties.Width,n.className="cui-cb-input",n.setAttribute("autocomplete","off"),n.setAttribute("data-lpignore","true"),n.setAttribute("data-lpignore","true"),n.id=this.cbProperties.Id,n.title=r,this.inMenu=s.a.isDisplayModeMenu(e),this.setInitialAriaMenuLauncherAttributes(n),"true"===this.cbProperties.FillContainer&&(d.a.ensureCSSClassOnElement(n,"cui-cb-fill-input"),d.a.ensureCSSClassOnElement(t,"cui-cb-fill-container")),d.a.addToTabLoop(n),i=d.a.createElement("a"),d.a.ensureCSSClassOnElement(i,"cui-dd-arrow-button"),i.tabIndex=-1,i.setAttribute("role","presentation");var p=!1;return!u.b(this.cbProperties.ArrowImgId)&&(l=document.getElementById(this.cbProperties.ArrowImgId))&&((a=document.createElement("span")).appendChild(l),p=!0),p||(o=d.a.createElement("img"),a=this.isVisualRefreshEnabled?d.a.createClusteredImageContainerNew(2,this.root.properties.ImageDownArrow8by8,this.root.properties.ImageDownArrow8by8Class,o,!0,!1):d.a.createClusteredImageContainerNew(1,this.root.properties.ImageDownArrow,this.root.properties.ImageDownArrowClass,o,!0,!1)),o&&(o.alt=r),i.title=r,t.appendChild(n),t.appendChild(i),i.appendChild(a),this._comboBoxDom=new c.a(e),this.comboBoxDom.elmControl=t,this.comboBoxDom.elmInput=n,this.comboBoxDom.elmBtnA=i,this.comboBoxDom.elmArwImg=l||o,this.comboBoxDom.elmIconContainer=a,this.comboBoxDom},g.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,this.comboBoxDom.elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)},g.selectDropdownItem=function(e){this.selectedControl!==e&&(this._selectedControl=e,this.comboBoxDom.elmInput.value=e.getTextValue(),this.behavior.isCommitChangeFixEnabled&&!this.allowFreeForm&&(this.stateProperties[l.a.Value]=e.getTextValue()))},g.commitPendingChange=function(){this.behavior.commitPendingChange()},g.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},r=i,(h=[{key:"comboBoxDom",get:function(){return this._comboBoxDom}},{key:"allowFreeForm",get:function(){return this._allowFreeForm}},{key:"autoCompleteDelay",get:function(){return this._autoCompleteDelay}},{key:"controlType",get:function(){return o.Control.comboBoxControlType}},{key:"ariaRole",get:function(){return a.a.ariaComboboxRole}},{key:"menuItems",get:function(){return u.c(this._menuItems)&&(this._menuItems={}),this._menuItems},set:function(e){this._menuItems=e}},{key:"focusableElement",get:function(){return this.comboBoxDom?this.comboBoxDom.elmInput:null}},{key:"cbProperties",get:function(){return this.controlProperties}},{key:"isEditable",get:function(){return!0}}])&&p(r.prototype,h),m&&p(r,m),i}(r.a);Object(i.a)(h,"ComboBox",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(42);var a=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).elmInput=null,n.elmBtnA=null,n.elmArwImg=null,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"ComboBoxComponentDom",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(42);var a=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).elmTBody=null,n.cellATags=null,n.cells=null,n.innerDivs=null,n.outerDivs=null,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"InsertTableComponentDom",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(42);var a=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).elmInput=null,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"SliderComponentDom",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),r=n(42);var a=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).elmInput=null,n.elmUpArrow=null,n.elmDownArrow=null,n.elmUpArrowImageContainer=null,n.elmDownArrowImageContainer=null,n.elmUpArrowImage=null,n.elmDownArrowImage=null,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(a,"SpinnerComponentDom",r.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n(0),r=n(2),a=n(31),o=n(1),s=n(9),l=n(129),c=n(185),u=n(78),d=n(4),p=n(131),h=n(24);var m=function(e){var t,n;function i(t,n){var m;(m=e.call(this,t)||this)._tabListItems=void 0,m._tabLinks=void 0,m._tabs=void 0,m._disposed=void 0,m._framework=n,t.id="WACDebugPanelFrame",t.className="WACDebugPanelFrame";var g=document.createElement("div");g.id="WACDebugPanelTabContainer",g.className="WACDebugTabContainer",t.appendChild(g);var f=document.createElement("ul");f.id="WACDebugPanelTabList",f.className="WACDebugTabList",g.appendChild(f);var v=document.createElement("div");v.id="WACDebugPanelInset",v.className="WACDebugPanelInset",t.appendChild(v);var _=document.createElement("div");_.id="WACDebugPanelContentArea",_.className="WACDebugPanelContentArea",v.appendChild(_);var y=m._framework.getDebugTabs();s.Debug.assertTag(!!y,3002370);var b=document.createElement("li");b.className="WACDebugLabel",b.innerText=o.AFrameworkApplication.buildVersion,f.appendChild(b),m._expandControl=document.createElement("a"),m._expandControl.className="WACDebugTab",m._expandControl.href="#",m._expandControl.UNSELECTABLE="on",m._expandControl.innerText=">",f.appendChild(m._expandControl),o.AFrameworkApplication.activeFrame.theClickInputManager.registerHandler(d.EventNames.click,m._expandControl,Object(r.d)(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(m),m.onExpandControlClick,"onExpandControlClick"));for(var S=0;S<y.length;S++){var C=y[S];Array.add(m._tabs,C);var A=document.createElement("div");A.className="WACDebugPanel",A.id="WACDebugPanel_"+C.displayName,A.style.display="none",_.appendChild(A),C.initialize(A);var I=document.createElement("li");I.className="WACDebugTab",I.id="WACDebugTabHeader_"+C.displayName,I.style.display="none",Array.add(m._tabListItems,I);var w=document.createElement("a");w.href="#",w.UNSELECTABLE="on",w.innerText=C.displayName,w.className="WACDebugTab",Array.add(m._tabLinks,w),I.appendChild(w),o.AFrameworkApplication.activeFrame.theClickInputManager.registerHandlerWithData(d.EventNames.click,w,i.onDebugTabClick,C.displayName),f.appendChild(I)}if(h.FocusManager.usable()){var T=o.AFrameworkApplication.activeFrame.theFocusManager;T.getScope(i.debugFocusId).parent=a.AFrame.mainAppFocusId;var E=new u.DOMFocusListing((function(){return t}));E.rememberFirstElement=!0,E.addValidTag(1),E.addValidTag(2),E.addValidTag(3),E.addValidTag(4),T.buildRegionWithDelegate((function(){return t}),T.getScope(i.debugFocusId),E),T.getRegion(i.debugFocusId).rememberFocusStealers(),T.addFocusHighlight(i.debugFocusId,t),p.F6Manager.usable()&&o.AFrameworkApplication.activeFrame.theF6Manager.addF6(i.debugFocusId),o.AFrameworkApplication.activeFrame.theMouseInputManager.addControlFocus(i.debugFocusId,m.get_element()),o.AFrameworkApplication.activeFrame.theTouchInputManager.addControlFocus(i.debugFocusId,m.get_element())}return s.Debug.debugSettings.allowAssertDebugging=!l.ADebugOptionsTab.getOptionValue("DisallowAssertDebugging"),s.Debug.debugSettings.disableAssert=l.ADebugOptionsTab.getOptionValue("DisableAssert"),s.Debug.debugSettings.enableMaxAssertCount=l.ADebugOptionsTab.getOptionValue(c.CommonDebugOptions.enableMaxAssertCount),s.Debug.debugSettings.shouldLogFunction=i.shouldLog,s.Debug.debugSettings.shouldLogCallstackFunction=i.shouldLogCallstack,m}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Sys.UI.Control);m.debugFocusId=void 0,Object(i.a)(m,"DebugPanel",Sys.UI.Control,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(3),a=function(e,t,n,i,r){this.T=e,this.L=t,this.S=n,this.I=i,this.V=r};Object(i.a)(a,"SerializableLogCache",null,[]);var o=function(){function e(e,t,n,i,r,a,o,s){void 0===o&&(o=!1),void 0===s&&(s=null),this.G=0,this.T=0,this.M=null,this.C=null,this.D=0,this.G=a,this.T=i,this.M=e,this.C=t,this.D=1e3*r+n,o&&(this.O=1),s&&(this.A=s)}return e.prototype.computeSerializedLength=function(){var t=n(391).LogCache.logEnvelopeSize+e.charsInObj(this.G)+e.charsInObj(this.T)+this.M.length+e.charsInObj(this.C)+e.charsInObj(this.D);if(1===this.O&&(t+=6),this.A){t+=7;for(var i=0,r=this.A.length;i<r;++i)t+=this.A[i].length+3}return t},e.charsInObj=function(e){return(""+e).length},e}();Object(i.a)(o,"SerializableLogEntry",null,[]);var s=n(199);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"LogCache",(function(){return c}));var c=function(){function e(t,n,i){this._timestampBase=0,this._logs=null,this._dataSizeBytes=0,this._uploadMaximumSizeBytes=0,this.uploadId=0,this._sizeThresholdBytes=t,this._logMessageMaxChars=n,this._userSessionId=i,this._sizeThresholdBytes=t<e.maxSizeThresholdBytes?t:e.maxSizeThresholdBytes,this._maxDataSizeBytes=this._sizeThresholdBytes-4*(this._logMessageMaxChars+e.serializationEnvelopeSize),this.reset()}var t,n,i,c=e.prototype;return c.reset=function(){this._logs=[],this._dataSizeBytes=e.serializationEnvelopeSize,this._timestampBase=(new Date).getTime()},c.addLog=function(e){if(e){if(e.message.length>this._logMessageMaxChars&&(e.message=e.message.substr(0,this._logMessageMaxChars-13)+"... [trimmed]",r.ULS.sendTraceTag(3465240,100,50,"Trimmed message for log {0}",s.a(e.tag))),e.args)for(var t=0;t<e.args.length;t++)e.args[t].length>this._logMessageMaxChars&&(e.args[t]=e.args[t].substr(0,this._logMessageMaxChars-13)+"... [trimmed]",r.ULS.sendTraceTag(3465240,100,50,"Trimmed arg {0} for log {1}",t,s.a(e.tag)));var n=new o(e.message,e.category,e.level,e.timestamp-this._timestampBase,e.logType,e.tag,e.isMinified,e.args),i=n.computeSerializedLength();if(this._uploadMaximumSizeBytes>0&&i+this._dataSizeBytes>this._uploadMaximumSizeBytes){var a=this.count;this.reset(),r.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",a)}Array.add(this._logs,n),this._dataSizeBytes+=i}},c.serialize=function(){return r.ULS.jsonSerialize(new a(this._timestampBase,this._logs,this._userSessionId,this.uploadId,e.serializationSchemaVersion))},e.testJsonSerialize=function(e){return r.ULS.jsonSerialize(e)},t=e,(n=[{key:"count",get:function(){return this._logs.length}},{key:"uploadMaximumSizeBytes",get:function(){return this._uploadMaximumSizeBytes},set:function(e){this._uploadMaximumSizeBytes=e}},{key:"dataSizeBytes",get:function(){return this._dataSizeBytes}},{key:"isDataSizeThresholdExceeded",get:function(){return this._dataSizeBytes>this._maxDataSizeBytes}},{key:"sizeThresholdBytes",get:function(){return this._sizeThresholdBytes}},{key:"logMessageMaxChars",get:function(){return this._logMessageMaxChars}},{key:"logs",get:function(){return this._logs}},{key:"timestampBase",get:function(){return this._timestampBase}}])&&l(t.prototype,n),i&&l(t,i),e}();c.serializationEnvelopeSize=25,c.serializationSchemaVersion=1,c.logEnvelopeSize=31,c.maxSizeThresholdBytes=262144,Object(i.a)(c,"LogCache",null,[235,236])},function(e,t,n){"use strict";var i=n(0),r=n(23),a=(n(9),n(77)),o=n(314),s=n(42);var l=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.buildControlDom=function(e,t){var n=r.Control.createOuterElement("cui-menuloading",e);n.setAttribute("aria-label",e.controlProperties.LabelText);var i=new o.a("");return n.appendChild(i.element),new s.a(t,n)},i}(a.a);Object(i.a)(l,"LoadingIndicatorLabelDomStrategy",a.a,[]);var c=n(2),u=n(22),d=n(123),p=n(5),h=n(6);function m(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._innerLinkElement=null,t._control=null,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,o,l,g=i.prototype;return g.buildControlDom=function(e,t){this._control=e;var n=this.getSubsectionLabelClass(t),i=r.Control.createOuterElement(n,e),a=this.properties.LabelCss;if(p.c(a)||(i.style.cssText=a),"MenuSaveButton"===t||"MenuDiagnostics"===t){var o=h.a.createElement("span");if(o.appendChild(document.createTextNode(this.properties.LabelText)),o.className=String.format("{0} {1}","cui-ctl-mediumlabel","cui-btn-title"),Object(c.c)(d.Jewel,e.root)||(o.className+=" UIFontBold"),o.style.display="block",i.appendChild(o),this.properties.Description){var l=h.a.createElement("span");l.appendChild(document.createTextNode(this.properties.Description)),l.className="cui-btn-menu-description UIFont",i.appendChild(l),l.style.display="block"}}else this.updateElementInternal(i,this.properties.LabelText);var u=new s.a(t,i,this);return u.elmLabel=i,u},g.getSubsectionLabelClass=function(e){var t;switch(e){case"MenuFileName":t="cui-ctl-filenamelabel cui-menusection-filenametitle";break;case"MenuDiagnostics":t=String.format("{0} {1}","cui-menusection-diagnostics-label","cui-ctl-mediumlabel");break;default:t=String.format("{0} {1}","cui-ctl-mediumlabel","cui-menusection-subsectiontitle"),Object(c.c)(d.Jewel,this._control.root)||"MenuSaveButton"!==e||(t+=" cui-ctl-menu")}return t},g.updateLabel=function(e,t){return this.updateElementInternal(e,t),!0},g.updateElementInternal=function(e,t){t?(e.style.display="block",this._innerLinkElement=this.updateChildDomElements(e,t)):e.style.display="none"},g.updateChildDomElements=function(e,t){u.DomUtils.clearElement(e);var n,i=t.split("{0}");return this.concateChildNodesWithBr(e,i[0]),n=this.appendLinkChildNode(e),i.length>1&&this.concateChildNodesWithBr(e,i[1]),n},g.concateChildNodesWithBr=function(e,t){for(var n,i=m(t.split("\n"));!(n=i()).done;){var r=n.value,a=document.createElement("span");a.innerText=r,e.appendChild(a);var o=document.createElement("br");e.appendChild(o)}var s=e.lastChild;e.removeChild(s)},g.appendLinkChildNode=function(e){var t=null;if(this.properties.InnerLink&&this.properties.InnerLinkText){(t=h.a.createElement("a")).className="cui-subsectionlabellink",t.href=this.properties.InnerLink,t.target="_blank";var n=this.properties.InnerLinkTitle;n&&n.length>0&&(t.title=n),t.appendChild(document.createTextNode(this.properties.InnerLinkText)),e.appendChild(t)}return t},a=i,(o=[{key:"focusableElement",get:function(){return this._innerLinkElement}},{key:"properties",get:function(){return this._control.controlProperties}}])&&f(a.prototype,o),l&&f(a,l),i}(a.a);Object(i.a)(v,"MenuSubsectionLabelDomStrategy",a.a,[]);var _=n(220);function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return b}));var b=function(e){var t,i;function a(t,n,i){var r;return(r=e.call(this,t,n,i)||this)._focusableElement=null,r.addDisplayMode("Medium"),r.addDisplayMode("Medium14"),r.addDisplayMode("MediumCompact"),r.addDisplayMode("Small"),r.addDisplayMode("Small14"),r.addDisplayMode("Menu"),r.addDisplayMode("Menu16"),r.addDisplayMode("MenuMru"),r.addDisplayMode("MenuLoading"),r.addDisplayMode("MenuTemplate"),r.addDisplayMode("MenuTellMe"),r.addDisplayMode("MenuSaveAs"),r.addDisplayMode("MenuFileName"),r.addDisplayMode("MenuSaveButton"),r.addDisplayMode("MenuDiagnostics"),r.stateProperties[_.a.Visible]=r.visible,r}i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var o,s,c,u=a.prototype;return u.createComponentDomForDisplayMode=function(e){var t=null,n=this.getDomElementCreationStrategy(e);return n&&(t=n.buildControlDom(this,e),this._focusableElement=n.focusableElement),t},u.getDomElementCreationStrategy=function(e){var t=n(509).StandardLabelDomStrategy;switch(e){case"MenuMru":case"MenuTemplate":case"MenuSaveAs":case"MenuFileName":case"MenuSaveButton":case"MenuDiagnostics":return new v;case"MenuLoading":return new l;default:return new t}},u.constructClonedControl=function(e,t){return new a(e,this.id,t)},o=a,(s=[{key:"focusableElement",get:function(){return this._focusableElement}},{key:"controlType",get:function(){return r.Control.labelControlType}}])&&y(o.prototype,s),c&&y(o,c),a}(r.Control);Object(i.a)(b,"Label",r.Control,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(203),o=(n(9),n(74));function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this)._x=0,a._y=0,a._launcherHeight=0,a._launcherWidth=0,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,l=i.prototype;return l.setInitialAriaMenuLauncherAttributes=function(e){},l.updateAriaMenuLauncherAttributes=function(e,t){},l.launchContextMenuAt=function(e,t,n){this.launchContextMenuAtLauncher(new Sys.UI.Bounds(e,t,0,0),n)},l.launchContextMenuAtLauncher=function(e,t){this._x=e.x,this._y=e.y,this._launcherHeight=e.height,this._launcherWidth=e.width,this.launchMenu(t)},r=i,(a=[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"launcherHeight",get:function(){return this._launcherHeight}},{key:"launcherWidth",get:function(){return this._launcherWidth}},{key:"needsAKeytip",get:function(){return!1}},{key:"menuDirection",get:function(){return 4}}])&&s(r.prototype,a),o&&s(r,o),i}(o.MenuLauncher);Object(i.a)(l,"ContextMenuLauncher",o.MenuLauncher,[]);var c=n(23),u=n(42),d=n(6);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(e){var t,n;function i(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this).m_elmDefault=null,a.addDisplayMode("Menu"),a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.createComponentDomForDisplayMode=function(e){return this.m_elmDefault=d.a.createElement("span"),new u.a(e,this.m_elmDefault)},s.constructClonedMenuLauncher=function(e,t,n){return new i(e,this.id,t,n)},r=i,(a=[{key:"controlType",get:function(){return c.Control.contextMenuControlType}},{key:"properties$3",get:function(){return this.controlProperties}}])&&p(r.prototype,a),o&&p(r,o),i}(l);Object(i.a)(h,"ContextMenuControl",l,[]);var m=n(87),g=n(5),f=n(211),v=n(3);function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"ContextMenuRoot",(function(){return y}));var y=function(e){var t,n;function i(t,n){var i;return(i=e.call(this,t,n)||this).activeFloatie=null,i._activeMenu=null,i}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,o,s,l=i.prototype;return l.refreshInternal=function(){e.prototype.refreshInternal.call(this),g.c(this.elementInternal)&&this.ensureDOMElement(),this.elementInternal=d.a.removeChildNodes(this.elementInternal),this.appendChildrenToElement(this.elementInternal),this.dirty=!1},l.ensureCorrectChildType=function(e){if(!Object(r.c)(f.a,e))throw Error.create("Only children of type StandaloneDock can be added to a ContextMenuRoot")},l.createContextMenu=function(e,t,n,i,r){var a=new m.Menu(this,t,n,i,null);e||(e={}),e.CommandMenuOpen=this.contextMenuRootProperties.CommandMenuOpen,e.CommandMenuClose=this.contextMenuRootProperties.CommandMenuClose;var o=new h(this,t+"Launcher",e,a);this.createdControls[t]=o;var s=new f.a(this,"dock"+t);s.addChild(o.createComponentForDisplayMode("Menu")),this.addChild(s),this.refresh()},l.showContextMenuAt=function(e,t,n,i){this.showContextMenuAtLauncher(e,new Sys.UI.Bounds(t,n,0,0),i),v.ULS.sendTraceTag(36497229,207,50,"ContextMenu launched for Id: {0}",e)},l.showContextMenuAtLauncher=function(e,t,n){var i=this.createdControls[e];if(g.c(i))throw Error.create('The context menu "'+e+'" does not exist');i.launchContextMenuAtLauncher(t,n),this._activeMenu=i.menu},l.onMenuStackCleared=function(){this._activeMenu=null},l.dispose=function(){var t=this.createdControls;for(var n in t){({key:n,value:t[n]}).value.dispose()}e.prototype.dispose.call(this)},a=i,(o=[{key:"activeMenu",get:function(){return this._activeMenu}},{key:"rootType",get:function(){return 19}},{key:"contextMenuRootProperties",get:function(){return this.properties}}])&&_(a.prototype,o),s&&_(a,s),i}(a.a);Object(i.a)(y,"ContextMenuRoot",a.a,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){this.durationMs=null,this.extendedProperties=null};Object(i.a)(r,"AdditionalValues",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.searchFocusID="search",Object(i.a)(r,"SearchManagerConstants",null,[])},function(e,t,n){"use strict";var i=n(0),r=n(2),a=n(1),o=n(80),s=n(55),l=n(13),c=n(8),u=n(304),d=(n(9),n(393)),p=n(206);var h=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).CommandMenuOpen=null,t.CommandMenuClose=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(p.a);Object(i.a)(h,"ContextMenuRootProperties",p.a,[]);var m=n(18);function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(){function e(e){if(null==e)throw Error.argumentNull("hostingAppFrame");this._hostingAppFrame=e;var t=new h;t.ImageSideArrow=a.AFrameworkApplication.imageClusterPath,t.ImageSideArrowClass=s.getImageClass("SubmenuFlyoutArrow_13x13x32"),t.TextDirection=WordViewerIntl.WordViewerStrings.L_RibbonOptionTextDirection,this._root=new d.ContextMenuRoot("ContextMenuRootName",t),this._root.rootUser=this,this._root.refresh()}var t,n,i,r=e.prototype;return r.dispose=function(){this._root&&(this._root.dispose(),this._root=null),this._hostingAppFrame=null,this._root=null},r.executeRootCommand=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var o=parseInt(e);var s=a.AFrameworkApplication.theActionManager;n&&(s.commandLocation=n.CommandLocation,s.invocationMethod=n.InvocationMethod);var l=t;o===m.a.onZoomChange?l=parseInt(t.MenuItemId):o!==m.a.showSearchPane&&o!==c.a.showCommentPane||(l=new u.a(null,n.InvocationMethod));var d=s.processActionWithData(o,2,l,r);return this._root.refresh(),32===d},r.isRootCommandEnabled=function(e,t){if(void 0===t&&(t=null),!e)return!0;var n=parseInt(e);return 32===a.AFrameworkApplication.theActionManager.processAction(n,1)},r.pollForStateAndUpdateInternal=function(){this.theRoot.root.pollForStateAndUpdate()},r.showContextMenuAt=function(e,t,n){this.pollForStateAndUpdateInternal(),this.theRoot.showContextMenuAt(e,t.x,t.y,n)},t=e,(n=[{key:"theRoot",get:function(){return this._root}}])&&g(t.prototype,n),i&&g(t,i),e}();Object(i.a)(f,"AContextMenuUser",null,[48,4]);var v=n(34);function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"a",(function(){return y}));var y=function(){function e(t){var i=n(14).App;e._contextMenuUser=new f(t),this._contextMenuHandler=Object(r.d)(this,this.showDefaultContextMenu,"showDefaultContextMenu"),e._newEmbedModeIsEnabled=a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),i.get_activeAppFrame().theContextMenuInputManager.registerHandler(window.document,this._contextMenuHandler,null)}var t,i,u,d=e.prototype;return d.show=function(t){var i=n(14).App;e.ensureContextMenuCreated();var r=t.clientPoint;i.instance.isSmallView&&!e._newEmbedModeIsEnabled?(1===t.inputSource&&(r=new Sys.UI.Point(0,0)),e._contextMenuUser.showContextMenuAt(e._menuId,r,t.inputSource)):a.AFrameworkApplication.theActionManager.processActionWithData(m.a.showContextMenuInDocument,1,t)},d.dispose=function(){var t=n(14).App;e._contextMenuUser.dispose(),e._contextMenuUser=null,t.get_activeAppFrame().theContextMenuInputManager.unregisterHandler(window.document,this._contextMenuHandler),this._contextMenuHandler=null},d.showDefaultContextMenu=function(e){return this.show(e),!0},e.createContextMenu=function(){var t=n(14).App,i=e._contextMenuUser.theRoot,r={PopulateDynamically:"true",PopulateOnlyOnce:"false"};r.PopulateQueryCommand=""+m.a.populateContextMenu,r.Command=""+c.a.alwaysEnabled;var o=a.AFrameworkApplication.theActionManager;t.instance.isSmallView&&!e._newEmbedModeIsEnabled?(e._menuId="mnuEmbedViewer",t.instance.isAccessiblePdfMode||o.addActionWithFlags(m.a.populateContextMenu,v.a.application,e.populateContextMenuEmbedded,96)):(e._menuId="mnuSelectionViewer",o.addActionWithFlags(m.a.populateContextMenu,v.a.application,e.populateContextMenuSelection,96)),i.createContextMenu(r,e._menuId,"","","Menu16")},e.populateContextMenuEmbedded=function(t,n,i,r,s){if(1===i)return 32;var l=s,c=new Sys.StringBuilder;return c.append(String.format('<Menu Id="{0}">',e._menuId)),c.append('<MenuSection Id="msZoomLevel" DisplayMode="Menu"><Controls>'),c.append(o.a("fseaFitHeight","2719151194",WordViewerIntl.WordViewerStrings.L_FitHeight)),c.append(o.a("fseaFitWidth","2289035997",WordViewerIntl.WordViewerStrings.L_FitWidth)),c.append(o.f("100","3006111724",100)),c.append(o.f("150","3006111724",150)),c.append("</Controls></MenuSection>"),a.AFrameworkApplication.trimDownloadACopy||(c.append('<MenuSection Id="msDownload" DisplayMode="Menu"><Controls>'),c.append(o.a("fseaDownloadACopy","3555692408",CommonUIStrings.L_DownloadACopy)),c.append("</Controls></MenuSection>")),c.append('<MenuSection Id="msFullScreen" DisplayMode="Menu"><Controls>'),c.append(o.a("fseaFullScreen","2947452783",WordViewerIntl.WordViewerStrings.L_FullScreen)),c.append("</Controls></MenuSection></Menu>"),l.PopulationXML=c.toString(),32},e.populateContextMenuSelection=function(t,i,r,a,o){var s=n(14).App,l=n(14).App.instance.copyingEnabled,u=!n(14).App.instance.accessibleModeEnabled&&n(14).App.instance.userCanComment&&n(14).App.instance.fileTypeSupportsCommenting;if(1===r)return s.instance.isAccessiblePdfMode?8:l||u?32:8;var d=o,p=new Sys.StringBuilder;return p.append(String.format('<Menu Id="{0}">',e._menuId)),l&&(p.append('<MenuSection Id="msCopy" DisplayMode="Menu16"><Controls>'),p.append(e.generateButtonWithImageXml("fseaCopy",m.a.copy,"Copy_16x16x32",WordViewerIntl.WordViewerStrings.L_Copy)),p.append("</Controls></MenuSection>")),u&&(p.append('<MenuSection Id="msComment" DisplayMode="Menu16"><Controls>'),p.append(e.generateButtonWithImageXml("fseaComment",c.a.newComment,"CommentComment_16x16x32",WordViewerIntl.WordViewerStrings.L_Comment)),p.append("</Controls></MenuSection>")),p.append("</Menu>"),d.PopulationXML=p.toString(),32},e.showFromKey=function(t){e.ensureContextMenuCreated(),"mnuSelectionViewer"===e._menuId&&a.AFrameworkApplication.theActionManager.processAction(m.a.showContextMenuFromKey,1)},e.ensureContextMenuCreated=function(){e._inited||(e.createContextMenu(),e._inited=!0)},e.generateButtonWithImageXml=function(e,t,n,i){return String.format('<Button Id="{0}" Command="{1}" Image16by16="{2}" Image16by16Class="{3}" LabelText="{4}"/>',e,t,a.AFrameworkApplication.imageClusterPath,s.getImageClass(n),l.a.xmlEncode(i))},t=e,u=[{key:"contextMenuUser",get:function(){return e._contextMenuUser}}],(i=null)&&_(t.prototype,i),u&&_(t,u),e}();y._contextMenuUser=null,y._menuId=null,y._inited=!1,y._newEmbedModeIsEnabled=!1,Object(i.a)(y,"ContextMenuControl",null,[])},function(e,t,n){"use strict";var i=n(171),r=n(120),a=n(405),o=n(235),s=n(406),l=n(373),c=n(409),u=n(146),d=n(145),p=n(444),h=n(236),m=n(445);e.exports=function(e,t,n){var g=-1!==e.indexOf("Map"),f=-1!==e.indexOf("Weak"),v=g?"set":"add",_=r[e],y=_&&_.prototype,b=_,S={},C=function(e){var t=y[e];o(y,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(f&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return f&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(f&&!u(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(a(e,"function"!=typeof _||!(f||y.forEach&&!d((function(){(new _).entries().next()})))))b=n.getConstructor(t,e,g,v),s.REQUIRED=!0;else if(a(e,!0)){var A=new b,I=A[v](f?{}:-0,1)!=A,w=d((function(){A.has(1)})),T=p((function(e){new _(e)})),E=!f&&d((function(){for(var e=new _,t=5;t--;)e[v](t,t);return!e.has(-0)}));T||((b=t((function(t,n){c(t,b,e);var i=m(new _,t,b);return null!=n&&l(n,i[v],i,g),i}))).prototype=y,y.constructor=b),(w||E)&&(C("delete"),C("has"),g&&C("get")),(E||I)&&C(v),f&&y.clear&&delete y.clear}return S[e]=b,i({global:!0,forced:b!=_},S),h(b,e),f||n.setStrong(b,e,g),b}},function(e,t,n){var i=n(144),r=n(145),a=n(399);e.exports=!i&&!r((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var i=n(120),r=n(146),a=i.document,o=r(a)&&r(a.createElement);e.exports=function(e){return o?a.createElement(e):{}}},function(e,t,n){var i=n(401),r=Function.toString;"function"!=typeof i.inspectSource&&(i.inspectSource=function(e){return r.call(e)}),e.exports=i.inspectSource},function(e,t,n){var i=n(120),r=n(367),a=i["__core-js_shared__"]||r("__core-js_shared__",{});e.exports=a},function(e,t,n){var i=n(139),r=n(403),a=n(293),o=n(147);e.exports=function(e,t){for(var n=r(t),s=o.f,l=a.f,c=0;c<n.length;c++){var u=n[c];i(e,u)||s(e,u,l(t,u))}}},function(e,t,n){var i=n(273),r=n(369),a=n(372),o=n(194);e.exports=i("Reflect","ownKeys")||function(e){var t=r.f(o(e)),n=a.f;return n?t.concat(n(e)):t}},function(e,t,n){var i=n(139),r=n(192),a=n(437).indexOf,o=n(272);e.exports=function(e,t){var n,s=r(e),l=0,c=[];for(n in s)!i(o,n)&&i(s,n)&&c.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~a(c,n)||c.push(n));return c}},function(e,t,n){var i=n(145),r=/#|\.prototype\./,a=function(e,t){var n=s[o(e)];return n==c||n!=l&&("function"==typeof t?i(t):!!t)},o=a.normalize=function(e){return String(e).replace(r,".").toLowerCase()},s=a.data={},l=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},function(e,t,n){var i=n(272),r=n(146),a=n(139),o=n(147).f,s=n(298),l=n(439),c=s("meta"),u=0,d=Object.isExtensible||function(){return!0},p=function(e){o(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},h=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,c)){if(!d(e))return"F";if(!t)return"E";p(e)}return e[c].objectID},getWeakData:function(e,t){if(!a(e,c)){if(!d(e))return!0;if(!t)return!1;p(e)}return e[c].weakData},onFreeze:function(e){return l&&h.REQUIRED&&d(e)&&!a(e,c)&&p(e),e}};i[c]=!0},function(e,t,n){var i=n(374);e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var i=n(376),r=n(365),a=n(121)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=i?r:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?n:o?r(t):"Object"==(i=r(t))&&"function"==typeof t.callee?"Arguments":i}},function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},function(e,t,n){var i=n(194),r=n(446);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,a){return i(n),r(a),t?e.call(n,a):n.__proto__=a,n}}():void 0)},function(e,t,n){"use strict";var i=n(147).f,r=n(300),a=n(449),o=n(375),s=n(409),l=n(373),c=n(377),u=n(452),d=n(144),p=n(406).fastKey,h=n(271),m=h.set,g=h.getterFor;e.exports={getConstructor:function(e,t,n,c){var u=e((function(e,i){s(e,u,t),m(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),d||(e.size=0),null!=i&&l(i,e[c],e,n)})),h=g(t),f=function(e,t,n){var i,r,a=h(e),o=v(e,t);return o?o.value=n:(a.last=o={index:r=p(t,!0),key:t,value:n,previous:i=a.last,next:void 0,removed:!1},a.first||(a.first=o),i&&(i.next=o),d?a.size++:e.size++,"F"!==r&&(a.index[r]=o)),e},v=function(e,t){var n,i=h(e),r=p(t);if("F"!==r)return i.index[r];for(n=i.first;n;n=n.next)if(n.key==t)return n};return a(u.prototype,{clear:function(){for(var e=h(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,d?e.size=0:this.size=0},delete:function(e){var t=h(this),n=v(this,e);if(n){var i=n.next,r=n.previous;delete t.index[n.index],n.removed=!0,r&&(r.next=i),i&&(i.previous=r),t.first==n&&(t.first=i),t.last==n&&(t.last=r),d?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=h(this),i=o(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(i(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!v(this,e)}}),a(u.prototype,n?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return f(this,0===e?0:e,t)}}:{add:function(e){return f(this,e=0===e?0:e,e)}}),d&&i(u.prototype,"size",{get:function(){return h(this).size}}),u},setStrong:function(e,t,n){var i=t+" Iterator",r=g(t),a=g(i);c(e,t,(function(e,t){m(this,{type:i,target:e,state:r(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(t)}}},function(e,t,n){"use strict";var i,r,a,o=n(413),s=n(193),l=n(139),c=n(121),u=n(297),d=c("iterator"),p=!1;[].keys&&("next"in(a=[].keys())?(r=o(o(a)))!==Object.prototype&&(i=r):p=!0),null==i&&(i={}),u||l(i,d)||s(i,d,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:p}},function(e,t,n){var i=n(139),r=n(275),a=n(296),o=n(451),s=a("IE_PROTO"),l=Object.prototype;e.exports=o?Object.getPrototypeOf:function(e){return e=r(e),i(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},function(e,t,n){"use strict";var i=n(454).charAt,r=n(271),a=n(377),o=r.set,s=r.getterFor("String Iterator");a(String,"String",(function(e){o(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=s(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=i(n,r),t.index+=e.length,{value:e,done:!1})}))},function(e,t,n){var i=n(120),r=n(455),a=n(416),o=n(193),s=n(121),l=s("iterator"),c=s("toStringTag"),u=a.values;for(var d in r){var p=i[d],h=p&&p.prototype;if(h){if(h[l]!==u)try{o(h,l,u)}catch(e){h[l]=u}if(h[c]||o(h,c,d),r[d])for(var m in a)if(h[m]!==a[m])try{o(h,m,a[m])}catch(e){h[m]=a[m]}}}},function(e,t,n){"use strict";var i=n(192),r=n(456),a=n(274),o=n(271),s=n(377),l=o.set,c=o.getterFor("Array Iterator");e.exports=s(Array,"Array",(function(e,t){l(this,{type:"Array Iterator",target:i(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var i=n(144),r=n(301),a=n(192),o=n(294).f,s=function(e){return function(t){for(var n,s=a(t),l=r(s),c=l.length,u=0,d=[];c>u;)n=l[u++],i&&!o.call(s,n)||d.push(e?[n,s[n]]:s[n]);return d}};e.exports={entries:s(!0),values:s(!1)}},function(e,t,n){var i=n(146),r=n(380),a=n(121)("species");e.exports=function(e,t){var n;return r(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!r(n.prototype)?i(n)&&null===(n=n[a])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t,n){var i,r,a=n(120),o=n(480),s=a.process,l=s&&s.versions,c=l&&l.v8;c?r=(i=c.split("."))[0]+i[1]:o&&(!(i=o.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=o.match(/Chrome\/(\d+)/))&&(r=i[1]),e.exports=r&&+r},function(e,t,n){var i=n(121);t.f=i},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return dangerouslyEval}));var dangerouslyEval=function dangerouslyEval(script){return eval(script)}},function(e,t,n){"use strict";n.r(t),n.d(t,"CompletableTask",(function(){return o}));var i=n(0),r=n(109),a=n(207);var o=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.SEsE=function(e){this.set_exception(a.a(e))},r.SEsA=function(e){this.set_exception(a.b(e))},r.SE=function(e){this.set_exception(e)},r.setResult=function(){this.setCompleted(!0)},i}(r.Task);Object(i.a)(o,"CompletableTask",r.Task,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(e,t,n,i,r,a,o,s,l,c,u,d,p,h){void 0===u&&(u=null),void 0===d&&(d=!1),void 0===p&&(p=null),void 0===h&&(h=null),this.status=0,this.httpStatus=0,this.responseData=null,this.responseXml=null,this.responseObject=null,this.responseHeaders=null,this.enqueueTime=null,this.invokedTime=null,this.invokedTimeTicks=0,this.completedTime=null,this.completedTimeTicks=0,this.requestQueuedTimeoutTask=null,this.id=e,this.priority=t,this.request=n,this.responseHeadersToSet=i,this.shouldSetResponseXml=r,this.successCallback=a,this.failureCallback=o,this.invokedCallback=h,this.state=s,this.isSynchronous=l,this.requestorId=c||"",this.completionCallbackTask=null,this.name=u,this.forceSynchronousNotify=d,this.extraInfo=p}var t,n,i;return t=e,(n=[{key:"shouldMarkOnTimeline",get:function(){return!!this.extraInfo&&this.extraInfo[e.keyOfFoundGetPutChanges]}}])&&r(t.prototype,n),i&&r(t,i),e}();a.keyOfFoundGetPutChanges="FoundGetPutChanges",a.keyOfGetChanges="GetChanges",a.keyOfPutChanges="PutChanges",Object(i.a)(a,"RequestItem",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i,r=n(0);!function(e){e[e.unknown=0]="unknown",e[e.excel=1]="excel",e[e.powerPoint=2]="powerPoint",e[e.word=3]="word",e[e.oneNote=4]="oneNote",e[e.visio=5]="visio"}(i||(i={})),Object(r.b)("OfficeAppType",i)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),r=(n(9),n(78)),a=n(24);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(e){this._validElements=e,this._currentIndex=Array.indexOf(this._validElements,this.firstElement)}var t,n,i,s=e.prototype;return s.dispose=function(){this._validElements=null},s.trySetCurrentElement=function(e){return this.setCurrentElement(e,!1),!0},s.forceSetCurrentElement=function(e){this.setCurrentElement(e,!0)},s.setCurrentElement=function(e,t){e&&(this.currentElement!==e||t)&&(e.tabIndex=0,a.FocusManager.tryFocus(e)),Array.contains(this._validElements,e)&&(this._currentIndex=Array.indexOf(this._validElements,e))},t=e,(n=[{key:"currentElement",get:function(){return this._validElements[this._currentIndex]}},{key:"previousElement",get:function(){var e=this._currentIndex;do{if(e){if(!(e>0&&e<this._validElements.length))break;e--}else e=this._validElements.length-1}while(!r.DOMFocusListing.elementFocusable(this._validElements[e])&&e!==this._currentIndex);return this._validElements[e]}},{key:"nextElement",get:function(){var e=this._currentIndex;do{if(e===this._validElements.length-1)e=0;else{if(!(e>=0&&e<this._validElements.length-1))break;e++}}while(!r.DOMFocusListing.elementFocusable(this._validElements[e])&&e!==this._currentIndex);return this._validElements[e]}},{key:"firstElement",get:function(){for(var e=0;!r.DOMFocusListing.elementFocusable(this._validElements[e])&&e<this._validElements.length;)e++;return r.DOMFocusListing.elementFocusable(this._validElements[e])?this._validElements[e]:null}},{key:"lastElement",get:function(){for(var e=this._validElements.length-1;!r.DOMFocusListing.elementFocusable(this._validElements[e])&&e>0;)e--;return r.DOMFocusListing.elementFocusable(this._validElements[e])?this._validElements[e]:null}}])&&o(t.prototype,n),i&&o(t,i),e}();Object(i.a)(s,"DialogFocusListing",null,[21])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};Object(i.a)(r,"ExtraInfo",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"AppSwitcher",(function(){return w}));var i=n(0),r=n(38),a=n(31),o=n(1),s=n(61),l=(n(9),n(55)),c=n(56),u=n(71),d=n(78),p=n(48),h=n(4),m=n(24),g=n(25),f=n(20),v=n(73),_=n(7),y=n(22),b=n(35),S=n(8),C=n(3);function A(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var w=function(){function e(){}return e.createSwitcherDropdown=function(t,n,i,r,a){var s=o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppSwitcherMitigationIsEnabled"),c=document.createElement("a");if(c.tabIndex=0,c.id=t+"-SwitcherLink",c.className="BreadcrumbItem SwitcherDropdown",s){var d=o.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppSwitcherRedirectUrl");d||(C.ULS.sendTraceTag(589037651,215,15,"switcherUrl is null"),d=o.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppSwitcherFallbackUrl")),c.target="_blank",c.href=d,c.setAttribute(_.a.ariaRoleAttribute,_.a.ariaLinkRole)}else c.href="javascript:void(0)",c.title=r.SwitcherTooltip.toString(),c.setAttribute(_.a.ariaRoleAttribute,_.a.ariaButtonRole);var p=l.createClusteredImage(50,50,"App_Switcher_Waffle_50x50x32","",!0,null);c.appendChild(p),n.appendChild(c),a&&!s&&(e.initializeSwitcherActions(),u.a.instance.registerHandler(h.EventNames.click,c,e.onSwitcherLauncherClick),f.KeyInputManager.instance.registerHandler(h.EventNames.keyDown,c,e.onSwitcherLauncherKeyDown),Array.add(i.breadcrumbItems,c),e.attachSwitcherEvents(i),e.attachSwitcherTileEvents(i))},e.onSwitcherLauncherKeyDown=function(e){return(e.innerEvent.keyCode===g.a.vK_Enter||e.innerEvent.keyCode===g.a.vK_Space)&&(o.AFrameworkApplication.theActionManager.processAction(S.a.openSwitcher,2),!0)},e.onSwitcherLauncherClick=function(e){return o.AFrameworkApplication.theActionManager.processAction(S.a.openSwitcher,2),!0},e.onO365SwitcherReadyHandler=function(t,n,i,r,a){return e._o365LoadingStopwatch&&(e._o365LoadingStopwatch.stop(),e._o365LoadingStopwatch=null),m.FocusManager.usable()&&e.pushScopeAndMoveIntoRegion(),32},e.pushScopeAndMoveIntoRegion=function(){var e=m.FocusManager.instance(),t=e.getRegion(a.AFrame.switcherFocusId);if(t){var n=e.currentScope;C.ULS.sendTraceTag(20525598,215,50,"Updating scope from '{0}' to '{1}'",n?n.name:"null",a.AFrame.switcherFocusId),n&&n.name===a.AFrame.switcherFocusId||e.pushScope(a.AFrame.switcherFocusId,!1),t.moveIntoFromTop()}},e.openSwitcher=function(){var t=document.getElementById("sw_bar"),n=document.getElementById("sw_barBG");t.style.display="block",n.style.display="block",Sys.UI.DomElement.containsCssClass(t,"SwitcherLoading")&&!e._o365LoadingStopwatch&&(C.ULS.sendTraceTag(7157248,215,50,"O365 switcher not ready, showing loading text instead"),o.AFrameworkApplication.theActionManager.addActionWithFlags(S.a.o365SwitcherReady,b.a.frame,e.onO365SwitcherReadyHandler,64),e._o365LoadingStopwatch=o.AFrameworkApplication.activeFrame.theStopwatchBuilder.makeAndStartStopwatch("LoadingUIShown","O365SwitcherLoadingUIShown")),Sys.UI.DomElement.removeCssClass(t,"closeAnimation");var i=r.CuiHelper.unifiedHeaderHeight+"px";if(window.setTimeout((function(){t.style.top=i}),0),window.setTimeout((function(){t.style.opacity="1"}),0),m.FocusManager.usable())e.pushScopeAndMoveIntoRegion();else{var a=document.getElementById("sw_Outlook");a&&a.focus()}e._switcherTileMouseUpHandler=e.restoreSwitcherTileVisuals,C.ULS.sendTraceTag(51196383,207,100,"Register MouseUp event. _isMouseUpEventRegistered: {0}",e._isMouseUpEventRegistered),e._isMouseUpEventRegistered||(v.a.instance.registerHandler(h.EventNames.mouseUp,document.body,e._switcherTileMouseUpHandler),e._isMouseUpEventRegistered=!0),Sys.UI.DomElement.addCssClass(t,"SwitcherActive")},e.closeSwitcher=function(){var t=document.getElementById("sw_bar"),n=document.getElementById("sw_barBG");Sys.UI.DomElement.containsCssClass(t,"closeAnimation")||Sys.UI.DomElement.addCssClass(t,"closeAnimation"),t.style.top="30px",t.style.opacity="0",n.style.display="none",window.setTimeout((function(){t.style.display="none"}),200),m.FocusManager.instance().popScope(a.AFrame.switcherFocusId),e.unregisterSwitcherMouseUpEvent(),Sys.UI.DomElement.removeCssClass(t,"SwitcherActive")},e.attachSwitcherEvents=function(t){var n=document.getElementById("sw_bar"),i=document.getElementById("sw_barBG");n&&i&&(u.a.instance.registerHandlerWithBrowserClickOption(h.EventNames.click,n,e.onSwitcherBackgroundClick,null,!0),u.a.instance.registerHandlerWithBrowserClickOption(h.EventNames.click,i,e.onSwitcherBackgroundClick,null,!0),Array.add(t.breadcrumbItems,n),Array.add(t.breadcrumbItems,i))},e.openSwitcherHandler=function(t,n,i,r,a){return o.AFrameworkApplication.activeFrame.onBeforeOpenSwitcher()&&e.openSwitcher(),32},e.onSwitcherBackgroundClick=function(e){return o.AFrameworkApplication.theActionManager.processAction(S.a.closeSwitcher,2),!1},e.closeSwitcherHandler=function(t,n,i,r,a){return o.AFrameworkApplication.activeFrame.onBeforeCloseSwitcher()&&e.closeSwitcher(),32},e.onSwitcherTileClick=function(e){var t;(o.AFrameworkApplication.theActionManager.processAction(S.a.switcherTileClick,2),e.caughtElement)&&C.ULS.sendTraceTag(7157252,207,50,"SwitcherTileClick {0}",((t={}).id=e.caughtElement.id,t.href=e.caughtElement.getAttribute("href"),t));return!1},e.onSwitcherTileMouseDown=function(e){return e.caughtElement&&Sys.UI.DomElement.addCssClass(e.caughtElement,"tilePressed"),!1},e.restoreSwitcherTileVisuals=function(t){if(!e._switcherTiles)return!1;for(var n,i=A(e._switcherTiles);!(n=i()).done;){var r=n.value;Sys.UI.DomElement.removeCssClass(r,"tilePressed")}return!1},e.onSwitcherTileDragStart=function(e){return e.innerEvent.preventDefault(),!1},e.initializeSwitcherActions=function(){e._switcherInitialized||(o.AFrameworkApplication.theActionManager.addAction(S.a.openSwitcher,b.a.frame,e.openSwitcherHandler),o.AFrameworkApplication.theActionManager.addAction(S.a.closeSwitcher,b.a.frame,e.closeSwitcherHandler),o.AFrameworkApplication.theActionManager.addAction(S.a.switcherTileClick,b.a.frame,s.ActionManager.doNothingButReportHandler))},e.attachSwitcherTileEvents=function(t){var n=document.getElementById("sw_tileList");if(n){e._switcherTiles=y.DomUtils.getChildrenByClassName(n,"swTile"),e._switcherTileLinks=new Array(0);for(var i,r=A(e._switcherTiles);!(i=r()).done;){var a=i.value;v.a.instance.registerHandler(h.EventNames.mouseDown,a,e.onSwitcherTileMouseDown),c.a.instance.registerHandler(h.EventNames.dragStart,a,e.onSwitcherTileDragStart);var o=y.DomUtils.getChildByClassName(a,"swTileLink");0,o&&(u.a.instance.registerHandlerWithBrowserClickOption(h.EventNames.click,o,e.onSwitcherTileClick,null,!0),Array.add(e._switcherTileLinks,o))}}},e.unregisterSwitcherMouseUpEvent=function(){e._switcherTileMouseUpHandler&&(C.ULS.sendTraceTag(51196384,207,100,"Unregister MouseUp event. _isMouseUpEventRegistered: {0}",e._isMouseUpEventRegistered),e._isMouseUpEventRegistered&&(v.a.instance.unregisterHandler(h.EventNames.mouseUp,document.body,e._switcherTileMouseUpHandler),e._isMouseUpEventRegistered=!1)),e._switcherTileMouseUpHandler=null},e.setupFocusRegionForSwitcher=function(){if(!e._switcherInitialized){var t=m.FocusManager.instance(),n=t.getScope(a.AFrame.switcherFocusId);n.parent=a.AFrame.appFocusId;var i=new d.DOMFocusListing((function(){return document.getElementById("sw_bar")}));i.addValidTag(1),i.rememberFirstElement=!0,i.rememberLastElement=!0,n.bindAction(f.KeyInputManager.hashKey(g.a.vK_Esc,0),S.a.closeSwitcher),t.buildRegionWithDelegate((function(){return document.getElementById("sw_bar")}),n,i).looped=!0,e._switcherInitialized=!0}},e.disposeSwitcher=function(){e._switcherTiles&&p.EventHandlerManager.instance.unregisterAllHandlersForDOMArray(e._switcherTiles),e._switcherTileLinks&&p.EventHandlerManager.instance.unregisterAllHandlersForDOMArray(e._switcherTileLinks),e.unregisterSwitcherMouseUpEvent()},e}();w._switcherTileMouseUpHandler=null,w._isMouseUpEventRegistered=!1,w._switcherTiles=null,w._switcherTileLinks=null,w._switcherInitialized=!1,w._o365LoadingStopwatch=null,Object(i.a)(w,"AppSwitcher",null,[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(0),r=function(){};r.open="open",r.refresh="refresh",r.saveAs="saveAs",r.translate="translate",r.modeSwitch="modeSwitch",r.createNew="createNew",r.convert="convert",Object(i.a)(r,"ReasonList",null,[])},function(e,t,n){n(430),n(431),n(520),e.exports=n(519)},function(e,t,n){n.p=function(){var e=function(e){return e.toLowerCase().endsWith("/wordviewerds.js")?e.substring(0,e.lastIndexOf("/")+1):null},t=document.currentScript,n=null;if(n=t?e(t.src):function(){for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var i=e(t[n].src);if(i)return i}return null}())return n;throw"Could not locate webpack public path"}()},function(e,t,n){"use strict";n.r(t);n(432),n(457),n(461),n(464),n(467),n(470),n(473),n(476),n(500)},function(e,t,n){var i=n(433);e.exports=i},function(e,t,n){n(434),n(378),n(414),n(415);var i=n(172);e.exports=i.Map},function(e,t,n){"use strict";var i=n(397),r=n(411);e.exports=i("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var i=n(120),r=n(400),a=i.WeakMap;e.exports="function"==typeof a&&/native code/.test(r(a))},function(e,t,n){var i=n(192),r=n(299),a=n(438),o=function(e){return function(t,n,o){var s,l=i(t),c=r(l.length),u=a(o,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},function(e,t,n){var i=n(370),r=Math.max,a=Math.min;e.exports=function(e,t){var n=i(e);return n<0?r(n+t,0):a(n,t)}},function(e,t,n){var i=n(145);e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,n){var i=n(121),r=n(274),a=i("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[a]===e)}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var i=n(408),r=n(274),a=n(121)("iterator");e.exports=function(e){if(null!=e)return e[a]||e["@@iterator"]||r[i(e)]}},function(e,t,n){var i=n(194);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&i(a.call(e)),t}}},function(e,t,n){var i=n(121)("iterator"),r=!1;try{var a=0,o={next:function(){return{done:!!a++}},return:function(){r=!0}};o[i]=function(){return this},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var a={};a[i]=function(){return{next:function(){return{done:n=!0}}}},e(a)}catch(e){}return n}},function(e,t,n){var i=n(146),r=n(410);e.exports=function(e,t,n){var a,o;return r&&"function"==typeof(a=t.constructor)&&a!==n&&i(o=a.prototype)&&o!==n.prototype&&r(e,o),e}},function(e,t,n){var i=n(146);e.exports=function(e){if(!i(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,n){var i=n(144),r=n(147),a=n(194),o=n(301);e.exports=i?Object.defineProperties:function(e,t){a(e);for(var n,i=o(t),s=i.length,l=0;s>l;)r.f(e,n=i[l++],t[n]);return e}},function(e,t,n){var i=n(273);e.exports=i("document","documentElement")},function(e,t,n){var i=n(235);e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},function(e,t,n){"use strict";var i=n(412).IteratorPrototype,r=n(300),a=n(270),o=n(236),s=n(274),l=function(){return this};e.exports=function(e,t,n){var c=t+" Iterator";return e.prototype=r(i,{next:a(1,n)}),o(e,c,!1,!0),s[c]=l,e}},function(e,t,n){var i=n(145);e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){"use strict";var i=n(273),r=n(147),a=n(121),o=n(144),s=a("species");e.exports=function(e){var t=i(e),n=r.f;o&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var i=n(376),r=n(408);e.exports=i?{}.toString:function(){return"[object "+r(this)+"]"}},function(e,t,n){var i=n(370),r=n(366),a=function(e){return function(t,n){var a,o,s=String(r(t)),l=i(n),c=s.length;return l<0||l>=c?e?"":void 0:(a=s.charCodeAt(l))<55296||a>56319||l+1===c||(o=s.charCodeAt(l+1))<56320||o>57343?e?s.charAt(l):a:e?s.slice(l,l+2):o-56320+(a-55296<<10)+65536}};e.exports={codeAt:a(!1),charAt:a(!0)}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,n){var i=n(121),r=n(300),a=n(147),o=i("unscopables"),s=Array.prototype;null==s[o]&&a.f(s,o,{configurable:!0,value:r(null)}),e.exports=function(e){s[o][e]=!0}},function(e,t,n){var i=n(458);e.exports=i},function(e,t,n){n(459);var i=n(172);e.exports=i.Object.assign},function(e,t,n){var i=n(171),r=n(460);i({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r})},function(e,t,n){"use strict";var i=n(144),r=n(145),a=n(301),o=n(372),s=n(294),l=n(275),c=n(364),u=Object.assign,d=Object.defineProperty;e.exports=!u||r((function(){if(i&&1!==u({b:1},u(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||"abcdefghijklmnopqrst"!=a(u({},t)).join("")}))?function(e,t){for(var n=l(e),r=arguments.length,u=1,d=o.f,p=s.f;r>u;)for(var h,m=c(arguments[u++]),g=d?a(m).concat(d(m)):a(m),f=g.length,v=0;f>v;)h=g[v++],i&&!p.call(m,h)||(n[h]=m[h]);return n}:u},function(e,t,n){var i=n(462);e.exports=i},function(e,t,n){n(463);var i=n(172);e.exports=i.Object.entries},function(e,t,n){var i=n(171),r=n(417).entries;i({target:"Object",stat:!0},{entries:function(e){return r(e)}})},function(e,t,n){var i=n(465);e.exports=i},function(e,t,n){n(416),n(466);var i=n(172);e.exports=i.Object.fromEntries},function(e,t,n){var i=n(171),r=n(373),a=n(379);i({target:"Object",stat:!0},{fromEntries:function(e){var t={};return r(e,(function(e,n){a(t,e,n)}),void 0,!0),t}})},function(e,t,n){var i=n(468);e.exports=i},function(e,t,n){n(469);var i=n(172);e.exports=i.Object.getOwnPropertyDescriptors},function(e,t,n){var i=n(171),r=n(144),a=n(403),o=n(192),s=n(293),l=n(379);i({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(e){for(var t,n,i=o(e),r=s.f,c=a(i),u={},d=0;c.length>d;)void 0!==(n=r(i,t=c[d++]))&&l(u,t,n);return u}})},function(e,t,n){var i=n(471);e.exports=i},function(e,t,n){n(472);var i=n(172);e.exports=i.Object.values},function(e,t,n){var i=n(171),r=n(417).values;i({target:"Object",stat:!0},{values:function(e){return r(e)}})},function(e,t,n){var i=n(474);e.exports=i},function(e,t,n){n(475),n(378),n(414),n(415);var i=n(172);e.exports=i.Set},function(e,t,n){"use strict";var i=n(397),r=n(411);e.exports=i("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},function(e,t,n){var i=n(477);e.exports=i},function(e,t,n){n(478),n(378),n(481),n(484),n(485),n(486),n(487),n(488),n(489),n(490),n(491),n(492),n(493),n(494),n(495),n(496),n(497),n(498),n(499);var i=n(172);e.exports=i.Symbol},function(e,t,n){"use strict";var i=n(171),r=n(145),a=n(380),o=n(146),s=n(275),l=n(299),c=n(379),u=n(418),d=n(479),p=n(121),h=n(419),m=p("isConcatSpreadable"),g=h>=51||!r((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),f=d("concat"),v=function(e){if(!o(e))return!1;var t=e[m];return void 0!==t?!!t:a(e)};i({target:"Array",proto:!0,forced:!g||!f},{concat:function(e){var t,n,i,r,a,o=s(this),d=u(o,0),p=0;for(t=-1,i=arguments.length;t<i;t++)if(v(a=-1===t?o:arguments[t])){if(p+(r=l(a.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<r;n++,p++)n in a&&c(d,p,a[n])}else{if(p>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(d,p++,a)}return d.length=p,d}})},function(e,t,n){var i=n(145),r=n(121),a=n(419),o=r("species");e.exports=function(e){return a>=51||!i((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){var i=n(273);e.exports=i("navigator","userAgent")||""},function(e,t,n){"use strict";var i=n(171),r=n(120),a=n(273),o=n(297),s=n(144),l=n(374),c=n(407),u=n(145),d=n(139),p=n(380),h=n(146),m=n(194),g=n(275),f=n(192),v=n(295),_=n(270),y=n(300),b=n(301),S=n(369),C=n(482),A=n(372),I=n(293),w=n(147),T=n(294),E=n(193),k=n(235),M=n(368),P=n(296),F=n(272),D=n(298),O=n(121),R=n(420),x=n(135),U=n(236),B=n(271),L=n(483).forEach,N=P("hidden"),H=O("toPrimitive"),W=B.set,j=B.getterFor("Symbol"),V=Object.prototype,K=r.Symbol,z=a("JSON","stringify"),q=I.f,G=w.f,Q=C.f,Z=T.f,$=M("symbols"),X=M("op-symbols"),J=M("string-to-symbol-registry"),Y=M("symbol-to-string-registry"),ee=M("wks"),te=r.QObject,ne=!te||!te.prototype||!te.prototype.findChild,ie=s&&u((function(){return 7!=y(G({},"a",{get:function(){return G(this,"a",{value:7}).a}})).a}))?function(e,t,n){var i=q(V,t);i&&delete V[t],G(e,t,n),i&&e!==V&&G(V,t,i)}:G,re=function(e,t){var n=$[e]=y(K.prototype);return W(n,{type:"Symbol",tag:e,description:t}),s||(n.description=t),n},ae=c?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof K},oe=function(e,t,n){e===V&&oe(X,t,n),m(e);var i=v(t,!0);return m(n),d($,i)?(n.enumerable?(d(e,N)&&e[N][i]&&(e[N][i]=!1),n=y(n,{enumerable:_(0,!1)})):(d(e,N)||G(e,N,_(1,{})),e[N][i]=!0),ie(e,i,n)):G(e,i,n)},se=function(e,t){m(e);var n=f(t),i=b(n).concat(de(n));return L(i,(function(t){s&&!le.call(n,t)||oe(e,t,n[t])})),e},le=function(e){var t=v(e,!0),n=Z.call(this,t);return!(this===V&&d($,t)&&!d(X,t))&&(!(n||!d(this,t)||!d($,t)||d(this,N)&&this[N][t])||n)},ce=function(e,t){var n=f(e),i=v(t,!0);if(n!==V||!d($,i)||d(X,i)){var r=q(n,i);return!r||!d($,i)||d(n,N)&&n[N][i]||(r.enumerable=!0),r}},ue=function(e){var t=Q(f(e)),n=[];return L(t,(function(e){d($,e)||d(F,e)||n.push(e)})),n},de=function(e){var t=e===V,n=Q(t?X:f(e)),i=[];return L(n,(function(e){!d($,e)||t&&!d(V,e)||i.push($[e])})),i};(l||(k((K=function(){if(this instanceof K)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=D(e),n=function e(n){this===V&&e.call(X,n),d(this,N)&&d(this[N],t)&&(this[N][t]=!1),ie(this,t,_(1,n))};return s&&ne&&ie(V,t,{configurable:!0,set:n}),re(t,e)}).prototype,"toString",(function(){return j(this).tag})),k(K,"withoutSetter",(function(e){return re(D(e),e)})),T.f=le,w.f=oe,I.f=ce,S.f=C.f=ue,A.f=de,R.f=function(e){return re(O(e),e)},s&&(G(K.prototype,"description",{configurable:!0,get:function(){return j(this).description}}),o||k(V,"propertyIsEnumerable",le,{unsafe:!0}))),i({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:K}),L(b(ee),(function(e){x(e)})),i({target:"Symbol",stat:!0,forced:!l},{for:function(e){var t=String(e);if(d(J,t))return J[t];var n=K(t);return J[t]=n,Y[n]=t,n},keyFor:function(e){if(!ae(e))throw TypeError(e+" is not a symbol");if(d(Y,e))return Y[e]},useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),i({target:"Object",stat:!0,forced:!l,sham:!s},{create:function(e,t){return void 0===t?y(e):se(y(e),t)},defineProperty:oe,defineProperties:se,getOwnPropertyDescriptor:ce}),i({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:ue,getOwnPropertySymbols:de}),i({target:"Object",stat:!0,forced:u((function(){A.f(1)}))},{getOwnPropertySymbols:function(e){return A.f(g(e))}}),z)&&i({target:"JSON",stat:!0,forced:!l||u((function(){var e=K();return"[null]"!=z([e])||"{}"!=z({a:e})||"{}"!=z(Object(e))}))},{stringify:function(e,t,n){for(var i,r=[e],a=1;arguments.length>a;)r.push(arguments[a++]);if(i=t,(h(t)||void 0!==e)&&!ae(e))return p(t)||(t=function(e,t){if("function"==typeof i&&(t=i.call(this,e,t)),!ae(t))return t}),r[1]=t,z.apply(null,r)}});K.prototype[H]||E(K.prototype,H,K.prototype.valueOf),U(K,"Symbol"),F[N]=!0},function(e,t,n){var i=n(192),r=n(369).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?function(e){try{return r(e)}catch(e){return o.slice()}}(e):r(i(e))}},function(e,t,n){var i=n(375),r=n(364),a=n(275),o=n(299),s=n(418),l=[].push,c=function(e){var t=1==e,n=2==e,c=3==e,u=4==e,d=6==e,p=5==e||d;return function(h,m,g,f){for(var v,_,y=a(h),b=r(y),S=i(m,g,3),C=o(b.length),A=0,I=f||s,w=t?I(h,C):n?I(h,0):void 0;C>A;A++)if((p||A in b)&&(_=S(v=b[A],A,y),e))if(t)w[A]=_;else if(_)switch(e){case 3:return!0;case 5:return v;case 6:return A;case 2:l.call(w,v)}else if(u)return!1;return d?-1:c||u?u:w}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},function(e,t,n){n(135)("asyncIterator")},function(e,t,n){"use strict";var i=n(171),r=n(144),a=n(120),o=n(139),s=n(146),l=n(147).f,c=n(402),u=a.Symbol;if(r&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var d={},p=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof p?new u(e):void 0===e?u():u(e);return""===e&&(d[t]=!0),t};c(p,u);var h=p.prototype=u.prototype;h.constructor=p;var m=h.toString,g="Symbol(test)"==String(u("test")),f=/^Symbol\((.*)\)[^)]+$/;l(h,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=m.call(e);if(o(d,e))return"";var n=g?t.slice(7,-1):t.replace(f,"$1");return""===n?void 0:n}}),i({global:!0,forced:!0},{Symbol:p})}},function(e,t,n){n(135)("hasInstance")},function(e,t,n){n(135)("isConcatSpreadable")},function(e,t,n){n(135)("iterator")},function(e,t,n){n(135)("match")},function(e,t,n){n(135)("matchAll")},function(e,t,n){n(135)("replace")},function(e,t,n){n(135)("search")},function(e,t,n){n(135)("species")},function(e,t,n){n(135)("split")},function(e,t,n){n(135)("toPrimitive")},function(e,t,n){n(135)("toStringTag")},function(e,t,n){n(135)("unscopables")},function(e,t,n){n(236)(Math,"Math",!0)},function(e,t,n){var i=n(120);n(236)(i.JSON,"JSON",!0)},function(e,t,n){var i=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var r=t&&t.prototype instanceof d?t:d,a=Object.create(r.prototype),o=new A(i||[]);return a._invoke=function(e,t,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return w()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=b(o,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=c(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(e,n,o),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function d(){}function p(){}function h(){}var m={};m[r]=function(){return this};var g=Object.getPrototypeOf,f=g&&g(g(I([])));f&&f!==t&&n.call(f,r)&&(m=f);var v=h.prototype=d.prototype=Object.create(m);function _(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){var i;this._invoke=function(r,a){function o(){return new t((function(i,o){!function i(r,a,o,s){var l=c(e[r],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,o,s)}),(function(e){i("throw",e,o,s)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return i("throw",e,o,s)}))}s(l.arg)}(r,a,i,o)}))}return i=i?i.then(o,o):o()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var i=c(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:w}}function w(){return{value:void 0,done:!0}}return p.prototype=v.constructor=h,h.constructor=p,p.displayName=s(h,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},_(y.prototype),y.prototype[a]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var o=new y(l(t,n,i,r),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(v),s(v,o,"Generator"),v[r]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=I,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return o.type="throw",o.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=i}catch(e){Function("r","regeneratorRuntime = r")(i)}},function(e,t,n){"use strict";n.r(t),n.d(t,"IgnoreTaskManagerRunningScope",(function(){return a}));var i=n(0),r=n(48),a=function(){function e(){r.EventHandlerManager.instance.startIgnoringTaskManagerRunning()}return e.prototype.dispose=function(){r.EventHandlerManager.instance.stopIgnoringTaskManagerRunning()},e}();Object(i.a)(a,"IgnoreTaskManagerRunningScope",null,[4])},function(e,t,n){"use strict";n.r(t),n.d(t,"A11yTab",(function(){return a}));var i=n(0),r=n(154);var a=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);a._contentDiv=null,a._focusScopeDiv=null,a._activeElementDiv=null,Object(i.a)(a,"A11yTab",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"EuplTelemetryLogger",(function(){return a}));var i=n(0),r=n(1),a=function(){function e(){this.requestType="PERF_EUPL"}var t=e.prototype;return t.logToMdm=function(e,t){var n=this.prepareRequestPayload(e,t);r.AFrameworkApplication.theClientRequestManager.addRequest(r.AFrameworkApplication.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),2,n,null,!1,1,null,null,null,void 0,void 0,void 0,void 0,"PerfTelemetry")},t.prepareRequestPayload=function(e,t){var n={},i={};return n.euplValue=e,n.perfEuplDimensions=t,i.type=this.requestType,i.payloadJson=JSON.stringify(n),JSON.stringify(i)},e}();Object(i.a)(a,"EuplTelemetryLogger",null,[221])},function(e,t,n){"use strict";n.r(t),n.d(t,"HostCallsTelemetryLogger",(function(){return a}));var i=n(0),r=n(1),a=function(){function e(){this.requestType="PERF_HOSTCALLS"}var t=e.prototype;return t.logToMdm=function(e,t){var n=this.prepareRequestPayload(e,t);r.AFrameworkApplication.theClientRequestManager.addRequest(r.AFrameworkApplication.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),2,n,null,!1,1,null,null,null,void 0,void 0,void 0,void 0,"PerfTelemetry")},t.prepareRequestPayload=function(e,t){var n={},i={};return n.hostCallPerfValue=e,n.perfHostCallDimensions=t,i.type=this.requestType,i.payloadJson=JSON.stringify(n),JSON.stringify(i)},e}();Object(i.a)(a,"HostCallsTelemetryLogger",null,[221])},function(e,t,n){"use strict";n.r(t),n.d(t,"MoveDragAdapter",(function(){return o}));var i=n(0),r=n(1),a=n(52),o=function(){function e(e){this._cursorOffsetX=0,this._cursorOffsetY=0,this._moveElementMargin=null,this._moveElementMarginSet=!1,this._moveElement=e}var t=e.prototype;return t.isDragPossible=function(e){return!0},t.onDragStart=function(e){var t=e.clientPoint.x,n=e.clientPoint.y,i=this._moveElement.offsetLeft,r=this._moveElement.offsetTop,a=this.getMargin(this._moveElement);return this._cursorOffsetX=t-i+a.x,this._cursorOffsetY=n-r+a.y,!0},t.onDragMove=function(e){var t=e.clientPoint.x-this._cursorOffsetX,n=e.clientPoint.y-this._cursorOffsetY,i=r.AFrameworkApplication.activeFrame.getDOMElement();if(this._moveElementMarginSet||(this._moveElementMargin=this.getMargin(this._moveElement),this._moveElementMarginSet=!0),t+this._moveElementMargin.x<0)t=-this._moveElementMargin.x;else{var a=i.offsetWidth-this._moveElement.offsetWidth-this._moveElementMargin.x;t>a&&(t=a)}if(n+this._moveElementMargin.y<0)n=-this._moveElementMargin.y;else{var o=i.offsetHeight-this._moveElement.offsetHeight-this._moveElementMargin.y;n>o&&(n=o)}return r.AFrameworkApplication.isRtl?this._moveElement.style.right=i.offsetWidth-t-this._moveElement.offsetWidth+"px":this._moveElement.style.left=t+"px",this._moveElement.style.top=n+"px",!0},t.onDragEnd=function(e){},t.onDragCancel=function(e){},t.getMargin=function(e){var t=a.CssUtils.getCurrentStyle(e);if(!t)return new Sys.UI.Point(0,0);var n=t.marginTop,i=t.marginLeft,o=parseInt(n),s=parseInt(i);if(r.AFrameworkApplication.isRtl){var l=t.marginRight;s-=parseInt(l)}return new Sys.UI.Point(isNaN(s)?0:s,isNaN(o)?0:o)},e}();Object(i.a)(o,"MoveDragAdapter",null,[77])},function(e,t,n){"use strict";n.r(t),n.d(t,"HealthConnectivityListener",(function(){return s}));var i=n(0),r=n(85),a=n(99),o=n(3),s=function(){function e(){}var t=e.prototype;return t.networkDisconnected=function(){o.ULS.sendTraceTag(579393666,383,50,"Lost connection to the internet. Health 2.0 events will be stored on IndexedDB until the connection is restored"),r.Health.instance.setIsAppOnline(!1),a.a.isAppOnline=!1},t.networkResumed=function(){o.ULS.sendTraceTag(579393667,383,50,"Connection restored. Any events in our IndexedDB database will now be flushed"),r.Health.instance.setIsAppOnline(!0),a.a.isAppOnline=!0},e}();Object(i.a)(s,"HealthConnectivityListener",null,[94])},function(e,t,n){"use strict";n.r(t),n.d(t,"XMLHttpCrossDomainRequest",(function(){return s}));var i=n(0),r=n(2),a=n(179);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._request=new XMLHttpRequest,t._request.onreadystatechange=Object(r.d)(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),t.onReadyStateChange,"onReadyStateChange"),t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,s,l,c=i.prototype;return c.abort=function(){this._request.abort()},c.getResponseHeader=function(e){return this._request.getResponseHeader(e)},c.send=function(e){this._request.send(e)},c.open=function(e,t){this._request.open(e,t,!0)},c.onReadyStateChange=function(){4===this._request.readyState&&this.onRequestCompleted()},a=i,(s=[{key:"contentType",get:function(){return this._request.getResponseHeader("Content-Type")}},{key:"responseText",get:function(){return this._request.responseText}},{key:"statusCode",get:function(){return this._request.status}},{key:"statusText",get:function(){return this._request.statusText}}])&&o(a.prototype,s),l&&o(a,l),i}(a.a);Object(i.a)(s,"XMLHttpCrossDomainRequest",a.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"XDomainCrossDomainRequest",(function(){return l}));var i=n(0),r=n(2),a=n(179);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var l=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._statusCode=0,t._request=new XDomainRequest,t._request.onload=Object(r.d)(s(t),t.onLoad,"onLoad"),t._request.onerror=Object(r.d)(s(t),t.onError,"onError"),t._request.ontimeout=Object(r.d)(s(t),t.onTimeout,"onTimeout"),t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,l,c,u=i.prototype;return u.abort=function(){this._statusCode=-1,this._request.abort()},u.send=function(e){this._request.send(e)},u.open=function(e,t){this._request.open(e,t)},u.onLoad=function(){this.safeSetStatusCode(200),this.onRequestCompleted()},u.onError=function(){this.safeSetStatusCode(400),this.onRequestCompleted()},u.onTimeout=function(){this.safeSetStatusCode(408),this.onRequestCompleted()},u.getResponseHeader=function(e){return"Content-Type"===e?this._request.contentType:null},u.safeSetStatusCode=function(e){this._statusCode||(this._statusCode=e)},a=i,(l=[{key:"contentType",get:function(){return this._request.contentType}},{key:"responseText",get:function(){return this._request.responseText}},{key:"statusCode",get:function(){return this._statusCode}}])&&o(a.prototype,l),c&&o(a,c),i}(a.a);Object(i.a)(l,"XDomainCrossDomainRequest",a.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"StandardLabelDomStrategy",(function(){return u}));var i=n(0),r=(n(2),n(77)),a=(n(9),n(7)),o=n(64),s=n(202),l=(n(392),n(5)),c=n(6);var u=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.buildControlDom=function(e,t){var n=(new s.a).buildControlDom(e,t),i=o.a.isDisplayModeMenu(t),r="MediumCompact"===t;return this.setCssClasses(n.elmControl,i,r),this.setAccessibilityInfo(n.elmControl,i),this.setImageBackgroundColor(n.elmImage,e.controlProperties.ImageBackColor),this.setLabelForTarget(n.elmLabel,e.controlProperties.For),n},r.setCssClasses=function(e,t,n){e.className=n?"cui-fslb cui-ctl-compact":"cui-fslb",t&&(c.a.ensureCSSClassOnElement(e,"cui-ctl-menu"),c.a.ensureCSSClassOnElement(e,"cui-ctl-menu16"))},r.setAccessibilityInfo=function(e,t){e.tabIndex=-1,t||a.a.setAriaAttribute(e,"aria-hidden","true"),e.title=""},r.setImageBackgroundColor=function(e,t){e&&""!==t&&(e.style.backgroundColor=t)},r.setLabelForTarget=function(e,t){e&&!l.b(t)&&e.setAttribute("for",t)},i}(r.a);Object(i.a)(u,"StandardLabelDomStrategy",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"CheckRoamingRightsRequest",(function(){return a}));var i=n(0),r=n(266);var a=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.getPriority=function(){return 2},r.getClassId=function(){return 1},i}(r.a);Object(i.a)(a,"CheckRoamingRightsRequest",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"GetRoamingLauncherRequest",(function(){return a}));var i=n(0),r=n(266);var a=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.getPriority=function(){return 0},r.getClassId=function(){return 2},i}(r.a);Object(i.a)(a,"GetRoamingLauncherRequest",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"BreadcrumbContainer",(function(){return c}));var i=n(0),r=n(267),a=n(38),o=n(149),s=n(1),l=n(48);var c=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._elmContainer=o.a.createUnselectableElement("span"),t.elmContainer.className="cui-herobar-breadcrumbContainer",t.elmContainer.id="viewerChrome-breadcrumbContainer",s.AFrameworkApplication.hideHeader&&(a.CuiHelper.createAppBrandElement(t.elmContainer),(s.AFrameworkApplication.breadcrumbBrandName||s.AFrameworkApplication.breadcrumbFolderName)&&a.CuiHelper.createAppBrandSeparatorElement(t.elmContainer)),t._breadcrumbItems=a.CuiHelper.createHostBrandAndFolderElements(t.elmContainer,a.CuiHelper.breadcrumbAlternateSeparatorImageName),t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.getBreadcrumbItem=function(e){if(!this._breadcrumbItems)return null;for(var t=0;t<this._breadcrumbItems.length;t++)if(this._breadcrumbItems[t].id===e)return this._breadcrumbItems[t];return null},r.truncateWidth=function(t){if(this._elementToTruncate=this.getBreadcrumbItem(a.CuiHelper.breadcrumbFolderId),this._elementToTruncate){var n=i.calculateBreadcrumbFolderNameMaxWidth(this.elmContainer.offsetWidth,this._elementToTruncate.offsetWidth,t);n>0&&e.prototype.truncateWidth.call(this,n)}},r.dispose=function(){l.EventHandlerManager.instance.unregisterAllHandlersForDOMArray(this._breadcrumbItems)},i.calculateBreadcrumbFolderNameMaxWidth=function(e,t,n){return t-(e-n)},i}(r.a);Object(i.a)(c,"BreadcrumbContainer",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"DocumentTitleContainer",(function(){return c}));var i=n(0),r=n(267),a=n(38),o=n(149),s=n(1),l=n(55);var c=function(e){var t,n;function i(){var t;if((t=e.call(this)||this)._elmContainer=o.a.createUnselectableElement("span"),t.elmContainer.id="viewerChrome-documentTitleContainer",s.AFrameworkApplication.isMobileMode){t.elmContainer.className="cui-herobar-MobileDocTitleContainer";var n=l.createClusteredImage(32,32,s.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppIcon"),"AppHeaderIconFloat",!0,"");n.style.margin="4px",n.style.marginLeft="12px",t.elmContainer.appendChild(n)}else t.elmContainer.className="cui-herobar-documentTitleContainer";return s.AFrameworkApplication.docPropertiesProvider.breadcrumbDocName&&(t._elementToTruncate=a.CuiHelper.createDocumentTitleElementInternal(t.elmContainer,!1),s.AFrameworkApplication.isMobileMode&&(t._elementToTruncate.style.padding="10px 5px 10px",t._elementToTruncate.style.lineHeight="18px")),t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.dispose=function(){a.CuiHelper.disposeTitleElement()},i}(r.a);Object(i.a)(c,"DocumentTitleContainer",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"ToolbarContainer",(function(){return s}));var i=n(0),r=n(268),a=n(149),o=n(1);var s=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._elmContainer=a.a.createUnselectableElement("span"),t.elmContainer.className="cui-herobar-toolbarContainer",t.elmContainer.id="viewerChrome-ToolbarContainer",o.AFrameworkApplication.isMobileMode&&1===o.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&(t.elmContainer.style.fontSize="1.42em"),t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(r.a);Object(i.a)(s,"ToolbarContainer",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"PDFConvertFailureDialog",(function(){return d}));var i=n(0),r=n(262),a=n(1),o=n(164),s=n(3),l=n(14),c=n(229);function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(e){var t,n;function i(t){var n;return(n=e.call(this,t,a.AFrameworkApplication.isCloseable)||this)._isDisposed=!1,c.a(),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,d,p,h=i.prototype;return h.prepareDialog=function(){this.hasCloseGlyph=a.AFrameworkApplication.isCloseable,e.prototype.prepareDialog.call(this)},h.logDialogDisplayed=function(){s.ULS.sendTraceTag(7660227,301,50,"Download a PDF copy dialog displayed after PDF converter error")},h.logDownloadLinkClicked=function(){s.ULS.sendTraceTag(7660228,301,50,"Download a PDF copy dialog clicked after PDF converter error")},h.dispose=function(){this.hasBeenDisposed||(e.prototype.dispose.call(this),l.App.get_activeAppFrame().ribbonUser&&l.App.get_activeAppFrame().ribbonUser.poll(),o.a.closeAppOnErrorWithFailoverToBlank(),l.App.get_activeAppFrame().workspace.dispose(),this.hasBeenDisposed=!0)},r=i,(d=[{key:"hasBeenDisposed",get:function(){return this._isDisposed},set:function(e){this._isDisposed=e}},{key:"messageString",get:function(){return CommonUIStrings.l_PdfConvertFailureDialogMessage}},{key:"linkString",get:function(){return CommonUIStrings.l_PdfConvertFailureDialogLinkSuggestion}},{key:"linkId",get:function(){return"DownloadPDFCopyLink"}}])&&u(r.prototype,d),p&&u(r,p),i}(r.a);Object(i.a)(d,"PDFConvertFailureDialog",r.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"SaveAndEditDialog",(function(){return l}));var i=n(0),r=n(2),a=n(75),o=n(322),s=n(111);var l=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=i.prototype;return a.start=function(){var e=document.createElement("span"),t=document.createElement("div");t.innerText=WordViewerIntl.WordViewerStrings.L_SaveAndEditTranslatedDocumentDialogMessage,e.appendChild(t),this.dialogHtml=o.b(e),this.buttonsOption=1,this.showDialog(WordViewerIntl.WordViewerStrings.L_EditInBrowser,Object(r.d)(this,this.handleClick,"handleClick"))},a.handleClick=function(e,t){1===e&&s.a.saveAndEditATranslatedCopy()},i}(a.a);Object(i.a)(l,"SaveAndEditDialog",a.a,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"SaveAndEditATranslatedCopyRequest",(function(){return h}));var i=n(0),r=n(288),a=n(1),o=n(13),s=n(105),l=n(14),c=n(111),u=n(37),d=n(36);function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(e){var t,n,i,h,m;function g(){var t;t=e.call(this)||this;for(var n=c.a.translationLanguages.getLanguages(),i="",s=0;s<n.length;s++)if(n[s].name===l.App.instance.translationLanguage){i=n[s].displayName;break}return t._downloadUri=l.App.webServiceBase+"docdatahandler.ashx?"+l.App.instance.theDocument.baseDocQuerySignature+"&language="+o.a.urlKeyValueEncode(l.App.instance.translationLanguage)+"&languagename="+o.a.urlKeyValueEncode(i)+"&type=docx&o15=1&SaveAndEdit=1",a.AFrameworkApplication.theWsaClient.incrementDw(r.DownloadATranslatedCopyRequest.DATAID_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS,1),t}return n=e,(t=g).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,g.prototype.onSuccess=function(e){var t=e.responseXml.selectSingleNode("/docdata/editUrl");if(t){if(s.c(a.AFrameworkApplication.appSettingsManager))s.e(t.text);else window.self.location.href=t.text}else{d.a.propagateError(!1,"SaveAndEditATranslatedDocumentFailed",u.a.itemNotGenerated,"Unexpected null edit url in response!")}},i=g,(h=[{key:"waitMessage",get:function(){return WordViewerIntl.WordViewerStrings.l_SaveAndEditTranslatedDocument}}])&&p(i.prototype,h),m&&p(i,m),g}(r.DownloadATranslatedCopyRequest);Object(i.a)(h,"SaveAndEditATranslatedCopyRequest",r.DownloadATranslatedCopyRequest,[])},function(e,t,n){"use strict";n.r(t),n.d(t,"getExecuteState",(function(){return s})),n.d(t,"executeAction",(function(){return l})),n.d(t,"executeActionWithData",(function(){return c})),n.d(t,"getPageHeightAtZoom",(function(){return u})),n.d(t,"getPageWidthAtZoom",(function(){return d})),n.d(t,"perfMetricsStart",(function(){return p})),n.d(t,"perfMetricsStop",(function(){return h}));var i=n(1),r=n(69),a=n(155),o=n(91),s=function(){a.a.getExecuteState()},l=function(e){return a.a.verifyExecuteState()?i.AFrameworkApplication.theActionManager.processAction(a.a.calcActionId(e),2):16},c=function(e,t){if(!a.a.verifyExecuteState())return 16;var n=a.a.calcActionId(e);return i.AFrameworkApplication.theActionManager.processActionWithData(n,2,t)},u=function(e,t){return a.a.verifyExecuteState()?o.a.instance.getPageHeightAtZoom(e,t):-1},d=function(e,t){return a.a.verifyExecuteState()?o.a.instance.getPageWidthAtZoom(e,t):-1},p=function(){a.a.ignoreExecuteState(),r.a.start()},h=function(){a.a.ignoreExecuteState(),r.a.stop()}},function(e,t){window.setTimeout((function(){try{1===Common.AFrameworkApplication.appSettingsManager.getIntAppSetting("Environment")&&(console.log("%c\ud83d\udc4cPowered By Dullscript!\ud83d\udc4c","font-size: 40px; color: green"),console.log("\nDullscript is a project to convert office online's Script# codebases to Typescript.\nThis session is running on build created from the transpiled source code. If you would\nlike to learn more, or provide feedback, please reach out in our Teams channel: https://aka.ms/dullscriptfeedback\n"))}catch(e){}}),0)},function(e,t,n){"use strict";n.r(t);var i=function(){window.IEnumerable=1,window.IEnumerator=2,"undefined"==typeof Sys&&Type.registerNamespace("Sys")},r=n(2),a=function(e,t){if(null!=t&&!Object(r.c)(e,t))throw Error.create(Sys.Res.argumentType);return t},o=n(109),s=n(0),l=n(142),c=n(89),u=function(){function e(){this._scheduler=c.a.get_default()}var t=e.prototype;return t.S=function(e){var t=o.Task.Create(e);return t.Start$Scheduler(this._scheduler),t},t.SC=function(e,t){var n=o.Task.Create(e);return t.get_isCancellationRequested()?n.setCanceled():n.Start$Scheduler(this._scheduler),n},t.SO=function(e,t){var n=o.Task.Create$object(e,t);return n.Start$Scheduler(this._scheduler),n},t.SOC=function(e,t,n){var i=o.Task.Create$object(e,t);return n.get_isCancellationRequested()?i.setCanceled():i.Start$Scheduler(this._scheduler),i},t.SR=function(e){var t=l.a.C(e);return t.Start$Scheduler(this._scheduler),t},t.SRC=function(e,t){var n=l.a.C(e);return t.get_isCancellationRequested()?n.setCanceled():n.Start$Scheduler(this._scheduler),n},t.SRO=function(e,t){var n=l.a.CO(e,t);return n.Start$Scheduler(this._scheduler),n},t.SROC=function(e,t,n){var i=l.a.CO(e,t);return n.get_isCancellationRequested()?i.setCanceled():i.Start$Scheduler(this._scheduler),i},e}();function d(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(u,"TaskFactory",null,[]);var p=function(e){function t(){return e.call(this)||this}return d(t,e),t.prototype.queueTask=function(e){var t=this;window.setTimeout((function(){t.tryExecuteTask(e)}),0)},t}(c.a);Object(s.a)(p,"DefaultTaskScheduler",c.a,[]);var h=function(){Type.registerNamespace("$$sc"),window.$$ct=a,window.$$as=function(e,t){return e.isInstanceOfType(t)?t:null},o.Task._factory=new u,c.a._default=new p,c.a._current=c.a._default},m=function(){Type.registerNamespace("Common.UnitTestFramework")},g=function(){Type.registerNamespace("Common.Collections"),Type.registerNamespace("System.Collections.Generic")},f=function(){Type.registerNamespace("Common"),Type.registerNamespace("Common.Utils"),Type.registerNamespace("System"),window.isUndefined=function(e){return void 0===e},window.isNull=function(e){return null===e},window.isNullOrUndefined=function(e){return null==e}},v=n(281),_=n(317),y=n(318),b=function(){Type.registerNamespace("Common"),window.Common.AsynchronousXMLHttpExecutor=v.a,window.Common.SynchronousXMLHttpExecutor=_.a,window.Common.FetchKeepAliveExecutor=y.a},S=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./lib/core/index.js")}({"./lib/core/api.js":
/*!*************************!*\
  !*** ./lib/core/api.js ***!
  \*************************/
/*! exports provided: logUserAction, logActivity, ScorecardAggregateMethod, logActivityForExperiment, sendTelemetryEvent, sendActivityEvent, sendOtelEvent, sendUserActionEvent, addNamespaceMapping, setEnabledState, shutdown, registerEventHandler */
/*! exports used: ScorecardAggregateMethod, addNamespaceMapping, logActivity, logActivityForExperiment, logUserAction, registerEventHandler, sendActivityEvent, sendOtelEvent, sendTelemetryEvent, sendUserActionEvent, setEnabledState, shutdown */
function(e,t,n){n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return v})),n.d(t,"f",(function(){return _}));var i,r,a=!1,o=[],s=0;function l(e,t,n,i,r,a,o){m({name:null,actionName:e,commandSurface:r,parentName:n,triggerMethod:i,durationMs:a,succeeded:t,dataFields:o})}function c(e,t,n,i){void 0===t&&(t=!0),void 0===n&&(n=0),void 0===i&&(i=[]),p({name:e,succeeded:t,durationMs:n,dataFields:i})}function u(e,t,n,i,a,o){void 0===n&&(n=r.Count),void 0===i&&(i=!0),void 0===a&&(a=0),void 0===o&&(o=[]),null!==e&&""!==e&&(n!==r.Count&&null===t||(o.push({name:"WAC_Experiment",string:n.toString()}),o.push({name:"WAC_Experiment_Value",double:t}),o.push({name:"WAC_Experiment_EventName",string:"WAC_Exp_"+e+"_"+n.toString()}),p({name:e,succeeded:i,durationMs:a,dataFields:o})))}function d(e){y({kind:"event",event:e,timestamp:(new Date).getTime()})}function p(e){y({kind:"activity",event:e,timestamp:(new Date).getTime()})}function h(e){y({kind:"otel",event:e})}function m(e){y({kind:"action",event:e,timestamp:(new Date).getTime()})}function g(e,t){y({kind:"addNamespaceMapping",namespace:e,ariaTenantToken:t})}function f(e){(a=e)||(o=[])}function v(){return y({kind:"shutdown"}),o.length+s}function _(e){i=e,o.forEach((function(e){return y(e)})),o=[]}function y(e){a&&(i?i(e):o.length<=2e4?o.push(e):s+=1)}!function(e){e[e.Count=0]="Count",e[e.Avg=1]="Avg",e[e.Sum=2]="Sum"}(r||(r={}))},"./lib/core/generated/otel.gen.js":
/*!****************************************!*\
  !*** ./lib/core/generated/otel.gen.js ***!
  \****************************************/
/*! exports provided: TelemetryFactoryGlobal */
/*! exports used: TelemetryFactoryGlobal */
function(e,t,n){n.d(t,"a",(function(){return i}));var i=new(n(
/*! ../telemetryFactory */
"./lib/core/telemetryFactory.js").a)},"./lib/core/index.js":
/*!***************************!*\
  !*** ./lib/core/index.js ***!
  \***************************/
/*! exports provided: TelemetryFactoryGlobal, logUserAction, logActivity, ScorecardAggregateMethod, logActivityForExperiment, sendTelemetryEvent, sendActivityEvent, sendOtelEvent, sendUserActionEvent, addNamespaceMapping, setEnabledState, shutdown, registerEventHandler */
/*! all exports used */
function(e,t,n){n.r(t);var i=n(
/*! ./generated/otel.gen */
"./lib/core/generated/otel.gen.js");n.d(t,"TelemetryFactoryGlobal",(function(){return i.a}));var r=n(
/*! ./api */
"./lib/core/api.js");n.d(t,"logUserAction",(function(){return r.e})),n.d(t,"logActivity",(function(){return r.c})),n.d(t,"ScorecardAggregateMethod",(function(){return r.a})),n.d(t,"logActivityForExperiment",(function(){return r.d})),n.d(t,"sendTelemetryEvent",(function(){return r.i})),n.d(t,"sendActivityEvent",(function(){return r.g})),n.d(t,"sendOtelEvent",(function(){return r.h})),n.d(t,"sendUserActionEvent",(function(){return r.j})),n.d(t,"addNamespaceMapping",(function(){return r.b})),n.d(t,"setEnabledState",(function(){return r.k})),n.d(t,"shutdown",(function(){return r.l})),n.d(t,"registerEventHandler",(function(){return r.f}))},"./lib/core/telemetryFactory.js":
/*!**************************************!*\
  !*** ./lib/core/telemetryFactory.js ***!
  \**************************************/
/*! exports provided: TelemetryFactory */
/*! exports used: TelemetryFactory */
function(e,t,n){n.d(t,"a",(function(){return r}));var i=n(
/*! ./telemetryLogger */
"./lib/core/telemetryLogger.js"),r=function(){function e(){}return e.prototype.createInstance=function(){return new i.a},e}()},"./lib/core/telemetryLogger.js":
/*!*************************************!*\
  !*** ./lib/core/telemetryLogger.js ***!
  \*************************************/
/*! exports provided: TelemetryLogger */
/*! exports used: TelemetryLogger */
function(e,t,n){n.d(t,"a",(function(){return r}));var i=n(
/*! ./api */
"./lib/core/api.js"),r=function(){function e(){}return e.prototype.sendTelemetryEvent=function(e){e&&Object(i.i)(e)},e.prototype.sendActivityEvent=function(e){e&&Object(i.g)(e)},e.prototype.sendUserActionEvent=function(e){e&&Object(i.j)(e)},e.prototype.addNamespaceMapping=function(e,t){e&&t&&Object(i.b)(e,t)},e.prototype.sendOtelEvent=function(e){e&&Object(i.h)(e)},e.prototype.setEnabledState=function(e){Object(i.k)(e)},e.prototype.registerEventHandler=function(e){e&&Object(i.f)(e)},e.prototype.shutdown=function(){return Object(i.l)()},e}()}}),C=function(){Type.registerNamespace("Otel");var e=S;window.otel=e},A=function(){Type.registerNamespace("Common")},I=function(){Type.registerNamespace("Diag")},w=function(){Type.registerNamespace("DiagUse")},T=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./lib/index.js")}({"./lib/generated/health.gen.js":
/*!*************************************!*\
  !*** ./lib/generated/health.gen.js ***!
  \*************************************/
/*! exports provided: KpiType, HealthLoggingLevel, HealthFactoryGlobal */
/*! exports used: HealthFactoryGlobal, HealthLoggingLevel, KpiType */
function(e,t,n){n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var i,r,a=n(
/*! ../healthFactory */
"./lib/healthFactory.js");!function(e){e[e.FailureBased=0]="FailureBased",e[e.SuccessBased=1]="SuccessBased"}(i||(i={})),function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(r||(r={}));var o=new a.a},"./lib/health.js":
/*!***********************!*\
  !*** ./lib/health.js ***!
  \***********************/
/*! exports provided: Health */
/*! exports used: Health */
function(e,t,n){n.d(t,"a",(function(){return a}));var i=n(
/*! ./generated/health.gen */
"./lib/generated/health.gen.js"),r=n(
/*! ./healthInternal */
"./lib/healthInternal.js"),a=function(){function e(e){var t;this._isHealthEnabled=!1,this._health=null,this._partCDimensionsUpdatedObservers=[];try{this._isHealthEnabled=e.getIsHealthEnabled(),this._isHealthEnabled&&(this._health=new r.a(e))}catch(r){var n=null===(t=e)||void 0===t?void 0:t.getExternalLogger();n&&n(51144384,i.b.Warning,"Failed to initialize the health telemetry system: "+r),this._health=null,this._isHealthEnabled=!1}this._health&&this._isHealthEnabled&&(this._health.Heartbeat&&this.registerPartCDimensionsUpdatedObserver(this._health.Heartbeat.partCDimensionsUpdated.bind(this._health.Heartbeat)),this._health.Qos&&this.registerPartCDimensionsUpdatedObserver(this._health.Qos.partCDimensionsUpdated.bind(this._health.Qos)),this._health.Kpi&&this.registerPartCDimensionsUpdatedObserver(this._health.Kpi.partCDimensionsUpdated.bind(this._health.Kpi)),this._health.Logger&&this.registerPartCDimensionsUpdatedObserver(this._health.Logger.partCDimensionsUpdated.bind(this._health.Logger)))}return e.prototype.healthTimersStopSignalEncountered=function(){this._isHealthEnabled&&this._health&&this._health.stopAllHealthTimers()},e.prototype.stopAllHealthTimers=function(){this._isHealthEnabled&&this._health&&this._health.stopAllHealthTimers()},e.prototype.resumeAllHealthTimers=function(){this._isHealthEnabled&&this._health&&this._health.resumeAllHealthTimers()},e.prototype.getQosRecorder=function(){return this._isHealthEnabled&&this._health?this._health.Qos:null},e.prototype.getKpiRecorder=function(){return this._isHealthEnabled&&this._health?this._health.Kpi:null},e.prototype.recordBsqmQosError=function(e,t,n){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.recordBsqmError(e,t,n)},e.prototype.recordQosError=function(e,t,n,i,r,a,o){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.recordError(e,t,n,i,r,a,o)},e.prototype.addQosPillar=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.addPillar(e)},e.prototype.removeQosPillar=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.removePillar(e)},e.prototype.recordKpiImpliedSuccess=function(e,t,n){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordImpliedSuccess(e,t,n)},e.prototype.recordKpiImpliedFailure=function(e,t,n,i,r,a){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordImpliedFailure(e,t,n,i,r,a)},e.prototype.recordKpiFailure=function(e,t,n,i,r){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordFailure(e,t,n,i,r)},e.prototype.recordKpiFailureMultiple=function(e,t,n,i,r){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordFailureMultiple(e,t,n,i,r)},e.prototype.recordKpiSuccess=function(e,t){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordSuccess(e,t)},e.prototype.recordKpiSuccessMultiple=function(e,t){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordSuccessMultiple(e,t)},e.prototype.recordKpiUsage=function(e,t,n,i){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsage(e,t,n,i)},e.prototype.recordKpiUsageForAlertableKpi=function(e,t,n){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsageForAlertableKpi(e,t,n)},e.prototype.recordKpiUsageMultiple=function(e,t,n,i){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsageMultiple(e,t,n,i)},e.prototype.setQosHandlerForWarmPipeline=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.setHandlerForWarmPipeline(e)},e.prototype.setKpiHandlerForWarmPipeline=function(e){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.setHandlerForWarmPipeline(e)},e.prototype.setQosHandlerForOtelLibraryLoader=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.setHandlerForOtelLibraryLoader(e)},e.prototype.setHandlerForIsOtelJsReady=function(e){var t,n,i,r;this._isHealthEnabled&&this._health&&(null===(n=null===(t=this._health)||void 0===t?void 0:t.Qos)||void 0===n||n.setHandlerForIsOtelJsReady(e),null===(r=null===(i=this._health)||void 0===i?void 0:i.Kpi)||void 0===r||r.setHandlerForIsOtelJsReady(e))},e.prototype.setHandlerForIsAppShuttingDown=function(e){var t,n,i,r,a,o;this._isHealthEnabled&&e&&(null===(n=null===(t=this._health)||void 0===t?void 0:t.Kpi)||void 0===n||n.setHandlerForIsAppShuttingDown(e),null===(r=null===(i=this._health)||void 0===i?void 0:i.Qos)||void 0===r||r.setHandlerForIsAppShuttingDown(e),null===(o=null===(a=this._health)||void 0===a?void 0:a.Logger)||void 0===o||o.setHandlerForIsAppShuttingDown(e))},e.prototype.getRemoteTelemetryStats=function(){var e;return null===(e=this._health)||void 0===e?void 0:e.getRemoteTelemetryStats()},e.prototype.shutdown=function(){var e,t,n,r;this._isHealthEnabled&&(null===(e=this._health)||void 0===e||e.ExternalLogger(589850511,i.b.Info,JSON.stringify(this._health.SessionStats)),null===(n=null===(t=this._health)||void 0===t?void 0:t.Logger)||void 0===n||n.shutdown(),null===(r=this._offlineWorker)||void 0===r||r.terminate())},e.prototype.setIsAppOnline=function(e){var t,n;null===(n=null===(t=this._health)||void 0===t?void 0:t.Logger)||void 0===n||n.setIsAppOnline(e)},e.prototype.startOfflineWorker=function(e,t){var n,r,a,o,s,l,c=this;if(this._isHealthEnabled&&e&&t)try{if("undefined"==typeof Worker)return void(null===(n=this._health)||void 0===n||n.ExternalLogger(578074690,i.b.Warning,"Worker API is not available"));if(!t)return void(null===(r=this._health)||void 0===r||r.ExternalLogger(578074644,i.b.Warning,"Invalid worker URL"));null===(a=this._health)||void 0===a||a.ExternalLogger(578074645,i.b.Info,"Installing offline worker"),this.recordKpiUsage("OfflineWorker",i.c.SuccessBased);var u=new Blob(["try{importScripts('"+encodeURI(t)+"');}catch(e){self.postMessage({tagId:577642522,level:2,message:'Failed to load worker script: '+e})}"],{type:"application/javascript"});this._offlineWorker=new Worker(URL.createObjectURL(u)),null===(s=null===(o=this._health)||void 0===o?void 0:o.Logger)||void 0===s||s.setOfflineWorker(this._offlineWorker),this._offlineWorker.onmessage=function(e){var t,n;try{var r=e.data;switch(null===(t=c._health)||void 0===t||t.ExternalLogger(r.tagId,r.level,r.message),r.tagId){case 578074650:c.recordKpiSuccess("OfflineWorker");break;case 577642522:c.recordKpiFailure("OfflineWorker","FailedToLoadScript",!1,!0);break;case 578074648:c.recordKpiFailure("OfflineWorker","IndexedDbNotAvailable",!1,!0);break;case 578074649:c.recordKpiFailure("OfflineWorker","GetAllKeysNotAvailable",!1,!0)}}catch(e){null===(n=c._health)||void 0===n||n.ExternalLogger(578074646,i.b.Warning,"Failed to process message from the offline worker: "+e)}},this._offlineWorker.postMessage({type:"init",value:e}),this._offlineWorker.postMessage({type:"flush"})}catch(e){null===(l=this._health)||void 0===l||l.ExternalLogger(578074647,i.b.Warning,"Failed to install the offline worker: "+e)}},e.prototype.addOrUpdatePartCDimension=function(e,t){var n=this;this._health&&(this._health.addOrUpdateDimension(e,t)&&this._partCDimensionsUpdatedObservers.forEach((function(e){var t;return e(null===(t=n._health)||void 0===t?void 0:t.getAdditionalPartCDimensions())})))},e.prototype.addOrUpdatePartCDimensions=function(e){var t=this;this._health&&(this._health.addOrUpdateDimensions(e)&&this._partCDimensionsUpdatedObservers.forEach((function(e){var n;return e(null===(n=t._health)||void 0===n?void 0:n.getAdditionalPartCDimensions())})))},e.prototype.registerPartCDimensionsUpdatedObserver=function(e){e&&this._partCDimensionsUpdatedObservers.push(e)},e.prototype.removePartCDimensionsUpdatedObserver=function(e){e&&(this._partCDimensionsUpdatedObservers=this._partCDimensionsUpdatedObservers.filter((function(t){return t!==e})))},e}()},"./lib/healthConfig.js":
/*!*****************************!*\
  !*** ./lib/healthConfig.js ***!
  \*****************************/
/*! exports provided: HealthConfig */
/*! exports used: HealthConfig */
function(e,t,n){n.d(t,"a",(function(){return i}));var i=function(){function e(){this._remoteTelemetryUrl="",this._isHealthEnabled=!1,this._isQosEnabled=!1,this._isKpiEnabled=!1,this._shouldUseNewLogger=!1,this._shouldUseOtelCsForAllEvents=!1,this._shouldUseXhr=!1,this._heartbeatIntervalMs=0,this._recordPillarToWarmIntervalMs=0,this._loggerMaxQueueSize=25,this._loggerMaxIntervalMs=3e4,this._dimensions=void 0,this._qosVetoClassifier=function(){},this._externalLogger=function(){}}return e.prototype.getRemoteTelemetryUrl=function(){return this._remoteTelemetryUrl},e.prototype.getIsHealthEnabled=function(){return this._isHealthEnabled},e.prototype.getIsQosEnabled=function(){return this._isQosEnabled},e.prototype.getIsKpiEnabled=function(){return this._isKpiEnabled},e.prototype.getShouldUseNewLogger=function(){return this._shouldUseNewLogger},e.prototype.getShouldUseOtelCsForAllEvents=function(){return this._shouldUseOtelCsForAllEvents},e.prototype.getShouldUseXhr=function(){return this._shouldUseXhr},e.prototype.getHeartbeatIntervalMs=function(){return this._heartbeatIntervalMs},e.prototype.getRecordPillarToWarmPipelineIntervalMs=function(){return this._recordPillarToWarmIntervalMs},e.prototype.getLoggerMaxQueueSize=function(){return this._loggerMaxQueueSize},e.prototype.getLoggerMaxIntervalMs=function(){return this._loggerMaxIntervalMs},e.prototype.getQosVetoClassifier=function(){return this._qosVetoClassifier},e.prototype.getExternalLogger=function(){return this._externalLogger},e.prototype.getDimensions=function(){return this._dimensions},e.prototype.setRemoteTelemetryUrl=function(e){this._remoteTelemetryUrl=e},e.prototype.setIsHealthEnabled=function(e){this._isHealthEnabled=e},e.prototype.setIsQosEnabled=function(e){this._isQosEnabled=e},e.prototype.setIsKpiEnabled=function(e){this._isKpiEnabled=e},e.prototype.setShouldUseNewLogger=function(e){this._shouldUseNewLogger=e},e.prototype.setShouldUseOtelCsForAllEvents=function(e){this._shouldUseOtelCsForAllEvents=e},e.prototype.setShouldUseXhr=function(e){this._shouldUseXhr=e},e.prototype.setHeartbeatIntervalMs=function(e){this._heartbeatIntervalMs=e},e.prototype.setLoggerMaxQueueSize=function(e){this._loggerMaxQueueSize=e},e.prototype.setLoggerMaxIntervalMs=function(e){this._loggerMaxIntervalMs=e},e.prototype.setRecordPillarToWarmPipelineIntervalMs=function(e){this._recordPillarToWarmIntervalMs=e},e.prototype.setQosVetoClassifier=function(e){this._qosVetoClassifier=e},e.prototype.setExternalLogger=function(e){this._externalLogger=null!=e?e:function(){}},e.prototype.setDimensions=function(e){this._dimensions=e},e}()},"./lib/healthFactory.js":
/*!******************************!*\
  !*** ./lib/healthFactory.js ***!
  \******************************/
/*! exports provided: HealthFactory */
/*! exports used: HealthFactory */
function(e,t,n){n.d(t,"a",(function(){return o}));var i=n(
/*! ./healthConfig */
"./lib/healthConfig.js"),r=n(
/*! ./qosVeto */
"./lib/qosVeto.js"),a=n(
/*! ./health */
"./lib/health.js"),o=function(){function e(){this._health=null}return e.prototype.createHealthInstance=function(e){return null==this._health&&(this._health=new a.a(e)),this._health},e.prototype.createHealthConfigInstance=function(){return new i.a},e.prototype.createQosVetoInstance=function(){return new r.a},e}()},"./lib/healthHeartbeat.js":
/*!********************************!*\
  !*** ./lib/healthHeartbeat.js ***!
  \********************************/
/*! exports provided: HealthHeartbeat */
/*! exports used: HealthHeartbeat */
function(e,t,n){n.d(t,"a",(function(){return a}));var i=n(
/*! ./utils */
"./lib/utils.js"),r=n(
/*! ./stats */
"./lib/stats.js"),a=function(){function e(e){var t=this;this.xhrFactory=e,this.isQosEnabled=!1,this.isKpiEnabled=!1,this.shouldUseNewLogger=!1,this.heartbeatOrderingNumber=0,this.heartbeatSendTimerId=0,this.heartbeatIntervalMs=3e5,this.remoteTelemetryUrl="",this.initialStartCalled=!1,this.running=!1,this._dimensions={},this._additionalPartCDimensions=new Map,this._saveRequestStatus=function(e){},this._stats=new r.a,this.getHeartbeatRequestJson=function(){var e={};e.heartbeatIntervalMs=t.heartbeatIntervalMs,e.heartbeatOrderingNumber=t.heartbeatOrderingNumber,e.heartbeatQosPillars=t.isQosEnabled&&t._qosPillars?i.b.convertStringSetToArray(t._qosPillars):[],e.heartbeatKpiNames=t.isKpiEnabled&&t._alertableKpiNames?i.b.convertStringSetToArray(t._alertableKpiNames):[],e.heartbeatDimensions=t._dimensions,e.additionalPartCDimensions=i.b.convertStringMapToObject(t._additionalPartCDimensions);var n={type:"health_heartbeat"};return n.payloadJson=JSON.stringify(e),JSON.stringify(n)},this._qosPillars=new Set,this._alertableKpiNames=new Set}return e.prototype.start=function(e){var t,n,i;e&&(e.isQosEnabled||e.isKpiEnabled)&&!this.initialStartCalled&&e.remoteTelemetryUrl&&(this.isQosEnabled=e.isQosEnabled,this.isKpiEnabled=e.isKpiEnabled,this.shouldUseNewLogger=e.shouldUseNewLogger,this.remoteTelemetryUrl=e.remoteTelemetryUrl,this.heartbeatIntervalMs=e.heartbeatIntervalMs&&e.heartbeatIntervalMs>0?e.heartbeatIntervalMs:3e5,this._dimensions=null!=(t=e.dimensions)?t:{},this._saveRequestStatus=null!=(n=e.saveHeartbeatRequestStatus)?n:function(e){},this._logger=e.remoteTelemetryLogger,this._stats=null!=(i=e.stats)?i:new r.a,this.initialStartCalled=!0,this.running=!0,this.sendHeartbeatAndReQueue())},e.prototype.stop=function(){this.running=!1,this.heartbeatOrderingNumber=0,this.clearHeartbeatSendTimer()},e.prototype.resume=function(){this.initialStartCalled&&!this.running&&this.sendHeartbeatAndReQueue()},e.prototype.qosPillarAdded=function(e){e&&!this._qosPillars.has(e)&&(this._qosPillars.add(e),this.heartbeatOrderingNumber=0,this.sendHeartbeat())},e.prototype.qosPillarRemoved=function(e){e&&this._qosPillars.has(e)&&(this._qosPillars.delete(e),this.heartbeatOrderingNumber=0,this.sendHeartbeat())},e.prototype.kpiAdded=function(e){e&&!this._alertableKpiNames.has(e)&&(this._alertableKpiNames.add(e),this.sendHeartbeat())},e.prototype.sessionEndingErrorEncountered=function(){this.stop()},e.prototype.partCDimensionsUpdated=function(e){e&&(this._additionalPartCDimensions=e,this.sendHeartbeat())},e.prototype.queueHeartbeat=function(){var e=this;this.heartbeatSendTimerId=window.setTimeout((function(){e.sendHeartbeatAndReQueue()}),this.heartbeatIntervalMs)},e.prototype.sendHeartbeat=function(){var e,t,n,i,r,a,o,s=this;this._stats.heartbeats.totalProcessed+=1;var l=null!=(t=null===(e=performance)||void 0===e?void 0:e.now())?t:0;if(this.shouldUseNewLogger)return null===(n=this._logger)||void 0===n||n.addHeartbeat(this._qosPillars,this._alertableKpiNames,this.heartbeatIntervalMs,this.heartbeatOrderingNumber),this.heartbeatOrderingNumber=(this.heartbeatOrderingNumber+1)%1e3,void(this._stats.heartbeats.totalProcessingTime+=(r=null===(i=performance)||void 0===i?void 0:i.now(),(null!=r?r:0)-l));var c=this.getHeartbeatRequestJson();try{var u=this.xhrFactory();u.open("POST",this.remoteTelemetryUrl,!0),u.send(c),u.onreadystatechange=function(){u.readyState===XMLHttpRequest.DONE&&(200===u.status&&(s.heartbeatOrderingNumber=(s.heartbeatOrderingNumber+1)%1e3),s._saveRequestStatus(u.status))},this._stats.heartbeats.totalProcessingTime+=(null!=(o=null===(a=performance)||void 0===a?void 0:a.now())?o:0)-l}catch(e){}},e.prototype.sendHeartbeatAndReQueue=function(){this.sendHeartbeat(),this.queueHeartbeat()},e.prototype.clearHeartbeatSendTimer=function(){0!==this.heartbeatSendTimerId&&(window.clearTimeout(this.heartbeatSendTimerId),this.heartbeatSendTimerId=0)},e}()},"./lib/healthInternal.js":
/*!*******************************!*\
  !*** ./lib/healthInternal.js ***!
  \*******************************/
/*! exports provided: HealthInternal */
/*! exports used: HealthInternal */
function(e,t,n){n.d(t,"a",(function(){return l}));var i=n(
/*! ./healthHeartbeat */
"./lib/healthHeartbeat.js"),r=n(
/*! ./qosRecorder */
"./lib/qosRecorder.js"),a=n(
/*! ./kpiRecorder */
"./lib/kpiRecorder.js"),o=n(
/*! ./remoteTelemetryLogger */
"./lib/remoteTelemetryLogger.js"),s=n(
/*! ./stats */
"./lib/stats.js"),l=function(){function e(e){var t,n,l,c,u=this;if(this._requestStats=new Map,this._dimensions={},this._additionalPartCDimensions=new Map,this.SessionStats=new s.a,this.ExternalLogger=function(){},this.Heartbeat=new i.a((function(){return new XMLHttpRequest})),e){if(this._dimensions=null!=(n=null===(t=e)||void 0===t?void 0:t.getDimensions())?n:{},this.ExternalLogger=null!=(c=null===(l=e)||void 0===l?void 0:l.getExternalLogger())?c:function(){},this.Logger=new o.a({remoteTelemetryUrl:e.getRemoteTelemetryUrl(),dimensions:this._dimensions,requestStatusLogger:function(e){return u.saveRequestStatus(e)}.bind(this),externalLogger:this.ExternalLogger,shouldUseXhr:e.getShouldUseXhr(),maxQueueSize:e.getLoggerMaxQueueSize(),maxTimeBetweenBatchesMs:e.getLoggerMaxIntervalMs()}),e.getIsQosEnabled()){var d={isEnabled:e.getIsQosEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),vetoClassifier:e.getQosVetoClassifier(),recordPillarToWarmIntervalMs:e.getRecordPillarToWarmPipelineIntervalMs(),dimensions:this._dimensions,saveQosRequestStatus:function(e){return u.saveRequestStatus(e)}.bind(this),shouldUseNewLogger:e.getShouldUseNewLogger(),shouldUseOtelCsForAllEvents:e.getShouldUseOtelCsForAllEvents(),shouldUseXhr:e.getShouldUseXhr(),remoteTelemetryLogger:this.Logger,stats:this.SessionStats,externalLogger:this.ExternalLogger};this.Qos=new r.a(d),this.Qos.registerAddPillarObserver(this.Heartbeat.qosPillarAdded.bind(this.Heartbeat)),this.Qos.registerRemovePillarObserver(this.Heartbeat.qosPillarRemoved.bind(this.Heartbeat)),this.Qos.registerSessionEndingErrorObserver(this.Heartbeat.sessionEndingErrorEncountered.bind(this.Heartbeat)),this.Qos.registerSessionEndingErrorObserver(this.healthTimersStopSignalEncountered.bind(this))}if(e.getIsKpiEnabled()){var p={isEnabled:e.getIsKpiEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),dimensions:this._dimensions,saveKpiRequestStatus:function(e){return u.saveRequestStatus(e)}.bind(this),shouldUseNewLogger:e.getShouldUseNewLogger(),shouldUseOtelCsForAllEvents:e.getShouldUseOtelCsForAllEvents(),shouldUseXhr:e.getShouldUseXhr(),remoteTelemetryLogger:this.Logger,stats:this.SessionStats,externalLogger:this.ExternalLogger};this.Kpi=new a.a(p),this.Kpi.registerAlertableKpiObserver(this.Heartbeat.kpiAdded.bind(this.Heartbeat))}if(e.getIsQosEnabled()||e.getIsKpiEnabled()){var h={isQosEnabled:e.getIsQosEnabled(),isKpiEnabled:e.getIsKpiEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),heartbeatIntervalMs:e.getHeartbeatIntervalMs(),dimensions:this._dimensions,saveHeartbeatRequestStatus:function(e){return u.saveRequestStatus(e)}.bind(this),shouldUseNewLogger:e.getShouldUseNewLogger(),remoteTelemetryLogger:this.Logger,stats:this.SessionStats};this.Heartbeat.start(h)}}}return e.prototype.healthTimersStopSignalEncountered=function(){this.stopAllHealthTimers()},e.prototype.stopAllHealthTimers=function(){this.Heartbeat&&this.Heartbeat.stop(),this.Qos&&this.Qos.stopRecordPillarToWarmPipelineTimer()},e.prototype.resumeAllHealthTimers=function(){this.Heartbeat&&this.Heartbeat.resume(),this.Qos&&this.Qos.resumeRecordPillarToWarmPipelineTimer()},e.prototype.getRemoteTelemetryStats=function(){return this._requestStats},e.prototype.getAdditionalPartCDimensions=function(){return this._additionalPartCDimensions},e.prototype.addOrUpdateDimension=function(e,t){return this.addOrUpdateDimensionInternal(e,t)},e.prototype.addOrUpdateDimensions=function(e){var t=this,n=!1;return e&&e.forEach((function(e,i){i&&e&&t.addOrUpdateDimensionInternal(i,e)&&(n=!0)})),n},e.prototype.addOrUpdateDimensionInternal=function(e,t){if(e&&t){if(this._dimensions.hasOwnProperty(e))return!1;if(this._additionalPartCDimensions.get(e)!==t)return this._additionalPartCDimensions.set(e,t),!0}return!1},e.prototype.saveRequestStatus=function(e){var t=this._requestStats.get(e)||0;this._requestStats.set(e,t+1)},e}()},"./lib/index.js":
/*!**********************!*\
  !*** ./lib/index.js ***!
  \**********************/
/*! exports provided: KpiType, HealthLoggingLevel, HealthFactoryGlobal, Utils, HealthDataField, HealthFactory */
/*! all exports used */
function(e,t,n){n.r(t);var i=n(
/*! ./generated/health.gen */
"./lib/generated/health.gen.js");n.d(t,"KpiType",(function(){return i.c})),n.d(t,"HealthLoggingLevel",(function(){return i.b})),n.d(t,"HealthFactoryGlobal",(function(){return i.a}));var r=n(
/*! ./utils */
"./lib/utils.js");n.d(t,"Utils",(function(){return r.b})),n.d(t,"HealthDataField",(function(){return r.a}));var a=n(
/*! ./healthFactory */
"./lib/healthFactory.js");n.d(t,"HealthFactory",(function(){return a.a}))},"./lib/kpiRecorder.js":
/*!****************************!*\
  !*** ./lib/kpiRecorder.js ***!
  \****************************/
/*! exports provided: KpiRecorder */
/*! exports used: KpiRecorder */
function(e,t,n){n.d(t,"a",(function(){return o}));var i=n(
/*! ./generated/health.gen */
"./lib/generated/health.gen.js"),r=n(
/*! ./utils */
"./lib/utils.js"),a=n(
/*! ./stats */
"./lib/stats.js"),o=function(){function e(e){var t,n,i,o,s,l,c,u=this;this._isEnabled=!1,this._dimensions={},this._additionalPartCDimensions=new Map,this._kpis=new Map,this._application="",this._recordToWarmPipeline=null,this._isOtelJsReady=function(){return!1},this._saveRequestStatus=function(e){},this._isAppShuttingDown=function(){return!1},this._stats=new a.a,this._shouldUseNewLogger=!1,this._shouldUseOtelCsForAllEvents=!1,this._shouldUseXhr=!1,this._externalLogger=function(){},this.formatAlertableKpiFailurePayload=function(e,t){var n={};n.sessionDimensions=u._dimensions,n.additionalPartCDimensions=r.b.convertStringMapToObject(u._additionalPartCDimensions);var i=new Set;e&&i.add(e),n.failedKpis=r.b.convertStringSetToArray(i),t&&t.durationMs&&(n.durationMs=t.durationMs);var a={type:"kpi_failure"};return a.payloadJson=JSON.stringify(n),JSON.stringify(a)},this.formatAlertableKpiSuccessDurationPayload=function(e,t){var n={};n.sessionDimensions=u._dimensions,n.additionalPartCDimensions=r.b.convertStringMapToObject(u._additionalPartCDimensions),n.succeededKpi=e,n.durationMs=t.durationMs;var i={type:"kpi_success_duration"};return i.payloadJson=JSON.stringify(n),JSON.stringify(i)},e&&(e.remoteTelemetryUrl&&(this._remoteTelemetryUrl=e.remoteTelemetryUrl),this._isEnabled=e.isEnabled,this._dimensions=null!=(t=e.dimensions)?t:{},this._saveRequestStatus=null!=(n=e.saveKpiRequestStatus)?n:function(e){},this._shouldUseNewLogger=null!=(i=e.shouldUseNewLogger)&&i,this._shouldUseOtelCsForAllEvents=null!=(o=e.shouldUseOtelCsForAllEvents)&&o,this._shouldUseXhr=null!=(s=e.shouldUseXhr)&&s,this._logger=e.remoteTelemetryLogger,this._stats=null!=(l=e.stats)?l:new a.a,this._externalLogger=null!=(c=e.externalLogger)?c:function(){}),this._alertableKpiObservers=[]}return e.prototype.registerAlertableKpiObserver=function(e){e&&this._alertableKpiObservers.push(e)},e.prototype.removeAlertableKpiObserver=function(e){e&&(this._alertableKpiObservers=this._alertableKpiObservers.filter((function(t){return t!==e})))},e.prototype.setHandlerForIsOtelJsReady=function(e){e&&(this._isOtelJsReady=e)},e.prototype.setHandlerForIsAppShuttingDown=function(e){e&&(this._isAppShuttingDown=e)},e.prototype.recordImpliedSuccess=function(e,t,n){if(this._isEnabled&&e&&this._kpis){this._kpis.has(e)||this.addNewKpi(e,i.c.FailureBased,!1,t);var r=this._kpis.get(e);r&&(r.successCount=r.successCount+1,this._kpis.set(e,r)),this.sendKpiEventToPipeline(r,e,"ImpliedUsageSuccess",n,null)}},e.prototype.recordImpliedFailure=function(e,t,n,r,a,o){var s;if(this._isEnabled&&e&&this._kpis){this._kpis.has(e)||this.addNewKpi(e,i.c.FailureBased,!1,a);var l=this.constructKpiUpdateForFailure(this._kpis.get(e),e,t,n,r);l&&(this._kpis.set(e,l),this.sendKpiEventToPipeline(l,e,"ImpliedUsageFailure",o,null===(s=l.kpiErrors)||void 0===s?void 0:s.get(t)))}},e.prototype.recordFailure=function(e,t,n,i,r){var a,o,s,l,c,u;if(this._isEnabled&&e&&this._kpis&&this._kpis.has(e)){var d=this._kpis.get(e);if(d){if(d.failureCount=d.failureCount+1,t&&d.kpiErrors)if(d.kpiErrors.has(t)){var p=d.kpiErrors.get(e);p&&(p.count=p.count+1,d.kpiErrors.set(t,p))}else{var h={kpiErrorName:t,isIntentional:!0===n,isInternal:!0===i,count:1};d.kpiErrors.set(t,h)}this._kpis.set(e,d);var m=this._isOtelJsReady(),g=null!=(o=null===(a=performance)||void 0===a?void 0:a.now())?o:0;this._shouldUseOtelCsForAllEvents||this._shouldUseNewLogger&&(d.isAlertable||!m)?(null===(s=this._logger)||void 0===s||s.addKpi(d,"Failure",r,this._shouldUseOtelCsForAllEvents||!m,null===(l=d.kpiErrors)||void 0===l?void 0:l.get(t)),m||(this._stats.kpis.totalProcessed+=1,this._stats.kpis.totalProcessingTime+=(null!=(u=null===(c=performance)||void 0===c?void 0:c.now())?u:0)-g)):d.isAlertable&&this.sendKpiFailureToHotPipeline(e,r),this._shouldUseOtelCsForAllEvents||this._shouldUseNewLogger&&!m||this.sendToWarmPipeline(e,"Failure",g,r,t)}}},e.prototype.recordFailureMultiple=function(e,t,n,i,r){var a=this;this._isEnabled&&e&&e.forEach((function(e){e&&a.recordFailure(e,t,n,i,r)}))},e.prototype.recordSuccess=function(e,t){var n,i,r,a,o;if(this._isEnabled&&e&&this._kpis&&this._kpis.has(e)){var s=this._kpis.get(e);if(s){s.successCount=s.successCount+1,this._kpis.set(e,s);var l=this._isOtelJsReady(),c=null!=(i=null===(n=performance)||void 0===n?void 0:n.now())?i:0;this._shouldUseOtelCsForAllEvents||this._shouldUseNewLogger&&(s.isAlertable||!l)?(null===(r=this._logger)||void 0===r||r.addKpi(s,"Success",t,this._shouldUseOtelCsForAllEvents||!l,null),l||(this._stats.kpis.totalProcessed+=1,this._stats.kpis.totalProcessingTime+=(null!=(o=null===(a=performance)||void 0===a?void 0:a.now())?o:0)-c)):s.isAlertable&&this.sendKpiSuccessDurationToHotPipeline(e,t),this._shouldUseOtelCsForAllEvents||this._shouldUseNewLogger&&!l||this.sendToWarmPipeline(e,"Success",c,t)}}},e.prototype.recordSuccessMultiple=function(e,t){var n=this;this._isEnabled&&e&&e.forEach((function(e){e&&n.recordSuccess(e,t)}))},e.prototype.recordUsage=function(e,t,n,i){var r,a,o,s,l;if(this._isEnabled&&e&&this._kpis){this._kpis.has(e)?this.incrementUsageOnKpi(e):this.addNewKpi(e,t,!1,n);var c=null!=(a=null===(r=performance)||void 0===r?void 0:r.now())?a:0;this.shouldSendEventViaOtelCs()?(null===(o=this._logger)||void 0===o||o.addKpi(this._kpis.get(e),"Usage",{extendedProperties:i},!0,null),this._stats.kpis.totalProcessed+=1,this._stats.kpis.totalProcessingTime+=(null!=(l=null===(s=performance)||void 0===s?void 0:s.now())?l:0)-c):this.sendToWarmPipeline(e,"Usage",c,{extendedProperties:i})}},e.prototype.recordUsageMultiple=function(e,t,n,i){var r=this;this._isEnabled&&e&&e.forEach((function(e){e&&r.recordUsage(e,t,n,i)}))},e.prototype.recordUsageForAlertableKpi=function(e,t,n){var r,a,o,s,l;if(this._isEnabled&&e&&this._kpis){var c=!0;if(this._kpis.has(e)){var u=this._kpis.get(e);u&&(c=u.type===i.c.FailureBased),this.incrementUsageOnKpi(e)}else this.addNewKpi(e,i.c.FailureBased,!0,t);c&&this._alertableKpiObservers.forEach((function(t){return t(e)}));var d=null!=(a=null===(r=performance)||void 0===r?void 0:r.now())?a:0;this.shouldSendEventViaOtelCs()?(null===(o=this._logger)||void 0===o||o.addKpi(this._kpis.get(e),"Usage",{extendedProperties:n},!0,null),this._stats.kpis.totalProcessed+=1,this._stats.kpis.totalProcessingTime+=(null!=(l=null===(s=performance)||void 0===s?void 0:s.now())?l:0)-d):this.sendToWarmPipeline(e,"Usage",d,{extendedProperties:n})}},e.prototype.setHandlerForWarmPipeline=function(e){e&&(this._recordToWarmPipeline=e)},e.prototype.partCDimensionsUpdated=function(e){e&&(this._additionalPartCDimensions=e)},e.prototype.sendToWarmPipeline=function(e,t,n,a,o){var s,l;if(this._recordToWarmPipeline){var c=r.b.formatEventName(e,"Kpi",this.getApplication());if(this._kpis){var u=this._kpis.get(e);if(u){var d=u.type===i.c.FailureBased,p=[new r.a("KpiEvent","string",t),new r.a("KpiType","string",d?"FailureBased":"SuccessBased"),new r.a("UsageCount","int",u.usageCount.toString()),new r.a("FailureCount","int",u.failureCount.toString()),new r.a("SuccessCount","int",u.successCount.toString())];if(r.b.addPartCFields(this._additionalPartCDimensions,p),d&&u.kpiErrors&&o){var h=u.kpiErrors.get(o);h&&(p.push(new r.a("ErrorName","string",h.kpiErrorName?h.kpiErrorName:"")),p.push(new r.a("IsIntentional","boolean",h.isIntentional.toString())),p.push(new r.a("IsInternal","boolean",h.isInternal.toString())),p.push(new r.a("ErrorCount","int",h.count.toString())))}a&&(a.durationMs&&p.push(new r.a("DurationMs","int",a.durationMs.toString())),a.extendedProperties&&a.extendedProperties.forEach((function(e,t){p.push(new r.a("ExtendedProperties_"+t,"string",e||""))}))),this._recordToWarmPipeline(c,!0,p);var m='{"type":"kpi","kpiName":"'+u.kpiName+'","kpiEvent":"'+t+'","shouldSendEventWithOtelCs":false"}';this._externalLogger(590406981,i.b.Info,m)}}this._stats.kpis.totalProcessedWithOtelJs+=1,this._stats.kpis.totalProcessingTimeWithOtelJs+=(null!=(l=null===(s=performance)||void 0===s?void 0:s.now())?l:0)-n}},e.prototype.addNewKpi=function(e,t,n,r){if(e&&this._kpis){var a={kpiName:e,type:n?i.c.FailureBased:t||i.c.FailureBased,isAlertable:n,owningFeatureCrewAlias:r,kpiErrors:new Map,usageCount:1,successCount:0,failureCount:0};this._kpis.set(e,a)}},e.prototype.incrementUsageOnKpi=function(e){if(e&&this._kpis){var t=this._kpis.get(e);t&&(t.usageCount=t.usageCount+1,this._kpis.set(e,t))}},e.prototype.sendKpiFailureToHotPipeline=function(e,t){if(this._remoteTelemetryUrl){var n=this.formatAlertableKpiFailurePayload(e,t),i=this._isAppShuttingDown()||!this._shouldUseXhr;r.b.sendToHotPipeline(this._remoteTelemetryUrl,n,i,this._saveRequestStatus)}},e.prototype.sendKpiSuccessDurationToHotPipeline=function(e,t){if(this._remoteTelemetryUrl&&e&&t&&t.durationMs){var n=this.formatAlertableKpiSuccessDurationPayload(e,t),i=this._isAppShuttingDown()||!this._shouldUseXhr;r.b.sendToHotPipeline(this._remoteTelemetryUrl,n,i,this._saveRequestStatus)}},e.prototype.getApplication=function(){var e;if(this._application)return this._application;var t=null!=(e=this._dimensions.application)?e:"Unknown";return"Unknown"!==t&&(this._application=t),t},e.prototype.shouldSendEventViaOtelCs=function(){return this._shouldUseOtelCsForAllEvents||this._shouldUseNewLogger&&!this._isOtelJsReady()},e.prototype.sendKpiEventToPipeline=function(e,t,n,i,r){var a,o,s,l,c;if(e){var u=this._isOtelJsReady(),d=null!=(o=null===(a=performance)||void 0===a?void 0:a.now())?o:0;(this._shouldUseOtelCsForAllEvents||this._shouldUseNewLogger&&(e.isAlertable||!u))&&(null===(s=this._logger)||void 0===s||s.addKpi(e,n,i,this._shouldUseOtelCsForAllEvents||!u,r),u||(this._stats.kpis.totalProcessed+=1,this._stats.kpis.totalProcessingTime+=(null!=(c=null===(l=performance)||void 0===l?void 0:l.now())?c:0)-d)),this._shouldUseOtelCsForAllEvents||this._shouldUseNewLogger&&!u||this.sendToWarmPipeline(t,n,d,i)}},e.prototype.constructKpiUpdateForFailure=function(e,t,n,i,r){if(e&&(e.failureCount=e.failureCount+1,n&&e.kpiErrors))if(e.kpiErrors.has(n)){var a=e.kpiErrors.get(t);a&&(a.count=a.count+1,e.kpiErrors.set(n,a))}else{var o={kpiErrorName:n,isIntentional:!0===i,isInternal:!0===r,count:1};e.kpiErrors.set(n,o)}return e},e}()},"./lib/qosRecorder.js":
/*!****************************!*\
  !*** ./lib/qosRecorder.js ***!
  \****************************/
/*! exports provided: QosRecorder */
/*! exports used: QosRecorder */
function(e,t,n){n.d(t,"a",(function(){return o}));var i=n(
/*! ./generated/health.gen */
"./lib/generated/health.gen.js"),r=n(
/*! ./utils */
"./lib/utils.js"),a=n(
/*! ./stats */
"./lib/stats.js"),o=function(){function e(e){var t,n,i,o,s,l,c,u=this;this._isEnabled=!1,this._dimensions={},this._additionalPartCDimensions=new Map,this._qosErrors=new Map,this._qosPillars=new Set,this._application="",this.recordPillarToWarmTimerId=0,this.recordPillarToWarmIntervalMs=864e5,this.recordPillarToWarmLastTimestamp=0,this._recordToWarmPipeline=null,this._downloadOtelLibrary=function(){},this._isOtelJsReady=function(){return!1},this._saveRequestStatus=function(e){},this._isAppShuttingDown=function(){return!1},this._stats=new a.a,this._shouldUseNewLogger=!1,this._shouldUseOtelCsForAllEvents=!1,this._shouldUseXhr=!1,this._externalLogger=function(){},this.formatQosErrorPayload=function(e){var t={};t.qosDimensions=u._dimensions,t.additionalPartCDimensions=r.b.convertStringMapToObject(u._additionalPartCDimensions);var n=new Map;e&&e.errorName&&n.set(e.errorName,e),t.errors=r.b.convertQosErrorToObject(n),t.sessionPillars=r.b.convertStringSetToArray(u._qosPillars),t.shouldSendErrorWithOtelCs=u.shouldSendEventViaOtelCs();var i={type:"qos_error"};return i.payloadJson=JSON.stringify(t),JSON.stringify(i)},e&&(e.remoteTelemetryUrl&&(this._remoteTelemetryUrl=e.remoteTelemetryUrl),this._vetoClassifier=e.vetoClassifier,this._isEnabled=e.isEnabled,this._dimensions=null!=(t=e.dimensions)?t:{},this._saveRequestStatus=null!=(n=e.saveQosRequestStatus)?n:function(e){},this._shouldUseNewLogger=null!=(i=e.shouldUseNewLogger)&&i,this._shouldUseOtelCsForAllEvents=null!=(o=e.shouldUseOtelCsForAllEvents)&&o,this._shouldUseXhr=null!=(s=e.shouldUseXhr)&&s,this._logger=e.remoteTelemetryLogger,this._stats=null!=(l=e.stats)?l:new a.a,this._externalLogger=null!=(c=e.externalLogger)?c:function(){},this.recordPillarToWarmIntervalMs=e.recordPillarToWarmIntervalMs&&e.recordPillarToWarmIntervalMs>0?e.recordPillarToWarmIntervalMs:864e5),this._addPillarObservers=[],this._removePillarObservers=[],this._sessionEndingErrorObservers=[]}return e.prototype.registerAddPillarObserver=function(e){e&&this._addPillarObservers.push(e)},e.prototype.registerRemovePillarObserver=function(e){e&&this._removePillarObservers.push(e)},e.prototype.registerSessionEndingErrorObserver=function(e){e&&this._sessionEndingErrorObservers.push(e)},e.prototype.removeAddPillarObserver=function(e){e&&(this._addPillarObservers=this._addPillarObservers.filter((function(t){return t!==e})))},e.prototype.removeRemovePillarObserver=function(e){e&&(this._removePillarObservers=this._removePillarObservers.filter((function(t){return t!==e})))},e.prototype.removeSessionEndingErrorObserver=function(e){e&&(this._sessionEndingErrorObservers=this._sessionEndingErrorObservers.filter((function(t){return t!==e})))},e.prototype.setHandlerForWarmPipeline=function(e){e&&(this._recordToWarmPipeline=e)},e.prototype.setHandlerForOtelLibraryLoader=function(e){e&&(this._downloadOtelLibrary=e)},e.prototype.setHandlerForIsOtelJsReady=function(e){e&&(this._isOtelJsReady=e)},e.prototype.setHandlerForIsAppShuttingDown=function(e){e&&(this._isAppShuttingDown=e)},e.prototype.recordBsqmError=function(e,t,n){var i;this._isEnabled&&(null===(i=this._logger)||void 0===i||i.addBsqmQosError(e,t,n))},e.prototype.recordError=function(e,t,n,a,o,s,l){var c,u,d,p,h,m,g,f,v;if(this._isEnabled){var _=null;if(this._qosErrors&&e&&t&&(this._qosErrors.has(e)?(_=this._qosErrors.get(e))&&(_.count+=1,this._qosErrors.set(e,_)):(_={errorName:e,isIntentional:!0===n,isInternal:!0===a,alertOnPillar:!0===o,isSessionEndingError:!0===s,count:1},this._qosErrors.set(e,_)),_)){var y=new Set;_.vetos=[];for(var b=0,S=t;b<S.length;b++){var C=S[b];if(this._vetoClassifier&&!y.has(C)){var A=this._vetoClassifier.getVeto(C);A&&(_.vetos.push(A),y.add(C))}}_.durationMs=l&&l.durationMs?l.durationMs:null,_.extendedProperties=l&&l.extendedProperties?l.extendedProperties:null,_.isSessionEndingError&&(this._shouldUseXhr=!1,this._downloadOtelLibrary(),this._sessionEndingErrorObservers.forEach((function(e){return e()})),this.recordPillarsToWarmPipeline());var I=this.shouldSendEventViaOtelCs(),w='{"type":"qos_error","errorName":"'+_.errorName+'","vetos":"'+t+'","shouldSendEventWithOtelCs":"'+I+'"}';this._externalLogger(590406981,i.b.Info,w);var T=null!=(u=null===(c=performance)||void 0===c?void 0:c.now())?u:0;if(I||this._shouldUseNewLogger?(null===(d=this._logger)||void 0===d||d.addQosError(_,t,this._qosPillars,I),this._stats.qosErrors.totalProcessed+=1,this._stats.qosErrors.totalProcessingTime+=(null!=(h=null===(p=performance)||void 0===p?void 0:p.now())?h:0)-T,_.isSessionEndingError&&(null===(m=this._logger)||void 0===m||m.shutdown())):this.sendQosErrorToHotPipeline(_),!I&&this._recordToWarmPipeline){var E=r.b.formatEventName(_.errorName,"Qos.Error",this.getApplication()),k=[];if(_.extendedProperties&&_.extendedProperties.forEach((function(e,t){k.push(new r.a("ExtendedProperties_"+t,"string",e||""))})),_.vetos)for(var M=0,P=_.vetos;M<P.length;M++){var F=P[M];if(F){C=F.getVetoName();var D=F.getPillars();if(D)for(var O=0,R=D;O<R.length;O++){var x=R[O];if(x&&((null===(g=this._qosPillars)||void 0===g?void 0:g.has(x))||"VetoMissingClassification"===x)){var U=[new r.a("IsIntentional","boolean",_.isIntentional.toString()),new r.a("IsInternal","boolean",_.isInternal.toString()),new r.a("AlertOnPillar","boolean",_.alertOnPillar.toString()),new r.a("Count","int",_.count.toString()),new r.a("Pillar","string",x),new r.a("Veto","string",C||"")];_.durationMs&&U.push(new r.a("DurationMs","int",_.durationMs.toString())),r.b.addPartCFields(this._additionalPartCDimensions,U),U=U.concat(k),this._recordToWarmPipeline(E,!1,U)}}}}this._stats.qosErrors.totalProcessedWithOtelJs+=1,this._stats.qosErrors.totalProcessingTimeWithOtelJs+=(null!=(v=null===(f=performance)||void 0===f?void 0:f.now())?v:0)-T}}}},e.prototype.addPillar=function(e){e&&this._qosPillars&&(0===this._qosPillars.size&&(this.recordPillarToWarmLastTimestamp=Date.now(),this.queueRecordPillarToWarmPipeline()),this._qosPillars.has(e)||(this._qosPillars.add(e),this._addPillarObservers.forEach((function(t){return t(e)})),this.recordPillarToWarmPipeline(e)))},e.prototype.removePillar=function(e){e&&this._qosPillars&&this._qosPillars.has(e)&&(this._qosPillars.delete(e),this._removePillarObservers.forEach((function(t){return t(e)})),0===this._qosPillars.size&&this.stopRecordPillarToWarmPipelineTimer())},e.prototype.getPillars=function(){return r.b.convertStringSetToArray(this._qosPillars)},e.prototype.sendQosErrorToHotPipeline=function(e){if(this._remoteTelemetryUrl){var t=this.formatQosErrorPayload(e),n=this._isAppShuttingDown()||!this._shouldUseXhr;r.b.sendToHotPipeline(this._remoteTelemetryUrl,t,n,this._saveRequestStatus)}},e.prototype.recordPillarToWarmPipeline=function(e){var t,n=this.shouldSendEventViaOtelCs(),a='{"type":"qos_pillar","pillarName":"'+e+'","shouldSendEventWithOtelCs":"'+n+'"}';if(this._externalLogger(590406981,i.b.Info,a),n)null===(t=this._logger)||void 0===t||t.addQosPillar(e);else if(this._recordToWarmPipeline){var o=r.b.formatEventName(e,"Qos.Pillar",this.getApplication(),!0),s=[new r.a("Pillar","string",e)];r.b.addPartCFields(this._additionalPartCDimensions,s),this._recordToWarmPipeline(o,!0,s)}},e.prototype.queueRecordPillarToWarmPipeline=function(e){var t=this;void 0===e&&(e=this.recordPillarToWarmIntervalMs),this.recordPillarToWarmTimerId=window.setTimeout((function(){t.recordPillarsToWarmPipelineAndReQueue()}),e)},e.prototype.recordPillarsToWarmPipeline=function(){var e=this;this._qosPillars&&this._qosPillars.forEach((function(t){t&&e.recordPillarToWarmPipeline(t)}))},e.prototype.recordPillarsToWarmPipelineAndReQueue=function(){this._qosPillars&&(this.recordPillarToWarmLastTimestamp=Date.now(),this.recordPillarsToWarmPipeline()),this.queueRecordPillarToWarmPipeline()},e.prototype.stopRecordPillarToWarmPipelineTimer=function(){this.clearRecordPillarToWarmPipelineTimer()},e.prototype.resumeRecordPillarToWarmPipelineTimer=function(){if(0===this.recordPillarToWarmTimerId&&0!==this.recordPillarToWarmLastTimestamp){var e=Date.now()-this.recordPillarToWarmLastTimestamp;e>=this.recordPillarToWarmIntervalMs||e<=0?this.recordPillarsToWarmPipelineAndReQueue():this.queueRecordPillarToWarmPipeline(this.recordPillarToWarmIntervalMs-e)}},e.prototype.partCDimensionsUpdated=function(e){e&&(this._additionalPartCDimensions=e,this.recordPillarsToWarmPipelineAndReQueue())},e.prototype.clearRecordPillarToWarmPipelineTimer=function(){0!==this.recordPillarToWarmTimerId&&(window.clearTimeout(this.recordPillarToWarmTimerId),this.recordPillarToWarmTimerId=0)},e.prototype.getApplication=function(){var e;if(this._application)return this._application;var t=null!=(e=this._dimensions.application)?e:"Unknown";return"Unknown"!==t&&(this._application=t),t},e.prototype.shouldSendEventViaOtelCs=function(){return this._shouldUseOtelCsForAllEvents||this._shouldUseNewLogger&&!this._isOtelJsReady()},e}()},"./lib/qosVeto.js":
/*!************************!*\
  !*** ./lib/qosVeto.js ***!
  \************************/
/*! exports provided: QosVeto */
/*! exports used: QosVeto */
function(e,t,n){n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.prototype.getPillars=function(){return this._pillars},e.prototype.getVetoName=function(){return this._vetoName},e.prototype.setPillars=function(e){this._pillars=e},e.prototype.setVetoName=function(e){this._vetoName=e},e}()},"./lib/remoteTelemetryLogger.js":
/*!**************************************!*\
  !*** ./lib/remoteTelemetryLogger.js ***!
  \**************************************/
/*! exports provided: RemoteTelemetryLogger */
/*! exports used: RemoteTelemetryLogger */
function(e,t,n){n.d(t,"a",(function(){return a}));var i=n(
/*! ./generated/health.gen */
"./lib/generated/health.gen.js"),r=n(
/*! ./utils */
"./lib/utils.js"),a=function(){function e(e){var t,n,i;this._bsqmQosErrorQueue=[],this._kpiQueue=[],this._qosErrorQueue=[],this._qosHeartbeatQueue=[],this._qosPillarQueue=[],this._remoteTelemetryUrl="",this._currentQueueSize=0,this._maxQueueSize=25,this._maxTimeBetweenBatchesMs=3e4,this._sendTimerId=0,this._shouldUseBeacons=!1,this._saveRequestStatus=function(e){},this._isAppShuttingDown=function(){return!1},this._dimensionsVersion=0,this._isAppOnline=!0,this._remoteTelemetryUrl=null!=(t=e.remoteTelemetryUrl)?t:"",this._maxQueueSize=e.maxQueueSize,this._maxTimeBetweenBatchesMs=e.maxTimeBetweenBatchesMs,this._shouldUseBeacons=!e.shouldUseXhr,this._dimensions=this.minifyDimensions(null!=(n=e.dimensions)?n:{}),this._saveRequestStatus=e.requestStatusLogger,this._externalLogger=null!=(i=e.externalLogger)?i:function(){},this.scheduleEventUploadTimer()}return e.prototype.addBsqmQosError=function(e,t,n){var a,o,s;if(e){var l='{"type":"bsqm_qos_error","bsqmErrorId":"'+e+'","additionalVetos":"'+t+'","shouldSendEventWithOtelCs":"true"}';this._externalLogger(590406981,i.b.Info,l);var c={};c.b=e,c.v=t,c.d=null===(a=n)||void 0===a?void 0:a.durationMs,c.p=r.b.convertStringMapToObject(null===(o=n)||void 0===o?void 0:o.extendedProperties),this._isAppOnline?(this._bsqmQosErrorQueue.push(c),this.updateQueue()):(this.addOfflineFields(c),null===(s=this._offlineWorker)||void 0===s||s.postMessage({type:"bsqm_qos_error",key:this._dimensions.w+"."+this._dimensionsVersion,minifiedDimensions:this._dimensions,additionalPartC:this._additionalPartCDimensions,value:c}))}},e.prototype.addQosError=function(e,t,n,i){var a;if(e&&t){var o={};o.n=e.errorName,o.x=e.isIntentional,o.z=e.isInternal,o.l=e.alertOnPillar,o.c=e.count,o.v=t,o.d=e.durationMs,o.p=r.b.convertStringMapToObject(e.extendedProperties),o.s=r.b.convertStringSetToArray(n),o.a=i,this._isAppOnline?(this._qosErrorQueue.push(o),this.updateQueue()):(this.addOfflineFields(o),null===(a=this._offlineWorker)||void 0===a||a.postMessage({type:"qos_error",key:this._dimensions.w+"."+this._dimensionsVersion,minifiedDimensions:this._dimensions,additionalPartC:this._additionalPartCDimensions,value:o}))}},e.prototype.addQosPillar=function(e){var t;if(e){var n={};n.n=e,this._isAppOnline?(this._qosPillarQueue.push(n),this.updateQueue()):(this.addOfflineFields(n),null===(t=this._offlineWorker)||void 0===t||t.postMessage({type:"qos_pillar",key:this._dimensions.w+"."+this._dimensionsVersion,minifiedDimensions:this._dimensions,additionalPartC:this._additionalPartCDimensions,value:n}))}},e.prototype.addKpi=function(e,t,n,a,o){var s,l,c;if(e&&t){if(a){var u='{"type":"kpi","kpiName":"'+e.kpiName+'","kpiEvent":"'+t+'","shouldSendEventWithOtelCs":"true"}';this._externalLogger(590406981,i.b.Info,u)}var d={};if(d.n=e.kpiName,d.e=t,d.t=i.c[e.type],d.u=e.usageCount,d.f=e.failureCount,d.s=e.successCount,d.d=null===(s=n)||void 0===s?void 0:s.durationMs,d.p=r.b.convertStringMapToObject(null===(l=n)||void 0===l?void 0:l.extendedProperties),d.a=a,d.m=e.isAlertable,o){var p={};p.n=o.kpiErrorName,p.x=o.isIntentional,p.z=o.isInternal,p.c=o.count,d.g=p}this._isAppOnline?(this._kpiQueue.push(d),this.updateQueue()):(this.addOfflineFields(d),null===(c=this._offlineWorker)||void 0===c||c.postMessage({type:"kpi",key:this._dimensions.w+"."+this._dimensionsVersion,minifiedDimensions:this._dimensions,additionalPartC:this._additionalPartCDimensions,value:d}))}},e.prototype.addHeartbeat=function(e,t,n,i){if(e||t){var a={};a.p=r.b.convertStringSetToArray(e),a.k=r.b.convertStringSetToArray(t),a.i=n,a.o=i,this._qosHeartbeatQueue.push(a),this.updateQueue()}},e.prototype.partCDimensionsUpdated=function(e){e&&(this.sendEventsAndRequeue(),this._additionalPartCDimensions=r.b.convertStringMapToObject(e),this._dimensionsVersion+=1)},e.prototype.setHandlerForIsAppShuttingDown=function(e){e&&(this._isAppShuttingDown=e)},e.prototype.shutdown=function(){this.cancelEventUploadTimer(),this._isAppShuttingDown=function(){return!0},this.flush()},e.prototype.setIsAppOnline=function(e){var t;!this._isAppOnline&&e&&(null===(t=this._offlineWorker)||void 0===t||t.postMessage({type:"flush"})),this._isAppOnline=e},e.prototype.setOfflineWorker=function(e){this._offlineWorker=e},e.prototype.addOfflineFields=function(e){e.a=!0,e.o=(new Date).toJSON()},e.prototype.updateQueue=function(){this._currentQueueSize+=1,this._isAppShuttingDown()?this.flush():this._currentQueueSize>=this._maxQueueSize&&(this.cancelEventUploadTimer(),this.sendEventsAndRequeue())},e.prototype.scheduleEventUploadTimer=function(){var e=this;this.cancelEventUploadTimer(),this._sendTimerId=window.setTimeout((function(){e.sendEventsAndRequeue()}),this._maxTimeBetweenBatchesMs)},e.prototype.cancelEventUploadTimer=function(){this._sendTimerId&&(window.clearTimeout(this._sendTimerId),this._sendTimerId=0)},e.prototype.sendEventsAndRequeue=function(){this.flush(),this.scheduleEventUploadTimer()},e.prototype.minifyDimensions=function(e){var t={};return t.a=e.application,t.b=e.applicationLcid,t.c=e.applicationMode,t.d=e.applicationModeExtended,t.e=e.arrVersion,t.f=e.browser,t.g=e.browserLcid,t.h=e.browserMajorVersion,t.i=e.browserVersion,t.j=e.clientVersion,t.k=e.datacenter,t.l=e.dataCulture,t.m=e.flightsImpressionId,t.n=e.host,t.o=e.isAnonymousUser,t.p=e.isBusinessUser,t.q=e.isEduUser,t.r=e.isSynthetic,t.s=e.loggableUserId,t.t=e.loggableUserIdSpace,t.u=e.ring,t.v=e.serverDocId,t.w=e.session_id,t.x=e.sessionOrigin,t.y=e.tenantId,t.z=e.uiHost,t.aa=e.wfeVersion,t.ab=e.fileExtension,t},e.prototype.formatPayload=function(){var e={};return e.d=this._dimensions,e.a=this._additionalPartCDimensions,e.b=this._bsqmQosErrorQueue,e.e=this._qosErrorQueue,e.h=this._qosHeartbeatQueue,e.q=this._qosPillarQueue,e.k=this._kpiQueue,e.type="health_events_v1",JSON.stringify(e)},e.prototype.flush=function(){try{if(this._currentQueueSize<=0)return;r.b.sendToHotPipeline(this._remoteTelemetryUrl,this.formatPayload(),this._shouldUseBeacons||this._isAppShuttingDown(),this._saveRequestStatus),this._bsqmQosErrorQueue=[],this._kpiQueue=[],this._qosErrorQueue=[],this._qosHeartbeatQueue=[],this._qosPillarQueue=[],this._currentQueueSize=0}catch(e){}},e}()},"./lib/stats.js":
/*!**********************!*\
  !*** ./lib/stats.js ***!
  \**********************/
/*! exports provided: HealthStats */
/*! exports used: HealthStats */
function(e,t,n){n.d(t,"a",(function(){return i}));var i=function(){function e(){this.heartbeats=this.createNewStats(),this.qosErrors=this.createNewStats(),this.kpis=this.createNewStats()}return e.prototype.createNewStats=function(){return{totalProcessed:0,totalProcessedWithOtelJs:0,totalProcessingTime:0,totalProcessingTimeWithOtelJs:0}},e}()},"./lib/utils.js":
/*!**********************!*\
  !*** ./lib/utils.js ***!
  \**********************/
/*! exports provided: Utils, HealthDataField */
/*! exports used: HealthDataField, Utils */
function(e,t,n){n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var i=function(){function e(){}return e.convertStringMapToObject=function(e){if(!e)return{};var t={};return e.forEach((function(e,n){n&&(t[n]=e)})),t},e.convertStringSetToArray=function(e){if(!e)return[];var t=[];return e.forEach((function(e){e&&t.push(e)})),t},e.convertQosErrorToObject=function(e){var t=this;if(!e)return{};var n={};return e.forEach((function(e,i){if(i&&e){var r=[];e.vetos&&e.vetos.forEach((function(e){if(e){var t={};t.vetoName=e.getVetoName(),t.pillars=e.getPillars(),r.push(t)}}));var a={};a.errorName=e.errorName,a.extendedProperties=t.convertStringMapToObject(e.extendedProperties),a.isIntentional=e.isIntentional,a.isInternal=e.isInternal,a.alertOnPillar=e.alertOnPillar,a.vetos=r,a.count=e.count,a.durationMs=e.durationMs,n[i]=a}})),n},e.sendToHotPipeline=function(e,t,n,i){if(t){if(n)try{if("undefined"!=typeof navigator.sendBeacon)return void navigator.sendBeacon(e,t)}catch(e){}var r=new XMLHttpRequest;r.open("POST",e,!0),r.onreadystatechange=function(){r.readyState===XMLHttpRequest.DONE&&i(r.status)},r.send(t)}},e.formatEventName=function(e,t,n,i){if(i)return"Office."+n+".Online.Health."+t;var r="Unknown"+t;return e&&(r=(r=(r=e.length>0&&!isNaN(Number(e.charAt(0)))?"Unknown"+e:e).replace(/_/g,"")).charAt(0).toUpperCase()+r.slice(1)),"Office."+n+".Online.Health."+t+"."+r},e.getDimension=function(e,t){var n="Unknown";if(e){var i=e.get(t);i&&(n=i)}return n},e.addPartCFields=function(e,t){e&&e.forEach((function(e,n){n&&e&&t.push(new r(n,"string",e))}))},e}(),r=function(){function e(e,t,n){this._name=e,this._type=t,this._value=n}return e.prototype.getName=function(){return this._name},e.prototype.getValue=function(){return this._value},e.prototype.getType=function(){return this._type},e}()}}),E=n(1),k=n(9),M=n(19),P=arguments,F=function(e){try{return k.Debug.methodFrame(e,Object(M.a)(Function,P.callee.caller))}catch(e){}return""},D=n(219),O=function(){D.a.instance.authenticationCheck()},R=n(183);function x(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function U(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),e}var B=function(){function e(e,t){void 0===t&&(t=!0),this._actionData=e,this._shouldCanvasTakeFocus=t}return U(e,[{key:"actionData",get:function(){return this._actionData}},{key:"shouldCanvasTakeFocus",get:function(){return this._shouldCanvasTakeFocus}}]),e}();Object(s.a)(B,"ActionDataContainer",null,[239]);var L=n(284),N=n(154);function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var j=function(e){function t(){var n;return(n=e.call(this)||this)._panel=null,n._debugLogLevels=void 0,n._contentDiv=null,n._loggingOptionsTable=null,n._logLevelElements=void 0,n._callstackLevelElements=void 0,t._singletonInstance=H(n),n._logLevelChangeHandler=Object(r.d)(H(n),n.logLevelChange,"logLevelChange"),n._callstackLevelChangeHandler=Object(r.d)(H(n),n.callstackLevelChange,"callstackLevelChange"),n}return W(t,e),t}(N.a);j._singletonInstance=null,j._initialized=void 0,Object(s.a)(j,"ALogCategoriesTab",N.a,[]);var V=n(86),K=n(155),z=n(67),q=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./lib/index.js")}({"./lib/generated/qosWac.gen.js":
/*!*************************************!*\
  !*** ./lib/generated/qosWac.gen.js ***!
  \*************************************/
/*! exports provided: QosPillarName, QosWacFactoryGlobal */
/*! exports used: QosPillarName, QosWacFactoryGlobal */
function(e,t,n){n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var i,r=n(
/*! ../qosWacFactory */
"./lib/qosWacFactory.js");!function(e){e[e.Interruptions=0]="Interruptions",e[e.Open=1]="Open",e[e.Save=2]="Save",e[e.VetoMissingClassification=3]="VetoMissingClassification",e[e.Consumption=4]="Consumption",e[e.Authoring=5]="Authoring",e[e.RealTimeCoauth=6]="RealTimeCoauth"}(i||(i={}));var a=new r.a},"./lib/index.js":
/*!**********************!*\
  !*** ./lib/index.js ***!
  \**********************/
/*! exports provided: QosPillarName, QosWacFactoryGlobal, QosWacFactory */
/*! all exports used */
function(e,t,n){n.r(t);var i=n(
/*! ./generated/qosWac.gen */
"./lib/generated/qosWac.gen.js");n.d(t,"QosPillarName",(function(){return i.a})),n.d(t,"QosWacFactoryGlobal",(function(){return i.b}));var r=n(
/*! ./qosWacFactory */
"./lib/qosWacFactory.js");n.d(t,"QosWacFactory",(function(){return r.a}))},"./lib/qosVetoClassification.js":
/*!**************************************!*\
  !*** ./lib/qosVetoClassification.js ***!
  \**************************************/
/*! exports provided: QosVetoClassification */
/*! exports used: QosVetoClassification */
function(e,t,n){n.d(t,"a",(function(){return a}));var i=n(
/*! ./generated/qosWac.gen */
"./lib/generated/qosWac.gen.js"),r=n(
/*! ./vetosByPillar.json */
"./lib/vetosByPillar.json"),a=function(){function e(e,t){this._wacVetos=new Map,this._vetoFactory=e,this._wacVetos=null!=t?t:this.createVetosDictionary()}return e.prototype.getVeto=function(e){if(!e)return null;var t=this._wacVetos.get(e);return t||(t=this.createNewVeto(e,[i.a[i.a.VetoMissingClassification]]),this._wacVetos.set(e,t)),t},e.prototype.getVetosDictionary=function(){return this._wacVetos},e.prototype.createVetosDictionary=function(){for(var e=new Map,t=0,n=r.a;t<n.length;t++)for(var i=n[t],a=0,o=i.Vetos;a<o.length;a++){var s=o[a];e.set(s,this.createNewVeto(s,[i.Pillar]))}return e},e.prototype.createNewVeto=function(e,t){var n=this._vetoFactory();return n.setVetoName(e),n.setPillars(t),n},e}()},"./lib/qosWacFactory.js":
/*!******************************!*\
  !*** ./lib/qosWacFactory.js ***!
  \******************************/
/*! exports provided: QosWacFactory */
/*! exports used: QosWacFactory */
function(e,t,n){n.d(t,"a",(function(){return r}));var i=n(
/*! ./qosVetoClassification */
"./lib/qosVetoClassification.js"),r=function(){function e(){this._qosVetoClassification=void 0}return e.prototype.createQosVetoClassificationInstance=function(e){if(void 0===this._qosVetoClassification)try{this._qosVetoClassification=new i.a(e,null)}catch(e){this._qosVetoClassification=null}return this._qosVetoClassification},e}()},"./lib/vetosByPillar.json":
/*!********************************!*\
  !*** ./lib/vetosByPillar.json ***!
  \********************************/
/*! exports provided: VetosByPillar, default */
/*! exports used: VetosByPillar */
function(e){e.exports={a:[{Pillar:"Authoring",Vetos:["BBUnableToRefreshLock","ContentRenderFailed","MergedCellOverlap","PasteFailed","PhoneticDataLossWarning","SlowEditAction","SlowScrollingSession","SlowTypingSession","TransitionNonMetroCanNotConvert","UnsupportedFeatures","UnsupportedFeatureDownloadWarning","VersionHistoryAuthoringDowngraded"]},{Pillar:"Consumption",Vetos:["ExternalDataRefreshFailed","ExternalLinksDisabled","FailedToBrowseToURL","MissingFont","NavigationSlow","SilentFailure","SlideShowACE","SlideShowNavigationSlow","SlideShowOpenSlow","ThumbnailLoadSlow","VersionHistoryConsumptionDowngraded"]},{Pillar:"Interruptions",Vetos:["ACE","BBNetworkDown","BBTransientServerCommunicationFailures","BBWorkingOnIt","ClientSideHangs","Crash","DismissibleDialog","ExpiredSessions","FailedToFetchLegacyErrorDetails","FellBackToReadOnly","ICE","InternalError","KickoutWithoutDataLoss","NonDismissibleDialog","OperationSucceededWithAlert","OtherACE","OtherICE","SessionExpired","TemplateServiceFailed","UnexpectedAppRefresh","WorkingOnIt"]},{Pillar:"Open",Vetos:["BootCriticalFileDownloadFailed","FileOpenFailed","InteractiveOpenSlow","PerceivedOpenSlow","ViewByDefault","RibbonBootFailed"]},{Pillar:"RealTimeCoauth",Vetos:["CoauthGalleryExperienceDegraded","PresenceExperienceDegraded","UserBlockedByOtherUser"]},{Pillar:"Save",Vetos:["ClientSideDataLoss","MergeFailure","ServerSideDataLoss"]}]}}}),G=function(){Type.registerNamespace("AppRealtimeChannel"),Type.registerNamespace("CommandUI"),Type.registerNamespace("Common"),Type.registerNamespace("Common.AdaptiveLayout"),Type.registerNamespace("Common.App"),Type.registerNamespace("Common.App.AccountSwitching"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),Type.registerNamespace("Common.App.BasicChat"),Type.registerNamespace("Common.App.CoauthTelemetry"),Type.registerNamespace("Common.App.LearningTools"),Type.registerNamespace("Common.App.NetworkConnectivity"),Type.registerNamespace("Common.App.O365Shell"),Type.registerNamespace("Common.App.SaveStatus"),Type.registerNamespace("Common.App.SearchCommon"),Type.registerNamespace("Common.App.SensitiveLogging"),Type.registerNamespace("Common.App.SkypeChat"),Type.registerNamespace("Common.App.Throttling"),Type.registerNamespace("Common.App.VisibilityManagement"),Type.registerNamespace("Common.App.WopiIdentity"),Type.registerNamespace("Common.AppResourceLoader"),Type.registerNamespace("Common.Comments"),Type.registerNamespace("Common.CustomEvents"),Type.registerNamespace("Common.Interface"),Type.registerNamespace("Common.MruV2"),Type.registerNamespace("Common.NetworkTiming"),Type.registerNamespace("Common.UI"),Type.registerNamespace("Common.Utils"),Type.registerNamespace("Common.Utils.Aggregators"),Type.registerNamespace("Common.Utils.System"),Type.registerNamespace("Common.Utils.Telemetry"),Type.registerNamespace("CommonUI"),Type.registerNamespace("System"),Type.registerNamespace("common");var e=T;window.health=e,window.Common.AFrameworkApplication=E.AFrameworkApplication,window.Common.Debug=k.Debug,window.$$methodFrame=F,window.hardSigninCompleted=O,window.Common.TestHarnessInterface=R.a,window.Common.ActionDataContainer=B,window.Common.CrossDomainRequestExecutor=L.a,window.Common.ALogCategoriesTab=j,window.Common.UISurfaces=V.UISurfaces,window.Common.ObjectModelUtils=K.a,window.Common.App.AppLifecycleManager=z.a;var t=q;window.qosWac=t},Q=function(){};Q._periodicTimerIntervalId=void 0,Object(s.a)(Q,"OtelDebugActions",null,[]);var Z=n(283),$=n(85),X=n(30),J=n(329),Y=n(134),ee=n(33),te=n(330),ne=n(130),ie=n(27),re=n(88),ae=n(3),oe=function(){this.name=null,this.platform=null,this.version=null,this.osVersion=null,this.osBuild=null,this.sessionId=null,this.host=null,this.serverDocId=null,this.datacenter=null,this.isSynthetic=null,this.applicationMode=null,this.applicationModeExtended=null,this.flights=null,this.flightsImpressionId=null,this.ring=null,this.audienceGroup=null,this.loggableUserId=null,this.loggableUserIdSpace=null,this.isAnonymousUser=null,this.isBusinessUser=null,this.isEduUser=null,this.omsTenantId=null,this.browserName=null,this.browserVersion=null,this.browserLanguage=null,this.appLanguage=null,this.contentLanguage=null,this.uiHost=null,this.sessionOrigin=null};Object(s.a)(oe,"AlwaysOnMetadata",null,[]);var se=function(){this.ulsLogger=null,this.sendToUls=null,this.enableAdditionalDiagnosticTracing=null};function le(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(se,"LoggingSettings",null,[]);var ce=function(e){function t(){var t;return(t=e.call(this)||this).sendToAria=null,t.otelUseOneDsSink=null,t.ariaEndpointTarget=null,t.eventUploadFrequency=null,t.cacheMemorySizeLimitInNumberOfEvents=null,t.pingCollectorPingUrl=null,t.pingCollectorEndpoint=null,t.samplingIsEnabled=null,t.sampleRate=null,t}return le(t,e),t}(se);function ue(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(ce,"OneDSTransportSettings",se,[]);var de=function(e){function t(){var t;return(t=e.call(this)||this).wacAriaThrottlingIsEnabled=null,t.wacAriaTotalEventsThrottlePerSec=null,t.wacAriaSingleEventThrottlePerSec=null,t.otelEventNamesToBeSuppressedCommaSeparated=null,t}return ue(t,e),t}(ce);function pe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(de,"ThrottlingSettings",ce,[]);var he=function(e){function t(){var t;return(t=e.call(this)||this).taskDurationLogFrequency=null,t.taskDurationLogThreshold=null,t.reportTaskDetails=null,t}return pe(t,e),t}(de);function me(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(he,"StatsReporterSettings",de,[]);var ge=function(e){function t(){var t;return(t=e.call(this)||this).sendToExpLogger=null,t.expLoggerEndpointUrl=null,t.expLoggerNumEventsToTriggerUpload=null,t.expLoggerTimeToWaitBeforeAutoUploadingEvents=null,t.expLoggerMaxEventsPerRequest=null,t}return me(t,e),t}(he);function fe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(ge,"LoggerExpSettings",he,[]);var ve=function(e){function t(){var t;return(t=e.call(this)||this).alwaysOnMetadata=null,t}return fe(t,e),t}(ge);Object(s.a)(ve,"TelemetrySettings",ge,[]);var _e=n(394),ye="MissingUserClicks",be="BadUserClicks",Se="BootPerf",Ce=function(){function e(){}return e.isEnabledCheckAppInitStatusBeforeOtelFullDownload=function(t){var n=!1;switch(t){case"word":case"onenote":case"powerpoint":case"visio":n=e.appSettingsManager.getBooleanAppSetting("OtelFullJsDelayLoadAfterAppLoadedSuccessfullyEnabled");break;case"excel":n=!0}return n},e.getAppInitializationStatusToWaitForInViewMode=function(t){var n=7;switch(t){case"onenote":case"excel":n=7;break;case"word":case"powerpoint":case"visio":n=8}var i=e.sessionStartInfoSettings.ApplicationModeExtended;return i&&"embed_view"===i.toLowerCase()&&(n=8),n},e.getAppInitializationStatusToWaitForInEditMode=function(t){var n=7;switch(t){case"word":case"onenote":case"powerpoint":n=7;break;case"excel":n=e.appSettingsManager.getBooleanAppSetting("FlushBootMetricsToOtelIsEnabled")?8:4;break;case"visio":n=8}return n},e.getAppInitializationStatusToWaitFor=function(t){var n=e.sessionStartInfoSettings.ApplicationMode,i=n?n.toLowerCase():"";return"view"===i?e.getAppInitializationStatusToWaitForInViewMode(t):"slideshow"===i||"broadcast_view"===i?8:e.getAppInitializationStatusToWaitForInEditMode(t)},e.getOtelDownloadSafetyTimerDelayMs=function(){e._otelDownloadSafetyTimerDelayMsMainAppModes=e.appSettingsManager.getIntAppSetting("OtelDownloadSafetyTimerDelayMsMainAppModes",0),e._otelDownloadSafetyTimerDelayMsNonMainAppModes=e.appSettingsManager.getIntAppSetting("OtelDownloadSafetyTimerDelayMsNonMainAppModes",3e3);var t=e._otelDownloadSafetyTimerDelayMsNonMainAppModes,n=e.sessionStartInfoSettings.ApplicationMode;if(n)switch(n=n.toLowerCase()){case"view":case"edit":case"unified":t=e._otelDownloadSafetyTimerDelayMsMainAppModes;break;default:t=e._otelDownloadSafetyTimerDelayMsNonMainAppModes}return t},e.checkAppInitStatusBeforeOtelFullDownload=function(){window.setTimeout((function(){e.kickOffOtelFullDownloadCallback()}),e.getOtelDownloadSafetyTimerDelayMs());var t=e.sessionStartInfoSettings.Application||"unknownapp";t=t.toLowerCase(),e.isEnabledCheckAppInitStatusBeforeOtelFullDownload(t)?(ae.ULS.sendTraceTag(50622754,383,50,"OtelLibraryLoader:Waiting for {0} to download {1}",Z.a[e.getAppInitializationStatusToWaitFor(t)],e.otelFullJSName),e.appLifecycleManager.executeWhen(e.getAppInitializationStatusToWaitFor(t),e.kickOffOnDemandFullDownload)):(ae.ULS.sendTraceTag(50622755,383,50,"OtelLibraryLoader:NOT waiting for any app initialization status to download {0}",e.otelFullJSName),e.kickOffOtelFullDownload()),e.appSettingsManager.getBooleanAppSetting("OtelTriggerDemandLoadIsEnabled")&&e.appLifecycleManager.executeWhen(13,e.kickOffOtelFullDownload)},e.kickOffOtelFullDownloadCallback=function(){e.kickOffOtelFullDownloadCallMade||(ae.ULS.sendTraceTag(50622784,383,15,"KickOffOtelFullDownload was called from safety callback[{0}]",e.getAppDetails()),e.kickOffOtelFullDownload())},e.kickOffOnDemandFullDownload=function(){e.kickOffOtelFullDownloadCallMade||(ae.ULS.sendTraceTag(50622785,383,50,"OtelFull download was demand initiated [{0}]",e.getAppDetails()),e.kickOffOtelFullDownload())},e.flushBootMetricsToOtel=function(){try{if(e.metricsLogged=!1,!e.appSettingsManager.getBooleanAppSetting("FlushBootMetricsToOtelIsEnabled"))return;if(e.appSettingsManager.getBooleanAppSetting("FlushBootMetricsModifyAppInitStatusIsEnabled")&&e.bootPerfMetricsFlushInitiated)return;e.bootPerfMetricsFlushInitiated=!0,ae.ULS.sendTraceTag(577642517,383,100,"OtelLibraryLoader:BootPerf: Starting process to send Boot metrics."),e.pageLoadPerfRecorder.logTelemetry(),e.pageLoadPerfRecorder.computeAndAddDurationMetrics();new Array(0);var t=ee.b(e.appSettingsManager.appSettings.SessionStartInfoJson.toString()),n=Object.assign(new _e.a,{extendedProperties:new Map});n.extendedProperties.set("SessionOrigin",t.SessionOrigin);try{var i=e.sessionStartInfoSettings.Flights||(E.AFrameworkApplication.flightId?E.AFrameworkApplication.flightId.split(";"):new Array(0));n.extendedProperties.set("Flights",ee.c(i))}catch(e){ae.ULS.sendTraceTag(592984016,383,50,"Failed to parse flight info, continuing with logging other metrics. Exception: {0}",e)}if(e.pageLoadPerfRecorder.pageLoadPerfMetrics){$.Health.instance.recordKpiUsageForAlertableKpi(ye,"wacbootmonitoring",null),$.Health.instance.recordKpiUsageForAlertableKpi(be,"wacbootmonitoring",null);var r=e.pageLoadPerfRecorder.pageLoadPerfMetrics;for(var a in r){var o={key:a,value:r[a]};try{if(Object.getType(o.value)===Boolean)n.extendedProperties.set(o.key,o.value.toString());else{if(n.extendedProperties.set(o.key,Object.getType(o.value)===Object?ee.c(o.value):o.value.toString()),o.key===X.a.eupl){var s=Number.parseInvariant(o.value.toString());!isNaN(s)&&s>0&&(n.durationMs=s)}if(o.key===X.a.userClickedHostUI){var l=o.value.toString();null==l&&$.Health.instance.recordKpiFailure(ye,"UserClickTime is missing",!1,!0,null)}if(o.key===X.a.hostDuration){var c=Number.parseInvariant(o.value.toString());!isNaN(c)&&c>E.AFrameworkApplication.appSettingsManager.getIntAppSetting("BadUserClicksDuration",6e4)&&$.Health.instance.recordKpiFailure(be,"Bad click detected",!1,!0,null)}}}catch(e){n.extendedProperties.set(o.key,"")}}}$.Health.instance.recordKpiUsageForAlertableKpi(Se,"wacbootmonitoring",null),$.Health.instance.recordKpiSuccess(Se,n),ae.ULS.sendTraceTag(577642518,383,100,"OtelLibraryLoader:BootPerf: Boot Perf KPI logged."),e.metricsLogged=!0}catch(e){ae.ULS.sendTraceTag(594137291,383,15,"Failed to send boot metrics to Otel"+e.toString())}},e.kickOffOtelFullDownload=function(){if(!e.kickOffOtelFullDownloadCallMade){e.kickOffOtelFullDownloadCallMade=!0;var t=e.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled");if(re.a.setEnabledState(t),t)if(ae.ULS.sendTraceTag(50622787,383,50,"Otel pipeline is enabled [{0}]",e.getAppDetails()),e.isOtelFullAvailable())e.initializeOtelFull();else{var n=ne.a.create(E.AFrameworkApplication.scriptUrlFromName(e.otelFullJSName,5));n.add_loadFinished(e.onOtelFullLoadFinished),Y.a.enqueueResourceWithoutEnabling(n),e.appSettingsManager.getBooleanAppSetting("FlushBootMetricsModifyAppInitStatusIsEnabled")?e.initBootPerfMetricsProcess():e.flushBootMetricsToOtel()}else ae.ULS.sendTraceTag(50622786,383,50,"Otel pipeline is disabled [{0}]!",e.getAppDetails())}},e.onOtelFullLoadFinished=function(t,n){if(!n.succeeded)return re.a.setEnabledState(!1),void ae.ULS.sendTraceTag(50622788,383,10,"Failed to load {0} from {1}",e.otelFullJSName,n.resourceUrl);ae.ULS.sendTraceTag(50622789,383,50,"Successfully loaded {0} from {1}",e.otelFullJSName,n.resourceUrl),e.initializeOtelFull()},e.initializeOtelFull=function(){e.tryInitializeOtelFull()&&(re.a.registerEventHandler((function(e){otelFull.TelemetryFullGlobal.processTelemetryEvent(e)})),re.a.setOtelFullAvailable())},e.tryInitializeOtelFull=function(){try{var t=Object(M.a)(String,e.sessionStartInfoSettings.Os);if(t){var n=Object(M.a)(String,e.sessionStartInfoSettings.OsVersion);n&&(t+="("+n+")")}var i=Object.assign(new oe,{name:Object(M.a)(String,e.sessionStartInfoSettings.Application)||"",platform:"Web",version:Object(M.a)(String,E.AFrameworkApplication.buildVersion||e.sessionStartInfoSettings.WFEVersion)||"",osVersion:t||"",sessionId:Object(M.a)(String,e.sessionStartInfoSettings.WACSessionID)||"",flightsImpressionId:Object(M.a)(String,e.sessionStartInfoSettings.FlightsImpressionId)||"",audienceGroup:Object(M.a)(String,e.sessionStartInfoSettings.AudienceGroup)||"",browserName:Object(M.a)(String,e.sessionStartInfoSettings.Browser)||"",browserVersion:Object(M.a)(String,e.sessionStartInfoSettings.BrowserVersion)||"",appLanguage:Object(M.a)(String,e.sessionStartInfoSettings.ApplicationLCID)||"",host:Object(M.a)(String,e.sessionStartInfoSettings.Host)||"",uiHost:Object(M.a)(String,e.sessionStartInfoSettings.UiHost)||"",sessionOrigin:Object(M.a)(String,e.sessionStartInfoSettings.SessionOrigin)||"",serverDocId:Object(M.a)(String,e.sessionStartInfoSettings.ServerDocId)||"",datacenter:Object(M.a)(String,e.sessionStartInfoSettings.WACDatacenter)||"",isSynthetic:Boolean.parse(e.sessionStartInfoSettings.IsSynthetic||"false"),applicationMode:Object(M.a)(String,e.sessionStartInfoSettings.ApplicationMode)||"",applicationModeExtended:Object(M.a)(String,e.sessionStartInfoSettings.ApplicationModeExtended)||"",browserLanguage:Object(M.a)(String,e.sessionStartInfoSettings.BrowserLCID)||"",contentLanguage:Object(M.a)(String,e.sessionStartInfoSettings.DataCulture)||"",ring:Object(M.a)(String,e.sessionStartInfoSettings.Ring)||"-1",loggableUserId:(e.appSettingsManager.getStringAppSetting("LoggableUserId")||"").toLowerCase(),loggableUserIdSpace:(e.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||"").toLowerCase(),isAnonymousUser:Boolean.parse(e.appSettingsManager.getStringAppSetting("IsAnonymousUser")||"false"),isBusinessUser:!!e.sessionStartInfoSettings.IsBusinessUser,isEduUser:!!e.sessionStartInfoSettings.IsEduUser,omsTenantId:e.appSettingsManager.getStringAppSetting("TenantId")||"",flights:E.AFrameworkApplication.flightId?E.AFrameworkApplication.flightId.split(";"):new Array(0)});""===i.name||""===i.applicationMode||""===i.sessionId||""===i.loggableUserId||""===i.loggableUserIdSpace||""===i.audienceGroup||""===i.host||""===i.datacenter||"-1"===i.ring||""===i.omsTenantId?ae.ULS.sendTraceTag(594903131,383,15,"Otel AlwaysOnMetadata Missing! AppName: "+(""!==i.name?i.name:"N")+", ApplicationMode: "+(""!==i.applicationMode?i.applicationMode:"N")+", SessionId: "+(""!==i.sessionId?"Y":"N")+", LoggableUserIdSpace: "+(""!==i.loggableUserIdSpace?"Y":"N")+", LoggableUserId: "+(""!==i.loggableUserId?"Y":"N")+", AudienceGroup: "+(""!==i.audienceGroup?"Y":"N")+", Host: "+(""!==i.host?"Y":"N")+", Datacenter: "+(""!==i.datacenter?"Y":"N")+", Ring: "+("-1"!==i.ring?"Y":"N")+", OmsTenantId: "+(""!==i.omsTenantId?"Y":"N")):ae.ULS.sendTraceTag(594903130,383,50,"Otel AlwaysOnMetadata Good!");var r=null;te.a((function(){r=new J.a}));var a=Object.assign(new ve,{alwaysOnMetadata:i,sendToAria:!0,sendToUls:!1,ulsLogger:r,ariaEndpointTarget:e.appSettingsManager.getStringAppSetting("AriaEndpointTarget"),eventUploadFrequency:e.appSettingsManager.getIntAppSetting("OtelPipelineEventUploadFrequency",2e3),pingCollectorPingUrl:e.appSettingsManager.getBooleanAppSetting("OtelPingCollectorPingUrl"),pingCollectorEndpoint:e.appSettingsManager.getBooleanAppSetting("OtelPingCollectorEndpoint"),wacAriaThrottlingIsEnabled:e.appSettingsManager.getBooleanAppSetting("WACAriaThrottlingIsEnabled"),wacAriaTotalEventsThrottlePerSec:e.appSettingsManager.getIntAppSetting("WACAriaTotalEventsThrottlePerSec",100),wacAriaSingleEventThrottlePerSec:e.appSettingsManager.getIntAppSetting("WACAriaSingleEventThrottlePerSec",20),otelEventNamesToBeSuppressedCommaSeparated:e.appSettingsManager.getStringAppSetting("WACAriaEventNamesToBeSuppressedCommaSeparated"),taskDurationLogFrequency:e.appSettingsManager.getIntAppSetting("OtelStatsTaskDurationLogFrequency",20),taskDurationLogThreshold:e.appSettingsManager.getIntAppSetting("OtelStatsTaskDurationLogThreshold",100),reportTaskDetails:e.appSettingsManager.getBooleanAppSetting("OtelStatsReportTaskDetails"),sendToExpLogger:e.appSettingsManager.getBooleanAppSetting("OtelExpLoggerEnabled"),expLoggerEndpointUrl:ie.a.getAbsoluteUrl(e.appSettingsManager.getStringAppSetting("OtelExpLoggerEndpoint")),expLoggerNumEventsToTriggerUpload:e.appSettingsManager.getIntAppSetting("OtelExpLoggerNumEventsToTriggerUpload",200),expLoggerTimeToWaitBeforeAutoUploadingEvents:e.appSettingsManager.getIntAppSetting("OtelExpLoggerTimeToWaitBeforeAutoUploadingEvents",1e4),expLoggerMaxEventsPerRequest:e.appSettingsManager.getIntAppSetting("OtelExpLoggerMaxEventsPerRequest",500),samplingIsEnabled:e.appSettingsManager.getBooleanAppSetting("OtelSamplingEnabled"),sampleRate:e.appSettingsManager.getDoubleAppSetting("OtelSampleRate",1)});return e.appSettingsManager.getBooleanAppSetting("OtelPipelineExperimentalFeaturesEnabled")&&(a.sendToAria=e.appSettingsManager.getBooleanAppSetting("OtelPipelineSendEventsToAria"),a.sendToUls=e.appSettingsManager.getBooleanAppSetting("OtelPipelineSendEventsToULS"),a.alwaysOnMetadata=e.appSettingsManager.getBooleanAppSetting("OtelPipelineAppendAlwaysOnMetadataToEveryEvent")?i:null),e.isOtelFullAvailable()?(otelFull.TelemetryFullGlobal.initialize(a),ae.ULS.sendTraceTag(50622791,383,50,"Success OtelFullAvailable"),!0):(ae.ULS.sendTraceTag(50622792,383,10,"We thought we had downloaded the otel js content but something went wrong because otelFull isn't actually available"),!1)}catch(e){ae.ULS.sendTraceTag(50622793,383,10,"Failed in TryInitializeOtelFull: "+e)}return!1},e.isOtelFullAvailable=function(){return"undefined"!=typeof otelFull},e.getAppDetails=function(){return String.format("{0}, {1}, {2}",e.sessionStartInfoSettings.Application,e.sessionStartInfoSettings.ApplicationMode,e.sessionStartInfoSettings.ApplicationModeExtended)},e.initBootPerfMetricsProcess=function(){e.appSettingsManager.getBooleanAppSetting("FlushBootMetricsToOtelIsEnabled")&&(e.bootPerfMetricsFlushInitiated?ae.ULS.sendTraceTag(577642519,383,100,"OtelLibraryLoader:BootPerf: BootPerfMetricsFlushInitiated is true so bailing out -[{0}]",e.getAppDetails()):(ae.ULS.sendTraceTag(578379980,383,50,"OtelLibraryLoader:BootPerf: Waiting on App init status to flush metrics"),window.setTimeout((function(){e.bootPerfMetricsFlushInitiated||(ae.ULS.sendTraceTag(578379981,383,15,"OtelLibraryLoader:BootPerf: Boot Perf metrics flush triggered from safety timer-[{0}]",e.getAppDetails()),e.flushBootMetricsToOtel())}),e.appSettingsManager.getIntAppSetting("FlushBootMetricsSafetyTimerDelayMs",6e4)),e.appLifecycleManager.executeWhen(7,(function(){ae.ULS.sendTraceTag(577642520,383,100,"OtelLibraryLoader:BootPerf: ChromeReady event called -[{0}]",e.getAppDetails()),e.chromeReadyCalled=!0,e.appLoadedSuccessfullyCalled&&!e.bootPerfMetricsFlushInitiated&&(ae.ULS.sendTraceTag(578379982,383,50,"OtelLibraryLoader:BootPerf: Boot Perf metrics flush triggered from ChromeReady-[{0}]",e.getAppDetails()),e.flushBootMetricsToOtel())})),e.appLifecycleManager.executeWhen(8,(function(){ae.ULS.sendTraceTag(577642521,383,100,"OtelLibraryLoader:BootPerf: AppLoadedSuccessfully event called -[{0}]",e.getAppDetails()),e.appLoadedSuccessfullyCalled=!0,e.chromeReadyCalled&&!e.bootPerfMetricsFlushInitiated&&(ae.ULS.sendTraceTag(578379983,383,50,"OtelLibraryLoader:BootPerf: Boot Perf metrics flush triggered from AppLoadedSuccessfully-[{0}]",e.getAppDetails()),e.flushBootMetricsToOtel())}))))},e}();Ce.appSettingsManager=null,Ce.sessionStartInfoSettings=null,Ce.appLifecycleManager=null,Ce.pageLoadPerfRecorder=null,Ce.otelFullJSName="otelFull.min.js",Ce.kickOffOtelFullDownloadCallMade=!1,Ce.bootPerfMetricsFlushInitiated=!1,Ce.chromeReadyCalled=!1,Ce.appLoadedSuccessfullyCalled=!1,Ce.metricsLogged=!0,Ce._otelDownloadSafetyTimerDelayMsMainAppModes=3e4,Ce._otelDownloadSafetyTimerDelayMsNonMainAppModes=3e3,Object(s.a)(Ce,"OtelLibraryLoaderHelper",null,[]);var Ae=n(68),Ie=n(113);function we(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Te(e,t,n){return t&&we(e.prototype,t),n&&we(e,n),e}var Ee=function(){function e(){}var t=e.prototype;return t.configure=function(e){},t.init=function(){ae.ULS.sendTraceTag(38836106,383,50,"OtelLibraryLoader:Init");var e=function(){Ce.appSettingsManager=E.AFrameworkApplication.appSettingsManager,Ce.sessionStartInfoSettings=E.AFrameworkApplication.sessionStartInfoSettings,Ce.appLifecycleManager=z.a.get_instance(),Ce.pageLoadPerfRecorder=Ie.a.instance,Ce.checkAppInitStatusBeforeOtelFullDownload()};try{z.a.get_instance().isCompleted(13)&&e()}catch(e){ae.ULS.sendTraceTag(594564771,383,10,"Failed to initialize OTelJS after a session ending error: "+e)}E.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){ae.ULS.sendTraceTag(38836107,383,50,"OtelLibraryLoader:FullAppSettingsReady"),e()})),E.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsFailed((function(){ae.ULS.sendTraceTag(38836108,383,10,"OtelLibraryLoader:Failed to get FullAppSettings"),e()}))},t.dispose=function(){},e.main=function(){Ae.a.instance.registerPackage(new e)},Te(e,[{key:"name",get:function(){return"Common.App.OtelLibraryLoader"}}]),e}();Object(s.a)(Ee,"OtelLibraryLoaderPackage",null,[14,15]);var ke=function(){Type.registerNamespace("Common"),Type.registerNamespace("Common.App.OtelLibraryLoader"),Type.registerNamespace("Otel"),Ee.main()},Me=function(){Type.registerNamespace("CommonUI")},Pe=n(357);function Fe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function De(e,t,n){return t&&Fe(e.prototype,t),n&&Fe(e,n),e}var Oe=function(){function e(){}var t=e.prototype;return t.configure=function(e){},t.init=function(){Pe.a.logInfo()},t.dispose=function(){},e.main=function(){Ae.a.instance.registerPackage(new e)},De(e,[{key:"name",get:function(){return"Common.App.BrowserInfoLogger"}}]),e}();Object(s.a)(Oe,"BrowserInfoLoggerPackage",null,[14,15]);var Re=function(){Type.registerNamespace("Common.App.BrowserInfoLogger"),Oe.main()},xe=function(){Type.registerNamespace("Common")},Ue=function(){function e(){this.Message=null,this.File=null,this.Line=0,this.Column=0,this.Stack=null,this.ClientAppVersion=null,this.AppType=0,this.AppMode=0,this.DeobfuscateWithSourceMaps=!1,this.SessionStartInfoJson=null,this.DataPlumber=null,this.IsShuttingDown=!1,this.Flight=null}return e.prototype.serialization=function(){return ee.c(this)},e}();Object(s.a)(Ue,"DiagnosticsRequest",null,[]);var Be=n(110),Le=n(13),Ne="text/json; charset=utf-8",He=function(){function e(e,t,n,i,r){this._webServiceUrl=e,this._appVersion=t,this._appType=n,this._appMode=i,this._isGoogleClosureEnabled=r}var t=e.prototype;return t.sendReport=function(e,t){try{this.createHttpRequest().send(this.generateReport(e,t))}catch(e){ae.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",e.toString())}},t.createHttpRequest=function(){var e=new XMLHttpRequest;if(e.open("POST",this._webServiceUrl,!0),e.setRequestHeader("Content-Type",Ne),E.AFrameworkApplication.userSessionId&&e.setRequestHeader(Be.a.userSessionIdHeaderName,Le.a.httpHeaderEncode(E.AFrameworkApplication.userSessionId)),this._appVersion&&e.setRequestHeader(Be.a.officeVersionHeaderName,this._appVersion),E.AFrameworkApplication.theClientRequestManager){var t=E.AFrameworkApplication.theClientRequestManager.wacClusterId;t&&e.setRequestHeader(Be.a.wacClusterHeaderName,t)}return e},t.generateReport=function(e,t){if(!e)return null;t=t?"<stack>"+t+"</stack>":"";var n=new Ue;if(n.Message=e.message,n.File=e.source,n.Line=e.line,n.Column=e.column,n.Stack=t,n.ClientAppVersion=this._appVersion,n.AppType=this._appType,n.AppMode=this._appMode,n.DeobfuscateWithSourceMaps=this._isGoogleClosureEnabled,E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("JavaScriptCrashJsonTagEnabled")){var i=E.AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson||"";n.SessionStartInfoJson=i,E.AFrameworkApplication.dataPlumber&&(n.DataPlumber=ee.c(E.AFrameworkApplication.dataPlumber)),n.IsShuttingDown=E.AFrameworkApplication.isShuttingDown,n.Flight=E.AFrameworkApplication.flightId}return n.serialization()},e}();Object(s.a)(He,"JavascriptErrorReporter",null,[56]);var We=function(){function e(){}return e.prototype.build=function(e,t,n,i,r){return new He(e,t,n,i,r)},e}();function je(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ve(e,t,n){return t&&je(e.prototype,t),n&&je(e,n),e}Object(s.a)(We,"JavascriptErrorReporterFactory",null,[37]);var Ke=function(){function e(){}var t=e.prototype;return t.configure=function(e){e.register(We,"Common.App.Diagnostics.JavascriptErrorReporterFactory").as("Common.IJavascriptErrorReporterFactory").singleInstance().usingFactory((function(){return new We}))},t.init=function(){},t.dispose=function(){},e.main=function(){Ae.a.instance.registerPackage(new e)},Ve(e,[{key:"name",get:function(){return"Common.App.Diagnostics"}}]),e}();Object(s.a)(Ke,"DiagnosticsPackage",null,[14,15]);var ze=function(){Type.registerNamespace("Common.App.Diagnostics"),Ke.main()},qe=function(){Type.registerNamespace("Common.App.AccessibilityHelpDialog")},Ge="securitypolicyviolation",Qe=function(){function e(){$addHandler(document,Ge,Object(r.d)(this,this.onSecurityPolicyViolationEventHandler,"onSecurityPolicyViolationEventHandler"))}var t=e.prototype;return t.onSecurityPolicyViolationEventHandler=function(e){var t=e.rawEvent,n=t.blockedURI;n=ie.a.removeAllUrlParameters(n);var i={};i.effectiveDirective=t.effectiveDirective,i.violatedDirective=t.violatedDirective,i.originalPolicy=t.originalPolicy,i.blockedURI=n,i.disposition=t.disposition,ae.ULS.sendTraceTag(588084128,306,15,"{0}",i)},t.dispose=function(){$removeHandler(document,Ge,Object(r.d)(this,this.onSecurityPolicyViolationEventHandler,"onSecurityPolicyViolationEventHandler"))},e}();function Ze(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $e(e,t,n){return t&&Ze(e.prototype,t),n&&Ze(e,n),e}Object(s.a)(Qe,"ContentSecurityPolicyListener",null,[4]);var Xe=function(){function e(){this._container=null}var t=e.prototype;return t.init=function(){this._container.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")},t.dispose=function(){var e=this._container.tryResolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");e&&e.dispose()},t.configure=function(e){this._container=e,this._container.register(Qe,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").singleInstance().usingFactory((function(){return new Qe}))},e.main=function(){Ae.a.instance.registerPackage(new e)},$e(e,[{key:"name",get:function(){return"Common.App.ContentSecurityPolicy"}}]),e}();Object(s.a)(Xe,"ContentSecurityPolicyPackage",null,[14,15]);var Je=function(){Type.registerNamespace("Common.App.ContentSecurityPolicy"),Xe.main()},Ye=n(56),et=n(4),tt=n(127);function nt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function it(e,t,n){return t&&nt(e.prototype,t),n&&nt(e,n),e}var rt=function(){function e(e){this._previousNumberOfChats=0,this._chatContainerId=null,this._reactSharedHeaderFocusManager=e}var t=e.prototype;return t.registerActions=function(){this.isInitialized?this.registerActionsInternal():this.registerOnChatReady(Object(r.d)(this,this.registerActionsInternal,"registerActionsInternal"))},t.registerActionsInternal=function(){var e=this;ae.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then((function(t){t.getChatsContainer(Object(r.d)(e,e.onChatContainerReady,"onChatContainerReady"))})).catch((function(e){ae.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",e)})),this.chat.getChatsCounter().then((function(t){t.onChatsCountChange(Object(r.d)(e,e.chatCountChanged,"chatCountChanged"))})).catch((function(e){ae.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",e)})),this.chat.getKeyboard().then((function(t){t.onKeyDown(Object(r.d)(e,e.onChatKeyPress,"onChatKeyPress"))})).catch((function(e){ae.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",e)})))}catch(e){ae.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",e)}},t.chatCountChanged=function(e){if(ae.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",e),e){if(1===e&&!this._previousNumberOfChats){var t=document.getElementById(this._chatContainerId?this._chatContainerId:tt.a.chatFocusId);t?this.sharedHeaderFocusManager.onChatOpen(t,Object(r.d)(this,this.transferFocusToChat,"transferFocusToChat")):ae.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}}else this.sharedHeaderFocusManager.onChatClose();this._previousNumberOfChats=e},t.onChatContainerReady=function(e){this._chatContainerId=e},t.onChatKeyPress=function(e){e.ctrlKey&&"f6"===e.key.toLowerCase()&&this.transferFocusFromChat(e.shiftKey)},t.registerOnChatReady=function(e){Ye.a.instance.registerHandler(et.EventNames.swcReady,window.self,(function(t){return e(),!0}))},t.transferFocusToChat=function(){ae.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then((function(e){e.focusConversationInput()})).catch((function(e){ae.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",e)}))}catch(e){ae.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",e)}},t.transferFocusFromChat=function(e){ae.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat"),this.sharedHeaderFocusManager.onChatCtrlF6(e)},it(e,[{key:"chat",get:function(){return window.swc}},{key:"isInitialized",get:function(){return!!this.chat}},{key:"sharedHeaderFocusManager",get:function(){return this._reactSharedHeaderFocusManager.value}}]),e}();Object(s.a)(rt,"ChatManager",null,[193]);var at=n(49);function ot(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function st(e,t,n){return t&&ot(e.prototype,t),n&&ot(e,n),e}var lt="OnTopRowControlsCreatedEvent",ct="OnTopRowControlsDisposingEvent",ut="OnRenameTextboxStatusChangedEventKey",dt=function(){function e(){this._eventSource=new at.a,this._topRowControlsCreated=!1,this._standaloneRootControlManager=null}var t=e.prototype;return t.add_onTopRowControlsCreated=function(e){this._eventSource.addHandler(lt,e)},t.remove_onTopRowControlsCreated=function(e){this._eventSource.removeHandler(lt,e)},t.add_onTopRowControlsDisposing=function(e){this._eventSource.addHandler(ct,e)},t.remove_onTopRowControlsDisposing=function(e){this._eventSource.removeHandler(ct,e)},t.add_onRenameTextboxStatusChanged=function(e){this._eventSource.addHandler(ut,e)},t.remove_onRenameTextboxStatusChanged=function(e){this._eventSource.removeHandler(ut,e)},t.raiseTopRowControlsCreatedEvent=function(e,t){void 0===t&&(t=null),this._topRowControlsCreated=!0,this._standaloneRootControlManager=e,this._eventSource.raiseEvent(lt,t)},t.raiseOnTopRowControlsDisposingEvent=function(){this._topRowControlsCreated=!1,this._eventSource.raiseEvent(ct)},t.raiseRenameTextboxStatusChangedEvent=function(e){this._eventSource.raiseEvent(ut,e?"true":"false")},st(e,[{key:"topRowControlsCreated",get:function(){return this._topRowControlsCreated}},{key:"standaloneRootControlManager",get:function(){return this._standaloneRootControlManager}}]),e}();Object(s.a)(dt,"HeaderEventSource",null,[]);var pt=n(31),ht=n(78),mt=n(25),gt=n(20),ft=n(8),vt=function(){function e(e,t,n,i,r){this._transferFocusToChat=null,this._focusManager=e,this._f6Manager=t,this._mouseInputManager=n,this._touchInputManager=i,this._actionManager=r}var t=e.prototype;return t.registerF6=function(e,t,n,i){void 0===i&&(i=null);var r=this._focusManager.getScope(t);r.parent=n,r.keyDownHandledExternally=!0,i&&r.addOnFocus(i),this._mouseInputManager.addControlFocus(t,e,!1),this._touchInputManager.addControlFocus(t,e,!1);var a=new ht.DOMFocusListing((function(){return e}));a.addValidTag(2),a.addValidTag(1),a.addValidTag(8),a.addValidTag(5),a.addValidTag(3),a.addValidTag(6),this._focusManager.buildRegionWithDelegate((function(){return e}),r,a).looped=!0;var o=gt.KeyInputManager.hashKey(mt.a.vK_Tab,0),s=gt.KeyInputManager.hashKey(mt.a.vK_Tab,4);r.unBindAction(o),r.unBindAction(s)},t.onFlexPaneOpen=function(e){this.registerF6(e,tt.a.meControlFlexPaneFocusId,tt.a.headerUiFocusId),this._focusManager.setScope(tt.a.meControlFlexPaneFocusId),this._f6Manager.addF6(tt.a.meControlFlexPaneFocusId)},t.onFlexPaneClose=function(e){this._f6Manager.deactivateFocus(tt.a.meControlFlexPaneFocusId),this._focusManager.setScope(tt.a.headerUiFocusId)},t.onChatOpen=function(e,t){this._transferFocusToChat||(this._transferFocusToChat=t,this.registerF6(e,tt.a.chatFocusId,pt.AFrame.appFocusId,Object(r.d)(this,this.onChatFocus,"onChatFocus"))),this._focusManager.setScope(tt.a.chatFocusId),this._f6Manager.addF6(tt.a.chatFocusId)},t.onChatFocus=function(e,t){this._transferFocusToChat&&this._transferFocusToChat()},t.onChatClose=function(){this._f6Manager.deactivateFocus(tt.a.chatFocusId),this._focusManager.forceScopeChange(pt.AFrame.documentFocusID)},t.onChatCtrlF6=function(e){this._actionManager.processAction(e?ft.a.f6shift:ft.a.F6,2)},e}();Object(s.a)(vt,"ReactSharedHeaderFocusManager",null,[38]);var _t=n(61),yt=n(302),bt=n(16),St=n(21),Ct=n(35),At=function(){function e(e){this._actionManager=e}var t=e.prototype;return t.registerActions=function(){this._actionManager.addAction(ft.a.freemiumUpsellEligible,Ct.a.frame,Object(r.d)(this,this.navigateToUpsellPage,"navigateToUpsellPage")),this._actionManager.addAction(ft.a.freemiumUpsellDialogShowUI,Ct.a.frame,Object(r.d)(this,this.launchUpsellExperience,"launchUpsellExperience")),this._actionManager.addAction(ft.a.reportFreemiumUpsellEligibleDisplayed,Ct.a.frame,_t.ActionManager.doNothingButReportHandler),this._actionManager.addAction(ft.a.reportFreemiumUpsellEligibleClicked,Ct.a.frame,_t.ActionManager.doNothingButReportHandler)},t.navigateToUpsellPage=function(e,t,n,i,r){if(1===n)return 32;var a=8;if(2===n){var o=this.getCommandArgument(r,"experience","gopremiumribbon"),s=ie.a.getFwLinkUrl("2116536");s=ie.a.addParameterValue(s,"ocid",yt.b(E.AFrameworkApplication.activeFrame.applicationInstance.officeAppType,E.AFrameworkApplication.activeFrame.applicationInstance.officeAppMode,o)),bt.a.safelyOpenWindow(s,"_blank",void 0,void 0,"NavigateToUpsellPage"),a=32,this._actionManager.processAction(ft.a.reportFreemiumUpsellEligibleClicked,2),ae.ULS.sendTraceTag(38929747,340,50,"User directed to POC")}return a},t.launchUpsellExperience=function(e,t,n,i,r){if(1===n)return 32;var a=8;if(2===n){ae.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon");var o=St.a.instance.tryResolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");if(o){var s=this.getCommandArgument(r,"experience","gopremium");o.launchUpsellExperience(s),a=32}else ae.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),a=this.navigateToUpsellPage(e,t,n,i,r)}return a},t.getCommandArgument=function(e,t,n){var i=n,r=e;return r&&r[t]&&(i=Object(M.a)(String,r[t])),i},e}();function It(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wt(e,t,n){return t&&It(e.prototype,t),n&&It(e,n),e}Object(s.a)(At,"UpsellActor",null,[39]);var Tt=function(){function e(){this._container=null}var t=e.prototype;return t.init=function(){St.a.instance.resolve("Common.App.Header.IUpsellActor").registerActions(),St.a.instance.resolve("Common.App.Header.IChatManager").registerActions()},t.dispose=function(){},t.configure=function(e){var t=this;this._container=e,this._container.register(dt,"Common.App.Header.HeaderEventSource").singleInstance(),this._container.register(At,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().usingFactory((function(){return new At(E.AFrameworkApplication.theActionManager)})),this._container.register(vt,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().usingFactory((function(){return new vt(E.AFrameworkApplication.activeFrame.theFocusManager,E.AFrameworkApplication.activeFrame.theF6Manager,E.AFrameworkApplication.activeFrame.theMouseInputManager,E.AFrameworkApplication.activeFrame.theTouchInputManager,E.AFrameworkApplication.theActionManager)})),this._container.register(rt,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().usingFactory((function(){return new rt(t._container.resolveLazy("Common.App.Header.IReactSharedHeaderFocusManager"))}))},e.main=function(){Ae.a.instance.registerPackage(new e)},wt(e,[{key:"name",get:function(){return"Common.App.Header"}}]),e}();Object(s.a)(Tt,"CommonAppHeaderPackage",null,[14,15]);var Et=function(){Type.registerNamespace("Common"),Tt.main()},kt=function(){Type.registerNamespace("Common")},Mt=n(315),Pt=n(26),Ft=n(332),Dt=n(225),Ot=function(){function e(e,t,n){this._supportedHostActions={},this._appSettingsManager=e,this._hostPostMessengerFuture=n,this.loadSupportedHostActions(),this.registerActionListener(t)}var t=e.prototype;return t.loadSupportedHostActions=function(){var e=this;(this._appSettingsManager.getBooleanAppSetting("DocRebootIsSupported")||this._appSettingsManager.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"))&&(this._supportedHostActions[Ft.a.refresh]=function(){return e.sendPostMessageForAction(Pt.a.documentRefresh)})},t.registerActionListener=function(e){e.addAction(ft.a.raiseActionToHost,Ct.a.frame,Object(r.d)(this,this.sendActionToHostIfSupported,"sendActionToHostIfSupported"))},t.sendActionToHostIfSupported=function(e,t,n,i,r){if(2!==n)return 32;if(!r)return ae.ULS.sendTraceTag(41972610,204,15,"HostActionExecutionManager - No actionData provided"),16;var a=r.toLowerCase();return this._supportedHostActions[a]?(ae.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this._supportedHostActions[a]()):2},t.sendPostMessageForAction=function(e){var t=Dt.a.createRetriableMessage(e,{},E.AFrameworkApplication.userSessionId,3);return this._hostPostMessengerFuture.execute((function(e){e.postMessage(t)})),32},e}();Object(s.a)(Ot,"HostActionExecutionManager",null,[]);var Rt=n(276),xt=(n(54),n(24)),Ut=n(70),Bt=n(50),Lt=n(53),Nt=n(214);function Ht(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Wt=10324,jt=10325,Vt=11045,Kt=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i)||this)._documentLoadedTime=0,a._hostClickTime=0,a._hostClickTimeReported=!1,a._hostIframeTime=0,a._hostPageFetchStartTime=null,a._hostPageRedirectCount=null,a._hostIFrameTimeReported=!1,a._hostDocumentLoadedTimeReported=!1,a._actionManager=r,a._name="HostIntegrationMessenger",a.create(),a}Ht(t,e);var n=t.prototype;return n.hostMessageHandler=function(e){var t=e.message,n=e.eventArgs.origin;switch(E.AFrameworkApplication.wopiHostOriginFromPostMessage||(E.AFrameworkApplication.wopiHostOriginFromPostMessage=n),t.MessageId){case Pt.a.blurFocus:case Pt.a.blur_Focus:this.hostBlurFocusHandler(t);break;case Pt.a.grabFocus:case Pt.a.grab_Focus:this.tryGrabFocus();break;case Pt.a.hostPerfTiming:this.hostPerfMessageHandler(t);break;case Pt.a.jsApiDiagnostics:this.jsApiDiagnosticsHandler(t);break;case Pt.a.wacBeforeUnloadApp:this.beforeUnloadAppHandler(e);break;case Pt.a.wacUnloadApp:this.unloadAppHandler(e);break;default:0}},n.uiHostMessageHandler=function(e){switch(e.MessageId){case Pt.a.fileRename:E.AFrameworkApplication.theActionManager.processActionWithData(ft.a.renameFile,2,e.Values.NewName);break;case Pt.a.hostAccessibilityLoopComplete:E.AFrameworkApplication.theActionManager.processActionWithData(ft.a.resumeFocusWithDirection,2,e.Values[Lt.a.direction]);break;case Pt.a.hostUnload:ae.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received"),E.AFrameworkApplication.theActionManager.processActionWithData(ft.a.hostUnload,2,(new Date).getTime());break;case Pt.a.moveToFolderResponse:var t=e.Values[Lt.a.isMoveSuccessful];ae.ULS.sendTraceTag(579702984,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",t),t&&E.AFrameworkApplication.theActionManager.processActionWithData(ft.a.moveToFolderCompleteByHost,2,e.Values)}},n.tryGrabFocus=function(){return!(!xt.FocusManager.instance()||!xt.FocusManager.instance().currentScope||xt.FocusManager.instance().currentScope.name!==E.AFrameworkApplication.postmessageFocusId)&&(xt.FocusManager.instance().popScope(xt.FocusManager.instance().currentScope.name),!0)},n.hostBlurFocusHandler=function(e){if(xt.FocusManager.instance().pushScope(E.AFrameworkApplication.postmessageFocusId,!1),Lt.a.shareCorrelation in e.Values){var t={};t[Lt.a.shareCorrelation]=e.Values[Lt.a.shareCorrelation],ae.ULS.sendTraceTag(38278996,204,50,ee.c(t))}},n.hostPerfMessageHandler=function(e){if(!!!ie.a.getParameterValue(document.URL,E.AFrameworkApplication.modeSwitchTimeParamName)&&e.Values){0;var t=0,n=0;try{t=e.Values[Lt.a.hostPerfTiming_Click],n=e.Values[Lt.a.hostPerfTiming_Iframe],Lt.a.hostPerfTiming_FetchStart in e.Values?this._hostPageFetchStartTime=e.Values[Lt.a.hostPerfTiming_FetchStart]:Lt.a.hostPerfTiming_FetchStartAlt in e.Values&&(this._hostPageFetchStartTime=e.Values[Lt.a.hostPerfTiming_FetchStartAlt]),Lt.a.hostPerfTiming_RedirectCount in e.Values&&(this._hostPageRedirectCount=e.Values[Lt.a.hostPerfTiming_RedirectCount])}catch(e){return void 0}this._hostClickTime=t,this._hostIframeTime=n,this._documentLoadedTime&&this.logHostPerfSqm()}},n.jsApiDiagnosticsHandler=function(e){ae.ULS.sendTraceTag(37536415,204,50,"JsApiDiagnostics");var t=e.Values[Lt.a.hostInitializeDiagnostics];t&&Ut.a.instance.recordHostInitDiagnostics(t);var n=e.Values[Lt.a.jsApiDiagnostics];n&&Ut.a.instance.recordJsApiDiagnostics(n)},n.beforeUnloadAppHandler=function(e){ae.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now()),E.AFrameworkApplication.isShuttingDownFromPostMessage=!0,E.AFrameworkApplication.activeFrame.thePageManager.onBeforeNavigate(e.eventArgs.innerEvent)},n.unloadAppHandler=function(e){ae.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now()),E.AFrameworkApplication.activeFrame.thePageManager.onNavigate(null,Sys.EventArgs.Empty)},n.logHostPerfSqm=function(){this.logHostClickTimeSqm(),this.logHostIFrameSqm(),null!=this._hostPageFetchStartTime&&Ut.a.instance.recordHostPageFetchStart(this._hostPageFetchStartTime),null!=this._hostPageRedirectCount&&Ut.a.instance.recordHostPageRedirectCount(this._hostPageRedirectCount)},n.logHostClickTimeSqm=function(){if(this._documentLoadedTime&&this._hostClickTime&&!this._hostClickTimeReported&&(this._hostClickTimeReported=!0,!(this._hostClickTime>this._documentLoadedTime))){var e=this._documentLoadedTime-this._hostClickTime;0,E.AFrameworkApplication.theWsaClient.setDw(Wt,e),Ut.a.instance.recordUserClickedInHostUi(this._hostClickTime)}},n.logHostIFrameSqm=function(){if(this._documentLoadedTime&&this._hostIframeTime&&!this._hostIFrameTimeReported&&(this._hostIFrameTimeReported=!0,!(this._hostIframeTime>this._documentLoadedTime))){var e=this._documentLoadedTime-this._hostIframeTime;0,E.AFrameworkApplication.theWsaClient.setDw(jt,e),Ut.a.instance.recordWacIframeGeneratedInHost(this._hostIframeTime)}},n.reportBrowserFetchStartToLoadBsqm=function(){var e=bt.a.getWindowPerformanceTimingObject();if(e){var t=0,n=e.fetchStart;if(null!=n&&(t=n),!(t<=0||t>this._documentLoadedTime)){var i=this._documentLoadedTime-t;E.AFrameworkApplication.theWsaClient.setDw(Vt,i)}}},n.create=function(){E.AFrameworkApplication.isCrossDocumentMessengerDisabled&&this.disable(),this.targetOrigin!==Nt.a.anyDomain&&this.addAllowedOrigin(this.targetOrigin),this._actionManager.addActionWithFlags(ft.a.disposeCrossDocumentMessenger,Ct.a.frame,Object(r.d)(this,this.disposeInstance,"disposeInstance"),96),this.addAllowedReceivingMessage(Pt.a.blurFocus),this.addAllowedReceivingMessage(Pt.a.blur_Focus),this.addAllowedReceivingMessage(Pt.a.grabFocus),this.addAllowedReceivingMessage(Pt.a.grab_Focus),this.addAllowedReceivingMessage(Pt.a.hostPerfTiming),this.addAllowedReceivingMessage(Pt.a.hostRefreshSessionInfo),this.addAllowedReceivingMessage(Pt.a.appRefreshSessionInfo);var e=Object(r.d)(this,this.hostMessageHandler,"hostMessageHandler");if(this.registerEventCallback(Pt.a.blurFocus,e),this.registerEventCallback(Pt.a.blur_Focus,e),this.registerEventCallback(Pt.a.grabFocus,e),this.registerEventCallback(Pt.a.grab_Focus,e),this.registerEventCallback(Pt.a.hostPerfTiming,e),E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteEmbedUnloadIsEnabled")&&(this.addAllowedFreeReceivingMessage(Pt.a.wacBeforeUnloadApp),this.addAllowedFreeReceivingMessage(Pt.a.wacUnloadApp),this.registerEventCallback(Pt.a.wacBeforeUnloadApp,e),this.registerEventCallback(Pt.a.wacUnloadApp,e)),E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PostMessageEmbedded")||E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi")){this.addAllowedReceivingMessage(Pt.a.fileRename),this.addAllowedReceivingMessage(Pt.a.hostUnload),this.addAllowedReceivingMessage(Pt.a.moveToFolderResponse);var t=Object(r.d)(this,this.uiHostMessageHandler,"uiHostMessageHandler");this.registerCallback(Pt.a.fileRename,t),this.registerCallback(Pt.a.moveToFolderResponse,t),E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportsAccessibilityLoop")&&(this.addAllowedReceivingMessage(Pt.a.hostAccessibilityLoopComplete),this.registerCallback(Pt.a.hostAccessibilityLoopComplete,t)),this.registerCallback(Pt.a.hostUnload,t)}E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi")&&(this.addAllowedReceivingMessage(Pt.a.jsApiDiagnostics),this.registerEventCallback(Pt.a.jsApiDiagnostics,e))},n.disposeInstance=function(e,t,n,i,r){return 2!==n||Bt.a(this),32},n.reportDocumentLoadedTime=function(e){if(!this._hostDocumentLoadedTimeReported){var t;if(this._documentLoadedTime=e,this.reportBrowserFetchStartToLoadBsqm(),this.targetOrigin!==Nt.a.anyDomain)this.sendMessage(Pt.a.appLoadingStatus,((t={}).DocumentLoadedTime=e,t));this.logHostPerfSqm(),this._hostDocumentLoadedTimeReported=!0}},t}(Rt.a);Object(s.a)(Kt,"HostIntegrationMessenger",Rt.a,[60,61,4]);var zt=function(){this._messenger=null};function qt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Gt(e,t,n){return t&&qt(e.prototype,t),n&&qt(e,n),e}Object(s.a)(zt,"CrossDocumentMessengerDebugDialog",null,[67]);var Qt=function(){function e(){this._container=null}var t=e.prototype;return t.init=function(){var e=this;E.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e.initHostPostmessenger(e._container)}))},t.initHostPostmessenger=function(e){E.AFrameworkApplication.hostPostmessenger=e.resolve("Common.App.Postmessengers.HostIntegrationMessenger"),E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HostActionExecutionIsEnabled")&&e.resolve("Common.App.HostActionExecutionManager")},t.dispose=function(){},t.configure=function(e){this._container=e,e.register(Kt,"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").singleInstance().usingFactory((function(){E.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady||ae.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");var e=E.AFrameworkApplication.postMessageOrigin?E.AFrameworkApplication.postMessageOrigin:Nt.a.anyDomain;return new Kt(window.parent,e,Mt.a.instance,E.AFrameworkApplication.theActionManager)})),e.register(Ot,"Common.App.HostActionExecutionManager").singleInstance().usingFactory((function(){return E.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady||ae.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready"),new Ot(E.AFrameworkApplication.appSettingsManager,E.AFrameworkApplication.theActionManager,e.resolveFuture("Postmessage.IHostPostmessenger"))}))},Gt(e,[{key:"name",get:function(){return"Common.App.Postmessengers"}}]),e}();Object(s.a)(Qt,"PostmessengersPackage",null,[14,15]);var Zt=function(){Ae.a.instance.registerPackage(new Qt)},$t=function(){Type.registerNamespace("Common"),Zt()},Xt=n(358),Jt=function(){Type.registerNamespace("CAUI"),Xt.a.main()};function Yt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function en(e,t,n){return t&&Yt(e.prototype,t),n&&Yt(e,n),e}var tn=function(){function e(){}var t=e.prototype;return t.configure=function(e){},t.init=function(){},t.dispose=function(){},e.main=function(){Ae.a.instance.registerPackage(new e)},en(e,[{key:"name",get:function(){return"Common.App.DialogWithLinkToResource"}}]),e}();Object(s.a)(tn,"CommonAppDialogWithLinkToResourcePackage",null,[14,15]);var nn=function(){Type.registerNamespace("CADWLTR"),tn.main()},rn=n(361),an=function(){function e(){this._dialog=null}return e.prototype.create=function(e,t,n,i){return this._dialog=new rn.a(e,t,n,i),this._dialog},e}();function on(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sn(e,t,n){return t&&on(e.prototype,t),n&&on(e,n),e}Object(s.a)(an,"ZoomDialogFactory",null,[40]);var ln=function(){function e(){this._container=null}var t=e.prototype;return t.init=function(){},t.dispose=function(){},t.configure=function(e){this._container=e,this._container.register(an,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").usingFactory((function(){return new an})).singleInstance()},e.main=function(){Ae.a.instance.registerPackage(new e)},sn(e,[{key:"name",get:function(){return"Common.App.Zoom"}}]),e}();Object(s.a)(ln,"ZoomPackage",null,[14,15]);var cn=function(){Type.registerNamespace("Common.App.Zoom"),ln.main()},un=function(){Type.registerNamespace("DiagUse")},dn=n(58),pn=n(17),hn=n(102),mn=n(425),gn=n(7),fn=n(22),vn=n(316);function _n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=yn(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function yn(e,t){if(e){if("string"==typeof e)return bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bn(e,t):void 0}}function bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Sn(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Cn="PrintPDFLink",An="AllowBrowserClick",In=40,wn="DirectPrintPdfObject",Tn="DirectPrintHeader",En="DirectPrintHeaderContent",kn="DirectPrintPdfObjectHidden",Mn=function(e){function t(t,n,i,r){var a;return void 0===r&&(r=null),(a=e.call(this)||this)._failureLink=null,a._printPreviewPostForm=null,a._pdfObject=null,a._validElements=[],a._pdfUrl=n,a._mouseInputManager=t,a._hideEmbeddedPdf=i,a._sensitiveParameters=r,a._stopwatch=new vn.a("LoadResource","LoadPrintablePdf"),a}Sn(t,e);var n=t.prototype;return n.displayDialog=function(){this.buttonsOption=5,this.width=In;var e=document.createElement("span");e.id=this.myId(En);var t=document.createElement("span");if(t.innerText=CommonUIStrings.l_DirectPrintDialogHeader,Sys.UI.DomElement.addCssClass(t,Tn),this._pdfObject=document.createElement("iframe"),this._pdfObject.name="pdfObjectFrame",this._pdfObject.title=CommonUIStrings.l_DirectPrintDialogIFrame,this._pdfObject.onload=Object(r.d)(this,this.printablePdfLoaded,"printablePdfLoaded"),this._sensitiveParameters&&this._sensitiveParameters.get_count()>0){var n=ie.a.getParametersFromUrl(this._pdfUrl,this._sensitiveParameters),i=ie.a.removeParameters(this._pdfUrl,this._sensitiveParameters);this._printPreviewPostForm=document.createElement("form"),this._printPreviewPostForm.id="printPreviewPostForm",this._printPreviewPostForm.method="POST",this._printPreviewPostForm.target=this._pdfObject.name,this._printPreviewPostForm.action=i;for(var a,o=_n(n);!(a=o()).done;){var s=a.value,l=document.createElement("input");l.type="hidden",l.name=s.get_key(),l.value=s.get_value(),this._printPreviewPostForm.appendChild(l)}}else this._pdfObject.setAttribute("src",this._pdfUrl);Sys.UI.DomElement.addCssClass(this._pdfObject,hn.a._objectInDialogCssClass),this._hideEmbeddedPdf?(Sys.UI.DomElement.addCssClass(this._pdfObject,kn),t.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,gn.a.setAriaAttribute(this._pdfObject,gn.a.ariaHiddenAttribute,gn.a.ariaTrueValue)):(Sys.UI.DomElement.addCssClass(this._pdfObject,wn),this._validElements.push(this._pdfObject)),e.appendChild(t),e.appendChild(document.createElement("br")),e.appendChild(this._pdfObject),this._printPreviewPostForm&&e.appendChild(this._printPreviewPostForm),e.appendChild(document.createElement("br")),e.appendChild(this.constructDownloadSpan(this._printPreviewPostForm?"#":this._pdfUrl)),this._stopwatch.start(),this.messageBoxImpl(CommonUIStrings.l_AppTitle,null,null,null,null,e),this.setDescribedByForDialog(this.myId(En)),this._printPreviewPostForm&&this._printPreviewPostForm.submit(),this.createFocusLoop(),ae.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")},n.constructDownloadSpan=function(e){var t=document.createElement("span"),n=document.createElement("span");if(n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader,t.appendChild(n),E.AFrameworkApplication.appSettingsManager&&(2===E.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PPTDisableDirectPrintDialogDownloadPDFLink")||1===E.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("XLODisableDirectPrintDialogOpenPDFLink"))){var i=document.createElement("span");2===E.AFrameworkApplication.activeFrame.applicationInstance.officeAppType?i.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===E.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&(i.innerText=CommonUIStrings.l_InternalError_Directive,ae.ULS.sendTraceTag(573691527,328,15,"Hyperlink removed from DirectPrintDialog in XLO.")),this._failureLink=i,t.appendChild(document.createElement("br")),t.appendChild(i)}else{var a=document.createElement("a");a.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,a.href=e,a.target="_blank",a.id=Cn,a.className=An,this._failureLink=a,t.appendChild(document.createElement("br")),t.appendChild(a),this._printPreviewPostForm&&pn.a.addHandler(a,"click",Object(r.d)(this,this.onSubmit,"onSubmit")),this._mouseInputManager.registerHandler(et.EventNames.click,this._failureLink,Object(r.d)(this,this.downloadPDFLinkClicked,"downloadPDFLinkClicked"),null)}return this._validElements.push(this._failureLink),t},n.onSubmit=function(e){this._printPreviewPostForm&&(this._printPreviewPostForm.target="_blank",this._printPreviewPostForm.submit()),e.preventDefault()},n.createFocusLoop=function(){if(this._validElements.length>0){var e=new mn.a(this._validElements),t=xt.FocusManager.instance().getCurrentRegion();t&&(this._failureLink.focus(),t.listing=e,t.looped=!0)}},n.downloadPDFLinkClicked=function(e){return ae.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked."),!1},n.logDownloadButtonClicked=function(){ae.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")},n.printablePdfLoaded=function(){ae.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully"),this._stopwatch&&this._stopwatch.stop()},n.dispose=function(){this._failureLink&&(this._mouseInputManager.unregisterHandler(et.EventNames.click,this._failureLink,Object(r.d)(this,this.downloadPDFLinkClicked,"downloadPDFLinkClicked")),this._failureLink=null),fn.DomUtils.removeElement(this._pdfObject),this._pdfObject=null,e.prototype.dispose.call(this)},t}(dn.StandardDialog);Object(s.a)(Mn,"DirectPrintDialog",dn.StandardDialog,[76]);var Pn=function(){function e(e){this._mouseInputManager=e}return e.prototype.getDirectPrintDialog=function(e,t,n){return void 0===n&&(n=null),new Mn(this._mouseInputManager,e,t,n)},e}();Object(s.a)(Pn,"DirectPrintDialogFactory",null,[59]);var Fn=n(226),Dn=function e(t){this.isEnabled=Boolean.parse(t.DirectPrintIsEnabled||"false"),this.isProbeEnabled=Boolean.parse(t.DirectPrintProbeIsEnabled||"false"),this.isInternetExplorerEnabled=Boolean.parse(t.DirectPrintEnabledForInternetExplorer||"false"),this.supportedMimeTypes=(t.DirectPrintSupportedMimeTypes||"").split(e.directPrintBRSDelimeter),this.supportedPlugins=(t.DirectPrintSupportedPlugins||"").split(e.directPrintBRSDelimeter),this.immersivePreviewPlugins=(t.DirectPrintImmersivePreviewPlugins||"").split(e.directPrintBRSDelimeter),this.isEdgeEnabled=Boolean.parse(t.DirectPrintEnabledForEdge||"false"),this.isChromePrintLayoutFixEnabled=Boolean.parse(t.ChromePrintLayoutFixIsEnabled||"false"),this.chromeVersionFromWhichPrintLayoutIsEnabled=parseInt(t.ChromeVersionFromWhichPrintLayoutIsEnabled||"76"),this.minEdgeMajorVersion=14,this.minEdgeMinorVersion=14394;var n=t.DirectPrintMinimalSupportedEdgeVersion;if(n){var i=n.split(".");2===i.length?(this.minEdgeMajorVersion=parseInt(i[0]),this.minEdgeMinorVersion=parseInt(i[1])):ae.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",n)}else ae.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")};Dn.directPrintBRSDelimeter=",",Object(s.a)(Dn,"DirectPrintBrsSettings",null,[]);var On=function(e,t){this.supportedMimetypes=e,this.supportedPlugins=t};Object(s.a)(On,"DirectPrintProbeResults",null,[]);var Rn=n(242),xn=n(10),Un=n(76),Bn=n(101);function Ln(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Nn(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Nn(e,t){if(e){if("string"==typeof e)return Hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hn(e,t):void 0}}function Hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Wn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jn(e,t,n){return t&&Wn(e.prototype,t),n&&Wn(e,n),e}var Vn=function(){function e(e,t,n,i,a,o,s,l,c,u){this._useNamedActionForAutoPrint=null,this._directPrintSettings=e,this._navigatorMimeTypes=t,this._navigatorPlugins=n,this._isEnabledMimeType=i,this._isSupportedActiveXControl=a,this._probeResults=new Bn.a(Object(r.d)(this,this.getProbeResults,"getProbeResults")),this._dialogFactory=o,this._legacyDialogFactory=c,this._stopWatchBuilder=s,this._isSupportedBrowser=l,this._isWordEmbeddedPreview=u}var t=e.prototype;return t.start=function(){},t.probeDirectPrintExperience=function(){this.directPrintSettings.isProbeEnabled&&this.logProbeResults()},t.querySupportedMimeTypes=function(){var e=new Array(this.directPrintSettings.supportedMimeTypes.length);if(!(void 0===this._navigatorMimeTypes||null===this._navigatorMimeTypes))for(var t=0;t<this.directPrintSettings.supportedMimeTypes.length;t++)e[t]=this.directPrintSettings.supportedMimeTypes[t]in this._navigatorMimeTypes&&this._isEnabledMimeType(this._navigatorMimeTypes[this.directPrintSettings.supportedMimeTypes[t]]);return e},t.querySupportedPlugins=function(){for(var e=new Array(this.directPrintSettings.supportedPlugins.length),t=!(void 0===this._navigatorPlugins||null===this._navigatorPlugins),n=0;n<this.directPrintSettings.supportedPlugins.length;n++){var i=this.directPrintSettings.supportedPlugins[n];t&&i in this._navigatorPlugins?e[n]=!0:e[n]=this._isSupportedActiveXControl(i)}return e},t.getSupportedMimeTypePluginNames=function(){for(var e=this.querySupportedMimeTypes(),t=new Array(e.length),n=0;n<e.length;n++)e[n]?t[n]=this.extractPluginNameFromMimeType(this._navigatorMimeTypes[this.directPrintSettings.supportedMimeTypes[n]]):t[n]=null;return t},t.extractPluginNameFromMimeType=function(e){if(null==e)return null;var t=e.enabledPlugin;return null==t?null:t.name},t.logProbeResults=function(){ae.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this._probeResults.value.supportedMimetypes,this._probeResults.value.supportedPlugins)},t.getProbeResults=function(){for(var e=this.getSupportedMimeTypePluginNames(),t=this.querySupportedPlugins(),n={},i={},r=0;r<this.directPrintSettings.supportedMimeTypes.length;r++)n[this.directPrintSettings.supportedMimeTypes[r]]=e[r];for(var a=0;a<this.directPrintSettings.supportedPlugins.length;a++)i[this.directPrintSettings.supportedPlugins[a]]=t[a];return new On(n,i)},t.shouldUseDirectPrint=function(){return!this._isWordEmbeddedPreview&&(!!this.directPrintSettings.isEnabled&&this.supportPluginPrint())},t.shouldUseNamedAction=function(){if(null!=this._useNamedActionForAutoPrint)return this._useNamedActionForAutoPrint;var t=e.isEdgeAndContainsPrintLayoutFix(this.directPrintSettings);return this._useNamedActionForAutoPrint=this.directPrintSettings.isEdgeEnabled&&t||this.isChromeAndContainsPrintLayoutFix(),this._useNamedActionForAutoPrint},t.isChromeAndContainsPrintLayoutFix=function(){return!!(xn.a.isChrome&&this.directPrintSettings.isChromePrintLayoutFixEnabled&&xn.a.chromeRevision>=this.directPrintSettings.chromeVersionFromWhichPrintLayoutIsEnabled)},t.supportPluginPrint=function(){if(!this._isSupportedBrowser(this.directPrintSettings))return!1;for(var e,t=Ln(Un.e(this._probeResults.value.supportedMimetypes));!(e=t()).done;){var n=e.value;if(null!=n)return!0}for(var i,r=Ln(Un.e(this._probeResults.value.supportedPlugins));!(i=r()).done;){if(i.value)return!0}return!1},t.hasImmersiveViewer=function(){for(var e,t=Ln(Un.e(this._probeResults.value.supportedMimetypes));!(e=t()).done;){var n=e.value;if(Rn.b(this.directPrintSettings.immersivePreviewPlugins,n))return!0}return!1},t.showPrintDialog=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=null),E.AFrameworkApplication.activeFrame&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")?this._legacyDialogFactory(e,n):this.shouldUseDirectPrint()?this.displayDirectPrintDialog(e,this.hasImmersiveViewer()&&!t,n):this._legacyDialogFactory(e,n)},t.displayDirectPrintDialog=function(e,t,n){void 0===n&&(n=null);var i=this._stopWatchBuilder.makeAndStartStopwatch("UserAction","OpenDirectPrintDialog");this._dialogFactory.getDirectPrintDialog(e,t,n).displayDialog(),i.stop()},e.isSupportedActiveXControl=function(e){try{return new ActiveXObject(e),!0}catch(t){ae.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",e)}return!1},e.isEnabledMimeType=function(e){return null!=e&&!(void 0===e.enabledPlugin||null===e.enabledPlugin)},e.create=function(t){var n=new Dn(E.AFrameworkApplication.appSettingsManager.appSettings),i=null;try{i=window.navigator.mimeTypes}catch(e){ae.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var r=null;try{r=window.navigator.plugins}catch(e){ae.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}return new e(n,i,r,e.isEnabledMimeType,e.isSupportedActiveXControl,t.resolve("Common.App.DirectPrint.DirectPrintDialogFactory"),E.AFrameworkApplication.activeFrame.theStopwatchBuilder,e.isSupportedBrowserCheck,(function(e,t){return new Fn.a(e,!1,t)}),E.AFrameworkApplication.isEmbedded)},e.isSupportedBrowserCheck=function(t){return!!xn.a.isChrome||(!(!xn.a.isInternetExplorerNonEdge||!t.isInternetExplorerEnabled)||!(!t.isEdgeEnabled||!e.isEdgeAndContainsPrintLayoutFix(t)))},e.isEdgeAndContainsPrintLayoutFix=function(e){var t=xn.a.edgeVersion;if(t){var n=t.split(".");if(2===n.length){var i=parseInt(n[0]),r=parseInt(n[1]);return i>e.minEdgeMajorVersion||i===e.minEdgeMajorVersion&&r>=e.minEdgeMinorVersion}}return!1},jn(e,[{key:"directPrintSettings",get:function(){return this._directPrintSettings}}]),e}();function Kn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zn(e,t,n){return t&&Kn(e.prototype,t),n&&Kn(e,n),e}Object(s.a)(Vn,"DirectPrintManager",null,[41]);var qn=function(){function e(){this._container=null,this._directPrintManager=null}var t=e.prototype;return t.configure=function(e){var t=this;this._container=e,e.register(Pn,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().usingFactory((function(){return new Pn(E.AFrameworkApplication.activeFrame.theMouseInputManager)})),e.register(41,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().usingFactory((function(){return Vn.create(t._container)}))},t.init=function(){this._directPrintManager=this._container.resolve("Common.App.DirectPrint.IDirectPrintManager"),this._directPrintManager.start()},t.dispose=function(){},zn(e,[{key:"name",get:function(){return"Common.App.DirectPrint"}}]),e}();Object(s.a)(qn,"PackageManager",null,[14,15]);var Gn=function(){Ae.a.instance.registerPackage(new qn)},Qn=function(){Type.registerNamespace("Common.App.DirectPrint"),Gn()},Zn=function(){Type.registerNamespace("DiagUse")},$n=function(){Type.registerNamespace("Common.App.SafeLinks")},Xn=function(){Type.registerNamespace("Common.App.Policy.Contracts")},Jn=function(){Type.registerNamespace("Common.App.LearningTools")},Yn=window.dynamicScriptLoaderDependencies=[{identifier:"appChrome",dependencies:["appResourceLoader","common"]},{identifier:"appResourceLoader",dependencies:[]},{identifier:"sharedComments",dependencies:["appResourceLoader","common","common50","comment-pane-strings"]},{identifier:"editorSettingsManager",dependencies:["appResourceLoader","common","common50"]},{identifier:"catchUpActivity",dependencies:["appResourceLoader","common","common50","word-catchup-activity-intl"]},{identifier:"alVoiceClient",dependencies:["appResourceLoader","common"]},{identifier:"previewPanel",dependencies:["appResourceLoader","common","common50","word-preview-panel-intl"]},{identifier:"versionHistory",dependencies:["appResourceLoader","common","common50","office-version-history-strings","friendly-dates-strings","version-history-sprite"]},{identifier:"wordVersionHistory",dependencies:["appResourceLoader","common","common50","versionHistory","pdfjsWorker"]},{identifier:"floatingContainerManager",dependencies:["appResourceLoader","common","common50"]},{identifier:"canvasAtMentions",dependencies:["appResourceLoader","common","common50","comment-pane-strings","uiFabricLazy"]},{identifier:"canvasContextual",dependencies:["appResourceLoader","common","common50","uiFabricLazy"]},{identifier:"performanceMeasureAggregator",dependencies:["appResourceLoader"]},{identifier:"iePolyfills",dependencies:["appResourceLoader"]},{identifier:"comment-pane-strings",isLocalized:!0},{identifier:"word-catchup-activity-intl",isLocalized:!0},{identifier:"word-preview-panel-intl",isLocalized:!0},{identifier:"office-version-history-strings",isLocalized:!0},{identifier:"accessibility-checker-pane-strings",isLocalized:!0},{identifier:"friendly-dates-strings",isLocalized:!0},{identifier:"version-history-sprite",isLocalized:!0},{identifier:"dictation-intl",isLocalized:!0},{identifier:"tellme-strings",isLocalized:!0},{identifier:"graphics-editor-intl",isLocalized:!0},{identifier:"graphics-editor-intl-lazy",isLocalized:!0},{identifier:"word-app-intl-lazy",isLocalized:!0},{identifier:"word-app-intl-mlr-lazy",isLocalized:!0},{identifier:"word-app-sprite",isLocalized:!0},{identifier:"word-app-mlr-sprite",isLocalized:!0},{identifier:"word-app-sprite-lazy",isLocalized:!0},{identifier:"word-app-mlr-sprite-lazy",isLocalized:!0},{identifier:"word-ideas-strings",isLocalized:!0}],ei=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./lib/index.js")}({"../../node_modules/toposort/index.js":
/*!****************************************************!*\
  !*** C:/_work/13/s/node_modules/toposort/index.js ***!
  \****************************************************/
/*! no static exports found */
function(e,t){function n(e,t){for(var n=e.length,i=new Array(n),r={},a=n;a--;)r[a]||o(e[a],a,[]);return i;function o(a,s,l){if(l.indexOf(a)>=0){var c;try{c=", node was:"+JSON.stringify(a)}catch(e){c=""}throw new Error("Cyclic dependency"+c)}if(!~e.indexOf(a))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(a));if(!r[s]){r[s]=!0;var u=t.filter((function(e){return e[0]===a}));if(s=u.length){var d=l.concat(a);do{var p=u[--s][1];o(p,e.indexOf(p),d)}while(s)}i[--n]=a}}}e.exports=function(e){return n(function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];t.indexOf(r[0])<0&&t.push(r[0]),t.indexOf(r[1])<0&&t.push(r[1])}return t}(e),e)},e.exports.array=n},"./lib/DynamicScriptLoader.js":
/*!************************************!*\
  !*** ./lib/DynamicScriptLoader.js ***!
  \************************************/
/*! no static exports found */
function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(
/*! ./getOrderedScriptAndDependencies */
"./lib/getOrderedScriptAndDependencies.js"),r=n(
/*! ./loadScript */
"./lib/loadScript.js"),a=n(
/*! ./preloadScript */
"./lib/preloadScript.js"),o=function(){function e(e){var t=this;this.config=e,this.requestedScripts=new Map,this.knownScriptMap=new Map,this.retryScriptsMap=new Map,this.loadScript=function(e){var n=t.config,a=n.crossOriginAttributeValue,o=n.loadScriptHandler,s=n.loadScriptWithRetryHandler,l=i.getOrderedScriptAndDependencies(e,t.knownScriptMap),c=l.map((function(e){var n=t.requestedScripts.get(e);return n||(n=(s||o||r.loadScript)(e,t.getUrlFromScriptIdentifier(e),a,void 0,void 0,t.getSriHashFromScriptIdentifier(e)),t.requestedScripts.set(e,n)),n}));return t.config.isRetryEnabled?Promise.all(c).then((function(){return e}),(function(){return l.forEach((function(e,n){var i=t.retryScriptsMap.get(e);i||(i=(n>0?t.retryScriptsMap.get(l[n-1]):Promise.resolve()).then((function(){return(s||o||r.loadScript)(e,t.getUrlFromScriptIdentifier(e),a,5,!0,t.getSriHashFromScriptIdentifier(e))})),t.retryScriptsMap.set(e,i))})),t.retryScriptsMap.get(l[l.length-1]).then((function(){return e}))})):Promise.all(c).then((function(){return e}))},this.preloadScript=function(e){i.getOrderedScriptAndDependencies(e,t.knownScriptMap).forEach((function(e){return a.preloadScript(t.getUrlFromScriptIdentifier(e),t.config.crossOriginAttributeValue)}))},e.knownScripts&&e.knownScripts.forEach((function(e){var n=e.identifier.toLowerCase();if(t.knownScriptMap.has(n))throw new Error("The knownScripts passed into the DynamicScriptLoader config contains multiple entries for the script with identifier: "+n);t.knownScriptMap.set(n,e)}))}return e.prototype.getSriHashFromScriptIdentifier=function(e){var t=this.knownScriptMap.get(e)||{identifier:e};return this.config.resolveSriHash?this.config.resolveSriHash(t):""},e.prototype.getUrlFromScriptIdentifier=function(e){var t=this.knownScriptMap.get(e)||{identifier:e};return this.config.resolveScript(t)},e}();t.DynamicScriptLoader=o},"./lib/getOrderedScriptAndDependencies.js":
/*!************************************************!*\
  !*** ./lib/getOrderedScriptAndDependencies.js ***!
  \************************************************/
/*! no static exports found */
function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(
/*! toposort */
"../../node_modules/toposort/index.js");t.getOrderedScriptAndDependencies=function(e,t){for(var n=new Set,r=[e.toLowerCase()],a=[],o=function(){var e=r.shift();n.add(e);var i=t.get(e);i&&i.dependencies&&i.dependencies.forEach((function(t){var i=t.toLowerCase();n.has(i)||r.push(i),a.push([i,e])}))};r.length>0;)o();var s=[];return n.forEach((function(e){return s.push(e)})),i.array(s,a)}},"./lib/index.js":
/*!**********************!*\
  !*** ./lib/index.js ***!
  \**********************/
/*! no static exports found */
function(e,t,n){function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(
/*! ./DynamicScriptLoader */
"./lib/DynamicScriptLoader.js")),i(n(
/*! ./loadScript */
"./lib/loadScript.js")),i(n(
/*! ./preloadScript */
"./lib/preloadScript.js"))},"./lib/loadScript.js":
/*!***************************!*\
  !*** ./lib/loadScript.js ***!
  \***************************/
/*! no static exports found */
function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.loadScript=function(e,t,n,i,r,a){return function e(t,n,i,r,a,o,s){return new Promise((function(l,c){var u=document.createElement("script");u.async=!1,u.src=n,void 0!==i&&(u.crossOrigin=i),a&&""!==a&&(u.setAttribute("integrity","sha256-"+a),i||(u.crossOrigin="anonymous")),u.onload=function(){o?o(t):l(t)},u.onerror=function(){if(r&&r>0)document.head.removeChild(u),e(t,n,i,r-1,a,o||l,s||c);else{var d=new Error("Failed to download the script with identifier: "+t+" at url: "+n);s?s(d):c(d)}},document.head.appendChild(u)}))}(e,t+(r?"?cache-bust=true":""),n,i,a)}},"./lib/preloadScript.js":
/*!******************************!*\
  !*** ./lib/preloadScript.js ***!
  \******************************/
/*! no static exports found */
function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.preloadScript=function(e,t){var n=document.createElement("link");n.rel="preload",n.href=e,n.setAttribute("as","script"),void 0!==t&&(n.crossOrigin=t),document.head.appendChild(n)}}}),ti=n(106),ni=n(143),ii=function(e){var t=e.isLocalized?ni.a.getLocalizationPath(E.AFrameworkApplication.lcid):ni.a.scriptPath;return e.isLocalized||!E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExperimentalBundleIsEnabled")&&!E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")||(t+="exp/"),t+e.identifier+ni.a.fileSuffix+".js"},ri=function(e,t){var n,i=E.AFrameworkApplication.staticContentScriptNameBase;return e.isLocalized?i+=E.AFrameworkApplication.lcid+"/":(E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExperimentalBundleIsEnabled")||t&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled"))&&(i+="exp/"),n=".min",i+e.identifier+n+".js"},ai=function(e,t){var n;n=".min";var i=e.identifier+n+".js",r="";return e.isLocalized?r+=E.AFrameworkApplication.lcid+"/":(E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExperimentalBundleIsEnabled")||t&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled"))&&(r+="exp/"),r+i},oi=function(e,t){if(ti.a.instance.isEnabled){var n=ai(e,t);return ti.a.instance.getSriHash(E.AFrameworkApplication.scriptFolderPath+n)}return null},si=function(e,t){var n=E.AFrameworkApplication.staticContentScriptNameBase,i=ai(e,t);if(ti.a.instance.isEnabled){var r=ti.a.instance.getHashedAppResourceHost(E.AFrameworkApplication.scriptFolderPath+i);r&&(n=r+E.AFrameworkApplication.scriptFolderPath)}return ae.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+i),n+i},li=function(e,t){void 0===e&&(e="anonymous"),void 0===t&&(t="dynamicScriptLoaderDependencies");var n={resolveScript:function(e){var t=ni.a.isKnownScript(n.knownScripts,e.identifier);return ni.a.isEnabled&&t?ii(e):ti.a.instance.isEnabled?si(e,t):ri(e,t)},resolveSriHash:function(e){var t=ni.a.isKnownScript(n.knownScripts,e.identifier);return oi(e,t)}};return n.crossOriginAttributeValue=e,n.knownScripts=window[E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExperimentalBundleIsEnabled")?"dynamicScriptLoaderDependenciesExperimental":t],n},ci=function(){function e(e){this._dynamicScriptLoader=e}return e.prototype.getScriptLoader=function(){return this._dynamicScriptLoader},e}();function ui(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function di(e,t,n){return t&&ui(e.prototype,t),n&&ui(e,n),e}Object(s.a)(ci,"DynamicScriptLoaderProvider",null,[25]);var pi=function(){function e(){this._container=null}var t=e.prototype;return t.configure=function(e){this._container=e;var t=li();e.register(ci,"Common.DynamicScriptLoaderProvider").as("Common.IDynamicScriptLoaderProvider").singleInstance().usingFactory((function(){return new ci(new dynamicScriptLoader.DynamicScriptLoader(t))}))},t.init=function(){},t.dispose=function(){},di(e,[{key:"name",get:function(){return"WordViewer.DynamicScriptLoader"}}]),e}();Object(s.a)(pi,"DynamicScriptLoaderPackage",null,[14,15]);var hi,mi=function(){Ae.a.instance.registerPackage(new pi)},gi=function(){Type.registerNamespace("Fdbk")},fi=[{CampaignId:"2df03896-1257-4681-a7f6-1e241349f1f5",StartTimeUtc:"2018-06-18T00:00:00Z",EndTimeUtc:"2018-12-31T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AtMentionDeepLink",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"AtMentionFS_PromptTitle",Question:"AtMentionFS_PromptQuestion",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"AtMentionFS_RatingQuestion",RatingValuesAscending:["AtMentionFS_RaitingValue_1","AtMentionFS_RaitingValue_2","AtMentionFS_RaitingValue_3","AtMentionFS_RaitingValue_4","AtMentionFS_RaitingValue_5"]},Question:{Question:"AtMentionFS_Question"}}}},{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customux",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPSOneClick",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageNPSOneClickTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_OneClickPromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_OneClickRating_Values_1","nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",LauncherType:"customux",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:8,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WebSuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"WebSuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2020-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2","VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"0d13dbe1-af04-49d1-84a8-624706f4293f",StartTimeUtc:"2019-04-08T00:00:00Z",EndTimeUtc:"2019-07-08T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"HasSeenDesigner",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"We'd love your feedback on PowerPoint Design Ideas",Question:"We have just 2 questions",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall, how do you feel while using Design Ideas?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Why did you choose that answer?"}}}},{CampaignId:"b915b0e8-f0ff-4e44-8b29-19e9ab1983bc",StartTimeUtc:"2019-09-03T00:00:00Z",EndTimeUtc:"2020-04-03T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PresenceBubbleRendered",IsAggregate:!1,Count:3}]},Content:{Prompt:{Title:"We would love your feedback about working with others in PowerPoint on the web",Question:"We have one question for you about the experience.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with how other people appear in the file?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us more about why you chose this rating."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2021-10-13T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"91d835f4-cd27-49bc-b86b-909703fcaba5",StartTimeUtc:"2020-06-05T00:00:00Z",EndTimeUtc:"2020-12-31T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office_Docs_SharedComments_CommitComment",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"AtMentionFPS_Title",Question:"AtMentionFPS_Question",YesLabel:"AtMentionFPS_YesLabel",NoLabel:"AtMentionFPS_NoLabel"},Rating:{Question:"AtMentionFPS_RatingQuestion",RatingValuesAscending:["AtMentionFPS_RatingValue_1","AtMentionFPS_RatingValue_2","AtMentionFPS_RatingValue_3","AtMentionFPS_RatingValue_4","AtMentionFPS_RatingValue_5"]},Question:{Question:"AtMentionFPS_WhyQuestion"}}}},{CampaignId:"ed3f617b-ca66-48ff-8b98-2f6a1435a01e",StartTimeUtc:"2019-12-20T00:00:00Z",EndTimeUtc:"2020-03-18T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"We'd love your feedback on Comments in PowerPoint.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall how do you feel while using Comments in PowerPoint?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us more. Why did you choose that answer?"}}}},{CampaignId:"59857ee9-c113-46fc-9ec1-e9674870b839",StartTimeUtc:"2020-02-01T00:00:00Z",EndTimeUtc:"2020-08-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebLivePresentationsActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on the PowerPoint Live experience.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the latest Live Presentation?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-31-08T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"21e37f3e-5605-443b-9ecd-243654ed0685",StartTimeUtc:"2020-09-02T00:00:00Z",EndTimeUtc:"2021-03-25T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"UIHostActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"UIHost_Title",Question:"UIHost_PromptQuestion",YesLabel:"UIHost_Sure",NoLabel:"UIHost_NotNow"},Rating:{Question:"UIHost_RatingQuestion",RatingValuesAscending:["UIHost_Rating_Values_1","UIHost_Rating_Values_2","UIHost_Rating_Values_3","UIHost_Rating_Values_4","UIHost_Rating_Values_5"]},Question:{Question:"UIHost_WhyQuestion"}}}},{CampaignId:"75d96c7f-b807-4630-87b4-ebee0b311eac",StartTimeUtc:"2020-11-20T00:00:00Z",EndTimeUtc:"2021-03-25T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"UIHostOfficeComActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"UIHostOfficeCom_Title",Question:"UIHostOfficeCom_PromptQuestion",YesLabel:"UIHostOfficeCom_Sure",NoLabel:"UIHostOfficeCom_NotNow"},Rating:{Question:"UIHostOfficeCom_RatingQuestion",RatingValuesAscending:["UIHostOfficeCom_Rating_Values_1","UIHostOfficeCom_Rating_Values_2","UIHostOfficeCom_Rating_Values_3","UIHostOfficeCom_Rating_Values_4","UIHostOfficeCom_Rating_Values_5"]},Question:{Question:"UIHostOfficeCom_WhyQuestion"}}}},{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-02-28T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}}],vi=[{CampaignId:"bb3ef5aa-e2a4-4ca2-b268-7d8177571479",StartTimeUtc:"2018-09-12T00:00:00Z",EndTimeUtc:"2019-12-29T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CreateUsingOnlineTemplate",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"We'd love your feedback on Visio Diagrams!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate us on how well are the diagrams provided by Visio satisfying your requirements.",RatingValuesAscending:["1- Very Unsatisfied","2","3","4","5- Very Satisfied"]},Question:{Question:"Please describe what other diagram types you would like to create in Visio for web."}}}},{CampaignId:"57fe6b60-8573-4597-b970-5502bda91735",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2020-02-29T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CFFused",IsAggregate:!0,Count:10}]},Content:{Prompt:{Title:"We'd love your feedback on cross-functional flowcharts in Visio!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience.",RatingValuesAscending:["1- Poor","2","3","4","5- Excellent"]},Question:{Question:"Please describe what you liked or would improve about cross-functional flowcharts."}}}},{CampaignId:"f3c27b06-f784-4368-9e19-a5671ef875b6",StartTimeUtc:"2020-02-07T00:00:00Z",EndTimeUtc:"2020-05-06T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Collabused",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"collab_Title_Visio",Question:"collab_Prompt_Question_Visio",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"collab_RatingQuestion_Visio",RatingValuesAscending:["collab_Rating_Values_1","collab_Rating_Values_2","collab_Rating_Values_3","collab_Rating_Values_4","collab_Rating_Values_5"]},Question:{Question:"collab_Question_Visio"}}}},{CampaignId:"e195e5f6-8aca-4856-839a-3b56de5c6674",StartTimeUtc:"2019-07-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:40,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VisioAppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"VisioAppUsageNPSFollowUpActivity",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_Visio",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"5cac8fe8-9e25-4e39-ad63-90524d42637a",StartTimeUtc:"2020-02-10T00:00:00Z",EndTimeUtc:"2020-06-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CustomConnectorsUsed",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"connector_campaign_Title",Question:"connector_campaign_Prompt_Question",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"connector_campaign_Survey_Question",RatingValuesAscending:["connector_campaign_Rating_Values_1","connector_campaign_Rating_Values_2","connector_campaign_Rating_Values_3","connector_campaign_Rating_Values_4","connector_campaign_Rating_Values_5"]},Question:{Question:"connector_campaign_Verbatim_Question"}}}},{CampaignId:"a927d4b3-64cc-4054-b285-535746125b7a",StartTimeUtc:"2020-06-01T00:00:00Z",EndTimeUtc:"2020-12-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"DownloadAsImageUsed",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Download_as_Image_Title",Question:"Download_as_Image_Prompt_Question",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Download_as_Image_Rating_Question",RatingValuesAscending:["Download_as_Image_Rating_Values_1","Download_as_Image_Rating_Values_2","Download_as_Image_Rating_Values_3","Download_as_Image_Rating_Values_4","Download_as_Image_Rating_Values_5"]},Question:{Question:"Download_as_Image_Question"}}}},{CampaignId:"760f14a5-d9de-43f4-91f7-db911a0fe5c0",StartTimeUtc:"2020-08-13T00:00:00Z",EndTimeUtc:"2021-05-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SoftwareITUsed",IsAggregate:!0,Count:10}]},Content:{Prompt:{Title:"SoftwareITDiagrams_Title",Question:"SoftwareITDiagrams_Prompt_Question",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"SoftwareITDiagrams_Survey_Question",RatingValuesAscending:["SoftwareITDiagrams_Rating_Values_1","SoftwareITDiagrams_Rating_Values_2","SoftwareITDiagrams_Rating_Values_3","SoftwareITDiagrams_Rating_Values_4","SoftwareITDiagrams_Rating_Values_5"]},Question:{Question:"SofwareITDiagrams_Question"}}}}],_i=[{CampaignId:"2df03896-1257-4681-a7f6-1e241349f1f5",StartTimeUtc:"2018-06-18T00:00:00Z",EndTimeUtc:"2019-06-30T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AtMentionDeepLink",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"AtMentionFS_PromptTitle",Question:"AtMentionFS_PromptQuestion",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"AtMentionFS_RatingQuestion",RatingValuesAscending:["AtMentionFS_RaitingValue_1","AtMentionFS_RaitingValue_2","AtMentionFS_RaitingValue_3","AtMentionFS_RaitingValue_4","AtMentionFS_RaitingValue_5"]},Question:{Question:"AtMentionFS_Question"}}}},{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customux",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:8,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPSOneClick",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageNPSOneClickTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_OneClickPromptQuestion_Excel",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_OneClickRatingQuestion_Excel",RatingValuesAscending:["nps_OneClickRating_Values_1","nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",LauncherType:"customux",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:28,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_Excel",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"95e3afa4-6f57-42e8-9750-86add4f45573",StartTimeUtc:"2018-11-15T00:00:00Z",EndTimeUtc:"2019-12-29T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SLROptOut",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on the web version of Excel's Simplified Ribbon!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall, how satisfied were you with it?",RatingValuesAscending:["1 - Very dissatisfied","2 - Somewhat dissatisfied","3 - Neutral","4 - Somewhat satisfied","5 - Very satisfied"]},Question:{Question:"Why did you turn off the Simplified Ribbon?"}}}},{CampaignId:"c3898ba1-939b-4d4e-adf2-1d07caf2328d",StartTimeUtc:"2018-11-15T00:00:00Z",EndTimeUtc:"2019-12-29T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SLRCommandUsed",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"We'd love your feedback on the web version of Excel's Simplified Ribbon!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall how do you feel while using the Simplified Ribbon at the top?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Tell us more about why you chose this answer"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-01-28T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthOccurred",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in Excel on the web.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"b915b0e8-f0ff-4e44-8b29-19e9ab1983bc",StartTimeUtc:"2019-01-15T00:00:00Z",EndTimeUtc:"2019-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultiUserPresenceOccurred",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"We would love your feedback about working with others in Excel on the web",Question:"We have one question for you about the experience.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with how other people appear in the file?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor satisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us more about why you chose this rating."}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2021-03-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2020-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2","VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2020-10-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"LinkedIn_Title",Question:"LinkedIn_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Excel_LinkedIn_RatingQuestion",RatingValuesAscending:["LinkedIn_Rating_Values_1","LinkedIn_Rating_Values_2","LinkedIn_Rating_Values_3","LinkedIn_Rating_Values_4","LinkedIn_Rating_Values_5"]},Question:{Question:"LinkedIn_QuestionQuestion"}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"}}}},{CampaignId:"93b605bc-bb75-4163-9006-3e223188b16d",StartTimeUtc:"2019-05-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:1209600},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"NamedSheetViewFeedback",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"NSV_Prompt_Title_Feedback",Question:"NSVPromptQuestion",YesLabel:"L_WAC_GenericSurvey_SureLabel",NoLabel:"L_WAC_GenericSurvey_NoLabel"},Rating:{Question:"NSVTimedSurvey_Question",RatingValuesAscending:["SatisfactionRating_1","SatisfactionRating_2","SatisfactionRating_3","SatisfactionRating_4","SatisfactionRating_5"]},Question:{Question:"NSV_Timed_Feedback_Freeform_Question"}}}},{CampaignId:"450bbdb1-a4a4-4552-a995-33085df4a4b2",StartTimeUtc:"2019-05-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:1209600},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"NamedSheetViewNotCreatedFeedback",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"NSVDidntCreatePrompt",Question:"NSVPromptQuestion",YesLabel:"L_WAC_GenericSurvey_SureLabel",NoLabel:"L_WAC_GenericSurvey_NoLabel"},Rating:{Question:"NSVDidntCreateSheetViewQuestion",RatingValuesAscending:["NSVDidntCreateNSVOption_1","NSVDidntCreateNSVOption_2","NSVDidntCreateNSVOption_3","NSVDidntCreateNSVOption_4"]},Question:{Question:"NSVFreeformDidntCreateSheetView"}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2021-10-13T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"91d835f4-cd27-49bc-b86b-909703fcaba5",StartTimeUtc:"2020-06-05T00:00:00Z",EndTimeUtc:"2020-12-31T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office_Docs_SharedComments_CommitComment",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"AtMentionFPS_Title",Question:"AtMentionFPS_Question",YesLabel:"AtMentionFPS_YesLabel",NoLabel:"AtMentionFPS_NoLabel"},Rating:{Question:"AtMentionFPS_RatingQuestion",RatingValuesAscending:["AtMentionFPS_RatingValue_1","AtMentionFPS_RatingValue_2","AtMentionFPS_RatingValue_3","AtMentionFPS_RatingValue_4","AtMentionFPS_RatingValue_5"]},Question:{Question:"AtMentionFPS_WhyQuestion"}}}},{CampaignId:"ed1c4566-210a-4412-9fcc-f2f30b42155a",StartTimeUtc:"2019-12-18T00:00:00Z",EndTimeUtc:"2020-04-18T00:00:00Z",GovernedChannelType:0,Scope:{Type:1,Languages:[{Type:0,Value:"en"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CardViewOpenCard",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on cards in Excel",Question:"We have two questions for you",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall, how satisfied are you with cards in Excel?",RatingValuesAscending:["SatisfactionRating_1","SatisfactionRating_2","SatisfactionRating_3","SatisfactionRating_4","SatisfactionRating_5"]},Question:{Question:"What do you like/dislike about the card?"}}}},{CampaignId:"9a2f8830-91c7-4b7d-9521-6bd64cf4fc98",StartTimeUtc:"2020-04-01T00:00:00Z",EndTimeUtc:"2021-04-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"OfficeScriptsFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"OfficeScriptsFPS_Title",Question:"OfficeScriptsFPS_Question",YesLabel:"OfficeScriptsFPS_YesLabel",NoLabel:"OfficeScriptsFPS_NoLabel"},Rating:{Question:"OfficeScriptsFPS_RatingQuestion",RatingValuesAscending:["OfficeScriptsFPS_RatingValue_1","OfficeScriptsFPS_RatingValue_2","OfficeScriptsFPS_RatingValue_3","OfficeScriptsFPS_RatingValue_4","OfficeScriptsFPS_RatingValue_5"]},Question:{Question:"OfficeScriptsFPS_WhyQuestion"}}}},{CampaignId:"cc6adef4-3482-4689-82e0-7c279dfa1ea8",StartTimeUtc:"2020-04-25T00:00:00Z",EndTimeUtc:"2020-08-25T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ApplyNamedCellStyle",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"CellStyles_Prompt",Question:"CellStyles_PromptQuestion",YesLabel:"CellStyles_PromptLabel_Sure",NoLabel:"CellStyles_PromptLabel_No"},Rating:{Question:"CellStyles_Overview_Question",RatingValuesAscending:["CellStyles_Rating_5_Useful","CellStyles_Rating_4_Useful","CellStyles_Rating_3_Useful","CellStyles_Rating_2_Useful","CellStyles_Rating_1_Useful"]},Question:{Question:"CellStyles_WhyQuestion"}}}},{CampaignId:"6d325b4d-1503-4da5-92a6-5a49336e769a",StartTimeUtc:"2020-04-30T00:00:00Z",EndTimeUtc:"2021-04-30T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office_Excel_Ideas_InitializeClosePaneFloodgate",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"ExcelIdeas_Prompt",Question:"ExcelIdeas_PromptQuestion",YesLabel:"L_WAC_GenericSurvey_SureLabel",NoLabel:"L_WAC_GenericSurvey_NoLabel"},Rating:{Question:"ExcelIdeas_Rating_Question",RatingValuesAscending:["ExcelIdeas_Rating_1_Expectations","ExcelIdeas_Rating_2_Expectations","ExcelIdeas_Rating_3_Expectations","ExcelIdeas_Rating_4_Expectations","ExcelIdeas_Rating_5_Expectations"]},Question:{Question:"ExcelIdeas_ExpectationsQuestion"}}}},{CampaignId:"9201b94a-be79-4fd4-b8ba-d28f03ece581",StartTimeUtc:"2020-04-30T00:00:00Z",EndTimeUtc:"2021-04-30T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"ExcelRecommendedCharts_Prompt",Question:"ExcelRecommendedCharts_PromptQuestion",YesLabel:"L_WAC_GenericSurvey_SureLabel",NoLabel:"L_WAC_GenericSurvey_NoLabel"},Rating:{Question:"ExcelRecommendedCharts_Rating_Question",RatingValuesAscending:["ExcelRecommendedCharts_Rating_1_Satisfied","ExcelRecommendedCharts_Rating_2_Satisfied","ExcelRecommendedCharts_Rating_3_Satisfied","ExcelRecommendedCharts_Rating_4_Satisfied","ExcelRecommendedCharts_Rating_5_Satisfied"]},Question:{Question:"ExcelRecommendedCharts_WhyQuestion"}}}},{CampaignId:"052df031-b00c-47ca-ac73-044919c048ef",StartTimeUtc:"2020-12-16T00:00:00Z",EndTimeUtc:"2021-12-16T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"ExcelRecommendedPivotTable_Prompt",Question:"ExcelRecommendedPivotTable_PromptQuestion",YesLabel:"L_WAC_GenericSurvey_SureLabel",NoLabel:"L_WAC_GenericSurvey_NoLabel"},Rating:{Question:"ExcelRecommendedPivotTable_Rating_Question",RatingValuesAscending:["ExcelRecommendedPivotTable_Rating_1_Expectations","ExcelRecommendedPivotTable_Rating_2_Expectations","ExcelRecommendedPivotTable_Rating_3_Expectations","ExcelRecommendedPivotTable_Rating_4_Expectations","ExcelRecommendedPivotTable_Rating_5_Expectations"]},Question:{Question:"ExcelRecommendedPivotTable_ExpectationsQuestion"}}}},{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-31-08T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_Excel",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"21e37f3e-5605-443b-9ecd-243654ed0685",StartTimeUtc:"2020-09-02T00:00:00Z",EndTimeUtc:"2021-03-25T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"UIHostActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"UIHost_Title",Question:"UIHost_PromptQuestion",YesLabel:"UIHost_Sure",NoLabel:"UIHost_NotNow"},Rating:{Question:"UIHost_RatingQuestion",RatingValuesAscending:["UIHost_Rating_Values_1","UIHost_Rating_Values_2","UIHost_Rating_Values_3","UIHost_Rating_Values_4","UIHost_Rating_Values_5"]},Question:{Question:"UIHost_WhyQuestion"}}}},{CampaignId:"75d96c7f-b807-4630-87b4-ebee0b311eac",StartTimeUtc:"2020-11-20T00:00:00Z",EndTimeUtc:"2021-03-25T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"UIHostOfficeComActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"UIHostOfficeCom_Title",Question:"UIHostOfficeCom_PromptQuestion",YesLabel:"UIHostOfficeCom_Sure",NoLabel:"UIHostOfficeCom_NotNow"},Rating:{Question:"UIHostOfficeCom_RatingQuestion",RatingValuesAscending:["UIHostOfficeCom_Rating_Values_1","UIHostOfficeCom_Rating_Values_2","UIHostOfficeCom_Rating_Values_3","UIHostOfficeCom_Rating_Values_4","UIHostOfficeCom_Rating_Values_5"]},Question:{Question:"UIHostOfficeCom_WhyQuestion"}}}},{CampaignId:"49f54878-363a-4842-bef0-b5c112771c78",StartTimeUtc:"2020-10-21T00:00:00Z",EndTimeUtc:"2021-04-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ExcelLineageShowChanges",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"ShowChanges_Prompt",Question:"ShowChanges_PromptQuestion",YesLabel:"ShowChanges_PromptLabel_Sure",NoLabel:"ShowChanges_PromptLabel_NotNow"},Rating:{Question:"ShowChanges_RatingQuestion",RatingValuesAscending:["ShowChanges_RatingValue_1","ShowChanges_RatingValue_2","ShowChanges_RatingValue_3","ShowChanges_RatingValue_4","ShowChanges_RatingValue_5"]},Question:{Question:"ShowChanges_WhyQuestion"}}}}],yi=[{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_OneNote",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"3689d04a-d216-4795-a7db-c8fc4679ae67",StartTimeUtc:"2018-12-10T00:00:00Z",EndTimeUtc:"2019-06-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"DictationUsed",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"We'd love your feedback on Dictation in Office Online!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:" Overall, how satisfied are you with OneNote Online\ufffds Dictation feature?",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please tell us more.\ufffd Why did you choose that answer?"}}}},{CampaignId:"da4d478d-1247-4e7f-9855-34d15c56b7f7",StartTimeUtc:"2019-03-12T00:00:00Z",EndTimeUtc:"2020-03-12T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SearchUsed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"SearchFPS_Title",Question:"SearchFPS_PromptQuestion",YesLabel:"SearchFPS_YesLabel",NoLabel:"SearchFPS_NoLabel"},Rating:{Question:"SearchFPS_RatingQuestion",RatingValuesAscending:["SearchFPS_Rating_Values_1","SearchFPS_Rating_Values_2","SearchFPS_Rating_Values_3","SearchFPS_Rating_Values_4","SearchFPS_Rating_Values_5"]},Question:{Question:"SearchFPS_WhyQuestion"}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"}}}}],bi={campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},Si={campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},Ci={PPTIdeasSurvey:bi,PPTRehearsePresentationSurvey:Si},Ai={campaignId:"44444444-4444-4444-4444-444444444444",commentQuestion:"Comment Question1",isZeroBased:!1,promptQuestion:"Prompt Question1",promptNoButtonText:"Prompt No Button Text",promptYesButtonText:"Prompt Yes Button Text",ratingQuestion:"Rating Question1",ratingValuesAscending:["CustomSurvey_Rating_11","CustomSurvey_Rating_12","CustomSurvey_Rating_3","CustomSurvey_Rating_4","CustomSurvey_Rating_5"],showPrompt:!1,surveyType:4,title:"Custom Survey Title"},Ii={VisioUISurveyExample:Ai},wi={campaignId:"44444444-4444-4444-4444-444444444444",commentQuestion:"Comment Question1",isZeroBased:!1,promptQuestion:"Prompt Question1",promptNoButtonText:"Prompt No Button Text",promptYesButtonText:"Prompt Yes Button Text",ratingQuestion:"Rating Question1",ratingValuesAscending:["CustomSurvey_Rating_11","CustomSurvey_Rating_12","CustomSurvey_Rating_3","CustomSurvey_Rating_4","CustomSurvey_Rating_5"],showPrompt:!1,surveyType:4,title:"Custom Survey Title"},Ti={OneNoteUISurveyExample:wi},Ei={campaignId:"44444444-4444-4444-4444-444444444444",commentQuestion:"Comment Question1",isZeroBased:!1,promptQuestion:"Prompt Question1",promptNoButtonText:"Prompt No Button Text",promptYesButtonText:"Prompt Yes Button Text",ratingQuestion:"Rating Question1",ratingValuesAscending:["CustomSurvey_Rating_11","CustomSurvey_Rating_12","CustomSurvey_Rating_3","CustomSurvey_Rating_4","CustomSurvey_Rating_5"],showPrompt:!1,surveyType:4,title:"Custom Survey Title"},ki={ExcelUISurveyExample:Ei},Mi=function(){Type.registerNamespace("Common.App.CustomerFeedback"),window.PPTCampaignsObj=fi,window.VisioCampaignsObj=vi,window.ExcelCampaignsObj=_i,window.OneNoteCampaignsObj=yi;var e=Ci;window.PPTUserInitiatedSurveysDictionary=e;var t=Ii;window.VisioUserInitiatedSurveysDictionary=t;var i=Ti;window.OneNoteUserInitiatedSurveysDictionary=i;var r=ki;window.ExcelUserInitiatedSurveysDictionary=r,n(521).CustomerFeedbackPackage.main()};window.WordViewerToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordViewer",ImageDownArrow:"IMGMAP@wv@SplitButtonArrow_5x3x32",Size:"SingleDock",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Docks",attrs:{Id:"buttondocks"},children:[{name:"HeroDock",attrs:{Id:"WordViewerHeroDock",OverflowMenuImage20by20:"IMGMAP@wv@EllipsisDark_20x20x32",OverflowMenuTooltip:"STR@L_MoreOptionsMenu"},children:[{name:"Controls",attrs:{id:"ctrlStripLeft"},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_AccessibilityMode",Id:"jbtnToggleViewMode",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",QueryCommand:"0x127D7696",Command:"0x9FC8F94C"}},{name:"Button",attrs:{Alt:"STR@L_ImmersiveView",Id:"btnLaunchImmersiveViewEdu",LabelText:"STR@L_ImmersiveView",Image20by20:"IMGMAP@wv@AudioReaderGlyph_20x20x32",Command:"0x72BE69D3"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_EditDocument",Command:"0x2F9A3D80",Id:"flyoutWordViewerEdit",LabelText:"STR@L_EditDocument",TextDirection:"STR@L_RibbonOptionTextDirection",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"},children:[{name:"Menu",attrs:{Id:"menuEdit"},children:[{name:"MenuSection",attrs:{Id:"menuSectionEdit",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlsEdit"},children:[{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutEditOnWeb",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x13A057F4"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutConvertToEditOnWeb",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x3809D3C2"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutCopyAndEdit",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",QueryCommand:"0x313544DC",Command:"0x68562DD8"}},{name:"Button",attrs:{Alt:"STR@L_OpenInWord",Id:"btnEditInClient",LabelText:"STR@L_OpenInWord",Description:"STR@L_EditInWordDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_OpenDocument",Command:"0x2F9A3D80",Id:"flyoutWordViewerOpen",LabelText:"STR@L_OpenDocument",TextDirection:"STR@L_RibbonOptionTextDirection",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"},children:[{name:"Menu",attrs:{Id:"menuOpen"},children:[{name:"MenuSection",attrs:{Id:"menuSectionOpen",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlsOpen"},children:[{name:"Button",attrs:{Alt:"STR@L_OpenInWord",Id:"btnOpenInClientBig",LabelText:"STR@L_OpenInWord",Description:"STR@L_EditInWordDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0xD5DF198A"}},{name:"Button",attrs:{Alt:"STR@L_InteractiveViewInBrowser",Id:"btnFlyoutInteractiveViewOnWeb",LabelText:"STR@L_InteractiveViewInBrowser",Description:"STR@L_ViewInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x13A057F4"}}]}]}]}]},{name:"Button",attrs:{Alt:"STR@L_EditInWord",Id:"btnPdfConvertAndEdit",LabelText:"STR@L_EditInWord",Command:"0xCAD15C25",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInWord",Id:"btnPdfCopyAndEdit",LabelText:"STR@L_EditInWord",Command:"0xFAA71D53",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_OpenInWord",Id:"btnOpenInClient",LabelText:"STR@L_OpenInWord",Command:"0xD5DF198A",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_InteractiveViewInBrowser",Id:"btnInteractiveViewOnWeb",LabelText:"STR@L_InteractiveViewInBrowser",Command:"0x13A057F4",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnEditOnWeb",LabelText:"STR@L_EditInBrowser",Command:"0x13A057F4",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnConvertToEditOnWeb",LabelText:"STR@L_EditInBrowser",Command:"0x3809D3C2",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnCopyAndEdit",LabelText:"STR@L_EditInBrowser",Command:"0x68562DD8",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",QueryCommand:"0x313544DC",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_SaveAndEditTranslatedDocumentButtonAltText",Id:"btnSaveAndEdit",LabelText:"STR@L_EditInBrowser",Command:"0xAADCE5C8",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"}},{name:"Button",attrs:{Id:"jbtnTranslateDocumentBack",LabelText:"STR@L_TranslateBackToOriginal",Image20by20:"IMGMAP@wv@Translator_20x20x32",Command:"0x22335D57"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"btnDownloadWithWord",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Alt:"STR@L_SaveToCloudStorage",Id:"btnSaveToCloudStorage",LabelText:"STR@L_SaveToCloudStorage",Image20by20:"IMGMAP@wv@SkyDriveCloud_20x20x32",Command:"0x24D132C8"}},{name:"Button",attrs:{Id:"btnPrintToPdf",LabelText:"STR@L_Print",Alt:"STR@L_PrintToPdf",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnDirectPrint",LabelText:"STR@L_DirectPrintJewelButton",Alt:"STR@L_DirectPrintJewelDescription",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnPrintPdfFile",LabelText:"STR@L_Print",Alt:"STR@L_PrintToPdf",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnDirectPrintPdfMode",LabelText:"STR@L_DirectPrintJewelButton",Alt:"STR@L_DirectPrintJewelDescription",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnjClose",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Image20by20:"IMGMAP@wv@CloseGlyphServer_20x20x32"}},{name:"Button",attrs:{Id:"HostConversation",Command:"0x2A5FDD0D",LabelText:"STR@L_Conversation",Image20by20:"IMGMAP@wv@ConversationWord_20x20x32"}},{name:"Button",attrs:{Id:"HostOpenInBrowser",Command:"0x9ACA3153",LabelText:"STR@L_OpenInBrowser",Image20by20:"IMGMAP@wv@Word_20x20x32"}},{name:"Button",attrs:{Alt:"STR@L_Share",Id:"btnFileSharing",LabelText:"STR@L_Share",Image20by20:"IMGMAP@wv@ShareServer_20x20x32",Command:"0x3A7DFAA4"}},{name:"ToggleButton",attrs:{Alt:"STR@L_OpenCommentPane",Id:"btnOpenCommentPane",LabelText:"STR@L_OpenCommentPane",Image20by20:"IMGMAP@wv@CommentsGlyphGrey_20x20x32",Command:"0x87F614C3",QueryCommand:"0x3282B935",UsePseudoCheckMark:"true"}},{name:"ToggleButton",attrs:{Alt:"STR@L_OpenSearchPane",Id:"btnOpenSearchPane",LabelText:"STR@L_OpenSearchPane",Image20by20:"IMGMAP@wv@FindGlyphServer_20x20x32",Command:"0x3A32DAF4",QueryCommand:"0x4CD7FCB8",UsePseudoCheckMark:"true"}},{name:"Button",attrs:{Alt:"STR@L_ImmersiveView",Id:"btnLaunchImmersiveViewNonEdu",LabelText:"STR@L_ImmersiveView",Image20by20:"IMGMAP@wv@AudioReaderGlyph_20x20x32",Command:"0x72BE69D3"}},{name:"Button",attrs:{Id:"jbtnTranslateDocument",LabelText:"STR@L_TranslateDocument",Image20by20:"IMGMAP@wv@Translator_20x20x32",Command:"0x9BB3ABA5"}},{name:"Button",attrs:{Id:"jbtnFileVersion",LabelText:"STR@L_PreviousVersions",Image20by20:"IMGMAP@wv@VersionsServer_20x20x32",Command:"0xDB70177B"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"overflowbtnDownloadWithWord",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Id:"jbtnDownloadATranslatedCopy",LabelText:"STR@L_Download",Description:"STR@L_DownloadDescription",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0x3E4AEF42"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"btnDownloadPdf",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Id:"jbtnDownloadAsPdf",LabelText:"STR@L_DownloadAsPDF",Description:"STR@L_DownloadAsPDFDescription",Image20by20:"IMGMAP@wv@PDFGlyph_20x20x32",Command:"0x5887FF04"}},{name:"Button",attrs:{Id:"jbtnFileEmbed",LabelText:"STR@L_Embed",Image20by20:"IMGMAP@wv@EmbedServer_20x20x32",Command:"0x66DDFD86"}},{name:"Button",attrs:{Id:"jbtnHelp",LabelText:"STR@L_HelpButtonTitle",Image20by20:"IMGMAP@wv@OfficeAssistantServerDark_20x20x32",Command:"0x56B04A51"}},{name:"Button",attrs:{Id:"jbtnAccessibilityHelp",LabelText:"STR@L_AccessibilityHelp",Image20by20:"IMGMAP@wv@GeneralAccessibilityGlyph_20x20x32",Command:"0xC34BD836"}},{name:"Button",attrs:{Id:"jbtnGiveFeedback",LabelText:"STR@L_GiveFeedback",Image20by20:"IMGMAP@wv@FeedbackGlyph_20x20x32",Command:"0x2FD6BDE0"}},{name:"Button",attrs:{Id:"btnjTryOffice",LabelText:"STR@L_TryOffice",Image20by20:"IMGMAP@wv@OfficeTrial_20x20x32",Command:"0x99AFA01D"}},{name:"Button",attrs:{Id:"btnjTryMacOffice",LabelText:"STR@L_TryMacOffice",Image20by20:"IMGMAP@wv@OfficeTrial_20x20x32",Command:"0x0C048010"}},{name:"Button",attrs:{Id:"jbtnTermsOfUse",LabelText:"STR@L_TermsOfUse",Image20by20:"IMGMAP@wv@InfoGlyphServer_20x20x32",Command:"0x8C0EBBB3"}},{name:"Button",attrs:{Id:"jbtnPrivacy",LabelText:"STR@L_Privacy",Image20by20:"IMGMAP@wv@PrivacyGlyphServer_20x20x32",Command:"0x48091446"}},{name:"Button",attrs:{Id:"jbtnReportAbuse",LabelText:"STR@L_ReportAbuse",Image20by20:"IMGMAP@wv@AbuseGlyph_20x20x32",Command:"0xC0F351AE"}},{name:"Button",attrs:{Id:"jbtnAccessibility",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",Command:"0x583F2602"}},{name:"Button",attrs:{Id:"jbtnAccessibilityPdf",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Alt:"STR@L_SyncToPresenter",Id:"btnSyncToPresenter",LabelText:"STR@L_SyncToPresenter",Image20by20:"IMGMAP@wv@SyncToPresenterServer_20x20x32",Command:"0xC79FFB5C"}},{name:"Button",attrs:{Alt:"STR@L_OpenSharedNotes",Id:"btnOpenSharedNotes",LabelText:"STR@L_OpenSharedNotes",Image20by20:"IMGMAP@wv@SharedNotesGlyph_Grey_20x20x32",Command:"0xE6ACD19C"}},{name:"Button",attrs:{Id:"jbtnTrustCenter",LabelText:"STR@l_TrustCenter",Image20by20:"IMGMAP@wv@PrivacyGlyphServer_20x20x32",Command:"0x9A00EB4E"}}]}]}]}]}]},window.WordViewerStatusBarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"StatusBar",attrs:{Id:"WordViewerStatusBar",ImageDownArrow:"IMGMAP@wv@StatusBarDownArrowGrey_5x3x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",LabelText:"STR@L_StatusBarLabel"},children:[{name:"Docks",attrs:{Id:"buttondocks"},children:[{name:"ButtonDock",attrs:{Id:"buttonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"buttonDockLeftControls"},children:[{name:"Label",attrs:{Id:"WordIcon",Image16by16:"IMGMAP@wv@Word_14x14x32",DisplayMode:"Small14"}},{name:"Label",attrs:{Id:"PageInfoLabel",LabelText:"",QueryCommand:"0x42EB999E",DisplayMode:"Medium14"}},{name:"Label",attrs:{Id:"ClassificationLabel",Alt:"",LabelText:"",Image16by16:"IMGMAP@wv@MarkAsProtected14",Command:"0xCC509ABF",QueryCommand:"0x1DACE7EE",DisplayMode:"Medium14",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"buttonDockCenter",Alignment:"Center"},children:[{name:"Controls",attrs:{id:"buttonDockCenterControls"},children:[{name:"Label",attrs:{Id:"EnvironmentLabel",QueryCommand:"0xE7B52458",LabelText:"",DisplayMode:"Medium14",Visible:"false"}},{name:"Label",attrs:{Id:"PresenterPageLabel",LabelText:"",QueryCommand:"0x37D5C13B",DisplayMode:"Medium14"}}]}]},{name:"ButtonDock",attrs:{Id:"buttonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"buttonDockRightControls"},children:[{name:"Button",attrs:{Id:"GiveFeedback",Alt:"STR@L_HelpImproveOffice",Command:"0x2FD6BDE0",LabelText:"STR@L_GiveFeedback",DisplayMode:"Medium14"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_CurrentZoom",Command:"0x2F9A3D80",Id:"ZoomFlyout",PopulateDynamically:"true",PopulateQueryCommand:"0x5D7E84A8",PopulateOnlyOnce:"true",QueryCommand:"0x19D00622",LabelText:""}},{name:"Button",attrs:{Id:"buttonShowZoomDialog",Alt:"STR@L_ZoomTooltip",Command:"0x6797D208",LabelText:"100%",QueryCommand:"0x19D00622",DisplayMode:"Medium14"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_ControlMenu",Command:"0x2F9A3D80",Id:"ControlMenu",PopulateDynamically:"false",PopulateOnlyOnce:"false",Image16by16:"IMGMAP@wv@sbMenuGrey_14x14x32",DisplayMode:"Small14"},children:[{name:"Menu",attrs:{Id:"menuEmbeddedControls"},children:[{name:"MenuSection",attrs:{Id:"msControlMenu1"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{MenuItemId:"DownloadACopy",Id:"DownloadACopy",Command:"0xD3EF8F78",LabelText:"STR@L_DownloadACopy",Alt:"STR@L_DownloadACopy"}},{name:"Button",attrs:{MenuItemId:"PrintPDF",Id:"PrintPDF",Command:"0xC6003374",LabelText:"STR@L_PrintPDF",Alt:"STR@L_PrintPDF"}},{name:"ToggleButton",attrs:{MenuItemId:"AccessibleMode",Id:"AccessibleMode",Command:"0x9FC8F94C",LabelText:"STR@L_AccessibilityMode",Alt:"STR@L_AccessibilityMode",QueryCommand:"0x127D7696"}}]}]},{name:"MenuSection",attrs:{Id:"msControlMenu2"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{MenuItemId:"DocumentInformation",Id:"DocumentInformation",Command:"0xAC76EB12",LabelText:"STR@L_DocumentInformation",Alt:"STR@L_DocumentInformation"}}]}]},{name:"MenuSection",attrs:{Id:"msControlMenu3"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{Id:"msControlMenu.Controls.GiveFeedback",LabelText:"STR@L_GiveFeedback",Command:"0x2FD6BDE0",DisplayMode:"Medium14"}},{name:"Button",attrs:{MenuItemId:"TermsOfUse",Id:"TermsOfUse",Command:"0x8C0EBBB3",LabelText:"STR@L_TermsOfUse",Alt:"STR@L_TermsOfUse"}},{name:"Button",attrs:{MenuItemId:"Privacy",Id:"Privacy",Command:"0x48091446",LabelText:"STR@L_Privacy",Alt:"STR@L_Privacy"}}]}]}]}]},{name:"Button",attrs:{Alt:"STR@L_FullScreen",Id:"fseaFullScreen",LabelText:"STR@L_FullScreen",Command:"0xAFAE8F6F",DisplayMode:"Small14",Image16by16:"IMGMAP@wv@FullScreenAttendee_14x14x32"}}]}]}]}]}]};"undefined"==typeof hi&&(hi={}),window.MSOJS=hi,hi.ClientUtils=function(){var e,t,n,i,r,a,o,s,l,c="",u="",d="";var p={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},h={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},m={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},g={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},f={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function v(){return Boolean(a)||(a=!0,o=b("Windows NT")),o>=6.1&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(w()||P()||k())}function _(){return window.navigator.userAgent.indexOf("Windows")>=0}function y(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function b(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;return null!=t&&t.length>=2&&(n=parseFloat(t[1]),isNaN(n)&&(n=-1)),n}function S(){return Boolean(s)||(s=!0,l=b("Windows Phone")),l>=8}function C(){return"function"==typeof navigator.msLaunchUri&&!y()&&!M()&&!I()}function A(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function I(){return window.navigator.userAgent.indexOf("Edge/")>=0}function w(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function T(){return!!w()&&8==window.document.documentMode}function E(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function k(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function M(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("android")>=0&&e.indexOf("chrome")>=0}function P(){return function(){if(E())return D("firefox/");return 0}()>=3}function F(){return function(){if(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0)return D("version/");return 0}()>=3}function D(e){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf(e);if(n>=0){var i=n+e.length,r=t.length;return parseInt(t.substring(i,r))}return 0}function O(e,t,n,i,r){i&&null!=t?t():C()?navigator.msLaunchUri(e,t,n):!k()&&!(window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0||navigator.maxTouchPoints>0&&A())||I()?x(e,t,n):function(e){return k()&&e}(r)?function(e,t,n){try{window.open(e,"_self")}catch(e){return void(null!=n&&n())}null!=t&&t()}(e,t,n):R(e,t,n)}function R(e,t,n){var i=document.getElementById("OICLinkTag");null==i&&((i=document.createElement("a")).id="OICLinkTag",i.style.visibility="hidden",i.href="",0==(r.Options&h.SupportsTopTargetNavigation)||r.NoBrowserModalDialogs?i.target="_blank":i.target="_top",document.body.appendChild(i),null!=i.addEventListener&&i.addEventListener("click",(function(e){null!=e.stopPropagation&&e.stopPropagation()}),!1));try{i.href=e,i.click()}catch(e){return void(null!=n&&n())}null!=t&&t()}function x(e,t,n){var i=document.getElementById("OICFrame");null==i&&((i=document.createElement("iframe")).className="ObjectInDialog",i.style.visibility="hidden",i.src="about:blank",document.body.appendChild(i),i.id="OICFrame");try{i.contentWindow.location.href=e}catch(e){return void(null!=n&&n())}null!=t&&t()}function U(e){return 0!=(e.Options&h.SkipProtocolHandler)||T()}function B(e){return!U(e)&&(!!function(e){return A()&&(e.Application==f.OneNote||Q("application/x-sharepoint-protocolhandler",!1)||Q("application/x-sharepoint-webkit-protocolhandler",!1))}(e)||(!!C()||(!!M()||(!(L()||"ActiveXObject"in window&&!y()||k())||ne()>=15))))}function L(){return A()&&(P()||F())||P()}function N(e){return e===p.ReadOnly||e===p.ReadWrite}function H(e,t,n,i,r){e==f.Visio&&n==p.ReadWrite&&(n=p.WriteOnly);var a=r;if(!(i=i||y()&&!S())){var o="";N(n)?o+="ofv|ofc|":o+="ofe|",a+=j(o+="u|")}a+=j(t);var s=function(e,t){var n=e.toLowerCase().indexOf("&"+t+"=");if(-1==n)return;var i=n+(t.length+2),r=e.indexOf("&",i);if(-1==r)return e.substr(i);return e.substring(i,r)}(window.location.href,"wdlor");if(null!=s&&"undefined"!=typeof s){var l="";try{l=decodeURIComponent(s)}catch(e){}l.length>0&&function(e){return RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(e)}(l)&&(a+="|f|",a+=l)}return a}function W(e,t,n,i,a,o){var s=J(e);return null==s?(te(r.DescriptiveUnattemptedEnums?m.ProtocolHandlerIsNull:m.Unattempted,r.Application),!1):(O(H(e,t,n,i,s),V,K,a,o),!0)}function j(e){if(A()&&k()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function V(){ee(g.ProtocolHandler)}function K(){r.Options|=h.SkipProtocolHandler,Y(r,e,t)}function z(){null!=n&&n(g.RoamingProtocolHandler)}function q(){null!=i&&i(m.ControlNeeded)}function G(){var e=document.getElementById("npSharePointPlugin");if(null==e){var t="application/x-sharepoint";if(A()&&F()&&Z("application/x-sharepoint-webkit")&&(t="application/x-sharepoint-webkit"),!Z(t)){if(!A()||!Z("application/officelive"))return null;t="application/officelive"}var n=document.createElement("object");n.id="npSharePointPlugin",n.type=t,n.style.width="0px",n.style.height="0px",n.style.setProperty("visibility","hidden",""),document.body.appendChild(n),e=document.getElementById("npSharePointPlugin")}return e}function Q(e,t){var n=window.navigator.mimeTypes;if(null==n)return!1;var i=n[e];return!!i&&!(t&&!i.enabledPlugin)}function Z(e){return Q(e,!0)}function $(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function X(e){switch(e){case f.OneNote:return"OneNote.Notebook";default:return""}}function J(e){if(e!=f.OneNote&&y()&&!S())return"office:";switch(e){case f.Excel:return"ms-excel:";case f.OneNote:return"onenote:";case f.PowerPoint:return"ms-powerpoint:";case f.Visio:return"ms-visio:";case f.Word:return"ms-word:";case f.Project:return"ms-project:";case f.Publisher:return"ms-publisher:";case f.Infopath:return"ms-infopath:";case f.Access:return"ms-access:";default:return""}}function Y(n,i,a){if(r=n,e=i,t=a,n.DocumentUrl){var o,s=n.DocumentUrl,l=n.DocumentUrl,c=n.DocumentUrl;try{c=decodeURIComponent(n.DocumentUrl)}catch(e){}try{l=encodeURI(n.DocumentUrl)}catch(e){}if(s=s+""+n.CorrelationIdForWinClient,c+=n.CorrelationIdForWinClient,l+=n.CorrelationIdForWinClient,n.Mode===p.ReadWrite&&h.CheckoutRequired===(n.Options&h.CheckoutRequired)&&(n.Mode=p.ForceCheckout),h.HostIsEditOnly===(n.Options&h.HostIsEditOnly)&&(n.Mode=p.WriteOnly),B(n))W(n.Application,n.EncodeUrl?l:s,n.Mode,n.Application==f.OneNote,n.SilentExternalHandler,n.NavigateUsingWindowOpen);else if(T()&&function(e,t,n,i){try{var r=new ActiveXObject("SharePoint.OpenDocuments.5");if(r)return r.ViewDocument3(window.self,e,t,i)}catch(e){}return!1}(n.EncodeUrl?s:c,n.Mode,n.Options,X(n.Application)))ee(g.O15ActiveX);else if(L()?o=function(e,t,n){var i=G();if(null==i)return r.DescriptiveUnattemptedEnums?m.PluginIsNull:m.Unattempted;var a=!1;try{a=i.ViewDocument3(window.self,e,t,n)}catch(e){}if(!a)try{a=N(t)?i.ViewDocument2(window.self,e,n):i.EditDocument2(window.self,e,n)}catch(e){}return a?(ee(g.NpapiPlugin),m.None):m.Failed}(n.EncodeUrl?s:c,n.Mode,X(n.Application)):(!function(){try{var e=new ActiveXObject("IDBHO.IDBHOCtrl");null!=e&&e.SaveSSOCreds()}catch(e){}}(),o=function(e,t,n,i){var a;try{if(a=new ActiveXObject("SharePoint.OpenDocuments.4"))return a.ViewDocument3(window.self,e,t,i)?(ee(g.O14ActiveX),m.None):m.Failed}catch(e){}if(h.O14Only===(n&h.O14Only))return r.DescriptiveUnattemptedEnums?m.O14AttemptFailure:m.Unattempted;try{if(a=new ActiveXObject("SharePoint.OpenDocuments.3"))return a.ViewDocument3(window.self,e,t,i)?(ee(g.O12ActiveX),m.None):m.Failed}catch(e){}if(h.O12UpOnly===(n&h.O12UpOnly))return r.DescriptiveUnattemptedEnums?m.O12UpOnlyFail:m.Unattempted;try{if(a=new ActiveXObject("SharePoint.OpenDocuments.2"))return(N(t)?a.ViewDocument2(window.self,e,i):a.EditDocument2(window.self,e,i))?(ee(g.O11ActiveX),m.None):m.Failed}catch(e){}return r.DescriptiveUnattemptedEnums?m.ActiveXUnattempted:m.Unattempted}(n.EncodeUrl?s:c,n.Mode,n.Options,X(n.Application))),o!=m.None){if(n.CouldUseRoamingApps&&v()&&n.Application!=f.OneNote){if(!hi.ClientUtils.CanUseRoamingControl())return void te(m.ControlNeeded,r.Application);if(n.RoamingAppsLauncher)return void function(n){"undefined"!=typeof n.RoamingAppsLauncher&&null!=n.RoamingAppsLauncher?"undefined"==typeof n.RoamingBitsUrl||null==n.RoamingBitsUrl?hi.ClientUtils.LaunchRoamingApps(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,e,t):hi.ClientUtils.LaunchRoamingApps2(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,e,t):te(r.DescriptiveUnattemptedEnums?m.RoamingLauncherIsNull:m.Unattempted,r.Application)}(n);if(!n.ContinueIfLauncherIsNull)return void te(m.LauncherNeeded,r.Application)}if(h.NoProtocolHandlerFallback!=(n.Options&h.NoProtocolHandlerFallback)&&!U(n)&&!w()&&(!A()||function(e){if(r.DescriptiveUnattemptedEnums)return e>=m.O14Unattempted&&e<=m.DocumentUrlIsNull;return e==m.Unattempted}(o)))return void W(n.Application,n.EncodeUrl?l:s,n.Mode,n.Application==f.OneNote,n.SilentExternalHandler,n.NavigateUsingWindowOpen);te(o,r.Application)}}else te(r.DescriptiveUnattemptedEnums?m.DocumentUrlIsNull:m.Unattempted,r.Application)}function ee(t){null!=e&&e(t)}function te(e,n){"undefined"==typeof n&&(n=null),null!=t&&t(e,n)}function ne(){var e=0;if(L()||k()){var t=G();try{null!=t&&(e=t.GetOfficeVersion())}catch(e){}}else $("SharePoint.OpenDocuments.5")?e=15:$("SharePoint.OpenDocuments.4")?e=14:$("SharePoint.OpenDocuments.3")?e=12:$("SharePoint.OpenDocuments.2")&&(e=11);return e}function ie(){return A()&&(Z("application/x-sharepoint")||Z("application/x-sharepoint-webkit"))}return{OpenDocumentMode:p,OpenDocumentOptions:h,OpenDocumentFailureType:m,OpenDocumentControl:g,OfficeApplication:f,EditDocumentInClient:Y,EditDocumentInClientParams:function(){this.DocumentUrl="",this.Mode=0,this.Options=0,this.Application=f.Unknown,this.CouldUseRoamingApps=!1,this.RoamingAppsLauncher="",this.ContinueIfLauncherIsNull=!1,this.ApplicationParameters="",this.RoamingPlatform="",this.RoamingApplicationExe="",this.RoamingBitsUrl="",this.SilentExternalHandler=!1,this.EncodeUrl=!1,this.CorrelationIdForWinClient="",this.NavigateUsingWindowOpen=!1,this.DescriptiveUnattemptedEnums=!1,this.NoBrowserModalDialogs=!1},OfficeVersionInstalled:ne,IsO14MacPluginInstalled:ie,OfferOfficeInDialog:function(){return _()&&ne()<=11},OfferOfficeNoIntrusive:function(){return _()&&ne()<15},OfferMacOffice:function(){return A()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!ie()},InstallRoamingControl:function(){E()?window.InstallTrigger.install({Office:{URL:u}}):x(d,null,null)},CanUseRoamingControl:function(){if(C())return!0;if(k())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),Boolean(navigator.mimeTypes["application/x-vnd.officeondemand"]);if(E()){var e=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(e);var t=document.createEvent("Events");return t.initEvent("RoamingOfficeInstalled",!0,!1),e.dispatchEvent(t),Boolean(e.getAttribute("installed"))}if(w())try{return new ActiveXObject("RoamingOfficeActiveX.RoamingOffice").HrExists()}catch(e){}return!1},InitUrls:function(e,t,n){c=e,u=n,d=t},LaunchRoamingApps:function(e,t,n,i,r,a){hi.ClientUtils.LaunchRoamingApps2(e,t,function(e){switch(e){case f.Excel:return"root\\office15\\excel.exe";case f.PowerPoint:return"root\\office15\\powerpnt.exe";case f.Visio:return"root\\office15\\visio.exe";case f.Word:return"root\\office15\\winword.exe";case f.Project:return"root\\office15\\winproj.exe";case f.Publisher:return"root\\office15\\mspub.exe";case f.Infopath:return"root\\office15\\infopath.exe";case f.Access:return"root\\office15\\msaccess.exe";default:return null}}(n),i,"x86",c,r,a)},LaunchRoamingApps2:function(e,t,r,a,o,s,l,c){var u="";if(null!=a&&(u+=" "+a),null!=e&&(u+=' "'+e+'"'),C()||k()){n=l,i=c;var d="office:";d+=' "'+s+'"',d+=' "'+r+'"',d+=' "ROAMING"',d+=' "'+t+'"',d+=' "'+o+'"',O(d+=" "+u,z,q,!1,!1)}else if(E()){var p=document.createElement("RoamingExtensionElement");p.setAttribute("cabUrl",s),p.setAttribute("app",r),p.setAttribute("licensingEntitlements",t),p.setAttribute("platform",o),p.setAttribute("args",u),document.documentElement.appendChild(p);var h=document.createEvent("Events");h.initEvent("RoamingOfficeLaunch",!0,!1),p.dispatchEvent(h),null!=l&&l(g.RoamingFFExtension)}else if(w()){var f=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice");if(null!=f)try{f.HrConfigureSingle(s,r,t,o,u),null!=l&&l(g.RoamingActiveX)}catch(e){}}else null!=c&&c(m.Failed)},ShouldShowDialog:function(){return!y()},NavigateToUrlUsingClickingOnATag:R,OpenDocumentWithProtocolHandler:W,OpenDocumentWithProtocolHandlerNoCallBack:function(e,t,n,i){var a=J(e);return null==a?(te(r.DescriptiveUnattemptedEnums?m.ProtocolHandlerNoCallbackIsNull:m.Unattempted,r.Application),!1):(O(H(e,t,n,i,a),null,null,!1,!1),!0)}}}(),hi.ClientUtils=hi.ClientUtils;var Pi=n(14),Fi=function(){};Fi.trace=ae.ULS.sendTraceTag,Object(s.a)(Fi,"UULS",null,[]);var Di=function(){Type.registerNamespace("Diag"),window.Diag.UULS=Fi},Oi=function(){Type.registerNamespace("CommandUI"),Type.registerNamespace("CommandUI.Controls"),Type.registerNamespace("CommandUI.Controls.SearchBoxComponents")},Ri=n(28),xi=n(23),Ui=n(156),Bi=n(72),Li=n(82),Ni=n(74),Hi=n(5),Wi=n(45),ji=n(6);function Vi(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Ki(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Ki(e,t){if(e){if("string"==typeof e)return zi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zi(e,t):void 0}}function zi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function qi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Gi(e,t,n){return t&&qi(e.prototype,t),n&&qi(e,n),e}var Qi=function(){function e(e){this._isCommitChangeFixEnabled=!1,this._activeElement=null,this._activeElementBounds=null,this._activeElementHovered=!1,this._control=e}var t=e.prototype;return t.attachEvents=function(e){},t.initialize=function(){},t.doDefaultAction=function(e,t,n){this.control.doDefaultActionPublic(e,t,n)},t.pollForStateAndUpdate=function(){Hi.c(this.control.controlProperties.Command)||this.pollForStateAndUpdateInternal(this.control.controlProperties.Command,null,null)},t.pollForStateAndUpdateInternal=function(e,t,n){var i=0;return this.root&&(i=this.root.pollForCommandState(e,t,n)),this.control.enabled=(1&i)>0,i},t.updateVisibility=function(){var e=this.control.visible;return this.root.supportsInvisibleControls&&(e=this.stateProperties[Wi.a.visible])!==this.control.visible&&(this.control.visible=e,this.root.needRefresh=!0),e},t.updateLabelText=function(){var e=ji.a.validateStringProperty(this.stateProperties[Wi.a.labelText],this.control.controlProperties.LabelText);this.setLabelText(e)},t.setLabelText=function(e){this.control.labelText!==e&&(this.controlComponentDomCache.forEach((function(t){t.setLabelText(e)})),this.control.labelText=e,this.root.needScaling=!0)},t.updateTooltip=function(){var e=ji.a.validateStringProperty(this.stateProperties[Wi.a.alt],this.control.controlProperties.Alt);this.setTooltip(e)},t.setTooltip=function(e){this.control.tooltip!==e&&(this.controlComponentDomCache.forEach((function(t){t.setTooltip(e)})),this.control.tooltip=e)},t.updateImage=function(){var e=ji.a.validateStringProperty(this.stateProperties[Ui.a.Image16by16Class],this.control.controlProperties.Image16by16Class),t=ji.a.validateStringProperty(this.stateProperties[Ui.a.Image32by32Class],this.control.controlProperties.Image32by32Class),n=ji.a.validateStringProperty(this.stateProperties[Ui.a.Image48by48Class],this.control.controlProperties.Image48by48Class),i=Hi.b(n)?t:n;this.applyImageCssClass(this.controlComponentDomCache.small,e),this.applyImageCssClass(this.controlComponentDomCache.medium,e),this.applyImageCssClass(this.controlComponentDomCache.large,t),this.applyImageCssClass(this.controlComponentDomCache.smallMenu,e),this.applyImageCssClass(this.controlComponentDomCache.largeMenu,i)},t.applyImageCssClass=function(e,t){e&&(Hi.c(e.elmImage)||Hi.c(t)||e.elmImage.className===t||(e.elmImage.className=t))},t.updateDisplayMode=function(e){if(!Hi.b(e))if(this.root.supportsDynamicDisplayMode){for(var t,n=Vi(this.control.components);!(t=n()).done;){var i=t.value,r=i.displayMode===e;r&&(!0,this.control.activeComponentWhenVisible=i),this.control.visible&&(i.visibleInDOM=r)}this.control.visible&&(this.root.needScaling=!0)}else 0},t.adjustLayoutForLargeMenu=function(){if(this.controlComponentDomCache.largeMenu&&this.controlComponentDomCache.largeMenu.elmLabel&&this.controlComponentDomCache.largeMenu.elmDescription){var e=this.controlComponentDomCache.largeMenu.elmLabel,t=ji.a.validateStringProperty(this.stateProperties[Bi.a.Description],this.control.controlProperties.Description);Hi.b(t)&&(e.style.position="relative",e.style.top=(e.parentNode.offsetHeight-e.offsetHeight)/2+"px",e.style.padding="0px")}},t.onFocus=function(e){var t=this.displayedComponent;return Object(r.c)(Li.a,t)?this.parentMenu.updateFocusedIndex(t):this.root.controlWithFocus=this.control,!1},t.onBlur=function(e){var t=this.displayedComponent;return this.control.isStandardMenuItem()&&ji.a.removeCSSClassFromElement(t.elementInternal,"cui-ctl-menu-hovered-without-focus"),this.root.controlWithFocus=null,!1},t.onPointerOver=function(e){if(this.control.isStandardMenuItem()){var t=this.parentMenu.stackIndex,n=t===this.root.menuStackDepth-1,i=n?null:this.root.menuLauncherStack[t+1];this.closeChildMenus(!1),n||this.control===i||ji.a.removeCSSClassFromElement(i.launcher,Ni.MenuLauncher.menuDroppedClassName),this.control.enabled&&this.control.focusableElement?n?this.control.setFocusOnControl():(ji.a.ensureCSSClassOnElement(this.displayedComponent.elementInternal,"cui-ctl-menu-hovered-without-focus"),i.elmHadFocus=this.control.focusableElement):n?this.parentMenu.setFocus(e.inputSource):(i.elmHadFocus=this.parentMenu.elementInternal,this.parentMenu.resetFocusedIndex())}return!1},t.onPointerOut=function(e){return this.control.isStandardMenuItem()&&ji.a.removeCSSClassFromElement(this.displayedComponent.elementInternal,"cui-ctl-menu-hovered-without-focus"),!1},t.onKeyDown=function(e){var t=!1;if(!Hi.c(e.innerEvent)&&!Hi.c(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,a=n.shiftKey;if(i===Sys.UI.Key.enter&&(t=!0),Object(r.c)(Li.a,this.displayedComponent)){var o=this.parentMenu;if(!Hi.c(o)){var s=o.stackIndex,l=!this.root.textDirection,c=!Hi.c(this.control.parentGrid);if(i!==Sys.UI.Key.tab&&i!==Sys.UI.Key.left&&i!==Sys.UI.Key.right&&i!==Sys.UI.Key.up&&i!==Sys.UI.Key.down&&i!==Sys.UI.Key.esc)return t;bt.a.clearSelectionIfNecessary(),i!==Sys.UI.Key.tab||a?i===Sys.UI.Key.tab&&a?(o.focusNext(1),t=!0):i===Sys.UI.Key.left&&l||i===Sys.UI.Key.right&&!l?(c?o.focusNext(2):s>0&&this.root.closeMenuStackAtIndex(s,!0,!1),t=!0):i===Sys.UI.Key.right&&l||i===Sys.UI.Key.left&&!l?(c&&o.focusNext(4),t=!0):i===Sys.UI.Key.up?(o.focusNext(5),t=!0):i===Sys.UI.Key.down?(o.focusNext(6),t=!0):i===Sys.UI.Key.esc&&(this.root.closeMenuStackAtIndex(s,!0,!1),t=!0):(o.focusNext(0),t=!0)}}}return t},t.onKeyUp=function(e){var t=!1;if(!Hi.c(e.innerEvent)&&!Hi.c(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode;n.shiftKey;gt.KeyInputManager.hasKeyModifiers(e)||i!==Sys.UI.Key.enter&&i!==Sys.UI.Key.space||(t=this.handleDefaultActionWithKeytips(e))||(this.doDefaultAction(e.sourceElement,1,e.innerEvent),t=!0)}return t},t.onPointerDown=function(e){if(this.commitRootPendingChanges(),this.activatesOnPress){var t=!0;2===e.inputSource&&(t=!e.mouseButton),t&&this.displayedComponent&&this.activateElement(this.displayedComponent.elementInternal)}return(e.innerEvent.type.toLowerCase()!==et.EventNames.touchStart||this.activatesOnPress)&&e.innerEvent.preventDefault(),!1},t.enableCommitChangeFix=function(){this._isCommitChangeFixEnabled=!0},t.commitRootPendingChanges=function(){this.isCommitChangeFixEnabled&&this.control.root.commitAnyPendingChange()},t.onPointerUp=function(e){var t=!1;return!Object(r.c)(Li.a,this.displayedComponent)||this.activatesOnPress||2!==e.inputSource||e.mouseButton?t=this.control.deactivateElement(e):(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),t=!0),t},t.onClick=function(e){var t=!1;return Object(r.c)(Li.a,this.displayedComponent)&&!this.activatesOnPress&&3===e.inputSource&&(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),t=!0),!xn.a.isIPad&&t},t.onTouchMove=function(e){return this.onActivePointerMove(e)},t.onTouchEnd=function(e){return this.deactivateElement(e),!1},t.onActivePointerMove=function(e){if(!Hi.c(this._activeElement)){var t=bt.a.isPointInBounds(this.activeElementBounds,e.clientPoint);return this.setActiveElementHovered(t),!0}return!1},t.onModalBodyPointerDown=function(t){var n=!1;if(this.deactivateElement(t)&&(n=!0),3!==t.inputSource){var i=!0;!this.root&&e.nullCheckRootInOnModalBodyPointerDownIsEnabled&&(ae.ULS.sendTraceTag(588084884,207,50,"Root is null"),i=!1),i&&this.root.closeAllMenus(),n=!0}return n},t.onModalBodyPointerUp=function(e){return this.deactivateElement(e)},t.onModalBodyPointerMove=function(e){return this.onActivePointerMove(e)},t.onModalBodyPointerOut=function(e){return this.deactivateElement(e)},t.onModalBodyClick=function(e){return 3===e.inputSource&&(this.root.closeAllMenus(),!0)},t.onModalBodyMouseWheel=function(e){return!1},t.setActiveElementHovered=function(e){this._activeElementHovered!==e&&(this._activeElementHovered=e,this.activeElementStateChanged(this._activeElementHovered))},t.activeElementStateChanged=function(e){Hi.c(this._activeElement)||ji.a.toggleCSSClassOnElement(this._activeElement,xi.Control.activeClassName,e)},t.activateElement=function(e){this.control.enabled&&(this._activeElement=e,this.root.activeControl=this.control,this.setActiveElementHovered(!0),this.root.beginModal(this.control,!1))},t.deactivateElement=function(t){if(!Hi.c(this._activeElement)){this.setActiveElementHovered(!1);var n=!!this.root;if(e.nullCheckRootInOnModalBodyPointerDownIsEnabled){var i=parseInt(this.control.controlProperties.Command),r=_t.ActionManager.actionIdResolver(i)||"";ae.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",n,r)}if(n&&this.root.endModal(this.control,!1),!Hi.c(t)){var a=t.clientPoint;bt.a.isPointInBounds(this.activeElementBounds,a)&&this.doDefaultAction(this._activeElement,t.inputSource,t.innerEvent)}return n=!!this.root,e.nullCheckRootInOnModalBodyPointerDownIsEnabled&&ae.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",n),n&&(this.root.activeControl=null),this._activeElement=null,this._activeElementBounds=null,!0}return!1},t.focusNext=function(e){var t=this.displayedComponent;return!(!Object(r.c)(Li.a,t)||2===e||4===e||bt.a.isActiveElement(this.control.focusableElement))&&this.setFocusOnControl()},t.setFocusOnControl=function(){try{if(this.control.visible){var e=this.control.focusableElement;if(!Hi.c(e))return e.focus(),!0}}catch(e){0}return!1},t.closeChildMenus=function(e){var t=this.parentMenu;Hi.c(t)||this.root.closeMenuStackAtIndex(t.stackIndex+1,e)},t.onMenuClosed=function(){},t.handleDefaultActionWithKeytips=function(e){return!1},t.getTelemetryData=function(t){var n=null;return t&&t.rawEvent&&((n={})[e.triggerTime]=t.rawEvent.timeStamp),n},Gi(e,[{key:"control",get:function(){return this._control}},{key:"stateProperties",get:function(){return this.control.stateProperties}},{key:"root",get:function(){return this.control.root}},{key:"parentMenu",get:function(){return this.control.parentMenu}},{key:"activatesOnPress",get:function(){return this.control.activatesOnPress}},{key:"displayedComponent",get:function(){return this.control.displayedComponent}},{key:"controlComponentDomCache",get:function(){return this.control.controlComponentDomCache}},{key:"isCommitChangeFixEnabled",get:function(){return this._isCommitChangeFixEnabled}},{key:"activeElementBounds",get:function(){return!Hi.c(this._activeElement)&&Hi.c(this._activeElementBounds)&&(this._activeElementBounds=bt.a.getElementBounds(this._activeElement)),this._activeElementBounds}}],[{key:"nullCheckRootInOnModalBodyPointerDownIsEnabled",get:function(){return null==e._nullCheckRootInOnModalBodyPointerDownIsEnabled&&(e._nullCheckRootInOnModalBodyPointerDownIsEnabled=!!E.AFrameworkApplication.appSettingsManager&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NullCheckRootInOnModalBodyPointerDownIsEnabled")),e._nullCheckRootInOnModalBodyPointerDownIsEnabled}}]),e}();Qi.triggerTime="TriggerTime",Qi._nullCheckRootInOnModalBodyPointerDownIsEnabled=null,Object(s.a)(Qi,"ControlBehavior",null,[216]);var Zi=n(71),$i=n(57);function Xi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ji(e,t,n){return t&&Xi(e.prototype,t),n&&Xi(e,n),e}function Yi(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var er=function(e){function t(t){return e.call(this,t)||this}Yi(t,e);var n=t.prototype;return n.attachEvents=function(e){var t=e.elmControl,n=e.displayMode;Hi.c(t)||(Ye.a.instance.registerHandler(et.EventNames.focus,t,Object(r.d)(this,this.onFocus,"onFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,t,Object(r.d)(this,this.onBlur,"onBlur")),Ri.a.instance.registerHandler(et.EventNames.pointerOver,t,Object(r.d)(this,this.onPointerOver,"onPointerOver")),Ri.a.instance.registerHandler(et.EventNames.pointerOut,t,Object(r.d)(this,this.onPointerOut,"onPointerOut")),gt.KeyInputManager.instance.registerHandlerWithData(et.EventNames.keyDown,t,Object(r.d)(this,this.onKeyDown,"onKeyDown"),n),gt.KeyInputManager.instance.registerHandlerWithData(et.EventNames.keyPress,t,Object(r.d)(this,this.onKeyPress,"onKeyPress"),n),gt.KeyInputManager.instance.registerHandlerWithData(et.EventNames.keyUp,t,Object(r.d)(this,this.onKeyUp,"onKeyUp"),n),Ri.a.instance.registerHandler(et.EventNames.pointerDown,t,Object(r.d)(this,this.onPointerDown,"onPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,t,Object(r.d)(this,this.onPointerUp,"onPointerUp")),Zi.a.instance.registerHandler(et.EventNames.click,t,Object(r.d)(this,this.onClick,"onClick")),$i.a.instance.registerHandler(et.EventNames.touchMove,t,Object(r.d)(this,this.onTouchMove,"onTouchMove")),$i.a.instance.registerHandler(et.EventNames.touchEnd,t,Object(r.d)(this,this.onTouchEnd,"onTouchEnd")))},n.doDefaultAction=function(e,t,n){if(this.control.enabled){var i=null;if(this.displayedComponent&&this.displayedComponent.isMenuItem()&&this.parentMenu){var r=this.parentMenu.stackIndex;(i=this.root.menuLauncherStack[r])&&!this.isCommitChangeFixEnabled&&(i.selectDropdownItem(this.button),i=null)}this.executeCommand(this.control.controlProperties.Command,t,!0,n),i&&i.selectDropdownItem(this.button)}},n.executeCommand=function(e,t,n,i){if(!Hi.c(e)){var r=this.stateProperties;r.CommandValueId=this.button.getCommandValueId(),r.MenuItemId=this.button.getMenuItemId(),r.SourceControlId=this.control.id,this.root.executeCommand(e,r,this.displayedComponent,t,n,null,this.getTelemetryData(i))}},n.pollForStateAndUpdate=function(){Hi.c(this.control.controlProperties.Command)||(2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0&&this.updateVisibility()&&this.updateHtml()},n.updateHtml=function(){this.updateLabelText(),this.updateTooltip(),this.updateImage()},n.onFocus=function(t){return e.prototype.onFocus.call(this,t),this.startLivePreview(),!1},n.onBlur=function(t){return e.prototype.onBlur.call(this,t),this.endLivePreview(),!1},n.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!Hi.c(t.innerEvent)){var i=t.userData,r=t.innerEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(i,r)&&(n=!1)}return n},n.onKeyPress=function(e){var t=!1;if(!Hi.c(e.innerEvent)&&!Hi.c(e.innerEvent.rawEvent)){var n=e.userData,i=e.innerEvent.rawEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(n,i)?(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),t=!0):e.innerEvent.preventDefault()}return t},n.shouldDoDefaultActionOnKeyPress=function(e,t){if(xn.a.isInternetExplorerNonEdge&&t===Sys.UI.Key.enter)switch(e){case"MenuMru":case"MenuTemplate":case"MenuHeader":case"MenuFooter":return!0}return!1},n.onKeyUp=function(t){var n=!1;if(!Hi.c(t.innerEvent)){var i=t.userData,r=t.innerEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(i,r)||(n=e.prototype.onKeyUp.call(this,t))}return n},n.startLivePreview=function(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)},n.endLivePreview=function(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)},Ji(t,[{key:"button",get:function(){return this.control}},{key:"properties",get:function(){return this.control.controlProperties}}]),t}(Qi);Object(s.a)(er,"ButtonBehavior",Qi,[]);var tr=n(228),nr=n(212);n(384);function ir(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rr(e,t,n){return t&&ir(e.prototype,t),n&&ir(e,n),e}function ar(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var or="cui-colorpicker-hoveredOver",sr="cui-colorpicker-selected",lr=function(e){function t(t){var n;return(n=e.call(this,t)||this)._focusedIndex=-1,n._selectedIndex=-1,n}ar(t,e);var n=t.prototype;return n.doDefaultAction=function(e,n,i){if(this.control.enabled){var r=t.getNearestContainingParentElementOfType(e,"td"),a=this.stateProperties;a.Color=r[tr.ColorPicker.colorInformation];var o=null;if(ji.a.isTrue(this.properties.Stateful)&&this.displayedComponent&&this.displayedComponent.isMenuItem()&&this.parentMenu){var s=this.parentMenu.stackIndex;o=this.root.menuLauncherStack[s]}0,this.root.executeCommand(this.properties.Command,a,this.displayedComponent,n,!0,null,this.getTelemetryData(i)),o&&o.selectDropdownItem(this.colorPicker)}},n.pollForStateAndUpdate=function(){var e=this.stateProperties;if(e.SourceControlId=this.properties.Id,(2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,e))>0){var t=-1;if(nr.a.IndexColorSelected in this.stateProperties&&(t=this.stateProperties[nr.a.IndexColorSelected]),t!==this._selectedIndex){var n=this.colorCells;0<=t&&t<n.length&&this.updateCellSelection(n[t],!0),0<=this._selectedIndex&&this._selectedIndex<n.length&&this.updateCellSelection(n[this._selectedIndex],!1),this._selectedIndex=t}}},n.updateCellSelection=function(e,t){t?ji.a.ensureCSSClassOnElement(e,sr):ji.a.removeCSSClassFromElement(e,sr)},n.attachEvents=function(e){for(var t=e,n=0;n<t.aTags.length;++n){var i=t.aTags[n];Ye.a.instance.registerHandler(et.EventNames.focus,i,Object(r.d)(this,this.onCellFocus,"onCellFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,i,Object(r.d)(this,this.onCellBlur,"onCellBlur")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,i,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,i,Object(r.d)(this,this.onKeyUp,"onKeyUp")),Zi.a.instance.registerHandler(et.EventNames.click,i,Object(r.d)(this,this.onCellClick,"onCellClick")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,i,Object(r.d)(this,this.onCellPointerUp,"onCellPointerUp")),Ri.a.instance.registerHandler(et.EventNames.pointerOver,i,Object(r.d)(this,this.onCellPointerOver,"onCellPointerOver")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,i,Object(r.d)(this,this.onCellPointerDown,"onCellPointerDown"))}},n.onCellFocus=function(e){var n=t.getNearestContainingParentElementOfType(e.sourceElement,"td");return this.parentMenu.updateFocusedIndex(this.displayedComponent),this.updateCellFocus(n,!0),!0},n.onCellBlur=function(e){var n=t.getNearestContainingParentElementOfType(e.sourceElement,"td");return this.updateCellFocus(n,!1),!0},n.updateCellFocus=function(e,t){t?(this._focusedIndex=parseInt(e.getAttribute("arrayPosition")),ji.a.ensureCSSClassOnElement(e,or),this.startLivePreview(e)):(this._focusedIndex=-1,this.endLivePreview(e),ji.a.removeCSSClassFromElement(e,or))},n.onCellClick=function(e){return 3===e.inputSource&&this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),!0},n.onCellPointerUp=function(e){return 3!==e.inputSource&&this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),!0},n.onCellPointerOver=function(e){this.closeChildMenus(!1);var n=t.getNearestContainingParentElementOfType(e.sourceElement,"td"),i=parseInt(n.getAttribute("arrayPosition"));return this.setFocusOnCell(i),!0},n.onCellPointerDown=function(e){return!1},n.startLivePreview=function(e){if(this.control.enabled){0;var t=this.properties.CommandPreview;if(!Hi.b(t)){var n=this.stateProperties;n.Color=e[tr.ColorPicker.colorInformation],this.root.executeCommand(t,n,this.displayedComponent,0,!1)}}},n.endLivePreview=function(e){if(this.control.enabled){var t=this.properties.CommandRevert;if(!Hi.b(t)){var n=this.stateProperties;n.Color=e[tr.ColorPicker.colorInformation],this.root.executeCommand(t,n,this.displayedComponent,0,!1)}}},n.focusNext=function(e){var t=xi.Control.focusNextIndexInGrid(this._focusedIndex,this.colorPicker.width,this.colorCells.length,e);return!(t===this._focusedIndex||!this.setFocusOnCell(t))||(this.updateCellFocus(this.colorCells[this._focusedIndex],!1),!1)},n.setFocusOnControl=function(){return this.setFocusOnCell(0)},n.setFocusOnCell=function(e){if(this.colorCells&&this.colorCells.length>e){var t=this.colorCells[e];if(t.firstChild)return t.firstChild.focus(),!0}return!1},n.onMenuClosed=function(){-1!==this._focusedIndex&&this.updateCellFocus(this.colorCells[this._focusedIndex],!1)},t.getNearestContainingParentElementOfType=function(e,n){return t.getNearestContainingParentElementOfTypes(e,[n])},t.getNearestContainingParentElementOfTypes=function(e,t){var n=t.length;if(!e)return null;for(var i=0;i<n;i++)if(e.tagName.toLowerCase()===t[i].toLowerCase())return e;for(var r=e.parentNode;r;){for(var a=0;a<n;a++)if(r.tagName.toLowerCase()===t[a].toLowerCase())return r;r=r.parentNode}return null},rr(t,[{key:"colorPicker",get:function(){return this.control}},{key:"colorCells",get:function(){return this.colorPicker.colorPickerDom.colorCells}},{key:"properties",get:function(){return this.colorPicker.controlProperties}}]),t}(Qi);Object(s.a)(lr,"ColorPickerBehavior",Qi,[]);var cr=n(11),ur=n(175),dr=n(256),pr=n(125),hr=function(){};hr.Callback="action",Object(s.a)(hr,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var mr=n(69),gr="msCSSOMElementFloatMetrics",fr=function(){function e(e,t){this._savedFloatMetricsState=!1,this._usingFloatMetrics=!1,this._floatMetricsGetter=e,this._floatMetricsSetter=t,this.ensureUsingFloatMetrics()}var t=e.prototype;return t.ensureUsingFloatMetrics=function(){this._usingFloatMetrics||(this._savedFloatMetricsState=this._floatMetricsGetter(),this._floatMetricsSetter(!0)),this._usingFloatMetrics=!0},t.doneUsingFloatMetrics=function(){this._usingFloatMetrics&&this._floatMetricsSetter(this._savedFloatMetricsState),this._usingFloatMetrics=!1},t.dispose=function(){this.doneUsingFloatMetrics()},e.create=function(){return new e(e.getUsingCssFloatMetrics,e.setUsingCssFloatMetrics)},e.getUsingCssFloatMetrics=function(){return window.document[gr]},e.setUsingCssFloatMetrics=function(e){window.document[gr]=e},e}();Object(s.a)(fr,"CssFloatMetricsActivator",null,[4]);var vr=n(87),_r=n(348),yr=function(){function e(e,t){this._textDirectionLtr=e,this._isAppDivSyndicated=t}var t=e.prototype;return t.setFlyoutCoordinates=function(t,n,i,r){if(Hi.c(t)||Hi.c(n))return null;var a,o,s=new _r.a,l=r.x,c=r.y,u=r.width,d=r.height,p=e.dictToInt(n,"flyoutWidth"),h=e.dictToInt(n,"flyoutRealHeight"),m=e.dictToInt(n,"viewportWidth"),g=e.dictToInt(n,"viewportHeight"),f=e.dictToInt(n,"viewableLeft"),v=e.dictToInt(n,"viewableTop"),_=this._textDirectionLtr,y=!1,b=!1,S=1===i,C=4===i,A=this._isAppDivSyndicated;if(t.style.maxHeight="none",t.style.top="0px",t.style.overflowY="visible",t.style.width="auto",p=this.measureWidth(t),s.viewPortHeight=g,s.viewPortWidth=m,S)_?a=l+u:(a=l-p,s.launchedLeft=!0),o=c;else{var I="";u>p&&(I=((p=u)-2*vr.Menu.menuBorderPx).toString()),_?a=l:(a=l+u-p,s.launchedLeft=!0),o=c+d,""!==I&&(t.style.minWidth=I+"px")}A&&(o+=v,a+=f),t.style.top=o+"px",t.style.left=a+"px";var w=!1,T=!1;p<=m?a+p>f+m?(S&&_&&l-p>f||C&&l-p>f?(a=l-p,A&&(a+=f),s.launchedLeft=!0,T=!0):(a=f+m-p,y=!0),w=!0):a<f&&(S&&!_&&l+u+p<f+m?(a=l+u,A&&(a+=f),s.launchedLeft=!1,T=!0):(a=f,b=!0,s.launchedLeft=!0),w=!0):_?(a=f,w=!0,s.launchedLeft=!0):(a=f+m-p,w=!0,s.launchedLeft=!1),w&&(t.style.left=a+"px");var E,k,M,P,F=o+h<=v+g;(s.flyoutTop=o,F&&3!==i)||(s.launchedUp=!0,this.fitFlyoutVertically(i,o,h,c,v,g,Object(cr.a)((function(){return E}),(function(e){return E=e})),Object(cr.a)((function(){return k}),(function(e){return k=e})),Object(cr.a)((function(){return M}),(function(e){return M=e})),Object(cr.a)((function(){return P}),(function(e){return P=e}))),o!==E&&(t.style.top=E+"px",s.flyoutTop=E),k>-1&&(t.style.maxHeight=k+"px"),M&&(t.style.bottom="0px",t.style.height="auto"),P&&this.makeFlyoutScrollable(t,_,S,T,b,y,m,l,u));return s.flyoutLeft=a,s.flyoutWidth=p,s.flyoutHeight=h,s},t.fitFlyoutVertically=function(e,t,n,i,r,a,o,s,l,c){o.val=t,s.val=-1,l.val=!1,c.val=!1;var u=t,d=r+a-t;t=i-n;var p=this._isAppDivSyndicated,h=!1;t<0&&(t=r);var m=i;(p||(m-=r),n<=m&&1!==e)||(4===e||1===e?n<a?(t=a-n,l.val=!0):(t=r,l.val=!0,c.val=!0,h=!0):(m<d&&3!==e?(t=u,l.val=!0):s.val=m,c.val=!0));p&&(l.val=!1,h?s.val=a:t+=r),o.val=t},t.makeFlyoutScrollable=function(e,t,n,i,r,a,o,s,l){if(e.style.overflowY="scroll",e.style.width="auto",t){if(a||i){var c=a?0:o-s;e.style.left="",e.style.right=c+"px"}}else if(!r&&!i){var u=n?o-s:o-s-l;e.style.left="",e.style.right=u+"px"}},t.getDimensionsForMenu=function(e){var t={};if(Hi.c(e))return t;t.viewportWidth=fn.DomUtils.getViewPortWidth(),t.viewportHeight=fn.DomUtils.getViewPortHeight(),Hi.c(t.viewportWidth)&&(t.viewportWidth=document.documentElement.clientWidth,t.viewportHeight=document.documentElement.clientHeight),Hi.c(t.viewportWidth)&&(t.viewportWidth=document.body.clientWidth,t.viewportHeight=document.body.clientHeight),t.viewableTop=window.pageYOffset,t.viewableLeft=window.pageXOffset,Hi.c(t.viewableTop)&&(t.viewableTop=document.documentElement.scrollTop,t.viewableLeft=document.documentElement.scrollLeft),Hi.c(t.viewableTop)&&(t.viewableTop=document.body.scrollTop,t.viewableLeft=document.body.scrollLeft),e.scrollHeight!==e.offsetHeight?t.flyoutRealHeight=e.scrollHeight+2*vr.Menu.menuBorderPx:t.flyoutRealHeight=e.scrollHeight;var n=e.style.overflowY;return e.style.overflowY="visible",t.flyoutWidth=this.measureWidth(e),e.style.overflowY=n,t},t.measureWidth=function(e){return e.offsetWidth},e.dictToInt=function(e,t){return Hi.c(e)?0:e[t]},e}();Object(s.a)(yr,"MenuPositioner",null,[]);var br=n(152),Sr=n(177),Cr=(n(385),n(341)),Ar=n(286),Ir=n(346),wr=n(342),Tr=(n(161),n(209));function Er(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kr(e,t,n){return t&&Er(e.prototype,t),n&&Er(e,n),e}function Mr(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Pr=function(e){function t(t){var n;return(n=e.call(this,t)||this)._menuInvocationMethod=0,n._lastDynamicPopulationXml=null,n._pendingBackFrameTimeoutId=-1,n._elmBackFrame=null,n._hasAsyncCallbackBeenSentToHandler=!1,n.polledOnce=!1,n._menuPositioner=new yr(!n.root.textDirection,ji.a.isTrue(n.root.properties.DivSyndicated)),n}Mr(t,e);var n=t.prototype;return n.doDefaultAction=function(e,t,n){this.menuLauncher.launchMenu(t)},n.launchMenu=function(e){if(this.menuLauncher.enabled&&!this.menuLaunched){var t=dr.a.instance.startActivity(ft.a.launchMenu);t.properties.add("Id",this.menuLauncher.controlProperties.Id),t.properties.add("InputMethod",ur.a[e]),t.end(),mr.a.mark(10326),bt.a.measureTimeToNextFrame(this.menuLauncher.controlProperties.Id,"MenuOpen"),this.menuLauncher.focusableElement&&(this.menuLauncher.elmHadFocus=bt.a.getActiveElement(this.menuLauncher.focusableElement.ownerDocument)),this._menuInvocationMethod=e,this.populateAndPositionMenu(e),this.sendNotifyAsyncMenuTrigger(),this.menuLauncher.updateAriaMenuLauncherAttributes(this.menuLauncher.focusableElement,!0)}},n.sendNotifyAsyncMenuTrigger=function(){Hi.c(this.properties.PopulateAsyncTriggerCommand)||this._hasAsyncCallbackBeenSentToHandler||(this.notifyAsyncMenuTrigger(),this._hasAsyncCallbackBeenSentToHandler=!0)},n.notifyAsyncMenuTrigger=function(){var e={};e[hr.Callback]=Object(r.d)(this,this.refreshMenuCallback,"refreshMenuCallback"),this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,e,this.displayedComponent,0,!1)},n.refreshMenuCallback=function(){this.menuLauncher.refreshMenu()},n.refreshMenu=function(){this.menuLaunched&&this.populateAndPositionMenu(this._menuInvocationMethod,!0)},n.populateAndPositionMenu=function(e,t){void 0===t&&(t=!1);var n=!0;if(ji.a.isTrue(this.properties.PopulateDynamically)){var i=!1,r=this.pollForDynamicMenu(e);r!==this._lastDynamicPopulationXml&&(i=this.populateMenuFromXml(r,t)),n=i||!this.menuLaunched}if(n){var a=E.AFrameworkApplication.activeFrame.theStopwatchBuilder,o=null;a&&(o=a.makeAndStartStopwatch("LoadResource","Menu Initialization")),this.initializeMenu(e),o&&o.stop(),this.onMenuChanged()}},n.initializeMenu=function(e){if(Hi.c(this.menu))mr.a.mark(10327);else{if(this.menuLauncher.parentKeytipsIds){var t=this.menuLauncher.displayedComponent;if(t&&t.keytip){var n=t.keytip.key.toLocaleLowerCase();this.menu.setParentKeytipsIdsForMenuItems(String.format("{0} {1}",this.menuLauncher.parentKeytipsIds,t.keytip.elementId),this.menuLauncher.parentKeytipsKeys&&""!==this.menuLauncher.parentKeytipsKeys?String.format("{0}-{1}",this.menuLauncher.parentKeytipsKeys,n):n)}}this.menu.ensureRefreshed(),ji.a.ensureCSSClassOnElement(this.menu.elementInternal,this.menuLauncher.additionalMenuCssClass);var i=3===e||this.root.touchModeForcedOn;if(ji.a.toggleCSSClassOnElement(this.menu.elementInternal,"cui-touch",i),this.menu.hasItems()){this.menu.attachEvents();var a=this.displayedComponent;a.ensureChildren(),a.ignoreDirtyingEvents=!0,a.addChild(this.menu),a.ignoreDirtyingEvents=!1,this.menu.pollIfRootPolledSinceLastPoll();var o=Object(r.c)(Tr.a,this.root),s=null,l=!1;o&&(l=(s=this.root).shouldHandleElementResize,s.shouldHandleElementResize=!1);var c=this.menu.elementInternal;c.style.visibility="hidden",c.style.position="absolute",c.style.top="0px",c.style.left="0px",xn.a.isInternetExplorerNonEdge&&!xn.a.isInternetExplorer9Up&&(c.style.maxHeight="100px",c.style.overflowY="scroll"),document.body.appendChild(c),this.adjustMenuLayout(),this.positionMenu(c),Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.addAndPositionBackFrame(),ji.a.ensureCSSClassOnElement(this.menuLauncher.launcher,Ni.MenuLauncher.menuDroppedClassName);var u=this.root.menuStackDepth;this.shouldGoModal&&this.root.beginModal(this.control,!0),c.style.zIndex=String(E.AFrameworkApplication.activeFrame.activeModalUIZIndex),this.root.addMenuLauncherToStack(this.menuLauncher),this.menu.stackIndex=u,c.style.visibility="visible";var d=this.getChildElementsToAnimate();if(Object(r.c)(Ir.a,this.menu)){c.style.position="fixed";var p=this.root.menuLauncherStack[0];p&&p.menu&&p.menu.elementInternal?100!==bt.a.getOpacity(this.root.menuLauncherStack[0].menu.elementInternal)&&pr.e(c,d,Object(r.d)(this,this.afterShowMenu,"afterShowMenu")):pr.e(c,d,Object(r.d)(this,this.afterShowMenu,"afterShowMenu"))}else pr.e(c,d,Object(r.d)(this,this.afterShowMenu,"afterShowMenu"));this.menuLaunched=!0,this.menu.launched=!0,!xn.a.isIPad&&this.menuLauncher.sendFocusToMenuDrop&&this.menu.setFocus(e),o&&(s.shouldHandleElementResize=l);var h=this.properties.CommandMenuOpen;Hi.b(h)||this.root.executeCommand(h,null,a,e,!1),mr.a.mark(10327)}else mr.a.mark(10327)}},n.onMenuChanged=function(){},n.addAndPositionBackFrame=function(){var e=this;ji.a.cancelPendingTimeout(Object(cr.a)((function(){return e._pendingBackFrameTimeoutId}),(function(t){return e._pendingBackFrameTimeoutId=t}))),this._pendingBackFrameTimeoutId=window.setTimeout(Object(r.d)(this,this.addAndPositionBackFrameInternal,"addAndPositionBackFrameInternal"),50)},n.addAndPositionBackFrameInternal=function(){this.menu&&this.menu.elementInternal&&(document.body.appendChild(this.backFrame),this.positionBackFrame())},n.positionBackFrame=function(){var e=this.backFrame,t=this.menu.elementInternal;e.style.position="absolute",e.style.visibility="hidden",e.style.left=t.style.left,e.style.right=t.style.right,e.style.top=t.style.top,e.style.bottom=t.style.bottom;var n=t.offsetWidth,i=t.offsetHeight;xn.a.isInternetExplorer9Up&&(n-=4,i-=4),e.style.width=n.toString()+"px",e.style.height=i.toString()+"px",e.style.visibility="visible"},n.afterShowMenu=function(e){e.element&&(e.element.style.filter="",e.element.style.opacity="",this.menu&&this.menu.elementInternal===e.element&&Object(r.c)(Ar.a,this.menu)&&pr.b(this.menu.elementInternal,this.getChildElementsToAnimate()))},n.getChildElementsToAnimate=function(){var e=this.menu.children,t=[];if(Object(r.c)(Ar.a,this.menu))for(var n=0;n<e.count;n++){var i=e.get_item(n);Array.add(t,i.separator);for(var a=0;a<i.children.count;a++){var o=i.children.get_item(a);Array.add(t,o.elementInternal)}}return t},n.adjustMenuLayout=function(){for(var e=this.menu.children,t=0;t<e.count;t++)for(var n=e.get_item(t).children,i=0;i<n.count;i++){var a=n.get_item(i);if(Object(r.c)(Li.a,a)){var o=a;if("Menu32"===o.displayMode||"Menu48"===o.displayMode){var s=a.control;s.behavior&&(Object(r.c)(Sr.a,s)||Object(r.c)(Cr.a,s))&&s.behavior.adjustLayoutForLargeMenu()}}}if(e.count>0){var l=e.get_item(0);Hi.c(l.separator)||(l.separator.style.display="none"),Hi.c(l.titleElement)||ji.a.ensureCSSClassOnElement(l.titleElement,"cui-menusection-titleAtTop")}},n.positionMenu=function(e){if(!Hi.c(e)){e.style.top="0px",e.style.left="0px",e.style.bottom="",e.style.right="",e.style.width="",e.style.minWidth="";var t=fr.create();try{var n=this.menuPositioner.getDimensionsForMenu(e),i=this.getLauncherBounds(),r=this.root.setFlyoutCoordinates(e,n,this.menuLauncher.menuDirection,i);r||(r=this.menuPositioner.setFlyoutCoordinates(e,n,this.menuLauncher.menuDirection,i)),this.root.menuPositioningInfo=r}finally{t&&t.dispose()}}},n.getLauncherBounds=function(){var e=bt.a.getElementBounds(this.menuLauncher.launcher),t=this.parentMenu;if(!Hi.c(t)&&!Hi.c(t.elementInternal)){var n=bt.a.getElementBounds(t.elementInternal);e.x=n.x+vr.Menu.menuBorderPx,e.width=n.width-2*vr.Menu.menuBorderPx}return e},n.closeMenu=function(){var e;if(this.menuLauncher.menuLaunched){ae.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",((e={}).Id=this.menuLauncher.controlProperties.Id,e)),this.menu.onMenuClosed(),this.removeMenuFromHierarchy(),this.menuLaunched=!1,this.menu.launched=!1,this.root.endModal(this.control,!0),this.shouldRestoreFocusToApp?E.AFrameworkApplication.activeFrame.restoreFocusAfterDismissingPopup(this.menuLauncher.elmHadFocus,this._menuInvocationMethod):this.restoreFocusToElmHadFocus(),this.menuLauncher.elmHadFocus=null;var t=this.menuLauncher.launcher;ji.a.removeCSSClassFromElement(t,Ni.MenuLauncher.menuDroppedClassName),this.menuLauncher.updateAriaMenuLauncherAttributes(this.menuLauncher.focusableElement,!1),ji.a.removeCSSClassFromElement(t,"cui-ctl-menu-hovered-without-focus"),this.menu.resetFocusedIndex();var n=this.properties.CommandMenuClose;Hi.b(n)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.displayedComponent,0,!1),this.removeMenuFromDom()}},n.restoreFocusToElmHadFocus=function(){var e=this.menuLauncher.elmHadFocus;if(e)try{e.focus()}catch(e){0}else 0},n.removeMenuFromDom=function(){fn.DomUtils.removeElement(this.menu.elementInternal),fn.DomUtils.removeElement(this._elmBackFrame),ji.a.unregisterAllHandlers(this.menu.elementInternal)},n.pollForDynamicMenu=function(e){if(this.polledOnce&&ji.a.isTrue(this.properties.PopulateOnlyOnce))return null;if(Hi.c(this.properties.PopulateQueryCommand))return null;null==e&&(e=0);var t=this.menuLauncher.getCommandPopulateProperties();return(1&this.root.pollForCommandState(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,t,e))>0?t.PopulationXML:null},n.populateMenuFromXml=function(e,t){if(void 0===t&&(t=!1),this.polledOnce&&ji.a.isTrue(this.properties.PopulateOnlyOnce))return!0;var n=null;if(this._lastDynamicPopulationXml=e,Hi.c(e)||(n=this.createMenuFromXml(e)),Hi.c(n)||(this.polledOnce=!0),t){if(this.root.clearMenuStack(this.menuLauncher),Hi.c(n)||!n.hasItems())return this.closeMenu(),!1;this.removeMenuFromHierarchy(),this.removeMenuFromDom()}return this.setMenu(n),!0},n.onDynamicMenuPopulated=function(){},n.createMenuFromXml=function(e){var t=br.Builder.convertXMLStringToJSON(e);if(!Hi.c(t)){var n=new wr.a;n.cloneControlsForMenu=!0,n.parentId=this.control.id;return this.root.builder.buildMenu(t,n,!1)}return null},n.setMenu=function(e){Hi.c(e)||(Hi.c(this.menu)||this.menu.dispose(),this.menu=e,this.onDynamicMenuPopulated())},n.removeMenuFromHierarchy=function(){var e=this.menu.parent;e.ignoreDirtyingEvents=!0,e.removeChild(this.menu.id),e.ignoreDirtyingEvents=!1},n.onKeyDown=function(t){var n=!1;Hi.c(t.innerEvent)||Hi.c(t.innerEvent.rawEvent)||(Object(r.c)(Li.a,this.displayedComponent)||t.innerEvent.rawEvent.altKey&&t.innerEvent.keyCode===Sys.UI.Key.down&&(this.doDefaultAction(t.sourceElement,1,t.innerEvent),n=!0));return n||(n=e.prototype.onKeyDown.call(this,t)),n},n.onPointerDown=function(e){return this.commitRootPendingChanges(),2===e.inputSource&&e.mouseButton||this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),e.innerEvent.preventDefault(),!1},n.handleDefaultActionWithKeytips=function(e){return!!(this.parentMenu&&this.parentMenu.inKeytipMode&&this.menuLauncher.onMenuLaunchCallback)&&(this.menuLauncher.onMenuLaunchCallback(this.displayedComponent,e),!0)},t.createHiddenIframeElement=function(){var e=ji.a.createElement("iframe");return e.style.position="absolute",e.style.visibility="hidden",e.style.borderWidth="0px",e},kr(t,[{key:"menuPositioner",get:function(){return this._menuPositioner}},{key:"menuLauncher",get:function(){return this.control}},{key:"properties",get:function(){return this.control.controlProperties}},{key:"menu",get:function(){return this.menuLauncher.menu},set:function(e){this.menuLauncher.menu=e}},{key:"menuLaunched",get:function(){return this.menuLauncher.menuLaunched},set:function(e){this.menuLauncher.menuLaunched=e}},{key:"backFrame",get:function(){return Hi.c(this._elmBackFrame)&&(this._elmBackFrame=t.createHiddenIframeElement()),this._elmBackFrame}},{key:"shouldRestoreFocusToApp",get:function(){return!this.root.inModalMode}},{key:"shouldGoModal",get:function(){return!this.root.menuStackDepth}}]),t}(Qi);Object(s.a)(Pr,"MenuLauncherBehavior",Qi,[234,216]);var Fr=n(215);function Dr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Or(e,t,n){return t&&Dr(e.prototype,t),n&&Dr(e,n),e}function Rr(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var xr=function(e){function t(t){return e.call(this,t)||this}Rr(t,e);var n=t.prototype;return n.attachEvents=function(e){Ri.a.instance.registerHandler(et.EventNames.pointerDown,this.dropDownDom.elmControl,Object(r.d)(this,this.onPointerDown,"onPointerDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,this.dropDownDom.elmControl,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,this.dropDownDom.elmControl,Object(r.d)(this,this.onKeyUp,"onKeyUp"))},n.pollForStateAndUpdate=function(){var e=this.stateProperties[Fr.a.SelectedItemId];if((2&this.pollForStateAndUpdateInternal(this.properties$2.Command,this.properties$2.QueryCommand,this.stateProperties))>0){var t=this.stateProperties[Fr.a.SelectedItemId];Hi.c(t)||e===t||this.dropDown.selectDropdownItemById(t)||(this.stateProperties[Fr.a.SelectedItemId]=null)}},Or(t,[{key:"properties$2",get:function(){return this.dropDown.properties}},{key:"dropDown",get:function(){return this.control}},{key:"dropDownDom",get:function(){return this.dropDown.dropDownDom}}]),t}(Pr);Object(s.a)(xr,"DropDownBehavior",Pr,[]);var Ur=n(73),Br=n(95);n(386),n(195);function Lr(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Nr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Nr(e,t){if(e){if("string"==typeof e)return Hr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hr(e,t):void 0}}function Hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Wr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jr(e,t,n){return t&&Wr(e.prototype,t),n&&Wr(e,n),e}function Vr(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Kr=function(e){function t(t){var n;return(n=e.call(this,t)||this)._elmHadFocus=null,n._mouseupOnTextboxSinceFocus=!1,n._inputFocused=!1,n._needMenuContentsForAutocomplete=!1,n._pendingDropdownItemId=null,n._pendingAutoCompleteTimeoutId=-1,n}Vr(t,e);var n=t.prototype;return n.attachEvents=function(e){var t=e;Ri.a.instance.registerHandler(et.EventNames.pointerDown,t.elmControl,Object(r.d)(this,this.onPointerDown,"onPointerDown"));var n=t.elmInput;Ye.a.instance.registerHandler(et.EventNames.focus,n,Object(r.d)(this,this.onInputFocus,"onInputFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,n,Object(r.d)(this,this.onInputBlur,"onInputBlur")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,n,Object(r.d)(this,this.onInputKeyDown,"onInputKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyPress,n,Object(r.d)(this,this.onInputKeyPress,"onInputKeyPress")),Ur.a.instance.registerHandler(et.EventNames.mouseUp,n,Object(r.d)(this,this.onInputMouseUp,"onInputMouseUp")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,n,Object(r.d)(this,this.onInputPointerDown,"onInputPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,t.elmBtnA,Object(r.d)(this,this.onMenuButtonPointerDown,"onMenuButtonPointerDown"))},n.pollForStateAndUpdate=function(){(2&this.pollForStateAndUpdateInternal(this.cbProperties.Command,this.cbProperties.QueryCommand,this.stateProperties))>0&&(this._inputFocused||this.updateValueAndSelectedControl(),this.updateFontStyle())},n.onDynamicMenuPopulated=function(){this.comboBox.menuItems=null;var e=null,t=null,n=null;if(!Hi.c(this.menu)){this.setAriaOwnsAttributeWithMenuId();for(var i,a=Lr(this.menu.children);!(i=a()).done;)for(var o,s=Lr(i.value.children);!(o=s()).done;){var l=o.value;Object(r.c)(Li.a,l)&&(e=l.control,Object(r.c)(88,e)&&(t=e.getMenuItemId()),Object(r.c)(87,e)&&(n=e.getTextValue()),Hi.c(t)||Hi.c(n)||(this.comboBox.menuItems[n]=t,n=null,t=null))}}},n.onInputPointerDown=function(e){return!1},n.onPointerDown=function(t){this.commitRootPendingChanges();var n=!1;return 3===t.inputSource&&(n=e.prototype.onPointerDown.call(this,t),this.setAriaOwnsAttributeWithMenuId()),n&&t.innerEvent.preventDefault(),!1},n.onMenuButtonPointerDown=function(e){var t=!1;return 2===e.inputSource&&e.mouseButton||(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),this.setAriaOwnsAttributeWithMenuId(),t=!0),t&&e.innerEvent.preventDefault(),!1},n.onInputKeyDown=function(e){var t=!1;if(!Hi.c(e.innerEvent)&&!Hi.c(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode;n.shiftKey,n.altKey,ji.a.isTrue(this.cbProperties.AutoComplete);i===Sys.UI.Key.enter?(this.commitPendingChange(),this.restoreFocusFromFloatie(),t=!0):i===Sys.UI.Key.tab?(this.commitPendingChange(),this.restoreFocusFromFloatie()):i===Sys.UI.Key.backspace||i===Sys.UI.Key.del?this.control.enabled?(this.cancelPendingAutoComplete(),this._pendingDropdownItemId=null):t=!0:i===Sys.UI.Key.esc?(this.restoreToKnownValue(),this.restoreFocusFromFloatie(),t=!0):i===Sys.UI.Key.down&&(this.launchMenu(1),this.setAriaOwnsAttributeWithMenuId(),t=!0)}return t},n.onInputKeyPress=function(e){return!this.control.enabled||(!Hi.c(e.innerEvent)&&e.innerEvent.charCode&&this.delayAutoComplete(),!1)},n.onInputMouseUp=function(e){return!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)},n.executeAutoComplete=function(){this._pendingAutoCompleteTimeoutId=-1;var e=this.comboBoxDom.elmInput,t=e.value,n=this.getFirstMenuItemThatBeginsWith(t);if(n){if(e.value=n.key,e.setSelectionRange)e.setSelectionRange(t.length,e.value.length);else if(e.createTextRange){var i=e.createTextRange();i.moveStart("character",t.length),i.moveEnd("character",e.value.length),i.select()}else 0;this._pendingDropdownItemId=n.value}else this._pendingDropdownItemId=null},n.getFirstMenuItemThatBeginsWith=function(e){var t=this.comboBox.menuItems;for(var n in t){var i={key:n,value:t[n]};if(i.key.toLowerCase().startsWith(e.toLowerCase()))return i}return null},n.delayAutoComplete=function(){ji.a.isTrue(this.cbProperties.AutoComplete)&&-1===this._pendingAutoCompleteTimeoutId&&(this._needMenuContentsForAutocomplete&&(this.pollForDynamicMenu(0),this._needMenuContentsForAutocomplete=!1),this._pendingAutoCompleteTimeoutId=window.setTimeout(Object(r.d)(this,this.executeAutoComplete,"executeAutoComplete"),this.comboBox.autoCompleteDelay))},n.cancelPendingAutoComplete=function(){var e=this;ji.a.isTrue(this.cbProperties.AutoComplete)&&ji.a.cancelPendingTimeout(Object(cr.a)((function(){return e._pendingAutoCompleteTimeoutId}),(function(t){return e._pendingAutoCompleteTimeoutId=t})))},n.onInputFocus=function(e){return this.menuLaunched?(this.menu.setFocus(0),!0):(this.onFocus(e),this._inputFocused=!0,ji.a.ensureCSSClassOnElement(this.comboBoxDom.elmControl,"cui-cb-focus"),ji.a.isTrue(this.cbProperties.PopulateDynamically)&&(this._needMenuContentsForAutocomplete=!0),bt.a.selectAllTextInInput(this.comboBoxDom.elmInput),Hi.c(this.menu)||this.menu.refreshInternal(),this._mouseupOnTextboxSinceFocus=!1,!1)},n.onInputBlur=function(e){return this._inputFocused=!1,this.commitPendingChange(),ji.a.removeCSSClassFromElement(this.comboBoxDom.elmControl,"cui-cb-focus"),!1},n.restoreFocusFromFloatie=function(){0},n.commitPendingChange=function(){if(this.control.enabled){this.cancelPendingAutoComplete();var e=this.comboBoxDom.elmInput;if(void 0!==this.stateProperties[Br.a.Value]&&null!==this.stateProperties[Br.a.Value]&&e.value===this.stateProperties[Br.a.Value].toString())return;if(this.comboBox.selectDropdownItemById(this._pendingDropdownItemId)){var t;this.isFreeForm=!1,this.stateProperties[Br.a.Value]=e.value;var n=((t={}).IsFreeForm=!1,t.CommandValueId=this.comboBox.selectedControl.getCommandValueId(),t.MenuItemId=this.comboBox.selectedControl.getMenuItemId(),t);this.root.executeCommand(this.cbProperties.Command,n,this.displayedComponent,0,!1)}else{if(!ji.a.isTrue(this.cbProperties.AutoComplete)){var i=this.comboBox.menuItems[e.value];if(!Hi.b(i)&&this.comboBox.selectDropdownItemById(i)){var r;this.isFreeForm=!1,this.stateProperties[Br.a.Value]=e.value;var a=((r={}).IsFreeForm=!1,r.CommandValueId=this.comboBox.selectedControl.getCommandValueId(),r.MenuItemId=i,r);return void this.root.executeCommand(this.cbProperties.Command,a,this.displayedComponent,0,!1)}}var o,s=!Hi.b(e.value)&&""!==Le.a.removeAllWhitespace(e.value);if(!this.comboBox.allowFreeForm||!s)return void this.restoreToKnownValue();this.isFreeForm=!0,this.stateProperties[Br.a.Value]=e.value;var l=((o={}).IsFreeForm=!0,o.Value=e.value,o);this.root.executeCommand(this.cbProperties.Command,l,this.displayedComponent,0,!1)}}else this.restoreToKnownValue()},n.restoreToKnownValue=function(){this.cancelPendingAutoComplete(),this._pendingDropdownItemId=null,this.updateValueAndSelectedControl()},n.updateValueAndSelectedControl=function(){var e=this.stateProperties[Br.a.Value]||"";e!==this.comboBoxDom.elmInput.value&&(this.comboBoxDom.elmInput.value=e),this.comboBox.selectDropdownItemById(this.comboBox.menuItems[e])},n.updateFontStyle=function(){var e=this.stateProperties[Br.a.FontStyle]||"normal";e!==this.comboBoxDom.elmInput.style.fontStyle&&(this.comboBoxDom.elmInput.style.fontStyle=e)},n.setAriaOwnsAttributeWithMenuId=function(){this.control.focusableElement&&this.menu&&this.control.focusableElement.setAttribute(gn.a.ariaOwnsAttribute,this.menu.id)},jr(t,[{key:"comboBox",get:function(){return this.control}},{key:"comboBoxDom",get:function(){return this.comboBox.comboBoxDom}},{key:"cbProperties",get:function(){return this.comboBox.cbProperties}},{key:"isFreeForm",get:function(){return this.stateProperties[Br.a.IsFreeForm]},set:function(e){this.stateProperties[Br.a.IsFreeForm]=e}}]),t}(xr);function zr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qr(e,t,n){return t&&zr(e.prototype,t),n&&zr(e,n),e}function Gr(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(Kr,"ComboBoxBehavior",xr,[]);var Qr=function(e){function t(t){return e.call(this,t)||this}return Gr(t,e),t.prototype.getLauncherBounds=function(){var e=0;return this.menu&&this.menu.elementInternal&&2===this.menu.horizontalAlignment&&(e=this.menu.elementInternal.clientWidth),new Sys.UI.Bounds(this.contextMenuLauncher.x-e,this.contextMenuLauncher.y,this.contextMenuLauncher.launcherWidth,this.contextMenuLauncher.launcherHeight)},qr(t,[{key:"contextMenuLauncher",get:function(){return this.control}}]),t}(Pr);function Zr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $r(e,t,n){return t&&Zr(e.prototype,t),n&&Zr(e,n),e}function Xr(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(Qr,"ContextMenuLauncherBehavior",Pr,[]);var Jr=function(e){function t(t){return e.call(this,t)||this}return Xr(t,e),t.prototype.getLauncherBounds=function(){return new Sys.UI.Bounds(this.dialogMenuLauncher.x,this.dialogMenuLauncher.y,this.dialogMenuLauncher.launcherWidth,this.dialogMenuLauncher.launcherHeight)},$r(t,[{key:"dialogMenuLauncher",get:function(){return this.control}}]),t}(Pr);Object(s.a)(Jr,"DialogMenuLauncherBehavior",Pr,[]);var Yr=n(98);function ea(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ta(e,t,n){return t&&ea(e.prototype,t),n&&ea(e,n),e}function na(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var ia=function(e){function t(t){var n;return(n=e.call(this,t)||this)._needToRefreshAfterMenuClose=!1,n._shouldRefreshWhenDropped=!ji.a.isFalse(n.properties$2.ShouldRefreshWhenDropped),n}na(t,e);var n=t.prototype;return n.attachEvents=function(e){var t=e.elmControl;Hi.c(t)||(Ye.a.instance.registerHandler(et.EventNames.focus,t,Object(r.d)(this,this.onFocus,"onFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,t,Object(r.d)(this,this.onBlur,"onBlur")),Ri.a.instance.registerHandler(et.EventNames.pointerOver,t,Object(r.d)(this,this.onPointerOver,"onPointerOver")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,t,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,t,Object(r.d)(this,this.onKeyUp,"onKeyUp")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,t,Object(r.d)(this,this.onPointerDown,"onPointerDown")))},n.pollForStateAndUpdate=function(){if(!Hi.c(this.control.controlProperties.Command))if(!this.flyoutAnchor.menuLaunched||this._shouldRefreshWhenDropped){if((2&this.pollForStateAndUpdateInternal(this.properties$2.Command,this.properties$2.QueryCommand,this.stateProperties))>0)this.updateVisibility()&&this.updateHtml();ji.a.isTrue(this.properties$2.RefreshableMenu)&&this.menuLaunched&&this.menu.pollMenuState()}else this._needToRefreshAfterMenuClose=!0},n.updateHtml=function(){this.updateFlyoutLabelText(),this.updateImage(),this.updateImageBackgroundColor(),this.flyoutAnchor.imageIsVisible=this.stateProperties[Yr.a.ImageIsVisible]},n.updateFlyoutLabelText=function(){var e=ji.a.validateStringProperty(this.stateProperties[Yr.a.LabelText],this.properties$2.LabelText),t=this.stateProperties[Yr.a.LabelTextUserGeneratedPlaceholderReplacements];this.control.labelText===e&&this.properties$2.LabelTextUserGeneratedPlaceholderReplacements===t||(this.controlComponentDomCache.medium&&this.updateFlyoutLabelTextDom(this.controlComponentDomCache.medium.elmLabel,e,t),this.controlComponentDomCache.large,this.root.needScaling=!0,this.control.labelText=e,this.properties$2.LabelTextUserGeneratedPlaceholderReplacements=t)},n.updateFlyoutLabelTextDom=function(e,t,n){var i=e.lastChild;ji.a.setControlText(e,t+" ",n);var r=Hi.c(i);ae.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",r?"":i.nodeType.toString()),r||e.appendChild(i)},n.updateImageBackgroundColor=function(){var e=this.stateProperties[Yr.a.ImageBackColor];this.controlComponentDomCache.forEach((function(n){t.applyColorToImage(n.elmImage,e)}))},n.launchMenu=function(t){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(E.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),E.AFrameworkApplication.theActionManager.processAction(ft.a.digitalPrintToSwaySlabClicked,2)),"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||E.AFrameworkApplication.theActionManager.processAction(ft.a.digitalPrintToSwaySlabClicked,2),Object(r.c)(Li.a,this.displayedComponent)&&(this.menuLaunched||this.closeChildMenus(!0),this.control.enabled&&this.setFocusOnControl()),e.prototype.launchMenu.call(this,t)},n.closeMenu=function(){e.prototype.closeMenu.call(this),this._needToRefreshAfterMenuClose&&(this._needToRefreshAfterMenuClose=!1,this.pollForStateAndUpdate())},n.onPointerOver=function(t){return this.control.isStandardMenuItem()?(this.flyoutAnchor.menuLaunched?(this.root.cancelPendingCloseMenuStack(),ji.a.ensureCSSClassOnElement(this.flyoutAnchor.launcher,Ni.MenuLauncher.menuDroppedClassName),this.flyoutAnchor.elmHadFocus=this.control.focusableElement):(e.prototype.onPointerOver.call(this,t),this.doDefaultAction(t.sourceElement,t.inputSource,t.innerEvent)),!1):e.prototype.onPointerOver.call(this,t)},n.onKeyDown=function(t){var n=!1;if(!Hi.c(t.innerEvent)&&!Hi.c(t.innerEvent.rawEvent)){if(Object(r.c)(Li.a,this.displayedComponent)){var i=t.innerEvent.rawEvent,a=t.innerEvent.keyCode,o=!this.root.textDirection;i.shiftKey||i.ctrlKey||!(a===Sys.UI.Key.right&&o||a===Sys.UI.Key.left&&!o)||(n=this.handleDefaultActionWithKeytips(t))||(this.doDefaultAction(t.sourceElement,1,t.innerEvent),n=!0)}n||(n=e.prototype.onKeyDown.call(this,t))}return n},t.applyColorToImage=function(e,t){Hi.c(e)||Hi.c(t)||e.style.backgroundColor===t||(e.style.backgroundColor=t)},ta(t,[{key:"flyoutAnchor",get:function(){return this.control}},{key:"properties$2",get:function(){return this.control.controlProperties}}]),t}(Pr);Object(s.a)(ia,"FlyoutAnchorBehavior",Pr,[]);n(383);var ra=n(90);function aa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oa(e,t,n){return t&&aa(e.prototype,t),n&&aa(e,n),e}function sa(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var la=function(e){function t(t){return e.call(this,t)||this}sa(t,e);var n=t.prototype;return n.attachEvents=function(e){var t=e.elmA;Ye.a.instance.registerHandler(et.EventNames.focus,t,Object(r.d)(this,this.onFocus,"onFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,t,Object(r.d)(this,this.onBlur,"onBlur")),Ri.a.instance.registerHandler(et.EventNames.pointerOver,t,Object(r.d)(this,this.onPointerOver,"onPointerOver")),Ri.a.instance.registerHandler(et.EventNames.pointerOut,t,Object(r.d)(this,this.onPointerOut,"onPointerOut")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,t,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,t,Object(r.d)(this,this.onKeyUp,"onKeyUp")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,t,Object(r.d)(this,this.onPointerDown,"onPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,t,Object(r.d)(this,this.onPointerUp,"onPointerUp")),$i.a.instance.registerHandler(et.EventNames.touchMove,t,Object(r.d)(this,this.onTouchMove,"onTouchMove")),$i.a.instance.registerHandler(et.EventNames.touchEnd,t,Object(r.d)(this,this.onTouchEnd,"onTouchEnd"))},n.pollForStateAndUpdate=function(){var e=this.stateProperties[ra.a.On],t=this.stateProperties[ra.a.IsRtl];if(this.updateStateProperties(),(2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0){var n=!Hi.c(this.stateProperties[ra.a.InnerHTML])||!Hi.c(this.properties.InnerHTML),i=!Hi.c(this.properties.Image);n||i||(this.control.enabled=!1);var r=this.componentDom.elmA;if(!Hi.c(r)){if(n){var a=ji.a.validateStringProperty(this.stateProperties[ra.a.InnerHTML],this.properties.InnerHTML);null!==r.innerHTML&&null!==a&&Le.a.toLower(r.innerHTML)===Le.a.toLower(a)||(r.innerHTML=a),""===a&&(this.control.enabled=!1)}var o=r.title,s=ji.a.validateStringProperty(this.stateProperties[ra.a.Alt],this.properties.Alt);s===o||this.control.shouldIgnoreTitle||(r.title=s)}var l=this.stateProperties[ra.a.On],c=this.stateProperties[ra.a.IsRtl];e===l&&t===c||this.control.onStateChanged()}},n.updateStateProperties=function(){var e=this.stateProperties;e[ra.a.CommandValueId]=this.control.getCommandValueId(),e.MenuItemId=this.control.getMenuItemId(),e.SourceControlId=this.properties.Id},n.doDefaultAction=function(e,t,n){var i=this.displayedComponent;if(i&&this.control.enabled){var r=this.root;if(E.AFrameworkApplication.appSettingsManager&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelBorderMenuCompactionEnabled")&&i.isMenuItem()&&this.parentMenu){var a=this.parentMenu.stackIndex,o=r.menuLauncherStack[a];o?o.selectDropdownItem(this.galleryButton):ae.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.updateStateProperties(),this.stateProperties[ra.a.On]||(this.stateProperties[ra.a.On]=!0,this.control.onStateChanged()),"Menu"===i.displayMode&&ji.a.removeCSSClassFromElement(this.componentDom.elmControl,"cui-gallerybutton-focused"),r.executeCommand(this.properties.Command,this.stateProperties,i,t,!0,null,this.getTelemetryData(n))}},n.onFocus=function(t){return e.prototype.onFocus.call(this,t),ji.a.ensureCSSClassOnElement(this.componentDom.elmControl,"cui-gallerybutton-focused"),!1},n.onBlur=function(t){return e.prototype.onBlur.call(this,t),ji.a.removeCSSClassFromElement(this.componentDom.elmControl,"cui-gallerybutton-focused"),!1},oa(t,[{key:"galleryButton",get:function(){return this.control}},{key:"properties",get:function(){return this.galleryButton.properties}},{key:"componentDom",get:function(){return this.galleryButton.componentDom}}]),t}(Qi);Object(s.a)(la,"GalleryButtonBehavior",Qi,[]);var ca=n(191),ua=n(265),da=(n(387),n(162));function pa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ha(e,t,n){return t&&pa(e.prototype,t),n&&pa(e,n),e}function ma(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var ga=function(e){function t(t){var n;return(n=e.call(this,t)||this)._oldIdx=-1,n}ma(t,e);var n=t.prototype;return n.doDefaultAction=function(e,t,n){if(this.control.enabled){0;var i=this.getIndexFromElement(this.getCellOuterDiv(e)),r=this.getColFromIndex(i),a=this.getRowFromIndex(i);this.commandProperties[ua.a.Rows]=a+1,this.commandProperties[ua.a.Columns]=r+1,this.root.executeCommand(this.properties.Command,this.commandProperties,this.displayedComponent,t,!0,null,this.getTelemetryData(n))}},n.attachEvents=function(e){var t=e,n=t.elmControl,i=t.cellATags,a=t.cells;Ri.a.instance.registerHandler(et.EventNames.pointerOut,n,Object(r.d)(this,this.onControlPointerOut,"onControlPointerOut")),$i.a.instance.registerHandler(et.EventNames.touchMove,n,Object(r.d)(this,this.onControlTouchMove,"onControlTouchMove")),$i.a.instance.registerHandler(et.EventNames.touchEnd,n,Object(r.d)(this,this.onControlTouchEnd,"onControlTouchEnd"));for(var o=0;o<a.length;++o)this.attachCellEvents(i[o],a[o])},n.attachCellEvents=function(e,t){Ye.a.instance.registerHandler(et.EventNames.focus,e,Object(r.d)(this,this.onCellFocus,"onCellFocus")),Ri.a.instance.registerHandler(et.EventNames.pointerOver,t,Object(r.d)(this,this.onCellPointerOver,"onCellPointerOver")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,t,Object(r.d)(this,this.onCellPointerUp,"onCellPointerUp")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,t,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,t,Object(r.d)(this,this.onKeyUp,"onKeyUp")),$i.a.instance.registerHandler(et.EventNames.touchStart,t,Object(r.d)(this,this.onCellTouchStart,"onCellTouchStart"))},n.getIndexFromElement=function(e){return parseInt(e.id.substr(this.insertTableControl.id.length+1))},n.handleHighlightingTitle=function(e){this.handleHighlightingAndTitleForIndex(this.getIndexFromElement(e))},n.getRowFromIndex=function(e){return Math.floor(e/ca.a.numCols)},n.getColFromIndex=function(e){return e%ca.a.numCols},n.handleHighlightingAndTitleForIndex=function(e){if(e!==this._oldIdx){var t=this.getColFromIndex(e),n=this.getRowFromIndex(e),i=-1,r=-1;for(-1!==this._oldIdx&&(i=this.getRowFromIndex(this._oldIdx),r=this.getColFromIndex(this._oldIdx));i!==n||r!==t;)i<n?this.setRowHighlighting(++i,r,!0):i>n?(this.setRowHighlighting(i,r,!1),i--):r<t?this.setColHighlighting(++r,i,!0):r>t&&(this.setColHighlighting(r,i,!1),r--);if(this.hostMenuSection)this.hostMenuSection.setTitleImmediate(this.getCellTitle(n+1,t+1));else{var a,o=this.control.components,s=o&&o.length>0?o[0]:null,l=this.displayedComponent;ae.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",((a={}).CtrlComps=!!o,a.FirstComp=!!s,a.FirstCompPar=!!s&&!!s.parent,a.DispComp=!!l,a.DispCompPar=!!l&&!!l.parent,a))}this._oldIdx=e}},n.setRowHighlighting=function(e,t,n){for(var i=0;i<=t;i++)this.setCellHighlighting(e,i,n)},n.setColHighlighting=function(e,t,n){for(var i=0;i<=t;i++)this.setCellHighlighting(i,e,n)},n.setCellHighlighting=function(e,t,n){var i=e*ca.a.numCols+t,r=this.innerDivs[i],a=this.outerDivs[i];n?(r.className="cui-it-activeCell",a.className="cui-it-activeCellOuter"):(r.className="cui-it-inactiveCell",a.className="cui-it-inactiveCellOuter")},n.onCellPointerUp=function(e){return this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),!0},n.getCellOuterDiv=function(e){for(;e.hasChildNodes();)e=e.childNodes[0];return Hi.c(e.tagName)||"a"!==e.tagName.toLowerCase()?null:e.parentNode.parentNode},n.setTitleOnAnchor=function(e){var t=e.childNodes[0].childNodes[0],n=this.getIndexFromElement(e);t.title=this.getCellTitle(this.getRowFromIndex(n)+1,this.getColFromIndex(n)+1)},n.getCellTitle=function(e,t){var n=this.properties.Alt;return Hi.c(n)&&(n=this.properties.MenuSectionTitle),n=String.format(n,t.toString(),e.toString())},n.resetAll=function(){if(this.displayedComponent){for(var e=0;e<ca.a.numCells;e++)this.innerDivs[e].className="cui-it-inactiveCell",this.outerDivs[e].className="cui-it-inactiveCellOuter";this._oldIdx=-1;var t=this.properties.MenuSectionInitialTitle;Hi.c(t)&&(t=""),this.hostMenuSection.setTitleImmediate(t)}},n.onCellPointerOver=function(e){if(this.control.enabled){var t=this.getCellOuterDiv(e.sourceElement);this.setFocusOnCell(t),this.doCellHover(t)}return!1},n.doCellHover=function(e){this.setTitleOnAnchor(e),this.handleHighlightingTitle(e)},n.onCellFocus=function(e){if(!this.control.enabled)return!1;var t=this.getCellOuterDiv(e.sourceElement);return this.setTitleOnAnchor(t),this.handleHighlightingTitle(t),!1},n.onControlPointerOut=function(e){return bt.a.isPointInElement(this.insertTableControl.insertTableDom.elmControl,e.clientPoint)||this.resetAll(),!1},n.onCellTouchStart=function(e){if(!this.control.enabled)return!1;var t=this.getCellOuterDiv(e.sourceElement);return this.doCellHover(t),!0},n.onControlTouchMove=function(e){if(!this.control.enabled)return!1;var t=e.clientPoint,n=bt.a.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return!1;var i=this.getCellOuterDiv(n);return i?this.doCellHover(i):this.resetAll(),!0},n.onControlTouchEnd=function(e){if(!this.control.enabled)return!1;var t=e.clientPoint,n=bt.a.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return this.resetAll(),!0;var i=this.getCellOuterDiv(n);return i?this.doDefaultAction(i,3,e.innerEvent):this.resetAll(),!0},n.focusNext=function(e){var t=xi.Control.focusNextIndexInGrid(this._oldIdx,ca.a.numCols,ca.a.numCells,e);return t!==this._oldIdx?(this.innerDivs[t].firstChild.focus(),this.handleHighlightingAndTitleForIndex(t),!0):(this.resetAll(),this._oldIdx=-1,!1)},n.setFocusOnControl=function(){var e=this.innerDivs[0];return!Hi.c(e)&&(e.firstChild.focus(),!0)},n.setFocusOnCell=function(e){return!Hi.c(e)&&(e.firstChild.firstChild.focus(),!0)},n.onMenuClosed=function(){this.resetAll()},ha(t,[{key:"insertTableControl",get:function(){return this.control}},{key:"properties",get:function(){return this.insertTableControl.controlProperties}},{key:"commandProperties",get:function(){return this.insertTableControl.commandProperties}},{key:"hostMenuSection",get:function(){var e=null;if(this.displayedComponent){var t=this.displayedComponent.parent;if(!Object(r.c)(da.a,t))throw Error.create("InsertTable must live inside of a MenuSection.");e=t}return e}},{key:"innerDivs",get:function(){return this.insertTableControl.insertTableDom.innerDivs}},{key:"outerDivs",get:function(){return this.insertTableControl.insertTableDom.outerDivs}}]),t}(Qi);function fa(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}Object(s.a)(ga,"InsertTableBehavior",Qi,[]);var va=function(e){function t(t){return e.call(this,t)||this}fa(t,e);var n=t.prototype;return n.pollForStateAndUpdate=function(){this.control.enabled=!!this.menu},n.doDefaultAction=function(e,t,n){E.AFrameworkApplication.theActionManager.processActionWithData(ft.a.launchFileMenu,2,t,this.getTelemetryData(n))},t}(Pr);Object(s.a)(va,"JewelMenuLauncherBehavior",Pr,[]);var _a=n(220);function ya(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ba(e,t,n){return t&&ya(e.prototype,t),n&&ya(e,n),e}function Sa(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ca=function(e){function t(t){return e.call(this,t)||this}Sa(t,e);var n=t.prototype;return n.pollForStateAndUpdate=function(){(2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0&&(this.updateVisibility()&&this.updateHtml())},n.updateHtml=function(){this.updateTextForLabelControl(),this.updateImage(),this.updateTooltip()},n.updateTextForLabelControl=function(){var e=this.control.labelText,t=this.stateProperties[_a.a.Value];Hi.c(t)&&(t=this.properties.LabelText,Hi.c(t)&&(t="")),t!==e&&this.setLabelText(t)},n.attachEvents=function(e){var t=e.elmControl;Hi.c(t)||(Ri.a.instance.registerHandler(et.EventNames.pointerDown,t,Object(r.d)(this,this.onPointerDown,"onPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerOver,t,Object(r.d)(this,this.onPointerOver,"onPointerOver")),Ri.a.instance.registerHandler(et.EventNames.pointerOut,t,Object(r.d)(this,this.onPointerOut,"onPointerOut")))},ba(t,[{key:"properties",get:function(){return this.control.controlProperties}}]),t}(Qi);Object(s.a)(Ca,"LabelBehavior",Qi,[]);var Aa=n(201),Ia=n(64),wa=n(84);function Ta(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ea(e,t,n){return t&&Ta(e.prototype,t),n&&Ta(e,n),e}function ka(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ma=function(e){function t(t){var n;return(n=e.call(this,t)||this)._closingMenu=!1,n._inActiveInteraction=!1,n._activeIconClass=null,n._inactiveIconClass=null,n._isRedesignFlightEnabled=E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeRedesignIsEnabled"),n._isRedesignFlightEnabled&&(n._activeIconClass=n.searchBox.sbProperties.LightImage16by16Class,n._inactiveIconClass=n.searchBox.sbProperties.DarkImage16by16Class),n}ka(t,e);var n=t.prototype;return n.notifyCommandExecuted=function(e,t,n,i){if(t&&(this.searchBox.elmHadFocus=n,E.AFrameworkApplication.activeFrame.setFocusOnDocument()),Object(r.c)(Ia.a,e)&&i){var a=new Aa.a;a.CommandLocation=this.root.rootType,a.InvocationMethod=0;var o={},s=e.control;if(s&&s.controlProperties){if(o.CommandId=s.controlProperties.Command,o.ControlId=s.controlProperties.Id,o.CloseAllMenus=t,s.parentMenu&&s.parentMenu.parent&&s.parentMenu.parent.id){var l=s.parentMenu.parent.id;o.ParentControlId=l.split("-")[0]}this.root.rootUser&&this.root.rootUser.executeRootCommand(i,o,a)}}},n.closeMenu=function(){this.searchBox.elmHadFocus||(this.searchBox.elmHadFocus=this.searchBox.inputField),this.searchBox.mouseIsOver||this._isRedesignFlightEnabled&&(ji.a.removeCSSClassFromElement(this.searchBox.inputField,"cui-sb-focus"),ji.a.removeCSSClassFromElement(this.searchBox.topLevelElement,"cui-sb-focus"),ji.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._activeIconClass),ji.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._inactiveIconClass)),this._closingMenu=!0,e.prototype.closeMenu.call(this),this._closingMenu=!1,this.raiseInteractionEnd()},n.onMenuChanged=function(){this.searchBox.onMenuChanged()},n.raiseInteractionBegin=function(){this._inActiveInteraction||this._closingMenu||(this._inActiveInteraction=!0,this.searchBox.raiseEvent(wa.a.interactionBegin,null))},n.raiseInteractionEnd=function(){this.menuLaunched||this.searchBox.inputHasFocus||(this._inActiveInteraction=!1,this.searchBox.raiseEvent(wa.a.interactionEnd,null))},n.onInputBoxBlur=function(e){return ji.a.removeCSSClassFromElement(this.searchBox.inputField,"cui-sb-focus"),ji.a.removeCSSClassFromElement(this.searchBox.topLevelElement,"cui-sb-focus"),this._isRedesignFlightEnabled&&!this.searchBox.menuLaunched&&(ji.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._activeIconClass),ji.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._inactiveIconClass)),this.searchBox.raiseEvent(wa.a.blur,e),this.raiseInteractionEnd(),this.searchBox.elmHadFocus=this.searchBox.inputField,!1},n.onInputBoxFocus=function(e){return ji.a.ensureCSSClassOnElement(this.searchBox.inputField,"cui-sb-focus"),ji.a.ensureCSSClassOnElement(this.searchBox.topLevelElement,"cui-sb-focus"),this._isRedesignFlightEnabled&&(ji.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._inactiveIconClass),ji.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._activeIconClass)),this.searchBox.raiseEvent(wa.a.focus,e),this.raiseInteractionBegin(),!1},n.onSearchContainerMouseOver=function(e){return this._isRedesignFlightEnabled&&(ji.a.ensureCSSClassOnElement(this.searchBox.topLevelElement,"cui-sb-hover"),ji.a.ensureCSSClassOnElement(this.searchBox.inputField,"cui-sb-hover"),ji.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._inactiveIconClass),ji.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._activeIconClass)),!1},n.onSearchContainerMouseOut=function(e){return this._isRedesignFlightEnabled&&(ji.a.removeCSSClassFromElement(this.searchBox.topLevelElement,"cui-sb-hover"),ji.a.removeCSSClassFromElement(this.searchBox.inputField,"cui-sb-hover"),this.searchBox.menuLaunched||this.searchBox.inputHasFocus||(ji.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._activeIconClass),ji.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._inactiveIconClass))),!1},Ea(t,[{key:"searchBox",get:function(){return this.control}},{key:"shouldRestoreFocusToApp",get:function(){return!this.searchBox.processingKeystroke}}]),t}(Pr);Object(s.a)(Ma,"SearchBoxBehavior",Pr,[218,216]);var Pa=n(128);n(388);function Fa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Da(e,t,n){return t&&Fa(e.prototype,t),n&&Fa(e,n),e}function Oa(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ra="cui-sldr-onfocus",xa=function(e){function t(t){return e.call(this,t)||this}Oa(t,e);var n=t.prototype;return n.initialize=function(){},n.doDefaultAction=function(e,t,n){},n.attachEvents=function(e){var t=e.elmInput;Ye.a.instance.registerHandler(et.EventNames.focus,t,Object(r.d)(this,this.onFocus,"onFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,t,Object(r.d)(this,this.onBlur,"onBlur")),Ye.a.instance.registerHandler(et.EventNames.change,t,Object(r.d)(this,this.onChange,"onChange")),Ye.a.instance.registerHandler(et.EventNames.input,t,Object(r.d)(this,this.onChange,"onChange"))},n.onFocus=function(t){return this.sliderDom.elmControl&&Sys.UI.DomElement.addCssClass(this.sliderDom.elmControl,Ra),e.prototype.onFocus.call(this,t)},n.onBlur=function(t){return this.sliderDom.elmControl&&Sys.UI.DomElement.removeCssClass(this.sliderDom.elmControl,Ra),e.prototype.onBlur.call(this,t)},n.onChange=function(e){return this.commitValue(this.sliderDom.elmInput.value),!0},n.commitValue=function(e){this.stateProperties[Pa.a.Value]=parseFloat(e),this.root.executeCommand(this.properties.Command,this.stateProperties,this.displayedComponent,0,!1)},n.pollForStateAndUpdate=function(){var e=this.stateProperties[Pa.a.Value],t=this.stateProperties[Pa.a.MaxValue],n=this.stateProperties[Pa.a.Text],i=this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties);if(this.sliderDom&&this.sliderDom.elmInput&&(this.sliderDom.elmInput.disabled=!this.control.enabled),(2&i)>0){var r=this.stateProperties[Pa.a.Value],a=this.stateProperties[Pa.a.MaxValue],o=this.stateProperties[Pa.a.Text];a===t&&r===e&&n===o||this.sliderDom&&this.sliderDom.elmInput&&(this.sliderDom.elmInput.setAttribute(gn.a.ariaValueMaxAttribute,String.format("{0}",a)),this.sliderDom.elmInput.setAttribute("max",String.format("{0}",a)),this.sliderDom.elmInput.value=r,this.sliderDom.elmLabel.innerText=this.stateProperties[Pa.a.Text])}},Da(t,[{key:"slider",get:function(){return this.control}},{key:"sliderDom",get:function(){return this.slider.sliderDom}},{key:"properties",get:function(){return this.control.controlProperties}}]),t}(Qi);Object(s.a)(xa,"SliderBehavior",Qi,[]);var Ua=n(81);n(389);function Ba(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function La(e,t,n){return t&&Ba(e.prototype,t),n&&Ba(e,n),e}function Na(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ha=500,Wa=50,ja=function(e){function t(t){var n;return(n=e.call(this,t)||this)._numericalValue=0,n._unit=null,n._isSpecialText=!1,n._validUnitTypes=null,n._spinningUp=!1,n._pendingDelaySpinTimeoutId=-1,n._repeatSpinIntervalId=-1,n._mouseupOnTextboxSinceFocus=!1,n}Na(t,e);var n=t.prototype;return n.initialize=function(){var e=this.spinner.validUnits;this._validUnitTypes=this.unitTypeArrayFromUnitArray(e),this._numericalValue=e[0].min,this._unit=e[0],this._isSpecialText=!1},n.doDefaultAction=function(e,t,n){},n.attachEvents=function(e){var t=e,n=t.elmInput,i=t.elmUpArrow,a=t.elmDownArrow;Ye.a.instance.registerHandler(et.EventNames.focus,n,Object(r.d)(this,this.onFocus,"onFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,n,Object(r.d)(this,this.onBlur,"onBlur")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,n,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyPress,n,Object(r.d)(this,this.onKeyPress,"onKeyPress")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,n,Object(r.d)(this,this.onKeyUp,"onKeyUp")),Ye.a.instance.registerHandler(et.EventNames.change,n,Object(r.d)(this,this.onChange,"onChange")),Ur.a.instance.registerHandler(et.EventNames.mouseUp,n,Object(r.d)(this,this.onInputMouseUp,"onInputMouseUp")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,i,Object(r.d)(this,this.onArrowPointerDown,"onArrowPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,a,Object(r.d)(this,this.onArrowPointerDown,"onArrowPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,i,Object(r.d)(this,this.onArrowPointerUp,"onArrowPointerUp")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,a,Object(r.d)(this,this.onArrowPointerUp,"onArrowPointerUp")),$i.a.instance.registerHandler(et.EventNames.touchMove,i,Object(r.d)(this,this.onArrowTouchMove,"onArrowTouchMove")),$i.a.instance.registerHandler(et.EventNames.touchMove,a,Object(r.d)(this,this.onArrowTouchMove,"onArrowTouchMove")),$i.a.instance.registerHandler(et.EventNames.touchEnd,i,Object(r.d)(this,this.onArrowTouchEnd,"onArrowTouchEnd")),$i.a.instance.registerHandler(et.EventNames.touchEnd,a,Object(r.d)(this,this.onArrowTouchEnd,"onArrowTouchEnd"))},n.onFocus=function(t){return e.prototype.onFocus.call(this,t),ji.a.ensureCSSClassOnElement(this.spinnerDom.elmControl,"cui-spn-focus"),this.control.enabled&&bt.a.selectAllTextInInput(this.spinnerDom.elmInput),this._mouseupOnTextboxSinceFocus=!1,!1},n.onBlur=function(t){return e.prototype.onBlur.call(this,t),ji.a.removeCSSClassFromElement(this.spinnerDom.elmControl,"cui-spn-focus"),!1},n.onKeyDown=function(e){var t=!1;if(!Hi.c(e.innerEvent)&&!Hi.c(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode;n.shiftKey;i===Sys.UI.Key.up||i===Sys.UI.Key.down?(this.root.isCurrentModalController(this.control)||this.startSpin(i===Sys.UI.Key.up,e.inputSource),t=!0):i===Sys.UI.Key.enter?(this.commitPendingChange(),t=!0):i===Sys.UI.Key.tab?this.commitPendingChange():i===Sys.UI.Key.esc?(this.resetInputToPreviousValue(),t=!0):i!==Sys.UI.Key.backspace&&i!==Sys.UI.Key.del||(t=!this.control.enabled)}return t},n.onKeyPress=function(e){return!this.control.enabled},n.onKeyUp=function(e){return this.deactivateElementFromKeyboard(),!1},n.onChange=function(e){return this.commitPendingChange(),!1},n.onInputMouseUp=function(e){return!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)},n.onArrowPointerDown=function(e){var t=!1,n=!0;if(2===e.inputSource&&(n=!e.mouseButton),n){var i=e.sourceElement,r=i===this.spinnerDom.elmUpArrow||i===this.spinnerDom.elmUpArrowImageContainer||i===this.spinnerDom.elmUpArrowImage;this.startSpin(r,e.inputSource),t=!0}return t},n.onArrowPointerUp=function(e){return this.deactivateElement(e)},n.onArrowTouchMove=function(e){return this.onActivePointerMove(e)},n.onArrowTouchEnd=function(e){return this.deactivateElement(e)},n.incDecValue=function(e){if(this.control.enabled){var t=!1;if(!this._isSpecialText){var n=this.getIncDecStartingValue(e),i=e?n+this._unit.step:n-this._unit.step;i=Math.min(i,this._unit.max),(i=Math.max(i,this._unit.min))!==this._numericalValue&&(this.commitNumericalValue(i,this._unit),this.root.executeCommand(this.properties.Command,this.stateProperties,this.displayedComponent,0,!1),t=!0)}if(!t){var r=this.properties.SpinCommand,a=this.stateProperties;a.Increment=e,Hi.c(r)||this.root.executeCommand(r,a,this.displayedComponent,0,!1)}}},n.getIncDecStartingValue=function(e){var t=Math.pow(10,E.AFrameworkApplication.numberFormat.numberDecimalDigits),n=Math.round(this._numericalValue*t),i=Math.round(this._unit.step*t),r=n/i;return(r=e?Math.floor(r):Math.ceil(r))*i/t},n.startSpin=function(e,t){if(this.control.enabled){this.commitPendingChange();var n=e?this.spinnerDom.elmUpArrow:this.spinnerDom.elmDownArrow;switch(t){case 2:case 3:this._spinningUp=e,this.activateElement(n);break;case 1:this._spinningUp=e,this.activateElementFromKeyboard(n)}}},n.stopSpin=function(){this.cancelPendingDelaySpin(),this.cancelRepeatSpin()},n.delaySpin=function(){-1===this._pendingDelaySpinTimeoutId&&(this._pendingDelaySpinTimeoutId=window.setTimeout(Object(r.d)(this,this.repeatSpin,"repeatSpin"),Ha))},n.cancelPendingDelaySpin=function(){var e=this;ji.a.cancelPendingTimeout(Object(cr.a)((function(){return e._pendingDelaySpinTimeoutId}),(function(t){return e._pendingDelaySpinTimeoutId=t})))},n.repeatSpin=function(){this.cancelPendingDelaySpin(),-1===this._repeatSpinIntervalId&&(this.spin(),this._repeatSpinIntervalId=window.setInterval(Object(r.d)(this,this.spin,"spin"),Wa))},n.cancelRepeatSpin=function(){var e=this;ji.a.cancelInterval(Object(cr.a)((function(){return e._repeatSpinIntervalId}),(function(t){return e._repeatSpinIntervalId=t})))},n.spin=function(){this.incDecValue(this._spinningUp)},n.activateElementFromKeyboard=function(e){this.root.beginModal(this.control,!1),ji.a.ensureCSSClassOnElement(e,xi.Control.activeClassName),this.spin(),this.delaySpin()},n.deactivateElementFromKeyboard=function(){this.root.endModal(this.control,!1),this.stopSpin(),ji.a.removeCSSClassFromElement(this.spinnerDom.elmUpArrow,xi.Control.activeClassName),ji.a.removeCSSClassFromElement(this.spinnerDom.elmDownArrow,xi.Control.activeClassName)},n.setInputValue=function(e){this.spinnerDom.elmInput.value!==e&&(this.spinnerDom.elmInput.value=e)},n.resetInputToPreviousValue=function(){this.setInputValue(this.stateProperties[Ua.a.Text])},n.setCurrentValueToSpecialText=function(e){this.setInputValue(e),this.stateProperties[Ua.a.Text]=e,this._isSpecialText=!0},n.setCurrentValueToNumber=function(e,t,n){this.setInputValue(n),this.stateProperties[Ua.a.Text]=n,this.stateProperties[Ua.a.Number]=e,this.stateProperties[Ua.a.UnitType]=t.type,this._numericalValue=e,this._unit=t,this.spinnerDom.elmInput.setAttribute(gn.a.ariaValueNowAttribute,n),this.spinnerDom.elmInput.setAttribute(gn.a.ariaValueMinAttribute,String.format("{0}",t.min)),this.spinnerDom.elmInput.setAttribute(gn.a.ariaValueMaxAttribute,String.format("{0}",t.max)),this._isSpecialText=!1},n.commitTextValue=function(e){var t;if(this.isSpecialText(e,Object(cr.a)((function(){return t}),(function(e){return t=e}))))this.setCurrentValueToSpecialText(t);else{var n=0,i=0;Le.a.parseNumberAndUnitsFromString(e,this._validUnitTypes,E.AFrameworkApplication.numberFormat,Object(cr.a)((function(){return n}),(function(e){return n=e})),Object(cr.a)((function(){return i}),(function(e){return i=e})));var r=this.unitFromUnitType(i);!i&&Hi.c(r)&&(r=this.unitFromUnitType(this.stateProperties[Ua.a.UnitType])),this.commitNumericalValue(n,r)}},n.commitNumericalValue=function(e,t){if(e=this.normalizeNumber(e,t),isNaN(e)||Hi.c(t))this.resetInputToPreviousValue();else{var n=E.AFrameworkApplication.numberFormat,i="";Le.a.formatNumberToString(e,t.type,n,Object(cr.a)((function(){return i}),(function(e){return i=e})));var r=6===t.type?n.numberGroupSeparator:n.percentGroupSeparator;i=i.replace(r,""),this.setCurrentValueToNumber(e,t,i)}},n.isSpecialText=function(e,t){var n=!1;t.val="",e=e.trim();var i=this.spinner.validSpecialStrings;if(!Hi.c(i))for(var r=0;r<i.length;r++)if(i[r].toLowerCase()===e.toLowerCase()){t.val=i[r],n=!0;break}return n},n.normalizeNumber=function(e,t){return isNaN(e)||Hi.c(t)?Number.NaN:t.normalizeNumber(e)},n.unitFromUnitType=function(e){for(var t=null,n=this.spinner.validUnits,i=0;i<n.length;i++)if(n[i].type===e){t=n[i];break}return t},n.unitTypeArrayFromUnitArray=function(e){for(var t=e.length,n=new Array(t),i=0;i<t;i++)n[i]=e[i].type;return n},n.commitPendingChange=function(){if(this.control.enabled){var e=this.stateProperties[Ua.a.Text],t=this.spinnerDom.elmInput.value;if(t!==e)this.commitTextValue(t),this.stateProperties[Ua.a.Text]!==e&&this.root.executeCommand(this.properties.Command,this.stateProperties,this.displayedComponent,0,!1)}else this.resetInputToPreviousValue()},n.pollForStateAndUpdate=function(){var e=this.stateProperties[Ua.a.Text],t=this.stateProperties[Ua.a.Number],n=this.stateProperties[Ua.a.UnitType],i=this.stateProperties[Ua.a.MaxValue];if((2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0){var r=this.stateProperties[Ua.a.Text],a=this.stateProperties[Ua.a.Number],o=this.stateProperties[Ua.a.UnitType],s=this.stateProperties[Ua.a.MaxValue];s!==i&&(this.unitFromUnitType(o).max=s,this.spinnerDom.elmInput.setAttribute(gn.a.ariaValueMaxAttribute,String.format("{0}",s))),r!==e?""===r?this.setCurrentValueToSpecialText(r):this.commitTextValue(r):isNaN(a)||a===t&&o===n||this.commitNumericalValue(a,this.unitFromUnitType(o));var l=this.spinnerDom.elmControl.title,c=ji.a.validateStringProperty(this.stateProperties[Ua.a.Alt],this.properties.Alt);c!==l&&(this.spinnerDom.elmInput.title=c,this.spinnerDom.elmUpArrow.title=c,this.spinnerDom.elmDownArrow.title=c)}},n.activeElementStateChanged=function(t){e.prototype.activeElementStateChanged.call(this,t),t?(this.spin(),this.delaySpin()):this.stopSpin()},La(t,[{key:"spinner",get:function(){return this.control}},{key:"spinnerDom",get:function(){return this.spinner.spinnerDom}},{key:"properties",get:function(){return this.control.controlProperties}}]),t}(Qi);Object(s.a)(ja,"SpinnerBehavior",Qi,[217,216]);var Va=n(247),Ka=(n(250),n(181));function za(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qa(e,t,n){return t&&za(e.prototype,t),n&&za(e,n),e}function Ga(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Qa="cui-ctl-split-hovered-primary",Za="cui-ctl-split-hovered-secondary",$a="title",Xa=function(e){function t(t){var n;return(n=e.call(this,t)||this)._menuButtonEnabled=!0,n._buttonEnabled=!1,n}Ga(t,e);var n=t.prototype;return n.attachEvents=function(e){var t=e,n=t.elmControl,i=t.elmButtonPart,a=t.elmMenuLauncherPart;Ye.a.instance.registerHandler(et.EventNames.focus,n,Object(r.d)(this,this.onFocus,"onFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,n,Object(r.d)(this,this.onBlur,"onBlur")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,n,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,n,Object(r.d)(this,this.onKeyUp,"onKeyUp")),xn.a.isInternetExplorerEdge&&this.getEdgeMajorVersion()<16&&(Ri.a.instance.registerHandler(et.EventNames.pointerDown,n,Object(r.d)(this,this.onSplitbuttonPointerDownPointerUp,"onSplitbuttonPointerDownPointerUp")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,n,Object(r.d)(this,this.onSplitbuttonPointerDownPointerUp,"onSplitbuttonPointerDownPointerUp"))),Ri.a.instance.registerHandler(et.EventNames.pointerOver,i,Object(r.d)(this,this.onButtonPointerOver,"onButtonPointerOver")),Ri.a.instance.registerHandler(et.EventNames.pointerOut,i,Object(r.d)(this,this.onButtonPointerOut,"onButtonPointerOut")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,i,Object(r.d)(this,this.onButtonPointerDown,"onButtonPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,i,Object(r.d)(this,this.onButtonPointerUp,"onButtonPointerUp")),$i.a.instance.registerHandler(et.EventNames.touchMove,i,Object(r.d)(this,this.onButtonTouchMove,"onButtonTouchMove")),$i.a.instance.registerHandler(et.EventNames.touchEnd,i,Object(r.d)(this,this.onButtonTouchEnd,"onButtonTouchEnd")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,a,Object(r.d)(this,this.onMenuButtonPointerDown,"onMenuButtonPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerOver,a,Object(r.d)(this,this.onMenuButtonPointerOver,"onMenuButtonPointerOver")),Ri.a.instance.registerHandler(et.EventNames.pointerOut,a,Object(r.d)(this,this.onMenuButtonPointerOut,"onMenuButtonPointerOut"))},n.doDefaultAction=function(t,n,i){if(Sys.UI.DomElement.containsCssClass(t,"cui-ctl-a1")){if(this._buttonEnabled){this.splitButton.on=!this.splitButton.on;var r=this.stateProperties;r.CommandValueId=this.control.getCommandValueId(),this.root.executeCommand(this.properties$2.Command,r,this.displayedComponent,n,!0,null,this.getTelemetryData(i))}}else this._menuButtonEnabled&&e.prototype.doDefaultAction.call(this,t,n,i)},n.onKeyUp=function(t){var n=t.innerEvent.keyCode;if(n===Sys.UI.Key.enter||n===Sys.UI.Key.space){var i=this.stateProperties;return i.CommandValueId=this.control.getCommandValueId(),this.root.executeCommand(this.properties$2.Command,i,this.displayedComponent,1,!0),!0}return e.prototype.onKeyUp.call(this,t)},n.pollForStateAndUpdate=function(){var e=this.root.pollForCommandState(this.properties$2.Command,this.properties$2.QueryCommand,this.stateProperties),t=(1&e)>0,n=!0;Hi.c(this.properties$2.CommandMenuOpen)?n=t:n=(1&this.root.pollForCommandState(this.properties$2.CommandMenuOpen,null,null))>0;if(n===this._menuButtonEnabled&&t===this._buttonEnabled&&(n||t)===this.control.enabled||(this.control.enabled=n||t,t!==this._buttonEnabled&&this.onEnabledChangedForButton(t),n!==this._menuButtonEnabled&&this.onEnabledChangedForMenu(n),this._menuButtonEnabled=n,this._buttonEnabled=t),(2&e)>0){this.updateImage();var i=ji.a.validateStringProperty(this.stateProperties[Ka.a.LabelText],this.properties$2.LabelText);if(this.stateProperties[Ka.a.ApplyLabelTextToControlOnly]?this.splitButton.forEachSplitButtonComponentDom((function(e){e.elmControl.title=i,e.elmButtonPart.removeAttribute($a),e.elmMenuLauncherPart.removeAttribute($a)})):this.splitButton.forEachSplitButtonComponentDom((function(e){e.elmButtonPart.title=i})),this.stateProperties[Ka.a.EnsureControlRoleIsButton]&&this.splitButton.forEachSplitButtonComponentDom((function(e){gn.a.setAriaAttribute(e.elmControl,gn.a.ariaRoleAttribute,gn.a.ariaButtonRole)})),!Hi.c(this.stateProperties[Ka.a.Visible]))this.updateVisibility()&&this.updateHtml()}this.splitButton.setState(this.splitButton.on&&t)},n.updateHtml=function(){this.updateLabelText(),this.updateTooltip(),this.updateImage()},n.onEnabledChangedForMenu=function(e){this.splitButton.forEachSplitButtonComponentDom((function(t){ji.a.setEnabledOnElement(t.elmMenuLauncherPart,e)})),this.removeControlHighlight(),this._menuButtonEnabled=e},n.onEnabledChangedForButton=function(e){this.splitButton.forEachSplitButtonComponentDom((function(t){ji.a.setEnabledOnElement(t.elmButtonPart,e)})),this.removeControlHighlight(),this._buttonEnabled=e},n.removeControlHighlight=function(){var e=this.splitButton.getDisplayedComponentElement();Hi.c(e)||(ji.a.removeCSSClassFromElement(e.childNodes[0],Qa),ji.a.removeCSSClassFromElement(e.childNodes[0],Za),ji.a.removeCSSClassFromElement(e.childNodes[1],Qa),ji.a.removeCSSClassFromElement(e.childNodes[1],Za))},n.onSplitbuttonPointerDownPointerUp=function(e){if(Va.a(e.innerEvent))return!1;var t=!1;return e.eventName===et.EventNames.pointerDown?t=this.onButtonPointerDown(e):e.eventName===et.EventNames.pointerUp&&(t=this.onButtonPointerUp(e)),t},n.onButtonPointerDown=function(e){var t=!1,n=e.inputSource;switch(n){case 3:this.shouldUseFlyoutBehaviorOnTouch()?(this.doDefaultAction(this.displayedComponent.elementInternal,n,e.innerEvent),t=!0):(this.activateElement(this.splitButton.displayedButtonElement),t=!0);break;case 2:e.mouseButton||(this.activateElement(this.splitButton.displayedButtonElement),t=!0);break;default:0}return t&&e.innerEvent.preventDefault(),!1},n.shouldUseFlyoutBehaviorOnTouch=function(){var e=this.displayedComponent.displayMode;return"Small"===e||"Medium"===e||"Menu16"===e||"MenuTellMe"===e},n.onButtonPointerUp=function(e){return this.deactivateElement(e)},n.onButtonTouchMove=function(e){return this.onActivePointerMove(e)},n.onButtonTouchEnd=function(e){return this.deactivateElement(e)},n.onFocus=function(t){return e.prototype.onFocus.call(this,t),this.highlightControl(!0,!0),!1},n.onBlur=function(t){return e.prototype.onFocus.call(this,t),this.removeControlHighlight(),!1},n.onButtonPointerOver=function(e){return this.control.enabled&&this._buttonEnabled&&this.highlightControl(!0,this.splitButton.on),!1},n.onButtonPointerOut=function(e){return this.control.enabled&&this._buttonEnabled&&this.removeControlHighlight(),!1},n.onMenuButtonPointerDown=function(e){var t=!1;return 2===e.inputSource&&e.mouseButton||(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),t=!0),t&&e.innerEvent.preventDefault(),!1},n.onMenuButtonPointerOver=function(e){return this.control.enabled&&this._menuButtonEnabled&&this.highlightControl(this.splitButton.on,!0),!1},n.onMenuButtonPointerOut=function(e){return this.removeControlHighlight(),!1},n.highlightControl=function(e,t){var n=this.control.getDisplayedComponentElement();Hi.c(n)||(ji.a.ensureCSSClassOnElement(n.childNodes[0],e?Qa:Za),ji.a.ensureCSSClassOnElement(n.childNodes[1],t?Qa:Za))},n.getEdgeMajorVersion=function(){var e=xn.a.edgeVersion;if(e){var t=e.split(".");if(2===t.length)return parseInt(t[0])}return 0},qa(t,[{key:"splitButton",get:function(){return this.control}},{key:"properties$2",get:function(){return this.splitButton.properties}}]),t}(Pr);Object(s.a)(Xa,"SplitButtonBehavior",Pr,[]);var Ja=n(216);n(277);function Ya(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eo(e,t,n){return t&&Ya(e.prototype,t),n&&Ya(e,n),e}function to(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var no=function(e){function t(t){var n;return(n=e.call(this,t)||this)._mouseupOnTextboxSinceFocus=!1,n._inputFocused=!1,n._excelTableRenameEnabled=!!E.AFrameworkApplication.appSettingsManager&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelTableRenameEnabled"),n}to(t,e);var n=t.prototype;return n.attachEvents=function(e){var t=e.elmInput;Ye.a.instance.registerHandler(et.EventNames.focus,t,Object(r.d)(this,this.onFocus,"onFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,t,Object(r.d)(this,this.onBlur,"onBlur")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,t,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyPress,t,Object(r.d)(this,this.onKeyPress,"onKeyPress")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,t,Object(r.d)(this,this.onKeyUp,"onKeyUp")),Ye.a.instance.registerHandler(et.EventNames.change,t,Object(r.d)(this,this.onChange,"onChange")),Ur.a.instance.registerHandler(et.EventNames.mouseUp,t,Object(r.d)(this,this.onMouseUp,"onMouseUp"))},n.onFocus=function(t){return e.prototype.onFocus.call(this,t),this._inputFocused=!0,ji.a.ensureCSSClassOnElement(this.textBoxDom.elmControl,"cui-tb-focus"),this.control.enabled&&bt.a.selectAllTextInInput(this.textBoxDom.elmInput),this._mouseupOnTextboxSinceFocus=!1,!1},n.onBlur=function(t){return this._inputFocused=!1,e.prototype.onBlur.call(this,t),ji.a.removeCSSClassFromElement(this.textBoxDom.elmControl,"cui-tb-focus"),!1},n.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!Hi.c(t.innerEvent)&&!Hi.c(t.innerEvent.rawEvent)){var i=t.innerEvent.rawEvent,r=t.innerEvent.keyCode;i.shiftKey;r===Sys.UI.Key.tab?this.commitPendingChange():r===Sys.UI.Key.enter?this._excelTableRenameEnabled&&(this.commitPendingChange(),n=!0):r===Sys.UI.Key.esc?(this.resetInputToPreviousValue(),n=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?n=!this.control.enabled:t.commandKey}return n},n.onKeyPress=function(e){return!this.control.enabled},n.onKeyUp=function(e){return!1},n.onChange=function(e){return this.commitPendingChange(),!1},n.onMouseUp=function(e){return this.textBoxDom.isEditable?!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0):(bt.a.selectAllTextInInput(this.textBoxDom.elmInput),!0)},n.setInputValue=function(e){this.textBoxDom.elmInput.value!==e&&(this.textBoxDom.elmInput.value=e)},n.resetInputToPreviousValue=function(){this.setInputValue(this.stateProperties[Ja.a.Text])},n.commitPendingChange=function(){if(this.control.enabled&&this.textBoxDom.isEditable){var e=this.stateProperties[Ja.a.Text],t=this.textBoxDom.elmInput.value;t!==e&&(this.stateProperties[Ja.a.Text]=t,this.root.executeCommand(this.tbProperties.Command,this.stateProperties,this.displayedComponent,0,!1))}else this.resetInputToPreviousValue()},n.pollForStateAndUpdate=function(){var e=this.stateProperties[Ja.a.Text];if((2&this.pollForStateAndUpdateInternal(this.tbProperties.Command,this.tbProperties.QueryCommand,this.stateProperties))>0&&!this._inputFocused){var t=this.stateProperties[Ja.a.Text];t!==e&&this.setInputValue(t)}},eo(t,[{key:"textBox",get:function(){return this.control}},{key:"textBoxDom",get:function(){return this.textBox.textBoxDom}},{key:"tbProperties",get:function(){return this.textBox.controlProperties}}]),t}(Qi);Object(s.a)(no,"TextBoxBehavior",Qi,[215,216]);var io=n(123);function ro(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ao(e,t,n){return t&&ro(e.prototype,t),n&&ro(e,n),e}function oo(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var so=function(e){function t(t){return e.call(this,t)||this}oo(t,e);var n=t.prototype;return n.doDefaultAction=function(e,t,n){var i=this;this.control.enabled&&(ji.a.isFalse(this.properties.TogglesWhenExecuted)||this.toggle(),this.stateProperties.CommandValueId=this.toggleButton.getCommandValueId(),this.stateProperties.MenuItemId=this.toggleButton.getMenuItemId(),this.stateProperties.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.stateProperties,this.displayedComponent,t,!ji.a.isFalse(this.properties.CloseMenuWhenExecuted),(function(e){ji.a.isTrue(i.properties.UpdateHtmlPostToggle)&&(32===e?i.toggleUx():i.toggleState())}),this.getTelemetryData(n)))},n.toggleState=function(){var e=!this.stateProperties[Bi.a.On];this.stateProperties[Bi.a.On]=e},n.toggleUx=function(){var e=this.stateProperties[Bi.a.On];this.toggleButton.setState(e),(this.toggleButton.useCheckMark&&this.toggleButton.useUncheckedImage||ji.a.isTrue(this.properties.UpdateHtmlPostToggle))&&this.updateHtml()},n.toggle=function(){this.toggleState(),ji.a.isTrue(this.properties.UpdateHtmlPostToggle)||this.toggleUx()},n.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!n&&!Hi.c(t.innerEvent)&&this.parentMenu){var i=t.innerEvent.keyCode;i!==Sys.UI.Key.enter&&i!==Sys.UI.Key.space||t.innerEvent.preventDefault()}return n},n.pollForStateAndUpdate=function(){(Hi.c(this.properties.MenuItemId)||(this.stateProperties.MenuItemId=this.properties.MenuItemId),(2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0)&&(this.updateVisibility()&&this.updateHtml())},n.updateHtml=function(){this.toggleButton.setState(this.stateProperties[Bi.a.On]),this.updateDisplayMode(ji.a.validateStringProperty(this.stateProperties[Bi.a.DisplayMode],"")),this.updateLabelText(),this.updateImage(),this.updateLargeMenu(),Bi.a.Alt in this.stateProperties&&this.updateTooltip()},n.updateLargeMenu=function(){var e=this.controlComponentDomCache.largeMenu;if(e&&e.elmDescription){var t=ji.a.validateStringProperty(this.stateProperties[Bi.a.Description],this.properties.Description);if(t!==e.elmDescription.innerText&&(e.elmDescription.innerText=t,e.elmLabel&&!Object(r.c)(io.Jewel,this.root))){var n=!Hi.b(t);ji.a.toggleCSSClassOnElement(e.elmLabel,"UIFontBold",n),ji.a.toggleCSSClassOnElement(e.elmLabel,"cui-ctl-mediumlabel-nodescription",!n)}}},n.attachEvents=function(e){var t=e.elmControl;Ye.a.instance.registerHandler(et.EventNames.focus,t,Object(r.d)(this,this.onFocus,"onFocus")),Ye.a.instance.registerHandler(et.EventNames.blur,t,Object(r.d)(this,this.onBlur,"onBlur")),Ri.a.instance.registerHandler(et.EventNames.pointerOver,t,Object(r.d)(this,this.onPointerOver,"onPointerOver")),Ri.a.instance.registerHandler(et.EventNames.pointerOut,t,Object(r.d)(this,this.onPointerOut,"onPointerOut")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyDown,t,Object(r.d)(this,this.onKeyDown,"onKeyDown")),gt.KeyInputManager.instance.registerHandler(et.EventNames.keyUp,t,Object(r.d)(this,this.onKeyUp,"onKeyUp")),Ri.a.instance.registerHandler(et.EventNames.pointerDown,t,Object(r.d)(this,this.onPointerDown,"onPointerDown")),Ri.a.instance.registerHandler(et.EventNames.pointerUp,t,Object(r.d)(this,this.onPointerUp,"onPointerUp")),Zi.a.instance.registerHandler(et.EventNames.click,t,Object(r.d)(this,this.onClick,"onClick")),$i.a.instance.registerHandler(et.EventNames.touchMove,t,Object(r.d)(this,this.onTouchMove,"onTouchMove")),$i.a.instance.registerHandler(et.EventNames.touchEnd,t,Object(r.d)(this,this.onTouchEnd,"onTouchEnd"))},ao(t,[{key:"toggleButton",get:function(){return this.control}},{key:"properties",get:function(){return this.control.controlProperties}}]),t}(Qi);function lo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function co(e,t,n){return t&&lo(e.prototype,t),n&&lo(e,n),e}Object(s.a)(so,"ToggleButtonBehavior",Qi,[]);var uo=function(){function e(e){var t;this._commitChangeFixEnabled=e,this._factoryMethods=((t={}).Button=function(e){return new er(e)},t.FileMenuButton=function(e){return new er(e)},t.ColorPicker=function(e){return new lr(e)},t.ComboBox=function(e){return new Kr(e)},t.ContextMenuControl=function(e){return new Qr(e)},t.ContextMenuLauncher=function(e){return new Qr(e)},t.DialogMenuLauncher=function(e){return new Jr(e)},t.DropDown=function(e){return new xr(e)},t.FlyoutAnchor=function(e){return new ia(e)},t.GalleryButton=function(e){return new la(e)},t.StatefulColorFlyoutAnchor=function(e){return new ia(e)},t.JewelMenuLauncher=function(e){return new va(e)},t.Label=function(e){return new Ca(e)},t.Placeholder=function(e){return new Qi(e)},t.SearchBox=function(e){return new Ma(e)},t.Separator=function(e){return new Qi(e)},t.SplitButton=function(e){return new Xa(e)},t.StatefulColorSplitButton=function(e){return new Xa(e)},t.StatefulImageSplitButton=function(e){return new Xa(e)},t.TextBox=function(e){return new no(e)},t.ToggleButton=function(e){return new so(e)},t)}var t=e.prototype;return t.enableInsertTable=function(){this._factoryMethods[xi.Control.insertTableControlType]=function(e){return new ga(e)}},t.enableSlider=function(){this._factoryMethods[xi.Control.sliderControlType]=function(e){return new xa(e)}},t.enableSpinner=function(){this._factoryMethods[xi.Control.spinnerControlType]=function(e){return new ja(e)}},t.getBehaviorForControl=function(e){var t=this._factoryMethods[e.controlType],n=t?t(e):null;return n&&this._commitChangeFixEnabled&&n.enableCommitChangeFix(),n},co(e,null,[{key:"instance",get:function(){return e._instance||(e._instance=new e(!!E.AFrameworkApplication.appSettingsManager&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CUICommitChangeFixIsEnabled")))}}]),e}();uo._instance=null,Object(s.a)(uo,"ControlBehaviorFactory",null,[191]);var po=n(55),ho=n(203),mo=n(42);function go(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fo(e,t,n){return t&&go(e.prototype,t),n&&go(e,n),e}function vo(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var _o=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this)._launcherElement=null,a._x=0,a._y=0,a.rootUser=null,a._launcherHeight=0,a._launcherWidth=0,a.addDisplayMode("Menu"),a.enabled=!0,a}vo(t,e);var n=t.prototype;return n.setInitialAriaMenuLauncherAttributes=function(e){},n.updateAriaMenuLauncherAttributes=function(e,t){},n.getCommandPopulateProperties=function(){var e={};return e.MenuId=this.id,e.DialogMoveCommand=this.properties$2.DialogMoveCommand,e.DialogCloseCommand=this.properties$2.DialogCloseCommand,e},n.launchDialogMenuAtLauncher=function(e,t){this._x=e.x,this._y=e.y,this._launcherHeight=e.height,this._launcherWidth=e.width,this.launchMenu(t)},n.createComponentDomForDisplayMode=function(e){return this._launcherElement=ji.a.createElement("span"),new mo.a(e,this._launcherElement)},n.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.id,n,i)},fo(t,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"launcherHeight",get:function(){return this._launcherHeight}},{key:"launcherWidth",get:function(){return this._launcherWidth}},{key:"controlType",get:function(){return"DialogMenuLauncher"}},{key:"properties$2",get:function(){return this.controlProperties}}]),t}(Ni.MenuLauncher);Object(s.a)(_o,"DialogMenuLauncher",Ni.MenuLauncher,[]);var yo=n(211);function bo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function So(e,t,n){return t&&bo(e.prototype,t),n&&bo(e,n),e}function Co(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ao=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this)._activeMenu=null,i}Co(t,e);var n=t.prototype;return n.refreshInternal=function(){e.prototype.refreshInternal.call(this),Hi.c(this.elementInternal)&&this.ensureDOMElement(),this.elementInternal=ji.a.removeChildNodes(this.elementInternal),this.appendChildrenToElement(this.elementInternal),this.dirty=!1},n.ensureCorrectChildType=function(e){if(!Object(r.c)(yo.a,e))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot")},n.createDialogMenu=function(e,t,n,i){var r=new vr.Menu(this,t,n,i,null);e||(e={}),e.CommandMenuOpen=this.dialogMenuRootProperties.CommandMenuOpen,e.CommandMenuClose=this.dialogMenuRootProperties.CommandMenuClose;var a=new _o(this,t,e,r);this.createdControls[t]=a;var o=new yo.a(this,"dock"+t);o.addChild(a.createComponentForDisplayMode("Menu")),this.addChild(o),this.refresh()},n.showDialogMenuAt=function(e,t,n,i){var r=this.createdControls[e];if(Hi.c(r))throw Error.create('The dialog menu "'+e+'" does not exist');r.launchDialogMenuAtLauncher(new Sys.UI.Bounds(t,n,0,0),i),this._activeMenu=r.menu},n.closeDialogMenu=function(e){var t=this.createdControls[e];Hi.c(t)||(t.closeMenu(),this._activeMenu=null)},n.onMenuStackCleared=function(){this._activeMenu=null},n.dispose=function(){var t=this.createdControls;for(var n in t){({key:n,value:t[n]}).value.dispose()}e.prototype.dispose.call(this)},So(t,[{key:"activeMenu",get:function(){return this._activeMenu}},{key:"dialogMenuRootProperties",get:function(){return this.properties}},{key:"rootType",get:function(){return 20}}]),t}(ho.a);Object(s.a)(Ao,"DialogMenuRoot",ho.a,[]);var Io=n(206);function wo(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var To=function(e){function t(){var t;return(t=e.call(this)||this).CommandMenuOpen=null,t.CommandMenuClose=null,t}return wo(t,e),t}(Io.a);function Eo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ko(e,t,n){return t&&Eo(e.prototype,t),n&&Eo(e,n),e}Object(s.a)(To,"DialogMenuRootProperties",Io.a,[]);var Mo="DialogMenuRootId",Po=function(){function e(){var e=new To;e.ImageSideArrow=E.AFrameworkApplication.imageClusterPath,e.ImageSideArrowClass=po.getImageClass("SubmenuFlyoutArrow_13x13x32"),e.TextDirection=E.AFrameworkApplication.isRtl?"rtl":"ltr",this._root=new Ao(Mo,e),this._root.rootUser=this,this._root.refresh(),E.AFrameworkApplication.theActionManager.addActionWithFlags(ft.a.populateDialogMenu,Ct.a.frame,Object(r.d)(this,this.populateDialogMenu,"populateDialogMenu"),96)}var t=e.prototype;return t.executeRootCommand=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var a=parseInt(e);var o=E.AFrameworkApplication.theActionManager;n&&(o.commandLocation=n.CommandLocation,o.invocationMethod=n.InvocationMethod);var s=t,l=o.processActionWithData(a,2,s,r);return this._root.refresh(),32===l},t.isRootCommandEnabled=function(e,t){if(void 0===t&&(t=null),!e)return!0;var n=parseInt(e);return 32===E.AFrameworkApplication.theActionManager.processAction(n,1)},t.pollForStateAndUpdateInternal=function(){this.theRoot.root.pollForStateAndUpdate()},t.createDialogMenu=function(e,t,n){var i={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};i.DialogMoveCommand=t,i.DialogCloseCommand=n,this.theRoot.createDialogMenu(i,e,"","")},t.showDialogMenuAt=function(e,t,n,i){this.theRoot.showDialogMenuAt(e,t,n,i)},t.closeDialogMenu=function(e){this.theRoot.closeDialogMenu(e)},t.populateDialogMenu=function(e,t,n,i,r){if(1===n)return 32;var a=r,o=new Sys.StringBuilder;o.append('<Menu Id="dialogMenu">'),o.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');var s=a.DialogMoveCommand;o.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',s,CommonUIStrings.l_DialogMove));var l=a.DialogCloseCommand;return o.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',l,CommonUIStrings.l_DialogClose)),o.append("</Controls></MenuSection>"),o.append("</Menu>"),a.PopulationXML=o.toString(),32},t.dispose=function(){this._root&&(this._root.dispose(),this._root=null)},ko(e,[{key:"theRoot",get:function(){return this._root}}]),e}();Object(s.a)(Po,"DialogMenuRootUser",null,[48,4,17]);var Fo=n(52);function Do(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oo(e,t,n){return t&&Do(e.prototype,t),n&&Do(e,n),e}var Ro=10,xo=1,Uo=function(){function e(e,t,n){this._target=null,this._moveIcon=null,this._startingPosition=null,this._currentPosition=null,this._shouldExit=!1,this._inMoveMode=!1,this._frameElement=e,this._keyInputManager=t,this._pointerInputManager=n,this._isRTL=E.AFrameworkApplication.isRtl}var t=e.prototype;return t.enterMoveMode=function(e){e?(this._target=e,this._inMoveMode=!0,this._shouldExit=!1,this._keyInputManager.capture(Object(r.d)(this,this.keyEventHandler,"keyEventHandler"),null),this._pointerInputManager.registerHandler(et.EventNames.pointerDown,this._frameElement,Object(r.d)(this,this.pointerDownHandler,"pointerDownHandler")),this._moveIcon||this.createMoveIcon(),this._target.appendChild(this._moveIcon),this.initializeCurrentPosition()):ae.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")},t.exitMoveMode=function(){this._inMoveMode=!1,this._currentPosition=null,this._startingPosition=null,this.removeMoveIcon(),this.releaseHandlers(),this._target=null},t.releaseHandlers=function(){this._keyInputManager.releaseCapture(),this._pointerInputManager.unregisterHandler(et.EventNames.pointerDown,this._frameElement,Object(r.d)(this,this.pointerDownHandler,"pointerDownHandler"))},t.initializeCurrentPosition=function(){if(this._target.style.left.endsWith("px")&&this._target.style.right.endsWith("px"))this._currentPosition=new Sys.UI.Point(Fo.CssUtils.parseIntDefaultZero(this._isRTL?this._target.style.right:this._target.style.left),Fo.CssUtils.parseIntDefaultZero(this._target.style.top));else{var e=this._isRTL?this._frameElement.offsetWidth-(this._target.offsetLeft+this._target.offsetWidth+Fo.CssUtils.parseIntDefaultZero(this._target.style.marginRight)):this._target.offsetLeft-Fo.CssUtils.parseIntDefaultZero(this._target.style.marginLeft),t=this._target.offsetTop-Fo.CssUtils.parseIntDefaultZero(this._target.style.marginTop);this.setStylePosition(e,t),this._currentPosition=new Sys.UI.Point(e,t)}this._startingPosition=this._currentPosition},t.createMoveIcon=function(){this._moveIcon=po.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")},t.removeMoveIcon=function(){this._moveIcon.parentNode===this._target&&this._target.removeChild(this._moveIcon)},t.keyEventHandler=function(e){if(!this.inMoveMode)return!1;if(e.innerEvent.preventDefault(),e.eventName===et.EventNames.keyDown){var t,n=e.innerEvent.ctrlKey?xo:Ro;switch(e.innerEvent.keyCode){case mt.a.vK_UpArrow:this.moveElement(0,-1*n);break;case mt.a.vK_DownArrow:this.moveElement(0,1*n);break;case mt.a.vK_LeftArrow:t=this._isRTL?1:-1,this.moveElement(t*n,0);break;case mt.a.vK_RightArrow:t=this._isRTL?-1:1,this.moveElement(t*n,0);break;case mt.a.vK_Esc:this.moveElementTo(this._startingPosition.x,this._startingPosition.y),this._shouldExit=!0;break;case mt.a.vK_Enter:this._shouldExit=!0}}return e.eventName===et.EventNames.keyUp&&this._shouldExit&&this.exitMoveMode(),!0},t.pointerDownHandler=function(e){return!!this.inMoveMode&&(e.innerEvent.preventDefault(),this.exitMoveMode(),!0)},t.moveElement=function(e,t){var n=this._currentPosition.x+e,i=this._currentPosition.y+t;this.moveElementTo(n,i)},t.moveElementTo=function(e,t){var n=this.adjustPositionForAppFrameBounds(e,t);this.setStylePosition(n.x,n.y),this._currentPosition=n},t.setStylePosition=function(e,t){this._isRTL?this._target.style.right=e+"px":this._target.style.left=e+"px",this._target.style.top=t+"px"},t.adjustPositionForAppFrameBounds=function(e,t){var n=this._isRTL?Fo.CssUtils.parseIntDefaultZero(this._target.style.marginRight):Fo.CssUtils.parseIntDefaultZero(this._target.style.marginLeft),i=this._frameElement.offsetWidth-this._target.offsetWidth-n,r=Math.min(Math.max(-n,e),i),a=Fo.CssUtils.parseIntDefaultZero(this._target.style.marginTop),o=this._frameElement.offsetHeight-this._target.offsetHeight-a,s=Math.min(Math.max(-a,t),o);return new Sys.UI.Point(r,s)},Oo(e,[{key:"inMoveMode",get:function(){return this._inMoveMode}}]),e}();Object(s.a)(Uo,"KeyMoveAdapter",null,[18]);var Bo=n(335),Lo=n(141);function No(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ho(e,t,n){return t&&No(e.prototype,t),n&&No(e,n),e}var Wo=function(){function e(){}var t=e.prototype;return t.configure=function(e){E.AFrameworkApplication.appSettingsManager&&E.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AccessibleMovingDialogsEnabled")&&(e.register(17,"Common.UI.IDialogMenuRootUser").singleInstance().usingFactory((function(){return new Po})),e.register(18,"Common.IKeyMoveAdapter").singleInstance().usingFactory((function(){return new Uo(E.AFrameworkApplication.activeFrame.getDOMElement(),gt.KeyInputManager.instance,Ri.a.instance)}))),e.register(Lo.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().usingFactory((function(){return Lo.a.instance}))},t.init=function(){Bo.a.controlBehaviorFactory=uo.instance;for(var e=Lo.a.instance.roots,t=0;t<e.length;++t){var n=Object(M.a)(19,e[t]);n&&n.ensureBehaviorAttached()}z.a.get_instance().setAppInitializationStatus(6)},t.dispose=function(){},e.main=function(){Ae.a.instance.registerPackage(new e,5)},Ho(e,[{key:"name",get:function(){return"CUI.Behavior"}}]),e}();Object(s.a)(Wo,"CuiBehaviorPackage",null,[14,15]);var jo=function(){Type.registerNamespace("CUIB"),Wo.main()};Type.registerNamespace("Box4"),Type.registerNamespace("Wac.Common"),Type.registerNamespace("Wac.Common.SendUsYourFile"),Type.registerNamespace("Wac.Common.Utils"),Type.registerNamespace("WordShared"),Type.registerNamespace("WordViewer"),Type.registerNamespace("WordViewer.Comments"),Type.registerNamespace("WordViewer.Controls"),Type.registerNamespace("WordViewer.DisplayManager"),Type.registerNamespace("WordViewer.DocumentData"),Type.registerNamespace("WordViewer.DynamicScriptLoader"),Type.registerNamespace("WordViewer.PageInfo"),Type.registerNamespace("WordViewer.Search"),Type.registerNamespace("WordViewer.Selection"),i(),h(),m(),g(),f(),b(),C(),A(),I(),w(),G(),ke(),Me(),Re(),xe(),ze(),qe(),Je(),Et(),kt(),$t(),Jt(),nn(),cn(),un(),Qn(),Zn(),$n(),Xn(),Jn(),
/*! Version=16.0.10001.10000 */
window.dynamicScriptLoaderDependencies=Yn;var Vo=ei;window.dynamicScriptLoader=Vo,window.dynamicScriptLoader=Vo,mi(),gi(),Mi(),window.g_jsLT=new Date;window.WordViewer.App=Pi.App,window.ObjectModel=n(518),window.g_wordViewerJsDownloaded=!0,window.g_appSettingsDownloaded&&(Sys.Application.get_isInitialized()?window.g_wordViewerAppConstructed||pageInit():(Sys.Application.add_init(pageInit),Sys.Application.initialize())),Di(),Oi(),jo(),window.loadObjectModel=function(){return Promise.all([n.e(2),n.e(3)]).then(n.t.bind(null,551,7))}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(1),a=n(3),o=function(e,t){var n=null;if(e&&e.length>0&&t&&t.length>0){var i=window[t];if(i){i&&e in i?n=i[e]:a.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+e+" from dictionary "+t)}else a.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+t)}return n},s=function(){var e=!1,t=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId"),n=-1!==(t?t.toLowerCase():"").indexOf("floodgatelatestversion");return(e=n?r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateLatestVersionIsEnabled"):r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateUseRecentVersion"))?a.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "+n):a.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version"),e},l=n(33),c=function(){function e(){}var t=e.prototype;return t.getAppData=function(e){return null},t.getNPSBrsForApp=function(){return"ExcelNPSFloodgateEnabled"},t.getNPSDelayInMsBrsForApp=function(){return"ExcelNPSDelayInMilliseconds"},t.getNPSUsageActivityName=function(){return"AppUsageNPS"},t.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},t.getCampaignDefinitions=function(){return l.c(window.ExcelCampaignsObj)},t.getUserInitiatedSurvey=function(e){return o(e,"ExcelUserInitiatedSurveysDictionary")},e}();Object(i.a)(c,"ExcelFeedbackAppData",null,[238]);var u=function(){function e(){}var t=e.prototype;return t.getAppData=function(e){return null},t.getNPSBrsForApp=function(){return"OneNoteNPSFloodgateEnabled"},t.getNPSDelayInMsBrsForApp=function(){return"OneNoteNPSDelayInMilliseconds"},t.getNPSUsageActivityName=function(){return"AppUsageNPS"},t.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},t.getCampaignDefinitions=function(){return l.c(window.OneNoteCampaignsObj)},t.getUserInitiatedSurvey=function(e){return o(e,"OneNoteUserInitiatedSurveysDictionary")},e}();Object(i.a)(u,"OneNoteFeedbackAppData",null,[238]);var d=function(){function e(){}var t=e.prototype;return t.getAppData=function(e){return null},t.getNPSBrsForApp=function(){return"PPTNPSFloodgateEnabled"},t.getNPSDelayInMsBrsForApp=function(){return"PPTNPSDelayInMilliseconds"},t.getNPSUsageActivityName=function(){return"AppUsageNPS"},t.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},t.getCampaignDefinitions=function(){return l.c(window.PPTCampaignsObj)},t.getUserInitiatedSurvey=function(e){return o(e,"PPTUserInitiatedSurveysDictionary")},e}();Object(i.a)(d,"PPTFeedbackAppData",null,[238]);var p=function(){function e(){}var t=e.prototype;return t.getAppData=function(e){return null},t.getNPSBrsForApp=function(){return"VisioNPSFloodgateEnabled"},t.getNPSDelayInMsBrsForApp=function(){return"VisioNPSDelayInMilliseconds"},t.getNPSUsageActivityName=function(){return"AppUsageNPS"},t.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},t.getCampaignDefinitions=function(){return l.c(window.VisioCampaignsObj)},t.getUserInitiatedSurvey=function(e){return o(e,"VisioUserInitiatedSurveysDictionary")},e}();Object(i.a)(p,"VisioFeedbackAppData",null,[238]);var h=n(2),m=n(19),g=(n(9),n(176)),f=n(32),v=n(237),_=n(21),y=n(35),b=n(8);function S(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var C=function(){function e(e,t,n,i,a){var o=this;this._mostRecentError=null,this._isFeedbackEnabled=!0,this._dataPlumber=null,this._actionManager=e,this._activeFrame=t,this._customerFeedbackFormManager=n,this._settingsManager=i,this.dataPlumber=a,r.AFrameworkApplication.add_errorDialogDisplayed(Object(h.d)(this,this.updateLastError,"updateLastError")),_.a.instance.resolveFuture("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute((function(e){e.getBooleanPolicySetting("Enabled").then((function(e){return o._isFeedbackEnabled=e,null}),(function(e){return null}))}))}var t,n,i,o=e.prototype;return o.updateLastError=function(e,t){if(null!=t){var n=t;n&&(this._mostRecentError=n.errorCode)}},o.registerActions=function(){this._actionManager.addAction(b.a.giveFeedback,y.a.frame,Object(h.d)(this,this.giveFeedbackHandler,"giveFeedbackHandler")),this._actionManager.addAction(b.a.triggerFloodgateSurvey,y.a.frame,e.triggerFloodgateSurvey),this._activeFrame.updateCommandUI()},o.giveFeedbackHandler=function(e,t,n,i,o){if(1===n)return this._isFeedbackEnabled&&v.SessionStatusManager.instance.isNetworkConnected?32:8;if(2===n){a.ULS.sendTraceTag(8405838,356,50,""),this.dataPlumber.Feedback|=f.a.feedback_Attempted;var s=o||{};void 0!==s.ErrorCode&&null!==s.ErrorCode||null==this._mostRecentError||(s.ErrorCode=this._mostRecentError),r.AFrameworkApplication.appSettingsManager.addInfoForULS(s),this._customerFeedbackFormManager.launchFeedbackFormWhenAvailable(s)}return 32},e.triggerFloodgateSurvey=function(e,t,n,i,r){if(1===n)return v.SessionStatusManager.instance.isNetworkConnected?32:8;if(2===n&&!r)return 8;var a=r;return _.a.instance.resolveFuture("Common.ISystemInitiatedFeedback").execute((function(e){e.logActivity(Object(m.a)(String,a.ActivityName),Object(m.a)(String,a.BRSName))})),32},t=e,(n=[{key:"dataPlumber",get:function(){return this._dataPlumber||(r.AFrameworkApplication.dataPlumber||(r.AFrameworkApplication.dataPlumber=new g.a),this._dataPlumber=r.AFrameworkApplication.dataPlumber),this._dataPlumber},set:function(e){this._dataPlumber=e}}])&&S(t.prototype,n),i&&S(t,i),e}();function A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object(i.a)(C,"CustomerFeedbackActor",null,[]);var I=function(){function e(e,t,n){this._loadingJs=!1,this._jsDownloaded=!1,this._contextData=null,this._dataPlumber=null,this._uiWrapper=e,this._resourceDownloadManager=t,this.dataPlumber=n}var t,n,i,o=e.prototype;return o.launchFeedbackFormWhenAvailable=function(e){this._contextData=e,this.initOFeedbackIfDepsReady()||this.loadResources()},o.loadResources=function(){this._loadingJs||(this._loadingJs=!0,this._resourceDownloadManager.downloadJsResource(Object(h.d)(this,this.oFeedbackJsDownloadFinished,"oFeedbackJsDownloadFinished")))},o.oFeedbackJsDownloadFinished=function(e,t){e?(this._jsDownloaded=!0,this.dataPlumber.Feedback|=f.a.feedback_ResourcesDownloadSuccessful,this.initOFeedbackIfDepsReady(),a.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.dataPlumber.Feedback|=f.a.feedback_ResourcesDownloadFailed,a.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed")),this._loadingJs=!1},o.initOFeedbackIfDepsReady=function(){return!!this._jsDownloaded&&(this._uiWrapper.showUi(this._contextData),!0)},o.jsDownloaded=function(e){this._jsDownloaded=e},o.getJSDownloaded=function(){return this._jsDownloaded},t=e,(n=[{key:"dataPlumber",get:function(){return this._dataPlumber||(r.AFrameworkApplication.dataPlumber||(r.AFrameworkApplication.dataPlumber=new g.a),this._dataPlumber=r.AFrameworkApplication.dataPlumber),this._dataPlumber},set:function(e){this._dataPlumber=e}}])&&A(t.prototype,n),i&&A(t,i),e}();Object(i.a)(I,"CustomerFeedbackC3FormManager",null,[250]);var w=n(40),T=n(134),E=n(130),k=function(){function e(e){void 0===e&&(e=null),this._onJsDownloadFinished=null,this._callbackData=e}var t=e.prototype;return t.downloadJsResource=function(e){this._onJsDownloadFinished=e;var t="Feedback/officebrowserfeedback_floodgate.js";s()&&(t="Feedback/latest/officebrowserfeedback_floodgate.js");var n=w.a.commonScripts(t),i=(w.a.commonScriptsLocalized("OFeedbackIntl.js"),E.a.create(n));i.add_loadFinished(Object(h.d)(this,this.onJsDownloadFinished,"onJsDownloadFinished")),T.a.enqueueResourceWithoutEnabling(i),a.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",n)},t.setCallerData=function(e){this._callbackData?e&&this._callbackData.add(e):this._callbackData=e},t.onJsDownloadFinished=function(e,t){this._onJsDownloadFinished(t.succeeded,this._callbackData)},e}();Object(i.a)(k,"CustomerFeedbackResourceDownloadManager",null,[251]);var M=n(11),P=function(){function e(){this.audienceGroup=null,this.ringId=0,this.ocvEnvironment=0}return e.prototype.isProd=function(){return!this.ocvEnvironment},e}();Object(i.a)(P,"OCVData",null,[]);var F=n(31),D=n(78),O=n(97);var R=function(e){var t,n;function i(t){var n;return(n=e.call(this)||this).submitted=t,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Sys.EventArgs);Object(i.a)(R,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var x=n(66),U=n(44),B=n(94),L=n(197),N=n(13),H=n(131),W=n(24),j=n(73),V=n(57),K=n(307),z=n(308),q=n(243),G=function(){this.text=null};Object(i.a)(G,"AppBaseButtonProps",null,[]);var Q=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).onExecute=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(G);Object(i.a)(Q,"CustomCalloutButtonProps$1",G,[]);var Z=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).onExecute=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(G);Object(i.a)(Z,"CustomCalloutButtonProps",G,[]);var $=n(309),X=n(86),J=n(39),Y=function(e){this.type=null,this.type=e};Object(i.a)(Y,"CustomContentProps",null,[]);var ee=function(){function e(e,t,n,i,a,o,s,l,c){this.currentPage=0,this.ratingComponent=null,this.promptComponent=null,this.ratingSendButtonProps=null,this.cancelButtonProps=null,this.verbatimSendButtonProps=null,this.disclaimer=null,this.prompt=null,this.thankyouText=null,this.question=null,this.ratingLabels=null,this.privacyStatement=null,this.privacyStatementLink=null,this.verbatimPrompt=null,this.verbatimDisclaimer=null,this.emailLabel=null,this.emailPlaceHolder=null,this.submissionDisclaimer=null,this.verbatimPrivacyStatement=null,this.isCommercialHost=!1,this.emailValidationErrorMessage=null,this.currentPage=e,this.prompt=CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion,this.question=n,this.ratingLabels=i,this.ratingSendButtonProps=s,this.verbatimSendButtonProps=l,this.cancelButtonProps=c,this.disclaimer=this.getDisclaimerStatement(),this.ratingComponent=a,this.promptComponent=o,this.privacyStatement=CommonUIStrings.l_WAC_NPS_PrivacyPolicy,this.verbatimPrompt=CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion,this.verbatimDisclaimer=CommonUIStrings.l_WAC_NPS_VerbatimDisclaimer,this.emailLabel=CommonUIStrings.l_WAC_NPS_EmailLabel,this.emailPlaceHolder=CommonUIStrings.l_WAC_NPS_EmailPlaceHolder,this.submissionDisclaimer=this.getDisclaimerStatement(),this.verbatimPrivacyStatement=CommonUIStrings.l_WAC_NPS_PrivacyPolicyVerbatim,this.thankyouText=CommonUIStrings.l_WAC_NPS_Thankyou,this.privacyStatementLink="http://go.microsoft.com/fwlink/?LinkID=390004",this.isCommercialHost=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost"),this.emailValidationErrorMessage=CommonUIStrings.l_WAC_NPS_EmailValidationErrorMessage}return e.prototype.getDisclaimerStatement=function(){return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost")?CommonUIStrings.l_WAC_ModernNPSServeyRadioButtonCommercial:CommonUIStrings.l_WAC_ModernNPSServeyRadioButtonConsumer},e}();Object(i.a)(ee,"NpsOneClickRadioButtonCommonProps",null,[]);var te=function(e){var t,n;function i(t,n,i,r,a,o,s,l,c){var u;return(u=e.call(this,"NPSOneClickRadioButton")||this).npsOneClickCommonProps=null,u.npsOneClickCommonProps=new ee(t,n,i,r,a,o,s,l,c),u}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Y);Object(i.a)(te,"NpsOneClickRadioButtonCustomProps",Y,[]);var ne=function(){this.surveyId=null};Object(i.a)(ne,"Survey",null,[]);var ie=function(){function e(){}return e.init=function(e,t,n,i,r){r.onDismiss=e,r.onError=t;var o=null;OfficeBrowserFeedback.initOptions?("screenshot"in r&&(OfficeBrowserFeedback.initOptions.screenshot=r.screenshot),"showEmailAddress"in r&&(OfficeBrowserFeedback.initOptions.showEmailAddress=r.showEmailAddress),o=r):OfficeBrowserFeedback.initOptions=r,OfficeBrowserFeedback.multiFeedback(o).then((function(){a.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")})).catch((function(e){return a.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+e.toString())}))},e.initSIFeedback=function(t,n,i,r){if(a.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback"),e._initState===e.initialized)return Promise.resolve(1);if(e._initState===e.initializing)return e.initializingMsgLogged||(e.initializingMsgLogged=!0,a.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(e._initState!==e.error){if(e._initState=e.initializing,a.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check"),e.initSIContext(t,n,i,r))return e.initFloodgate();e._initState=e.error,Promise.reject(e.ofbUndefinedMsg)}return Promise.reject(0)},e.initFloodgate=function(){try{return OfficeBrowserFeedback.floodgate.initialize().then((function(t){return e.startFloodgate()})).catch((function(e){a.ULS.sendTraceTag(36546402,356,10,"BFCOCV Floodgate initialize error:"+e.toString())}))}catch(t){return a.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+t.toString()),Promise.reject(e.ofbFloodgateInitializeUndefinedMsg)}},e.startFloodgate=function(){return OfficeBrowserFeedback.floodgate.start().then((function(){e.floodgateInitCompleted()})).catch((function(e){a.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+e.toString())}))},e.floodgateInitCompleted=function(){e._initState=e.initialized,a.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate")},e.officeBrowserFeedbackIsUndefined=function(){return"undefined"==typeof OfficeBrowserFeedback},e.initSIContext=function(t,n,i,o){var s=!0;try{if(e.officeBrowserFeedbackIsUndefined())return a.ULS.sendTraceTag(39900617,356,15,e.ofbUndefinedMsg),!1;OfficeBrowserFeedback.initOptions||(i.onDismiss=o,i.onError=n,i=e.appendAutoDismissToAppData(i),OfficeBrowserFeedback.initOptions=i),e.getPetrolPayload(i),e.isProduction=!i.environment;var l=e.onSurveyActivated,c={},u={};u.onSurveyActivated=l,u.onTeachingCampaignRender=i.onTeachingCampaignRender,c.onSurveyActivatedCallback=u,c.onDismiss=t,c.autoDismiss=i.FloodgateUIAutoDismissTimeEnum,c.uIStringGetter=i.uIStringGetter,c.authTokenCallback=i.authTokenCallback,c.augLoopCallback=i.augLoopCallback,c.campaignFlights="",r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAdminControlsIsEnabled")&&("surveyEnabled"in i&&(c.surveyEnabled=i.surveyEnabled),"showEmailAddress"in i&&(c.showEmailAddress=i.showEmailAddress));var d=e.getCurrentFlights(i),p=e.getFloodgateFlightParameters(d),h=e.getDefaultCampaignQueryParameters(i);for(var m in p){var g={key:m,value:p[m]};-1!==g.key.toLowerCase().indexOf("flight")?c.campaignFlights+=g.value+";":h=h+g.key+"="+g.value+"&"}a.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+c.campaignFlights+" campaignQueryParameters: "+h),c.campaignQueryParameters=h,OfficeBrowserFeedback.floodgate.initOptions=c}catch(e){s=!1,a.ULS.sendTraceTag(39900618,356,15,e.toString())}return s},e.appendAutoDismissToAppData=function(e){try{var t=e.applicationGroup?e.applicationGroup:{},n=t.appData,i=n?l.a(l.a('"'+n+'"')):{};i.fgUIAutoDismiss=e.FloodgateUIAutoDismissTimeEnum,t.appData=l.c(i),e.applicationGroup=t}catch(e){a.ULS.sendTraceTag(588842831,356,10,"Failed to parse applicationGroup.appData",e.toString())}return e},e.getCurrentFlights=function(e){var t=Array.isArray(e.Flights)?e.Flights:null;if(!t){var n=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId");t=n?n.toString().split(";"):null}return t},e.getFloodgateFlightParameters=function(e){var t={SelfTriggerActivity:""};if(!e||!e.length)return t;try{for(var n=0;n<e.length;n++){var i=e[n]?e[n].toLowerCase():"";if(-1!==i.indexOf("floodgateflight")){"AppFlights"in t?t.AppFlights+=";"+i:t.AppFlights=i;var o=N.a.replaceAll(i,"-",""),s=r.AFrameworkApplication.appSettingsManager.getStringAppSetting(o);if(s)try{var c=l.a(s);if((c?c.SelfTriggerActivity:null)||(t.SelfTriggerActivity+=";"+o),c)for(var u in c){var d={key:u,value:c[u]};d.key in t?t[d.key]!==d.value&&(t[d.key]=t[d.key]+";"+d.value):t[d.key]=d.value}}catch(e){a.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+o+" json data",e.toString())}else t.SelfTriggerActivity+=";"+o}}}catch(e){a.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",e.toString())}return t},e.getDefaultCampaignQueryParameters=function(e){var t,n="",i=((t={}).OFC_Audience="AudienceGroup",t.AppHostName="Host",t.AppMode="ApplicationMode",t.Datacenter="WACDatacenter",t.UpsellMode="FreemiumUpsellMode",t.TenantId="TenantId",t);for(var a in i){var o={key:a,value:i[a]},s=e[Object(m.a)(String,o.value)];s||(s=r.AFrameworkApplication.appSettingsManager.getStringAppSetting(Object(m.a)(String,o.value))),s&&(n+=o.key+"="+encodeURIComponent(s)+"&")}return n},e.onSurveyActivated=function(t,n){t?(a.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated"),r.AFrameworkApplication.activeFrame.applicationInstance.isReactNotificationsEnabled&&(r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NPS1ClickSurveyIsEnabled")||r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NPSOneClickRadioButtonIsEnabled"))&&n&&"customux"===n.getLauncherType()?(r.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordNPS1ClickSurveySettings"),a.ULS.sendTraceTag(51197718,356,50,"BFCOCV.CustomLauncherType"),"npsoneclickradiobutton"===r.AFrameworkApplication.appSettingsManager.getStringAppSetting("NpsUxType")?(a.ULS.sendTraceTag(575979847,356,50,"Showing Insightful survey experience"),e.showNPSSurvey(n,"NPSOneClickRadioButton")):a.ULS.sendTraceTag(51197721,356,10,"BFCOCV.ShowNPSOneClickError")):(t.launch(),e.setupEventHandlersOnSurveyUI())):a.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")},e.logActivity=function(t){if(e.checkParams(t,"LogActivity")){var n=e.getFloodgateListener();n&&(a.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+t),n.logActivity(t))}},e.showUserInitiatedSurvey=function(t){t?(a.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(t),e.setupEventHandlersOnSurveyUI()):a.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")},e.setupEventHandlersOnSurveyUI=function(){a.ULS.sendTraceTag(36706401,356,50,"BFCOCV.SetupEventHandlersOnSurveyUI"),e.addFocusScope(e.floodgateContainerID)},e.initializeFocusSettings=function(e,t,n,i,r,a,o,s,l,c,u,d){void 0===c&&(c=!0),void 0===u&&(u=!1),void 0===d&&(d=!1);var p=W.FocusManager.instance(),h=p.getScope(e);if(h.parent=F.AFrame.mainAppFocusId,h.keyDownHandledExternally=d,H.F6Manager.instance.addF6(e,c),t&&h.addSetFocus(t),n&&h.addOnFocus(n),i&&h.addOnBlur(i),r&&(j.a.instance.addControlFocus(e,r,a,u),V.a.instance.addControlFocus(e,r,a,u),o)){for(var m=new D.DOMFocusListing((function(){return r})),g=0;g<s.length;++g)m.addValidTag(s[g]);p.buildRegionWithDelegate((function(){return r}),h,m).looped=l}return h},e.addFocusScope=function(t){var n=document.getElementById(t);if(n)e.initializeFocusSettings(t,null,e.onFocusAction,null,n,!1,!0,[3,2,5,1],!0,!0,!0,!0);else a.ULS.sendTraceTag(36706402,356,10,"BFCOCV.Could not find container "+t)},e.onFocusAction=function(e,t){if(a.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+(e?e.name:"")+" NextScopeName "+(t?t.name:"")),t){var n=W.FocusManager.instance().getRegion(t.name);n&&n.moveIntoFromTop()}},e.logActivityStart=function(t){if(e.checkParams(t,"LogActivityStart")){var n=e.getFloodgateListener();n&&(a.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+t),n.logActivityStartTime(t))}},e.logActivityEnd=function(t){if(e.checkParams(t,"LogActivityEnd")){var n=e.getFloodgateListener();n&&(a.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+t),n.logActivityStopTime(t,new Date))}},e.floodgateStart=function(){OfficeBrowserFeedback.floodgate.start()},e.floodgateStop=function(){OfficeBrowserFeedback.floodgate.stop()},e.checkParams=function(e,t){return e||a.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+t),!!e},e.getFloodgateListener=function(){var t=null,n=OfficeBrowserFeedback.floodgate.getEngine();return n?(t=n.getActivityListener())||a.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):e.nullFloodgateEngineMsgLogged||(e.nullFloodgateEngineMsgLogged=!0,a.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null")),t},e.addAdditionalFieldsToAppData=function(e){try{var t=e.appData,n=t?l.a(t):{};n.isExperimentalSurvey="No",n.Description="App NPS Insightful Survey experience",e.appData=l.c(n)}catch(e){a.ULS.sendTraceTag(575981714,356,10,"Error adding additional fields to AppData"+e.toString())}return e},e.submitRating=function(t,n,i){try{var r=OfficeBrowserFeedback.initOptions.applicationGroup?OfficeBrowserFeedback.initOptions.applicationGroup:{},o=e.addAdditionalFieldsToAppData(r);OfficeBrowserFeedback.initOptions.applicationGroup=o,i.setSelectedRatingIndex(t),e.petrolPayload.rating=t,n.submit(),a.ULS.sendTraceTag(51197722,356,50,"BFCOCV.NPS1ClickRatingResponse_Submitted")}catch(e){a.ULS.sendTraceTag(579217044,356,10,"Rating Submission Error: "+e.toString())}},e.submitVerbatim=function(t,n,i,r){try{e.petrolPayload.comment=t,e.petrolPayload.email=n;var o=e.petrolPayload.application?e.petrolPayload.application:{},s=e.addAdditionalFieldsToAppData(o);e.petrolPayload.application=s,e.petrolPayload.survey.surveyId=r.getCampaignId();var c={"Content-Type":"application/json"},u={},d=e.petrolPayload.application;u.appData=d.appData,u.extendedManifestData=i,e.petrolPayload.application=u,e.petrolPayload.clientFeedbackId=r.getClientFeedbackId();e.petrolPayload.rating=(e.petrolPayload.rating+1)/5,e.queueRequestToOCV(l.c(e.petrolPayload),c),a.ULS.sendTraceTag(587551686,356,50,"BFCOCV.NPS1ClickVerbatimResponse_Submitted")}catch(e){a.ULS.sendTraceTag(579728323,356,10,"Verbatim Submission Error: "+e.toString())}},e.getPetrolPayload=function(t){try{e.petrolPayload.appId=t.appId,e.petrolPayload.application=t.applicationGroup,e.petrolPayload.manifestType="Nps",e.petrolPayload.source="Client",e.petrolPayload.submitTime=(new Date).toISOString(),e.petrolPayload.telemetry=t.telemetryGroup,e.petrolPayload.type="Survey",e.petrolPayload.survey=new ne,e.petrolPayload.web=t.webGroup;e.petrolPayload.telemetry&&e.petrolPayload.telemetry.flights&&e.petrolPayload.telemetry.flights.length>2e3&&(e.petrolPayload.telemetry.flights=String.format("{0}...[Flight IDs trimmed]",e.petrolPayload.telemetry.flights.substr(0,1999)))}catch(e){a.ULS.sendTraceTag(575981715,356,10,"Error populating Petrol API payload"+e.toString())}},e.queueRequestToOCV=function(t,n,i){void 0===i&&(i=0);var o=0;i>3||(1===i?o=200:i>1&&(o=200+500*(i-1)),r.AFrameworkApplication.theTaskManager.addTask(new J.a(2,1,o,(function(o){r.AFrameworkApplication.theClientRequestManager.addRequest(e.isProduction?"https://petrol.office.microsoft.com/v1/feedback":"https://petrol-int.office.microsoft.com/v1/feedback",2,t,n,!1,2,(function(e){a.ULS.sendTraceTag(587551687,356,50,"Success sending OCV feedback for Page 2 verbatim")}),(function(r){e.queueRequestToOCV(t,n,i+1),a.ULS.sendTraceTag(587551688,356,50,"Failure sending OCV feedback for Page 2 verbatim, attempt {0}",i)}),null)}))))},e.showNPSSurvey=function(t,n){return X.UISurfaces.getNotificationsAPIAsync().then((function(i){var r,o,s,l,c,u,d=null,p=t.getComponent("Rating"),h=t.getComponent("Prompt"),m=p.getQuestion(),g=h.getQuestion(),f=p.getRatingValuesAscending(),v=null,_=!1,y=((o=new K.a).target=".WACStatusBarContainer",o.showCloseIcon=!0,o.calloutProps=((r=new $.a).directionalHint=2,r.isBeakVisible=!1,r.preventDismissOnScroll=!0,r),o.preventLightDismiss=!0,o),b=((s=new Z).text=CommonUIStrings.l_WAC_NPS_Cancel,s.onExecute=function(){d&&i.removeNotification(d)},s),S=((l=new Q).text=CommonUIStrings.l_WAC_NPS_Send,l.onExecute=function(n){var i=n[0],r=n[1],a=n[2];d&&e.submitVerbatim(i,r,a,t)},l);if("NPSOneClickRadioButton"===n){var C,A=((C=new Q).text=CommonUIStrings.l_WAC_NPS_Send,C.onExecute=function(n){if(d){e.submitRating(n,t,p),i.removeNotification(d),v=new te(1,g,m,f,p,h,null,S,b),y.content=v;var r=i.callout(y);d=i.addNotification(r)}},C);v=new te(0,g,m,f,p,h,A,S,b),y.content=v,_=i.isCustomContentSupported(v)}var I=((u=new q.a).telemetryId=String.format("NPSSurvey-{0}",n),u.expirationOptions=((c=new z.a).displayTimeoutSeconds=e.customUxAutoDismiss,c.onExpire=function(){d&&(i.removeNotification(d),a.ULS.sendTraceTag(51197723,356,50,"BFCOCV.NPS1ClickResponse_Expired"))},c),u);if(_){var w=i.callout(y);d=i.addNotification(w,I)}return null})).catch((function(e){a.ULS.sendTraceTag(51197724,356,10,"BFCOCV React Notification Error:"+e.toString())}))},e}();ie.floodgateContainerID="obf-ToastContainer",ie.notInitialized=0,ie.initializing=1,ie.initialized=2,ie.error=-1,ie._initState=ie.notInitialized,ie.nullFloodgateEngineMsgLogged=!1,ie.initializingMsgLogged=!1,ie.ofbUndefinedMsg="OFB still undefined",ie.ofbFloodgateInitializeUndefinedMsg="OFB Floodgate is undefined or does not contain initialize function",ie.customUxMaxWidth=1200,ie.customUxAutoDismiss=30,ie.isProduction=!1,ie.petrolPayload={},Object(i.a)(ie,"BrowserFeedbackControlOCV",null,[]);var re=n(49);function ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var oe=function(){function e(t,n){this.mainContentHolderId="obf-MainContentHolder",this.likeButtonId="obf-OverallSmileAnchor",this.privacyStatementLinkId="obf-PrivacyStatementLink",this.contactFormContainerId="obf-MiddleFormContainer",this.commentBoxId="obf-BasicFormComment",this.submitButtonId="obf-BasicFormSubmitButton",this.suggestionButtonId="officeBrowserFeedbackOverallSuggestDiv",this.userVoicePrivacyStatementLinkId="officeBrowserFeedbackUservoiceLinkFormAnchor",this.goToUserVoiceButtonId="officeBrowserFeedbackUservoiceLinkFormCloseButton",this.userVoiceFormContainerId="officeBrowserFeedbackUservoiceLinkFormContainer",this.visibleClassName="obf-visible",this._checkLikeButtonIntervalId=e.resetIntervalId,this._checkMainContentHolderIntervalId=e.resetIntervalId,this._isFeedbackEnabled=!0,this._isScreenshotEnabled=!0,this._isEmailEnabled=!1,this._isSurveyEnabled=!1,this._flagIsEmailEnabledSet=!1,this._flagIsSurveyEnabledSet=!1,this.onDismissedCallback=null,this._dataPlumber=null,this._submitButton=null,this._gotoUserVoiceButton=null,this._userVoiceFormContainer=null,this._likeButton=null,this._commentBox=null,this._suggestionButton=null,this._userVoicePrivacyStatementLink=null,this._contactFormContainer=null,this._privacyStatementLink=null,this._mainContentHolder=null,this._feedbackTabHandlerEnabled=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FeedbackTabHandlerEnabled"),this._focusManager=t,this.dataPlumber=n,this._eventSource=new re.a;var i=this;_.a.instance.resolveFuture("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute((function(e){e.getBooleanPolicySetting("Enabled").then((function(e){return i._isFeedbackEnabled=e,null}),(function(e){return null})),e.getBooleanPolicySetting("IncludeScreenshot").then((function(e){return i._isScreenshotEnabled=e,null}),(function(e){return null})),e.getBooleanPolicySetting("IncludeEmail").then((function(e){return i._isEmailEnabled=e,i._flagIsEmailEnabledSet=!0,null}),(function(e){return null})),e.getBooleanPolicySetting("SurveyEnabled").then((function(e){return i._isSurveyEnabled=e,i._flagIsSurveyEnabledSet=!0,null}),(function(e){return null}))}))}var t,n,i,o=e.prototype;return o.add_onFeedbackUiDismissed=function(t){this._eventSource.addHandler(e.onFeedbackUiDismissedEventId,t)},o.remove_onFeedbackUiDismissed=function(t){this._eventSource.removeHandler(e.onFeedbackUiDismissedEventId,t)},o.clearCachedElements=function(){this._submitButton=null,this._gotoUserVoiceButton=null,this._userVoiceFormContainer=null,this._likeButton=null,this._commentBox=null,this._suggestionButton=null,this._userVoicePrivacyStatementLink=null,this._contactFormContainer=null,this._privacyStatementLink=null,this._mainContentHolder=null},o.isElementVisible=function(e){return!!e&&e.className.toLowerCase().indexOf(this.visibleClassName.toLowerCase())>=0},o.showUi=function(t){if(r.AFrameworkApplication.showFeedbackButton){if(this._isFeedbackEnabled){var n=t||{};this.getContext(n);var i=e.determineFeedbackUlsCategory(n.AppMode||"Unknown");ie.init(Object(h.d)(this,this.onDismiss,"onDismiss"),Object(h.d)(this,this.onError,"onError"),356,i,n),this.initializeFocus(),e.allowKeytips(!1),a.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus."),this.dataPlumber.Feedback|=f.a.feedback_Opened}}else a.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")},o.fillUserEmail=function(e,t){if(t&&t.ringId<=2){var n=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName");n&&n.length>0&&(e.userEmail=n),e.userEmailConsentDefault=!0}else e.userEmail=""},o.getAppData=function(e){var t,n={};if(void 0!==e.appData&&null!==e.appData){var i=e.appData;for(var r in i){var o={key:r,value:i[r]};n[o.key]=o.value}}if(n.App=e.Application||"",n.AppMode=e.AppMode||"",n.AppModeExt=e.ApplicationMode||"",n.Host=e.Host||"",n.Language=e.locale,n.IsError=e.Error||!1,n.IsCrash=e.Crash||!1,n.ServerDocId=e.ServerDocId||"",e.ErrorCode&&""!==e.ErrorCode.toString()&&(n.IsError=!0),"Origin"in e&&(n.Origin=e.Origin),n.ClientThrottlingProtection=this.dataPlumber.ClientThrottlingProtection||"",n.HostServiceLevel=this.dataPlumber.HostServiceLevel||"",n.RequestedCallThrottling=this.dataPlumber.RequestedCallThrottling||"",n.WacServiceLevel=this.dataPlumber.WacServiceLevel||"",this.dataPlumber.HostResponseStats){var s=this.dataPlumber.HostResponseStats.Label;s&&(n.HostFarmHint=s)}var c=null;try{c=l.c(n),c=N.a.encodeString(c,N.a.jsonEscapedCharacters)}catch(e){c="",a.ULS.sendTraceTag(39077268,356,10,"Exception trying to serialize appData:"+e.message)}return(t={}).appData=c||"",t},o.getCommonContext=function(t,n){var i;if(!t||!n)return null;t.LanguageID?t.locale=L.a.getCultureInfo(t.LanguageID).name||"":t.ApplicationLCID&&(t.locale=t.ApplicationLCID),t.applicationGroup=this.getAppData(t),e.determineOCVData(n,t),t.appId=e.determineOCVFeedbackAppId(),t.environment=n.ocvEnvironment,s()?(t.stylesUrl=w.a.commonScripts("Feedback/latest/officebrowserfeedback.css"),t.intlUrl=w.a.commonScriptsPath("Feedback/latest/Intl/")):(t.stylesUrl=w.a.commonScripts("Feedback/officebrowserfeedback.css"),t.intlUrl=w.a.commonScriptsPath("Feedback/Intl/")),t.rtl=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Rtl")?"rtl":"ltr";var o=e.determineOCVFeedbackAppColor();t.primaryColour=o.primaryColour,t.secondaryColour=o.secondaryColour,t.sessionId=t.SessionID||t.WACSessionID||"",t.build=t.ApplicationVersion||t.WFEVersion||"";var l=t.FlightIDs?t.FlightIDs.toString():t.Flights?t.Flights.toString():"",c="";t.ErrorCode&&(c=t.ErrorCode.toString());var u=this.getPlatform(t),d=n.isProd()?r.AFrameworkApplication.appSettingsManager.getStringAppSetting("TenantId"):"";d||(d="");var p=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("LoggableUserIdSpace"),h=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("LoggableUserId")||"";switch(p){case"MsaPuid":h="p:"+h;break;case"MsaCid":h="m:"+h;break;case"OrgIdPuid":h="a:"+(r.AFrameworkApplication.appSettingsManager.getStringAppSetting("AADUserObjectId")||h);break;default:a.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: "+h+", LoggableUserIdSpace: "+p),h=""}var m={};if(void 0!==t.telemetryGroup&&null!==t.telemetryGroup){var g=t.telemetryGroup;for(var f in g){var v={key:f,value:g[f]};m[v.key]=v.value}}return m.audienceGroup=n.audienceGroup,m.flights=l,m.platform=u,m.ringId=n.ringId,m.officeUILang=r.AFrameworkApplication.lcid,m.errorCode=c,m.loggableUserId=h,d.length>0&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==d&&(m.tenantId=d),t.telemetryGroup=m,t.webGroup=((i={}).browser=t.Browser||"",i.browserVersion=(t.BrowserMajorVersion||"")+"."+(t.BrowserMinorVersion||""),i.dataCenter=t.Datacenter||t.WACDatacenter||"",i),t.isCommercialHost=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost"),t.disableIncludeScreenshot=!this._isScreenshotEnabled,t.screenshot=this._isScreenshotEnabled,t.showEmailAddress=this._isEmailEnabled,r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAdminControlsIsEnabled")&&(t.surveyEnabled=this._isSurveyEnabled,r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost")&&(t.showEmailAddress=!0,t.surveyEnabled=!0)),this.fillUserEmail(t,n),t.DismissHandler?this.onDismissedCallback=t.DismissHandler:this.onDismissedCallback=null,t},o.areFeedbackOCPSPoliciesSet=function(){return this._flagIsEmailEnabledSet&&this._flagIsSurveyEnabledSet},o.getContext=function(e){var t=e||this.getContextFromAppSettings(),n=new P;return this.getCommonContext(t,n),t},o.getPlatform=function(e){var t="";return e.Platform&&(t=e.Platform.toString()),e.PlatformMajorVersion&&(t.length>0&&(t+=" "),t+=e.PlatformMajorVersion.toString()+"."),e.PlatformMinorVersion&&(t+=e.PlatformMinorVersion.toString()),t},o.standardizeKeyNames=function(e){e.ApplicationMode&&(e.AppMode=e.ApplicationMode),e.ApplicationModeExtended&&(e.ApplicationMode=e.ApplicationModeExtended)},o.getContextFromAppSettings=function(){var e;try{e=l.b(r.AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson.toString()),this.standardizeKeyNames(e)}catch(t){a.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),e={}}return e},o.onError=function(t){a.ULS.sendTraceTag(37259477,356,10,"FB submit error: "+t),this.dataPlumber.Feedback|=f.a.feedback_Error,e.allowKeytips(!0)},o.doNPSTestAction=function(){if(e.isNPSLocalizationTestingSession()){a.ULS.sendTraceTag(40112215,356,50,e.npsTestActivityFlightBRS);var t=_.a.instance.resolve("Common.ISystemInitiatedFeedback");t&&t.logActivity("AppUsageNPSLocalizationTest",null)}},o.onDismiss=function(t){this.removeFocus(),this.clearCachedElements(),x.a.oldActionsPipelineIsEnabled()&&a.ULS.sendTraceTag(34936718,356,50,"FB dismiss"),x.a.isUserActionLoggingToOtelEnabled()&&O.c(t?b.a.feedbackSubmit:b.a.feedbackCancel,!0,null,2,8),t?(x.a.oldActionsPipelineIsEnabled()&&a.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.dataPlumber.Feedback|=f.a.feedback_Submitted):(this.dataPlumber.Feedback|=f.a.feedback_Cancelled,this.doNPSTestAction()),this._eventSource.raiseEvent(e.onFeedbackUiDismissedEventId,new R(t)),e.allowKeytips(!0),this.onDismissedCallback&&(this.onDismissedCallback(),this.onDismissedCallback=null)},o.initializeFocus=function(){var t=this;if(this._focusManager){var n=!1,i=5,r=!1;this.clearInterval(Object(M.a)((function(){return t._checkMainContentHolderIntervalId}),(function(e){return t._checkMainContentHolderIntervalId=e}))),this.clearInterval(Object(M.a)((function(){return t._checkLikeButtonIntervalId}),(function(e){return t._checkLikeButtonIntervalId=e}))),this._checkLikeButtonIntervalId=window.setInterval((function(){if(t.likeButton){0,r=!0;var a=t._focusManager.getScope(e.customerFeedbackFocusId);if(a.keyDownHandledExternally=!0,a.parent=F.AFrame.mainAppFocusId,a.addDispose(e.customerFeedbackScopeDispose),a.addSetFocus((function(){var n=t._focusManager.getRegion(e.customerFeedbackFocusId),i=null,r=5,a=!1;t._checkMainContentHolderIntervalId=window.setInterval((function(){t.isElementVisible(t.mainContentHolder)&&(a=!0,t.likeButton.focus(),n||(n=t._focusManager.getRegion(e.customerFeedbackFocusId)),n&&!i&&(i=n.listing),i&&i.trySetCurrentElement(t.likeButton)),r--,!a&&r||t.clearInterval(Object(M.a)((function(){return t._checkMainContentHolderIntervalId}),(function(e){return t._checkMainContentHolderIntervalId=e})))}),1e3)})),n||(t._focusManager.pushScope(e.customerFeedbackFocusId,!0),n=!0),t._feedbackTabHandlerEnabled&&t.mainContentHolder){var o=new D.DOMFocusListing((function(){return t.mainContentHolder}));o.addValidTag(1),o.addValidTag(2),o.addValidTag(3),o.addValidTag(5);var s=t._focusManager.buildRegionWithDelegate((function(){return t.mainContentHolder}),t._focusManager.getScope(e.customerFeedbackFocusId),o);s.rememberFocusStealers(),s.looped=!0,s.contained=!0,s.moveIntoRestore()}}i--,!r&&i||t.clearInterval(Object(M.a)((function(){return t._checkLikeButtonIntervalId}),(function(e){return t._checkLikeButtonIntervalId=e})))}),1e3)}},o.clearInterval=function(t){t.val!==e.resetIntervalId&&(window.clearInterval(t.val),t.val=e.resetIntervalId)},o.removeFocus=function(){this._focusManager&&(this._focusManager.popScope(e.customerFeedbackFocusId),this._focusManager.removeScope(e.customerFeedbackFocusId))},e.allowKeytips=function(e){r.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&U.apiExists("allowKeytips")&&appChrome.api.allowKeytips(e)},e.determineOCVData=function(e,t){if(t){if(e.ringId=parseInt(t.Ring),isNaN(e.ringId))e.audienceGroup="Unknown",e.ringId=-2;else switch(e.ringId){case 0:case 1:e.audienceGroup="Dogfood";break;case 2:e.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:e.audienceGroup="Production";break;default:e.audienceGroup="Unknown"}var n=!0;t.Host&&(n="MsInternal"!==t.Host&&"Blue Chicken"!==t.Host),e.ocvEnvironment=n?0:1}},e.determineOCVFeedbackAppId=function(){var e=0;switch(B.Redirect.application){case 2:e=2155;break;case 4:e=2158;break;case 3:e=2157;break;case 1:e=2156;break;case 5:e=2159;break;default:a.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",B.Redirect.application.toString())}return e},e.determineOCVFeedbackAppColor=function(){var e={},t="#2B579A",n="#3C65A4";switch(B.Redirect.application){case 2:r.AFrameworkApplication.appSettingsManager&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")?(t="#185ABD",n="#2E6AC5"):(t="#2B579A",n="#3C65A4");break;case 4:t="#7719AA",n="#9953C0";break;case 3:t="#B7472A",n="#C75033";break;case 1:t="#217346",n="#3F8159";break;case 5:t="#3955A3",n="#4D6AB8";break;default:a.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",B.Redirect.application.toString())}return e.primaryColour=t,e.secondaryColour=n,e},e.determineUserVoiceUrls=function(){var e=null,t=null,n=null;switch(B.Redirect.application){case 2:e="https://word.uservoice.com/forums/271331-word-online",t="https://word.uservoice.com/tos",n="https://word.uservoice.com/tos#privacy-policy";break;case 4:e=" https://onenote.uservoice.com/forums/327183-onenote-online",t="https://onenote.uservoice.com/tos",n="https://onenote.uservoice.com/tos#privacy-policy";break;case 3:e="https://powerpoint.uservoice.com/forums/270149-powerpoint-online",t="https://powerpoint.uservoice.com/tos",n="https://powerpoint.uservoice.com/tos#privacy-policy";break;case 1:e="https://excel.uservoice.com/forums/274580-excel-online",t="https://excel.uservoice.com/tos",n="https://excel.uservoice.com/tos#privacy-policy";break;case 5:e="https://visio.uservoice.com/forums/368199-visio-online",t="https://visio.uservoice.com/tos",n="https://visio.uservoice.com/tos#privacy-policy";break;default:a.ULS.sendTraceTag(36718029,356,10,"Unexpected Application: {0}",B.Redirect.application.toString())}var i=null;return e&&t&&n&&((i={}).url=e,i.termsOfServiceUrl=t,i.privacyPolicyUrl=n),i},e.determineFeedbackUlsCategory=function(e){var t=356;switch(B.Redirect.application){case 2:switch(e){case"Edit":t=364;break;case"View":case"Attendee":case"Presenter":t=363;break;default:0,a.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",r.AFrameworkApplication.activeFrame.modeName),t=363}break;case 4:t=362;break;case 3:switch(e){case"Edit":t=361;break;case"View":case"Attendee":case"Presenter":case"Outline":case"":t=360;break;default:0,a.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",r.AFrameworkApplication.activeFrame.modeName),t=360}break;case 1:switch(e){case"Edit":t=358;break;case"View":t=357;break;case"Survey":t=359;break;default:0,a.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",r.AFrameworkApplication.activeFrame.modeName),t=357}break;case 5:switch(e){case"View":t=373;break;case"Edit":t=374;break;default:0,a.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",r.AFrameworkApplication.activeFrame.modeName),t=373}break;default:a.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",B.Redirect.application.toString())}return t},e.customerFeedbackScopeDispose=function(){a.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")},e.isNPSLocalizationTestingSession=function(){if(!e.npsLocalizationTestingSession){var t=!!r.AFrameworkApplication.appSettingsManager&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e.npsTestActivityFlightBRS);e.npsLocalizationTestingSession=t?2:1}return 2===e.npsLocalizationTestingSession},t=e,(n=[{key:"dataPlumber",get:function(){return this._dataPlumber||(r.AFrameworkApplication.dataPlumber||(r.AFrameworkApplication.dataPlumber=new g.a),this._dataPlumber=r.AFrameworkApplication.dataPlumber),this._dataPlumber},set:function(e){this._dataPlumber=e}},{key:"submitButton",get:function(){return this._submitButton||(this._submitButton=document.getElementById(this.submitButtonId))}},{key:"goToUserVoiceButton",get:function(){return this._gotoUserVoiceButton||(this._gotoUserVoiceButton=document.getElementById(this.goToUserVoiceButtonId))}},{key:"userVoiceFormContainer",get:function(){return this._userVoiceFormContainer||(this._userVoiceFormContainer=document.getElementById(this.userVoiceFormContainerId))}},{key:"likeButton",get:function(){return this._likeButton||(this._likeButton=document.getElementById(this.likeButtonId))}},{key:"commentBox",get:function(){return this._commentBox||(this._commentBox=document.getElementById(this.commentBoxId))}},{key:"suggestionButton",get:function(){return this._suggestionButton||(this._suggestionButton=document.getElementById(this.suggestionButtonId))}},{key:"userVoicePrivacyStatementLink",get:function(){return this._userVoicePrivacyStatementLink||(this._userVoicePrivacyStatementLink=document.getElementById(this.userVoicePrivacyStatementLinkId))}},{key:"contactFormContainer",get:function(){return this._contactFormContainer||(this._contactFormContainer=document.getElementById(this.contactFormContainerId))}},{key:"privacyStatementLink",get:function(){return this._privacyStatementLink||(this._privacyStatementLink=document.getElementById(this.privacyStatementLinkId))}},{key:"mainContentHolder",get:function(){return this._mainContentHolder||(this._mainContentHolder=document.getElementById(this.mainContentHolderId))}}])&&ae(t.prototype,n),i&&ae(t,i),e}();oe.customerFeedbackFocusId="CustomerFeedbackFocusId",oe.onFeedbackUiDismissedEventId="FUID",oe.resetIntervalId=-1,oe.npsLocalizationTestingSession=0,oe.npsTestActivityFlightBRS="NPSLocalizationTestingIsEnabled",Object(i.a)(oe,"CustomerFeedbackUiWrapper",null,[253]);var se=function(){function e(e,t,n,i){this._callbackWithString=e,this._activityName=t,this._callbackWithObject=n,this._obj=i}var t=e.prototype;return t.callBackWithString=function(){return this._callbackWithString},t.callBackWithObject=function(){return this._callbackWithObject},t.activityName=function(){return this._activityName},t.object=function(){return this._obj},e}();Object(i.a)(se,"OneCallBackData",null,[]);var le=function(){function e(e,t,n,i){this._callbacksData=[],Array.add(this._callbacksData,new se(e,t,n,i))}var t=e.prototype;return t.add=function(e){e&&Array.addRange(this._callbacksData,e._callbacksData)},t.getCallbacksData=function(){return this._callbacksData},t.clearCallbacksData=function(){Array.clear(this._callbacksData)},e}();Object(i.a)(le,"CallBackData",null,[]);var ce=function(e){var t,n;function i(t,n,i,r,a,o,s,l){var c;return void 0===i&&(i=null),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===s&&(s=null),void 0===l&&(l=null),(c=e.call(this,"FloodgateTeachingCallout")||this).title=null,c.smallHeadline=null,c.message=null,c.footer=null,c.image=null,c.positionImageAtLeft=!1,c.primaryButtonProps=null,c.secondaryButtonProps=null,c.footer=t,c.message=n,c.image=i,c.positionImageAtLeft=r,c.smallHeadline=a,c.title=o,c.primaryButtonProps=s,c.secondaryButtonProps=l,c}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(Y);Object(i.a)(ce,"FloodgateCalloutContent",Y,[]);var ue=function(){this.options=null,this.props=null};Object(i.a)(ue,"Notification",null,[]);var de=function(){this.label=null,this.onExecute=null,this.ariaDescription=null};Object(i.a)(de,"CalloutButtonProps",null,[]);var pe=function(e){this.src=null,this.ariaLabel=null,this.alt=null,this.src=e};Object(i.a)(pe,"ImageProps",null,[]);var he=function(){function e(){}return e.convertAndShowTeachingUx=function(t){return e.getReactFloodgateNotificationsEnabled().then((function(n){try{for(var i=new Array(0),r=0;r<t.length;r++){var a=t[r],o=e.isSupportedSurface(a.surfaceType),s=new ue;s.options=e.getNotificationOptions(a,!o),s.props=o?n.callout(e.makeOneCallout(t[r])):n.externalNotification(),i.push(s)}return e.showFloodgateTeachingUx(n,i)}catch(e){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+e.message)}}))},e.isSupportedSurface=function(e){switch(e){case"teaching":case"coachmark":case"sequence":return!0;default:return!1}},e.getNotificationOptions=function(e,t){var n=new q.a;return t&&(n.onShow=e.onUnsupportedSurfaceType),n.telemetryId="FloodgateTeachingUx-Surface"+(t?"NotSupported":"Supported"),n},e.makeOneCallout=function(t){var n=new ce(t.footer,t.description,t.illustrationImage?Object.assign(new pe(t.illustrationImage),{ariaLabel:t.imageAriaLabel}):null,"left"===t.position,t.smallHeadline,t.title,e.getCalloutButton(t.primaryButtonText,t.primaryButtonAction),e.getCalloutButton(t.secondaryButtonText,t.secondaryButtonAction)),i=Object.assign(new K.a,{target:t.selector,content:n,showCloseIcon:!0,useTeachingStyles:!0,calloutProps:Object.assign(new $.a,{onDismiss:function(){t.onClosed&&t.onClosed("close")},directionalHint:t.anchorHint})});return"coachmark"===t.surfaceType&&(i.hasDynamicSizing=!1,i.useCoachmark=!0),i},e.getCalloutButton=function(e,t){return e&&""!==e&&t?Object.assign(new de,{label:e,onExecute:t}):(a.ULS.shipAssertTag(594569111,356,!(e&&""!==e||t),"A callout button needs both a caption and an action."),null)},e.getReactFloodgateNotificationsEnabled=function(){return e.floodgateUxEnabledPromise||(r.AFrameworkApplication.activeFrame.applicationInstance.isReactNotificationsEnabled&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacFloodgateNotificationsIntegrationIsEnabled")?e.floodgateUxEnabledPromise=X.UISurfaces.getNotificationsAPIAsync().then((function(e){var t=new ce(null,null);if(e.isCustomContentSupported&&e.isCustomContentSupported(t))return e;throw Error.create("Custom Content not supported: "+t.type)}),(function(e){return a.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",e),null})):e.floodgateUxEnabledPromise=Promise.reject("React Notifications not enabled")),e.floodgateUxEnabledPromise},e.showFloodgateTeachingUx=function(t,n){if(!n||!n.length)return new Array(0);for(var i=new Array(0),r=0;r<n.length;r++){var a=n[r],o=e.showOneNotification(t,a);i.push(o)}return i},e.showOneNotification=function(e,t){var n=e.addNotification(t.props,t.options);return function(){e.removeNotification(n)}},e}();he.floodgateUxEnabledPromise=null,Object(i.a)(he,"FloodgateNotifications",null,[]);var me=function(e,t){var n=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName");return!!t.ocvData&&2===t.ocvData.ringId&&ge(n)},ge=function(e){return!!(e=e.toLowerCase())&&(e.indexOf("linkedin.com")>0||e.indexOf("linkedin.biz")>0)},fe=function(e,t){this.ocvData=e,this.context=t};Object(i.a)(fe,"SurveyMetadata",null,[]);var ve=n(4),_e=n(17),ye=n(10),be=n(205),Se=n(186);function Ce(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ae(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var we=function(){function e(e){this.isInitialized=!1,this.isError=!1,this._appSpecificFeedbackData=null,this.currentLocaleLowerCase=null,this.useCustomizedAppFloodgateStartStop=!1,this.surveyMetadata=null,this.isEventListenerAdded=!1,this.deferredActivityTimeoutId=0,this.postDownloadJsInitPromise=null,this.haveAccessToLocalStorage=!0,this.customerFeedbackUiWrapperObject=e,this.timeBasedSurveyActivityNames={},this.attemptedGettingCurrentLocale=!1,this.floodgateUIStringMap=null,this.restrictedSurveyActivityMap=null,this.floodgateEnabledInEnvironment=0}var t,n,i,o=e.prototype;return o.initializeWACAppParameters=function(e){if(this.isInitialized&&this._appSpecificFeedbackData||this.isError)return a.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."),!1;if(null===e)return a.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"),!1;this.useCustomizedAppFloodgateStartStop=e.useCustomizedAppFloodgateStartStop;var t=e.getAppSpecificFeedbackData();return null===t?(a.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"),!1):this._appSpecificFeedbackData?(a.ULS.sendTraceTag(595142227,356,10,"SIFB: _appSpecificFeedbackData was already set. Not setting it again"),!1):(this._appSpecificFeedbackData=t,a.ULS.sendTraceTag(595142226,356,50,"SIFB: _appSpecificFeedbackData successfully set via call to InitializeWACAppParameters"),!0)},o.initializeSurveyRestrictions=function(){var e=this.customerFeedbackUiWrapperObject.getContext(null),t=new P;oe.determineOCVData(t,e),this.surveyMetadata=new fe(t,e),this.restrictedSurveyActivityMap=new be.a(Se.a.get_ordinal()),this.restrictedSurveyActivityMap.set_item("LinkedInWACUsage",me)},o.logActivity=function(t,n){t&&this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(this.isInitialized?(a.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+t),ie.logActivity(t)):(a.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+t),this.initializeFloodgateThenDoAction(new le(ie.logActivity,t,null,null))))},o.logActivityDeferred=function(t,n){var i=this;this.isInitialized?(this.deferredActivityTimeoutId>0&&(window.clearTimeout(this.deferredActivityTimeoutId),a.ULS.sendTraceTag(592217693,356,15,"SIFB: LogActivityDeferred cancelled "+t)),this.deferredActivityTimeoutId=window.setTimeout((function(){i.deferredActivityTimeoutId=0,i.logActivity(t,n)}),e.defaultDeferredActivityDelayInMilliSeconds)):a.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+t)},o.logActivityStart=function(t,n){t&&this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(this.logActivityStartInternal(t,n),this.timeBasedSurveyActivityNames[t]=n)},o.logActivityStartInternal=function(t,n){this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(this.isInitialized?(a.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+t),ie.logActivityStart(t)):(a.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+t),this.initializeFloodgateThenDoAction(new le(ie.logActivityStart,t,null,null))))},o.logActivityEnd=function(t,n){t&&this.isInitialized&&this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(t in this.timeBasedSurveyActivityNames&&delete this.timeBasedSurveyActivityNames[t],this.logActivityEndInternal(t,n))},o.logActivityEndInternal=function(t,n){this.isInitialized&&this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(a.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+t),ie.logActivityEnd(t))},o.showUserInitiatedSurvey=function(t,n){if(this.floodgateEnabled(t,e.mainSIFBBrs,n)){var i=this.appSpecificFeedbackData.getUserInitiatedSurvey(t);i&&(this.isInitialized?(a.ULS.sendTraceTag(38605911,356,50,"SIFB:ShowUserInitiatedSurvey "+t),ie.showUserInitiatedSurvey(i)):(a.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+t),this.initializeFloodgateThenDoAction(new le(null,null,ie.showUserInitiatedSurvey,i))))}},o.floodgateEnabled=function(e,t,n){return!this.isError&&(r.AFrameworkApplication.showFeedbackButton?!!this.isFloodgateEnabledInEnvironment()&&(this.createAppSpecificFeedbackDataIfRequired(),(this.isDynamicWebCampaignActivity(e)||this.currentLanguageEnabled(e))&&this.brSesEnabled(t,n)&&this.surveyRestrictionsSatisfied(e)):(a.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1))},o.createAppSpecificFeedbackDataIfRequired=function(){try{this._appSpecificFeedbackData||(this._appSpecificFeedbackData=_.a.instance.resolve("Common.App.IAppSpecificFeedbackData"))}catch(e){a.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData creation "+e)}return this._appSpecificFeedbackData},o.isFloodgateEnabledInRing=function(e){return 6!==e},o.isFloodgateEnabledInEnvironment=function(){if(0===this.floodgateEnabledInEnvironment){var e=this.customerFeedbackUiWrapperObject.getContext(null);this.floodgateEnabledInEnvironment=this.isFloodgateEnabledInRing(parseInt(e.Ring))?1:2,2===this.floodgateEnabledInEnvironment&&a.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.floodgateEnabledInEnvironment},o.surveyRestrictionsSatisfied=function(e){return null===this.restrictedSurveyActivityMap&&this.initializeSurveyRestrictions(),!(e&&this.restrictedSurveyActivityMap&&this.restrictedSurveyActivityMap.containsKey(e))||this.restrictedSurveyActivityMap.get_item(e)(e,this.surveyMetadata)},o.getCurrentLocaleLowerCase=function(){if(!this.currentLocaleLowerCase&&!this.attemptedGettingCurrentLocale){this.attemptedGettingCurrentLocale=!0;var e=this.customerFeedbackUiWrapperObject.getContext(null);this.currentLocaleLowerCase="locale"in e?e.locale:"",this.currentLocaleLowerCase=this.currentLocaleLowerCase.toLowerCase()}return this.currentLocaleLowerCase},o.currentLanguageEnabled=function(e){if(this.currentLocaleLowerCase||(this.currentLocaleLowerCase=this.getCurrentLocaleLowerCase()),!(this.currentLocaleLowerCase&&this.currentLocaleLowerCase.length&&e&&e.length))return!1;var t="en-us"===this.currentLocaleLowerCase||oe.isNPSLocalizationTestingSession();return!t&&this.isNPSActivity(e)&&(t=this.isNPSSupportedLanguage(this.currentLocaleLowerCase)),t},o.isNPSActivity=function(t){return t===e.appUsageNPSOneClick||t===e.appUsageNPSOneClickTimeSatisfied||(this.appSpecificFeedbackData?t===this.appSpecificFeedbackData.getNPSUsageActivityName()||t===this.appSpecificFeedbackData.getNPSFollowupActivityName():(a.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+t),!1))},o.isDynamicWebCampaignActivity=function(e){return!!e&&-1!==e.toLowerCase().indexOf("floodgateflight")},o.isNPSSupportedLanguage=function(e){if(!e||!e.length)return!1;if(!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacNPSLocalizedLanguagesEnabled"))return"en-us"===e;var t=!1;switch(e){case"en-us":case"es-es":case"ja-jp":case"en-gb":case"pt-br":case"nl-nl":case"de-de":case"fr-fr":case"sv-se":case"fi-fi":case"nb-no":case"da-dk":case"ru-ru":case"es-mx":case"pl-pl":case"zh-cn":case"zh-tw":case"it-it":case"ko-kr":t=!0}return t},o.brSesEnabled=function(e,t){return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e)?!(t&&!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(t))||(a.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+t+") is off"),!1):(a.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+e+") is off"),!1)},o.initializeFloodgateThenDoAction=function(e){var t=this;if(r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAdminControlsIsEnabled"))r.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){try{t.downloadResources(e)}catch(e){a.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+e)}}));else try{this.downloadResources(e)}catch(e){a.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+e)}},o.trySetCampaignTriggerData=function(e,t){var n=this.getLocalStorage();if(n)try{n.setItem(this.constructKey(e),t)}catch(e){}else a.ULS.sendTraceTag(36546387,356,10,"SIFB.Error:Trigger data !set, Storage.Local null");return!!n},o.getCampaignTriggerData=function(e){var t=this.getLocalStorage();if(t)try{return t.getItem(this.constructKey(e))}catch(e){}return null},o.removeCampaignTriggerData=function(e){var t=this.getLocalStorage();if(t)try{t.removeItem(this.constructKey(e))}catch(e){}},o.onWindowFocus=function(e){this.useCustomizedAppFloodgateStartStop||this.start()},o.onWindowBlur=function(e){this.useCustomizedAppFloodgateStartStop||this.stop()},o.startFloodgate=function(){this.useCustomizedAppFloodgateStartStop&&this.start()},o.stopFloodgate=function(){this.useCustomizedAppFloodgateStartStop&&this.stop()},o.start=function(){a.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized),this.isInitialized&&(ie.floodgateStart(),this.timeBasedSurveysStart())},o.stop=function(){a.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized),this.isInitialized&&(this.timeBasedSurveysEnd(),ie.floodgateStop())},o.timeBasedSurveysStart=function(){var e=this.timeBasedSurveyActivityNames;for(var t in e){var n={key:t,value:e[t]};this.logActivityStartInternal(n.key,n.value)}},o.timeBasedSurveysEnd=function(){var e=this.timeBasedSurveyActivityNames;for(var t in e){var n={key:t,value:e[t]};this.logActivityEndInternal(n.key,n.value)}},o.constructKey=function(e){return B.Redirect.application.toString()+e},o.downloadResources=function(e){a.ULS.sendTraceTag(36546388,356,100,"SIFB: Entered DownloadResources");var t=_.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");if(t)if(t.getJSDownloaded())this.floodgateJsDownloadFinished(!0,e);else{var n=_.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");n.setCallerData(e),n.downloadJsResource(Object(h.d)(this,this.floodgateJsDownloadFinished,"floodgateJsDownloadFinished"))}},o.floodgateJsDownloadFinished=function(e,t){var n=this;a.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+e);var i="";if(t&&t.getCallbacksData()&&t.getCallbacksData().length>0&&(i=t.getCallbacksData()[0].activityName()),e)if(s()){if(this.isInitialized)return void this.doPostInitializationWork(t);!this.isError&&this.postDownloadJsInitPromise||(this.postDownloadJsInitPromise=this.postDownloadJsInit()),this.postDownloadJsInitPromise.then((function(){n.doPostInitializationWork(t)})).catch((function(e){return n.postDownloadJsInitFailure(i,e)}))}else this.postDownloadJsInit().then((function(){n.doPostInitializationWork(t)})).catch((function(e){return n.postDownloadJsInitFailure(i,e)}));else this.isError=!0,a.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+i)},o.postDownloadJsInitFailure=function(e,t){this.isError=!0,a.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+e+". "+t.toString())},o.floodgateUIStringGetter=function(e){this.floodgateUIStringMap||this.initializeUIStringGetter();var t=e;return e&&e.length>0&&(t=this.floodgateUIStringMap&&this.floodgateUIStringMap.containsKey(e)?this.floodgateUIStringMap.get_item(e):e),t||""},o.postDownloadJsInit=function(){var t=this,n=_.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");if(n&&n.jsDownloaded(!0),this.setupCampaigns(),this.setWindowEvents(),this.initOptions(),r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAdminControlsIsEnabled")&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost")&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled"))return e.delayCustomMs(this.getInitDelayTimeInMs()).then((function(e){var n=t.getAllContextForFloodgate();return t.logFloodgateInitState(n),n})).then((function(e){return ie.initSIFeedback(Object(h.d)(t,t.onSIFeedbackDismiss,"onSIFeedbackDismiss"),Object(h.d)(t.customerFeedbackUiWrapperObject,t.customerFeedbackUiWrapperObject.onError,"onError"),e,Object(h.d)(t.customerFeedbackUiWrapperObject,t.customerFeedbackUiWrapperObject.onDismiss,"onDismiss"))}));var i=this.getAllContextForFloodgate();return this.logFloodgateInitState(i),ie.initSIFeedback(Object(h.d)(this,this.onSIFeedbackDismiss,"onSIFeedbackDismiss"),Object(h.d)(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onError,"onError"),i,Object(h.d)(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onDismiss,"onDismiss"))},o.getAllContextForFloodgate=function(){var t=this.customerFeedbackUiWrapperObject.getContext(null);return t.FloodgateUIAutoDismissTimeEnum=this.getAutoDismissTimeEnum(),t.uIStringGetter=Object(h.d)(this,this.floodgateUIStringGetter,"floodgateUIStringGetter"),t.authTokenCallback=e.createAuthTokenHandler(Object(m.a)(String,t.AudienceGroup)),t.augLoopCallback=e.createAugLoopHandler(),t.onTeachingCampaignRender=he.convertAndShowTeachingUx,t},o.logFloodgateInitState=function(e){var t=this.customerFeedbackUiWrapperObject.areFeedbackOCPSPoliciesSet(),n=this.getInitDelayTimeInMs(),i=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAdminControlsIsEnabled"),o=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost"),s=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"),l=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled"),c="surveyEnabled"in e?e.surveyEnabled:"null or undefined",u="showEmailAddress"in e?e.showEmailAddress:"null or undefined";a.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}"',t,i,o,s,l,n,u,c)},o.getAutoDismissTimeEnum=function(){if(r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateOverrideDefaultAutoDismissEnumIsEnabled")){var e=0;return me(0,this.surveyMetadata)?(a.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:{0}",e),e):(r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateNoAutoDismissIsEnabled")||(e=4),a.ULS.sendTraceTag(590407907,356,50,"SIFB Info:Floodgate AutoDismissTimeEnum:{0}",e),e)}return r.AFrameworkApplication.appSettingsManager.getIntAppSetting("FloodgateUIAutoDismissTimeEnum",2)},o.getInitDelayTimeInMs=function(){return r.AFrameworkApplication.appSettingsManager.getIntAppSetting("FloodgateContextAndInitDelayInMilliSeconds",e.defaultPostDownloadJsInitDelayInMilliSeconds)},o.doPostInitializationWork=function(e){if(this.isInitialized=!0,this.addWebCampaignUIEventListener(),e){for(var t,n=Ce(e.getCallbacksData());!(t=n()).done;){var i=t.value;i.callBackWithString()?i.callBackWithString()(i.activityName()):i.callBackWithObject()?i.callBackWithObject()(i.object()):a.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null")}e.clearCallbacksData()}else a.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{var r=this.customerFeedbackUiWrapperObject.getContext(null),o=ie.getFloodgateFlightParameters(Array.isArray(r.Flights)?r.Flights:null),s=o?Object(m.a)(String,o.SelfTriggerActivity):null;if(s)for(var l,c=Ce(s.split(";"));!(l=c()).done;){var u=l.value;u&&""!==u&&this.logActivity(u,null)}}catch(e){a.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+(e?e.toString():""))}},o.addWebCampaignUIEventListener=function(){if(!this.isEventListenerAdded&&window.addEventListener){var e=Object(h.d)(this,this.onWebCampaignEvent,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",e,!0),this.isEventListenerAdded=!0}},o.onWebCampaignEvent=function(e){var t=e?e.detail:null;if(t){var n=(t.action||"").toLowerCase();switch(n){case"dismissed":H.F6Manager.instance.deactivateFocus("obf-DynamicWebSurfaces");break;case"updated":ie.addFocusScope("obf-DynamicWebSurfaces");break;case"opened":case"":var i,o=t.telemetryEventName;try{i=JSON.stringify(t)}catch(e){i="id : "+t.id+" telemetryEventName: "+o,a.ULS.sendTraceTag(51131789,341,50,"Error serializing campaign event. "+i+" Error: "+(e?e.toString():""))}t.success?(o&&r.AFrameworkApplication.logUniqueFlightedSettingUsage(o),a.ULS.sendTraceTag(50704975,341,50,"Web Campaign UI launched. "+i)):a.ULS.sendTraceTag(50422098,341,10,"Error launching Web Campaign UI."+i),t.isHidden||t.isAA||ie.addFocusScope("obf-DynamicWebSurfaces");break;default:a.ULS.sendTraceTag(594626399,341,50,"Unrecognized action "+n)}}},o.setupCampaigns=function(){var t=!1,n=null,i=this.getLocalStorage();if(i)try{var r=this.appSpecificFeedbackData.getCampaignDefinitions();r?(i.setItem(e.campaignDefinitionKey,r),t=!0):(n="SIFB.campaign str was null",a.ULS.sendTraceTag(594143442,356,10,n))}catch(e){n="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+e,a.ULS.sendTraceTag(594143441,356,50,n)}else n="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",a.ULS.sendTraceTag(594143440,356,50,n);return a.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+t+" errorString: "+(n||"null")),t},o.onSIFeedbackDismiss=function(e,t){x.a.oldActionsPipelineIsEnabled()&&a.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",t,e),x.a.isUserActionLoggingToOtelEnabled()&&O.c(t?b.a.userSurveySubmit:b.a.userSurveyCancel,!0,null,2,8),H.F6Manager.instance.deactivateFocus(ie.floodgateContainerID)},o.initOptions=function(){},o.setWindowEvents=function(){this.useCustomizedAppFloodgateStartStop||(_e.a.addHandler(window.self,ve.EventNames.focus,Object(h.d)(this,this.onWindowFocus,"onWindowFocus")),_e.a.addHandler(window.self,ve.EventNames.blur,Object(h.d)(this,this.onWindowBlur,"onWindowBlur")))},o.getLocalStorage=function(){if(!this.haveAccessToLocalStorage)return null;var e=null;try{e=localStorage}catch(t){this.haveAccessToLocalStorage=!1,e=null,a.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+(t?t.toString():""))}return e},o.initializeUIStringGetter=function(){a.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.floodgateUIStringMap=new be.a(Se.a.get_ordinalIgnoreCase()),this.floodgateUIStringMap.set_item("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.floodgateUIStringMap.set_item("nps_PromptQuestion",CommonUIStrings.l_WAC_NPS_PromptQuestion),this.floodgateUIStringMap.set_item("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Word",e.get_Nps_RatingQuestion_Word()),this.floodgateUIStringMap.set_item("nps_RatingQuestion_OneNote",e.get_Nps_RatingQuestion_OneNote()),this.floodgateUIStringMap.set_item("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.floodgateUIStringMap.set_item("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.floodgateUIStringMap.set_item("nps_OneClickRatingQuestion_Excel",e.get_Nps_RatingQuestion_Excel()),this.floodgateUIStringMap.set_item("nps_OneClickRatingQuestion_PowerPoint",e.get_Nps_RatingQuestion_PowerPoint()),this.floodgateUIStringMap.set_item("nps_RatingQuestion_PowerPoint",e.get_Nps_RatingQuestion_PowerPoint()),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Excel",e.get_Nps_RatingQuestion_Excel()),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.floodgateUIStringMap.set_item("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.floodgateUIStringMap.set_item("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.floodgateUIStringMap.set_item("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.floodgateUIStringMap.set_item("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.floodgateUIStringMap.set_item("nps_Rating_Values_5",CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.floodgateUIStringMap.set_item("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.floodgateUIStringMap.set_item("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.floodgateUIStringMap.set_item("nps_OneClickRatingQuestion_Word",e.get_Nps_RatingQuestion_Word()),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.floodgateUIStringMap.set_item("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.floodgateUIStringMap.set_item("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.floodgateUIStringMap.set_item("AtMentionFS_PromptTitle",CommonUIStrings.l_WAC_AtMentionFS_PromptTitle),this.floodgateUIStringMap.set_item("AtMentionFS_PromptQuestion",CommonUIStrings.l_WAC_AtMentionFS_PromptQuestion),this.floodgateUIStringMap.set_item("AtMentionFS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFS_RatingQuestion),this.floodgateUIStringMap.set_item("AtMentionFS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("AtMentionFS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_3",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.floodgateUIStringMap.set_item("AtMentionFS_Question",CommonUIStrings.l_WAC_GenericSurvey_WhyQuestion),this.floodgateUIStringMap.set_item("SearchFPS_Title",CommonUIStrings.l_OneNote_Search_FPS_Title),this.floodgateUIStringMap.set_item("SearchFPS_PromptQuestion",CommonUIStrings.l_OneNote_Search_FPS_PromptQuestion),this.floodgateUIStringMap.set_item("SearchFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("SearchFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("SearchFPS_RatingQuestion",CommonUIStrings.l_OneNote_Search_FPS_RatingQuestion),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_1",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_1),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_2",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_2),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_3",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_3),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_4",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_4),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_5",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_5),this.floodgateUIStringMap.set_item("SearchFPS_WhyQuestion",CommonUIStrings.l_OneNote_Search_FPS_WhyQuestion),this.floodgateUIStringMap.set_item("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.floodgateUIStringMap.set_item("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),this.floodgateUIStringMap.set_item("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.floodgateUIStringMap.set_item("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.floodgateUIStringMap.set_item("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.floodgateUIStringMap.set_item("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.floodgateUIStringMap.set_item("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.floodgateUIStringMap.set_item("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.floodgateUIStringMap.set_item("NSV_Prompt_Title_Feedback",CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.floodgateUIStringMap.set_item("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.floodgateUIStringMap.set_item("NSVFreeformDidntCreateSheetView",CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.floodgateUIStringMap.set_item("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.floodgateUIStringMap.set_item("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.floodgateUIStringMap.set_item("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.floodgateUIStringMap.set_item("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.floodgateUIStringMap.set_item("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.floodgateUIStringMap.set_item("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.floodgateUIStringMap.set_item("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.floodgateUIStringMap.set_item("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.floodgateUIStringMap.set_item("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.floodgateUIStringMap.set_item("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),this.floodgateUIStringMap.set_item("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.floodgateUIStringMap.set_item("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_PromptTitle",CommonUIStrings.l_WAC_CoauthLatencySurvey_PromptTitle),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_PromptQuestion",CommonUIStrings.l_WAC_CoauthLatencySurvey_PromptQuestion),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_RatingQuestion",CommonUIStrings.l_WAC_CoauthLatencySurvey_RatingQuestion),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_Rating_Values_1",CommonUIStrings.l_WAC_CoauthLatencySurvey_Rating_Values_1),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_Rating_Values_2",CommonUIStrings.l_WAC_CoauthLatencySurvey_Rating_Values_2),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_Rating_Values_3",CommonUIStrings.l_WAC_CoauthLatencySurvey_Rating_Values_3),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_Rating_Values_4",CommonUIStrings.l_WAC_CoauthLatencySurvey_Rating_Values_4),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_QuestionQuestion",CommonUIStrings.l_WAC_CoauthLatencySurvey_QuestionQuestion),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.floodgateUIStringMap.set_item("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.floodgateUIStringMap.set_item("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.floodgateUIStringMap.set_item("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.floodgateUIStringMap.set_item("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.floodgateUIStringMap.set_item("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),this.floodgateUIStringMap.set_item("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.floodgateUIStringMap.set_item("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.floodgateUIStringMap.set_item("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.floodgateUIStringMap.set_item("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.floodgateUIStringMap.set_item("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.floodgateUIStringMap.set_item("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),this.floodgateUIStringMap.set_item("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.floodgateUIStringMap.set_item("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_RatingQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_RatingValue_5",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.floodgateUIStringMap.set_item("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.floodgateUIStringMap.set_item("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.floodgateUIStringMap.set_item("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),this.floodgateUIStringMap.set_item("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.floodgateUIStringMap.set_item("DictationV2_GreetingAnswer_Notnow",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.floodgateUIStringMap.set_item("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_4",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.floodgateUIStringMap.set_item("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_4",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.floodgateUIStringMap.set_item("CellStyles_Prompt",CommonUIStrings.l_Excel_CellStyles_Prompt),this.floodgateUIStringMap.set_item("CellStyles_Overview_Question",CommonUIStrings.l_Excel_CellStyles_Overview_Question),this.floodgateUIStringMap.set_item("CellStyles_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("CellStyles_PromptLabel_No",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("CellStyles_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.floodgateUIStringMap.set_item("CellStyles_Rating_1_Useful",CommonUIStrings.l_Excel_Rating_1_Useful),this.floodgateUIStringMap.set_item("CellStyles_Rating_2_Useful",CommonUIStrings.l_Excel_Rating_2_Useful),this.floodgateUIStringMap.set_item("CellStyles_Rating_3_Useful",CommonUIStrings.l_Excel_Rating_3_Useful),this.floodgateUIStringMap.set_item("CellStyles_Rating_4_Useful",CommonUIStrings.l_Excel_Rating_4_Useful),this.floodgateUIStringMap.set_item("CellStyles_Rating_5_Useful",CommonUIStrings.l_Excel_Rating_5_Useful),this.floodgateUIStringMap.set_item("CellStyles_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyQuestion),this.floodgateUIStringMap.set_item("ExcelIdeas_Prompt",CommonUIStrings.l_Excel_Ideas_Prompt),this.floodgateUIStringMap.set_item("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.floodgateUIStringMap.set_item("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_3_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_4_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_Question",CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_ExpectationsQuestion",CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.floodgateUIStringMap.set_item("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.floodgateUIStringMap.set_item("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.floodgateUIStringMap.set_item("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.floodgateUIStringMap.set_item("TextPredictions_FloodgatePromptTitle",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.floodgateUIStringMap.set_item("TextPredictions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.floodgateUIStringMap.set_item("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.floodgateUIStringMap.set_item("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.floodgateUIStringMap.set_item("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.floodgateUIStringMap.set_item("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),this.floodgateUIStringMap.set_item("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),this.floodgateUIStringMap.set_item("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.floodgateUIStringMap.set_item("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.floodgateUIStringMap.set_item("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.floodgateUIStringMap.set_item("ExternalContent_FloodgateRating_1",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.floodgateUIStringMap.set_item("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),this.floodgateUIStringMap.set_item("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.floodgateUIStringMap.set_item("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.floodgateUIStringMap.set_item("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.floodgateUIStringMap.set_item("ExternalContent_FloodgateQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.floodgateUIStringMap.set_item("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),this.floodgateUIStringMap.set_item("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.floodgateUIStringMap.set_item("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.floodgateUIStringMap.set_item("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.floodgateUIStringMap.set_item("Translator_RatingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.floodgateUIStringMap.set_item("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),this.floodgateUIStringMap.set_item("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.floodgateUIStringMap.set_item("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.floodgateUIStringMap.set_item("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.floodgateUIStringMap.set_item("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),this.floodgateUIStringMap.set_item("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.floodgateUIStringMap.set_item("TeamsOpen_GreetingQuestion",CommonUIStrings.l_WAC_NPS_Title),this.floodgateUIStringMap.set_item("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.floodgateUIStringMap.set_item("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),this.floodgateUIStringMap.set_item("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.floodgateUIStringMap.set_item("TeamsOpen_RatingQuestion_PowerPoint",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.floodgateUIStringMap.set_item("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.floodgateUIStringMap.set_item("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.floodgateUIStringMap.set_item("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.floodgateUIStringMap.set_item("LinkedIn_Title",CommonUIStrings.l_LinkedIn_Title),this.floodgateUIStringMap.set_item("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.floodgateUIStringMap.set_item("LinkedIn_QuestionQuestion",CommonUIStrings.l_LinkedIn_QuestionQuestion),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.floodgateUIStringMap.set_item("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),this.floodgateUIStringMap.set_item("UIHost_Title",CommonUIStrings.l_WAC_UIHost_PromptTitle),this.floodgateUIStringMap.set_item("UIHost_PromptQuestion",CommonUIStrings.l_WAC_UIHost_PromptQuestion),this.floodgateUIStringMap.set_item("UIHost_Sure",CommonUIStrings.l_WAC_UIHost_Sure),this.floodgateUIStringMap.set_item("UIHost_NotNow",CommonUIStrings.l_WAC_UIHost_NotNow),this.floodgateUIStringMap.set_item("UIHost_RatingQuestion",CommonUIStrings.l_WAC_UIHost_RatingQuestion),this.floodgateUIStringMap.set_item("UIHost_Rating_Values_1",CommonUIStrings.l_WAC_UIHost_RatingValue_1),this.floodgateUIStringMap.set_item("UIHost_Rating_Values_2",CommonUIStrings.l_WAC_UIHost_RatingValue_2),this.floodgateUIStringMap.set_item("UIHost_Rating_Values_3",CommonUIStrings.l_WAC_UIHost_RatingValue_3),this.floodgateUIStringMap.set_item("UIHost_Rating_Values_4",CommonUIStrings.l_WAC_UIHost_RatingValue_4),this.floodgateUIStringMap.set_item("UIHost_Rating_Values_5",CommonUIStrings.l_WAC_UIHost_RatingValue_5),this.floodgateUIStringMap.set_item("UIHost_WhyQuestion",CommonUIStrings.l_WAC_UIHost_WhyQuestion),this.floodgateUIStringMap.set_item("UIHostOfficeCom_Title",CommonUIStrings.l_WAC_UIHostOfficeCom_PromptTitle),this.floodgateUIStringMap.set_item("UIHostOfficeCom_PromptQuestion",CommonUIStrings.l_WAC_UIHostOfficeCom_PromptQuestion),this.floodgateUIStringMap.set_item("UIHostOfficeCom_Sure",CommonUIStrings.l_WAC_UIHostOfficeCom_Sure),this.floodgateUIStringMap.set_item("UIHostOfficeCom_NotNow",CommonUIStrings.l_WAC_UIHostOfficeCom_NotNow),this.floodgateUIStringMap.set_item("UIHostOfficeCom_RatingQuestion",CommonUIStrings.l_WAC_UIHostOfficeCom_RatingQuestion),this.floodgateUIStringMap.set_item("UIHostOfficeCom_Rating_Values_1",CommonUIStrings.l_WAC_UIHostOfficeCom_RatingValue_1),this.floodgateUIStringMap.set_item("UIHostOfficeCom_Rating_Values_2",CommonUIStrings.l_WAC_UIHostOfficeCom_RatingValue_2),this.floodgateUIStringMap.set_item("UIHostOfficeCom_Rating_Values_3",CommonUIStrings.l_WAC_UIHostOfficeCom_RatingValue_3),this.floodgateUIStringMap.set_item("UIHostOfficeCom_Rating_Values_4",CommonUIStrings.l_WAC_UIHostOfficeCom_RatingValue_4),this.floodgateUIStringMap.set_item("UIHostOfficeCom_Rating_Values_5",CommonUIStrings.l_WAC_UIHostOfficeCom_RatingValue_5),this.floodgateUIStringMap.set_item("UIHostOfficeCom_WhyQuestion",CommonUIStrings.l_WAC_UIHostOfficeCom_WhyQuestion),this.floodgateUIStringMap.set_item("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.floodgateUIStringMap.set_item("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.floodgateUIStringMap.set_item("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.floodgateUIStringMap.set_item("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.floodgateUIStringMap.set_item("VHRestore_SurveyQuestion",CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.floodgateUIStringMap.set_item("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.floodgateUIStringMap.set_item("VHRestore_Answer_Options_2",CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.floodgateUIStringMap.set_item("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.floodgateUIStringMap.set_item("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.floodgateUIStringMap.set_item("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.floodgateUIStringMap.set_item("TableBorder_FloodgatePromptTitle",CommonUIStrings.l_WAC_TableBorder_FloodgatePromptTitle),this.floodgateUIStringMap.set_item("TableBorder_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TableBorder_FloodgatePromptQuestion),this.floodgateUIStringMap.set_item("TableBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TableBorder_FloodgatePrompt_YesLabel),this.floodgateUIStringMap.set_item("TableBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TableBorder_FloodgatePrompt_NoLabel),this.floodgateUIStringMap.set_item("TableBorder_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TableBorder_FloodgateRatingQuestion),this.floodgateUIStringMap.set_item("TableBorder_FloodgateRating_1",CommonUIStrings.l_WAC_TableBorder_FloodgateRating_1),this.floodgateUIStringMap.set_item("TableBorder_FloodgateRating_2",CommonUIStrings.l_WAC_TableBorder_FloodgateRating_2),this.floodgateUIStringMap.set_item("TableBorder_FloodgateRating_3",CommonUIStrings.l_WAC_TableBorder_FloodgateRating_3),this.floodgateUIStringMap.set_item("TableBorder_FloodgateRating_4",CommonUIStrings.l_WAC_TableBorder_FloodgateRating_4),this.floodgateUIStringMap.set_item("TableBorder_FloodgateRating_5",CommonUIStrings.l_WAC_TableBorder_FloodgateRating_5),this.floodgateUIStringMap.set_item("TableBorder_FloodgateQuestion",CommonUIStrings.l_WAC_TableBorder_FloodgateQuestion),this.floodgateUIStringMap.set_item("TOC_FloodgatePromptTitle",CommonUIStrings.l_WAC_TOC_FloodgatePromptTitle),this.floodgateUIStringMap.set_item("TOC_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TOC_FloodgatePromptQuestion),this.floodgateUIStringMap.set_item("TOC_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TOC_FloodgatePrompt_YesLabel),this.floodgateUIStringMap.set_item("TOC_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TOC_FloodgatePrompt_NoLabel),this.floodgateUIStringMap.set_item("TOC_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TOC_FloodgateRatingQuestion),this.floodgateUIStringMap.set_item("TOC_FloodgateRating_1",CommonUIStrings.l_WAC_TOC_FloodgateRating_1),this.floodgateUIStringMap.set_item("TOC_FloodgateRating_2",CommonUIStrings.l_WAC_TOC_FloodgateRating_2),this.floodgateUIStringMap.set_item("TOC_FloodgateRating_3",CommonUIStrings.l_WAC_TOC_FloodgateRating_3),this.floodgateUIStringMap.set_item("TOC_FloodgateRating_4",CommonUIStrings.l_WAC_TOC_FloodgateRating_4),this.floodgateUIStringMap.set_item("TOC_FloodgateRating_5",CommonUIStrings.l_WAC_TOC_FloodgateRating_5),this.floodgateUIStringMap.set_item("TOC_FloodgateQuestion",CommonUIStrings.l_WAC_TOC_FloodgateQuestion),this.floodgateUIStringMap.set_item("ShowChanges_Prompt",CommonUIStrings.l_Excel_ShowChanges_Prompt),this.floodgateUIStringMap.set_item("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.floodgateUIStringMap.set_item("ShowChanges_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_2",CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_4",CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.floodgateUIStringMap.set_item("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgateRatingValue_1",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),this.floodgateUIStringMap.set_item("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.floodgateUIStringMap.set_item("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.floodgateUIStringMap.set_item("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.floodgateUIStringMap.set_item("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),this.floodgateUIStringMap.set_item("Ruler_PromptAnswer_Sure",CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.floodgateUIStringMap.set_item("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.floodgateUIStringMap.set_item("Ruler_RatingValue_1",CommonUIStrings.l_WordRuler_RatingValue_1),this.floodgateUIStringMap.set_item("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.floodgateUIStringMap.set_item("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.floodgateUIStringMap.set_item("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.floodgateUIStringMap.set_item("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),this.floodgateUIStringMap.set_item("Ruler_WhyQuestion",CommonUIStrings.l_WordRuler_WhyQuestion),this.floodgateUIStringMap.set_item("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),this.floodgateUIStringMap.set_item("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.floodgateUIStringMap.set_item("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.floodgateUIStringMap.set_item("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.floodgateUIStringMap.set_item("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),this.floodgateUIStringMap.set_item("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.floodgateUIStringMap.set_item("WordStyles_FloodgateRating_2",CommonUIStrings.l_WordStyles_FloodgateRating_2),this.floodgateUIStringMap.set_item("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.floodgateUIStringMap.set_item("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.floodgateUIStringMap.set_item("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.floodgateUIStringMap.set_item("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),this.floodgateUIStringMap.set_item("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),this.floodgateUIStringMap.set_item("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.floodgateUIStringMap.set_item("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.floodgateUIStringMap.set_item("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.floodgateUIStringMap.set_item("UnsavedChangesHighlight_RatingQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.floodgateUIStringMap.set_item("UnsavedChangesHighlight_Rating_Yes",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.floodgateUIStringMap.set_item("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.floodgateUIStringMap.set_item("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion)}catch(e){a.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+(e?e.toString():""))}},e.delayCustomMs=function(e){try{return new Promise((function(t,n){window.setTimeout((function(){t(null)}),e)}))}catch(e){return a.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),Promise.resolve(null)}},e.createAuthTokenHandler=function(t){if("Unknown"===t||"Automation"===t||!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAuthCallbackIsEnabled"))return a.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+t),null;var n={};return n.getUserPuid=e.getUserPuid,n},e.createAugLoopHandler=function(){var e={};return e.isEnabled=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAugLoopRuntimeIsEnabled"),e},e.getUserPuid=function(){return r.AFrameworkApplication.appSettingsManager.getStringAppSetting("Puid")},e.get_Nps_RatingQuestion_Word=function(){return ye.a.isTeamsElectron?CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Word},e.get_Nps_RatingQuestion_PowerPoint=function(){return ye.a.isTeamsElectron?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint},e.get_Nps_RatingQuestion_Excel=function(){return ye.a.isTeamsElectron&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel},e.get_Nps_RatingQuestion_OneNote=function(){return ye.a.isTeamsElectron&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote},t=e,(n=[{key:"appSpecificFeedbackData",get:function(){return this._appSpecificFeedbackData||(this._appSpecificFeedbackData=_.a.instance.resolve("Common.App.IAppSpecificFeedbackData"))}}])&&Ie(t.prototype,n),i&&Ie(t,i),e}();we.mainSIFBBrs="SystemInitiatedFeedbackIsEnabled",we.campaignDefinitionKey="obf-CampaignDefinitions",we.appUsageNPSOneClick="AppUsageNPSOneClick",we.appUsageNPSOneClickTimeSatisfied="AppUsageNPSOneClickTimeSatisfied",we.defaultDeferredActivityDelayInMilliSeconds=300,we.defaultPostDownloadJsInitDelayInMilliSeconds=1e3,Object(i.a)(we,"SystemInitiatedFeedback",null,[254]);var Te=function(){function e(e){if(!e)throw Error.argumentNull("SystemInitiatedFeedback is null");this._sif=e,this._activityTimestamps={},this._activitySkipCounts={},this._activityLoggedCounts={}}var t=e.prototype;return t.logActivityWithThreshold=function(e,t,n,i){return this.getActivityLoggedCount(e)<i&&this.logActivity(e,t,n)},t.logActivity=function(e,t,n){var i=new Date;if(!e||!this._sif.floodgateEnabled(e,we.mainSIFBBrs,t))return!1;var r=null;e in this._activityTimestamps&&(r=this._activityTimestamps[e]);var o=this.getActivitySkipCount(e),s=this.getActivityLoggedCount(e);return this.enoughTimeHasLapsed(r,i,n)?(a.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",o,e),this._sif.logActivity(e,t),this._activityTimestamps[e]=i,this._activitySkipCounts[e]=0,this._activityLoggedCounts[e]=s+1,!0):(this._activitySkipCounts[e]=o+1,!1)},t.enoughTimeHasLapsed=function(e,t,n){return!e||t.getTime()-e.getTime()>=1e3*n},t.getActivitySkipCount=function(e){var t=0;return e in this._activitySkipCounts&&(t=this._activitySkipCounts[e]),t},t.getActivityLoggedCount=function(e){var t=0;return e in this._activityLoggedCounts&&(t=this._activityLoggedCounts[e]),t},e}();Object(i.a)(Te,"SystemInitiatedFeedbackWithTimeLapse",null,[252]);var Ee=n(68);function ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"CustomerFeedbackPackage",(function(){return Me}));var Me=function(){function e(){this._container=null,this._customerFeedbackActor=null}var t,n,i,o=e.prototype;return o.configure=function(e){var t=this;r.AFrameworkApplication.dataPlumber||(a.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),r.AFrameworkApplication.dataPlumber=new g.a),e.register(k,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").singleInstance(),e.register(oe,"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").singleInstance().usingFactory((function(){return new oe(W.FocusManager.instance(),r.AFrameworkApplication.dataPlumber)})),e.register(I,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").singleInstance().usingFactory((function(){return new I(e.resolve("Common.App.ICustomerFeedbackUiWrapper"),e.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),r.AFrameworkApplication.dataPlumber)})),e.register(C,"Common.App.CustomerFeedback.CustomerFeedbackActor").singleInstance().usingFactory((function(){return new C(r.AFrameworkApplication.theActionManager,r.AFrameworkApplication.activeFrame,e.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),r.AFrameworkApplication.appSettingsManager,r.AFrameworkApplication.dataPlumber)})),e.register(we,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").singleInstance().usingFactory((function(){return new we(e.resolve("Common.App.ICustomerFeedbackUiWrapper"))})),e.register(238,"Common.App.IAppSpecificFeedbackData").singleInstance().usingFactory((function(){return t.createAppSpecificFeedbackData()})),e.register(Te,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").singleInstance().usingFactory((function(){return new Te(e.resolve("Common.ISystemInitiatedFeedback"))})),this._container=e},o.createAppSpecificFeedbackData=function(){var e=null;switch(B.Redirect.application){case 2:e=null;break;case 4:e=new u;break;case 3:e=new d;break;case 1:e=new c;break;case 5:e=new p;break;default:a.ULS.sendTraceTag(37234573,356,10,"Unexpected Application: {0}",B.Redirect.application.toString())}return e},o.init=function(){e._initialized||(this._customerFeedbackActor=this._container.resolve("Common.App.CustomerFeedback.CustomerFeedbackActor"),this._customerFeedbackActor.registerActions(),this._container.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback"),this._container.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse"),e._initialized=!0)},o.dispose=function(){},e.main=function(){Ee.a.instance.registerPackage(new e)},t=e,(n=[{key:"name",get:function(){return"Common.App.CustomerFeedback"}}])&&ke(t.prototype,n),i&&ke(t,i),e}();Me._initialized=!1,Object(i.a)(Me,"CustomerFeedbackPackage",null,[14,15])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(75),o=n(1),s=n(10);function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(){function e(){}var t,n,i;return t=e,i=[{key:"myDialogHtml",get:function(){return a.a.formatHtml(e.myDialogHtmlFormat,WordViewerIntl.WordViewerStrings.l_TranslationPrivacyWarning,WordViewerIntl.WordViewerStrings.l_ChooseTranslationLanguage)}}],(n=null)&&l(t.prototype,n),i&&l(t,i),e}();c.myDialogHtmlFormat="<div class='WACDialogRow' id='TranslationPrivacyLabelBlock'> <label id='TranslationPrivacyLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='TranslationLabelBlock'> <label id='TranslationLabel' class='WACDialogLabel' for='TranslationLanguageList' >{1}</label> </div> <div class='WACDialogRowNoBreak' id='TranslationLanguageListBlock'> <select class='UIFont WACDialogList' id='TranslationLanguageList'> </select> </div>",Object(i.a)(c,"TranslationDialogHtml",null,[]);var u=n(111);n.d(t,"TranslationDialog",(function(){return d}));var d=function(e){var t,n;function i(){var t;return(t=e.call(this)||this)._languages=null,t._uiLanguageId=0,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=i.prototype;return a.start=function(){var e;this.dialogId="TranslationDialog";var t=((e={}).TranslationLanguageList=0,e);this.dialogHtml=c.myDialogHtml,this.buttonsOption=1,this.initializeAndShow(WordViewerIntl.WordViewerStrings.L_TranslateDocument,Object(r.d)(this,this.handleClick,"handleClick"),t),this.setDescribedByForDialog(this.myId("TranslationPrivacyLabel")),this.populateLanguageList()},a.populateLanguageList=function(){this._languages=u.a.translationLanguages.getLanguages(),this._uiLanguageId=1023&o.AFrameworkApplication.lcid,this._languages.sort(Object(r.d)(this,this.compareLanguages,"compareLanguages"));for(var e=document.getElementById("TranslationLanguageList"),t=0;t<this._languages.length;t++){var n=document.createElement("OPTION");n.value=this._languages[t].name,n.text=this._languages[t].displayName,s.a.isInternetExplorerNonEdge?e.add(n):e.add(n,null)}},a.compareLanguages=function(e,t){var n=e,i=t,r=n.languageId===this._uiLanguageId,a=i.languageId===this._uiLanguageId;return r&&!a?-1:a&&!r?1:n.displayName.localeCompare(i.displayName)},a.handleClick=function(e,t){1===e&&u.a.translateDocument(this._languages[t.TranslationLanguageList].name)},i}(a.a);Object(i.a)(d,"TranslationDialog",a.a,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(269),a=n(1),o=n(3);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(e){var t,n;function i(t,n){var i;return void 0===n&&(n=0),(i=e.call(this)||this)._language=t,i._pageCount=n,i._startTime=(new Date).getTime(),a.AFrameworkApplication.theWsaClient.incrementDw(9984,1),i}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,l,c,u=i.prototype;return u.start=function(t){o.ULS.sendTraceTag(23184016,301,50,"Translation started"),e.prototype.start.call(this,t)},u.onCancel=function(t){e.prototype.onCancel.call(this,t),a.AFrameworkApplication.theWsaClient.incrementDw(9986,1),o.ULS.sendTraceTag(40953793,301,50,"Translation canceled")},u.onSuccess=function(e){var t=(new Date).getTime()-this._startTime;a.AFrameworkApplication.theWsaClient.setDw(9985,t),this.redirect(),o.ULS.sendTraceTag(23184017,301,50,"Translation succeeded")},u.getErrorMessage=function(e){return"TranslationServiceUnavailable"===e?CommonUIStrings.l_TranslationServiceUnavailable:"DocumentCannotBeTranslated"===e?CommonUIStrings.l_DocumentCannotBeTranslated:"DocumentHasOCX"===e?CommonUIStrings.l_DocumentCannotBeTranslatedOCX:"DocumentTooLong"===e?CommonUIStrings.l_DocumentCannotBeTranslatedLength:CommonUIStrings.l_GenericTranslationError},u.isDocumentIssue=function(e){return"DocumentCannotBeTranslated"===e||"DocumentHasOCX"===e||"DocumentTooLong"===e},r=i,(l=[{key:"waitMessage",get:function(){return this._pageCount>=10?CommonUIStrings.l_WaitForLongTranslation:CommonUIStrings.l_WaitForTranslation}},{key:"dismissWaitUIOnSuccess",get:function(){return!1}}])&&s(r.prototype,l),c&&s(r,c),i}(r.a);Object(i.a)(l,"TranslateDocumentRequest",r.a,[]);var c=n(27),u=n(16),d=n(105),p=n(112),h=n(14),m=n(37),g=n(36);function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"TranslateDocumentRequestFromViewer",(function(){return v}));var v=function(e){var t,n;function i(t){return e.call(this,t,h.App.instance.theDocument.pageCount)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,o,s,l=i.prototype;return l.redirect=function(){if(d.b(a.AFrameworkApplication.appSettingsManager)){var e=new p.a;e.add("language",this._language),d.f("view",e,d.g)}else{var t=c.a.addOrReplaceParameterValue(window.self.location.href,"language",this._language);u.a.openWindow(1,t)}},l.propagateError=function(e){g.a.propagateError(!1,"TranslationFailed",m.a.itemNotGenerated,e)},r=i,(o=[{key:"requestUri",get:function(){return h.App.instance.getDocDataUri(this._language)}}])&&f(r.prototype,o),s&&f(r,s),i}(l);Object(i.a)(v,"TranslateDocumentRequestFromViewer",l,[])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(290),a=n(331),o=n(233),s=n(59),l=function(){function e(){}return e.defineProperty=function(e,t,n,i){var l=new a.a(o.a(e,t,s.a.getStorageType(n)),n,i);return r.a.instance.registerProperty(l),l},e}();Object(i.a)(l,"APropertySpace",null,[]),n.d(t,"CommonProperties",(function(){return c}));var c=function(e){var t,n;function i(){return e.call(this)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.$$cctor=function(){},i.ensureLoaded=function(){},i.defineProperty$1=function(e,t){return l.defineProperty(2,e,t,0)},i}(l);c.nil=c.defineProperty$1(0,s.a.nil),c.noData=c.defineProperty$1(1,s.a.noData),c.bool=c.defineProperty$1(2,s.a.bool),c.oneByteOfData=c.defineProperty$1(3,s.a.oneByte),c.twoBytesOfData=c.defineProperty$1(4,s.a.twoBytes),c.fourBytesOfData=c.defineProperty$1(5,s.a.fourBytes),c.eightBytesOfData=c.defineProperty$1(6,s.a.eightBytes),c.fourBytesOfLengthFollowedByData=c.defineProperty$1(7,s.a.byteArray),c.objectId=c.defineProperty$1(8,s.a.objectId),c.arrayOfObjectIds=c.defineProperty$1(9,s.a.arrayOfObjectIds),c.objectSpaceId=c.defineProperty$1(10,s.a.objectSpaceId),c.arrayOfObjectSpaceIds=c.defineProperty$1(11,s.a.arrayOfObjectSpaceIds),c.contextId=c.defineProperty$1(12,s.a.contextId),c.arrayOfContextIds=c.defineProperty$1(13,s.a.arrayOfContextIds),c.reserved14=c.defineProperty$1(14,s.a.reserved14),c.reserved15=c.defineProperty$1(15,s.a.reserved15),c.arrayOfPropertyValues=c.defineProperty$1(16,s.a.arrayOfPropertyValues),c.propertySet=c.defineProperty$1(17,s.a.propertySet),c.iUnknown=c.defineProperty$1(18,s.a.iUnknown),c.iUnknownInPropertySet=c.defineProperty$1(19,s.a.iUnknownInPropertySet),c.reserved20=c.defineProperty$1(20,s.a.reserved20),c.reserved21=c.defineProperty$1(21,s.a.reserved21),c.reserved22=c.defineProperty$1(22,s.a.reserved22),c.reserved23=c.defineProperty$1(23,s.a.reserved23),c.reserved24=c.defineProperty$1(24,s.a.reserved24),c.reserved25=c.defineProperty$1(25,s.a.reserved25),c.reserved26=c.defineProperty$1(26,s.a.reserved26),c.reserved27=c.defineProperty$1(27,s.a.reserved27),c.reserved28=c.defineProperty$1(28,s.a.reserved28),c.reserved29=c.defineProperty$1(29,s.a.reserved29),c.reserved30=c.defineProperty$1(30,s.a.reserved30),c.conflict=c.defineProperty$1(31,s.a.conflict),c.reportingCustomData1=c.defineProperty$1(32,s.a.uInt_32),c.reportingCustomData2=c.defineProperty$1(33,s.a.uInt_32),c.maxPropertyIndex=33,Object(i.a)(c,"CommonProperties",l,[]),c.$$cctor()},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(152),o=(n(9),n(12)),s=n(343),l=n(344),c=n(123),u=n(167);var d=function(e){var t,n;function i(){var t;return(t=e.call(this)||this).jewel=null,t.jewelId=null,t.parentRoot=null,t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(u.a);Object(i.a)(d,"JewelBuildContext",u.a,[]);var p=n(311),h=n(190),m=n(5),g=n(6);function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"JewelBuilder",(function(){return v}));var v=function(e){var t,n;function i(t,n,i){var r;if(r=e.call(this,t,n,i,null)||this,m.c(n))throw Error.create("Jewel placeholder DOM element is null or undefined.");return r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a,u,v,_=i.prototype;return _.set_jewel=function(e){return this.root=e,e},_.buildJewel=function(e,t){if(this.inQuery)return!1;if(this.isIdTrimmed(e))return!0;var n=new d;n.jewelId=e,n.parentRoot=t,this.inQuery=!0;var i=new s.a;return i.id=n.jewelId,i.queryType=4,i.handler=Object(r.d)(this,this.onReturnJewel,"onReturnJewel"),i.data=n,this.dataSource.runQuery(i),!0},_.buildJewelFromData=function(e,t){var n=new l.a;n.success=!0,n.queryData=e,n.contextData=t,this.onReturnJewel(n)},_.onReturnJewel=function(e){var t=this,n=e.contextData,i=o.a.getFirstChildNodeWithName(e.queryData,o.a.JEWEL);this.set_jewel(this.buildJewelInternal(i,n)),this.jewel.jewelBuilder=this,this.jewel.refreshInternal(),this.placeholder.appendChild(this.jewel.elementInternal),g.a.ensureCSSClassOnElement(this.placeholder,"loaded"),this.buildClientTask.CWo((function(e){t.buildClientTask.get_result().onComponentBuilt(t.jewel,t.jewel.id)}),11)},_.buildJewelInternal=function(e,t){if(m.c(e))throw Error.create("No Jewel element was present in the data");var n=new o.a(e),i=n.attributes;i.DefaultSelection=this.jewelBuildOptions.defaultSelectionOverride||i.DefaultSelection,this.set_jewel(new c.Jewel(n.attributes.Id,i));var r=this.buildJewelMenuLauncher(e,t);return this.jewel.addChild(r.createComponentForDisplayMode("Default")),this.jewel.jewelMenuLauncher=r,this.jewel},_.buildJewelMenuLauncher=function(e,t){var n=e[o.a.ATTRIBUTES],i=o.a.getNodeChildren(e),r=null,a=e[o.a.ATTRIBUTES];g.a.isTrue(a.PopulateDynamically)||(r=this.buildMenu(i[0],t));var s=new p.JewelMenuLauncher(this.jewel,n.Id,n,r,t.parentRoot);return s.parentKeytipsIds=h.a.ribbonShortcutId,s.parentKeytipsKeys="",s},a=i,(u=[{key:"jewel",get:function(){return this.root}},{key:"jewelBuildOptions",get:function(){return this.options}}])&&f(a.prototype,u),v&&f(a,v),i}(a.Builder);Object(i.a)(v,"JewelBuilder",a.Builder,[])}]));
//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/ooui/1bdb878eb2c9f6e4858feb8dab64d388d1ebe749/WordViewerDS.js.map